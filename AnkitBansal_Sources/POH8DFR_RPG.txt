     H/TITLE WW Details f/Maint     DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSPATI
     H* Date          : 01/22/25  Time  : 10:50:03
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPOH8DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Details f/Maint     DF Display file
      *
     FOPBGWKLAIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Detail              co/
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOMHLREL7IF  E           K        DISK
      * RSQ : Accrual Program           Discount Programs
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FPMD2REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm          Retrieval index
      *
     FPNFJREL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Cust     Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMHQCPL1IF  E           K        DISK
      * RTV : Order Detail Accrual      Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIHREL4IF  E           K        DISK
      * RSQ : Price Method Header       Price Method Header
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDIPREL2IF  E           K        DISK
      * RSQ : Market Date Method        System/Co/Date Method
      *
     FOMF0CPL3IF  E           K        DISK
      * RTV : Commodity Mrkt Price      Active Only
      *
     FPDK3CPL2IF  E           K        DISK
      * RSQ : Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDK3CPL0IF  E           K        DISK                      A
      * UPD : Price Change Audit Log    Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 058  5 0A
     E                    W0END   7 058  5 0A
     E                    W0NAM   7 058 10
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WDAIC3
     I              IHQ7CD                          WDQ7CD
     I              IHMLNA                          WDMLNA
     I              IHU0ST                          WDU0ST
     I              IHV8ST                          WDV8ST
     I              IHBYST                          WDBYST
     I              IHRMNY                          WDRMNY
     I              IHH3ST                          WDH3ST
     I              IHH5ST                          WDH5ST
     I              IHH6ST                          WDH6ST
     I              IHH7ST                          WDH7ST
     I              IHUVST                          WDUVST
     I              IHUWST                          WDUWST
     I              IHUXST                          WDUXST
     I              IHAATM                          WDAATM
     I              IHAYNA                          WDAYNA
     I              IHA0NA                          WDA0NA
     I              IHAXDT                          WDAXDT
      *
     I@F0CPVR
      * Commodity Mrkt Price      Active Only
      * Renamed input format fields
     I              F0LQCD                          WELQCD
     I              F0LRCD                          WELRCD
     I              F0EQDT                          WEEQDT
     I              F0A5PR                          WEA5PR
     I              F0B8PR                          WEB8PR
     I              F0UVST                          WEUVST
     I              F0UWST                          WEUWST
     I              F0UXST                          WEUXST
     I              F0VSST                          WEVSST
     I              F0AATM                          WEAATM
     I              F0AYNA                          WEAYNA
     I              F0A0NA                          WEA0NA
     I              F0AXDT                          WEAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@K3CPKP
      * Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WGAIC3
     I              K3C4NB                          WGC4NB
     I              K3DPNB                          WGDPNB
     I              K3UENB                          WGUENB
     I              K3ASNO                          WGASNO
     I              K3HGCD                          WGHGCD
     I              K3GMST                          WGGMST
     I              K3GNST                          WGGNST
     I              K3AYVA                          WGAYVA
     I              K3YJVA                          WGYJVA
     I              K3U1ST                          WGU1ST
     I              K3PSTL                          WGPSTL
     I              K3U0ST                          WGU0ST
     I              K3RFCD                          WGRFCD
     I              K3PALS                          WGPALS
     I              K3WWCD                          WGWWCD
     I              K3AKPR                          WGAKPR
     I              K3DBPR                          WGDBPR
     I              K3ALPR                          WGALPR
     I              K3DCPR                          WGDCPR
     I              K3JPCD                          WGJPCD
     I              K3WXCD                          WGWXCD
     I              K3PREC                          WGPREC
     I              K3PIDX                          WGPIDX
     I              K3UVST                          WGUVST
     I              K3UWST                          WGUWST
     I              K3UXST                          WGUXST
     I              K3AATM                          WGAATM
     I              K3AYNA                          WGAYNA
     I              K3A0NA                          WGA0NA
     I              K3AXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop_Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     IYBRDCS      DS                            894
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPCRC        DS                             10
      * KEY : Order Detail              Retrieval index
      * I : RST Company Number
     I                                    P   1   20PCAIC3
      * I : RST Order Number
     I                                    P   3   60PCC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PCDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PCUENB
      *
      * Outward parameters
     IPDRC        DS                             12
      * KEY : Order Detail Accrual      Retrieval index
      * I : RST Company Number
     I                                    P   1   20PDAIC3
      * I : RST Order Number
     I                                    P   3   60PDC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PDDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PDUENB
      *
      * Outward parameters
     IPERC        DS                              7
      * KEY : IP Item Market Details    Retrieval index
      * I :  Item Code
     I                                    P   1   40PEHGCD
      * I :  Commodity Market Code
     I                                        5   7 PELQCD
      *
      * Outward parameters
     IPFRC        DS                             12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     I                                    P   1   40PFBKC7
      * I :  Price Code
     I                                    P   5   80PFBVTM
      * I :  Item Code
     I                                    P   9  120PFHGCD
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     IYCRDCS      DS                            525
     IYDRDCS      DS                            779
     IQPDK31    E DSPDK3CPL0
      * UPD : Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WGAIC3
     I              K3C4NB                          WGC4NB
     I              K3DPNB                          WGDPNB
     I              K3UENB                          WGUENB
     I              K3ASNO                          WGASNO
     I              K3HGCD                          WGHGCD
     I              K3GMST                          WGGMST
     I              K3GNST                          WGGNST
     I              K3AYVA                          WGAYVA
     I              K3YJVA                          WGYJVA
     I              K3U1ST                          WGU1ST
     I              K3PSTL                          WGPSTL
     I              K3U0ST                          WGU0ST
     I              K3RFCD                          WGRFCD
     I              K3PALS                          WGPALS
     I              K3WWCD                          WGWWCD
     I              K3AKPR                          WGAKPR
     I              K3DBPR                          WGDBPR
     I              K3ALPR                          WGALPR
     I              K3DCPR                          WGDCPR
     I              K3JPCD                          WGJPCD
     I              K3WXCD                          WGWXCD
     I              K3PREC                          WGPREC
     I              K3PIDX                          WGPIDX
     I              K3UVST                          WGUVST
     I              K3UWST                          WGUWST
     I              K3UXST                          WGUXST
     I              K3AATM                          WGAATM
     I              K3AYNA                          WGAYNA
     I              K3A0NA                          WGA0NA
     I              K3AXDT                          WGAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
     IP2PARM      DS
      * FLD: User Profile Control
      * N :  User Profile Name
     I                                        1  10 P2AJVN
      * N :  System Date Format
     I                                       11  13 P2B8NA
      * N :  Allow Multi_Company
     I                                       14  14 P2I6ST
      * N :  Default Printer
     I                                       15  24 P2MPNA
      * N :  Salesperson Code
     I                                       25  27 P2BCCD
      * N :  Warehouse Code
     I                                       28  30 P2AJCD
     IP3PARM      DS
      * FLD: Order Header TRG
      * I : MAP Order Type_Sales
     I                                        1   2 P3JNCD
      * N :  AR Customer Number
     I                                    P   3   60P3ANC7
      * I :  Ship To Customer
     I                                    P   7  100P3BKC7
      * I :  Ship To Name
     I                                       11  40 P3BRTX
      * I :  Ship To City
     I                                       41  60 P3HNNA
      * I :  Ship To State Code
     I                                       61  62 P3DBCD
      * I :  Customer Purchase Order #
     I                                       63  77 P3BCNA
      * I :  Requested Ship Date
     I                                    P  78  810P3A5DT
      * I :  Actual Shipped Date
     I                                    P  82  850P3GNDT
      * I : MAP Header Status
     I                                       86  86 P3GWST
      * N :  Header Status Last
     I                                       87  87 P3GXST
      * I :  Scheduled Ship Date
     I                                    P  88  910P3AODT
      * B : MAP Order Value Total
     I                                    P  92  972P3JZVA
      * B : MAP Order Weight Total
     I                                    P  98 1032P3A1WG
      * I :  Requested Delivery Date
     I                                    P 104 1070P3EIDT
      * I :  Price Audit
     I                                      108 108 P3U0ST
      * I :  Shipping Method
     I                                      109 110 P3Q2CD
      * N :  A_R order Value Total
     I                                    P 111 1162P3VRVA
      * I :  Billing Activity Type
     I                                      117 117 P3OBST
     IP4PARM      DS
      * N :  Price Status USR
     I                                        1   1 P4YBST
     IP5PARM      DS
      * N :  OD Price Type Req STS USR
     I                                        1   1 P5
     IP6PARM      DS
      * N :  Abs Freight Rate Change?
     I                                        1   1 P6HTSC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'F8 is not allowed Pay Met'
      * Shipping Method
     I                                        1   2 ZA0001
      * Message data for 'ABS Freight Rate is Zero'
      * Absorbed Freight Rate CWT
     I                                    P   1   32ZA0002
      * Message data for 'ABS Frt Ovr Rsn Must Exst'
      * Abs Frt Override Reason
     I                                        1   2 ZA0003
      * Message data for 'ABS Frt Ovr Rsn Must Exst'
      * Abs Frt Override Reason
     I                                        1   2 ZA0004
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     I                                        1  25 ZA0005
      * Message data for 'Price Code Inv for Mthd'
      * Price Code
     I                                    P   1   40ZA0006
      * Price Method Code
     I                                        5   7 ZA0007
      * Message data for 'Price Code not val f/cust'
      * Price Code
     I                                    P   1   40ZA0008
      * Message data for 'Price Code not val dt rng'
      * Price Code
     I                                    P   1   40ZA0009
      * Message data for 'Price Code not val f/item'
      * Price Code
     I                                    P   1   40ZA0010
      * Item Code
     I                                        5  11 ZA0011
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0012
      * Weight Allocated USR
     I                                    P   5   92ZA0013
      * Maximum Contract Units
     I                                    P  10  152ZA0014
      * Item Code
     I                                       16  22 ZA0015
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0016
      * Weight Allocated USR
     I                                    P   5   92ZA0017
      * Maximum Contract Units
     I                                    P  10  152ZA0018
      * Item Code
     I                                       16  22 ZA0019
      * Message data for 'Price code req for mthd'
      * Price Method Code
     I                                        1   3 ZA0020
      * Price Code
     I                                    P   4   70ZA0021
      * Message data for 'Market Date/Range ERR'
      * Market Pricing Date
     I                                    P   1   40ZA0022
      * OD Market Begin Date
     I                                    P   5   80ZA0023
      * OD Market Ending Date
     I                                    P   9  120ZA0024
      * Message data for 'Date Range Invalid'
      * OD Market Begin Date
     I                                    P   1   40ZA0025
      * OD Market Ending Date
     I                                    P   5   80ZA0026
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0027
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0028
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0029
      * Message data for 'Prc Date Range Inv'
      * OD Market Begin Date
     I                                    P   1   40ZA0030
      * OD Market Ending Date
     I                                    P   5   80ZA0031
      * Price Method Code
     I                                        9  11 ZA0032
      * Message data for 'Price Override Required'
      * Contract Price Override
     I                                    P   1   64ZA0033
      * Message data for 'Market Code not allowed'
      * Dft Commodity Market
     I                                        1   3 ZA0034
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0035
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0036
      * Message data for 'Prc Dts = 0 f/Prc Mth'
      * Market Pricing Date
     I                                    P   1   40ZA0037
      * OD Market Begin Date
     I                                    P   5   80ZA0038
      * OD Market Ending Date
     I                                    P   9  120ZA0039
      * Price Method Code
     I                                       13  15 ZA0040
      * Message data for 'Manual price within Prcnt'
      * Price Overage Override
     I                                    P   1   64ZA0041
      * Message data for 'No Mkt Prc Found for test'
      * Price Overage Override
     I                                    P   1   64ZA0042
      * Commodity Market Code
     I                                        7   9 ZA0043
      * Commodity Price Group
     I                                       10  16 ZA0044
      * Message data for 'Market Code not allowed'
      * Dft Commodity Market
     I                                        1   3 ZA0045
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0046
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0047
      * Message data for 'Ceiling Price Required'
      * OD Ceiling Price
     I                                    P   1   64ZA0048
      * Message data for 'Prc Dts = 0 f/Prc Mth'
      * Market Pricing Date
     I                                    P   1   40ZA0049
      * OD Market Begin Date
     I                                    P   5   80ZA0050
      * OD Market Ending Date
     I                                    P   9  120ZA0051
      * Price Method Code
     I                                       13  15 ZA0052
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0053
      * Message data for 'Market Code must be enter'
      * Commodity Market Code
     I                                        1   3 ZA0054
      * Message data for 'Market Date Method Inval.'
      * Date Method Code
     I                                        1   3 ZA0055
      * Message data for 'Date Meth & Prc Dat N/A'
      * Market Pricing Date
     I                                    P   1   40ZA0056
      * Date Method Code
     I                                        5   7 ZA0057
      * Message data for 'Market Date Method Inval.'
      * Date Method Code
     I                                        1   3 ZA0058
      * Message data for 'Market Date/Range ERR'
      * Market Pricing Date
     I                                    P   1   40ZA0059
      * OD Market Begin Date
     I                                    P   5   80ZA0060
      * OD Market Ending Date
     I                                    P   9  120ZA0061
      * Message data for 'Date Range Invalid'
      * OD Market Begin Date
     I                                    P   1   40ZA0062
      * OD Market Ending Date
     I                                    P   5   80ZA0063
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0064
      * Commodity Price Group
     I                                        4  10 ZA0065
      * Message data for 'No Price Mkt/Group Deflt'
      * Commodity Market Code
     I                                        1   3 ZA0066
      * Commodity Price Group
     I                                        4  10 ZA0067
      * Default Commod Mark basis
     I                                       11  13 ZA0068
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0069
      * Commodity Price Group
     I                                        4  10 ZA0070
      * Message data for 'OD Price Type Req'
      * OD Price Type
     I                                        1   3 ZA0071
      * Message data for 'Send Price MSG to Seaboar'
      * Order Number
     I                                        1   7 ZA0072
      * Order Sequence Number
     I                                    P   8   90ZA0073
      * Item Code
     I                                       10  16 ZA0074
      * Catch Weight Status
     I                                       17  17 ZA0075
      * Unit Price
     I                                    P  18  234ZA0076
      * Message data for 'OD Price Type Req'
      * OD Price Type
     I                                        1   3 ZA0077
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0078
      * Application Code
     I                                       11  16 ZA0079
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0080
      * Application Code
     I                                       11  16 ZA0081
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P3JNCD    PARM           WP0003  2        Order Type_Sale
     C           P3BKC7    PARM           WP0004  70       Ship To Custome
     C           P3BRTX    PARM           WP0005 30        Ship To Name
     C           P3HNNA    PARM           WP0006 20        Ship To City
     C           P3DBCD    PARM           WP0007  2        Ship To State C
     C           P3BCNA    PARM           WP0008 15        Customer Purcha
     C           P3A5DT    PARM           WP0009  70       Requested Ship
     C           P3GNDT    PARM           WP0010  70       Actual Shipped
     C           P3GWST    PARM           WP0011  1        Header Status
     C           P3AODT    PARM           WP0012  70       Scheduled Ship
     C           P3JZVA    PARM P3JZVA    WP0013 112       Order Value Tot
     C           P3A1WG    PARM P3A1WG    WP0014 112       Order Weight To
     C           P3EIDT    PARM           WP0015  70       Requested Deliv
     C           P3U0ST    PARM           WP0016  1        Price Audit
     C           P3Q2CD    PARM           WP0017  2        Shipping Method
     C           P3OBST    PARM           WP0018  1        Billing Activit
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
     C                     Z-ADDP3BKC7    #2BKC7           Ship To Custome
     C                     MOVELP3BRTX    #CBRTX           Ship To Name
     C                     MOVELP3HNNA    #2HNNA           Ship To City
     C                     MOVELP3DBCD    #2DBCD           Ship To State C
     C                     Z-ADDP3AODT    #CHODT           Scheduled Ship
     C                     Z-ADDP3GNDT    #CF9DT           Actual Ship Dat
     C                     MOVELP3BCNA    #CBCNA           Customer Purcha
     C                     Z-ADDP3EIDT    #2EIDT           Requested Deliv
     C                     Z-ADDP3A5DT    #2A5DT           Requested Ship
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           P5        PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.OD Price Type Req STS USR is yes
     C           P5        IFEQ 'Y'                        *IF
      * Val Price Type Entry  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      Record Found -O
      * CASE: LCL.Record Found -OrdDtlUSR is Record Found
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,002   #CG5TX           Text 1 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CG5TX           Text 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CG5TX           Text 1 USR
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SBRVGN
      * Rtv Discounts Exists  XF
      * Rtv Discounts Exist   RT - Accrual Program  * 
     C                     EXSR SCRVGN
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0002    IFEQ 'H'                        *IF
      * RTV HPB Equiv only   RT - Order Header Extension  * 
     C                     EXSR SGRVGN
      * CASE: CTL.HPB Equivalence Value USR is Not Entered
     C           #CP4NY    IFEQ *ZERO                      *IF
     C                     Z-ADD1.5       #CP4NY           HPB Equivalence
     C                     END                             *FI
     C                     END                             *FI
      * JJH 07/24/2014 E3212  Display Order Date
      * Rtv Order Date         RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * R12926 DN 05/16/18-Set ABS Freight Rate & Abs Frt Override Reason
      * CASE: *OTHERWISE
      * Rtv Org ABS & Reason   RT - Order Header Extension  * 
     C                     EXSR SIRVGN
     C                     Z-ADD#CQMNY    #CLMNY           Absorbed Freigh
      * Save Before Abs Frt Override Reason.
     C                     MOVEL#CHSSC    YL0006           Abs Frt Overrid
      * Rtv Abs Frt Rate Info RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * Save Before Rate.
     C                     Z-ADD#CTBNB    YL0010           Absorbed Freigh
      * If Buyers Truck or Rail, Don't Allow Input for Both Abs Frt Rate
      * CASE: LCL.Shipping Method is Buyers Truck
     C           YL0008    IFEQ 'CR'                       *IF
     C           YL0008    OREQ 'CT'
     C                     MOVEL'D'       YL0011           Edit/Display Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0011           Edit/Display Us
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     Z-ADD#2DPNB    OMDPNB
     C                     Z-ADD#2UENB    OMUENB
     C           KPOS      SETLL@BGWKAE
     C           KRST      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C           KRST      READE@BGWKAE                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2XIST    WZXIST
     C                     MOVEL#2XIST    WZXIST           Credit Hold
     C           *LIKE     DEFN #2XJST    WZXJST
     C                     MOVEL#2XJST    WZXJST           Production Hold
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type_Sale
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2U2ST    WZU2ST
     C                     MOVEL#2U2ST    WZU2ST           Export Status
     C           *LIKE     DEFN #2AFTM    WZAFTM
     C                     MOVEL#2AFTM    WZAFTM           Requested Deliv
     C           *LIKE     DEFN #2GJST    WZGJST
     C                     MOVEL#2GJST    WZGJST           Order in Use
     C           *LIKE     DEFN #2GMST    WZGMST
     C                     MOVEL#2GMST    WZGMST           Detail Line Sta
     C           *LIKE     DEFN #2JPCD    WZJPCD
     C                     MOVEL#2JPCD    WZJPCD           Event Code
     C           *LIKE     DEFN #2DPNB    WZDPNB
     C                     MOVEL#2DPNB    WZDPNB           Order Sequence
     C           *LIKE     DEFN #2UENB    WZUENB
     C                     MOVEL#2UENB    WZUENB           Order Secondary
     C           *LIKE     DEFN #2G7NA    WZG7NA
     C                     MOVEL#2G7NA    WZG7NA           Order Desc_Line
     C           *LIKE     DEFN #2Q7CD    WZQ7CD
     C                     MOVEL#2Q7CD    WZQ7CD           Price Method Co
     C           *LIKE     DEFN #2LQCD    WZLQCD
     C                     MOVEL#2LQCD    WZLQCD           Commodity Marke
     C           *LIKE     DEFN #2F3SX    WZF3SX
     C                     MOVEL#2F3SX    WZF3SX           Released by Use
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2HNNA    WZHNNA
     C                     MOVEL#2HNNA    WZHNNA           Ship To City
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2HGCD    WZHGCD
     C                     MOVEL#2HGCD    WZHGCD           Item Code
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #2F7SX    WZF7SX
     C                     MOVEL#2F7SX    WZF7SX           OD Price Type
     C           *LIKE     DEFN #2AKPR    WZAKPR
     C                     MOVEL#2AKPR    WZAKPR           Unit Price
     C           *LIKE     DEFN #2CRCD    WZCRCD
     C                     MOVEL#2CRCD    WZCRCD           U_M_Base Price
     C           *LIKE     DEFN #2AUPR    WZAUPR
     C                     MOVEL#2AUPR    WZAUPR           Unit Price Orde
     C           *LIKE     DEFN #2ATWG    WZATWG
     C                     MOVEL#2ATWG    WZATWG           Weight Shipped
     C           *LIKE     DEFN #2AYVA    WZAYVA
     C                     MOVEL#2AYVA    WZAYVA           Extended Amount
     C           *LIKE     DEFN #2U1ST    WZU1ST
     C                     MOVEL#2U1ST    WZU1ST           Price Status
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BGWKAE                  90*
     C  N82                READ @BGWKAE                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  9
     C                     MOVEAWKIND0    *IN,33
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2DPNB    IFEQ *ZERO                      Order Sequence
     C           #2UENB    IFNE *ZERO                      Order Secondary
     C           OMUENB    CABNE#2UENB    BB020            Order Secondary
     C                     END
     C                     END
     C           #2G7NA    IFNE *BLANK                     Order Desc_Line
     C           OMG7NA    CABNE#2G7NA    BB020            Order Desc_Line
     C                     END
     C           #2LQCD    IFNE *BLANK                     Commodity Marke
     C           OMLQCD    CABNE#2LQCD    BB020            Commodity Marke
     C                     END
     C           #2F3SX    IFNE *BLANK                     Released by Use
     C           OMF3SX    CABNE#2F3SX    BB020            Released by Use
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           OMBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2A5DT    IFNE *ZERO                      Requested Ship
     C           OMA5DT    CABNE#2A5DT    BB020            Requested Ship
     C                     END
     C           #2HGCD    IFNE *ZERO                      Item Code
     C           OMHGCD    CABNE#2HGCD    BB020            Item Code
     C                     END
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           OMAJCD    CABNE#2AJCD    BB020            Warehouse Code
     C                     END
     C           #2F7SX    IFNE *BLANK                     OD Price Type
     C           OMF7SX    CABNE#2F7SX    BB020            OD Price Type
     C                     END
     C           #2CRCD    IFNE *BLANK                     U_M_Base Price
     C           OMCRCD    CABNE#2CRCD    BB020            U_M_Base Price
     C                     END
     C           #2AYVA    IFNE *ZERO                      Extended Amount
     C           OMAYVA    CABNE#2AYVA    BB020            Extended Amount
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * RTV Item Descript.     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDNGXFR'              90  RTV Item Descri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0004  30       Company Number
     C                     PARM #1HGCD    WQ0005  70       Item Code
     C           #RGENA    PARM *BLANK    WQ0006 30        Description Lin
     C           WUAWNA    PARM *BLANK    WQ0007 30        Description Lin
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDOMBZPR    #RCLPR           Price Overage O
     C                     MOVELOMQ7CD    #RTKCD           Price Method Co
     C                     MOVELOMLQCD    #RTMCD           Commodity Marke
     C                     Z-ADDOMEXDT    #RG2DT           Market Pricing
     C                     Z-ADDOMBVTM    #RUYNX           Price Code USR
     C                     MOVEL#1RDCD    #RTLCD           Date Method Cod
     C                     Z-ADD#1CXDT    #RPNDT           Date Entered
      * PK0519  10/20/03 RMC
     C                     MOVEL'Y'       #RASTS           USR Display 3
      * Control:  Price Override
      * CASE: RCD.Price Method Code USR is Deviated
     C           #RTKCD    IFEQ 'DEV'                      *IF
     C                     MOVEL'N'       #RASTS           USR Display 3
     C                     END                             *FI
     C                     MOVELOMF7SX    #RPRMT           OD Price Type U
      * Rtv Deduct/Add Exist  RT - Order Detail Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0004           Company Number
     C                     Z-ADD#1C4NB    WL0005           Order Number
     C                     Z-ADD#1DPNB    WL0006           Order Sequence
     C                     Z-ADD#1UENB    WL0007           Order Secondary
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    #RGLST    P      Deduct/Add Sts
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@BGWKAE                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZHGCD    CASNE#2HGCD    FBRQRL
     C           WZAJCD    CASNE#2AJCD    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * 7=Display Customer Pricing Details
      * CASE: CTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * DSP Pricing Details    DF - Company Item  * 
     C                     CALL 'PMMXDFR'              90  DSP Pricing Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2BKC7    WQ0008  70       Ship To Custome
     C                     PARM #2AIC3    WQ0009  30       Company Number
     C                     PARM #2HGCD    WQ0010  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMXDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * S311930 F8=Freight Rate
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * CASE: LCL.Shipping Method is Buyers Truck
     C           YL0008    IFEQ 'CR'                       *IF
     C           YL0008    OREQ 'CT'
      * Setup message data for message
     C                     MOVELYL0008    ZA0001           Shipping Method
      * Send message 'F8 is not allowed Pay Met'
     C                     MOVEL'USR5529' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#CTBNB    YL0012           Absorbed Freigh
     C                     MOVEL#CHSSC    YL0013           Abs Frt Overrid
      * WW Order Maint Freight Rt - Order Detail  * 
     C                     CALL 'PVI6PVR'              90  WW Order Maint
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0011  30       Company Number
     C                     PARM #2C4NB    WQ0012  70       Order Number
     C           #CTBNB    PARM #CTBNB    WQ0013  52       Absorbed Freigh
     C           #CHSSC    PARM #CHSSC    WQ0014  2        Abs Frt Overrid
     C                     PARM #CLMNY    WQ0015  52       Absorbed Freigh
     C                     PARM YL0008    WQ0016  2        Shipping Method
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVI6PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Absorbed Freight Rate Usr NE CTL.Absorbed Freight Rate
     C           YL0012    IFNE #CTBNB                     *IF
      * Send message 'Freight Rate is changed'
     C                     MOVEL'USR5531' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.Abs Frt Override Rsn Usr NE CTL.Abs Frt Override Reason
     C           YL0013    IFNE #CHSSC                     *IF
      * Send message 'Freight Rate Reason code'
     C                     MOVEL'USR5532' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * R12926 DN 05/17/18-Validation for Order ABS Freight Rate & AFO Re
      * CASE: *OTHERWISE
      * Order ABS Freight Rate Cannot Be Zero if Originally Entered.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Absorbed Freight Rate 2 is Entered
      *   |- c2    : CTL.Absorbed Freight Rate CWT is EQ Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFNE *ZERO                      *IF
     C           #CTBNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#CTBNB    ZA0002           Absorbed Freigh
      * Send message 'ABS Freight Rate is Zero'
     C                     MOVEL'USR5072' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * ABS Frt Override Reason Cannot be Blank if ABS Frt Rate Changed.
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : CTL.Absorbed Freight Rate CWT NE CTL.Absorbed Freigh
      *   |- c2    : CTL.Absorbed Freight Rate 1 is Entered
      *   |- c3    : LCL.Shipping Method is Prepaid
      *   |- c4    : CTL.Abs Frt Override Reason is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTBNB    IFNE #CLMNY                     *IF
     C           #CLMNY    IFNE *ZERO                      *IF
     C           YL0008    IFEQ 'PR'                       *IF
     C           YL0008    OREQ 'PT'
     C           #CHSSC    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * S13591 DN 08/16/18-Bypass Error Msg If Orig AFR=0 in OHE & AFR ha
      *   NOT been changed.
      * Setup message data for message
     C                     MOVEL#CHSSC    ZA0003           Abs Frt Overrid
      * Send message 'ABS Frt Ovr Rsn Must Exst'
     C                     MOVEL'USR5084' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * ABS Frt Override Reason Cannot be Blank if ABS Frt Rate Changed-S
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : CTL.Absorbed Freight Rate CWT NE LCL.Absorbed Freigh
      *   |- c2    : CTL.Absorbed Freight Rate 1 is EQ Zeros
      *   |- c3    : LCL.Shipping Method is Prepaid
      *   |- c4    : CTL.Abs Frt Override Reason is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTBNB    IFNE YL0010                     *IF
     C           #CLMNY    IFEQ *ZERO                      *IF
     C           YL0008    IFEQ 'PR'                       *IF
     C           YL0008    OREQ 'PT'
     C           #CHSSC    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * This scenario is where the Orig AFR=0 in OHE file but the AFR hav
      * changed on the screen.
      * Setup message data for message
     C                     MOVEL#CHSSC    ZA0004           Abs Frt Overrid
      * Send message 'ABS Frt Ovr Rsn Must Exst'
     C                     MOVEL'USR5084' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * If No Errors, Proceed to Update ABS Freight Rate & Abs Frt Overri
      * R12926 DN 05/17/18-Update OH ABS Frt Rate & OHE Abs Frt Ovr Reaso
      * CASE: *OTHERWISE
      * Order ABS Freight Rate Changed.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Absorbed Freight Rate CWT is Entered
      *   |- c2    : CTL.Absorbed Freight Rate CWT NE LCL.Absorbed Freigh
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTBNB    IFNE *ZERO                      *IF
     C           #CTBNB    IFNE YL0010                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Abs. Freight Rate  CH - Order Header TRG  * 
     C                     EXSR SLCHRC
      * Create Load Order Change Log for ABS Freight Rate.
      * CASE: CTL.Absorbed Freight Rate CWT NE LCL.Absorbed Freight Rate
     C           #CTBNB    IFNE YL0010                     *IF
     C                     MOVEL'ABSRTE'  YL0014           Load Change Typ
     C                     MOVEL'TRF'     YL0015           Department Cont
      * Format Prior Absorbed Freight Rate with Decimal.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0016           Text USR 5
     C                     MOVELYL0010    YL0016           Text USR 5
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0016:ZQ YL0017    P  90  USR Text 3  3a
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0016:ZQ YL0018    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0017    CAT  '.':ZQ    YL0019    P      Absorbed Freigh
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0019    CAT  YL0018:ZQ YL0019    P      Absorbed Freigh
     C                     MOVEL*BLANK    YL0020           Change Log Prio
     C                     MOVELYL0019    YL0020           Change Log Prio
      * Format New Absorbed Freight Rate with Decimal.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0016           Text USR 5
     C                     MOVEL#CTBNB    YL0016           Text USR 5
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0016:ZQ YL0017    P  90  USR Text 3  3a
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0016:ZQ YL0018    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0017    CAT  '.':ZQ    YL0019    P      Absorbed Freigh
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0019    CAT  YL0018:ZQ YL0019    P      Absorbed Freigh
     C                     MOVEL*BLANK    YL0021           Change Log New
     C                     MOVELYL0019    YL0021           Change Log New
      * Append Abs Frt Override Reason to Last 2 Pos. for Change Log New
      * CASE:
      *  - NOTc1
      *   |- c1    : CTL.Abs Frt Override Reason is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CHSSC    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SET Abs Frt Ovr Rsn    US - /UT User Source  * 
      ** APPEND ABS FRT OVERRIDE REASON TO LAST 2 POS.
     C                     MOVE #CHSSC    YL0021
     C                     END                             *FI
      * CASE: CTL.Load ID is NE Blank
     C           #2RMNB    IFNE *ZERO                      *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#2RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELYL0014    PBRVST    P      Load Change Typ
     C                     MOVELYL0015    PBUJST    P      Department Cont
     C                     MOVELYL0020    PBMNTX    P      Change Log Prio
     C                     MOVELYL0021    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELYL0007    PBBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PBAIC3           Company Number
     C                     Z-ADD#2C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Load/OrderChg n/ld2XF - Load Order Change Log  * 
     C                     CALL 'PUIAXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0017  70       Load ID
     C                     PARM YL0014    WQ0018  6        Load Change Typ
     C                     PARM YL0015    WQ0019  3        Department Cont
     C                     PARM YL0020    WQ0020 12        Change Log Prio
     C                     PARM YL0021    WQ0021 12        Change Log New
     C                     PARM ##USR     WQ0022 10        User Id
     C                     PARM ##PGM     WQ0023 10        Job Name
     C                     PARM #2AIC3    WQ0024  30       Company Number
     C                     PARM #2C4NB    WQ0025  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUIAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Keep Track of Last Changed ABS Freight Rate.
     C                     Z-ADD#CTBNB    YL0010           Absorbed Freigh
     C                     MOVEL'Y'       P6HTSC           Abs Freight Rat
     C                     END                             *FI
      * ABS Freight Override Reason Changed.
      * CASE: CTL.Abs Frt Override Reason NE LCL.Abs Frt Override Reason
     C           #CHSSC    IFNE YL0006                     *IF
      * CHG Abs Rte Ovrrd Rsn  CH - Order Header Extension  * 
     C                     EXSR SMCHRC
      * Keep Track of Last Changed Abs Frt Override Reason.
     C                     MOVEL#CHSSC    YL0006           Abs Frt Overrid
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,33
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Market Pricing Date USR
      * External date
     C                     Z-ADDVRG2DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9839  *
     C                     END
     C                     Z-ADDXDINDT    #RG2DT
      * Validate OD Price Type USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#RPRMT'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * OD Price Type USR
     C                     MOVEL#RPRMT    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHPRMT
     C                     SELEC
     C           W0INVL    WHEQ 'FRM'                      FRM
     C                     Z-ADD1         ZHPRMT
     C           W0INVL    WHEQ 'CON'                      CON
     C                     Z-ADD2         ZHPRMT
     C           W0INVL    WHEQ 'NEG'                      NEG
     C                     Z-ADD3         ZHPRMT
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHPRMT
     C           W0INVL    WHEQ 'HDG'                      HDG
     C                     Z-ADD5         ZHPRMT
     C           W0INVL    WHEQ 'DST'                      DST
     C                     Z-ADD6         ZHPRMT
     C           W0INVL    WHEQ 'NHT'                      NHT
     C                     Z-ADD7         ZHPRMT
     C           W0INVL    WHEQ 'TNK'                      TNK
     C                     Z-ADD8         ZHPRMT
     C           W0INVL    WHEQ 'FLR'                      FLR
     C                     Z-ADD9         ZHPRMT
     C                     ENDSL
      * Window width
     C                     Z-ADD19        YWWDWD
      * Window depth
     C                     Z-ADD9         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD14        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD65        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
     C                     EXFMTZGPRMT
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHPRMT    WHEQ 1
     C                     MOVEL'FRM'     W0INVL           FRM
     C           ZHPRMT    WHEQ 2
     C                     MOVEL'CON'     W0INVL           CON
     C           ZHPRMT    WHEQ 3
     C                     MOVEL'NEG'     W0INVL           NEG
     C           ZHPRMT    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHPRMT    WHEQ 5
     C                     MOVEL'HDG'     W0INVL           HDG
     C           ZHPRMT    WHEQ 6
     C                     MOVEL'DST'     W0INVL           DST
     C           ZHPRMT    WHEQ 7
     C                     MOVEL'NHT'     W0INVL           NHT
     C           ZHPRMT    WHEQ 8
     C                     MOVEL'TNK'     W0INVL           TNK
     C           ZHPRMT    WHEQ 9
     C                     MOVEL'FLR'     W0INVL           FLR
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #RPRMT
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Date Entered
      * External date
     C                     Z-ADDVRPNDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9841  *
     C                     END
     C                     Z-ADDXDINDT    #RPNDT
      * Price Method Code USR required
     C           #RTKCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9835  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * F4                 PK0519A  10/30/03
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Price Code
      * CASE: PGM.*Cursor field <IS> RCD.Price Code USR
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RUYNX'                   *IF
     C                     Z-ADD*ZERO     YL0022           Price Code
      * Sel Customer Prc Hdr  SL - Customer Price Header  * 
     C                     CALL 'POPOSRR'              90  Sel Customer Pr
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0026  70       Ship To Custome
     C           YL0022    PARM YL0022    WQ0027  60       Price Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Price Code is Entered
     C           YL0022    IFGT *ZERO                      *IF
     C                     Z-ADDYL0022    #RUYNX           Price Code USR
     C                     END                             *FI
     C                     END                             *FI
      * Date Method Code
      * CASE: PGM.*Cursor field <IS> RCD.Date Method Code USR
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RTLCD'                   *IF
      * SEL OMS Mkt Date Only  SR - Market Date Method  * 
     C                     CALL 'PDZZSRR'              90  SEL OMS Mkt Dat
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0028  30       Company Number
     C           #RTLCD    PARM #RTLCD    WQ0029  3        Date Method Cod
     C                     PARM *BLANK    WQ0030 30        Date Method Des
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZZSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9836  *
     C                     END
     C                     END                             *FI
      * Commodity Market Code
      * CASE: PGM.*Cursor field <IS> RCD.Commodity Market Code USR
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RTMCD'                   *IF
      * SEL Commod. Mkts Actve SR - Commodity Markets  * 
     C                     CALL 'PDEDSRR'              90  SEL Commod. Mkt
     C                     PARM *BLANK    W0RTN   7
     C           #RTMCD    PARM #RTMCD    WQ0031  3        Commodity Marke
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9838  *
     C                     END
     C                     END                             *FI
      * Price Method USR
      * CASE: PGM.*Cursor field <IS> RCD.Price Method Code USR
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RTKCD'                   *IF
      * SEL OMS System Only    SR - Price Method Header  * 
     C                     CALL 'PDZSSRR'              90  SEL OMS System
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0032  30       Company Number
     C           #RTKCD    PARM #RTKCD    WQ0033  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9835  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Display Pricing Details
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * DSP Ship Price Details DF - Order Detail Pricing  * 
     C                     CALL 'PDM4DFR'              90  DSP Ship Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0034  30       Company Number
     C                     PARM #1C4NB    WQ0035  70       Order Number
     C                     PARM #1DPNB    WQ0036  30       Order Sequence
     C                     PARM #1UENB    WQ0037  30       Order Secondary
     C                     PARM #2JNCD    WQ0038  2        Order Type_Sale
     C                     PARM #1BKC7    WQ0039  70       Ship To Custome
     C                     PARM WUBRTX    WQ0040 30        Ship To Name
     C                     PARM #1A5DT    WQ0041  70       Requested Ship
     C                     PARM #1GNDT    WQ0042  70       Actual Shipped
     C                     PARM #1HGCD    WQ0043  70       Item Code
     C                     PARM #1AJCD    WQ0044  3        Warehouse Code
     C                     PARM #1AYVA    WQ0045 112       Extended Amount
     C                     PARM #1EXDT    WQ0046  70       Market Pricing
     C                     PARM #1LQCD    WQ0047  3        Commodity Marke
     C                     PARM #1RDCD    WQ0048  3        Date Method Cod
     C                     PARM #1Q7CD    WQ0049  3        Price Method Co
     C                     PARM #1BZPR    WQ0050 114       Price Overage O
     C                     PARM #1L6NB    WQ0051  70       Contract Number
     C                     PARM #1U1ST    WQ0052  1        Price Status
     C                     PARM #1GIDT    WQ0053  70       Pricing Date Us
     C                     PARM #1CRCD    WQ0054  2        U_M_Base Price
     C                     PARM #1AGCD    WQ0055  2        U_M_Ordered
     C                     PARM #1G7NA    WQ0056 30        Order Desc_Line
     C                     PARM #1U0ST    WQ0057  1        Price Audit
     C                     PARM #1RFCD    WQ0058  3        Price Audit Rea
     C                     PARM #1CCQT    WQ0059 112       Quantity Schedu
     C                     PARM #1CBQT    WQ0060 112       Quantity Shippe
     C                     PARM #1AKPR    WQ0061 114       Unit Price
     C                     PARM #1AUPR    WQ0062 114       Unit Price Orde
     C                     PARM #1AVWG    WQ0063 112       Unit Weight Ord
     C                     PARM #1BVTM    WQ0064  60       Price Code
     C                     PARM #1DWPR    WQ0065 114       OD Ceiling Pric
     C                     PARM #1TKDT    WQ0066  70       OD Market Begin
     C                     PARM #1TLDT    WQ0067  70       OD Market Endin
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDM4DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 7=Edit Pricing Details
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Edt OrdDtl Pricing    ER - Order Detail  * 
     C                     CLEARPCRC
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1C4NB    PCC4NB           Order Number
     C                     Z-ADD#1DPNB    PCDPNB           Order Sequence
     C                     Z-ADD#1UENB    PCUENB           Order Secondary
      *
     C                     CALL 'PNQBE1R'              90  Edt OrdDtl Pric
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Order Deta
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: CTL.Header Status is Avail/Alloc/Enter/Hold
     C           #2GWST    IFEQ 'L'                        *IF
     C           #2GWST    OREQ 'A'
     C           #2GWST    OREQ 'E'
     C           #2GWST    OREQ 'H'
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0068  30       Company Number
     C                     PARM #2C4NB    WQ0069  70       Order Number
     C                     PARM P3BKC7    WQ0070  70       Ship To Custome
     C           #PJZVA    PARM #PJZVA    WQ0071 112       Order Value Tot
     C           #PA1WG    PARM *ZERO     WQ0072 112       Order Weight To
     C                     PARM 'PM'      WQ0073  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0074  30       Company Number
     C                     PARM #2C4NB    WQ0075  70       Order Number
     C                     PARM *ZERO     WQ0076  30       Order Sequence
     C                     PARM *ZERO     WQ0077  30       Order Secondary
     C                     PARM 'PM'      WQ0078  3        Pricing Event C
     C           WUJZVA    PARM WUJZVA    WQ0079 112       Order Value Tot
     C           WUA1WG    PARM WUA1WG    WQ0080 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0081  1        Production Hold
     C                     PARM '*NO'     WQ0082  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 9=Edit Deduction/Addition
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Edt Ord Dtl Accr      EF - Order Detail Accrual  * 
     C                     CLEARPDRC
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
     C                     Z-ADD#1DPNB    PDDPNB           Order Sequence
     C                     Z-ADD#1UENB    PDUENB           Order Secondary
      *
     C                     CALL 'PNL9EFR'              90  Edt Ord Dtl Acc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Order Deta
     C                     PARM #1HGCD    WQ0083  70       Item Code
     C                     PARM #1AJCD    WQ0084  3        Warehouse Code
     C                     PARM #1BKC7    WQ0085  70       Ship To Custome
     C                     PARM #2HNNA    WQ0086 20        Ship To City
     C                     PARM #2DBCD    WQ0087  2        Ship To State C
     C                     PARM P3Q2CD    WQ0088  2        Shipping Method
     C                     PARM P3OBST    WQ0089  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNL9EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * R12926 DN 05/17/18-Added c9 to Check Order ABS Freight Rate was C
      * INPUT CHANGE: Price Override; Price Method; Price Code; etc
      * CASE: Price Overg Ovrrd or Price Mthd or Price Cd Chnged
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 ORc8 OR c9
      *   |- c1    : RCD.Price Overage Overrid USR NE RCD.Price Overage O
      *   |- c2    : RCD.Price Method Code USR NE RCD.Price Method Code
      *   |- c3    : RCD.Commodity Market Code USR NE RCD.Commodity Marke
      *   |- c4    : RCD.Price Code NE RCD.Price Code USR
      *   |- c5    : RCD.OD Price Type NE RCD.OD SD Price Method USR
      *   |- c6    : RCD.Market Pricing Date NE RCD.Market Pricing Date U
      *   |- c7    : RCD.Date Method Code USR NE RCD.Date Method Code
      *   |- c8    : RCD.Date Entered NE RCD.Date of Original Entry
      *   |- c9    : PAR.Abs Freight Rate Change? is Yes
      *   '-
     C           #RCLPR    IFNE #1BZPR                     *IF
     C           #RTKCD    ORNE #1Q7CD                     *OR
     C           #RTMCD    ORNE #1LQCD                     *OR
     C           #1BVTM    ORNE #RUYNX                     *OR
     C           #1F7SX    ORNE #RPRMT                     *OR
     C           #1EXDT    ORNE #RG2DT                     *OR
     C           #RTLCD    ORNE #1RDCD                     *OR
     C           #RPNDT    ORNE #1CXDT                     *OR
     C           P6HTSC    OREQ 'Y'                        *OR
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * *-------------------------- Validation ------------------------ *
      * R12926 DN 05/17/18-At Order level, use Absorbed Freight Rate from
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0009           Company Number
     C                     Z-ADD#1BKC7    WL0010           Ship To Custome
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    YL0023    P      Type Code
     C                     Z-ADDWL0012    YN0003           Absorbed Freigh
      * Val Manual Price      RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0013           Company Number
     C                     Z-ADD#1HGCD    WL0014           Item Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0024    P      Description Lin
     C                     MOVELWL0016    YL0025    P      Default Commod
     C                     Z-ADDWL0017    YL0026           Market Overage
     C                     Z-ADDWL0018    YL0027           Standard Overag
     C                     MOVELWL0019    YL0028    P      Commodity Price
     C                     Z-ADDWL0020    YL0029           Std Weight_Head
     C                     MOVELWL0021    YL0030    P      Primal Group Co
      * *** VAL: Price Method Code
      * RTV Prc Mth Typ/Prc TyRT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RTKCD    WL0022    P      Price Method Co
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    YL0031    P      Price Method Ty
     C                     MOVELWL0024    YL0032    P      PMH Price Type
     C                     MOVEL'N'       WUECST           Error Status
      * R12926 DN 05/17/18-At Order level, use Absorbed Freight Rate from
      * Edt OD Pricing Validt IF
     C                     Z-ADD*ZERO     #1ALPR           Unit Price_Cred
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                     CALL 'PNS7XFR'              90  RTV PrcMthTyp/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0090  30       Company Number
     C                     PARM #RTKCD    WQ0091  3        Price Method Co
     C           YL0034    PARM *BLANK    WQ0092  1        Price Method Ty
     C           YL0035    PARM *BLANK    WQ0093  1        PMH Price Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9835  *
     C                     END
      * Rtv Market Dtls OrEnt XF - IP Item Market Details  * 
     C                     CLEARPERC
     C                     Z-ADD#1HGCD    PEHGCD           Item Code
     C                     MOVEL#RTMCD    PELQCD    P      Commodity Marke
      *
     C                     CALL 'PNS1XFR'              90  Rtv Market Dtls
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: IP Item Ma
     C           YL0036    PARM *BLANK    WQ0094  7        Commodity Price
     C           YL0037    PARM *ZERO     WQ0095  94       Market Prem/Ded
     C           YL0038    PARM *BLANK    WQ0096  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9838  *
     C                     END
     C                     MOVEL'N'       YL0033           USR Display 4
      * LCL.Commodity Price Group & LCL.Market Overage
      * CASE: LCL.Record Found USR is Record Found
     C           YL0038    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0037    YL0039           Market Overage
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0028    YL0036           Commodity Price
     C                     Z-ADDYL0026    YL0039           Market Overage
     C                     END                             *FI
      * VAL: Price Method Code
      * CASE: PAR.Price Method Code is Blank
     C           #RTKCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTKCD    ZA0005           Price Method Co
      * Send message 'Value Required (alpha)'
     C                     MOVEL'USR2808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
      * VAL: Price Code
      * CASE: PAR.Price Code is Entered
     C           #RUYNX    IFGT 0                          *IF
      * VAL: Price Code
      * CASE: LCL.Price Method Type is Not Contract
     C           YL0034    IFEQ 'X'                        *IF
     C           YL0034    OREQ 'F'
     C           YL0034    OREQ 'M'
     C           YL0034    OREQ 'K'
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RUYNX    ZA0006           Price Code
     C                     MOVEL#RTKCD    ZA0007           Price Method Co
      * Send message 'Price Code Inv for Mthd'
     C                     MOVEL'USR4338' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983735*
      *
      * CASE: PAR.USR Display 4 is No
     C           YL0033    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0033           USR Display 4
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Cust Prc Str/End  XF - Customer Price Header  * 
     C                     CALL 'PNTAXFR'              90  Rtv Cust Prc St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0097  70       Ship To Custome
     C                     PARM #RUYNX    WQ0098  60       Price Code
     C           YL0040    PARM *ZERO     WQ0099  70       Price Start Dat
     C           YL0041    PARM *ZERO     WQ0100  70       Price End Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9837  *
     C                     END
      * CASE: LCL.Price Start Date is Not Entered
     C           YL0040    IFEQ 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RUYNX    ZA0008           Price Code
      * Send message 'Price Code not val f/cust'
     C                     MOVEL'USR3318' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL: Contract Start & End Date
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Scheduled Ship Date LT LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date GT LCL.Price End Date
      *   '-
     C           #1AODT    IFLT YL0040                     *IF
     C           #1AODT    ORGT YL0041                     *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RUYNX    ZA0009           Price Code
      * Send message 'Price Code not val dt rng'
     C                     MOVEL'USR3317' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     END                             *FI
      * Rtv Max Wt and price  XF - Customer Price Detail  * 
     C                     CALL 'PNTBXFR'              90  Rtv Max Wt and
     C                     PARM *BLANK    W0RTN   7
     C           W0RTN     PARM *BLANK    WQ0101  7        *Return code
     C                     PARM #1BKC7    WQ0102  70       Ship To Custome
     C                     PARM #RUYNX    WQ0103  60       Price Code
     C                     PARM #1HGCD    WQ0104  70       Item Code
     C           YL0042    PARM *ZERO     WQ0105 112       Maximum Contrac
     C           YL0043    PARM *ZERO     WQ0106 114       Customer Price_
     C           YL0044    PARM *BLANK    WQ0107  3        Commodity Marke
     C           YL0045    PARM *BLANK    WQ0108  3        Price Method Co
     C           YL0046    PARM *BLANK    WQ0109  3        Date Method Cod
     C           YL0047    PARM *BLANK    WQ0110  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9837  *
     C                     END
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RUYNX    ZA0010           Price Code
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code not val f/item'
     C                     MOVEL'USR3319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Sum weights shipped/ordered for ship to /price code
      *
     C                     Z-ADD*ZERO     WN0216 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0217 112       Total Quantity
     C                     Z-ADD*ZERO     WN0218 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0219 114       Customer Price_
     C                     MOVEL*BLANK    WN0220  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       WUECST           Error Status
     C           #1AVQT    MULT #1AVWG    YL0048           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPFRC
     C                     Z-ADD#1BKC7    PFBKC7           Ship To Custome
     C                     Z-ADD#RUYNX    PFBVTM           Price Code
     C                     Z-ADD#1HGCD    PFHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Order Deta
     C           WN0216    PARM WN0216    WQ0111 112       Total Weight Or
     C                     PARM #1C4NB    WQ0112  70       Order Number
     C           WN0217    PARM WN0217    WQ0113 112       Total Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9837  *
     C                     END
     C                     ADD  YL0048    WN0216           Total Weight Or
     C                     ADD  #1AVQT    WN0217           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0114  70       Ship To Custome
     C                     PARM #RUYNX    WQ0115  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0116  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0117  70       Price End Date
     C                     PARM #1HGCD    WQ0118  70       Item Code
     C           WN0218    PARM *ZERO     WQ0119 112       Maximum Contrac
     C           WN0219    PARM *ZERO     WQ0120 114       Customer Price_
     C           #RTMCD    PARM *BLANK    WQ0121  3        Commodity Marke
     C           YL0049    PARM *BLANK    WQ0122  3        Price Method Co
     C           #RTLCD    PARM *BLANK    WQ0123  3        Date Method Cod
     C           WN0220    PARM *BLANK    WQ0124  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983738*
     C                     SETON                     36    *
     C                     END
     C                     MOVELYL0049    #RTKCD           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     MOVELYL0049    WL0026    P      Price Method Co
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    YL0034    P      Price Method Ty
     C                     MOVELWL0028    YL0035    P      PMH Price Type
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0220    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0216    IFGT WN0218                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0216    SUB  WN0218    YL0050           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#RUYNX    ZA0012           Price Code
     C                     Z-ADDYL0050    ZA0013           Weight Allocate
     C                     Z-ADDWN0218    ZA0014           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0015           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0015           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0217    IFGT WN0218                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0217    SUB  WN0218    YL0050           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#RUYNX    ZA0016           Price Code
     C                     Z-ADDYL0050    ZA0017           Weight Allocate
     C                     Z-ADDWN0218    ZA0018           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0019           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0019           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     Z-ADDWN0219    #RCLPR           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0035    IFEQ 'I'                        *IF
     C                     Z-ADDWN0219    #RCLPR           Price Overage O
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0035    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     #RCLPR           Price Overage O
     C                     Z-ADDWN0219    #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL: Price Code Required
      * CASE: LCL.Price Method Type is Contract Pricing
     C           YL0034    IFEQ 'Q'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTKCD    ZA0020           Price Method Co
     C                     Z-ADD#RUYNX    ZA0021           Price Code
      * Send message 'Price code req for mthd'
     C                     MOVEL'USR3316' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983537*
      *
      * CASE: PAR.USR Display 4 is No
     C           YL0033    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0033           USR Display 4
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Market Price Date/Range
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RG2DT    IFNE 0                          *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #RG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0023
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0024
      * Send message 'Market Date/Range ERR'
     C                     MOVEL'USR4331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C           #1TKDT    IFGT #1TLDT                     *IF
      * CASE: PAR.OD Market Ending Date is not entered
     C           #1TLDT    IFEQ 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0025
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0026
      * Send message 'Date Range Invalid'
     C                     MOVEL'USR4332' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Published
      * CASE: LCL.Price Method Type is Published Pricing
     C           YL0034    IFEQ 'P'                        *IF
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #RCLPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RCLPR    ZA0027           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     MOVEL'SBD'     #RTMCD           Commodity Marke
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #RTLCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTLCD    ZA0028           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0029           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c2 OR c3
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0030
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0031
     C                     MOVEL#RTKCD    ZA0032           Price Method Co
      * Send message 'Prc Date Range Inv'
     C                     MOVEL'USR4344' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Manual/Extended
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c3    : LCL.Price Method Type is Extended Pricing
      *   '-
     C           YL0034    IFEQ 'M'                        *IF
     C           YL0034    OREQ 'X'                        *OR
      * VAL: Price Overage Override for Price Method Type=Extended
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override is Equal zero
      *   |- c2    : LCL.Price Method Type is Extended Pricing
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RCLPR    IFEQ 0                          *IF
     C           YL0034    IFEQ 'X'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RCLPR    ZA0033           Price Overage O
      * Send message 'Price Override Required'
     C                     MOVEL'USR1805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Entered
     C           #RTMCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTMCD    ZA0034           Commodity Marke
      * Send message 'Market Code not allowed'
     C                     MOVEL'USR1809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #RTLCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTLCD    ZA0035           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0036           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #RG2DT    IFNE 0                          *IF
     C           #1TKDT    ORNE 0                          *OR
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #RG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0037
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0038
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0039
     C                     MOVEL#RTKCD    ZA0040           Price Method Co
      * Send message 'Prc Dts = 0 f/Prc Mth'
     C                     MOVEL'USR4339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983935*
      *
     C                     END                             *FI
      * VAL: Manual Pricing
      * CASE: LCL.Price Method Type is Manual Pricing
     C           YL0034    IFEQ 'M'                        *IF
      * VAL: Manual Price Range
      * CASE: PAR.Billing Activity Type is Not Warehouse Transfer
     C           P3OBST    IFEQ '2'                        *IF
     C           P3OBST    OREQ '3'
     C           P3OBST    OREQ '1'
      * CASE: PAR.Primal Group Code is NE Samples or Cut Loss
     C           YL0030    IFNE 'UNID'                     *IF
      * RMC S14013 remove chk for type n= Promo/Samples- we want them val
      *
     C                     Z-ADD*ZERO     WN0221  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0222  52       CoPk_FdSrv ManP
     C                     Z-ADD*ZERO     WN0223  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0224 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     YL0051           Projected Marke
     C                     Z-ADD*ZERO     YL0053           Minimum Price
     C                     Z-ADD*ZERO     YL0054           Maximum Price
     C                     MOVEL'Y'       YL0052           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0029           Company Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0030    WN0221           Manual Price Ac
     C                     Z-ADDWL0031    WN0222           CoPk_FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           YL0025    IFEQ 'FSV'                      *IF
     C           YL0025    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0222    WN0221           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RTMCD    WL0032    P      Commodity Marke
     C                     MOVELYL0036    WL0033    P      Commodity Price
     C                     Z-ADD9999999   WL0034           Market Price Da
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0035    YL0051           Commodity Marke
     C                     Z-ADDWL0036    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0051    ADD  YL0039    W0WB01           *Synon (15,5) w
     C           #CTBNB    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0051           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0221    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0051    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0053           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0221    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0051    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0054           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RCLPR    IFGE YL0053                     *IF
     C           #RCLPR    IFLE YL0054                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0052           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0025    WL0032    P      Commodity Marke
     C                     MOVELYL0036    WL0033    P      Commodity Price
     C                     Z-ADD9999999   WL0034           Market Price Da
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0035    YL0051           Commodity Marke
     C                     Z-ADDWL0036    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0221    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0051    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0053           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0221    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0051    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0054           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RCLPR    IFGE YL0053                     *IF
     C           #RCLPR    IFLE YL0054                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0052           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0051           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0051    #1ALPR           Unit Price_Cred
     C                     END                             *FI
      * CASE: LCL.Error Status  3 is Yes
     C           YL0052    IFEQ 'Y'                        *IF
      * CASE: LCL.Projected Market Price is Not Zeros
     C           YL0051    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#RCLPR    ZA0041           Price Overage O
      * Send message 'Manual price within Prcnt'
     C                     MOVEL'USR2351' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RCLPR    ZA0042           Price Overage O
     C                     MOVEL#RTMCD    ZA0043           Commodity Marke
     C                     MOVELYL0028    ZA0044           Commodity Price
      * Send message 'No Mkt Prc Found for test'
     C                     MOVEL'USR2353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983438*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Contract
      * CASE: LCL.Price Method Type is Contract Pricing
     C           YL0034    IFEQ 'Q'                        *IF
      * VAL: Commodity Market Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Commodity Market Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RTMCD    IFNE *BLANK                     *IF
     C           YL0035    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTMCD    ZA0045           Commodity Marke
      * Send message 'Market Code not allowed'
     C                     MOVEL'USR1809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RTLCD    IFNE *BLANK                     *IF
     C           YL0035    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTLCD    ZA0046           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: LCL.PMH Price Type is Invoice Price
     C           YL0035    IFEQ 'I'                        *IF
      * ERR: Ceiling Price not allowed
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0047           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ERR: Ceiling Price Required
      * CASE: PAR.OD Ceiling Price is Equal zero
     C           #1DWPR    IFEQ 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0048           OD Ceiling Pric
      * Send message 'Ceiling Price Required'
     C                     MOVEL'USR4340' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     Z-ADD#1DWPR    #1ALPR           Unit Price_Cred
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #RG2DT    IFNE 0                          *IF
     C           #1TKDT    ORNE 0                          *OR
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #RG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0049
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0050
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0051
     C                     MOVEL#RTKCD    ZA0052           Price Method Co
      * Send message 'Prc Dts = 0 f/Prc Mth'
     C                     MOVEL'USR4339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983935*
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Market/Formula
      * CASE: LCL.Price Method Type is Market or Formula
     C           YL0034    IFEQ 'F'                        *IF
     C           YL0034    OREQ 'K'
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #RCLPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RCLPR    ZA0053           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Not Entered
     C           #RTMCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTMCD    ZA0054           Commodity Marke
      * Send message 'Market Code must be enter'
     C                     MOVEL'USR1750' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #RTLCD    IFNE *BLANK                     *IF
      * VAL Date Method Exists RT - Market Date Method  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0037           Company Number
     C                     MOVEL#RTLCD    WL0038    P      Date Method Cod
     C                     MOVEL'O'       WL0040    P      System using Da
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YN0004    P      Date Method Des
      * ERR: Date Method Code Invalid
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTLCD    ZA0055           Date Method Cod
      * Send message 'Market Date Method Inval.'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ERR: Date Method Entered & Market Price Date/Range Entered
      * CASE:
      *  - (c1 AND c2) OR (c1 AND c3 AND c4)
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   |- c3    : PAR.OD Market Begin Date is Entered
      *   |- c4    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RTLCD    IFNE *BLANK                     *IF
     C           #RG2DT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #RTLCD    IFNE *BLANK                     *IF
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #RG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0056
     C                     MOVEL#RTLCD    ZA0057           Date Method Cod
      * Send message 'Date Meth & Prc Dat N/A'
     C                     MOVEL'USR2097' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983936*
      *
     C                     END                             *FI
      * ERR: Date Method = Blank and Market Price Date/Rage = Zero
      * CASE: (No Market Dates Entered)
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : PAR.Date Method Code is Not Entered
      *   |- c2    : PAR.Market Pricing Date is EQ Zero
      *   |- c3    : PAR.OD Market Begin Date is not entered
      *   |- c4    : PAR.OD Market Ending Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RTLCD    IFEQ *BLANK                     *IF
     C           #RG2DT    IFEQ 0                          *IF
     C           #1TKDT    IFEQ 0                          *IF
     C           #1TLDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTLCD    ZA0058           Date Method Cod
      * Send message 'Market Date Method Inval.'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * ERR: Market Price Date & Market Price Date Range Entered
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RG2DT    IFNE 0                          *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #RG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0059
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0060
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0061
      * Send message 'Market Date/Range ERR'
     C                     MOVEL'USR4331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
      * ERR: Market Price Begin Date > Market Price Ending Date
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C           #1TKDT    IFGT #1TLDT                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0062
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0063
      * Send message 'Date Range Invalid'
     C                     MOVEL'USR4332' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RTMCD    WL0041    P      Commodity Marke
     C                     MOVELYL0036    WL0042    P      Commodity Price
     C                     EXSR SURVGN
      * VAL: Commodity Market Price Exists
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C           #RTMCD    IFNE YL0025                     *IF
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0025    WL0041    P      Commodity Marke
     C                     MOVELYL0036    WL0042    P      Commodity Price
     C                     EXSR SURVGN
      * Use Company Item
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTMCD    ZA0064           Commodity Marke
     C                     MOVELYL0036    ZA0065           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#RTMCD    ZA0066           Commodity Marke
     C                     MOVELYL0036    ZA0067           Commodity Price
     C                     MOVELYL0025    ZA0068           Default Commod
      * Send message 'No Price Mkt/Group Deflt'
     C                     MOVEL'USR2350' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#RTMCD    ZA0069           Commodity Marke
     C                     MOVELYL0036    ZA0070           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *---------------------------------------------------------------*
      * VAL: Signal Demand Price Method Required
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.SD Price Type Req STS USR is yes
      *   |- c2    : PAR.Order Type - Sales is Regular Order
      *   |- c3    : RCD.OD Price Type USR is *NONE
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5        IFEQ 'Y'                        *IF
     C           P3JNCD    IFEQ 'OR'                       *IF
     C           #RPRMT    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#RPRMT    ZA0071           OD Price Type U
      * Send message 'OD Price Type Req'
     C                     MOVEL'USR3952' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9840  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
      * CASE: CTL.Header Status is Avail/Alloc/Enter/Hold
     C           #2GWST    IFEQ 'L'                        *IF
     C           #2GWST    OREQ 'A'
     C           #2GWST    OREQ 'E'
     C           #2GWST    OREQ 'H'
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0125  30       Company Number
     C                     PARM #2C4NB    WQ0126  70       Order Number
     C                     PARM P3BKC7    WQ0127  70       Ship To Custome
     C           #PJZVA    PARM #PJZVA    WQ0128 112       Order Value Tot
     C           #PA1WG    PARM *ZERO     WQ0129 112       Order Weight To
     C                     PARM 'PM'      WQ0130  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0131  30       Company Number
     C                     PARM #2C4NB    WQ0132  70       Order Number
     C                     PARM *ZERO     WQ0133  30       Order Sequence
     C                     PARM *ZERO     WQ0134  30       Order Secondary
     C                     PARM 'PM'      WQ0135  3        Pricing Event C
     C           WUJZVA    PARM WUJZVA    WQ0136 112       Order Value Tot
     C           WUA1WG    PARM WUA1WG    WQ0137 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0138  1        Production Hold
     C                     PARM '*NO'     WQ0139  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,33
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Price Override Or Price Method Changed
      * CASE: Price Overage Override or Price Method Changed
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : RCD.Price Overage Overrid USR NE RCD.Price Overage O
      *   |- c2    : RCD.Price Method Code USR NE RCD.Price Method Code
      *   |- c3    : RCD.Commodity Market Code USR NE RCD.Commodity Marke
      *   |- c4    : RCD.Price Code USR NE RCD.Price Code
      *   |- c5    : RCD.OD Price Type USR NE RCD.OD Price Type
      *   |- c6    : RCD.Market Pricing Date USR NE RCD.Market Pricing Da
      *   |- c7    : RCD.Date Entered NE RCD.Date of Original Entry
      *   '-
     C           #RCLPR    IFNE #1BZPR                     *IF
     C           #RTKCD    ORNE #1Q7CD                     *OR
     C           #RTMCD    ORNE #1LQCD                     *OR
     C           #RUYNX    ORNE #1BVTM                     *OR
     C           #RPRMT    ORNE #1F7SX                     *OR
     C           #RG2DT    ORNE #1EXDT                     *OR
     C           #RPNDT    ORNE #1CXDT                     *OR
     C                     Z-ADD#1AKPR    #RDBPR           Unit Price Last
     C                     MOVEL#1U1ST    #RPSTL           Price Status La
     C                     Z-ADD#1AYVA    #RYJVA           Extended Amount
      * CLC Pricing using File XF - Order Detail Pricing  * 
     C                     CALL 'PDOJXFR'              90  CLC Pricing usi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0140  30       Company Number
     C                     PARM #1C4NB    WQ0141  70       Order Number
     C                     PARM #1DPNB    WQ0142  30       Order Sequence
     C                     PARM #1UENB    WQ0143  30       Order Secondary
     C                     PARM YL0055    WQ0144  30       Price Detail Se
     C                     PARM #1HGCD    WQ0145  70       Item Code
     C                     PARM #1Q7CD    WQ0146  3        Price Method Co
     C                     PARM #1AGCD    WQ0147  2        U_M_Ordered
     C           #1AKPR    PARM #1AKPR    WQ0148 114       Unit Price
     C           #1ALPR    PARM #1ALPR    WQ0149 114       Unit Price_Cred
     C           #1AUPR    PARM #1AUPR    WQ0150 114       Unit Price Orde
     C                     PARM '02'      WQ0151  2        Event Called Fr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *---*
     C                     Z-ADD#RCLPR    #1BZPR           Price Overage O
     C                     MOVEL#RTKCD    #1Q7CD           Price Method Co
     C                     MOVEL#RTMCD    #1LQCD           Commodity Marke
     C                     Z-ADD#RUYNX    #1BVTM           Price Code
     C                     MOVEL#RPRMT    #1F7SX           OD Price Type
     C                     Z-ADD#RG2DT    #1EXDT           Market Pricing
     C                     MOVEL#RTLCD    #1RDCD           Date Method Cod
      * Control:  Price Override
      * CASE: RCD.Price Method Code USR is Deviated
     C           #RTKCD    IFEQ 'DEV'                      *IF
     C                     MOVEL'N'       #RASTS           USR Display 3
     C                     END                             *FI
      * *---*
      *
     C                     MOVEL*BLANK    WN0225  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0226 112       Unit Weight
     C                     MOVEL*BLANK    WN0227  1        Catch Weight St
     C                     MOVEL*BLANK    WN0228  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0229 114       Price per Pound
     C                     Z-ADD*ZERO     WN0230 112       USR Quantity
     C                     Z-ADD*ZERO     WN0231 112       USR Weight
      *
      * CLC Price,Ext,U/M1Prc  IF
      * *****************************************************************
      * Calculate "Price Per Pound", "Extended Amount", "Primary U/M Pric
      * *****************************************************************
     C                     Z-ADD*ZERO     WN0226           Unit Weight
     C                     MOVEL*BLANK    WN0225           UOM Pricing
     C                     MOVEL*BLANK    WN0227           Catch Weight St
      * Load Quantity Shipped Total field. c2742- do -0- shipped from ord
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           #1CBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1CBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status  c2742 -0- shpe
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GMST    IFEQ 'L'                        *IF
     C           #1GMST    OREQ 'A'
     C           #1GMST    OREQ 'E'
     C           #1GMST    OREQ 'H'
     C           #1JPCD    IFGE '01'                       *IF
     C           #1JPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADD#1AVQT    WN0230           USR Quantity
     C                     Z-ADD#1D0WG    WN0231           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0230           USR Quantity
     C                     Z-ADD#1ATWG    WN0231           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0152  30       Company Number
     C                     PARM #1HGCD    WQ0153  70       Item Code
     C           WN0225    PARM *BLANK    WQ0154  2        UOM Pricing
     C           WN0226    PARM *ZERO     WQ0155 112       Unit Weight
     C           WN0227    PARM *BLANK    WQ0156  1        Catch Weight St
     C           WN0228    PARM *BLANK    WQ0157  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Check retrieve Unit Weight & C/W error
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Catch Weight Status is Y/N Values
      *   |- c3    : PAR.Unit Weight is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WN0227    IFEQ 'N'                        *IF
     C           WN0227    OREQ 'Y'
     C           WN0226    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           *ZERO     IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL*ZERO     WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0072           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0072           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZA0073           Order Sequence
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0074           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0074           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWN0227    ZA0075           Catch Weight St
     C                     Z-ADD*ZERO     ZA0076           Unit Price
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     98    *
     C                     END
      *
     C                     END                             *FI
      * CASE: PAR.Price Method Code is Extended
     C           #1Q7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADD#1BZPR    #1AYVA           Extended Amount
      * Calculate Unit Price for Extended
      * CASE: PAR.USR Weight is Not equal zero
     C           WN0231    IFNE 0                          *IF
     C           #1AYVA    DIV  WN0231    #1AKPR    H      Unit Price
     C                     END                             *FI
      * Calculate Pricing U/M Price for Extended
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0230    IFNE 0                          *IF
     C           #1AYVA    DIV  WN0230    #1AUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   |- c3    : PAR.Unit Price - Credit is Not Zeros
      *   |- c5    : PAR.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GMST    IFEQ 'L'                        *IF
     C           #1GMST    OREQ 'A'
     C           #1GMST    OREQ 'E'
     C           #1GMST    OREQ 'H'
     C           #1JPCD    IFGE '01'                       *IF
     C           #1JPCD    ANDLE'03'
     C           #1ALPR    IFNE 0                          *IF
     C           #1U0ST    IFEQ 'A'                        *IF
     C           #1U0ST    OREQ 'N'
     C           #1U0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced w/consideration for .01 manual price
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: PAR.Price Method Code is Deviated
     C           #1Q7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1AYVA    PARM *ZERO     WQ0158 112       Extended Amount
     C                     PARM WN0225    WQ0159  2        U_M_Base Price
     C                     PARM WN0230    WQ0160 112       Quantity Shippe
     C                     PARM WN0231    WQ0161 112       Weight Shipped
     C                     PARM #1BZPR    WQ0162 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Q7CD    IFEQ 'MAN'                      *IF
     C           YL0002    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1AYVA    PARM *ZERO     WQ0163 112       Extended Amount
     C                     PARM WN0225    WQ0164  2        U_M_Base Price
     C                     PARM WN0230    WQ0165 112       Quantity Shippe
     C                     PARM WN0231    WQ0166 112       Weight Shipped
     C                     PARM #1BZPR    WQ0167 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Q7CD    IFEQ 'MAN'                      *IF
     C           YL0002    IFEQ 'D'                        *IF
     C           YL0002    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : PAR.Price Overage Override is GT .01
      *   '-
     C           YL0023    IFEQ 'IC'                       *IF
     C           YL0023    OREQ 'PS'                       *OR
     C           WN0228    OREQ 'UNID'                     *OR
     C           WN0228    OREQ 'OTHER'                    *OR
     C           #1BZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1AYVA    PARM *ZERO     WQ0168 112       Extended Amount
     C                     PARM WN0225    WQ0169  2        U_M_Base Price
     C                     PARM WN0230    WQ0170 112       Quantity Shippe
     C                     PARM WN0231    WQ0171 112       Weight Shipped
     C                     PARM #1BZPR    WQ0172 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1AYVA    PARM *ZERO     WQ0173 112       Extended Amount
     C                     PARM WN0225    WQ0174  2        U_M_Base Price
     C                     PARM WN0230    WQ0175 112       Quantity Shippe
     C                     PARM WN0231    WQ0176 112       Weight Shipped
     C                     PARM #1ALPR    WQ0177 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1AYVA    PARM *ZERO     WQ0178 112       Extended Amount
     C                     PARM WN0225    WQ0179  2        U_M_Base Price
     C                     PARM WN0230    WQ0180 112       Quantity Shippe
     C                     PARM WN0231    WQ0181 112       Weight Shipped
     C                     PARM #1ALPR    WQ0182 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * ** Added Not .01 to force these orders to use Credit Chk Price.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Price is Not Zeros
      *   |- c2    : PAR.Unit Price is Not .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AKPR    IFNE 0                          *IF
     C           #1AKPR    IFNE .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1AYVA    PARM *ZERO     WQ0183 112       Extended Amount
     C                     PARM WN0225    WQ0184  2        U_M_Base Price
     C                     PARM WN0230    WQ0185 112       Quantity Shippe
     C                     PARM WN0231    WQ0186 112       Weight Shipped
     C                     PARM #1AKPR    WQ0187 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Unit Price Ordered U/M
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0230    IFNE 0                          *IF
     C           #1AYVA    DIV  WN0230    #1AUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1AYVA    PARM *ZERO     WQ0188 112       Extended Amount
     C                     PARM WN0225    WQ0189  2        U_M_Base Price
     C                     PARM WN0230    WQ0190 112       Quantity Shippe
     C                     PARM WN0231    WQ0191 112       Weight Shipped
     C                     PARM #1ALPR    WQ0192 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * CHG OM Price Maint     CH - Order Detail  * 
     C                     EXSR SVCHRC
      * CHG Ord  Prt,Prc Sts   CH - Order Header TRG  * 
     C                     EXSR SWCHRC
      * If price status or unit price changes write to log
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Price Status NE RCD.Price Status Last
      *   |- c2    : RCD.Unit Price NE RCD.Unit Price Last
      *   '-
     C           #1U1ST    IFNE #RPSTL                     *IF
     C           #1AKPR    ORNE #RDBPR                     *OR
      * RTV Next Audit Seq #   RT - Price Change Audit Log  * 
     C                     EXSR SXRVGN
      * CRT Price Change Audit CR - Price Change Audit Log  * 
     C                     EXSR SYCRRC
     C                     END                             *FI
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0200  30       Company Number
     C                     PARM #1C4NB    WQ0201  70       Order Number
     C                     PARM #1DPNB    WQ0202  30       Order Sequence
     C                     PARM #1UENB    WQ0203  30       Order Secondary
     C                     PARM 'PM'      WQ0204  3        Pricing Event C
     C           WUB5VL    PARM WUB5VL    WQ0205 112       Order Value Tot
     C           WUA1WG    PARM WUA1WG    WQ0206 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0207  1        Production Hold
     C                     PARM '*NO'     WQ0208  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *----------------------------------------------------------------
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0209  30       Company Number
     C                     PARM #1C4NB    WQ0210  70       Order Number
     C           P3JZVA    PARM P3JZVA    WQ0211 112       USR Order Value
     C           P3A1WG    PARM P3A1WG    WQ0212 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0213  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0214  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Update conrol values if total or weight changed
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Value Total NE CTL.Order Value Total
      *   |- c2    : PAR.Order Weight Total NE CTL.Order Weight Total
      *   '-
     C           P3JZVA    IFNE #PJZVA                     *IF
     C           P3A1WG    ORNE #PA1WG                     *OR
     C                     Z-ADDP3JZVA    #PJZVA           Order Value Tot
     C                     Z-ADDP3A1WG    #PA1WG           Order Weight To
     C                     END                             *FI
     C                     END                             *FI
      * RMC 4/25/23 comment the below
      * RMC 3/30/22 added here too..also in subfile build
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN75
     C           #RPFTX    IFNE *BLANK                     *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #RHLSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           #RASTS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0002    IFEQ 'D'                        *IF
     C           YL0002    OREQ 'S'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #CLMNY    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0003    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #CG5TX    IFNE *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKAE fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     Z-ADDOMALPR    #1ALPR           Unit Price_Cred
     C                     MOVELOMAGCD    #1AGCD           U_M_Ordered
     C                     MOVELOMG7NA    #1G7NA           Order Desc_Line
     C                     MOVELOMG8NA    #1G8NA           Order Desc_Line
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over_Short
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOMNXDT    #1NXDT           OD Firm Date
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate_Fina
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate_Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    #1DZPR           OD Original Ord
     C                     Z-ADDOMGSPR    #1GSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH2ST    #1H2ST           OD Spot Buy
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     MOVELOMCRCD    #1CRCD           U_M_Base Price
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
     C                     MOVEL*BLANK    #RHLSX           Reverse Image F
     C                     Z-ADD*ZERO     #RDBPR           Unit Price Last
     C                     MOVEL*BLANK    #RASTS           USR Display 3
     C                     MOVEL*BLANK    #RHDGD           OD Hedged Price
     C                     Z-ADD*ZERO     #RYJVA           Extended Amount
     C                     MOVEL*BLANK    #RPSTL           Price Status La
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RGLST           Deduct/Add Sts
     C                     Z-ADD*ZERO     #RCLPR           Price Overage O
     C                     MOVEL*BLANK    #RPFTX           Text 1 Length U
     C                     MOVEL*BLANK    #RTKCD           Price Method Co
     C                     MOVEL*BLANK    #RTLCD           Date Method Cod
     C                     Z-ADD*ZERO     #RUYNX           Price Code USR
     C                     MOVEL*BLANK    #RTMCD           Commodity Marke
     C                     Z-ADD*ZERO     #RG2DT           Market Pricing
      * Clear external version also
     C                     Z-ADD*ZERO     VRG2DT
     C                     MOVEL*BLANK    #RPRMT           OD Price Type U
     C                     MOVEL*BLANK    #RGENA           Item Descriptio
     C                     Z-ADD*ZERO     #RPNDT           Date Entered
      * Clear external version also
     C                     Z-ADD*ZERO     VRPNDT
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVELP3GWST    #2GWST           Header Status
     C                     MOVELP3JNCD    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     Z-ADD*ZERO     #CQMNY           OHE Orig ABS Fr
     C                     MOVEL*BLANK    #2GMST           Detail Line Sta
     C                     MOVEL*BLANK    #2JPCD           Event Code
     C                     Z-ADD*ZERO     #2DPNB           Order Sequence
     C                     Z-ADD*ZERO     #2UENB           Order Secondary
     C                     MOVEL*BLANK    #2G7NA           Order Desc_Line
     C                     MOVEL*BLANK    #CGENA           Item Descriptio
     C                     MOVEL*BLANK    #2Q7CD           Price Method Co
     C                     MOVEL*BLANK    #2LQCD           Commodity Marke
     C                     MOVEL*BLANK    #2F3SX           Released by Use
     C                     MOVEL*BLANK    #CQ1ST           Status Flag 1
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADDP3JZVA    #PJZVA           Order Value Tot
     C                     Z-ADD*ZERO     #CF9DT           Actual Ship Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VCF9DT
     C                     Z-ADD*ZERO     #CP4NY           HPB Equivalence
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     Z-ADDP3A1WG    #PA1WG           Order Weight To
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCHODT
     C                     Z-ADD*ZERO     #CFMPR           Price 5.2 USR
     C                     MOVEL*BLANK    #CBCNA           Customer Purcha
     C                     Z-ADD*ZERO     #CA0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCA0DT
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2A5DT
     C                     MOVEL*BLANK    #CCHTX           OHE Override Ty
     C                     Z-ADD*ZERO     #CTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #CLMNY           Absorbed Freigh
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     MOVEL*BLANK    #CHSSC           Abs Frt Overrid
     C                     MOVEL*BLANK    #CG5TX           Text 1 USR
     C                     Z-ADD*ZERO     #2HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V2HGCD
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     MOVEL*BLANK    #CGLST           Deduct/Add Sts
     C                     Z-ADD*ZERO     #CCLPR           Price Overage O
     C                     MOVEL*BLANK    #CTKCD           Price Method Co
     C                     MOVEL*BLANK    #CTLCD           Date Method Cod
     C                     Z-ADD*ZERO     #CUYNX           Price Code USR
     C                     MOVEL*BLANK    #CTMCD           Commodity Marke
     C                     Z-ADD*ZERO     #CG2DT           Market Pricing
      * Clear external version also
     C                     Z-ADD*ZERO     VCG2DT
     C                     MOVEL*BLANK    #2F7SX           OD Price Type
     C                     Z-ADD*ZERO     #2AKPR           Unit Price
     C                     MOVEL*BLANK    #2CRCD           U_M_Base Price
     C                     Z-ADD*ZERO     #2AUPR           Unit Price Orde
     C                     Z-ADD*ZERO     #2ATWG           Weight Shipped
     C                     Z-ADD*ZERO     #2AYVA           Extended Amount
     C                     MOVEL*BLANK    #2U1ST           Price Status
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Market Pricing Date USR to display format
      * Convert date
     C           1000000   ADD  #RG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRG2DT
      * Convert Date Entered to display format
      * Convert date
     C           1000000   ADD  #RPNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRPNDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  #CF9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCF9DT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCHODT
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #CA0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCA0DT
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #2A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2A5DT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Market Pricing Date USR to display format
      * Convert date
     C           1000000   ADD  #CG2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCG2DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Val Price Type Entry  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0003           Record Found -O
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
     C                     Z-ADDWL0002    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@BGWKL1                    *
     C           KRSSA     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WAGMST    IFEQ 'L'                        *IF
     C           WAGMST    OREQ 'A'
     C           WAGMST    OREQ 'C'
     C           WAGMST    OREQ 'R'
     C           WAGMST    OREQ 'E'
     C           WAGMST    OREQ 'H'
     C           WAGMST    OREQ 'I'
      * CASE: DB1.OD Price Type is *NONE
     C           WAF7SX    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WL0003           Record Found -O
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Company Organiz
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYJSX    YL0002           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Discounts Exist   RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0003           Discounts Exist
      * Establish starting position
     C           *LOVAL    SETLL@HLRELX                    *
     C                     READ @HLRELX                  90*
      * Data record not found
     C   90                MOVEL'USR1514' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Accrual Type is Discount/Allowance
     C           HLOKCD    IFEQ 'DA'                       *IF
      * Rtv Discount Exists   RT - Customer Accrual  * 
     C                     EXSR SDRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0003           Discounts Exist
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Accrual Type is Product Discount
     C           HLOKCD    IFEQ 'PD'                       *IF
      * Rtv Discounts Exist   RT - Accrual Prod Pgm  * 
     C                     EXSR SERVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0003           Discounts Exist
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @HLRELX                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Discount Exists   RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0004           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN HOBKC7    WQSD01           Ship To Custome
     C           *LIKE     DEFN HOOJCD    WQSD02           Accrual Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Ship To Custome
     C                     KFLD           WQSD02           Accrual Code
      * Setup key
     C                     Z-ADDP3BKC7    WQSD01           Ship To Custome
     C                     MOVELHLOJCD    WQSD02           Accrual Code
      * Establish starting position
     C           KRSSD     SETLL@HORELA                    *
     C           KRSSD     READE@HORELA                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.Period Beginning Date
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3AODT    IFGE HOBFDT                     *IF
     C           P3AODT    IFLE HOA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0004           Record Found US
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Discounts Exist   RT - Accrual Prod Pgm  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0004           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN D2OJCD    WQSE01           Accrual Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Accrual Code
      * Setup key
     C                     MOVELHLOJCD    WQSE01           Accrual Code
      * Establish starting position
     C           KRSSE     SETLL@D2RET9                    *
     C           KRSSE     READE@D2RET9                  90*
      * Data record not found
     C   90                MOVEL'USR3972' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.AD Period Beginning D
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.AD Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3AODT    IFGE D2SCDT                     *IF
     C           P3AODT    IFLE D2SDDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHECK: All Customers
      * CASE: DB1.AD All Customers is yes
     C           D2EWST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0004           Record Found US
     C                     GOTO SEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Discount Exists   RT - Accrual Prod Pgm Cust  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0005    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0004           Record Found US
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@D2RET9                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Discount Exists   RT - Accrual Prod Pgm Cust  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FJOJCD           Accrual Code
     C                     KFLD           FJMSNY           AD Program Numb
     C                     KFLD           FJBKC7           Ship To Custome
      * Setup key
     C                     MOVELD2OJCD    FJOJCD           Accrual Code
     C                     Z-ADDD2MSNY    FJMSNY           AD Program Numb
     C                     Z-ADDP3BKC7    FJBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@FJREBY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4157' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0005           Record Found US
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0005           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV HPB Equiv only   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    AMAIC3           Company Number
     C                     Z-ADD#2C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CP4NY           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     #CFMPR           OHE HPB RIN Pri
     C                     MOVEL*BLANK    #CCHTX           OHE Override Ty
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMHEVL    #CP4NY           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    #CFMPR           OHE HPB RIN Pri
     C                     MOVELAMCHTX    #CCHTX           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Order Date         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3           Company Number
     C                     Z-ADD#2C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CA0DT           Order Date
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEA0DT    #CA0DT           Order Date
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Org ABS & Reason   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #CHSSC           OHE Abs Rate Ov
     C                     Z-ADD*ZERO     #CQMNY           OHE Orig ABS Fr
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    AMAIC3           Company Number
     C                     Z-ADD#2C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMV4T1    #CHSSC           OHE Abs Rate Ov
     C                     Z-ADDAMQMNY    #CQMNY           OHE Orig ABS Fr
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Abs Frt Rate Info RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Carrier Code
     C                     Z-ADD*ZERO     #CTBNB           Absorbed Freigh
     C                     MOVEL*BLANK    YL0008           Shipping Method
     C                     MOVEL*BLANK    YL0009           Air Freight Ord
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3           Company Number
     C                     Z-ADD#2C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBZNA    YL0007           Carrier Code
     C                     Z-ADDBETBNB    #CTBNB           Absorbed Freigh
     C                     MOVELBEQ2CD    YL0008           Shipping Method
     C                     MOVELBEFTSX    YL0009           Air Freight Ord
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Deduct/Add Exist  RT - Order Detail Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0008           Deduct/Add Sts
      * Declare restrictor key work fields
     C           *LIKE     DEFN HQAIC3    WQSK01           Company Number
     C           *LIKE     DEFN HQC4NB    WQSK02           Order Number
     C           *LIKE     DEFN HQDPNB    WQSK03           Order Sequence
     C           *LIKE     DEFN HQUENB    WQSK04           Order Secondary
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WQSK03           Order Sequence
     C                     KFLD           WQSK04           Order Secondary
      * Setup key
     C                     Z-ADDWL0004    WQSK01           Company Number
     C                     Z-ADDWL0005    WQSK02           Order Number
     C                     Z-ADDWL0006    WQSK03           Order Sequence
     C                     Z-ADDWL0007    WQSK04           Order Secondary
      * Establish starting position
     C           KRSSK     SETLL@HQCPLJ                    *
     C           KRSSK     READE@HQCPLJ                  90*
      * Data record not found
     C   90                MOVEL'USR1524' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0008           Deduct/Add Sts
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@HQCPLJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG Abs. Freight Rate  CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  70       Load ID
     C                     Z-ADD*ZERO     WN0050 112       Rated Freight
     C                     MOVEL*BLANK    WN0051  1        LTL Flag
     C                     MOVEL*BLANK    WN0052  1        Price Audit
     C                     MOVEL*BLANK    WN0053  1        Price Status
     C                     MOVEL*BLANK    WN0054  2        Shipping Method
     C                     MOVEL*BLANK    WN0055  1        Export Status
     C                     MOVEL*BLANK    WN0056  1        Palletize
     C                     MOVEL*BLANK    WN0057  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0058  1        Slip Sheet
     C                     MOVEL*BLANK    WN0059  1        Age Code
     C                     Z-ADD*ZERO     WN0060  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0061  1        Load Type
     C                     Z-ADD*ZERO     WN0062  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0063  1        Load Plan Order
     C                     MOVEL*BLANK    WN0064  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0065  70       Resell Referenc
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  2        Manager Level C
     C                     MOVEL*BLANK    WN0071  3        VP Level Code
     C                     Z-ADD*ZERO     WN0072  70       Attach to Order
     C                     MOVEL*BLANK    WN0073  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0074  70       Invoice Number
     C                     MOVEL*BLANK    WN0075  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0076  70       Invoice Date
     C                     MOVEL*BLANK    WN0077  2        Event Code
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A_R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Process Sts for
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Order Requires
     C                     MOVEL*BLANK    WN0097  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#2AIC3    WBAIC3           Company Number
     C                     Z-ADD#2C4NB    WBC4NB           Order Number
      *
     C           KLCHSL    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSL    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD#CTBNB    WBTBNB           Absorbed Freigh
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
     C                     MOVELWBJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWBANC7    PAANC7           AR Customer Num
     C                     Z-ADDWBBKC7    PABKC7           Ship To Custome
     C                     MOVELWBBRTX    PABRTX    P      Ship To Name
     C                     MOVELWBHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWBHONA    PAHONA    P      Ship To Address
     C                     MOVELWBHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PAHNNA    P      Ship To City
     C                     MOVELWBDBCD    PADBCD    P      Ship To State C
     C                     MOVELWBCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWBB0C7    PAB0C7           Bill to Custome
     C                     MOVELWBAETX    PAAETX    P      Bill to Name
     C                     MOVELWBB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PAB2NA    P      Bill to City
     C                     MOVELWBBHCD    PABHCD    P      Bill to State C
     C                     MOVELWBC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWBBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PAA0DT           Order Date
     C                     Z-ADDWBA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PAACDT           Cancel Date
     C                     MOVELWBAQCD    PAAQCD    P      Terms Code
     C                     MOVELWBB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PABYNA    P      Special Instruc
     C                     MOVELWBBZNA    PABZNA    P      Carrier Code
     C                     MOVELWBGTST    PAGTST    P      Comment Print A
     C                     MOVELWBGVST    PAGVST    P      Comment Print I
     C                     MOVELWBGUST    PAGUST    P      Comment Print P
     C                     MOVELWBQFST    PAQFST    P      Comment Print S
     C                     MOVELWBCQCD    PACQCD    P      Reason Code
     C                     MOVELWBGJST    PAGJST    P      Order in Use
     C                     MOVELWBGWST    PAGWST    P      Header Status
     C                     MOVELWBGXST    PAGXST    P      Header Status L
     C                     MOVELWBGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PAAODT           Scheduled Ship
     C                     MOVELWBAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PACXDT           Date of Origina
     C                     Z-ADDWBJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PAA1WG           Order Weight To
     C                     MOVELWBXIST    PAXIST    P      Credit Hold
     C                     MOVELWBXJST    PAXJST    P      Production Hold
     C                     MOVELWBXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PAAFTM           Requested Deliv
     C                     MOVELWBE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PAR1NB           Rated Freight
     C                     MOVELWBPJST    PAPJST    P      LTL Flag
     C                     MOVELWBU0ST    PAU0ST    P      Price Audit
     C                     MOVELWBU1ST    PAU1ST    P      Price Status
     C                     MOVELWBQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PAU2ST    P      Export Status
     C                     MOVELWBVEST    PAVEST    P      Palletize
     C                     MOVELWBVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PAVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PARPCD    P      Age Code
     C                     Z-ADDWBRNNB    PARNNB           Reefer Temperat
     C                     MOVELWBVDST    PAVDST    P      Load Type
     C                     Z-ADDWBATIN    PAATIN           Attach to Invoi
     C                     MOVELWBU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PARSRN           Resell Referenc
     C                     MOVELWBMHNA    PAMHNA    P      Special Comment
     C                     MOVELWBMINA    PAMINA    P      Special Comment
     C                     MOVELWBWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PABFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PAT3NB           Attach to Order
     C                     MOVELWBSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PACONB           Invoice Number
     C                     MOVELWBCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PAAWDT           Invoice Date
     C                     MOVELWBJPCD    PAJPCD    P      Event Code
     C                     MOVELWBXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PAVRVA           A_R order Value
     C                     MOVELWBOBST    PAOBST    P      Billing Activit
     C                     MOVELWBBCST    PABCST    P      Block Order Fla
     C                     MOVELWBBDST    PABDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PAB7VL           Invoice Order V
     C                     MOVELWBGASX    PAGASX    P      Process Sts for
     C                     MOVELWBGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PAFUSX    P      Order Requires
     C                     MOVELWBFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWBFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PABQTM           Time of Origina
     C                     Z-ADDWBBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWBH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWBH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PAC0C7           Claim Number
     C                     MOVELWBUVST    PAUVST    P      EDI Status 1
     C                     MOVELWBUWST    PAUWST    P      EDI Status 2
     C                     MOVELWBUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PAAATM           Job Time
     C                     MOVELWBAYNA    PAAYNA    P      User Id
     C                     MOVELWBA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Abs Rte Ovrrd Rsn  CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0124  70       Load ID
     C                     Z-ADD*ZERO     WN0125  50       Stop_Drop Seque
     C                     MOVEL*BLANK    WN0126  3        Shipping Line
     C                     MOVEL*BLANK    WN0127 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0128 25        OHE City
     C                     MOVEL*BLANK    WN0129 30        OHE Vessel_Airl
     C                     MOVEL*BLANK    WN0130 15        OHE Voyage_Flig
     C                     MOVEL*BLANK    WN0131 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0132 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0133  70       OHE Sail_Flight
     C                     Z-ADD*ZERO     WN0134  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0135  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0136  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0137  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0138 12        OHE Container N
     C                     MOVEL*BLANK    WN0139 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0140 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0141 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0142 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0143 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0144 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0145 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0146 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0147 112       Transload Termi
     C                     Z-ADD*ZERO     WN0148  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0149  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0150  70       OHE Port_Pier P
     C                     Z-ADD*ZERO     WN0151  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0152  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0153  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0154  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0155  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0156  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0157  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0158  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0159  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0160  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0161  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0162  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0163  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0164 38        Delivery P_O  N
     C                     MOVEL*BLANK    WN0165  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0166  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0167  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0168  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0169  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0170  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0171  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0172 10        OHE Transload S
     C                     MOVEL*BLANK    WN0173 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0174 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0175 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0176 15        OHE Transload C
     C                     MOVEL*BLANK    WN0177 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0178 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0179 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0180 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0181 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0182  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0183  30       LD Stop_Drop
     C                     Z-ADD*ZERO     WN0184  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0185  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0186  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0187  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0188  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0189  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0190  60       Original Appoin
     C                     Z-ADD*ZERO     WN0191  60       Original Appoin
     C                     Z-ADD*ZERO     WN0192  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0193  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0194  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0195  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0196 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0197  1        OHE Email BOL_S
     C                     MOVEL*BLANK    WN0198  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN0199  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN0200  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0201  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0202  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0203 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0204 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN0205 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0206  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0207  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0208  1        EDI Status 1
     C                     MOVEL*BLANK    WN0209  1        EDI Status 2
     C                     MOVEL*BLANK    WN0210  1        EDI Status 3
     C                     MOVEL*BLANK    WN0211  1        Record Status
     C                     Z-ADD*ZERO     WN0212  60       Job Time
     C                     MOVEL*BLANK    WN0213 10        User Id
     C                     MOVEL*BLANK    WN0214 10        Job Name
     C                     Z-ADD*ZERO     WN0215  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADD#2AIC3    WCAIC3           Company Number
     C                     Z-ADD#2C4NB    WCC4NB           Order Number
      *
     C           KLCHSM    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSM    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     MOVEL#CHSSC    WCV4T1    P      OHE Abs Rate Ov
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     MOVEL##USR     WCAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0009    EOAIC3           Company Number
     C                     Z-ADDWL0010    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0011           Type Code
     C                     Z-ADD*ZERO     WL0012           Absorbed Freigh
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WL0011           Type Code
     C                     Z-ADDEOTBNB    WL0012           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Val Manual Price      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0013    BZAIC3           Company Number
     C                     Z-ADDWL0014    BZHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0015           Description Lin
     C                     MOVEL*BLANK    WL0016           Default Commod
     C                     Z-ADD*ZERO     WL0017           Market Overage
     C                     Z-ADD*ZERO     WL0018           Standard Overag
     C                     MOVEL*BLANK    WL0019           Commodity Price
     C                     Z-ADD*ZERO     WL0020           Std Weight_Head
     C                     MOVEL*BLANK    WL0021           Primal Group Co
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0015           Description Lin
     C                     MOVELBZLNCD    WL0016           Default Commod
     C                     Z-ADDBZBLPR    WL0017           Market Overage
     C                     Z-ADDBZBMPR    WL0018           Standard Overag
     C                     MOVELBZLRCD    WL0019           Commodity Price
     C                     Z-ADDBZSWGH    WL0020           Std Weight_Head
     C                     MOVELBZXRCD    WL0021           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Prc Mth Typ/Prc TyRT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IHQ7CD    WQSP01           Price Method Co
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Price Method Co
      * Setup key
     C                     MOVELWL0022    WQSP01           Price Method Co
      * Establish starting position
     C           KRSSP     SETLL@IHREU4                    *
     C           KRSSP     READE@IHREU4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0023           Price Method Ty
     C                     MOVEL*BLANK    WL0024           PMH Price Type
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHV8ST    WL0023           Price Method Ty
     C                     MOVELIHH3ST    WL0024           PMH Price Type
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@IHREU4                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDWL0025    WDAIC3           Company Number
     C                     MOVELWL0026    WDQ7CD           Price Method Co
      * Establish starting position
     C           KRSSQ     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0027           Price Method Ty
     C                     MOVEL*BLANK    WL0028           PMH Price Type
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDV8ST    WL0027           Price Method Ty
     C                     MOVELWDH3ST    WL0028           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0029    ASAIC3           Company Number
      * Establish starting position
     C           KRSSR     CHAIN@ASREVL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0030           Manual Price Ac
     C                     Z-ADD*ZERO     WL0031           CoPk_FdSrv ManP
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASAIPC    WL0030           Manual Price Ac
     C                     Z-ADDASASPC    WL0031           CoPk_FdSrv ManP
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F0LQCD    WQSS01           Commodity Marke
     C           *LIKE     DEFN F0LRCD    WQSS02           Commodity Price
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           Commodity Marke
     C                     KFLD           WQSS02           Commodity Price
     C                     KFLD           F0EQDT           Market Price Da
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Commodity Marke
     C                     KFLD           WQSS02           Commodity Price
      * Setup key
     C                     MOVELWL0032    WQSS01           Commodity Marke
     C                     MOVELWL0033    WQSS02           Commodity Price
     C                     Z-ADDWL0034    F0EQDT           Market Price Da
      * Establish starting position
     C           KPSSS     SETLL@F0CPEP                    *
     C           KRSSS     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0035           Commodity Marke
     C                     Z-ADD*ZERO     WL0036           USR Date Priced
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDF0A5PR    WL0035           Commodity Marke
     C                     Z-ADDF0EQDT    WL0036           USR Date Priced
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * VAL Date Method Exists RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IPBXST    WQST01           System using Da
     C           *LIKE     DEFN IPAIC3    WQST02           Company Number
     C           *LIKE     DEFN IPRDCD    WQST03           Date Method Cod
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           System using Da
     C                     KFLD           WQST02           Company Number
     C                     KFLD           WQST03           Date Method Cod
      * Setup key
     C                     MOVELWL0040    WQST01           System using Da
     C                     Z-ADDWL0037    WQST02           Company Number
     C                     MOVELWL0038    WQST03           Date Method Cod
      * Establish starting position
     C           KRSST     SETLL@IPREFJ                    *
     C           KRSST     READE@IPREFJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0039           Date Method Des
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIPMNNA    WL0039           Date Method Des
     C           KRSST     READE@IPREFJ                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WELQCD    WQSU01           Commodity Marke
     C           *LIKE     DEFN WELRCD    WQSU02           Commodity Price
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Commodity Marke
     C                     KFLD           WQSU02           Commodity Price
      * Setup key
     C                     MOVELWL0041    WQSU01           Commodity Marke
     C                     MOVELWL0042    WQSU02           Commodity Price
      * Establish starting position
     C           KRSSU     SETLL@F0CPVR                    *
     C           KRSSU     READE@F0CPVR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@F0CPVR                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * CHG OM Price Maint     CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0232  70       Item Code
     C                     MOVEL*BLANK    WN0233  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0234  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0235  70       Order Group Cod
     C                     MOVEL*BLANK    WN0236  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0237  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0238 112       Billing Detail
     C                     Z-ADD*ZERO     WN0239 112       Billing Detail
     C                     Z-ADD*ZERO     WN0240 112       Billing Detail
     C                     Z-ADD*ZERO     WN0241 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0242  1        Comment Print A
     C                     MOVEL*BLANK    WN0243  1        Comment Print I
     C                     MOVEL*BLANK    WN0244  1        Comment Print P
     C                     MOVEL*BLANK    WN0245  1        Comment Print S
     C                     Z-ADD*ZERO     WN0246  70       Contract Number
     C                     MOVEL*BLANK    WN0247  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0248  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0249  1        Work Confirm St
     C                     MOVEL*BLANK    WN0250  1        Work Over_Short
     C                     MOVEL*BLANK    WN0251  1        OD Production P
     C                     MOVEL*BLANK    WN0252 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0253 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0254  1        Age Code
     C                     MOVEL*BLANK    WN0255  1        Palletize
     C                     MOVEL*BLANK    WN0256  1        Slip Sheet
     C                     MOVEL*BLANK    WN0257  1        Catch Weight St
     C                     MOVEL*BLANK    WN0258  1        Price Audit
     C                     MOVEL*BLANK    WN0259  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0260  1        Production Date
     C                     Z-ADD*ZERO     WN0261 112       Rated Freight
     C                     Z-ADD*ZERO     WN0262 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0263 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0264 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0265 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0266 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0267 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0268 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0269 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0270 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0271 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0272 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0273  70       Requested Ship
     C                     Z-ADD*ZERO     WN0274  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0275  70       Actual Shipped
     C                     MOVEL*BLANK    WN0276  1        Affect Inventor
     C                     MOVEL*BLANK    WN0277  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0278  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0279  30       Item Structure
     C                     Z-ADD*ZERO     WN0280  30       Item Structure
     C                     Z-ADD*ZERO     WN0281  30       Item Structure
     C                     MOVEL*BLANK    WN0282  2        Item Level
     C                     MOVEL*BLANK    WN0283  2        Quality Level
     C                     MOVEL*BLANK    WN0284  2        Pricing Product
     C                     MOVEL*BLANK    WN0285  2        Season Product
     C                     MOVEL*BLANK    WN0286 10        User Profile Na
     C                     MOVEL*BLANK    WN0287  6        Country Code
     C                     MOVEL*BLANK    WN0288  2        Event Code
     C                     MOVEL*BLANK    WN0289  3        Reason Code
     C                     MOVEL*BLANK    WN0290  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0291  1        Modified Flag
     C                     MOVEL*BLANK    WN0292  1        Substituted Fla
     C                     MOVEL*BLANK    WN0293  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0294 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0295 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0296  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0297  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0298  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0299  1        Affect Commissi
     C                     MOVEL*BLANK    WN0300  1        Affect Pricing
     C                     MOVEL*BLANK    WN0301  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0302  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0303  3        Production Ware
     C                     Z-ADD*ZERO     WN0304  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0305  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0306  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0307  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0308  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0309  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0310  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0311  60       Substitution Li
     C                     Z-ADD*ZERO     WN0312  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0313 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0314 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0315 112       OD Item Target
     C                     Z-ADD*ZERO     WN0316 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0317 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0318 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0319 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0320 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0321 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0322 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0323 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0324 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0325  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0326  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0327  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0328 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0329  40       Item Age Days
     C                     Z-ADD*ZERO     WN0330  70       Production Ovr
     C                     Z-ADD*ZERO     WN0331  70       Production Ovr
     C                     MOVEL*BLANK    WN0332  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0333  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0334  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0335  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0336  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0337  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0338  1        EDI Status 1
     C                     MOVEL*BLANK    WN0339  1        EDI Status 2
     C                     MOVEL*BLANK    WN0340  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0341  60       Job Time
     C                     MOVEL*BLANK    WN0342 10        User Id
     C                     MOVEL*BLANK    WN0343 10        Job Name
     C                     Z-ADD*ZERO     WN0344  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    WFAIC3           Company Number
     C                     Z-ADD#1C4NB    WFC4NB           Order Number
     C                     Z-ADD#1DPNB    WFDPNB           Order Sequence
     C                     Z-ADD#1UENB    WFUENB           Order Secondary
      *
     C           KLCHSV    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSV    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * USER: Processing after Data read
      * E2247 RMC 10/03/12 Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Sent to USDA Sts is yes
     C           WFHOST    IFEQ 'Y'                        *IF
      * If price type changes, then create type: ORDPRT
      * CASE: DB1.OD Price Type NE PAR.OD Price Type
     C           WFF7SX    IFNE #1F7SX                     *IF
      * change log prior has seq in pos 1-3, price type 5-7: '001 NEG
     C                     MOVELWFDPNB    YL0056           Text 3 Length U
     C                     Z-ADD1         ZQ      50
     C           YL0056    CAT  WFF7SX:ZQ YL0057    P      Change Log Prio
     C                     MOVEL*BLANK    YL0058           Change Log New
     C                     MOVEL#1F7SX    YL0058           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0193  70       Load ID
     C                     PARM 'ORDPRT'  WQ0194  6        Load Change Typ
     C                     PARM 'SLS'     WQ0195  3        Department Cont
     C                     PARM YL0057    WQ0196 12        Change Log Prio
     C                     PARM YL0058    WQ0197 12        Change Log New
     C                     PARM WFAIC3    WQ0198  30       Company Number
     C                     PARM WFC4NB    WQ0199  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1AYVA    WFAYVA           Extended Amount
     C                     Z-ADD#1EXDT    WFEXDT           Market Pricing
     C                     MOVEL#1LQCD    WFLQCD    P      Commodity Marke
     C                     MOVEL#1RDCD    WFRDCD    P      Date Method Cod
     C                     MOVEL#1Q7CD    WFQ7CD    P      Price Method Co
     C                     Z-ADD#1BZPR    WFBZPR           Price Overage O
     C                     MOVEL#1U1ST    WFU1ST    P      Price Status
     C                     Z-ADDWUGIDT    WFGIDT           Pricing Date Us
     C                     Z-ADD#1AKPR    WFAKPR           Unit Price
     C                     Z-ADD#1AUPR    WFAUPR           Unit Price Orde
     C                     Z-ADD#RPNDT    WFCXDT           Date of Origina
     C                     MOVEL#1F3SX    WFF3SX    P      Released by Use
     C                     MOVEL#1F7SX    WFF7SX    P      OD Price Type
     C                     Z-ADD#1BVTM    WFBVTM           Price Code
     C                     Z-ADD#1DVPR    WFDVPR           Order Gate_Fina
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WFAATM' defaulted for 'Job Time'.
      * Field '(DB1) WFAYNA' defaulted for 'User Id'.
      * Field '(DB1) WFA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WFAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG Ord  Prt,Prc Sts   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0345  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0346  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0347  70       Ship To Custome
     C                     MOVEL*BLANK    WN0348 30        Ship To Name
     C                     MOVEL*BLANK    WN0349 30        Ship To Address
     C                     MOVEL*BLANK    WN0350 30        Ship To Address
     C                     MOVEL*BLANK    WN0351 30        Ship To Address
     C                     MOVEL*BLANK    WN0352 20        Ship To City
     C                     MOVEL*BLANK    WN0353  2        Ship To State C
     C                     MOVEL*BLANK    WN0354 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0355  70       Bill to Custome
     C                     MOVEL*BLANK    WN0356 30        Bill to Name
     C                     MOVEL*BLANK    WN0357 30        Bill to Address
     C                     MOVEL*BLANK    WN0358 30        Bill to Address
     C                     MOVEL*BLANK    WN0359 30        Bill to Address
     C                     MOVEL*BLANK    WN0360 20        Bill to City
     C                     MOVEL*BLANK    WN0361  2        Bill to State C
     C                     MOVEL*BLANK    WN0362 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0363 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0364  70       Order Date
     C                     Z-ADD*ZERO     WN0365  70       Requested Ship
     C                     Z-ADD*ZERO     WN0366  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0367  70       Cancel Date
     C                     MOVEL*BLANK    WN0368  2        Terms Code
     C                     MOVEL*BLANK    WN0369 40        Special Instruc
     C                     MOVEL*BLANK    WN0370 40        Special Instruc
     C                     MOVEL*BLANK    WN0371  3        Carrier Code
     C                     MOVEL*BLANK    WN0372  1        Comment Print A
     C                     MOVEL*BLANK    WN0373  1        Comment Print I
     C                     MOVEL*BLANK    WN0374  1        Comment Print P
     C                     MOVEL*BLANK    WN0375  1        Comment Print S
     C                     MOVEL*BLANK    WN0376  3        Reason Code
     C                     MOVEL*BLANK    WN0377  1        Order in Use
     C                     MOVEL*BLANK    WN0378  1        Header Status
     C                     MOVEL*BLANK    WN0379  1        Header Status L
     C                     Z-ADD*ZERO     WN0380  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0381 10        User Original E
     C                     Z-ADD*ZERO     WN0382  70       Date of Origina
     C                     Z-ADD*ZERO     WN0383 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0384 112       Order Weight To
     C                     MOVEL*BLANK    WN0385  1        Credit Hold
     C                     MOVEL*BLANK    WN0386  1        Production Hold
     C                     MOVEL*BLANK    WN0387  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0388  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0389  40       Requested Deliv
     C                     MOVEL*BLANK    WN0390  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0391 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0392  70       Load ID
     C                     Z-ADD*ZERO     WN0393  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0394 112       Rated Freight
     C                     MOVEL*BLANK    WN0395  1        LTL Flag
     C                     MOVEL*BLANK    WN0396  1        Price Audit
     C                     MOVEL*BLANK    WN0397  2        Shipping Method
     C                     MOVEL*BLANK    WN0398  1        Export Status
     C                     MOVEL*BLANK    WN0399  1        Palletize
     C                     MOVEL*BLANK    WN0400  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0401  1        Slip Sheet
     C                     MOVEL*BLANK    WN0402  1        Age Code
     C                     Z-ADD*ZERO     WN0403  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0404  1        Load Type
     C                     Z-ADD*ZERO     WN0405  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0406  1        Load Plan Order
     C                     MOVEL*BLANK    WN0407  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0408  70       Resell Referenc
     C                     MOVEL*BLANK    WN0409 30        Special Comment
     C                     MOVEL*BLANK    WN0410 30        Special Comment
     C                     MOVEL*BLANK    WN0411  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0412  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0413  2        Manager Level C
     C                     MOVEL*BLANK    WN0414  3        VP Level Code
     C                     Z-ADD*ZERO     WN0415  70       Attach to Order
     C                     MOVEL*BLANK    WN0416  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0417  70       Invoice Number
     C                     MOVEL*BLANK    WN0418  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0419  70       Invoice Date
     C                     MOVEL*BLANK    WN0420  2        Event Code
     C                     MOVEL*BLANK    WN0421  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0422  1        Modified Flag
     C                     Z-ADD*ZERO     WN0423 112       A_R order Value
     C                     MOVEL*BLANK    WN0424  1        Billing Activit
     C                     MOVEL*BLANK    WN0425  1        Block Order Fla
     C                     MOVEL*BLANK    WN0426  1        Order Certifica
     C                     Z-ADD*ZERO     WN0427 112       Invoice Order V
     C                     MOVEL*BLANK    WN0428  1        Process Sts for
     C                     MOVEL*BLANK    WN0429  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0430  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0431  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0432  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0433  1        Email Cust On O
     C                     MOVEL*BLANK    WN0434  1        Order Emailed
     C                     MOVEL*BLANK    WN0435  1        Export Docs Go
     C                     MOVEL*BLANK    WN0436  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0437  1        Broker Order St
     C                     MOVEL*BLANK    WN0438  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0439  2        Order Requires
     C                     MOVEL*BLANK    WN0440  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0441  2        Export USDA App
     C                     MOVEL*BLANK    WN0442  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0443  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0444  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0445  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0446  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0447  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0448  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0449  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0450  60       Time of Origina
     C                     Z-ADD*ZERO     WN0451  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0452  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0453  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0454 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0455 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0456 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0457 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0458 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0459  70       Claim Number
     C                     MOVEL*BLANK    WN0460  1        EDI Status 1
     C                     MOVEL*BLANK    WN0461  1        EDI Status 2
     C                     MOVEL*BLANK    WN0462  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0463  60       Job Time
     C                     MOVEL*BLANK    WN0464 10        User Id
     C                     MOVEL*BLANK    WN0465 10        Job Name
     C                     Z-ADD*ZERO     WN0466  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#1C4NB    WBC4NB           Order Number
      *
     C           KLCHSW    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSW    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       WBGYST    P      Order Type Prin
     C                     MOVEL'U'       WBU1ST    P      Price Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
     C                     MOVELWBJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWBANC7    PAANC7           AR Customer Num
     C                     Z-ADDWBBKC7    PABKC7           Ship To Custome
     C                     MOVELWBBRTX    PABRTX    P      Ship To Name
     C                     MOVELWBHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWBHONA    PAHONA    P      Ship To Address
     C                     MOVELWBHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PAHNNA    P      Ship To City
     C                     MOVELWBDBCD    PADBCD    P      Ship To State C
     C                     MOVELWBCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWBB0C7    PAB0C7           Bill to Custome
     C                     MOVELWBAETX    PAAETX    P      Bill to Name
     C                     MOVELWBB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PAB2NA    P      Bill to City
     C                     MOVELWBBHCD    PABHCD    P      Bill to State C
     C                     MOVELWBC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWBBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PAA0DT           Order Date
     C                     Z-ADDWBA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PAACDT           Cancel Date
     C                     MOVELWBAQCD    PAAQCD    P      Terms Code
     C                     MOVELWBB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PABYNA    P      Special Instruc
     C                     MOVELWBBZNA    PABZNA    P      Carrier Code
     C                     MOVELWBGTST    PAGTST    P      Comment Print A
     C                     MOVELWBGVST    PAGVST    P      Comment Print I
     C                     MOVELWBGUST    PAGUST    P      Comment Print P
     C                     MOVELWBQFST    PAQFST    P      Comment Print S
     C                     MOVELWBCQCD    PACQCD    P      Reason Code
     C                     MOVELWBGJST    PAGJST    P      Order in Use
     C                     MOVELWBGWST    PAGWST    P      Header Status
     C                     MOVELWBGXST    PAGXST    P      Header Status L
     C                     MOVELWBGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PAAODT           Scheduled Ship
     C                     MOVELWBAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PACXDT           Date of Origina
     C                     Z-ADDWBJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PAA1WG           Order Weight To
     C                     MOVELWBXIST    PAXIST    P      Credit Hold
     C                     MOVELWBXJST    PAXJST    P      Production Hold
     C                     MOVELWBXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PAAFTM           Requested Deliv
     C                     MOVELWBE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PAR1NB           Rated Freight
     C                     MOVELWBPJST    PAPJST    P      LTL Flag
     C                     MOVELWBU0ST    PAU0ST    P      Price Audit
     C                     MOVELWBU1ST    PAU1ST    P      Price Status
     C                     MOVELWBQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PAU2ST    P      Export Status
     C                     MOVELWBVEST    PAVEST    P      Palletize
     C                     MOVELWBVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PAVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PARPCD    P      Age Code
     C                     Z-ADDWBRNNB    PARNNB           Reefer Temperat
     C                     MOVELWBVDST    PAVDST    P      Load Type
     C                     Z-ADDWBATIN    PAATIN           Attach to Invoi
     C                     MOVELWBU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PARSRN           Resell Referenc
     C                     MOVELWBMHNA    PAMHNA    P      Special Comment
     C                     MOVELWBMINA    PAMINA    P      Special Comment
     C                     MOVELWBWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PABFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PAT3NB           Attach to Order
     C                     MOVELWBSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PACONB           Invoice Number
     C                     MOVELWBCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PAAWDT           Invoice Date
     C                     MOVELWBJPCD    PAJPCD    P      Event Code
     C                     MOVELWBXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PAVRVA           A_R order Value
     C                     MOVELWBOBST    PAOBST    P      Billing Activit
     C                     MOVELWBBCST    PABCST    P      Block Order Fla
     C                     MOVELWBBDST    PABDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PAB7VL           Invoice Order V
     C                     MOVELWBGASX    PAGASX    P      Process Sts for
     C                     MOVELWBGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PAFUSX    P      Order Requires
     C                     MOVELWBFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWBFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PABQTM           Time of Origina
     C                     Z-ADDWBBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWBH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWBH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PAC0C7           Claim Number
     C                     MOVELWBUVST    PAUVST    P      EDI Status 1
     C                     MOVELWBUWST    PAUWST    P      EDI Status 2
     C                     MOVELWBUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PAAATM           Job Time
     C                     MOVELWBAYNA    PAAYNA    P      User Id
     C                     MOVELWBA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Next Audit Seq #   RT - Price Change Audit Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN K3AIC3    WQSX01           Company Number
     C           *LIKE     DEFN K3C4NB    WQSX02           Order Number
     C           *LIKE     DEFN K3DPNB    WQSX03           Order Sequence
     C           *LIKE     DEFN K3UENB    WQSX04           Order Secondary
      * Define keylist
     C           KPSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
     C                     KFLD           WQSX03           Order Sequence
     C                     KFLD           WQSX04           Order Secondary
     C                     KFLD           K3ASNO           Audit Sequence
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
     C                     KFLD           WQSX03           Order Sequence
     C                     KFLD           WQSX04           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    WQSX01           Company Number
     C                     Z-ADD#1C4NB    WQSX02           Order Number
     C                     Z-ADD#1DPNB    WQSX03           Order Sequence
     C                     Z-ADD#1UENB    WQSX04           Order Secondary
     C                     Z-ADD999       K3ASNO           Audit Sequence
      * Establish starting position
     C           KPSSX     SETLL@K3CPKR                    *
     C           KRSSX     READE@K3CPKR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2378' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQQNB           USR Sequence Nu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           K3ASNO    ADD  1         WUQQNB           USR Sequence Nu
     C                     GOTO SXEXIT                     *QUIT
     C           KRSSX     READE@K3CPKR                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * CRT Price Change Audit CR - Price Change Audit Log  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0467  1        EDI Status 1
     C                     MOVEL*BLANK    WN0468  1        EDI Status 2
     C                     MOVEL*BLANK    WN0469  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0470  60       Job Time
     C                     MOVEL*BLANK    WN0471 10        User Id
     C                     MOVEL*BLANK    WN0472 10        Job Name
     C                     Z-ADD*ZERO     WN0473  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @K3CPKP
     C                     Z-ADD#1AIC3    WGAIC3           Company Number
     C                     Z-ADD#1C4NB    WGC4NB           Order Number
     C                     Z-ADD#1DPNB    WGDPNB           Order Sequence
     C                     Z-ADD#1UENB    WGUENB           Order Secondary
     C                     Z-ADDWUQQNB    WGASNO           Audit Sequence
     C                     Z-ADD#1HGCD    WGHGCD           Item Code
     C                     MOVEL#1GMST    WGGMST           Detail Line Sta
     C                     MOVEL#1GMST    WGGNST           Detail Line Sta
     C                     Z-ADD#1AYVA    WGAYVA           Extended Amount
     C                     Z-ADD#RYJVA    WGYJVA           Extended Amount
     C                     MOVEL#1U1ST    WGU1ST           Price Status
     C                     MOVEL#RPSTL    WGPSTL           Price Status La
     C                     MOVEL#1U0ST    WGU0ST           Price Audit
     C                     MOVEL#1RFCD    WGRFCD           Price Audit Rea
     C                     MOVEL#1U0ST    WGPALS           Price Audit Las
     C                     MOVEL#1RFCD    WGWWCD           Price Audit Rea
     C                     Z-ADD#1AKPR    WGAKPR           Unit Price
     C                     Z-ADD#RDBPR    WGDBPR           Unit Price Last
     C                     Z-ADD#1ALPR    WGALPR           Unit Price_Cred
     C                     Z-ADD#1ALPR    WGDCPR           Unit Price - Cr
     C                     MOVEL#1JPCD    WGJPCD           Event Code
     C                     MOVEL#1JPCD    WGWXCD           Event Code Last
     C                     MOVE *BLANK    WGPREC           Price Event Cal
     C                     MOVEL'PM'      WGPREC           Price Event Cal
     C                     MOVEL##PGM     WGPIDX           Program ID . .
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSY    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGASNO           Audit Sequence
      * Check for duplicate primary key
     C           KLCRSY    SETLL@K3CPKP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2379' W0RTN   7
      * Send message 'Price Change Audit Log EX'
     C                     MOVEL'USR2379' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@K3CPKP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0474    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSZ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0059           Company Number
     C                     MOVELDRBUVN    WN0475           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0043    DTAJVN           User Profile Na
     C                     MOVELWL0044    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTA     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0045           Company Number
     C                     MOVELDTAJCD    WL0046           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTB01           Application Cod
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTB01           Application Cod
     C                     MOVEL'OMS'     WQTB01           Application Cod
      * Establish starting position
     C           KRSTB     SETLL@DNRESF                    *
     C           KRSTB     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
     C           KRSTB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTC01           Application Cod
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTC01           Application Cod
      * Establish starting position
     C           KRSTC     SETLL@DNRESF                    *
     C           KRSTC     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0215  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0216  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVABE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C                     Z-ADD#2C4NB    BEC4NB
     C           KLVABE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELBEXIST    #2XIST           Credit Hold
     C                     MOVELBEXJST    #2XJST           Production Hold
     C                     MOVELBEGWST    #2GWST           Header Status
     C                     MOVELBEJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDBERMNB    #2RMNB           Load ID
     C                     MOVELBEU2ST    #2U2ST           Export Status
     C                     MOVELBEHNNA    #2HNNA           Ship To City
     C                     MOVELBEDBCD    #2DBCD           Ship To State C
     C                     Z-ADDBEEIDT    #2EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #2AFTM           Requested Deliv
     C                     MOVELBEGJST    #2GJST           Order in Use
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03584
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  14        W0CSRR  50
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  14        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD14        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDGE065
     C           ZHCSCL    ANDLE067
     C                     MOVEL'#RPRMT'  YPMTFD           OD Price Type U
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Exit
      *   |- c2    : PAR.OD Price Type Req STS USR is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN03     IFEQ '1'                        *IF
     C           P5        IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Price Type Entry  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      Record Found -O
      * CASE: LCL.Record Found -OrdDtlUSR is Record Found
     C           YL0001    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#2F7SX    ZA0077           OD Price Type
      * Send message 'OD Price Type Req'
     C                     MOVEL'USR3952' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CTL.Header Status is Avail/Alloc/Enter/Hold
     C           #2GWST    IFEQ 'L'                        *IF
     C           #2GWST    OREQ 'A'
     C           #2GWST    OREQ 'E'
     C           #2GWST    OREQ 'H'
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0217  30       Company Number
     C                     PARM #2C4NB    WQ0218  70       Order Number
     C                     PARM P3BKC7    WQ0219  70       Ship To Custome
     C           #PJZVA    PARM #PJZVA    WQ0220 112       Order Value Tot
     C           #PA1WG    PARM *ZERO     WQ0221 112       Order Weight To
     C                     PARM 'PM'      WQ0222  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0223  30       Company Number
     C                     PARM #2C4NB    WQ0224  70       Order Number
     C                     PARM *ZERO     WQ0225  30       Order Sequence
     C                     PARM *ZERO     WQ0226  30       Order Secondary
     C                     PARM 'PM'      WQ0227  3        Pricing Event C
     C           WUJZVA    PARM WUJZVA    WQ0228 112       Order Value Tot
     C           WUA1WG    PARM WUA1WG    WQ0229 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0230  1        Production Hold
     C                     PARM '*NO'     WQ0231  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3ANC7           AR Customer Num
     C                     MOVEL*BLANK    P3GXST           Header Status L
     C                     Z-ADD*ZERO     P3VRVA           A_R order Value
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4YBST           Price Status US
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5               OD Price Type R
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6HTSC           Abs Freight Rat
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A_R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WCQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WCQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WCQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WCGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WCHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WCHGVL           Transload Termi
     C                     Z-ADD*ZERO     WCQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WCQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WCQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WCQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WCQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WCQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WCP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WCQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WCQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WCQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WCQENY           Original Appoin
     C                     Z-ADD*ZERO     WCQFNY           Original Appoin
     C                     Z-ADD*ZERO     WCQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WCQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WCW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Production Hold
     C                     MOVEL*BLANK    WUXJST  1
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Price Start Date
     C                     Z-ADD*ZERO     WUPLDT  70
      * Define work field Price End Date
     C                     Z-ADD*ZERO     WUPMDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDRMNY           Decimal Places
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEEQDT           Market Price Da
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WEB8PR           Projected Marke
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Quantity Shipped Total
     C                     Z-ADD*ZERO     WUCBQT 112
      * Define work field Pricing Date Used
     C                     Z-ADD*ZERO     WUGIDT  70
      * Define work field USR Sequence Num. New ATR
     C                     Z-ADD*ZERO     WUQQNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGASNO           Audit Sequence
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGYJVA           Extended Amount
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGDBPR           Unit Price Last
     C                     Z-ADD*ZERO     WGALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WGDCPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     MOVEL*BLANK    WL0008  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  2
     C                     Z-ADD*ZERO     WL0012  52
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015 30
     C                     MOVEL*BLANK    WL0016  3
     C                     Z-ADD*ZERO     WL0017 114
     C                     Z-ADD*ZERO     WL0018 114
     C                     MOVEL*BLANK    WL0019  7
     C                     Z-ADD*ZERO     WL0020 112
     C                     MOVEL*BLANK    WL0021  6
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0022  3
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0025  30
     C                     MOVEL*BLANK    WL0026  3
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030  52
     C                     Z-ADD*ZERO     WL0031  52
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  7
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035 114
     C                     Z-ADD*ZERO     WL0036  70
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0037  30
     C                     MOVEL*BLANK    WL0038  3
     C                     MOVEL*BLANK    WL0039 30
     C                     MOVEL*BLANK    WL0040  1
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  7
      * Define local variables for subroutine TARVGN.
     C                     MOVEL*BLANK    WL0043 10
     C                     MOVEL*BLANK    WL0044  6
     C                     Z-ADD*ZERO     WL0045  30
     C                     MOVEL*BLANK    WL0046  3
      * Define local work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Discounts Exists USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Abs Frt Override Reason
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Air Freight Order
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Absorbed Freight Rate 2
     C                     Z-ADD*ZERO     YL0010  52
      * Define local work field Edit/Display Usr
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Absorbed Freight Rate Usr
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field Abs Frt Override Rsn Usr
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field Department Control Code
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field Text USR 5
     C                     MOVEL*BLANK    YL0016  5
      * Define local work field USR Text 3  3a
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field Text 2
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Absorbed Freight 6A USR
     C                     MOVEL*BLANK    YL0019  6
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0020 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0021 12
      * Define local work field Price Code
     C                     Z-ADD*ZERO     YL0022  60
      * Define null work field Date Method Description
     C                     MOVEL*BLANK    YN0002 30
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0023  2
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0003  52
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0024 30
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0026 114
      * Define local work field Standard Overage_Underage
     C                     Z-ADD*ZERO     YL0027 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0028  7
      * Define local work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     YL0029 112
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0030  6
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field USR Display 4
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0036  7
      * Define local work field Market Prem/Ded
     C                     Z-ADD*ZERO     YL0037  94
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0039 114
      * Define local work field Price Start Date
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Price End Date
     C                     Z-ADD*ZERO     YL0041  70
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0042 112
      * Define local work field Customer Price_UM Prc
     C                     Z-ADD*ZERO     YL0043 114
      * Define local work field Commodity Market Code USR
     C                     MOVEL*BLANK    YL0044  3
      * Define local work field Price Method Code USR
     C                     MOVEL*BLANK    YL0045  3
      * Define local work field Date Method Code USR
     C                     MOVEL*BLANK    YL0046  3
      * Define local work field Contract Unit Type
     C                     MOVEL*BLANK    YL0047  1
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0048 112
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0049  3
      * Define local work field Weight Allocated USR
     C                     Z-ADD*ZERO     YL0050  92
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0051 114
      * Define local work field Error Status  3
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Minimum Price   USR
     C                     Z-ADD*ZERO     YL0053 114
      * Define local work field Maximum Price  USR
     C                     Z-ADD*ZERO     YL0054 114
      * Define null work field Date Method Description
     C                     MOVEL*BLANK    YN0004 30
      * Define local work field Price Detail Sequence
     C                     Z-ADD*ZERO     YL0055  30
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0056  3
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0057 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0058 12
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0059  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0060  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD05        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0474 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0474           User Profile Na
      *
     C                     MOVEL*BLANK    WN0475 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SZRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0474    ZA0078           User Profile Na
     C                     MOVEL'OMS'     ZA0079           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0475    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0474    WL0043    P      User Profile Na
     C                     MOVEL'OMS'     WL0044    P      Application Cod
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0060    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0475    WL0043    P      User Profile Na
     C                     MOVEL'OMS'     WL0044    P      Application Cod
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0060    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0060    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0474    ZA0080           User Profile Na
     C                     MOVEL'OMS'     ZA0081           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0059    IFNE 0                          *IF
     C                     Z-ADDYL0059    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0060    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0232  3        Warehouse Code
     C                     PARM YL0059    WQ0233  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TBRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL##USR     P2AJVN           User Profile Na
      * R12926 DN 05/17/18-Keep Track if Order ABS Freight Rate Changed.
     C                     MOVEL'N'       P6HTSC           Abs Freight Rat
      * *Set Cursor: CTL.Item Code  (*Override=*YES)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD013       W0ROW0
     C                     Z-ADD004       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01040010550106401086011010112801150
01296013040135701384014060155201617
01640016660181801848018960207402108
02306033320334003345033480336403368
03372033790338303393033980341203415
03429034430345803586035880359603601
03604036180362003624036280363503639
03649036540366803671036850369903714
0384603896
** W0END
01042010610108301087011130113501153
01302013330136901391014110156601624
01647016670182301853019030207502132
02435033380334203345033600336603370
03377033810339003395034100341303427
03441034550345803586035940359803601
03616036180362203626036330363703646
03651036660366903683036970371103714
0387003903
** W0NAM
V2AIC3    V2C4NB    #2HNNA    #2DBCD    #PJZVA    VCF9DT    #CP4NY
V2BKC7    #CBRTX    #PA1WG    VCHODT    #CFMPR    #CBCNA    VCA0DT
V2A5DT    #CCHTX    #CTBNB    #CLMNY    V2EIDT    #CHSSC    #CG5TX
**SPT     V2HGCD    #2AJCD    #CGLST    #CCLPR    #CTKCD    #CTLCD
#CUYNX    #CTMCD    VCG2DT    #2F7SX    #2AKPR    #2CRCD    #2AUPR
#2ATWG    #2AYVA    #2U1ST    #1SEL     V1HGCD    #1AJCD    #RGLST
#RCLPR    #RPFTX    #RTKCD    #RTLCD    #RUYNX    #RTMCD    VRG2DT
#RPRMT    #1AKPR    #1CRCD    #1AUPR    #1ATWG    #1AYVA    #1U1ST
#RGENA    VRPNDT
** @CN
00001 ODPRCTYPRQ
00002 -Blank Price Type Exists-
00003 USR0752
00004 Y2U0005
