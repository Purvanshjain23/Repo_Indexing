     H/TITLE Clc Producer History  PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:50:21
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKA1CPO1IF  E           K        DISK
      * RSQ : Tattoo Header             Co/Pr/Kill Dt(d) Sel(C)
      *
     FPKCGCPL1IF  E           K        DISK
      * RTV : Producer History WKLY     Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPKB1CPL1IF  E           K        DISK
      * RTV : Carcass Detail            Retrieval index
      *
     FPKBYREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Row  Cmp/MinCrc(d)
      *
     FPKBZREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%
      *
     FPKCGCPL0UF  E           K        DISK                      A
      * UPD : Producer History WKLY     Update index
      *
     FPKTDPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Clc Producer History  PF  Print file
      *
     I@CGCPIQ
      * Producer History WKLY     Update index
      * Renamed input format fields
     I              CGY3A1                          WAY3A1
     I              CGABCD                          WAABCD
     I              CGUVST                          WAUVST
     I              CGDZDT                          WADZDT
     I              CGOJJF                          WAOJJF
     I              CGALHD                          WAALHD
     I              CGKDUR                          WAKDUR
     I              CGKJOQ                          WAKJOQ
     I              CGJOWR                          WAJOWR
     I              CGOIWE                          WAOIWE
     I              CGIOTR                          WAIOTR
     I              CGJOWK                          WAJOWK
     I              CGUQWP                          WAUQWP
     I              CGO6PC                          WAO6PC
     I              CGJKSE                          WAJKSE
     I              CGG8PC                          WAG8PC
     I              CGHAPC                          WAHAPC
     I              CGORJG                          WAORJG
     I              CGHDPC                          WAHDPC
     I              CGHFPC                          WAHFPC
     I              CGS1PR                          WAS1PR
     I              CGTCPR                          WATCPR
     I              CGS3PR                          WAS3PR
     I              CGTDPR                          WATDPR
     I              CGS5PR                          WAS5PR
     I              CGTEPR                          WATEPR
     I              CGS7PR                          WAS7PR
     I              CGTFPR                          WATFPR
     I              CGB6A1                          WAB6A1
     I              CGJKOS                          WAJKOS
     I              CGALRC                          WAALRC
     I              CGKDIE                          WAKDIE
     I              CGJOEW                          WAJOEW
     I              CGOWUI                          WAOWUI
     I              CGIOWN                          WAIOWN
     I              CGORMB                          WAORMB
     I              CGJOQR                          WAJOQR
     I              CGPRUR                          WAPRUR
     I              CGG7PC                          WAG7PC
     I              CGIOOG                          WAIOOG
     I              CGG9PC                          WAG9PC
     I              CGHBPC                          WAHBPC
     I              CGUWOE                          WAUWOE
     I              CGHEPC                          WAHEPC
     I              CGHGPC                          WAHGPC
     I              CGS2PR                          WAS2PR
     I              CGTGPR                          WATGPR
     I              CGS4PR                          WAS4PR
     I              CGTHPR                          WATHPR
     I              CGS6PR                          WAS6PR
     I              CGTIPR                          WATIPR
     I              CGS8PR                          WAS8PR
     I              CGTJPR                          WATJPR
     I              CGB8A1                          WAB8A1
     I              CGAAVN                          WAAAVN
     I              CGAADT                          WAAADT
     I              CGAMTM                          WAAMTM
     I              CGAJST                          WAAJST
     I              CGAHVN                          WAAHVN
     I              CGAGVN                          WAAGVN
     I              CGABVN                          WAABVN
     I              CGABDT                          WAABDT
     I              CGABTM                          WAABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
     IQPKCG1    E DSPKCGCPL0
      * UPD : Producer History WKLY     Update index
      * Renamed input format fields
     I              CGY3A1                          WAY3A1
     I              CGABCD                          WAABCD
     I              CGUVST                          WAUVST
     I              CGDZDT                          WADZDT
     I              CGOJJF                          WAOJJF
     I              CGALHD                          WAALHD
     I              CGKDUR                          WAKDUR
     I              CGKJOQ                          WAKJOQ
     I              CGJOWR                          WAJOWR
     I              CGOIWE                          WAOIWE
     I              CGIOTR                          WAIOTR
     I              CGJOWK                          WAJOWK
     I              CGUQWP                          WAUQWP
     I              CGO6PC                          WAO6PC
     I              CGJKSE                          WAJKSE
     I              CGG8PC                          WAG8PC
     I              CGHAPC                          WAHAPC
     I              CGORJG                          WAORJG
     I              CGHDPC                          WAHDPC
     I              CGHFPC                          WAHFPC
     I              CGS1PR                          WAS1PR
     I              CGTCPR                          WATCPR
     I              CGS3PR                          WAS3PR
     I              CGTDPR                          WATDPR
     I              CGS5PR                          WAS5PR
     I              CGTEPR                          WATEPR
     I              CGS7PR                          WAS7PR
     I              CGTFPR                          WATFPR
     I              CGB6A1                          WAB6A1
     I              CGJKOS                          WAJKOS
     I              CGALRC                          WAALRC
     I              CGKDIE                          WAKDIE
     I              CGJOEW                          WAJOEW
     I              CGOWUI                          WAOWUI
     I              CGIOWN                          WAIOWN
     I              CGORMB                          WAORMB
     I              CGJOQR                          WAJOQR
     I              CGPRUR                          WAPRUR
     I              CGG7PC                          WAG7PC
     I              CGIOOG                          WAIOOG
     I              CGG9PC                          WAG9PC
     I              CGHBPC                          WAHBPC
     I              CGUWOE                          WAUWOE
     I              CGHEPC                          WAHEPC
     I              CGHGPC                          WAHGPC
     I              CGS2PR                          WAS2PR
     I              CGTGPR                          WATGPR
     I              CGS4PR                          WAS4PR
     I              CGTHPR                          WATHPR
     I              CGS6PR                          WAS6PR
     I              CGTIPR                          WATIPR
     I              CGS8PR                          WAS8PR
     I              CGTJPR                          WATJPR
     I              CGB8A1                          WAB8A1
     I              CGAAVN                          WAAAVN
     I              CGAADT                          WAAADT
     I              CGAMTM                          WAAMTM
     I              CGAJST                          WAAJST
     I              CGAHVN                          WAAHVN
     I              CGAGVN                          WAAGVN
     I              CGABVN                          WAABVN
     I              CGABDT                          WAABDT
     I              CGABTM                          WAABTM
      *
     IYARDCS      DS                            242
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IYBRDCS      DS                            242
     IYCRDCS      DS                            242
     IYDRDCS      DS                            242
     IYERDCS      DS                            242
     IYFRDCS      DS                            242
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
     IP2PARM      DS
      * FLD: Producer History WKLY
      * N :  PH ALL DOA
     I                                    P   1   40P2OJJF
      * N :  PH ALL Head Received
     I                                    P   5   80P2ALHD
      * N :  PH ALL Yard Deads
     I                                    P   9  120P2KDUR
      * N :  PH ALL Head Condemned
     I                                    P  13  160P2KJOQ
      * N :  PH ALL Head Killed
     I                                    P  17  200P2JOWR
      * N :  PH ALL Live Weight
     I                                    P  21  261P2OIWE
      * N :  PH ALL Avg Live Wgt
     I                                    P  27  291P2IOTR
      * N :  PH ALL Hot Weight
     I                                    P  30  351P2JOWK
      * N :  PH ALL Avg Hot Wgt
     I                                    P  36  381P2UQWP
      * N :  PH ALL Actual Yield%
     I                                    P  39  412P2O6PC
      * N :  PH ALL Adj Live Weight
     I                                    P  42  471P2JKSE
      * N :  PH ALL Adjusted Yield%
     I                                    P  48  502P2G8PC
      * N :  PH ALL Avg Lean%
     I                                    P  51  521P2HAPC
      * N :  PH ALL Avg Backfat
     I                                    P  53  541P2ORJG
      * N :  PH ALL Avg Loin Eye
     I                                    P  55  561P2HDPC
      * N :  PH ALL Avg Light Ref
     I                                    P  57  581P2HFPC
      * N :  PH ALL Base /Live CWT
     I                                    P  59  612P2S1PR
      * N :  PH ALL Base /Carc CWT
     I                                    P  62  642P2TCPR
      * N :  PH ALL Sort Dsc /Live CWT
     I                                    P  65  672P2S3PR
      * N :  PH ALL Sort Dsc /Carc CWT
     I                                    P  68  702P2TDPR
      * N :  PH ALL Lean Prm /Live CWT
     I                                    P  71  732P2S5PR
      * N :  PH ALL Lean Prm /Carc CWT
     I                                    P  74  762P2TEPR
      * N :  PH ALL Gross /Live CWT
     I                                    P  77  792P2S7PR
      * N :  PH ALL Gross /Carc CWT
     I                                    P  80  822P2TFPR
      * N :  PH GA DOA
     I                                    P  83  860P2JKOS
      * N :  PH GA Head Received
     I                                    P  87  900P2ALRC
      * N :  PH GA Yard Deads
     I                                    P  91  940P2KDIE
      * N :  PH GA Head Condemned
     I                                    P  95  980P2JOEW
      * N :  PH GA Head Killed
     I                                    P  99 1020P2OWUI
      * N :  PH GA Live Weight
     I                                    P 103 1081P2IOWN
      * N :  PH GA Avg Live Wgt
     I                                    P 109 1111P2ORMB
      * N :  PH GA Hot Weight
     I                                    P 112 1171P2JOQR
      * N :  PH GA Avg Hot Wgt
     I                                    P 118 1201P2PRUR
      * N :  PH GA Actual Yield%
     I                                    P 121 1232P2G7PC
      * N :  PH GA Adj Live Weight
     I                                    P 124 1291P2IOOG
      * N :  PH GA Adjusted Yield%
     I                                    P 130 1322P2G9PC
      * N :  PH GA Avg Lean%
     I                                    P 133 1341P2HBPC
      * N :  PH GA Avg Backfat
     I                                    P 135 1361P2UWOE
      * N :  PH GA Avg Loin Eye
     I                                    P 137 1381P2HEPC
      * N :  PH GA Avg Light Ref
     I                                    P 139 1401P2HGPC
      * N :  PH GA Base /Live CWT
     I                                    P 141 1432P2S2PR
      * N :  PH GA Base /Carc CWT
     I                                    P 144 1462P2TGPR
      * N :  PH GA Sort Dsc /Live CWT
     I                                    P 147 1492P2S4PR
      * N :  PH GA Sort Dsc /Carc CWT
     I                                    P 150 1522P2THPR
      * N :  PH GA Lean Prm /Live CWT
     I                                    P 153 1552P2S6PR
      * N :  PH GA Lean Prm /Carc CWT
     I                                    P 156 1582P2TIPR
      * N :  PH GA Gross /Live CWT
     I                                    P 159 1612P2S8PR
      * N :  PH GA Gross /Carc CWT
     I                                    P 162 1642P2TJPR
     IP3PARM      DS
      * FLD: *Arrays
      * I :  Week(1)               USR
     I                                    P   1   40P3EHDT
      * I :  Date USR
     I                                    P   5   80P3B5DT
      * I :  Week(2)               USR
     I                                    P   9  120P3EIDT
      * I :  Date From USR
     I                                    P  13  160P3B3DT
      * I :  Week(4)
     I                                    P  17  200P3EFDT
      * I :  Date To   USR
     I                                    P  21  240P3B4DT
      * I :  Text 1                USR
     I                                       25  25 P3PETX
      * N :  Base Mkt Price Amt    USR
     I                                    P  26  332P3GYVA
      * N :  Sort Discount Amt     USR
     I                                    P  34  412P3GZVA
      * N :  LN AddOn/Deduct Amt   USR
     I                                    P  42  492P3G0VA
      * N :  Gross Amount          USR
     I                                    P  50  572P3GWVA
      * N :  Base Mkt Price Amt 2  USR
     I                                    P  58  652P3I7VA
      * N :  Sort Discount Amt 2   USR
     I                                    P  66  732P3I8VA
      * N :  LN AddOn/Deduct Amt 2 USR
     I                                    P  74  812P3I9VA
      * N :  Gross Amount 2        USR
     I                                    P  82  892P3JAVA
      * N :  Lean % * Wgt USR
     I                                    P  90  972P3NNNB
      * N :  Lean % * Wgt USR 2
     I                                    P  98 1052P3WQNB
      * N :  Backfat * Wgt USR
     I                                    P 106 1132P3NONB
      * N :  Backfat * Wgt USR 2
     I                                    P 114 1212P3WERQ
      * N :  Loin-Eye * Wgt USR
     I                                    P 122 1292P3NPNB
      * N :  Loin-Eye * Wgt USR 2
     I                                    P 130 1372P3GHH5
      * N :  Light Refl * Wgt Usr
     I                                    P 138 1452P3SZNB
      * N :  Light Refl * Wgt Usr 2
     I                                    P 146 1532P3RERR
      * N :  Sort Factor Tot ALL USR
     I                                    P 154 1593P3CBA1
      * N :  Sort factor Tot GA USR
     I                                    P 160 1653P3CCA1
      * N :  Sort Factor Carc ALL SUM
     I                                    P 166 1700P3CFA1
      * N :  Sort Factor Carc GA SUM
     I                                    P 171 1750P3CGA1
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P3EHDT    PARM           WP0002  70       Week(1)
     C           P3B5DT    PARM           WP0003  70       Date USR
     C           P3EIDT    PARM           WP0004  70       Week(2)
     C           P3B3DT    PARM           WP0005  70       Date From USR
     C           P3EFDT    PARM           WP0006  70       Week(4)
     C           P3B4DT    PARM           WP0007  70       Date To   USR
     C           P3PETX    PARM           WP0008  1        Text 1
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc Producer History  PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$KENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Clc Producer History  PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@ACREAI                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELACABCD    $CABCD           PD Producer Cod
     C                     MOVELACAGTX    $CAGTX           PD Name
     C                     Z-ADDACALNB    $CALNB           PD Production C
     C                     Z-ADDACAATH    $CAATH           PD Std Delv Tim
     C                     Z-ADDACAMNB    $CAMNB           PD Std Truck Si
     C                     MOVELACIWST    $CIWST           PD Freight Exp
     C                     MOVELACAPST    $CAPST           PD Fax Status
     C                     Z-ADDACGCNB    $CGCNB           PD VND Address
     C                     Z-ADDACGJNB    $CGJNB           PD EDI Trading
     C                     MOVELACC2TX    $CC2TX           PD VND Category
     C                     MOVELACAACD    $CAACD           SR Source Code
     C                     MOVELACACCD    $CACCD           HB Buyer Code
     C                     MOVELACADCD    $CADCD           Commission Prod
     C                     MOVELACAAVN    $CAAVN           RS User Changed
     C                     Z-ADDACAADT    $CAADT           RS Date Changed
     C                     Z-ADDACAMTM    $CAMTM           RS Time Changed
     C                     MOVELACAJST    $CAJST           RS Record Statu
     C                     MOVELACAHVN    $CAHVN           RS Job
     C                     MOVELACAGVN    $CAGVN           RS Program
     C                     MOVELACABVN    $CABVN           RS User Added
     C                     Z-ADDACABDT    $CABDT           RS Date Added
     C                     Z-ADDACABTM    $CABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Clc Producer History   PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Clc Producer History(1)PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Clc Producer History(1)PO
     C                     EXSR UJSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @ACREAI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.PD Producer Code is Blank
     C           ACABCD    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Chk Exists Co/Prd  RT - Tattoo Header  * 
     C                     EXSR THRVGN
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0019    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     ELSE
      * Next record - Detect level breaks
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Clc Producer History   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN A1ABCD    WQKB02           PD Producer Cod
      * Define keylist
     C           KPSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           PD Producer Cod
     C                     KFLD           A1B0DT           TH Kill Date
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQKB01           BOH Company Num
     C                     MOVELACABCD    WQKB02           PD Producer Cod
     C                     Z-ADDP3B5DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KPSB      SETLL@A1CPEB                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
      * USER: Null report processing
      * CASE: PAR.PH ALL Head Received is GT Zero
     C           P2ALHD    IFGT *ZERO                      *IF
      * ALL: Avg Live Wgt
      * CASE: PAR.PH ALL Head Received is GT Zero
     C           P2ALHD    IFGT *ZERO                      *IF
     C           P2OIWE    DIV  P2ALHD    WN0001    H      PH ALL Avg Live
     C                     END                             *FI
      * ALL: Avg Hot Wgt
      * CASE: PAR.PH ALL Head Killed is GT Zero
     C           P2JOWR    IFGT *ZERO                      *IF
     C           P2JOWK    DIV  P2JOWR    WN0002    H      PH ALL Avg Hot
     C                     END                             *FI
      * ALL: Actual Yield & /Live CWT
      * CASE: PAR.PH ALL Live Weight is Ne'0'
     C           P2OIWE    IFNE 0                          *IF
      * Actual Yield
      * PAR.PH ALL Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  P2OIWE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0003           PH ALL Actual Y
      * Base /Live
      * PAR.PH ALL Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           PH ALL Base /Li
      * Sort /Live
      * PAR.PH ALL Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           PH ALL Sort Dsc
      * Prem /Live
      * PAR.PH ALL Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3G0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0013           PH ALL Lean Prm
      * Gross /Live
      * PAR.PH ALL Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0015           PH ALL Gross /L
     C                     END                             *FI
      * ALL: Adjusted Yield
      * CASE: PAR.PH ALL Adj Live Weight is Ne'0'
     C           P2JKSE    IFNE 0                          *IF
      * Adjusted Yield
      * PAR.PH ALL Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH ALL Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  P2JKSE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           PH ALL Adjusted
     C                     END                             *FI
      * ALL: Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: PAR.PH ALL Hot Weight is Ne'0'
     C           P2JOWK    IFNE 0                          *IF
     C           P3NNNB    DIV  P2JOWK    WN0005    H      PH ALL Avg Lean
     C           P3NONB    DIV  P2JOWK    WN0006    H      PH ALL Avg Back
     C           P3NPNB    DIV  P2JOWK    WN0007    H      PH ALL Avg Loin
     C           P3SZNB    DIV  P2JOWK    WN0008    H      PH ALL Avg Ligh
      * Base /Carc
      * PAR.PH ALL Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           PH ALL Base /Ca
      * Sort /Carc
      * PAR.PH ALL Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0012           PH ALL Sort Dsc
      * Prem /Carc
      * PAR.PH ALL Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3G0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0014           PH ALL Lean Prm
      * Gross /Carc
      * PAR.PH ALL Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0016           PH ALL Gross /C
     C                     END                             *FI
      * ALL: Average Sort Discount Factor
      * CASE: PAR.Sort Factor Carc ALL SUM is GT Zero
     C           P3CFA1    IFGT *ZERO                      *IF
     C           P3CBA1    DIV  P3CFA1    WN0017    H      PH ALL Avg Srt
     C                     END                             *FI
      * GA : Avg Live Wgt
      * CASE: PAR.PH GA Head Received is GT Zero
     C           P2ALRC    IFGT *ZERO                      *IF
     C           P2IOWN    DIV  P2ALRC    WN0018    H      PH GA Avg Live
     C                     END                             *FI
      * GA : Avg Hot Wgt
      * CASE: PAR.PH GA Head Killed is GT Zero
     C           P2OWUI    IFGT *ZERO                      *IF
     C           P2JOQR    DIV  P2OWUI    WN0019    H      PH GA Avg Hot W
     C                     END                             *FI
      * GA : Actual Yield & /Live CWT
      * CASE: PAR.PH GA Live Weight is Ne'0'
     C           P2IOWN    IFNE 0                          *IF
      * Actual Yield
      * PAR.PH GA Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  P2IOWN    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0020           PH GA Actual Yi
      * Base /Live
      * PAR.PH GA Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0026           PH GA Base /Liv
      * Sort /Live
      * PAR.PH GA Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0028           PH GA Sort Dsc
      * Prem /Live
      * PAR.PH GA Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0030           PH GA Lean Prm
      * Gross /Live
      * PAR.PH GA Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3JAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0032           PH GA Gross /Li
     C                     END                             *FI
      * GA : Adjusted Yield
      * CASE: PAR.PH GA Adj Live Weight is Ne'0'
     C           P2IOOG    IFNE 0                          *IF
      * Adjusted Yield
      * PAR.PH GA Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH GA Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  P2IOOG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0021           PH GA Adjusted
     C                     END                             *FI
      * GA : Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: PAR.PH GA Hot Weight is Ne'0'
     C           P2JOQR    IFNE 0                          *IF
     C           P3WQNB    DIV  P2JOQR    WN0022    H      PH GA Avg Lean%
     C           P3WERQ    DIV  P2JOQR    WN0023    H      PH GA Avg Backf
     C           P3GHH5    DIV  P2JOQR    WN0024    H      PH GA Avg Loin
     C           P3RERR    DIV  P2JOQR    WN0025    H      PH GA Avg Light
      * Base /Carc
      * PAR.PH GA Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0027           PH GA Base /Car
      * Sort /Carc
      * PAR.PH GA Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0029           PH GA Sort Dsc
      * Prem /Carc
      * PAR.PH GA Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0031           PH GA Lean Prm
      * Gross /Carc
      * PAR.PH GA Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3JAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0033           PH GA Gross /Ca
     C                     END                             *FI
      * GA : Average Sort Discount Factor
      * CASE: PAR.Sort Factor Carc GA SUM is GT Zero
     C           P3CGA1    IFGT *ZERO                      *IF
     C           P3CCA1    DIV  P3CGA1    WN0034    H      PH GA Avg Srt D
     C                     END                             *FI
      * Upd Producer History  RT - Producer History WKLY  * 
     C                     EXSR SARVGN
     C                     END                             *FI
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0BL02  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $EOQET           TH PHA Add Type
     C                     MOVEL*BLANK    $EUVST           PH Summary Type
     C                     Z-ADD*ZERO     $EOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     $EALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     $EKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     $EKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     $EJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     $EOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     $EJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     $EJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     $EIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     $EUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     $EO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     $EG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     $EHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     $ENNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $EORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     $ENONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     $EHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     $ENPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $EHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     $ESZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     $EGYVA           Base Mkt Price
     C                     Z-ADD*ZERO     $EGZVA           Sort Discount A
     C                     Z-ADD*ZERO     $EG0VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     $EGWVA           Gross Amount
     C                     Z-ADD*ZERO     $ECFA1           Sort Factor Car
     C                     Z-ADD*ZERO     $EB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     $ECBA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $ET0PR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $ET1PR           TH CM Sort Disc
     C                     Z-ADD*ZERO     $ET2PR           TH CM Yield Gai
     C                     Z-ADD*ZERO     $ET3PR           TH CM Base Carc
     C                     Z-ADD*ZERO     $ET5PR           TH CM LN AddOn/
     C                     Z-ADD*ZERO     $ET6PR           TH CM Carcass G
     C                     Z-ADD*ZERO     $EYUUI           TH Unused Nbr 6
     C                     Z-ADD*ZERO     $ET4PR           TH Deduction Am
     C                     Z-ADD*ZERO     $ET7PR           TH CM Lean Prem
     C                     Z-ADD*ZERO     $ES1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     $ETCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     $ES3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $ETDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $ES5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $ETEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $ES7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     $ETFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     $EJKOS           PH GA DOA
     C                     Z-ADD*ZERO     $EALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     $EKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     $EJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     $EOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     $EIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     $EIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     $EJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     $EORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     $EPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $EG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     $EG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     $EHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     $EWQNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $EUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     $EWERQ           Backfat * Wgt U
     C                     Z-ADD*ZERO     $EHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     $EGHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $EHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     $ERERR           Light Refl * Wg
     C                     Z-ADD*ZERO     $EI7VA           Base Mkt Price
     C                     Z-ADD*ZERO     $EI8VA           Sort Discount A
     C                     Z-ADD*ZERO     $EI9VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     $EJAVA           Gross Amount 2
     C                     Z-ADD*ZERO     $ECGA1           Sort Factor Car
     C                     Z-ADD*ZERO     $EB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     $ECCA1           Sort factor Tot
     C                     Z-ADD*ZERO     $EUHPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $EUIPR           TH CM Sort Disc
     C                     Z-ADD*ZERO     $EUJPR           TH CM Yield Gai
     C                     Z-ADD*ZERO     $EUKPR           TH CM Base Carc
     C                     Z-ADD*ZERO     $EULPR           TH CM LN AddOn/
     C                     Z-ADD*ZERO     $EUMPR           TH CM Carcass G
     C                     Z-ADD*ZERO     $EGFDH           TH Unused Nbr 6
     C                     Z-ADD*ZERO     $EUNPR           TH Deduction Am
     C                     Z-ADD*ZERO     $EHUPC           PH GA Adjusted
     C                     Z-ADD*ZERO     $ES2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     $ETGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     $ES4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $ETHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $ES6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $ETIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $ES8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     $ETJPR           PH GA Gross /Ca
     C                     MOVEL*BLANK    $EIXTX           Blank Usr 1 fld
     C                     Z-ADD*ZERO     $EVWQE           PH GA Avg Live
     C                     Z-ADD*ZERO     $EVEQQ           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $EHTPC           PH GA Actual Yi
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $DGRR4           Amount2 * Hot W
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $DBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $DBONB           BOL Load Number
     C                     MOVEL*BLANK    $DJFTX           All Text
     C                     Z-ADDA1B0DT    $DB0DT           TH Kill Date
     C                     Z-ADDA1CVNB    $DCVNB           TH Tattoo Numbe
     C                     Z-ADDA1AWDT    $DAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $DBICD           TH Group Refere
     C                     MOVELA1CPST    $DCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $DACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $DB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $DCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $DC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $DAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $DA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $DC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    $DCXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    $DCWNB           TH Head Receive
     C                     Z-ADDA1FCNB    $DFCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    $DH9NB           TH Held Over
     C                     Z-ADDA1FDNB    $DFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    $DFENB           TH Head Killed
     C                     Z-ADDA1HENB    $DHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $DHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    $DCYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    $DLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $DE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $DA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $DFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $DA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $DF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    $DHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1AWPC    $DAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $DCWPC           TH Adj Actual Y
     C                     Z-ADDA1F4NB    $DF4NB           TH Avg Lean Per
     C                     Z-ADDA1F2NB    $DF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     $DSZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     $DRERR           Light Refl * Wg
     C                     Z-ADD*ZERO     $DNNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $DWQNB           Lean % * Wgt US
     C                     Z-ADDA1F3NB    $DF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F5NB    $DF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     $DNPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $DGHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $DNONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     $DWERQ           Backfat * Wgt U
     C                     Z-ADDA1AVPC    $DAVPC           TH Std Yield Pe
     C                     Z-ADDA1A8PC    $DA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $DA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $DB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $DAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $DTCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     $DTDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $DS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $DS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     $DTFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     $DS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     $DS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $DJKOS           PH GA DOA
     C                     Z-ADD*ZERO     $DALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     $DKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     $DJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     $DOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     $DIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     $DORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     $DIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     $DG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     $DPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $DJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     $DG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     $DUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     $DS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     $DHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     $DHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     $DHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     $DTGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     $DS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $DTHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $DS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $DTIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $DS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     $DTJPR           PH GA Gross /Ca
     C                     Z-ADDA1ANPR    $DANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $DAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $DAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $DAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $DAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $DAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $DASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $DA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $DATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $DA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    $DCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $DKFNB           Carcass Count U
     C                     Z-ADD*ZERO     $DCDA1           Sort Factor Tot
     C                     Z-ADDA1CCPR    $DCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $DLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $DCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $DA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $DA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $DJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $DCWST           TH Payment Sts
     C                     MOVELA1D7ST    $DD7ST           TH Header Error
     C                     MOVELA1D8ST    $DD8ST           TH Detail Error
     C                     MOVELA1DWST    $DDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $DD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $DGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $DBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $DE0ST           TH User Error O
     C                     MOVELA1E1ST    $DE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $DE2ST           TH Sex
     C                     Z-ADDA1BSDT    $DBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $DBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $DBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $DHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $DHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $DHINB           TH FFLI
     C                     Z-ADDA1A3PR    $DA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $DA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $DA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $DJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $DD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $DD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $DD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $DD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $DEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $DEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $DECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $DEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $DEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $DEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $DEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $DEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $DKAST           TH Source Type
     C                     MOVELA1J7ST    $DJ7ST           TH Scale Ticket
     C                     MOVELA1J9ST    $DJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    $DOXNB           TH HPS Movement
     C                     MOVELA1LKST    $DLKST           TH Source Code
     C                     MOVELA1LLST    $DLLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $DJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $DLIST           TH Schedule Kil
     C                     MOVELA1LJST    $DLJST           TH Shift Held O
     C                     MOVELA1NZTX    $DNZTX           TH State
     C                     MOVELA1HJCD    $DHJCD           TH Unused Code
     C                     MOVELA1R4ST    $DR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $DR5ST           TH Commission S
     C                     MOVELA1R6ST    $DR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $DR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $DTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $DT2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $DTHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $DT2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $DOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $DKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $DOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $DOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $DIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $DOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $DOQET           TH PHA Add Type
     C                     MOVELA1URST    $DURST           TH PHA Average
     C                     MOVELA1USST    $DUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $DHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $DS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $DTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $DTBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $DJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $DKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $DKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $DKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $DKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $DOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $DIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $DIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $DIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $DKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $DOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $DKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $DORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $DOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $DMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $DMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $DNCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $DNCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $DIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $DKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $DEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $DEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    $DECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $DEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    $DEEDT           TH Unused Date
     C                     MOVELA1U4ST    $DU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $DU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $DU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $DU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $DU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $DU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $DVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $DVBST           TH Unused Sts 8
     C                     MOVELA1BDCD    $DBDCD           DF Defect Code
     C                     MOVELA1CSCD    $DCSCD           THP Process Cod
     C                     MOVELA1ABCD    $DABCD           PD Producer Cod
     C                     MOVELA1AECD    $DAECD           PL Location Cod
     C                     MOVELA1ACCD    $DACCD           HB Buyer Code
     C                     MOVELA1AGCD    $DAGCD           GN Genetic Code
     C                     MOVELA1BECD    $DBECD           HC Class Code
     C                     MOVELA1AAVN    $DAAVN           RS User Changed
     C                     Z-ADDA1AADT    $DAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $DAMTM           RS Time Changed
     C                     MOVELA1AJST    $DAJST           RS Record Statu
     C                     MOVELA1AHVN    $DAHVN           RS Job
     C                     MOVELA1AGVN    $DAGVN           RS Program
     C                     MOVELA1ABVN    $DABVN           RS User Added
     C                     Z-ADDA1ABDT    $DABDT           RS Date Added
     C                     Z-ADDA1ABTM    $DABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * All Tattoo's
     C                     EXSR UCSUBR                     All Tattoo's
      * Not Paid w/Producer Historical Average
      * CASE: DB1.TH PHA Add Type is None
     C           A1OQET    IFEQ *BLANK                     *IF
     C                     ADD  A1CXNB    $EJKOS           PH GA DOA
     C                     ADD  A1CWNB    $EALRC           PH GA Head Rece
     C                     ADD  A1FCNB    $EKDIE           PH GA Yard Dead
     C                     ADD  A1FDNB    $EJOEW           PH GA Head Cond
     C                     ADD  A1FENB    $EOWUI           PH GA Head Kill
     C                     ADD  A1CYNB    $EIOWN           PH GA Live Weig
     C                     ADD  A1E0NB    $EJOQR           PH GA Hot Weigh
     C                     ADD  A1LRNB    $EIOOG           PH GA Adj Live
     C                     ADD  A1ANPR    $EI7VA           Base Mkt Price
     C                     ADD  A1AYVA    $EI8VA           Sort Discount A
     C                     ADD  A1AXVA    $EI9VA           LN AddOn/Deduct
     C                     ADD  A1CBPR    $EJAVA           Gross Amount 2
     C                     ADD  $DWQNB    $EWQNB           Lean % * Wgt US
     C                     ADD  $DWERQ    $EWERQ           Backfat * Wgt U
     C                     ADD  $DGHH5    $EGHH5           Loin-Eye * Wgt
     C                     ADD  $DRERR    $ERERR           Light Refl * Wg
     C                     ADD  $DCDA1    $ECCA1           Sort factor Tot
     C                     ADD  $DKFNB    $ECGA1           Sort Factor Car
     C                     END                             *FI
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZB001           BOH Company Num
     C                     Z-ADDA1HMNB    WZB001
     C           *LIKE     DEFN A1ABCD    WZB002           PD Producer Cod
     C                     MOVELA1ABCD    WZB002
     C           *LIKE     DEFN A1B0DT    WZB003           TH Kill Date
     C                     Z-ADDA1B0DT    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@A1CPEB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * kill Date is Less than  Wekk(1) Select the Record
      * CASE: DB1.TH Kill Date LT PAR.Week(1)               USR
     C           A1B0DT    IFLT P3EHDT                     *IF
      * CASE: PAR.PH Summary Type is 1 Week
     C           '1WK'     IFEQ '1WK'                      *IF
      * EOF File B            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE
     C                     ELSE
      * CASE: PAR.PH Summary Type is 2 Week
     C           '1WK'     IFEQ '2WK'                      *IF
      * EOF File C            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFC           END OF FILE
     C                     ELSE
      * CASE: PAR.PH Summary Type is 4 Week
     C           '1WK'     IFEQ '4WK'                      *IF
      * EOF File D            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFD           END OF FILE
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH Head Received is *Zeros
     C           A1CWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        PD Producer Cod
     C                     MOVEL*BLANK    W0BL02  1        TH Kill Date
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0BL02  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           A1ABCD    IFNE WZB002                     PD Producer Cod
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           A1B0DT    IFNE WZB003                     TH Kill Date
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     MOVEL'1WK'     $EUVST           PH Summary Type
      * ALL: Add PAR to CUR
     C                     EXSR UDSUBR                     ALL: Add PAR to
      * ALL: Avg Live Wgt
      * CASE: CUR.PH ALL Head Received is GT Zero
     C           $EALHD    IFGT *ZERO                      *IF
     C           $EOIWE    DIV  $EALHD    $EIOTR    H      PH ALL Avg Live
     C                     END                             *FI
      * ALL: Avg Hot Wgt
      * CASE: CUR.PH ALL Head Killed is GT Zero
     C           $EJOWR    IFGT *ZERO                      *IF
     C           $EJOWK    DIV  $EJOWR    $EUQWP    H      PH ALL Avg Hot
     C                     END                             *FI
      * ALL: Actual Yield & /Live CWT
      * CASE: CUR.PH ALL Live Weight is Ne'0'
     C           $EOIWE    IFNE 0                          *IF
      * Actual Yield
      * CUR.PH ALL Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $EJOWK    DIV  $EOIWE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $EO6PC           PH ALL Actual Y
      * Base /Live
      * CUR.PH ALL Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EGYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES1PR           PH ALL Base /Li
      * Sort /Live
      * CUR.PH ALL Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EGZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES3PR           PH ALL Sort Dsc
      * Prem /Live
      * CUR.PH ALL Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EG0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES5PR           PH ALL Lean Prm
      * Gross /Live
      * CUR.PH ALL Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EGWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES7PR           PH ALL Gross /L
     C                     END                             *FI
      * ALL: Adjusted Yield
      * CASE: CUR.PH ALL Adj Live Weight is Ne'0'
     C           $EJKSE    IFNE 0                          *IF
      * Adjusted Yield
      * CUR.PH ALL Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH ALL Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $EJOWK    DIV  $EJKSE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $EG8PC           PH ALL Adjusted
     C                     END                             *FI
      * ALL: Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: CUR.PH ALL Hot Weight is Ne'0'
     C           $EJOWK    IFNE 0                          *IF
     C           $ENNNB    DIV  $EJOWK    $EHAPC    H      PH ALL Avg Lean
     C           $ENONB    DIV  $EJOWK    $EORJG    H      PH ALL Avg Back
     C           $ENPNB    DIV  $EJOWK    $EHDPC    H      PH ALL Avg Loin
     C           $ESZNB    DIV  $EJOWK    $EHFPC    H      PH ALL Avg Ligh
      * Base /Carc
      * CUR.PH ALL Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EGYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETCPR           PH ALL Base /Ca
      * Sort /Carc
      * CUR.PH ALL Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EGZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETDPR           PH ALL Sort Dsc
      * Prem /Carc
      * CUR.PH ALL Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EG0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETEPR           PH ALL Lean Prm
      * Gross /Carc
      * CUR.PH ALL Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EGWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETFPR           PH ALL Gross /C
     C                     END                             *FI
      * ALL: Average Sort Discount Factor
      * CASE: CUR.Sort Factor Carc ALL SUM is GT Zero
     C           $ECFA1    IFGT *ZERO                      *IF
     C           $ECBA1    DIV  $ECFA1    $EB6A1    H      PH ALL Avg Srt
     C                     END                             *FI
      * GA : Add PAR to CUR
     C                     EXSR UESUBR                     GA : Add PAR to
      * GA : Avg Live Wgt
      * CASE: CUR.PH GA Head Received is GT Zero
     C           $EALRC    IFGT *ZERO                      *IF
     C           $EIOWN    DIV  $EALRC    $EORMB    H      PH GA Avg Live
     C                     END                             *FI
      * GA : Avg Hot Wgt
      * CASE: CUR.PH GA Head Killed is GT Zero
     C           $EOWUI    IFGT *ZERO                      *IF
     C           $EJOQR    DIV  $EOWUI    $EPRUR    H      PH GA Avg Hot W
     C                     END                             *FI
      * GA : Actual Yield & /Live CWT
      * CASE: CUR.PH GA Live Weight is Ne'0'
     C           $EIOWN    IFNE 0                          *IF
      * Actual Yield
      * CUR.PH GA Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $EJOQR    DIV  $EIOWN    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $EG7PC           PH GA Actual Yi
      * Base /Live
      * CUR.PH GA Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EI7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES2PR           PH GA Base /Liv
      * Sort /Live
      * CUR.PH GA Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EI8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES4PR           PH GA Sort Dsc
      * Prem /Live
      * CUR.PH GA Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EI9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES6PR           PH GA Lean Prm
      * Gross /Live
      * CUR.PH GA Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EJAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ES8PR           PH GA Gross /Li
     C                     END                             *FI
      * GA : Adjusted Yield
      * CASE: CUR.PH GA Adj Live Weight is Ne'0'
     C           $EIOOG    IFNE 0                          *IF
      * Adjusted Yield
      * CUR.PH GA Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH GA Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $EJOQR    DIV  $EIOOG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $EG9PC           PH GA Adjusted
     C                     END                             *FI
      * GA : Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: CUR.PH GA Hot Weight is Ne'0'
     C           $EJOQR    IFNE 0                          *IF
     C           $EWQNB    DIV  $EJOQR    $EHBPC    H      PH GA Avg Lean%
     C           $EWERQ    DIV  $EJOQR    $EUWOE    H      PH GA Avg Backf
     C           $EGHH5    DIV  $EJOQR    $EHEPC    H      PH GA Avg Loin
     C           $ERERR    DIV  $EJOQR    $EHGPC    H      PH GA Avg Light
      * Base /Carc
      * CUR.PH GA Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EI7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETGPR           PH GA Base /Car
      * Sort /Carc
      * CUR.PH GA Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EI8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETHPR           PH GA Sort Dsc
      * Prem /Carc
      * CUR.PH GA Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EI9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETIPR           PH GA Lean Prm
      * Gross /Carc
      * CUR.PH GA Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $EJAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ETJPR           PH GA Gross /Ca
     C                     END                             *FI
      * GA : Average Sort Discount Factor
      * CASE: CUR.Sort Factor Carc GA SUM is GT Zero
     C           $ECGA1    IFGT *ZERO                      *IF
     C           $ECCA1    DIV  $ECGA1    $EB8A1    H      PH GA Avg Srt D
     C                     END                             *FI
      * PAR = CUR By name
     C                     Z-ADD$EOJJF    P2OJJF           PH ALL DOA
     C                     Z-ADD$EALHD    P2ALHD           PH ALL Head Rec
     C                     Z-ADD$EKDUR    P2KDUR           PH ALL Yard Dea
     C                     Z-ADD$EKJOQ    P2KJOQ           PH ALL Head Con
     C                     Z-ADD$EJOWR    P2JOWR           PH ALL Head Kil
     C                     Z-ADD$EOIWE    P2OIWE           PH ALL Live Wei
     C                     Z-ADD$EIOTR    WN0001           PH ALL Avg Live
     C                     Z-ADD$EJOWK    P2JOWK           PH ALL Hot Weig
     C                     Z-ADD$EUQWP    WN0002           PH ALL Avg Hot
     C                     Z-ADD$EO6PC    WN0003           PH ALL Actual Y
     C                     Z-ADD$EJKSE    P2JKSE           PH ALL Adj Live
     C                     Z-ADD$EG8PC    WN0004           PH ALL Adjusted
     C                     Z-ADD$EHAPC    WN0005           PH ALL Avg Lean
     C                     Z-ADD$EORJG    WN0006           PH ALL Avg Back
     C                     Z-ADD$EHDPC    WN0007           PH ALL Avg Loin
     C                     Z-ADD$EHFPC    WN0008           PH ALL Avg Ligh
     C                     Z-ADD$ES1PR    WN0009           PH ALL Base /Li
     C                     Z-ADD$ETCPR    WN0010           PH ALL Base /Ca
     C                     Z-ADD$ES3PR    WN0011           PH ALL Sort Dsc
     C                     Z-ADD$ETDPR    WN0012           PH ALL Sort Dsc
     C                     Z-ADD$ES5PR    WN0013           PH ALL Lean Prm
     C                     Z-ADD$ETEPR    WN0014           PH ALL Lean Prm
     C                     Z-ADD$ES7PR    WN0015           PH ALL Gross /L
     C                     Z-ADD$ETFPR    WN0016           PH ALL Gross /C
     C                     Z-ADD$EB6A1    WN0017           PH ALL Avg Srt
     C                     Z-ADD$EJKOS    P2JKOS           PH GA DOA
     C                     Z-ADD$EALRC    P2ALRC           PH GA Head Rece
     C                     Z-ADD$EKDIE    P2KDIE           PH GA Yard Dead
     C                     Z-ADD$EJOEW    P2JOEW           PH GA Head Cond
     C                     Z-ADD$EOWUI    P2OWUI           PH GA Head Kill
     C                     Z-ADD$EIOWN    P2IOWN           PH GA Live Weig
     C                     Z-ADD$EORMB    WN0018           PH GA Avg Live
     C                     Z-ADD$EJOQR    P2JOQR           PH GA Hot Weigh
     C                     Z-ADD$EPRUR    WN0019           PH GA Avg Hot W
     C                     Z-ADD$EG7PC    WN0020           PH GA Actual Yi
     C                     Z-ADD$EIOOG    P2IOOG           PH GA Adj Live
     C                     Z-ADD$EG9PC    WN0021           PH GA Adjusted
     C                     Z-ADD$EHBPC    WN0022           PH GA Avg Lean%
     C                     Z-ADD$EUWOE    WN0023           PH GA Avg Backf
     C                     Z-ADD$EHEPC    WN0024           PH GA Avg Loin
     C                     Z-ADD$EHGPC    WN0025           PH GA Avg Light
     C                     Z-ADD$ES2PR    WN0026           PH GA Base /Liv
     C                     Z-ADD$ETGPR    WN0027           PH GA Base /Car
     C                     Z-ADD$ES4PR    WN0028           PH GA Sort Dsc
     C                     Z-ADD$ETHPR    WN0029           PH GA Sort Dsc
     C                     Z-ADD$ES6PR    WN0030           PH GA Lean Prm
     C                     Z-ADD$ETIPR    WN0031           PH GA Lean Prm
     C                     Z-ADD$ES8PR    WN0032           PH GA Gross /Li
     C                     Z-ADD$ETJPR    WN0033           PH GA Gross /Ca
     C                     Z-ADD$EB8A1    WN0034           PH GA Avg Srt D
     C                     Z-ADD$EGYVA    P3GYVA           Base Mkt Price
     C                     Z-ADD$EGZVA    P3GZVA           Sort Discount A
     C                     Z-ADD$EG0VA    P3G0VA           LN AddOn/Deduct
     C                     Z-ADD$EGWVA    P3GWVA           Gross Amount
     C                     Z-ADD$EI7VA    P3I7VA           Base Mkt Price
     C                     Z-ADD$EI8VA    P3I8VA           Sort Discount A
     C                     Z-ADD$EI9VA    P3I9VA           LN AddOn/Deduct
     C                     Z-ADD$EJAVA    P3JAVA           Gross Amount 2
     C                     Z-ADD$ENNNB    P3NNNB           Lean % * Wgt US
     C                     Z-ADD$EWQNB    P3WQNB           Lean % * Wgt US
     C                     Z-ADD$ENONB    P3NONB           Backfat * Wgt U
     C                     Z-ADD$EWERQ    P3WERQ           Backfat * Wgt U
     C                     Z-ADD$ENPNB    P3NPNB           Loin-Eye * Wgt
     C                     Z-ADD$EGHH5    P3GHH5           Loin-Eye * Wgt
     C                     Z-ADD$ESZNB    P3SZNB           Light Refl * Wg
     C                     Z-ADD$ERERR    P3RERR           Light Refl * Wg
     C                     Z-ADD$ECBA1    P3CBA1           Sort Factor Tot
     C                     Z-ADD$ECCA1    P3CCA1           Sort factor Tot
     C                     Z-ADD$ECFA1    P3CFA1           Sort Factor Car
     C                     Z-ADD$ECGA1    P3CGA1           Sort Factor Car
      * Upd Producer History  RT - Producer History WKLY  * 
     C                     EXSR SIRVGN
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Print format
     C                     WRITE$EFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Clc Producer History   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN A1ABCD    WQKC02           PD Producer Cod
      * Define keylist
     C           KPSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           PD Producer Cod
     C                     KFLD           A1B0DT           TH Kill Date
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQKC01           BOH Company Num
     C                     MOVELACABCD    WQKC02           PD Producer Cod
     C                     Z-ADDP3B3DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KPSC      SETLL@A1CPEB                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
      * USER: Null report processing
      * CASE: PAR.PH ALL Head Received is GT Zero
     C           P2ALHD    IFGT *ZERO                      *IF
      * ALL: Avg Live Wgt
      * CASE: PAR.PH ALL Head Received is GT Zero
     C           P2ALHD    IFGT *ZERO                      *IF
     C           P2OIWE    DIV  P2ALHD    WN0053    H      PH ALL Avg Live
     C                     END                             *FI
      * ALL: Avg Hot Wgt
      * CASE: PAR.PH ALL Head Killed is GT Zero
     C           P2JOWR    IFGT *ZERO                      *IF
     C           P2JOWK    DIV  P2JOWR    WN0054    H      PH ALL Avg Hot
     C                     END                             *FI
      * ALL: Actual Yield & /Live CWT
      * CASE: PAR.PH ALL Live Weight is Ne'0'
     C           P2OIWE    IFNE 0                          *IF
      * Actual Yield
      * PAR.PH ALL Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  P2OIWE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0055           PH ALL Actual Y
      * Base /Live
      * PAR.PH ALL Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0061           PH ALL Base /Li
      * Sort /Live
      * PAR.PH ALL Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0063           PH ALL Sort Dsc
      * Prem /Live
      * PAR.PH ALL Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3G0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0065           PH ALL Lean Prm
      * Gross /Live
      * PAR.PH ALL Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0067           PH ALL Gross /L
     C                     END                             *FI
      * ALL: Adjusted Yield
      * CASE: PAR.PH ALL Adj Live Weight is Ne'0'
     C           P2JKSE    IFNE 0                          *IF
      * Adjusted Yield
      * PAR.PH ALL Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH ALL Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  P2JKSE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0056           PH ALL Adjusted
     C                     END                             *FI
      * ALL: Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: PAR.PH ALL Hot Weight is Ne'0'
     C           P2JOWK    IFNE 0                          *IF
     C           P3NNNB    DIV  P2JOWK    WN0057    H      PH ALL Avg Lean
     C           P3NONB    DIV  P2JOWK    WN0058    H      PH ALL Avg Back
     C           P3NPNB    DIV  P2JOWK    WN0059    H      PH ALL Avg Loin
     C           P3SZNB    DIV  P2JOWK    WN0060    H      PH ALL Avg Ligh
      * Base /Carc
      * PAR.PH ALL Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0062           PH ALL Base /Ca
      * Sort /Carc
      * PAR.PH ALL Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0064           PH ALL Sort Dsc
      * Prem /Carc
      * PAR.PH ALL Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3G0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0066           PH ALL Lean Prm
      * Gross /Carc
      * PAR.PH ALL Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0068           PH ALL Gross /C
     C                     END                             *FI
      * ALL: Average Sort Discount Factor
      * CASE: PAR.Sort Factor Carc ALL SUM is GT Zero
     C           P3CFA1    IFGT *ZERO                      *IF
     C           P3CBA1    DIV  P3CFA1    WN0069    H      PH ALL Avg Srt
     C                     END                             *FI
      * GA : Avg Live Wgt
      * CASE: PAR.PH GA Head Received is GT Zero
     C           P2ALRC    IFGT *ZERO                      *IF
     C           P2IOWN    DIV  P2ALRC    WN0070    H      PH GA Avg Live
     C                     END                             *FI
      * GA : Avg Hot Wgt
      * CASE: PAR.PH GA Head Killed is GT Zero
     C           P2OWUI    IFGT *ZERO                      *IF
     C           P2JOQR    DIV  P2OWUI    WN0071    H      PH GA Avg Hot W
     C                     END                             *FI
      * GA : Actual Yield & /Live CWT
      * CASE: PAR.PH GA Live Weight is Ne'0'
     C           P2IOWN    IFNE 0                          *IF
      * Actual Yield
      * PAR.PH GA Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  P2IOWN    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0072           PH GA Actual Yi
      * Base /Live
      * PAR.PH GA Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0078           PH GA Base /Liv
      * Sort /Live
      * PAR.PH GA Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0080           PH GA Sort Dsc
      * Prem /Live
      * PAR.PH GA Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0082           PH GA Lean Prm
      * Gross /Live
      * PAR.PH GA Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3JAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0084           PH GA Gross /Li
     C                     END                             *FI
      * GA : Adjusted Yield
      * CASE: PAR.PH GA Adj Live Weight is Ne'0'
     C           P2IOOG    IFNE 0                          *IF
      * Adjusted Yield
      * PAR.PH GA Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH GA Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  P2IOOG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0073           PH GA Adjusted
     C                     END                             *FI
      * GA : Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: PAR.PH GA Hot Weight is Ne'0'
     C           P2JOQR    IFNE 0                          *IF
     C           P3WQNB    DIV  P2JOQR    WN0074    H      PH GA Avg Lean%
     C           P3WERQ    DIV  P2JOQR    WN0075    H      PH GA Avg Backf
     C           P3GHH5    DIV  P2JOQR    WN0076    H      PH GA Avg Loin
     C           P3RERR    DIV  P2JOQR    WN0077    H      PH GA Avg Light
      * Base /Carc
      * PAR.PH GA Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0079           PH GA Base /Car
      * Sort /Carc
      * PAR.PH GA Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0081           PH GA Sort Dsc
      * Prem /Carc
      * PAR.PH GA Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0083           PH GA Lean Prm
      * Gross /Carc
      * PAR.PH GA Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3JAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0085           PH GA Gross /Ca
     C                     END                             *FI
      * GA : Average Sort Discount Factor
      * CASE: PAR.Sort Factor Carc GA SUM is GT Zero
     C           P3CGA1    IFGT *ZERO                      *IF
     C           P3CCA1    DIV  P3CGA1    WN0086    H      PH GA Avg Srt D
     C                     END                             *FI
      * Upd Producer History  RT - Producer History WKLY  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0CL02  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $GOQET           TH PHA Add Type
     C                     MOVEL*BLANK    $GUVST           PH Summary Type
     C                     Z-ADD*ZERO     $GOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     $GALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     $GKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     $GKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     $GJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     $GOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     $GJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     $GJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     $GIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     $GUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     $GO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     $GG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     $GHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     $GNNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $GORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     $GNONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     $GHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     $GNPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $GHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     $GSZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     $GGYVA           Base Mkt Price
     C                     Z-ADD*ZERO     $GGZVA           Sort Discount A
     C                     Z-ADD*ZERO     $GG0VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     $GGWVA           Gross Amount
     C                     Z-ADD*ZERO     $GCFA1           Sort Factor Car
     C                     Z-ADD*ZERO     $GB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     $GCBA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $GT0PR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $GT1PR           TH CM Sort Disc
     C                     Z-ADD*ZERO     $GT2PR           TH CM Yield Gai
     C                     Z-ADD*ZERO     $GT3PR           TH CM Base Carc
     C                     Z-ADD*ZERO     $GT5PR           TH CM LN AddOn/
     C                     Z-ADD*ZERO     $GT6PR           TH CM Carcass G
     C                     Z-ADD*ZERO     $GYUUI           TH Unused Nbr 6
     C                     Z-ADD*ZERO     $GT4PR           TH Deduction Am
     C                     Z-ADD*ZERO     $GT7PR           TH CM Lean Prem
     C                     Z-ADD*ZERO     $GS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     $GTCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     $GS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $GTDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $GS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $GTEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $GS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     $GTFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     $GJKOS           PH GA DOA
     C                     Z-ADD*ZERO     $GALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     $GKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     $GJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     $GOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     $GIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     $GIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     $GJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     $GORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     $GPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $GG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     $GG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     $GHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     $GWQNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $GUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     $GWERQ           Backfat * Wgt U
     C                     Z-ADD*ZERO     $GHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     $GGHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $GHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     $GRERR           Light Refl * Wg
     C                     Z-ADD*ZERO     $GI7VA           Base Mkt Price
     C                     Z-ADD*ZERO     $GI8VA           Sort Discount A
     C                     Z-ADD*ZERO     $GI9VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     $GJAVA           Gross Amount 2
     C                     Z-ADD*ZERO     $GCGA1           Sort Factor Car
     C                     Z-ADD*ZERO     $GB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     $GCCA1           Sort factor Tot
     C                     Z-ADD*ZERO     $GUHPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $GUIPR           TH CM Sort Disc
     C                     Z-ADD*ZERO     $GUJPR           TH CM Yield Gai
     C                     Z-ADD*ZERO     $GUKPR           TH CM Base Carc
     C                     Z-ADD*ZERO     $GULPR           TH CM LN AddOn/
     C                     Z-ADD*ZERO     $GUMPR           TH CM Carcass G
     C                     Z-ADD*ZERO     $GGFDH           TH Unused Nbr 6
     C                     Z-ADD*ZERO     $GUNPR           TH Deduction Am
     C                     Z-ADD*ZERO     $GHUPC           PH GA Adjusted
     C                     Z-ADD*ZERO     $GS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     $GTGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     $GS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $GTHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $GS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $GTIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $GS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     $GTJPR           PH GA Gross /Ca
     C                     MOVEL*BLANK    $GIXTX           Blank Usr 1 fld
     C                     Z-ADD*ZERO     $GVWQE           PH GA Avg Live
     C                     Z-ADD*ZERO     $GVEQQ           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $GHTPC           PH GA Actual Yi
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $FGRR4           Amount2 * Hot W
     C                     Z-ADDA1HMNB    $FHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $FBONB           BOL Load Number
     C                     MOVEL*BLANK    $FJFTX           All Text
     C                     Z-ADDA1B0DT    $FB0DT           TH Kill Date
     C                     Z-ADDA1CVNB    $FCVNB           TH Tattoo Numbe
     C                     Z-ADDA1AWDT    $FAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $FBICD           TH Group Refere
     C                     MOVELA1CPST    $FCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $FACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $FB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $FCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $FC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $FAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $FA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $FC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    $FCXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    $FCWNB           TH Head Receive
     C                     Z-ADDA1FCNB    $FFCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    $FH9NB           TH Held Over
     C                     Z-ADDA1FDNB    $FFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    $FFENB           TH Head Killed
     C                     Z-ADDA1HENB    $FHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $FHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    $FCYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    $FLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $FE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $FA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $FFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $FA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $FF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    $FHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1AWPC    $FAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $FCWPC           TH Adj Actual Y
     C                     Z-ADDA1F4NB    $FF4NB           TH Avg Lean Per
     C                     Z-ADDA1F2NB    $FF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     $FSZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     $FRERR           Light Refl * Wg
     C                     Z-ADD*ZERO     $FNNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $FWQNB           Lean % * Wgt US
     C                     Z-ADDA1F3NB    $FF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F5NB    $FF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     $FNPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $FGHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $FNONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     $FWERQ           Backfat * Wgt U
     C                     Z-ADDA1AVPC    $FAVPC           TH Std Yield Pe
     C                     Z-ADDA1A8PC    $FA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $FA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $FB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $FAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $FTCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     $FTDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $FS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $FS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     $FTFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     $FS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     $FS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $FJKOS           PH GA DOA
     C                     Z-ADD*ZERO     $FALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     $FKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     $FJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     $FOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     $FIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     $FORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     $FIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     $FG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     $FPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $FJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     $FG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     $FUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     $FS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     $FHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     $FHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     $FHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     $FTGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     $FS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $FTHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $FS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $FTIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $FS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     $FTJPR           PH GA Gross /Ca
     C                     Z-ADDA1ANPR    $FANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $FAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $FAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $FAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $FAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $FAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $FASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $FA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $FATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $FA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    $FCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $FKFNB           Carcass Count U
     C                     Z-ADD*ZERO     $FCDA1           Sort Factor Tot
     C                     Z-ADDA1CCPR    $FCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $FLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $FCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $FA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $FA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $FJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $FCWST           TH Payment Sts
     C                     MOVELA1D7ST    $FD7ST           TH Header Error
     C                     MOVELA1D8ST    $FD8ST           TH Detail Error
     C                     MOVELA1DWST    $FDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $FD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $FGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $FBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $FE0ST           TH User Error O
     C                     MOVELA1E1ST    $FE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $FE2ST           TH Sex
     C                     Z-ADDA1BSDT    $FBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $FBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $FBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $FHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $FHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $FHINB           TH FFLI
     C                     Z-ADDA1A3PR    $FA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $FA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $FA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $FJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $FD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $FD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $FD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $FD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $FEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $FEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $FECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $FEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $FEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $FEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $FEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $FEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $FKAST           TH Source Type
     C                     MOVELA1J7ST    $FJ7ST           TH Scale Ticket
     C                     MOVELA1J9ST    $FJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    $FOXNB           TH HPS Movement
     C                     MOVELA1LKST    $FLKST           TH Source Code
     C                     MOVELA1LLST    $FLLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $FJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $FLIST           TH Schedule Kil
     C                     MOVELA1LJST    $FLJST           TH Shift Held O
     C                     MOVELA1NZTX    $FNZTX           TH State
     C                     MOVELA1HJCD    $FHJCD           TH Unused Code
     C                     MOVELA1R4ST    $FR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $FR5ST           TH Commission S
     C                     MOVELA1R6ST    $FR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $FR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $FTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $FT2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $FTHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $FT2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $FOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $FKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $FOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $FOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $FIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $FOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $FOQET           TH PHA Add Type
     C                     MOVELA1URST    $FURST           TH PHA Average
     C                     MOVELA1USST    $FUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $FHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $FS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $FTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $FTBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $FJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $FKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $FKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $FKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $FKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $FOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $FIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $FIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $FIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $FKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $FOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $FKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $FORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $FOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $FMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $FMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $FNCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $FNCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $FIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $FKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $FEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $FEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    $FECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $FEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    $FEEDT           TH Unused Date
     C                     MOVELA1U4ST    $FU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $FU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $FU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $FU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $FU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $FU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $FVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $FVBST           TH Unused Sts 8
     C                     MOVELA1BDCD    $FBDCD           DF Defect Code
     C                     MOVELA1CSCD    $FCSCD           THP Process Cod
     C                     MOVELA1ABCD    $FABCD           PD Producer Cod
     C                     MOVELA1AECD    $FAECD           PL Location Cod
     C                     MOVELA1ACCD    $FACCD           HB Buyer Code
     C                     MOVELA1AGCD    $FAGCD           GN Genetic Code
     C                     MOVELA1BECD    $FBECD           HC Class Code
     C                     MOVELA1AAVN    $FAAVN           RS User Changed
     C                     Z-ADDA1AADT    $FAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $FAMTM           RS Time Changed
     C                     MOVELA1AJST    $FAJST           RS Record Statu
     C                     MOVELA1AHVN    $FAHVN           RS Job
     C                     MOVELA1AGVN    $FAGVN           RS Program
     C                     MOVELA1ABVN    $FABVN           RS User Added
     C                     Z-ADDA1ABDT    $FABDT           RS Date Added
     C                     Z-ADDA1ABTM    $FABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * All Tattoo's
     C                     EXSR UGSUBR                     All Tattoo's
      * Not Paid w/Producer Historical Average
      * CASE: DB1.TH PHA Add Type is None
     C           A1OQET    IFEQ *BLANK                     *IF
     C                     ADD  A1CXNB    $GJKOS           PH GA DOA
     C                     ADD  A1CWNB    $GALRC           PH GA Head Rece
     C                     ADD  A1FCNB    $GKDIE           PH GA Yard Dead
     C                     ADD  A1FDNB    $GJOEW           PH GA Head Cond
     C                     ADD  A1FENB    $GOWUI           PH GA Head Kill
     C                     ADD  A1CYNB    $GIOWN           PH GA Live Weig
     C                     ADD  A1E0NB    $GJOQR           PH GA Hot Weigh
     C                     ADD  A1LRNB    $GIOOG           PH GA Adj Live
     C                     ADD  A1ANPR    $GI7VA           Base Mkt Price
     C                     ADD  A1AYVA    $GI8VA           Sort Discount A
     C                     ADD  A1AXVA    $GI9VA           LN AddOn/Deduct
     C                     ADD  A1CBPR    $GJAVA           Gross Amount 2
     C                     ADD  $FWQNB    $GWQNB           Lean % * Wgt US
     C                     ADD  $FWERQ    $GWERQ           Backfat * Wgt U
     C                     ADD  $FGHH5    $GGHH5           Loin-Eye * Wgt
     C                     ADD  $FRERR    $GRERR           Light Refl * Wg
     C                     ADD  $FCDA1    $GCCA1           Sort factor Tot
     C                     ADD  $FKFNB    $GCGA1           Sort Factor Car
     C                     END                             *FI
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZC001           BOH Company Num
     C                     Z-ADDA1HMNB    WZC001
     C           *LIKE     DEFN A1ABCD    WZC002           PD Producer Cod
     C                     MOVELA1ABCD    WZC002
     C           *LIKE     DEFN A1B0DT    WZC003           TH Kill Date
     C                     Z-ADDA1B0DT    WZC003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@A1CPEB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * kill Date is Less than  Wekk(1) Select the Record
      * CASE: DB1.TH Kill Date LT PAR.Week(1)               USR
     C           A1B0DT    IFLT P3EIDT                     *IF
      * CASE: PAR.PH Summary Type is 1 Week
     C           '2WK'     IFEQ '1WK'                      *IF
      * EOF File B            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE
     C                     ELSE
      * CASE: PAR.PH Summary Type is 2 Week
     C           '2WK'     IFEQ '2WK'                      *IF
      * EOF File C            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFC           END OF FILE
     C                     ELSE
      * CASE: PAR.PH Summary Type is 4 Week
     C           '2WK'     IFEQ '4WK'                      *IF
      * EOF File D            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFD           END OF FILE
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH Head Received is *Zeros
     C           A1CWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        PD Producer Cod
     C                     MOVEL*BLANK    W0CL02  1        TH Kill Date
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0CL02  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           A1ABCD    IFNE WZC002                     PD Producer Cod
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           A1B0DT    IFNE WZC003                     TH Kill Date
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     MOVEL'2WK'     $GUVST           PH Summary Type
      * ALL: Add PAR to CUR
     C                     EXSR UHSUBR                     ALL: Add PAR to
      * ALL: Avg Live Wgt
      * CASE: CUR.PH ALL Head Received is GT Zero
     C           $GALHD    IFGT *ZERO                      *IF
     C           $GOIWE    DIV  $GALHD    $GIOTR    H      PH ALL Avg Live
     C                     END                             *FI
      * ALL: Avg Hot Wgt
      * CASE: CUR.PH ALL Head Killed is GT Zero
     C           $GJOWR    IFGT *ZERO                      *IF
     C           $GJOWK    DIV  $GJOWR    $GUQWP    H      PH ALL Avg Hot
     C                     END                             *FI
      * ALL: Actual Yield & /Live CWT
      * CASE: CUR.PH ALL Live Weight is Ne'0'
     C           $GOIWE    IFNE 0                          *IF
      * Actual Yield
      * CUR.PH ALL Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $GJOWK    DIV  $GOIWE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GO6PC           PH ALL Actual Y
      * Base /Live
      * CUR.PH ALL Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GGYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS1PR           PH ALL Base /Li
      * Sort /Live
      * CUR.PH ALL Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GGZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS3PR           PH ALL Sort Dsc
      * Prem /Live
      * CUR.PH ALL Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GG0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS5PR           PH ALL Lean Prm
      * Gross /Live
      * CUR.PH ALL Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GGWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS7PR           PH ALL Gross /L
     C                     END                             *FI
      * ALL: Adjusted Yield
      * CASE: CUR.PH ALL Adj Live Weight is Ne'0'
     C           $GJKSE    IFNE 0                          *IF
      * Adjusted Yield
      * CUR.PH ALL Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH ALL Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $GJOWK    DIV  $GJKSE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GG8PC           PH ALL Adjusted
     C                     END                             *FI
      * ALL: Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: CUR.PH ALL Hot Weight is Ne'0'
     C           $GJOWK    IFNE 0                          *IF
     C           $GNNNB    DIV  $GJOWK    $GHAPC    H      PH ALL Avg Lean
     C           $GNONB    DIV  $GJOWK    $GORJG    H      PH ALL Avg Back
     C           $GNPNB    DIV  $GJOWK    $GHDPC    H      PH ALL Avg Loin
     C           $GSZNB    DIV  $GJOWK    $GHFPC    H      PH ALL Avg Ligh
      * Base /Carc
      * CUR.PH ALL Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GGYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTCPR           PH ALL Base /Ca
      * Sort /Carc
      * CUR.PH ALL Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GGZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTDPR           PH ALL Sort Dsc
      * Prem /Carc
      * CUR.PH ALL Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GG0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTEPR           PH ALL Lean Prm
      * Gross /Carc
      * CUR.PH ALL Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GGWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTFPR           PH ALL Gross /C
     C                     END                             *FI
      * ALL: Average Sort Discount Factor
      * CASE: CUR.Sort Factor Carc ALL SUM is GT Zero
     C           $GCFA1    IFGT *ZERO                      *IF
     C           $GCBA1    DIV  $GCFA1    $GB6A1    H      PH ALL Avg Srt
     C                     END                             *FI
      * GA : Add PAR to CUR
     C                     EXSR UISUBR                     GA : Add PAR to
      * GA : Avg Live Wgt
      * CASE: CUR.PH GA Head Received is GT Zero
     C           $GALRC    IFGT *ZERO                      *IF
     C           $GIOWN    DIV  $GALRC    $GORMB    H      PH GA Avg Live
     C                     END                             *FI
      * GA : Avg Hot Wgt
      * CASE: CUR.PH GA Head Killed is GT Zero
     C           $GOWUI    IFGT *ZERO                      *IF
     C           $GJOQR    DIV  $GOWUI    $GPRUR    H      PH GA Avg Hot W
     C                     END                             *FI
      * GA : Actual Yield & /Live CWT
      * CASE: CUR.PH GA Live Weight is Ne'0'
     C           $GIOWN    IFNE 0                          *IF
      * Actual Yield
      * CUR.PH GA Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $GJOQR    DIV  $GIOWN    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GG7PC           PH GA Actual Yi
      * Base /Live
      * CUR.PH GA Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GI7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS2PR           PH GA Base /Liv
      * Sort /Live
      * CUR.PH GA Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GI8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS4PR           PH GA Sort Dsc
      * Prem /Live
      * CUR.PH GA Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GI9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS6PR           PH GA Lean Prm
      * Gross /Live
      * CUR.PH GA Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GJAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GS8PR           PH GA Gross /Li
     C                     END                             *FI
      * GA : Adjusted Yield
      * CASE: CUR.PH GA Adj Live Weight is Ne'0'
     C           $GIOOG    IFNE 0                          *IF
      * Adjusted Yield
      * CUR.PH GA Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH GA Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $GJOQR    DIV  $GIOOG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GG9PC           PH GA Adjusted
     C                     END                             *FI
      * GA : Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: CUR.PH GA Hot Weight is Ne'0'
     C           $GJOQR    IFNE 0                          *IF
     C           $GWQNB    DIV  $GJOQR    $GHBPC    H      PH GA Avg Lean%
     C           $GWERQ    DIV  $GJOQR    $GUWOE    H      PH GA Avg Backf
     C           $GGHH5    DIV  $GJOQR    $GHEPC    H      PH GA Avg Loin
     C           $GRERR    DIV  $GJOQR    $GHGPC    H      PH GA Avg Light
      * Base /Carc
      * CUR.PH GA Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GI7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTGPR           PH GA Base /Car
      * Sort /Carc
      * CUR.PH GA Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GI8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTHPR           PH GA Sort Dsc
      * Prem /Carc
      * CUR.PH GA Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GI9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTIPR           PH GA Lean Prm
      * Gross /Carc
      * CUR.PH GA Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $GJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $GJAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GTJPR           PH GA Gross /Ca
     C                     END                             *FI
      * GA : Average Sort Discount Factor
      * CASE: CUR.Sort Factor Carc GA SUM is GT Zero
     C           $GCGA1    IFGT *ZERO                      *IF
     C           $GCCA1    DIV  $GCGA1    $GB8A1    H      PH GA Avg Srt D
     C                     END                             *FI
      * PAR = CUR By name
     C                     Z-ADD$GOJJF    P2OJJF           PH ALL DOA
     C                     Z-ADD$GALHD    P2ALHD           PH ALL Head Rec
     C                     Z-ADD$GKDUR    P2KDUR           PH ALL Yard Dea
     C                     Z-ADD$GKJOQ    P2KJOQ           PH ALL Head Con
     C                     Z-ADD$GJOWR    P2JOWR           PH ALL Head Kil
     C                     Z-ADD$GOIWE    P2OIWE           PH ALL Live Wei
     C                     Z-ADD$GIOTR    WN0053           PH ALL Avg Live
     C                     Z-ADD$GJOWK    P2JOWK           PH ALL Hot Weig
     C                     Z-ADD$GUQWP    WN0054           PH ALL Avg Hot
     C                     Z-ADD$GO6PC    WN0055           PH ALL Actual Y
     C                     Z-ADD$GJKSE    P2JKSE           PH ALL Adj Live
     C                     Z-ADD$GG8PC    WN0056           PH ALL Adjusted
     C                     Z-ADD$GHAPC    WN0057           PH ALL Avg Lean
     C                     Z-ADD$GORJG    WN0058           PH ALL Avg Back
     C                     Z-ADD$GHDPC    WN0059           PH ALL Avg Loin
     C                     Z-ADD$GHFPC    WN0060           PH ALL Avg Ligh
     C                     Z-ADD$GS1PR    WN0061           PH ALL Base /Li
     C                     Z-ADD$GTCPR    WN0062           PH ALL Base /Ca
     C                     Z-ADD$GS3PR    WN0063           PH ALL Sort Dsc
     C                     Z-ADD$GTDPR    WN0064           PH ALL Sort Dsc
     C                     Z-ADD$GS5PR    WN0065           PH ALL Lean Prm
     C                     Z-ADD$GTEPR    WN0066           PH ALL Lean Prm
     C                     Z-ADD$GS7PR    WN0067           PH ALL Gross /L
     C                     Z-ADD$GTFPR    WN0068           PH ALL Gross /C
     C                     Z-ADD$GB6A1    WN0069           PH ALL Avg Srt
     C                     Z-ADD$GJKOS    P2JKOS           PH GA DOA
     C                     Z-ADD$GALRC    P2ALRC           PH GA Head Rece
     C                     Z-ADD$GKDIE    P2KDIE           PH GA Yard Dead
     C                     Z-ADD$GJOEW    P2JOEW           PH GA Head Cond
     C                     Z-ADD$GOWUI    P2OWUI           PH GA Head Kill
     C                     Z-ADD$GIOWN    P2IOWN           PH GA Live Weig
     C                     Z-ADD$GORMB    WN0070           PH GA Avg Live
     C                     Z-ADD$GJOQR    P2JOQR           PH GA Hot Weigh
     C                     Z-ADD$GPRUR    WN0071           PH GA Avg Hot W
     C                     Z-ADD$GG7PC    WN0072           PH GA Actual Yi
     C                     Z-ADD$GIOOG    P2IOOG           PH GA Adj Live
     C                     Z-ADD$GG9PC    WN0073           PH GA Adjusted
     C                     Z-ADD$GHBPC    WN0074           PH GA Avg Lean%
     C                     Z-ADD$GUWOE    WN0075           PH GA Avg Backf
     C                     Z-ADD$GHEPC    WN0076           PH GA Avg Loin
     C                     Z-ADD$GHGPC    WN0077           PH GA Avg Light
     C                     Z-ADD$GS2PR    WN0078           PH GA Base /Liv
     C                     Z-ADD$GTGPR    WN0079           PH GA Base /Car
     C                     Z-ADD$GS4PR    WN0080           PH GA Sort Dsc
     C                     Z-ADD$GTHPR    WN0081           PH GA Sort Dsc
     C                     Z-ADD$GS6PR    WN0082           PH GA Lean Prm
     C                     Z-ADD$GTIPR    WN0083           PH GA Lean Prm
     C                     Z-ADD$GS8PR    WN0084           PH GA Gross /Li
     C                     Z-ADD$GTJPR    WN0085           PH GA Gross /Ca
     C                     Z-ADD$GB8A1    WN0086           PH GA Avg Srt D
     C                     Z-ADD$GGYVA    P3GYVA           Base Mkt Price
     C                     Z-ADD$GGZVA    P3GZVA           Sort Discount A
     C                     Z-ADD$GG0VA    P3G0VA           LN AddOn/Deduct
     C                     Z-ADD$GGWVA    P3GWVA           Gross Amount
     C                     Z-ADD$GI7VA    P3I7VA           Base Mkt Price
     C                     Z-ADD$GI8VA    P3I8VA           Sort Discount A
     C                     Z-ADD$GI9VA    P3I9VA           LN AddOn/Deduct
     C                     Z-ADD$GJAVA    P3JAVA           Gross Amount 2
     C                     Z-ADD$GNNNB    P3NNNB           Lean % * Wgt US
     C                     Z-ADD$GWQNB    P3WQNB           Lean % * Wgt US
     C                     Z-ADD$GNONB    P3NONB           Backfat * Wgt U
     C                     Z-ADD$GWERQ    P3WERQ           Backfat * Wgt U
     C                     Z-ADD$GNPNB    P3NPNB           Loin-Eye * Wgt
     C                     Z-ADD$GGHH5    P3GHH5           Loin-Eye * Wgt
     C                     Z-ADD$GSZNB    P3SZNB           Light Refl * Wg
     C                     Z-ADD$GRERR    P3RERR           Light Refl * Wg
     C                     Z-ADD$GCBA1    P3CBA1           Sort Factor Tot
     C                     Z-ADD$GCCA1    P3CCA1           Sort factor Tot
     C                     Z-ADD$GCFA1    P3CFA1           Sort Factor Car
     C                     Z-ADD$GCGA1    P3CGA1           Sort Factor Car
      * Upd Producer History  RT - Producer History WKLY  * 
     C                     EXSR STRVGN
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Print format
     C                     WRITE$GFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Clc Producer History   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKD01           BOH Company Num
     C           *LIKE     DEFN A1ABCD    WQKD02           PD Producer Cod
      * Define keylist
     C           KPSD      KLIST
     C                     KFLD           WQKD01           BOH Company Num
     C                     KFLD           WQKD02           PD Producer Cod
     C                     KFLD           A1B0DT           TH Kill Date
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           BOH Company Num
     C                     KFLD           WQKD02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQKD01           BOH Company Num
     C                     MOVELACABCD    WQKD02           PD Producer Cod
     C                     Z-ADDP3B4DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KPSD      SETLL@A1CPEB                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
      * USER: Null report processing
      * CASE: PAR.PH ALL Head Received is GT Zero
     C           P2ALHD    IFGT *ZERO                      *IF
      * ALL: Avg Live Wgt
      * CASE: PAR.PH ALL Head Received is GT Zero
     C           P2ALHD    IFGT *ZERO                      *IF
     C           P2OIWE    DIV  P2ALHD    WN0105    H      PH ALL Avg Live
     C                     END                             *FI
      * ALL: Avg Hot Wgt
      * CASE: PAR.PH ALL Head Killed is GT Zero
     C           P2JOWR    IFGT *ZERO                      *IF
     C           P2JOWK    DIV  P2JOWR    WN0106    H      PH ALL Avg Hot
     C                     END                             *FI
      * ALL: Actual Yield & /Live CWT
      * CASE: PAR.PH ALL Live Weight is Ne'0'
     C           P2OIWE    IFNE 0                          *IF
      * Actual Yield
      * PAR.PH ALL Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  P2OIWE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0107           PH ALL Actual Y
      * Base /Live
      * PAR.PH ALL Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0113           PH ALL Base /Li
      * Sort /Live
      * PAR.PH ALL Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0115           PH ALL Sort Dsc
      * Prem /Live
      * PAR.PH ALL Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3G0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0117           PH ALL Lean Prm
      * Gross /Live
      * PAR.PH ALL Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2OIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0119           PH ALL Gross /L
     C                     END                             *FI
      * ALL: Adjusted Yield
      * CASE: PAR.PH ALL Adj Live Weight is Ne'0'
     C           P2JKSE    IFNE 0                          *IF
      * Adjusted Yield
      * PAR.PH ALL Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH ALL Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  P2JKSE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0108           PH ALL Adjusted
     C                     END                             *FI
      * ALL: Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: PAR.PH ALL Hot Weight is Ne'0'
     C           P2JOWK    IFNE 0                          *IF
     C           P3NNNB    DIV  P2JOWK    WN0109    H      PH ALL Avg Lean
     C           P3NONB    DIV  P2JOWK    WN0110    H      PH ALL Avg Back
     C           P3NPNB    DIV  P2JOWK    WN0111    H      PH ALL Avg Loin
     C           P3SZNB    DIV  P2JOWK    WN0112    H      PH ALL Avg Ligh
      * Base /Carc
      * PAR.PH ALL Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0114           PH ALL Base /Ca
      * Sort /Carc
      * PAR.PH ALL Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0116           PH ALL Sort Dsc
      * Prem /Carc
      * PAR.PH ALL Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3G0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0118           PH ALL Lean Prm
      * Gross /Carc
      * PAR.PH ALL Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3GWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0120           PH ALL Gross /C
     C                     END                             *FI
      * ALL: Average Sort Discount Factor
      * CASE: PAR.Sort Factor Carc ALL SUM is GT Zero
     C           P3CFA1    IFGT *ZERO                      *IF
     C           P3CBA1    DIV  P3CFA1    WN0121    H      PH ALL Avg Srt
     C                     END                             *FI
      * GA : Avg Live Wgt
      * CASE: PAR.PH GA Head Received is GT Zero
     C           P2ALRC    IFGT *ZERO                      *IF
     C           P2IOWN    DIV  P2ALRC    WN0122    H      PH GA Avg Live
     C                     END                             *FI
      * GA : Avg Hot Wgt
      * CASE: PAR.PH GA Head Killed is GT Zero
     C           P2OWUI    IFGT *ZERO                      *IF
     C           P2JOQR    DIV  P2OWUI    WN0123    H      PH GA Avg Hot W
     C                     END                             *FI
      * GA : Actual Yield & /Live CWT
      * CASE: PAR.PH GA Live Weight is Ne'0'
     C           P2IOWN    IFNE 0                          *IF
      * Actual Yield
      * PAR.PH GA Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  P2IOWN    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0124           PH GA Actual Yi
      * Base /Live
      * PAR.PH GA Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0130           PH GA Base /Liv
      * Sort /Live
      * PAR.PH GA Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0132           PH GA Sort Dsc
      * Prem /Live
      * PAR.PH GA Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0134           PH GA Lean Prm
      * Gross /Live
      * PAR.PH GA Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2IOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3JAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0136           PH GA Gross /Li
     C                     END                             *FI
      * GA : Adjusted Yield
      * CASE: PAR.PH GA Adj Live Weight is Ne'0'
     C           P2IOOG    IFNE 0                          *IF
      * Adjusted Yield
      * PAR.PH GA Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.PH GA Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  P2IOOG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0125           PH GA Adjusted
     C                     END                             *FI
      * GA : Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: PAR.PH GA Hot Weight is Ne'0'
     C           P2JOQR    IFNE 0                          *IF
     C           P3WQNB    DIV  P2JOQR    WN0126    H      PH GA Avg Lean%
     C           P3WERQ    DIV  P2JOQR    WN0127    H      PH GA Avg Backf
     C           P3GHH5    DIV  P2JOQR    WN0128    H      PH GA Avg Loin
     C           P3RERR    DIV  P2JOQR    WN0129    H      PH GA Avg Light
      * Base /Carc
      * PAR.PH GA Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0131           PH GA Base /Car
      * Sort /Carc
      * PAR.PH GA Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0133           PH GA Sort Dsc
      * Prem /Carc
      * PAR.PH GA Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3I9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0135           PH GA Lean Prm
      * Gross /Carc
      * PAR.PH GA Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2JOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3JAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0137           PH GA Gross /Ca
     C                     END                             *FI
      * GA : Average Sort Discount Factor
      * CASE: PAR.Sort Factor Carc GA SUM is GT Zero
     C           P3CGA1    IFGT *ZERO                      *IF
     C           P3CCA1    DIV  P3CGA1    WN0138    H      PH GA Avg Srt D
     C                     END                             *FI
      * Upd Producer History  RT - Producer History WKLY  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0DL02  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $IOQET           TH PHA Add Type
     C                     MOVEL*BLANK    $IUVST           PH Summary Type
     C                     Z-ADD*ZERO     $IOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     $IALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     $IKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     $IKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     $IJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     $IOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     $IJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     $IJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     $IIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     $IUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     $IO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     $IG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     $IHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     $INNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $IORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     $INONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     $IHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     $INPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $IHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     $ISZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     $IGYVA           Base Mkt Price
     C                     Z-ADD*ZERO     $IGZVA           Sort Discount A
     C                     Z-ADD*ZERO     $IG0VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     $IGWVA           Gross Amount
     C                     Z-ADD*ZERO     $ICFA1           Sort Factor Car
     C                     Z-ADD*ZERO     $IB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     $ICBA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $IT0PR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $IT1PR           TH CM Sort Disc
     C                     Z-ADD*ZERO     $IT2PR           TH CM Yield Gai
     C                     Z-ADD*ZERO     $IT3PR           TH CM Base Carc
     C                     Z-ADD*ZERO     $IT5PR           TH CM LN AddOn/
     C                     Z-ADD*ZERO     $IT6PR           TH CM Carcass G
     C                     Z-ADD*ZERO     $IYUUI           TH Unused Nbr 6
     C                     Z-ADD*ZERO     $IT4PR           TH Deduction Am
     C                     Z-ADD*ZERO     $IT7PR           TH CM Lean Prem
     C                     Z-ADD*ZERO     $IS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     $ITCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     $IS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $ITDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $IS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $ITEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $IS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     $ITFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     $IJKOS           PH GA DOA
     C                     Z-ADD*ZERO     $IALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     $IKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     $IJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     $IOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     $IIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     $IIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     $IJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     $IORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     $IPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $IG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     $IG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     $IHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     $IWQNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $IUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     $IWERQ           Backfat * Wgt U
     C                     Z-ADD*ZERO     $IHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     $IGHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $IHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     $IRERR           Light Refl * Wg
     C                     Z-ADD*ZERO     $II7VA           Base Mkt Price
     C                     Z-ADD*ZERO     $II8VA           Sort Discount A
     C                     Z-ADD*ZERO     $II9VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     $IJAVA           Gross Amount 2
     C                     Z-ADD*ZERO     $ICGA1           Sort Factor Car
     C                     Z-ADD*ZERO     $IB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     $ICCA1           Sort factor Tot
     C                     Z-ADD*ZERO     $IUHPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $IUIPR           TH CM Sort Disc
     C                     Z-ADD*ZERO     $IUJPR           TH CM Yield Gai
     C                     Z-ADD*ZERO     $IUKPR           TH CM Base Carc
     C                     Z-ADD*ZERO     $IULPR           TH CM LN AddOn/
     C                     Z-ADD*ZERO     $IUMPR           TH CM Carcass G
     C                     Z-ADD*ZERO     $IGFDH           TH Unused Nbr 6
     C                     Z-ADD*ZERO     $IUNPR           TH Deduction Am
     C                     Z-ADD*ZERO     $IHUPC           PH GA Adjusted
     C                     Z-ADD*ZERO     $IS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     $ITGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     $IS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $ITHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $IS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $ITIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $IS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     $ITJPR           PH GA Gross /Ca
     C                     MOVEL*BLANK    $IIXTX           Blank Usr 1 fld
     C                     Z-ADD*ZERO     $IVWQE           PH GA Avg Live
     C                     Z-ADD*ZERO     $IVEQQ           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $IHTPC           PH GA Actual Yi
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $HGRR4           Amount2 * Hot W
     C                     Z-ADDA1HMNB    $HHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $HBONB           BOL Load Number
     C                     MOVEL*BLANK    $HJFTX           All Text
     C                     Z-ADDA1B0DT    $HB0DT           TH Kill Date
     C                     Z-ADDA1CVNB    $HCVNB           TH Tattoo Numbe
     C                     Z-ADDA1AWDT    $HAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $HBICD           TH Group Refere
     C                     MOVELA1CPST    $HCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $HACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $HB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $HCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $HC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $HAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $HA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $HC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    $HCXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    $HCWNB           TH Head Receive
     C                     Z-ADDA1FCNB    $HFCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    $HH9NB           TH Held Over
     C                     Z-ADDA1FDNB    $HFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    $HFENB           TH Head Killed
     C                     Z-ADDA1HENB    $HHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $HHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    $HCYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    $HLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $HE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $HA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $HFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $HA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $HF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    $HHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1AWPC    $HAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $HCWPC           TH Adj Actual Y
     C                     Z-ADDA1F4NB    $HF4NB           TH Avg Lean Per
     C                     Z-ADDA1F2NB    $HF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     $HSZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     $HRERR           Light Refl * Wg
     C                     Z-ADD*ZERO     $HNNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     $HWQNB           Lean % * Wgt US
     C                     Z-ADDA1F3NB    $HF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F5NB    $HF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     $HNPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $HGHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     $HNONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     $HWERQ           Backfat * Wgt U
     C                     Z-ADDA1AVPC    $HAVPC           TH Std Yield Pe
     C                     Z-ADDA1A8PC    $HA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $HA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $HB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $HAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $HTCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     $HTDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $HS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     $HS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     $HTFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     $HS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     $HS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     $HJKOS           PH GA DOA
     C                     Z-ADD*ZERO     $HALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     $HKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     $HJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     $HOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     $HIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     $HORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     $HIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     $HG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     $HPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     $HJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     $HG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     $HUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     $HS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     $HHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     $HHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     $HHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     $HTGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     $HS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $HTHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     $HS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $HTIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     $HS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     $HTJPR           PH GA Gross /Ca
     C                     Z-ADDA1ANPR    $HANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $HAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $HAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $HAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $HAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $HAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $HASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $HA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $HATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $HA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    $HCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $HKFNB           Carcass Count U
     C                     Z-ADD*ZERO     $HCDA1           Sort Factor Tot
     C                     Z-ADDA1CCPR    $HCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $HLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $HCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $HA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $HA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $HJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $HCWST           TH Payment Sts
     C                     MOVELA1D7ST    $HD7ST           TH Header Error
     C                     MOVELA1D8ST    $HD8ST           TH Detail Error
     C                     MOVELA1DWST    $HDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $HD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $HGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $HBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $HE0ST           TH User Error O
     C                     MOVELA1E1ST    $HE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $HE2ST           TH Sex
     C                     Z-ADDA1BSDT    $HBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $HBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $HBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $HHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $HHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $HHINB           TH FFLI
     C                     Z-ADDA1A3PR    $HA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $HA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $HA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $HJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $HD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $HD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $HD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $HD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $HEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $HEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $HECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $HEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $HEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $HEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $HEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $HEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $HKAST           TH Source Type
     C                     MOVELA1J7ST    $HJ7ST           TH Scale Ticket
     C                     MOVELA1J9ST    $HJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    $HOXNB           TH HPS Movement
     C                     MOVELA1LKST    $HLKST           TH Source Code
     C                     MOVELA1LLST    $HLLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $HJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $HLIST           TH Schedule Kil
     C                     MOVELA1LJST    $HLJST           TH Shift Held O
     C                     MOVELA1NZTX    $HNZTX           TH State
     C                     MOVELA1HJCD    $HHJCD           TH Unused Code
     C                     MOVELA1R4ST    $HR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $HR5ST           TH Commission S
     C                     MOVELA1R6ST    $HR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $HR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $HTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $HT2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $HTHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $HT2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $HOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $HKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $HOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $HOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $HIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $HOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $HOQET           TH PHA Add Type
     C                     MOVELA1URST    $HURST           TH PHA Average
     C                     MOVELA1USST    $HUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $HHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $HS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $HTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $HTBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $HJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $HKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $HKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $HKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $HKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $HOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $HIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $HIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $HIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $HKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $HOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $HKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $HORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $HOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $HMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $HMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $HNCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $HNCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $HIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $HKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $HEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $HEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    $HECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $HEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    $HEEDT           TH Unused Date
     C                     MOVELA1U4ST    $HU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $HU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $HU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $HU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $HU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $HU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $HVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $HVBST           TH Unused Sts 8
     C                     MOVELA1BDCD    $HBDCD           DF Defect Code
     C                     MOVELA1CSCD    $HCSCD           THP Process Cod
     C                     MOVELA1ABCD    $HABCD           PD Producer Cod
     C                     MOVELA1AECD    $HAECD           PL Location Cod
     C                     MOVELA1ACCD    $HACCD           HB Buyer Code
     C                     MOVELA1AGCD    $HAGCD           GN Genetic Code
     C                     MOVELA1BECD    $HBECD           HC Class Code
     C                     MOVELA1AAVN    $HAAVN           RS User Changed
     C                     Z-ADDA1AADT    $HAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $HAMTM           RS Time Changed
     C                     MOVELA1AJST    $HAJST           RS Record Statu
     C                     MOVELA1AHVN    $HAHVN           RS Job
     C                     MOVELA1AGVN    $HAGVN           RS Program
     C                     MOVELA1ABVN    $HABVN           RS User Added
     C                     Z-ADDA1ABDT    $HABDT           RS Date Added
     C                     Z-ADDA1ABTM    $HABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * All Tattoo's
     C                     EXSR UKSUBR                     All Tattoo's
      * Not Paid w/Producer Historical Average
      * CASE: DB1.TH PHA Add Type is None
     C           A1OQET    IFEQ *BLANK                     *IF
     C                     ADD  A1CXNB    $IJKOS           PH GA DOA
     C                     ADD  A1CWNB    $IALRC           PH GA Head Rece
     C                     ADD  A1FCNB    $IKDIE           PH GA Yard Dead
     C                     ADD  A1FDNB    $IJOEW           PH GA Head Cond
     C                     ADD  A1FENB    $IOWUI           PH GA Head Kill
     C                     ADD  A1CYNB    $IIOWN           PH GA Live Weig
     C                     ADD  A1E0NB    $IJOQR           PH GA Hot Weigh
     C                     ADD  A1LRNB    $IIOOG           PH GA Adj Live
     C                     ADD  A1ANPR    $II7VA           Base Mkt Price
     C                     ADD  A1AYVA    $II8VA           Sort Discount A
     C                     ADD  A1AXVA    $II9VA           LN AddOn/Deduct
     C                     ADD  A1CBPR    $IJAVA           Gross Amount 2
     C                     ADD  $HWQNB    $IWQNB           Lean % * Wgt US
     C                     ADD  $HWERQ    $IWERQ           Backfat * Wgt U
     C                     ADD  $HGHH5    $IGHH5           Loin-Eye * Wgt
     C                     ADD  $HRERR    $IRERR           Light Refl * Wg
     C                     ADD  $HCDA1    $ICCA1           Sort factor Tot
     C                     ADD  $HKFNB    $ICGA1           Sort Factor Car
     C                     END                             *FI
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZD001           BOH Company Num
     C                     Z-ADDA1HMNB    WZD001
     C           *LIKE     DEFN A1ABCD    WZD002           PD Producer Cod
     C                     MOVELA1ABCD    WZD002
     C           *LIKE     DEFN A1B0DT    WZD003           TH Kill Date
     C                     Z-ADDA1B0DT    WZD003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@A1CPEB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * kill Date is Less than  Wekk(1) Select the Record
      * CASE: DB1.TH Kill Date LT PAR.Week(1)               USR
     C           A1B0DT    IFLT P3EFDT                     *IF
      * CASE: PAR.PH Summary Type is 1 Week
     C           '4WK'     IFEQ '1WK'                      *IF
      * EOF File B            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE
     C                     ELSE
      * CASE: PAR.PH Summary Type is 2 Week
     C           '4WK'     IFEQ '2WK'                      *IF
      * EOF File C            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFC           END OF FILE
     C                     ELSE
      * CASE: PAR.PH Summary Type is 4 Week
     C           '4WK'     IFEQ '4WK'                      *IF
      * EOF File D            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFD           END OF FILE
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH Head Received is *Zeros
     C           A1CWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0DL01  1        PD Producer Cod
     C                     MOVEL*BLANK    W0DL02  1        TH Kill Date
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0DL02  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZD001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           A1ABCD    IFNE WZD002                     PD Producer Cod
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           A1B0DT    IFNE WZD003                     TH Kill Date
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     MOVEL'4WK'     $IUVST           PH Summary Type
      * ALL: Add PAR to CUR
     C                     EXSR ULSUBR                     ALL: Add PAR to
      * ALL: Avg Live Wgt
      * CASE: CUR.PH ALL Head Received is GT Zero
     C           $IALHD    IFGT *ZERO                      *IF
     C           $IOIWE    DIV  $IALHD    $IIOTR    H      PH ALL Avg Live
     C                     END                             *FI
      * ALL: Avg Hot Wgt
      * CASE: CUR.PH ALL Head Killed is GT Zero
     C           $IJOWR    IFGT *ZERO                      *IF
     C           $IJOWK    DIV  $IJOWR    $IUQWP    H      PH ALL Avg Hot
     C                     END                             *FI
      * ALL: Actual Yield & /Live CWT
      * CASE: CUR.PH ALL Live Weight is Ne'0'
     C           $IOIWE    IFNE 0                          *IF
      * Actual Yield
      * CUR.PH ALL Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $IJOWK    DIV  $IOIWE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IO6PC           PH ALL Actual Y
      * Base /Live
      * CUR.PH ALL Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IGYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS1PR           PH ALL Base /Li
      * Sort /Live
      * CUR.PH ALL Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IGZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS3PR           PH ALL Sort Dsc
      * Prem /Live
      * CUR.PH ALL Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IG0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS5PR           PH ALL Lean Prm
      * Gross /Live
      * CUR.PH ALL Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IOIWE    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IGWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS7PR           PH ALL Gross /L
     C                     END                             *FI
      * ALL: Adjusted Yield
      * CASE: CUR.PH ALL Adj Live Weight is Ne'0'
     C           $IJKSE    IFNE 0                          *IF
      * Adjusted Yield
      * CUR.PH ALL Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH ALL Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $IJOWK    DIV  $IJKSE    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IG8PC           PH ALL Adjusted
     C                     END                             *FI
      * ALL: Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: CUR.PH ALL Hot Weight is Ne'0'
     C           $IJOWK    IFNE 0                          *IF
     C           $INNNB    DIV  $IJOWK    $IHAPC    H      PH ALL Avg Lean
     C           $INONB    DIV  $IJOWK    $IORJG    H      PH ALL Avg Back
     C           $INPNB    DIV  $IJOWK    $IHDPC    H      PH ALL Avg Loin
     C           $ISZNB    DIV  $IJOWK    $IHFPC    H      PH ALL Avg Ligh
      * Base /Carc
      * CUR.PH ALL Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt    USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IGYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITCPR           PH ALL Base /Ca
      * Sort /Carc
      * CUR.PH ALL Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt     USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IGZVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITDPR           PH ALL Sort Dsc
      * Prem /Carc
      * CUR.PH ALL Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IG0VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITEPR           PH ALL Lean Prm
      * Gross /Carc
      * CUR.PH ALL Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount          USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH ALL Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOWK    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IGWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITFPR           PH ALL Gross /C
     C                     END                             *FI
      * ALL: Average Sort Discount Factor
      * CASE: CUR.Sort Factor Carc ALL SUM is GT Zero
     C           $ICFA1    IFGT *ZERO                      *IF
     C           $ICBA1    DIV  $ICFA1    $IB6A1    H      PH ALL Avg Srt
     C                     END                             *FI
      * GA : Add PAR to CUR
     C                     EXSR UMSUBR                     GA : Add PAR to
      * GA : Avg Live Wgt
      * CASE: CUR.PH GA Head Received is GT Zero
     C           $IALRC    IFGT *ZERO                      *IF
     C           $IIOWN    DIV  $IALRC    $IORMB    H      PH GA Avg Live
     C                     END                             *FI
      * GA : Avg Hot Wgt
      * CASE: CUR.PH GA Head Killed is GT Zero
     C           $IOWUI    IFGT *ZERO                      *IF
     C           $IJOQR    DIV  $IOWUI    $IPRUR    H      PH GA Avg Hot W
     C                     END                             *FI
      * GA : Actual Yield & /Live CWT
      * CASE: CUR.PH GA Live Weight is Ne'0'
     C           $IIOWN    IFNE 0                          *IF
      * Actual Yield
      * CUR.PH GA Actual Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $IJOQR    DIV  $IIOWN    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IG7PC           PH GA Actual Yi
      * Base /Live
      * CUR.PH GA Base /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $II7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS2PR           PH GA Base /Liv
      * Sort /Live
      * CUR.PH GA Sort Dsc /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $II8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS4PR           PH GA Sort Dsc
      * Prem /Live
      * CUR.PH GA Lean Prm /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $II9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS6PR           PH GA Lean Prm
      * Gross /Live
      * CUR.PH GA Gross /Live CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Live Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IIOWN    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IJAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IS8PR           PH GA Gross /Li
     C                     END                             *FI
      * GA : Adjusted Yield
      * CASE: CUR.PH GA Adj Live Weight is Ne'0'
     C           $IIOOG    IFNE 0                          *IF
      * Adjusted Yield
      * CUR.PH GA Adjusted Yield% =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.PH GA Adj Live Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           $IJOQR    DIV  $IIOOG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $IG9PC           PH GA Adjusted
     C                     END                             *FI
      * GA : Average-Lean%, Backfat, Loin-Eye, Light Ref & /Carc CWT
      * CASE: CUR.PH GA Hot Weight is Ne'0'
     C           $IJOQR    IFNE 0                          *IF
     C           $IWQNB    DIV  $IJOQR    $IHBPC    H      PH GA Avg Lean%
     C           $IWERQ    DIV  $IJOQR    $IUWOE    H      PH GA Avg Backf
     C           $IGHH5    DIV  $IJOQR    $IHEPC    H      PH GA Avg Loin
     C           $IRERR    DIV  $IJOQR    $IHGPC    H      PH GA Avg Light
      * Base /Carc
      * CUR.PH GA Base /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Base Mkt Price Amt 2  USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $II7VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITGPR           PH GA Base /Car
      * Sort /Carc
      * CUR.PH GA Sort Dsc /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Sort Discount Amt 2   USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $II8VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITHPR           PH GA Sort Dsc
      * Prem /Carc
      * CUR.PH GA Lean Prm /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.LN AddOn/Deduct Amt 2 USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $II9VA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITIPR           PH GA Lean Prm
      * Gross /Carc
      * CUR.PH GA Gross /Carc CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Gross Amount 2        USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PH GA Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $IJOQR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $IJAVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ITJPR           PH GA Gross /Ca
     C                     END                             *FI
      * GA : Average Sort Discount Factor
      * CASE: CUR.Sort Factor Carc GA SUM is GT Zero
     C           $ICGA1    IFGT *ZERO                      *IF
     C           $ICCA1    DIV  $ICGA1    $IB8A1    H      PH GA Avg Srt D
     C                     END                             *FI
      * PAR = CUR By name
     C                     Z-ADD$IOJJF    P2OJJF           PH ALL DOA
     C                     Z-ADD$IALHD    P2ALHD           PH ALL Head Rec
     C                     Z-ADD$IKDUR    P2KDUR           PH ALL Yard Dea
     C                     Z-ADD$IKJOQ    P2KJOQ           PH ALL Head Con
     C                     Z-ADD$IJOWR    P2JOWR           PH ALL Head Kil
     C                     Z-ADD$IOIWE    P2OIWE           PH ALL Live Wei
     C                     Z-ADD$IIOTR    WN0105           PH ALL Avg Live
     C                     Z-ADD$IJOWK    P2JOWK           PH ALL Hot Weig
     C                     Z-ADD$IUQWP    WN0106           PH ALL Avg Hot
     C                     Z-ADD$IO6PC    WN0107           PH ALL Actual Y
     C                     Z-ADD$IJKSE    P2JKSE           PH ALL Adj Live
     C                     Z-ADD$IG8PC    WN0108           PH ALL Adjusted
     C                     Z-ADD$IHAPC    WN0109           PH ALL Avg Lean
     C                     Z-ADD$IORJG    WN0110           PH ALL Avg Back
     C                     Z-ADD$IHDPC    WN0111           PH ALL Avg Loin
     C                     Z-ADD$IHFPC    WN0112           PH ALL Avg Ligh
     C                     Z-ADD$IS1PR    WN0113           PH ALL Base /Li
     C                     Z-ADD$ITCPR    WN0114           PH ALL Base /Ca
     C                     Z-ADD$IS3PR    WN0115           PH ALL Sort Dsc
     C                     Z-ADD$ITDPR    WN0116           PH ALL Sort Dsc
     C                     Z-ADD$IS5PR    WN0117           PH ALL Lean Prm
     C                     Z-ADD$ITEPR    WN0118           PH ALL Lean Prm
     C                     Z-ADD$IS7PR    WN0119           PH ALL Gross /L
     C                     Z-ADD$ITFPR    WN0120           PH ALL Gross /C
     C                     Z-ADD$IB6A1    WN0121           PH ALL Avg Srt
     C                     Z-ADD$IJKOS    P2JKOS           PH GA DOA
     C                     Z-ADD$IALRC    P2ALRC           PH GA Head Rece
     C                     Z-ADD$IKDIE    P2KDIE           PH GA Yard Dead
     C                     Z-ADD$IJOEW    P2JOEW           PH GA Head Cond
     C                     Z-ADD$IOWUI    P2OWUI           PH GA Head Kill
     C                     Z-ADD$IIOWN    P2IOWN           PH GA Live Weig
     C                     Z-ADD$IORMB    WN0122           PH GA Avg Live
     C                     Z-ADD$IJOQR    P2JOQR           PH GA Hot Weigh
     C                     Z-ADD$IPRUR    WN0123           PH GA Avg Hot W
     C                     Z-ADD$IG7PC    WN0124           PH GA Actual Yi
     C                     Z-ADD$IIOOG    P2IOOG           PH GA Adj Live
     C                     Z-ADD$IG9PC    WN0125           PH GA Adjusted
     C                     Z-ADD$IHBPC    WN0126           PH GA Avg Lean%
     C                     Z-ADD$IUWOE    WN0127           PH GA Avg Backf
     C                     Z-ADD$IHEPC    WN0128           PH GA Avg Loin
     C                     Z-ADD$IHGPC    WN0129           PH GA Avg Light
     C                     Z-ADD$IS2PR    WN0130           PH GA Base /Liv
     C                     Z-ADD$ITGPR    WN0131           PH GA Base /Car
     C                     Z-ADD$IS4PR    WN0132           PH GA Sort Dsc
     C                     Z-ADD$ITHPR    WN0133           PH GA Sort Dsc
     C                     Z-ADD$IS6PR    WN0134           PH GA Lean Prm
     C                     Z-ADD$ITIPR    WN0135           PH GA Lean Prm
     C                     Z-ADD$IS8PR    WN0136           PH GA Gross /Li
     C                     Z-ADD$ITJPR    WN0137           PH GA Gross /Ca
     C                     Z-ADD$IB8A1    WN0138           PH GA Avg Srt D
     C                     Z-ADD$IGYVA    P3GYVA           Base Mkt Price
     C                     Z-ADD$IGZVA    P3GZVA           Sort Discount A
     C                     Z-ADD$IG0VA    P3G0VA           LN AddOn/Deduct
     C                     Z-ADD$IGWVA    P3GWVA           Gross Amount
     C                     Z-ADD$II7VA    P3I7VA           Base Mkt Price
     C                     Z-ADD$II8VA    P3I8VA           Sort Discount A
     C                     Z-ADD$II9VA    P3I9VA           LN AddOn/Deduct
     C                     Z-ADD$IJAVA    P3JAVA           Gross Amount 2
     C                     Z-ADD$INNNB    P3NNNB           Lean % * Wgt US
     C                     Z-ADD$IWQNB    P3WQNB           Lean % * Wgt US
     C                     Z-ADD$INONB    P3NONB           Backfat * Wgt U
     C                     Z-ADD$IWERQ    P3WERQ           Backfat * Wgt U
     C                     Z-ADD$INPNB    P3NPNB           Loin-Eye * Wgt
     C                     Z-ADD$IGHH5    P3GHH5           Loin-Eye * Wgt
     C                     Z-ADD$ISZNB    P3SZNB           Light Refl * Wg
     C                     Z-ADD$IRERR    P3RERR           Light Refl * Wg
     C                     Z-ADD$ICBA1    P3CBA1           Sort Factor Tot
     C                     Z-ADD$ICCA1    P3CCA1           Sort factor Tot
     C                     Z-ADD$ICFA1    P3CFA1           Sort Factor Car
     C                     Z-ADD$ICGA1    P3CGA1           Sort Factor Car
      * Upd Producer History  RT - Producer History WKLY  * 
     C                     EXSR TERVGN
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Print format
     C                     WRITE$IFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Clc Producer History  PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Clc Producer History  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Detail line. of Clc Producer History  PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print PD Producer Code of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print TH Kill Date of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of Clc Producer History   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * ALL
     C           A1F4NB    MULT A1E0NB    $DNNNB           Lean % * Wgt US
     C           A1F2NB    MULT A1E0NB    $DNONB           Backfat * Wgt U
     C           A1F3NB    MULT A1E0NB    $DNPNB           Loin-Eye * Wgt
     C           A1F5NB    MULT A1E0NB    $DSZNB           Light Refl * Wg
      * GA
     C           A1F4NB    MULT A1E0NB    $DWQNB           Lean % * Wgt US
     C           A1F2NB    MULT A1E0NB    $DWERQ           Backfat * Wgt U
     C           A1F3NB    MULT A1E0NB    $DGHH5           Loin-Eye * Wgt
     C           A1F5NB    MULT A1E0NB    $DRERR           Light Refl * Wg
      * Rtv Payment Info      RT - Buy Order Header  * 
     C                     EXSR SDRVGN
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SERVGN
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0006    IFEQ 'S'                        *IF
      * Clc Sort Factor Tot   RT - Carcass Detail  * 
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $DCDA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $DKFNB           Carcass Count U
     C                     END                             *FI
      * If Tattoo Is Not GA Move ***
      * CASE:
      *  - NOTc1
      *   |- c1    : DB1.TH PHA Add Type is None
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1OQET    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'***'     $DJFTX           All Text
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $DJFTX           All Text
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $DB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDB0DT
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print PD Producer Code of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print TH Kill Date of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Detail line. of Clc Producer History   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * ALL
     C           A1F4NB    MULT A1E0NB    $FNNNB           Lean % * Wgt US
     C           A1F2NB    MULT A1E0NB    $FNONB           Backfat * Wgt U
     C           A1F3NB    MULT A1E0NB    $FNPNB           Loin-Eye * Wgt
     C           A1F5NB    MULT A1E0NB    $FSZNB           Light Refl * Wg
      * GA
     C           A1F4NB    MULT A1E0NB    $FWQNB           Lean % * Wgt US
     C           A1F2NB    MULT A1E0NB    $FWERQ           Backfat * Wgt U
     C           A1F3NB    MULT A1E0NB    $FGHH5           Loin-Eye * Wgt
     C           A1F5NB    MULT A1E0NB    $FRERR           Light Refl * Wg
      * Rtv Payment Info      RT - Buy Order Header  * 
     C                     EXSR SORVGN
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SPRVGN
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0006    IFEQ 'S'                        *IF
      * Clc Sort Factor Tot   RT - Carcass Detail  * 
     C                     EXSR SQRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $FCDA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $FKFNB           Carcass Count U
     C                     END                             *FI
      * If Tattoo Is Not GA Move ***
      * CASE:
      *  - NOTc1
      *   |- c1    : DB1.TH PHA Add Type is None
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1OQET    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'***'     $FJFTX           All Text
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $FJFTX           All Text
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $FB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFB0DT
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print BOH Company Number of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print PD Producer Code of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print TH Kill Date of Clc Producer History   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Detail line. of Clc Producer History   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * ALL
     C           A1F4NB    MULT A1E0NB    $HNNNB           Lean % * Wgt US
     C           A1F2NB    MULT A1E0NB    $HNONB           Backfat * Wgt U
     C           A1F3NB    MULT A1E0NB    $HNPNB           Loin-Eye * Wgt
     C           A1F5NB    MULT A1E0NB    $HSZNB           Light Refl * Wg
      * GA
     C           A1F4NB    MULT A1E0NB    $HWQNB           Lean % * Wgt US
     C           A1F2NB    MULT A1E0NB    $HWERQ           Backfat * Wgt U
     C           A1F3NB    MULT A1E0NB    $HGHH5           Loin-Eye * Wgt
     C           A1F5NB    MULT A1E0NB    $HRERR           Light Refl * Wg
      * Rtv Payment Info      RT - Buy Order Header  * 
     C                     EXSR SZRVGN
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR TARVGN
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0006    IFEQ 'S'                        *IF
      * Clc Sort Factor Tot   RT - Carcass Detail  * 
     C                     EXSR TBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $HCDA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $HKFNB           Carcass Count U
     C                     END                             *FI
      * If Tattoo Is Not GA Move ***
      * CASE:
      *  - NOTc1
      *   |- c1    : DB1.TH PHA Add Type is None
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1OQET    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'***'     $HJFTX           All Text
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $HJFTX           All Text
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $HB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHB0DT
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Clc Producer History  PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Clc Producer History  PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Clc Producer History   PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Clc Producer History   PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Clc Producer History   PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Clc Producer History   PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Clc Producer History   PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Clc Producer History   PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Clc Producer History   PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Clc Producer History   PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Clc Producer History   PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Clc Producer History   PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Clc Producer History   PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Clc Producer History   PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Clc Producer History   PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Clc Producer History   PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Clc Producer History   PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1HMNB    $BHMNB           BOH Company Num
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Producer History  RT - Producer History WKLY  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0035 10        RS User Changed
     C                     Z-ADD*ZERO     WN0036  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0037  60       RS Time Changed
     C                     MOVEL*BLANK    WN0038  1        RS Record Statu
     C                     MOVEL*BLANK    WN0039 10        RS Job
     C                     MOVEL*BLANK    WN0040 10        RS Program
     C                     MOVEL*BLANK    WN0041 10        RS User Added
     C                     Z-ADD*ZERO     WN0042  70       RS Date Added
     C                     Z-ADD*ZERO     WN0043  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           CGY3A1           PH Company Numb
     C                     KFLD           CGABCD           PD Producer Cod
     C                     KFLD           CGUVST           PH Summary Type
     C                     KFLD           CGDZDT           PH Week Ending
      * Setup key
     C                     Z-ADDP1HMNB    CGY3A1           PH Company Numb
     C                     MOVELACABCD    CGABCD           PD Producer Cod
     C                     MOVEL'1WK'     CGUVST           PH Summary Type
     C                     Z-ADDP3B5DT    CGDZDT           PH Week Ending
      * Establish starting position
     C           KRSSA     CHAIN@CGCPIR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0180' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HMNB' defaulted for 'PH Company Number'.
      * Create Producer History - Producer History WKLY  * 
     C                     EXSR SBCRRC
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) CGY3A1' defaulted for 'PH Company Number'.
      * Chg Producer History  CH - Producer History WKLY  * 
     C                     EXSR SCCHRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Create Producer History - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CGCPIQ
     C                     Z-ADDP1HMNB    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD           PD Producer Cod
     C                     MOVEL'1WK'     WAUVST           PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0001    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0002    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0003    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0004    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0005    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0006    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0007    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0008    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0009    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0010    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0011    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0012    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0013    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0014    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0015    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0016    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0017    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0018    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0019    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0020    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0021    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0022    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0023    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0024    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0025    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0026    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0027    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0028    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0029    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0030    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0031    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0032    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0033    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0034    WAB8A1           PH GA Avg Srt D
     C                     MOVELWN0035    WAAAVN           RS User Changed
     C                     Z-ADDWN0036    WAAADT           RS Date Changed
     C                     Z-ADDWN0037    WAAMTM           RS Time Changed
     C                     MOVELWN0038    WAAJST           RS Record Statu
     C                     MOVELWN0039    WAAHVN           RS Job
     C                     MOVELWN0040    WAAGVN           RS Program
     C                     MOVELWN0041    WAABVN           RS User Added
     C                     Z-ADDWN0042    WAABDT           RS Date Added
     C                     Z-ADDWN0043    WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSB    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
      * Check for duplicate primary key
     C           KLCRSB    SETLL@CGCPIQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0181' W0RTN   7
      * Send message 'Producer History WKLY  EX'
     C                     MOVEL'PRK0181' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@CGCPIQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Producer History  CH - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CGCPIQ
     C                     Z-ADDCGY3A1    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD    P      PD Producer Cod
     C                     MOVEL'1WK'     WAUVST    P      PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
      *
     C           KLCHSC    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
     C           KLCHSC    CHAIN@CGCPIQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCGCPL0'MDACP
     C                     MOVEL'@CGCPIQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCG1    YARDCS
      * Move non-key fields to @CGCPIQ
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0001    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0002    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0003    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0004    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0005    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0006    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0007    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0008    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0009    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0010    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0011    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0012    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0013    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0014    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0015    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0016    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0017    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0018    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0019    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0020    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0021    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0022    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0023    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0024    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0025    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0026    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0027    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0028    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0029    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0030    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0031    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0032    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0033    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0034    WAB8A1           PH GA Avg Srt D
     C                     MOVELCGAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDCGAADT    WAAADT           RS Date Changed
     C                     Z-ADDCGAMTM    WAAMTM           RS Time Changed
     C                     MOVELCGAJST    WAAJST    P      RS Record Statu
     C                     MOVELCGAHVN    WAAHVN    P      RS Job
     C                     MOVELCGAGVN    WAAGVN    P      RS Program
     C                     MOVELCGABVN    WAABVN    P      RS User Added
     C                     Z-ADDCGABDT    WAABDT           RS Date Added
     C                     Z-ADDCGABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CGCPIQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Payment Info      RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$DHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$DBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSD     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           BOH Quote Price
     C                     MOVEL*BLANK    YL0002           PC Contract Cod
     C                     MOVEL*BLANK    YL0003           PSC Sub-Contrac
     C                     MOVEL*BLANK    YL0004           CMP Program Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWB3ST    YL0001           BOH Quote Price
     C                     MOVELAWAKCD    YL0002           PC Contract Cod
     C                     MOVELAWALCD    YL0003           PSC Sub-Contrac
     C                     MOVELAWAMCD    YL0004           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELYL0004    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSE     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           CMP Description
     C                     MOVEL*BLANK    YL0006           CMP Grading Typ
     C                     MOVEL*BLANK    YL0007           CMP Sort Basis
     C                     MOVEL*BLANK    YL0008           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     YL0009           CMP Std Lean Pe
     C                     Z-ADD*ZERO     YL0010           CMP Lean Factor
     C                     MOVEL*BLANK    YL0011           CMP Optimal Row
     C                     MOVEL*BLANK    YL0012           CMP Type
     C                     Z-ADD*ZERO     YL0013           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARA3TX    YL0005           CMP Description
     C                     MOVELARDLST    YL0006           CMP Grading Typ
     C                     MOVELARDMST    YL0007           CMP Sort Basis
     C                     MOVELARDQST    YL0008           CMP Carc Wgt Ty
     C                     Z-ADDARAZPC    YL0009           CMP Std Lean Pe
     C                     Z-ADDARA0PC    YL0010           CMP Lean Factor
     C                     MOVELARDTST    YL0011           CMP Optimal Row
     C                     MOVELARF5ST    YL0012           CMP Type
     C                     Z-ADDARI1PR    YL0013           CMP Market Add/
     C                     MOVELARAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Clc Sort Factor Tot   RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DCDA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $DKFNB           Carcass Count U
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1HMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN B1BNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN B1BONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN B1CVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN B1B0DT    WQSF05           TH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
      * Setup key
     C                     Z-ADD$DHMNB    WQSF01           BOH Company Num
     C                     Z-ADD$DBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD$DBONB    WQSF03           BOL Load Number
     C                     Z-ADD$DCVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    WQSF05           TH Kill Date
      * Establish starting position
     C           KRSSF     SETLL@B1CPG7                    *
     C           KRSSF     READE@B1CPG7                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           B1AJST    IFEQ 'A'                        *IF
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR SGRVGN
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SHRVGN
     C                     ADD  YL0017    $DCDA1           Sort Factor Tot
     C                     ADD  1         $DKFNB           Carcass Count U
     C                     END                             *FI
     C           KRSSF     READE@B1CPG7                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BYAMCD    WQSG01           CMP Program Cod
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           CMP Program Cod
     C                     KFLD           BYEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           CMP Program Cod
      * Setup key
     C                     MOVELYL0004    WQSG01           CMP Program Cod
     C                     Z-ADDB1EWNB    BYEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSG     SETLL@BYREJ9                    *
     C           KRSSG     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0014           CMMR Row Number
     C                     Z-ADD*ZERO     YL0015           CMMR Std Dressi
     C                     Z-ADD*ZERO     YL0016           CD Sort Loss
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBYE8NB    YL0014           CMMR Row Number
     C                     Z-ADDBYAQPC    YL0015           CMMR Std Dressi
     C                     Z-ADDBYEMNB    YL0016           CD Sort Loss
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZAMCD    WQSH01           CMP Program Cod
     C           *LIKE     DEFN BZE8NB    WQSH02           CMMR Row Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           CMP Program Cod
     C                     KFLD           WQSH02           CMMR Row Number
     C                     KFLD           BZA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           CMP Program Cod
     C                     KFLD           WQSH02           CMMR Row Number
      * Setup key
     C                     MOVELYL0004    WQSH01           CMP Program Cod
     C                     Z-ADDYL0014    WQSH02           CMMR Row Number
     C                     Z-ADDB1AUPC    BZA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSH     SETLL@BZREKA                    *
     C           KRSSH     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           CMMC Premium Va
     C                     MOVEL*BLANK    YL0018           Record Found CM
     C                     MOVEL'N'       YL0018           Record Found CM
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0018           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDBZERNB    YL0017           CMMC Premium Va
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Producer History  RT - Producer History WKLY  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0044 10        RS User Changed
     C                     Z-ADD*ZERO     WN0045  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0046  60       RS Time Changed
     C                     MOVEL*BLANK    WN0047  1        RS Record Statu
     C                     MOVEL*BLANK    WN0048 10        RS Job
     C                     MOVEL*BLANK    WN0049 10        RS Program
     C                     MOVEL*BLANK    WN0050 10        RS User Added
     C                     Z-ADD*ZERO     WN0051  70       RS Date Added
     C                     Z-ADD*ZERO     WN0052  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           CGY3A1           PH Company Numb
     C                     KFLD           CGABCD           PD Producer Cod
     C                     KFLD           CGUVST           PH Summary Type
     C                     KFLD           CGDZDT           PH Week Ending
      * Setup key
     C                     Z-ADDP1HMNB    CGY3A1           PH Company Numb
     C                     MOVELACABCD    CGABCD           PD Producer Cod
     C                     MOVEL'1WK'     CGUVST           PH Summary Type
     C                     Z-ADDP3B5DT    CGDZDT           PH Week Ending
      * Establish starting position
     C           KRSSI     CHAIN@CGCPIR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0180' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HMNB' defaulted for 'PH Company Number'.
      * Create Producer History - Producer History WKLY  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) CGY3A1' defaulted for 'PH Company Number'.
      * Chg Producer History  CH - Producer History WKLY  * 
     C                     EXSR SKCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Create Producer History - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CGCPIQ
     C                     Z-ADDP1HMNB    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD           PD Producer Cod
     C                     MOVEL'1WK'     WAUVST           PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0001    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0002    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0003    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0004    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0005    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0006    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0007    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0008    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0009    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0010    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0011    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0012    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0013    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0014    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0015    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0016    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0017    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0018    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0019    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0020    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0021    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0022    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0023    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0024    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0025    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0026    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0027    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0028    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0029    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0030    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0031    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0032    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0033    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0034    WAB8A1           PH GA Avg Srt D
     C                     MOVELWN0044    WAAAVN           RS User Changed
     C                     Z-ADDWN0045    WAAADT           RS Date Changed
     C                     Z-ADDWN0046    WAAMTM           RS Time Changed
     C                     MOVELWN0047    WAAJST           RS Record Statu
     C                     MOVELWN0048    WAAHVN           RS Job
     C                     MOVELWN0049    WAAGVN           RS Program
     C                     MOVELWN0050    WAABVN           RS User Added
     C                     Z-ADDWN0051    WAABDT           RS Date Added
     C                     Z-ADDWN0052    WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@CGCPIQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0181' W0RTN   7
      * Send message 'Producer History WKLY  EX'
     C                     MOVEL'PRK0181' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@CGCPIQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Producer History  CH - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @CGCPIQ
     C                     Z-ADDCGY3A1    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD    P      PD Producer Cod
     C                     MOVEL'1WK'     WAUVST    P      PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
      *
     C           KLCHSK    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
     C           KLCHSK    CHAIN@CGCPIQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCGCPL0'MDACP
     C                     MOVEL'@CGCPIQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCG1    YBRDCS
      * Move non-key fields to @CGCPIQ
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0001    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0002    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0003    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0004    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0005    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0006    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0007    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0008    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0009    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0010    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0011    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0012    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0013    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0014    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0015    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0016    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0017    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0018    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0019    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0020    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0021    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0022    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0023    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0024    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0025    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0026    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0027    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0028    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0029    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0030    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0031    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0032    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0033    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0034    WAB8A1           PH GA Avg Srt D
     C                     MOVELCGAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDCGAADT    WAAADT           RS Date Changed
     C                     Z-ADDCGAMTM    WAAMTM           RS Time Changed
     C                     MOVELCGAJST    WAAJST    P      RS Record Statu
     C                     MOVELCGAHVN    WAAHVN    P      RS Job
     C                     MOVELCGAGVN    WAAGVN    P      RS Program
     C                     MOVELCGABVN    WAABVN    P      RS User Added
     C                     Z-ADDCGABDT    WAABDT           RS Date Added
     C                     Z-ADDCGABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@CGCPIQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Producer History  RT - Producer History WKLY  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0087 10        RS User Changed
     C                     Z-ADD*ZERO     WN0088  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0089  60       RS Time Changed
     C                     MOVEL*BLANK    WN0090  1        RS Record Statu
     C                     MOVEL*BLANK    WN0091 10        RS Job
     C                     MOVEL*BLANK    WN0092 10        RS Program
     C                     MOVEL*BLANK    WN0093 10        RS User Added
     C                     Z-ADD*ZERO     WN0094  70       RS Date Added
     C                     Z-ADD*ZERO     WN0095  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           CGY3A1           PH Company Numb
     C                     KFLD           CGABCD           PD Producer Cod
     C                     KFLD           CGUVST           PH Summary Type
     C                     KFLD           CGDZDT           PH Week Ending
      * Setup key
     C                     Z-ADDP1HMNB    CGY3A1           PH Company Numb
     C                     MOVELACABCD    CGABCD           PD Producer Cod
     C                     MOVEL'2WK'     CGUVST           PH Summary Type
     C                     Z-ADDP3B5DT    CGDZDT           PH Week Ending
      * Establish starting position
     C           KRSSL     CHAIN@CGCPIR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0180' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HMNB' defaulted for 'PH Company Number'.
      * Create Producer History - Producer History WKLY  * 
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) CGY3A1' defaulted for 'PH Company Number'.
      * Chg Producer History  CH - Producer History WKLY  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Create Producer History - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CGCPIQ
     C                     Z-ADDP1HMNB    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD           PD Producer Cod
     C                     MOVEL'2WK'     WAUVST           PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0053    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0054    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0055    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0056    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0057    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0058    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0059    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0060    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0061    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0062    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0063    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0064    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0065    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0066    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0067    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0068    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0069    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0070    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0071    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0072    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0073    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0074    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0075    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0076    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0077    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0078    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0079    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0080    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0081    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0082    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0083    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0084    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0085    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0086    WAB8A1           PH GA Avg Srt D
     C                     MOVELWN0087    WAAAVN           RS User Changed
     C                     Z-ADDWN0088    WAAADT           RS Date Changed
     C                     Z-ADDWN0089    WAAMTM           RS Time Changed
     C                     MOVELWN0090    WAAJST           RS Record Statu
     C                     MOVELWN0091    WAAHVN           RS Job
     C                     MOVELWN0092    WAAGVN           RS Program
     C                     MOVELWN0093    WAABVN           RS User Added
     C                     Z-ADDWN0094    WAABDT           RS Date Added
     C                     Z-ADDWN0095    WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
      * Check for duplicate primary key
     C           KLCRSM    SETLL@CGCPIQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0181' W0RTN   7
      * Send message 'Producer History WKLY  EX'
     C                     MOVEL'PRK0181' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@CGCPIQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Producer History  CH - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @CGCPIQ
     C                     Z-ADDCGY3A1    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD    P      PD Producer Cod
     C                     MOVEL'2WK'     WAUVST    P      PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
      *
     C           KLCHSN    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
     C           KLCHSN    CHAIN@CGCPIQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCGCPL0'MDACP
     C                     MOVEL'@CGCPIQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCG1    YCRDCS
      * Move non-key fields to @CGCPIQ
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0053    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0054    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0055    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0056    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0057    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0058    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0059    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0060    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0061    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0062    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0063    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0064    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0065    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0066    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0067    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0068    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0069    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0070    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0071    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0072    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0073    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0074    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0075    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0076    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0077    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0078    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0079    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0080    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0081    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0082    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0083    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0084    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0085    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0086    WAB8A1           PH GA Avg Srt D
     C                     MOVELCGAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDCGAADT    WAAADT           RS Date Changed
     C                     Z-ADDCGAMTM    WAAMTM           RS Time Changed
     C                     MOVELCGAJST    WAAJST    P      RS Record Statu
     C                     MOVELCGAHVN    WAAHVN    P      RS Job
     C                     MOVELCGAGVN    WAAGVN    P      RS Program
     C                     MOVELCGABVN    WAABVN    P      RS User Added
     C                     Z-ADDCGABDT    WAABDT           RS Date Added
     C                     Z-ADDCGABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@CGCPIQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Payment Info      RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$FHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$FBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSO     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           BOH Quote Price
     C                     MOVEL*BLANK    YL0002           PC Contract Cod
     C                     MOVEL*BLANK    YL0003           PSC Sub-Contrac
     C                     MOVEL*BLANK    YL0004           CMP Program Cod
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWB3ST    YL0001           BOH Quote Price
     C                     MOVELAWAKCD    YL0002           PC Contract Cod
     C                     MOVELAWALCD    YL0003           PSC Sub-Contrac
     C                     MOVELAWAMCD    YL0004           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELYL0004    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSP     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           CMP Description
     C                     MOVEL*BLANK    YL0006           CMP Grading Typ
     C                     MOVEL*BLANK    YL0007           CMP Sort Basis
     C                     MOVEL*BLANK    YL0008           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     YL0009           CMP Std Lean Pe
     C                     Z-ADD*ZERO     YL0010           CMP Lean Factor
     C                     MOVEL*BLANK    YL0011           CMP Optimal Row
     C                     MOVEL*BLANK    YL0012           CMP Type
     C                     Z-ADD*ZERO     YL0013           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARA3TX    YL0005           CMP Description
     C                     MOVELARDLST    YL0006           CMP Grading Typ
     C                     MOVELARDMST    YL0007           CMP Sort Basis
     C                     MOVELARDQST    YL0008           CMP Carc Wgt Ty
     C                     Z-ADDARAZPC    YL0009           CMP Std Lean Pe
     C                     Z-ADDARA0PC    YL0010           CMP Lean Factor
     C                     MOVELARDTST    YL0011           CMP Optimal Row
     C                     MOVELARF5ST    YL0012           CMP Type
     C                     Z-ADDARI1PR    YL0013           CMP Market Add/
     C                     MOVELARAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Clc Sort Factor Tot   RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $FCDA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $FKFNB           Carcass Count U
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1HMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN B1BNNB    WQSQ02           BOH Buy Order N
     C           *LIKE     DEFN B1BONB    WQSQ03           BOL Load Number
     C           *LIKE     DEFN B1CVNB    WQSQ04           TH Tattoo Numbe
     C           *LIKE     DEFN B1B0DT    WQSQ05           TH Kill Date
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
     C                     KFLD           WQSQ03           BOL Load Number
     C                     KFLD           WQSQ04           TH Tattoo Numbe
     C                     KFLD           WQSQ05           TH Kill Date
      * Setup key
     C                     Z-ADD$FHMNB    WQSQ01           BOH Company Num
     C                     Z-ADD$FBNNB    WQSQ02           BOH Buy Order N
     C                     Z-ADD$FBONB    WQSQ03           BOL Load Number
     C                     Z-ADD$FCVNB    WQSQ04           TH Tattoo Numbe
     C                     Z-ADD$FB0DT    WQSQ05           TH Kill Date
      * Establish starting position
     C           KRSSQ     SETLL@B1CPG7                    *
     C           KRSSQ     READE@B1CPG7                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           B1AJST    IFEQ 'A'                        *IF
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR SRRVGN
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SSRVGN
     C                     ADD  YL0017    $FCDA1           Sort Factor Tot
     C                     ADD  1         $FKFNB           Carcass Count U
     C                     END                             *FI
     C           KRSSQ     READE@B1CPG7                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BYAMCD    WQSR01           CMP Program Cod
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           CMP Program Cod
     C                     KFLD           BYEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           CMP Program Cod
      * Setup key
     C                     MOVELYL0004    WQSR01           CMP Program Cod
     C                     Z-ADDB1EWNB    BYEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSR     SETLL@BYREJ9                    *
     C           KRSSR     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0014           CMMR Row Number
     C                     Z-ADD*ZERO     YL0015           CMMR Std Dressi
     C                     Z-ADD*ZERO     YL0016           CD Sort Loss
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBYE8NB    YL0014           CMMR Row Number
     C                     Z-ADDBYAQPC    YL0015           CMMR Std Dressi
     C                     Z-ADDBYEMNB    YL0016           CD Sort Loss
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZAMCD    WQSS01           CMP Program Cod
     C           *LIKE     DEFN BZE8NB    WQSS02           CMMR Row Number
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           CMP Program Cod
     C                     KFLD           WQSS02           CMMR Row Number
     C                     KFLD           BZA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           CMP Program Cod
     C                     KFLD           WQSS02           CMMR Row Number
      * Setup key
     C                     MOVELYL0004    WQSS01           CMP Program Cod
     C                     Z-ADDYL0014    WQSS02           CMMR Row Number
     C                     Z-ADDB1AUPC    BZA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSS     SETLL@BZREKA                    *
     C           KRSSS     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           CMMC Premium Va
     C                     MOVEL*BLANK    YL0018           Record Found CM
     C                     MOVEL'N'       YL0018           Record Found CM
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0018           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDBZERNB    YL0017           CMMC Premium Va
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Upd Producer History  RT - Producer History WKLY  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0096 10        RS User Changed
     C                     Z-ADD*ZERO     WN0097  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0098  60       RS Time Changed
     C                     MOVEL*BLANK    WN0099  1        RS Record Statu
     C                     MOVEL*BLANK    WN0100 10        RS Job
     C                     MOVEL*BLANK    WN0101 10        RS Program
     C                     MOVEL*BLANK    WN0102 10        RS User Added
     C                     Z-ADD*ZERO     WN0103  70       RS Date Added
     C                     Z-ADD*ZERO     WN0104  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           CGY3A1           PH Company Numb
     C                     KFLD           CGABCD           PD Producer Cod
     C                     KFLD           CGUVST           PH Summary Type
     C                     KFLD           CGDZDT           PH Week Ending
      * Setup key
     C                     Z-ADDP1HMNB    CGY3A1           PH Company Numb
     C                     MOVELACABCD    CGABCD           PD Producer Cod
     C                     MOVEL'2WK'     CGUVST           PH Summary Type
     C                     Z-ADDP3B5DT    CGDZDT           PH Week Ending
      * Establish starting position
     C           KRSST     CHAIN@CGCPIR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0180' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HMNB' defaulted for 'PH Company Number'.
      * Create Producer History - Producer History WKLY  * 
     C                     EXSR SUCRRC
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) CGY3A1' defaulted for 'PH Company Number'.
      * Chg Producer History  CH - Producer History WKLY  * 
     C                     EXSR SVCHRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Create Producer History - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CGCPIQ
     C                     Z-ADDP1HMNB    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD           PD Producer Cod
     C                     MOVEL'2WK'     WAUVST           PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0053    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0054    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0055    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0056    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0057    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0058    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0059    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0060    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0061    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0062    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0063    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0064    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0065    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0066    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0067    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0068    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0069    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0070    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0071    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0072    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0073    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0074    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0075    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0076    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0077    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0078    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0079    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0080    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0081    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0082    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0083    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0084    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0085    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0086    WAB8A1           PH GA Avg Srt D
     C                     MOVELWN0096    WAAAVN           RS User Changed
     C                     Z-ADDWN0097    WAAADT           RS Date Changed
     C                     Z-ADDWN0098    WAAMTM           RS Time Changed
     C                     MOVELWN0099    WAAJST           RS Record Statu
     C                     MOVELWN0100    WAAHVN           RS Job
     C                     MOVELWN0101    WAAGVN           RS Program
     C                     MOVELWN0102    WAABVN           RS User Added
     C                     Z-ADDWN0103    WAABDT           RS Date Added
     C                     Z-ADDWN0104    WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSU    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
      * Check for duplicate primary key
     C           KLCRSU    SETLL@CGCPIQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0181' W0RTN   7
      * Send message 'Producer History WKLY  EX'
     C                     MOVEL'PRK0181' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@CGCPIQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Producer History  CH - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @CGCPIQ
     C                     Z-ADDCGY3A1    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD    P      PD Producer Cod
     C                     MOVEL'2WK'     WAUVST    P      PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
      *
     C           KLCHSV    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
     C           KLCHSV    CHAIN@CGCPIQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCGCPL0'MDACP
     C                     MOVEL'@CGCPIQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCG1    YDRDCS
      * Move non-key fields to @CGCPIQ
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0053    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0054    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0055    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0056    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0057    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0058    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0059    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0060    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0061    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0062    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0063    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0064    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0065    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0066    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0067    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0068    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0069    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0070    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0071    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0072    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0073    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0074    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0075    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0076    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0077    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0078    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0079    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0080    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0081    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0082    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0083    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0084    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0085    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0086    WAB8A1           PH GA Avg Srt D
     C                     MOVELCGAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDCGAADT    WAAADT           RS Date Changed
     C                     Z-ADDCGAMTM    WAAMTM           RS Time Changed
     C                     MOVELCGAJST    WAAJST    P      RS Record Statu
     C                     MOVELCGAHVN    WAAHVN    P      RS Job
     C                     MOVELCGAGVN    WAAGVN    P      RS Program
     C                     MOVELCGABVN    WAABVN    P      RS User Added
     C                     Z-ADDCGABDT    WAABDT           RS Date Added
     C                     Z-ADDCGABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@CGCPIQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd Producer History  RT - Producer History WKLY  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0139 10        RS User Changed
     C                     Z-ADD*ZERO     WN0140  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0141  60       RS Time Changed
     C                     MOVEL*BLANK    WN0142  1        RS Record Statu
     C                     MOVEL*BLANK    WN0143 10        RS Job
     C                     MOVEL*BLANK    WN0144 10        RS Program
     C                     MOVEL*BLANK    WN0145 10        RS User Added
     C                     Z-ADD*ZERO     WN0146  70       RS Date Added
     C                     Z-ADD*ZERO     WN0147  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           CGY3A1           PH Company Numb
     C                     KFLD           CGABCD           PD Producer Cod
     C                     KFLD           CGUVST           PH Summary Type
     C                     KFLD           CGDZDT           PH Week Ending
      * Setup key
     C                     Z-ADDP1HMNB    CGY3A1           PH Company Numb
     C                     MOVELACABCD    CGABCD           PD Producer Cod
     C                     MOVEL'4WK'     CGUVST           PH Summary Type
     C                     Z-ADDP3B5DT    CGDZDT           PH Week Ending
      * Establish starting position
     C           KRSSW     CHAIN@CGCPIR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0180' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HMNB' defaulted for 'PH Company Number'.
      * Create Producer History - Producer History WKLY  * 
     C                     EXSR SXCRRC
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) CGY3A1' defaulted for 'PH Company Number'.
      * Chg Producer History  CH - Producer History WKLY  * 
     C                     EXSR SYCHRC
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Create Producer History - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CGCPIQ
     C                     Z-ADDP1HMNB    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD           PD Producer Cod
     C                     MOVEL'4WK'     WAUVST           PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0105    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0106    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0107    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0108    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0109    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0110    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0111    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0112    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0113    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0114    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0115    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0116    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0117    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0118    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0119    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0120    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0121    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0122    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0123    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0124    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0125    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0126    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0127    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0128    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0129    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0130    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0131    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0132    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0133    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0134    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0135    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0136    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0137    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0138    WAB8A1           PH GA Avg Srt D
     C                     MOVELWN0139    WAAAVN           RS User Changed
     C                     Z-ADDWN0140    WAAADT           RS Date Changed
     C                     Z-ADDWN0141    WAAMTM           RS Time Changed
     C                     MOVELWN0142    WAAJST           RS Record Statu
     C                     MOVELWN0143    WAAHVN           RS Job
     C                     MOVELWN0144    WAAGVN           RS Program
     C                     MOVELWN0145    WAABVN           RS User Added
     C                     Z-ADDWN0146    WAABDT           RS Date Added
     C                     Z-ADDWN0147    WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSX    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
      * Check for duplicate primary key
     C           KLCRSX    SETLL@CGCPIQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0181' W0RTN   7
      * Send message 'Producer History WKLY  EX'
     C                     MOVEL'PRK0181' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@CGCPIQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Producer History  CH - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @CGCPIQ
     C                     Z-ADDCGY3A1    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD    P      PD Producer Cod
     C                     MOVEL'4WK'     WAUVST    P      PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
      *
     C           KLCHSY    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
     C           KLCHSY    CHAIN@CGCPIQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCGCPL0'MDACP
     C                     MOVEL'@CGCPIQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCG1    YERDCS
      * Move non-key fields to @CGCPIQ
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0105    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0106    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0107    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0108    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0109    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0110    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0111    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0112    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0113    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0114    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0115    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0116    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0117    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0118    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0119    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0120    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0121    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0122    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0123    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0124    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0125    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0126    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0127    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0128    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0129    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0130    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0131    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0132    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0133    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0134    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0135    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0136    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0137    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0138    WAB8A1           PH GA Avg Srt D
     C                     MOVELCGAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDCGAADT    WAAADT           RS Date Changed
     C                     Z-ADDCGAMTM    WAAMTM           RS Time Changed
     C                     MOVELCGAJST    WAAJST    P      RS Record Statu
     C                     MOVELCGAHVN    WAAHVN    P      RS Job
     C                     MOVELCGAGVN    WAAGVN    P      RS Program
     C                     MOVELCGABVN    WAABVN    P      RS User Added
     C                     Z-ADDCGABDT    WAABDT           RS Date Added
     C                     Z-ADDCGABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@CGCPIQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Payment Info      RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$HHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$HBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSZ     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           BOH Quote Price
     C                     MOVEL*BLANK    YL0002           PC Contract Cod
     C                     MOVEL*BLANK    YL0003           PSC Sub-Contrac
     C                     MOVEL*BLANK    YL0004           CMP Program Cod
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWB3ST    YL0001           BOH Quote Price
     C                     MOVELAWAKCD    YL0002           PC Contract Cod
     C                     MOVELAWALCD    YL0003           PSC Sub-Contrac
     C                     MOVELAWAMCD    YL0004           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELYL0004    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSTA     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           CMP Description
     C                     MOVEL*BLANK    YL0006           CMP Grading Typ
     C                     MOVEL*BLANK    YL0007           CMP Sort Basis
     C                     MOVEL*BLANK    YL0008           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     YL0009           CMP Std Lean Pe
     C                     Z-ADD*ZERO     YL0010           CMP Lean Factor
     C                     MOVEL*BLANK    YL0011           CMP Optimal Row
     C                     MOVEL*BLANK    YL0012           CMP Type
     C                     Z-ADD*ZERO     YL0013           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARA3TX    YL0005           CMP Description
     C                     MOVELARDLST    YL0006           CMP Grading Typ
     C                     MOVELARDMST    YL0007           CMP Sort Basis
     C                     MOVELARDQST    YL0008           CMP Carc Wgt Ty
     C                     Z-ADDARAZPC    YL0009           CMP Std Lean Pe
     C                     Z-ADDARA0PC    YL0010           CMP Lean Factor
     C                     MOVELARDTST    YL0011           CMP Optimal Row
     C                     MOVELARF5ST    YL0012           CMP Type
     C                     Z-ADDARI1PR    YL0013           CMP Market Add/
     C                     MOVELARAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Clc Sort Factor Tot   RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $HCDA1           Sort Factor Tot
     C                     Z-ADD*ZERO     $HKFNB           Carcass Count U
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1HMNB    WQTB01           BOH Company Num
     C           *LIKE     DEFN B1BNNB    WQTB02           BOH Buy Order N
     C           *LIKE     DEFN B1BONB    WQTB03           BOL Load Number
     C           *LIKE     DEFN B1CVNB    WQTB04           TH Tattoo Numbe
     C           *LIKE     DEFN B1B0DT    WQTB05           TH Kill Date
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           BOH Company Num
     C                     KFLD           WQTB02           BOH Buy Order N
     C                     KFLD           WQTB03           BOL Load Number
     C                     KFLD           WQTB04           TH Tattoo Numbe
     C                     KFLD           WQTB05           TH Kill Date
      * Setup key
     C                     Z-ADD$HHMNB    WQTB01           BOH Company Num
     C                     Z-ADD$HBNNB    WQTB02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQTB03           BOL Load Number
     C                     Z-ADD$HCVNB    WQTB04           TH Tattoo Numbe
     C                     Z-ADD$HB0DT    WQTB05           TH Kill Date
      * Establish starting position
     C           KRSTB     SETLL@B1CPG7                    *
     C           KRSTB     READE@B1CPG7                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           B1AJST    IFEQ 'A'                        *IF
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR TCRVGN
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR TDRVGN
     C                     ADD  YL0017    $HCDA1           Sort Factor Tot
     C                     ADD  1         $HKFNB           Carcass Count U
     C                     END                             *FI
     C           KRSTB     READE@B1CPG7                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BYAMCD    WQTC01           CMP Program Cod
      * Define keylist
     C           KPSTC     KLIST
     C                     KFLD           WQTC01           CMP Program Cod
     C                     KFLD           BYEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           CMP Program Cod
      * Setup key
     C                     MOVELYL0004    WQTC01           CMP Program Cod
     C                     Z-ADDB1EWNB    BYEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSTC     SETLL@BYREJ9                    *
     C           KRSTC     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0014           CMMR Row Number
     C                     Z-ADD*ZERO     YL0015           CMMR Std Dressi
     C                     Z-ADD*ZERO     YL0016           CD Sort Loss
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBYE8NB    YL0014           CMMR Row Number
     C                     Z-ADDBYAQPC    YL0015           CMMR Std Dressi
     C                     Z-ADDBYEMNB    YL0016           CD Sort Loss
     C                     GOTO TCEXIT                     *QUIT
     C           KRSTC     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZAMCD    WQTD01           CMP Program Cod
     C           *LIKE     DEFN BZE8NB    WQTD02           CMMR Row Number
      * Define keylist
     C           KPSTD     KLIST
     C                     KFLD           WQTD01           CMP Program Cod
     C                     KFLD           WQTD02           CMMR Row Number
     C                     KFLD           BZA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           CMP Program Cod
     C                     KFLD           WQTD02           CMMR Row Number
      * Setup key
     C                     MOVELYL0004    WQTD01           CMP Program Cod
     C                     Z-ADDYL0014    WQTD02           CMMR Row Number
     C                     Z-ADDB1AUPC    BZA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSTD     SETLL@BZREKA                    *
     C           KRSTD     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           CMMC Premium Va
     C                     MOVEL*BLANK    YL0018           Record Found CM
     C                     MOVEL'N'       YL0018           Record Found CM
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0018           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDBZERNB    YL0017           CMMC Premium Va
     C                     GOTO TDEXIT                     *QUIT
     C           KRSTD     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Upd Producer History  RT - Producer History WKLY  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0148 10        RS User Changed
     C                     Z-ADD*ZERO     WN0149  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0150  60       RS Time Changed
     C                     MOVEL*BLANK    WN0151  1        RS Record Statu
     C                     MOVEL*BLANK    WN0152 10        RS Job
     C                     MOVEL*BLANK    WN0153 10        RS Program
     C                     MOVEL*BLANK    WN0154 10        RS User Added
     C                     Z-ADD*ZERO     WN0155  70       RS Date Added
     C                     Z-ADD*ZERO     WN0156  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           CGY3A1           PH Company Numb
     C                     KFLD           CGABCD           PD Producer Cod
     C                     KFLD           CGUVST           PH Summary Type
     C                     KFLD           CGDZDT           PH Week Ending
      * Setup key
     C                     Z-ADDP1HMNB    CGY3A1           PH Company Numb
     C                     MOVELACABCD    CGABCD           PD Producer Cod
     C                     MOVEL'4WK'     CGUVST           PH Summary Type
     C                     Z-ADDP3B5DT    CGDZDT           PH Week Ending
      * Establish starting position
     C           KRSTE     CHAIN@CGCPIR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0180' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HMNB' defaulted for 'PH Company Number'.
      * Create Producer History - Producer History WKLY  * 
     C                     EXSR TFCRRC
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) CGY3A1' defaulted for 'PH Company Number'.
      * Chg Producer History  CH - Producer History WKLY  * 
     C                     EXSR TGCHRC
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Create Producer History - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CGCPIQ
     C                     Z-ADDP1HMNB    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD           PD Producer Cod
     C                     MOVEL'4WK'     WAUVST           PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0105    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0106    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0107    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0108    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0109    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0110    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0111    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0112    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0113    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0114    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0115    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0116    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0117    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0118    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0119    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0120    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0121    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0122    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0123    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0124    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0125    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0126    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0127    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0128    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0129    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0130    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0131    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0132    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0133    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0134    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0135    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0136    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0137    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0138    WAB8A1           PH GA Avg Srt D
     C                     MOVELWN0148    WAAAVN           RS User Changed
     C                     Z-ADDWN0149    WAAADT           RS Date Changed
     C                     Z-ADDWN0150    WAAMTM           RS Time Changed
     C                     MOVELWN0151    WAAJST           RS Record Statu
     C                     MOVELWN0152    WAAHVN           RS Job
     C                     MOVELWN0153    WAAGVN           RS Program
     C                     MOVELWN0154    WAABVN           RS User Added
     C                     Z-ADDWN0155    WAABDT           RS Date Added
     C                     Z-ADDWN0156    WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRTF    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
      * Check for duplicate primary key
     C           KLCRTF    SETLL@CGCPIQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0181' W0RTN   7
      * Send message 'Producer History WKLY  EX'
     C                     MOVEL'PRK0181' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@CGCPIQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg Producer History  CH - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @CGCPIQ
     C                     Z-ADDCGY3A1    WAY3A1           PH Company Numb
     C                     MOVELACABCD    WAABCD    P      PD Producer Cod
     C                     MOVEL'4WK'     WAUVST    P      PH Summary Type
     C                     Z-ADDP3B5DT    WADZDT           PH Week Ending
      *
     C           KLCHTG    KLIST
     C                     KFLD           WAY3A1           PH Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAUVST           PH Summary Type
     C                     KFLD           WADZDT           PH Week Ending
     C           KLCHTG    CHAIN@CGCPIQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCGCPL0'MDACP
     C                     MOVEL'@CGCPIQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCG1    YFRDCS
      * Move non-key fields to @CGCPIQ
     C                     Z-ADDP2OJJF    WAOJJF           PH ALL DOA
     C                     Z-ADDP2ALHD    WAALHD           PH ALL Head Rec
     C                     Z-ADDP2KDUR    WAKDUR           PH ALL Yard Dea
     C                     Z-ADDP2KJOQ    WAKJOQ           PH ALL Head Con
     C                     Z-ADDP2JOWR    WAJOWR           PH ALL Head Kil
     C                     Z-ADDP2OIWE    WAOIWE           PH ALL Live Wei
     C                     Z-ADDWN0105    WAIOTR           PH ALL Avg Live
     C                     Z-ADDP2JOWK    WAJOWK           PH ALL Hot Weig
     C                     Z-ADDWN0106    WAUQWP           PH ALL Avg Hot
     C                     Z-ADDWN0107    WAO6PC           PH ALL Actual Y
     C                     Z-ADDP2JKSE    WAJKSE           PH ALL Adj Live
     C                     Z-ADDWN0108    WAG8PC           PH ALL Adjusted
     C                     Z-ADDWN0109    WAHAPC           PH ALL Avg Lean
     C                     Z-ADDWN0110    WAORJG           PH ALL Avg Back
     C                     Z-ADDWN0111    WAHDPC           PH ALL Avg Loin
     C                     Z-ADDWN0112    WAHFPC           PH ALL Avg Ligh
     C                     Z-ADDWN0113    WAS1PR           PH ALL Base /Li
     C                     Z-ADDWN0114    WATCPR           PH ALL Base /Ca
     C                     Z-ADDWN0115    WAS3PR           PH ALL Sort Dsc
     C                     Z-ADDWN0116    WATDPR           PH ALL Sort Dsc
     C                     Z-ADDWN0117    WAS5PR           PH ALL Lean Prm
     C                     Z-ADDWN0118    WATEPR           PH ALL Lean Prm
     C                     Z-ADDWN0119    WAS7PR           PH ALL Gross /L
     C                     Z-ADDWN0120    WATFPR           PH ALL Gross /C
     C                     Z-ADDWN0121    WAB6A1           PH ALL Avg Srt
     C                     Z-ADDP2JKOS    WAJKOS           PH GA DOA
     C                     Z-ADDP2ALRC    WAALRC           PH GA Head Rece
     C                     Z-ADDP2KDIE    WAKDIE           PH GA Yard Dead
     C                     Z-ADDP2JOEW    WAJOEW           PH GA Head Cond
     C                     Z-ADDP2OWUI    WAOWUI           PH GA Head Kill
     C                     Z-ADDP2IOWN    WAIOWN           PH GA Live Weig
     C                     Z-ADDWN0122    WAORMB           PH GA Avg Live
     C                     Z-ADDP2JOQR    WAJOQR           PH GA Hot Weigh
     C                     Z-ADDWN0123    WAPRUR           PH GA Avg Hot W
     C                     Z-ADDWN0124    WAG7PC           PH GA Actual Yi
     C                     Z-ADDP2IOOG    WAIOOG           PH GA Adj Live
     C                     Z-ADDWN0125    WAG9PC           PH GA Adjusted
     C                     Z-ADDWN0126    WAHBPC           PH GA Avg Lean%
     C                     Z-ADDWN0127    WAUWOE           PH GA Avg Backf
     C                     Z-ADDWN0128    WAHEPC           PH GA Avg Loin
     C                     Z-ADDWN0129    WAHGPC           PH GA Avg Light
     C                     Z-ADDWN0130    WAS2PR           PH GA Base /Liv
     C                     Z-ADDWN0131    WATGPR           PH GA Base /Car
     C                     Z-ADDWN0132    WAS4PR           PH GA Sort Dsc
     C                     Z-ADDWN0133    WATHPR           PH GA Sort Dsc
     C                     Z-ADDWN0134    WAS6PR           PH GA Lean Prm
     C                     Z-ADDWN0135    WATIPR           PH GA Lean Prm
     C                     Z-ADDWN0136    WAS8PR           PH GA Gross /Li
     C                     Z-ADDWN0137    WATJPR           PH GA Gross /Ca
     C                     Z-ADDWN0138    WAB8A1           PH GA Avg Srt D
     C                     MOVELCGAAVN    WAAAVN    P      RS User Changed
     C                     Z-ADDCGAADT    WAAADT           RS Date Changed
     C                     Z-ADDCGAMTM    WAAMTM           RS Time Changed
     C                     MOVELCGAJST    WAAJST    P      RS Record Statu
     C                     MOVELCGAHVN    WAAHVN    P      RS Job
     C                     MOVELCGAGVN    WAAGVN    P      RS Program
     C                     MOVELCGABVN    WAABVN    P      RS User Added
     C                     Z-ADDCGABDT    WAABDT           RS Date Added
     C                     Z-ADDCGABTM    WAABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@CGCPIQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Chk Exists Co/Prd  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQTH01           BOH Company Num
     C           *LIKE     DEFN A1ABCD    WQTH02           PD Producer Cod
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           BOH Company Num
     C                     KFLD           WQTH02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQTH01           BOH Company Num
     C                     MOVELACABCD    WQTH02           PD Producer Cod
      * Establish starting position
     C           KRSTH     SETLL@A1CPEB                    *
     C           KRSTH     READE@A1CPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0019           Record Found US
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0019           Record Found US
     C                     GOTO THEXIT                     *QUIT
     C           KRSTH     READE@A1CPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  3/30/17 JBB E9815  Add Company Number to Producer History
      *          Recompiled for change in access path.  Also check if a
      *          Tattoo Header record exists in initial record selection.
      * 11/04/20 ISE H16853-Recompiled due to change in Buy Order Number
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Clc Producer History   PO
      *================================================================
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2OJJF           PH ALL DOA
     C                     Z-ADD*ZERO     P2ALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     P2KDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     P2KJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     P2JOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     P2OIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     P2IOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     P2JOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     P2UQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     P2O6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     P2JKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     P2G8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     P2HAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     P2ORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     P2HDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     P2HFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     P2S1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     P2TCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     P2S3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     P2TDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     P2S5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     P2TEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     P2S7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     P2TFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     P2JKOS           PH GA DOA
     C                     Z-ADD*ZERO     P2ALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     P2KDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     P2JOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     P2OWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     P2IOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     P2ORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     P2JOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     P2PRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     P2G7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     P2IOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     P2G9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     P2HBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     P2UWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     P2HEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     P2HGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     P2S2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     P2TGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     P2S4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     P2THPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     P2S6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     P2TIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     P2S8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     P2TJPR           PH GA Gross /Ca
     C                     Z-ADD*ZERO     P3GYVA           Base Mkt Price
     C                     Z-ADD*ZERO     P3GZVA           Sort Discount A
     C                     Z-ADD*ZERO     P3G0VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     P3GWVA           Gross Amount
     C                     Z-ADD*ZERO     P3I7VA           Base Mkt Price
     C                     Z-ADD*ZERO     P3I8VA           Sort Discount A
     C                     Z-ADD*ZERO     P3I9VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     P3JAVA           Gross Amount 2
     C                     Z-ADD*ZERO     P3NNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     P3WQNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     P3NONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     P3WERQ           Backfat * Wgt U
     C                     Z-ADD*ZERO     P3NPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     P3GHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     P3SZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     P3RERR           Light Refl * Wg
     C                     Z-ADD*ZERO     P3CBA1           Sort Factor Tot
     C                     Z-ADD*ZERO     P3CCA1           Sort factor Tot
     C                     Z-ADD*ZERO     P3CFA1           Sort Factor Car
     C                     Z-ADD*ZERO     P3CGA1           Sort Factor Car
      *
     C                     Z-ADD*ZERO     WN0001  51       PH ALL Avg Live
     C                     Z-ADD*ZERO     WN0002  51       PH ALL Avg Hot
     C                     Z-ADD*ZERO     WN0003  52       PH ALL Actual Y
     C                     Z-ADD*ZERO     WN0004  52       PH ALL Adjusted
     C                     Z-ADD*ZERO     WN0005  31       PH ALL Avg Lean
     C                     Z-ADD*ZERO     WN0006  31       PH ALL Avg Back
     C                     Z-ADD*ZERO     WN0007  31       PH ALL Avg Loin
     C                     Z-ADD*ZERO     WN0008  31       PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WN0009  52       PH ALL Base /Li
     C                     Z-ADD*ZERO     WN0010  52       PH ALL Base /Ca
     C                     Z-ADD*ZERO     WN0011  52       PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WN0012  52       PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WN0013  52       PH ALL Lean Prm
     C                     Z-ADD*ZERO     WN0014  52       PH ALL Lean Prm
     C                     Z-ADD*ZERO     WN0015  52       PH ALL Gross /L
     C                     Z-ADD*ZERO     WN0016  52       PH ALL Gross /C
     C                     Z-ADD*ZERO     WN0017  53       PH ALL Avg Srt
     C                     Z-ADD*ZERO     WN0018  51       PH GA Avg Live
     C                     Z-ADD*ZERO     WN0019  51       PH GA Avg Hot W
     C                     Z-ADD*ZERO     WN0020  52       PH GA Actual Yi
     C                     Z-ADD*ZERO     WN0021  52       PH GA Adjusted
     C                     Z-ADD*ZERO     WN0022  31       PH GA Avg Lean%
     C                     Z-ADD*ZERO     WN0023  31       PH GA Avg Backf
     C                     Z-ADD*ZERO     WN0024  31       PH GA Avg Loin
     C                     Z-ADD*ZERO     WN0025  31       PH GA Avg Light
     C                     Z-ADD*ZERO     WN0026  52       PH GA Base /Liv
     C                     Z-ADD*ZERO     WN0027  52       PH GA Base /Car
     C                     Z-ADD*ZERO     WN0028  52       PH GA Sort Dsc
     C                     Z-ADD*ZERO     WN0029  52       PH GA Sort Dsc
     C                     Z-ADD*ZERO     WN0030  52       PH GA Lean Prm
     C                     Z-ADD*ZERO     WN0031  52       PH GA Lean Prm
     C                     Z-ADD*ZERO     WN0032  52       PH GA Gross /Li
     C                     Z-ADD*ZERO     WN0033  52       PH GA Gross /Ca
     C                     Z-ADD*ZERO     WN0034  53       PH GA Avg Srt D
      *
      * Clc Producer History   PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * All Tattoo's
      *================================================================
     C                     ADD  A1CXNB    $EOJJF           PH ALL DOA
     C                     ADD  A1CWNB    $EALHD           PH ALL Head Rec
     C                     ADD  A1FCNB    $EKDUR           PH ALL Yard Dea
     C                     ADD  A1FDNB    $EKJOQ           PH ALL Head Con
     C                     ADD  A1FENB    $EJOWR           PH ALL Head Kil
     C                     ADD  A1CYNB    $EOIWE           PH ALL Live Wei
     C                     ADD  A1E0NB    $EJOWK           PH ALL Hot Weig
     C                     ADD  A1LRNB    $EJKSE           PH ALL Adj Live
     C                     ADD  A1ANPR    $EGYVA           Base Mkt Price
     C                     ADD  A1AYVA    $EGZVA           Sort Discount A
     C                     ADD  A1AXVA    $EG0VA           LN AddOn/Deduct
     C                     ADD  A1CBPR    $EGWVA           Gross Amount
     C                     ADD  $DNNNB    $ENNNB           Lean % * Wgt US
     C                     ADD  $DNONB    $ENONB           Backfat * Wgt U
     C                     ADD  $DNPNB    $ENPNB           Loin-Eye * Wgt
     C                     ADD  $DSZNB    $ESZNB           Light Refl * Wg
     C                     ADD  $DCDA1    $ECBA1           Sort Factor Tot
     C                     ADD  $DKFNB    $ECFA1           Sort Factor Car
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ALL: Add PAR to CUR
      *================================================================
     C                     ADD  P2OJJF    $EOJJF           PH ALL DOA
     C                     ADD  P2ALHD    $EALHD           PH ALL Head Rec
     C                     ADD  P2KDUR    $EKDUR           PH ALL Yard Dea
     C                     ADD  P2KJOQ    $EKJOQ           PH ALL Head Con
     C                     ADD  P2JOWR    $EJOWR           PH ALL Head Kil
     C                     ADD  P2OIWE    $EOIWE           PH ALL Live Wei
     C                     ADD  P2JOWK    $EJOWK           PH ALL Hot Weig
     C                     ADD  P2JKSE    $EJKSE           PH ALL Adj Live
     C                     ADD  P3GYVA    $EGYVA           Base Mkt Price
     C                     ADD  P3GZVA    $EGZVA           Sort Discount A
     C                     ADD  P3G0VA    $EG0VA           LN AddOn/Deduct
     C                     ADD  P3GWVA    $EGWVA           Gross Amount
     C                     ADD  P3NNNB    $ENNNB           Lean % * Wgt US
     C                     ADD  P3NONB    $ENONB           Backfat * Wgt U
     C                     ADD  P3NPNB    $ENPNB           Loin-Eye * Wgt
     C                     ADD  P3SZNB    $ESZNB           Light Refl * Wg
     C                     ADD  P3CFA1    $ECFA1           Sort Factor Car
     C                     ADD  P3CBA1    $ECBA1           Sort Factor Tot
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * GA : Add PAR to CUR
      *================================================================
     C                     ADD  P2JKOS    $EJKOS           PH GA DOA
     C                     ADD  P2ALRC    $EALRC           PH GA Head Rece
     C                     ADD  P2KDIE    $EKDIE           PH GA Yard Dead
     C                     ADD  P2JOEW    $EJOEW           PH GA Head Cond
     C                     ADD  P2OWUI    $EOWUI           PH GA Head Kill
     C                     ADD  P2IOWN    $EIOWN           PH GA Live Weig
     C                     ADD  P2JOQR    $EJOQR           PH GA Hot Weigh
     C                     ADD  P2IOOG    $EIOOG           PH GA Adj Live
     C                     ADD  P3I7VA    $EI7VA           Base Mkt Price
     C                     ADD  P3I8VA    $EI8VA           Sort Discount A
     C                     ADD  P3I9VA    $EI9VA           LN AddOn/Deduct
     C                     ADD  P3JAVA    $EJAVA           Gross Amount 2
     C                     ADD  P3WQNB    $EWQNB           Lean % * Wgt US
     C                     ADD  P3WERQ    $EWERQ           Backfat * Wgt U
     C                     ADD  P3GHH5    $EGHH5           Loin-Eye * Wgt
     C                     ADD  P3RERR    $ERERR           Light Refl * Wg
     C                     ADD  P3CGA1    $ECGA1           Sort Factor Car
     C                     ADD  P3CCA1    $ECCA1           Sort factor Tot
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Clc Producer History(1)PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0053  51       PH ALL Avg Live
     C                     Z-ADD*ZERO     WN0054  51       PH ALL Avg Hot
     C                     Z-ADD*ZERO     WN0055  52       PH ALL Actual Y
     C                     Z-ADD*ZERO     WN0056  52       PH ALL Adjusted
     C                     Z-ADD*ZERO     WN0057  31       PH ALL Avg Lean
     C                     Z-ADD*ZERO     WN0058  31       PH ALL Avg Back
     C                     Z-ADD*ZERO     WN0059  31       PH ALL Avg Loin
     C                     Z-ADD*ZERO     WN0060  31       PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WN0061  52       PH ALL Base /Li
     C                     Z-ADD*ZERO     WN0062  52       PH ALL Base /Ca
     C                     Z-ADD*ZERO     WN0063  52       PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WN0064  52       PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WN0065  52       PH ALL Lean Prm
     C                     Z-ADD*ZERO     WN0066  52       PH ALL Lean Prm
     C                     Z-ADD*ZERO     WN0067  52       PH ALL Gross /L
     C                     Z-ADD*ZERO     WN0068  52       PH ALL Gross /C
     C                     Z-ADD*ZERO     WN0069  53       PH ALL Avg Srt
     C                     Z-ADD*ZERO     WN0070  51       PH GA Avg Live
     C                     Z-ADD*ZERO     WN0071  51       PH GA Avg Hot W
     C                     Z-ADD*ZERO     WN0072  52       PH GA Actual Yi
     C                     Z-ADD*ZERO     WN0073  52       PH GA Adjusted
     C                     Z-ADD*ZERO     WN0074  31       PH GA Avg Lean%
     C                     Z-ADD*ZERO     WN0075  31       PH GA Avg Backf
     C                     Z-ADD*ZERO     WN0076  31       PH GA Avg Loin
     C                     Z-ADD*ZERO     WN0077  31       PH GA Avg Light
     C                     Z-ADD*ZERO     WN0078  52       PH GA Base /Liv
     C                     Z-ADD*ZERO     WN0079  52       PH GA Base /Car
     C                     Z-ADD*ZERO     WN0080  52       PH GA Sort Dsc
     C                     Z-ADD*ZERO     WN0081  52       PH GA Sort Dsc
     C                     Z-ADD*ZERO     WN0082  52       PH GA Lean Prm
     C                     Z-ADD*ZERO     WN0083  52       PH GA Lean Prm
     C                     Z-ADD*ZERO     WN0084  52       PH GA Gross /Li
     C                     Z-ADD*ZERO     WN0085  52       PH GA Gross /Ca
     C                     Z-ADD*ZERO     WN0086  53       PH GA Avg Srt D
      *
      * Clc Producer History   PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * All Tattoo's
      *================================================================
     C                     ADD  A1CXNB    $GOJJF           PH ALL DOA
     C                     ADD  A1CWNB    $GALHD           PH ALL Head Rec
     C                     ADD  A1FCNB    $GKDUR           PH ALL Yard Dea
     C                     ADD  A1FDNB    $GKJOQ           PH ALL Head Con
     C                     ADD  A1FENB    $GJOWR           PH ALL Head Kil
     C                     ADD  A1CYNB    $GOIWE           PH ALL Live Wei
     C                     ADD  A1E0NB    $GJOWK           PH ALL Hot Weig
     C                     ADD  A1LRNB    $GJKSE           PH ALL Adj Live
     C                     ADD  A1ANPR    $GGYVA           Base Mkt Price
     C                     ADD  A1AYVA    $GGZVA           Sort Discount A
     C                     ADD  A1AXVA    $GG0VA           LN AddOn/Deduct
     C                     ADD  A1CBPR    $GGWVA           Gross Amount
     C                     ADD  $FNNNB    $GNNNB           Lean % * Wgt US
     C                     ADD  $FNONB    $GNONB           Backfat * Wgt U
     C                     ADD  $FNPNB    $GNPNB           Loin-Eye * Wgt
     C                     ADD  $FSZNB    $GSZNB           Light Refl * Wg
     C                     ADD  $FCDA1    $GCBA1           Sort Factor Tot
     C                     ADD  $FKFNB    $GCFA1           Sort Factor Car
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * ALL: Add PAR to CUR
      *================================================================
     C                     ADD  P2OJJF    $GOJJF           PH ALL DOA
     C                     ADD  P2ALHD    $GALHD           PH ALL Head Rec
     C                     ADD  P2KDUR    $GKDUR           PH ALL Yard Dea
     C                     ADD  P2KJOQ    $GKJOQ           PH ALL Head Con
     C                     ADD  P2JOWR    $GJOWR           PH ALL Head Kil
     C                     ADD  P2OIWE    $GOIWE           PH ALL Live Wei
     C                     ADD  P2JOWK    $GJOWK           PH ALL Hot Weig
     C                     ADD  P2JKSE    $GJKSE           PH ALL Adj Live
     C                     ADD  P3GYVA    $GGYVA           Base Mkt Price
     C                     ADD  P3GZVA    $GGZVA           Sort Discount A
     C                     ADD  P3G0VA    $GG0VA           LN AddOn/Deduct
     C                     ADD  P3GWVA    $GGWVA           Gross Amount
     C                     ADD  P3NNNB    $GNNNB           Lean % * Wgt US
     C                     ADD  P3NONB    $GNONB           Backfat * Wgt U
     C                     ADD  P3NPNB    $GNPNB           Loin-Eye * Wgt
     C                     ADD  P3SZNB    $GSZNB           Light Refl * Wg
     C                     ADD  P3CFA1    $GCFA1           Sort Factor Car
     C                     ADD  P3CBA1    $GCBA1           Sort Factor Tot
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * GA : Add PAR to CUR
      *================================================================
     C                     ADD  P2JKOS    $GJKOS           PH GA DOA
     C                     ADD  P2ALRC    $GALRC           PH GA Head Rece
     C                     ADD  P2KDIE    $GKDIE           PH GA Yard Dead
     C                     ADD  P2JOEW    $GJOEW           PH GA Head Cond
     C                     ADD  P2OWUI    $GOWUI           PH GA Head Kill
     C                     ADD  P2IOWN    $GIOWN           PH GA Live Weig
     C                     ADD  P2JOQR    $GJOQR           PH GA Hot Weigh
     C                     ADD  P2IOOG    $GIOOG           PH GA Adj Live
     C                     ADD  P3I7VA    $GI7VA           Base Mkt Price
     C                     ADD  P3I8VA    $GI8VA           Sort Discount A
     C                     ADD  P3I9VA    $GI9VA           LN AddOn/Deduct
     C                     ADD  P3JAVA    $GJAVA           Gross Amount 2
     C                     ADD  P3WQNB    $GWQNB           Lean % * Wgt US
     C                     ADD  P3WERQ    $GWERQ           Backfat * Wgt U
     C                     ADD  P3GHH5    $GGHH5           Loin-Eye * Wgt
     C                     ADD  P3RERR    $GRERR           Light Refl * Wg
     C                     ADD  P3CGA1    $GCGA1           Sort Factor Car
     C                     ADD  P3CCA1    $GCCA1           Sort factor Tot
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Clc Producer History(1)PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0105  51       PH ALL Avg Live
     C                     Z-ADD*ZERO     WN0106  51       PH ALL Avg Hot
     C                     Z-ADD*ZERO     WN0107  52       PH ALL Actual Y
     C                     Z-ADD*ZERO     WN0108  52       PH ALL Adjusted
     C                     Z-ADD*ZERO     WN0109  31       PH ALL Avg Lean
     C                     Z-ADD*ZERO     WN0110  31       PH ALL Avg Back
     C                     Z-ADD*ZERO     WN0111  31       PH ALL Avg Loin
     C                     Z-ADD*ZERO     WN0112  31       PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WN0113  52       PH ALL Base /Li
     C                     Z-ADD*ZERO     WN0114  52       PH ALL Base /Ca
     C                     Z-ADD*ZERO     WN0115  52       PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WN0116  52       PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WN0117  52       PH ALL Lean Prm
     C                     Z-ADD*ZERO     WN0118  52       PH ALL Lean Prm
     C                     Z-ADD*ZERO     WN0119  52       PH ALL Gross /L
     C                     Z-ADD*ZERO     WN0120  52       PH ALL Gross /C
     C                     Z-ADD*ZERO     WN0121  53       PH ALL Avg Srt
     C                     Z-ADD*ZERO     WN0122  51       PH GA Avg Live
     C                     Z-ADD*ZERO     WN0123  51       PH GA Avg Hot W
     C                     Z-ADD*ZERO     WN0124  52       PH GA Actual Yi
     C                     Z-ADD*ZERO     WN0125  52       PH GA Adjusted
     C                     Z-ADD*ZERO     WN0126  31       PH GA Avg Lean%
     C                     Z-ADD*ZERO     WN0127  31       PH GA Avg Backf
     C                     Z-ADD*ZERO     WN0128  31       PH GA Avg Loin
     C                     Z-ADD*ZERO     WN0129  31       PH GA Avg Light
     C                     Z-ADD*ZERO     WN0130  52       PH GA Base /Liv
     C                     Z-ADD*ZERO     WN0131  52       PH GA Base /Car
     C                     Z-ADD*ZERO     WN0132  52       PH GA Sort Dsc
     C                     Z-ADD*ZERO     WN0133  52       PH GA Sort Dsc
     C                     Z-ADD*ZERO     WN0134  52       PH GA Lean Prm
     C                     Z-ADD*ZERO     WN0135  52       PH GA Lean Prm
     C                     Z-ADD*ZERO     WN0136  52       PH GA Gross /Li
     C                     Z-ADD*ZERO     WN0137  52       PH GA Gross /Ca
     C                     Z-ADD*ZERO     WN0138  53       PH GA Avg Srt D
      *
      * Clc Producer History   PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * All Tattoo's
      *================================================================
     C                     ADD  A1CXNB    $IOJJF           PH ALL DOA
     C                     ADD  A1CWNB    $IALHD           PH ALL Head Rec
     C                     ADD  A1FCNB    $IKDUR           PH ALL Yard Dea
     C                     ADD  A1FDNB    $IKJOQ           PH ALL Head Con
     C                     ADD  A1FENB    $IJOWR           PH ALL Head Kil
     C                     ADD  A1CYNB    $IOIWE           PH ALL Live Wei
     C                     ADD  A1E0NB    $IJOWK           PH ALL Hot Weig
     C                     ADD  A1LRNB    $IJKSE           PH ALL Adj Live
     C                     ADD  A1ANPR    $IGYVA           Base Mkt Price
     C                     ADD  A1AYVA    $IGZVA           Sort Discount A
     C                     ADD  A1AXVA    $IG0VA           LN AddOn/Deduct
     C                     ADD  A1CBPR    $IGWVA           Gross Amount
     C                     ADD  $HNNNB    $INNNB           Lean % * Wgt US
     C                     ADD  $HNONB    $INONB           Backfat * Wgt U
     C                     ADD  $HNPNB    $INPNB           Loin-Eye * Wgt
     C                     ADD  $HSZNB    $ISZNB           Light Refl * Wg
     C                     ADD  $HCDA1    $ICBA1           Sort Factor Tot
     C                     ADD  $HKFNB    $ICFA1           Sort Factor Car
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * ALL: Add PAR to CUR
      *================================================================
     C                     ADD  P2OJJF    $IOJJF           PH ALL DOA
     C                     ADD  P2ALHD    $IALHD           PH ALL Head Rec
     C                     ADD  P2KDUR    $IKDUR           PH ALL Yard Dea
     C                     ADD  P2KJOQ    $IKJOQ           PH ALL Head Con
     C                     ADD  P2JOWR    $IJOWR           PH ALL Head Kil
     C                     ADD  P2OIWE    $IOIWE           PH ALL Live Wei
     C                     ADD  P2JOWK    $IJOWK           PH ALL Hot Weig
     C                     ADD  P2JKSE    $IJKSE           PH ALL Adj Live
     C                     ADD  P3GYVA    $IGYVA           Base Mkt Price
     C                     ADD  P3GZVA    $IGZVA           Sort Discount A
     C                     ADD  P3G0VA    $IG0VA           LN AddOn/Deduct
     C                     ADD  P3GWVA    $IGWVA           Gross Amount
     C                     ADD  P3NNNB    $INNNB           Lean % * Wgt US
     C                     ADD  P3NONB    $INONB           Backfat * Wgt U
     C                     ADD  P3NPNB    $INPNB           Loin-Eye * Wgt
     C                     ADD  P3SZNB    $ISZNB           Light Refl * Wg
     C                     ADD  P3CFA1    $ICFA1           Sort Factor Car
     C                     ADD  P3CBA1    $ICBA1           Sort Factor Tot
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * GA : Add PAR to CUR
      *================================================================
     C                     ADD  P2JKOS    $IJKOS           PH GA DOA
     C                     ADD  P2ALRC    $IALRC           PH GA Head Rece
     C                     ADD  P2KDIE    $IKDIE           PH GA Yard Dead
     C                     ADD  P2JOEW    $IJOEW           PH GA Head Cond
     C                     ADD  P2OWUI    $IOWUI           PH GA Head Kill
     C                     ADD  P2IOWN    $IIOWN           PH GA Live Weig
     C                     ADD  P2JOQR    $IJOQR           PH GA Hot Weigh
     C                     ADD  P2IOOG    $IIOOG           PH GA Adj Live
     C                     ADD  P3I7VA    $II7VA           Base Mkt Price
     C                     ADD  P3I8VA    $II8VA           Sort Discount A
     C                     ADD  P3I9VA    $II9VA           LN AddOn/Deduct
     C                     ADD  P3JAVA    $IJAVA           Gross Amount 2
     C                     ADD  P3WQNB    $IWQNB           Lean % * Wgt US
     C                     ADD  P3WERQ    $IWERQ           Backfat * Wgt U
     C                     ADD  P3GHH5    $IGHH5           Loin-Eye * Wgt
     C                     ADD  P3RERR    $IRERR           Light Refl * Wg
     C                     ADD  P3CGA1    $ICGA1           Sort Factor Car
     C                     ADD  P3CCA1    $ICCA1           Sort factor Tot
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2OJJF           PH ALL DOA
     C                     Z-ADD*ZERO     P2ALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     P2KDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     P2KJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     P2JOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     P2OIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     P2IOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     P2JOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     P2UQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     P2O6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     P2JKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     P2G8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     P2HAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     P2ORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     P2HDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     P2HFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     P2S1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     P2TCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     P2S3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     P2TDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     P2S5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     P2TEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     P2S7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     P2TFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     P2JKOS           PH GA DOA
     C                     Z-ADD*ZERO     P2ALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     P2KDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     P2JOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     P2OWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     P2IOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     P2ORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     P2JOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     P2PRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     P2G7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     P2IOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     P2G9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     P2HBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     P2UWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     P2HEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     P2HGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     P2S2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     P2TGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     P2S4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     P2THPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     P2S6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     P2TIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     P2S8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     P2TJPR           PH GA Gross /Ca
     C                     Z-ADD*ZERO     P3GYVA           Base Mkt Price
     C                     Z-ADD*ZERO     P3GZVA           Sort Discount A
     C                     Z-ADD*ZERO     P3G0VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     P3GWVA           Gross Amount
     C                     Z-ADD*ZERO     P3I7VA           Base Mkt Price
     C                     Z-ADD*ZERO     P3I8VA           Sort Discount A
     C                     Z-ADD*ZERO     P3I9VA           LN AddOn/Deduct
     C                     Z-ADD*ZERO     P3JAVA           Gross Amount 2
     C                     Z-ADD*ZERO     P3NNNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     P3WQNB           Lean % * Wgt US
     C                     Z-ADD*ZERO     P3NONB           Backfat * Wgt U
     C                     Z-ADD*ZERO     P3WERQ           Backfat * Wgt U
     C                     Z-ADD*ZERO     P3NPNB           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     P3GHH5           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     P3SZNB           Light Refl * Wg
     C                     Z-ADD*ZERO     P3RERR           Light Refl * Wg
     C                     Z-ADD*ZERO     P3CBA1           Sort Factor Tot
     C                     Z-ADD*ZERO     P3CCA1           Sort factor Tot
     C                     Z-ADD*ZERO     P3CFA1           Sort Factor Car
     C                     Z-ADD*ZERO     P3CGA1           Sort Factor Car
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    ACABCD           PD Producer Cod
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1ABCD           PD Producer Cod
     C                     MOVEL*HIVAL    A1B0DT           TH Kill Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY3A1           PH Company Numb
     C                     Z-ADD*ZERO     WADZDT           PH Week Ending
     C                     Z-ADD*ZERO     WAOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     WAALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     WAKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     WAKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     WAJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     WAOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     WAIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     WAJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     WAUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     WAO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     WAJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     WAG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     WAHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     WAORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     WAHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     WAHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WAS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     WATCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     WAS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WATDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WAS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WATEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WAS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     WATFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     WAB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     WAJKOS           PH GA DOA
     C                     Z-ADD*ZERO     WAALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     WAKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     WAJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     WAOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     WAIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     WAORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     WAJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     WAPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     WAG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     WAIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     WAG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     WAHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     WAUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     WAHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     WAHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     WAS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     WATGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     WAS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WATHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WAS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WATIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WAS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     WATJPR           PH GA Gross /Ca
     C                     Z-ADD*ZERO     WAB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1ABCD           PD Producer Cod
     C                     MOVEL*HIVAL    A1B0DT           TH Kill Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1ABCD           PD Producer Cod
     C                     MOVEL*HIVAL    A1B0DT           TH Kill Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field BOH Quote Price Type
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field PC Contract Code
     C                     MOVEL*BLANK    YL0002  5
      * Define local work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    YL0003  5
      * Define local work field CMP Program Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field CMP Description
     C                     MOVEL*BLANK    YL0005 25
      * Define local work field CMP Grading Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field CMP Sort Basis
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field CMP Carc Wgt Type
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field CMP Std Lean Percent
     C                     Z-ADD*ZERO     YL0009  31
      * Define local work field CMP Lean Factor
     C                     Z-ADD*ZERO     YL0010  31
      * Define local work field CMP Optimal Row Nbr f/srt
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field CMP Type
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     YL0013  52
      * Define local work field CMMR Row Number
     C                     Z-ADD*ZERO     YL0014  30
      * Define local work field CMMR Std Dressing Yield%
     C                     Z-ADD*ZERO     YL0015  52
      * Define local work field CD Sort Loss
     C                     Z-ADD*ZERO     YL0016  72
      * Define local work field CMMC Premium Value
     C                     Z-ADD*ZERO     YL0017  53
      * Define local work field Record Found CMMC USR
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0019  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
