     H/TITLE PRT Load Summ By Carr  PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/01/19  Time  : 17:16:55
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPLFIF  E           K        DISK
      * RSQ : Order Header TRG          Carrier/Load#/RqDlvDt
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FPDEXPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Load Summ By Carr  PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  USR From Date
     I                                    P   1   40P1BDDT
     IP2PARM      DS
      * I :  USR To Date
     I                                    P   1   40P2FDDT
     IP3PARM      DS
      * I :  Prm From Date
     I                                    P   1   40P3FTDT
     IP4PARM      DS
      * I :  Prm To Date
     I                                    P   1   40P4FUDT
     IP5PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P5AIC3
      * N :  Order Number
     I                                    P   3   60P5C4NB
      * N :  Order Weight Total
     I                                    P   7  122P5A1WG
      * I :  Load ID
     I                                    P  13  160P5RMNB
      * I :  Shipping Method
     I                                       17  18 P5Q2CD
      * N :  Export Status
     I                                       19  19 P5U2ST
     IP6PARM      DS
      * I :  USR Carrier Code
     I                                        1   3 P6R6CD
     IP7PARM      DS
      * I :  USR Check Y/N Status
     I                                        1   1 P7JDST
     IP8PARM      DS
      * I :  USR Load Type
     I                                        1   1 P8WNST
     IP9PARM      DS
      * FLD: *Arrays
      * I :  USR Warehouse Code
     I                                        1   3 P9CPCD
      * I :  USR CDE Parm 1
     I                                        4   6 P9VSCD
      * I :  USR CDE Parm 2
     I                                        7   9 P9VTCD
      * I :  USR CDE Parm 3
     I                                       10  12 P9VUCD
      * I :  USR CDE Parm 4
     I                                       13  15 P9VVCD
      * I :  USR CDE Parm 5
     I                                       16  18 P9VWCD
      * I :  USR CDE Parm 6
     I                                       19  21 P9VXCD
      * I :  USR CDE Parm 7
     I                                       22  24 P9VYCD
      * I :  USR CDE Parm 8
     I                                       25  27 P9VZCD
      * I :  USR CDE Parm 9
     I                                       28  30 P9V0CD
      * I :  USR Select/Omit Flag
     I                                       31  31 P9CYST
      * I :  From Date             USR
     I                                    P  32  350P9L9DT
      * I :  Thru Date             USR
     I                                    P  36  390P9OADT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BDDT    PARM           WP0001  70       USR From Date
     C           P2FDDT    PARM           WP0002  70       USR To Date
     C           P3FTDT    PARM           WP0003  70       Prm From Date
     C           P4FUDT    PARM           WP0004  70       Prm To Date
     C           P5AIC3    PARM           WP0005  30       Company Number
     C           P5RMNB    PARM           WP0006  70       Load ID
     C           P5Q2CD    PARM           WP0007  2        Shipping Method
     C           P6R6CD    PARM           WP0008  3        USR Carrier Cod
     C           P7JDST    PARM           WP0009  1        USR Check Y/N S
     C           P8WNST    PARM           WP0010  1        USR Load Type
     C           P9CPCD    PARM           WP0011  3        USR Warehouse C
     C           P9VSCD    PARM           WP0012  3        USR CDE Parm 1
     C           P9VTCD    PARM           WP0013  3        USR CDE Parm 2
     C           P9VUCD    PARM           WP0014  3        USR CDE Parm 3
     C           P9VVCD    PARM           WP0015  3        USR CDE Parm 4
     C           P9VWCD    PARM           WP0016  3        USR CDE Parm 5
     C           P9VXCD    PARM           WP0017  3        USR CDE Parm 6
     C           P9VYCD    PARM           WP0018  3        USR CDE Parm 7
     C           P9VZCD    PARM           WP0019  3        USR CDE Parm 8
     C           P9V0CD    PARM           WP0020  3        USR CDE Parm 9
     C           P9CYST    PARM           WP0021  1        USR Select/Omit
     C           P9L9DT    PARM           WP0022  70       From Date
     C           P9OADT    PARM           WP0023  70       Thru Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Load Summ By Carr  PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$JENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Load Summ By Carr  PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@BFCPRE                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Carrier Code
     C                     MOVEL'Y'       W0AL01  1        Load ID
     C                     MOVEL'Y'       W0AL02  1        Requested Deliv
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $ICOWG           USR Weight   9.
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDBEAIC3    $HAIC3           Company Number
     C                     Z-ADDBEC4NB    $HC4NB           Order Number
     C                     MOVELBEDBCD    $HDBCD           Ship To State C
     C                     Z-ADDBEAODT    $HAODT           Scheduled Ship
     C                     Z-ADDBERMNB    $HRMNB           Load ID
     C                     Z-ADDBEA1WG    $HA1WG           Order Weight To
     C                     Z-ADD*ZERO     $HCOWG           USR Weight   9.
     C                     Z-ADD*ZERO     $HH8WG           USR Weight   9.
     C                     Z-ADD*ZERO     $HH9WG           USR Weight   9.
     C                     Z-ADD*ZERO     $HIAWG           USR Weight   9.
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $CAIC3           Company Number
     C                     Z-ADDBEC4NB    $CC4NB           Order Number
     C                     Z-ADDBEBKC7    $CBKC7           Ship To Custome
     C                     MOVELBEBRTX    $CBRTX           Ship To Name
     C                     MOVELBEHNNA    $CHNNA           Ship To City
     C                     MOVELBEDBCD    $CDBCD           Ship To State C
     C                     MOVELBEBCNA    $CBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $CR9NB           Order Quantity
     C                     Z-ADDBEA1WG    $CA1WG           Order Weight To
     C                     Z-ADD*ZERO     $CCOWG           USR Weight   9.
     C                     MOVELBEQ2CD    $CQ2CD           Shipping Method
     C                     Z-ADDBERMNB    $CRMNB           Load ID
     C                     Z-ADD*ZERO     $CRVNB           Stop/Drop
     C                     Z-ADDBEEIDT    $CEIDT           Requested Deliv
     C                     Z-ADDBEAODT    $CAODT           Scheduled Ship
     C                     MOVELBEXIST    $CXIST           Credit Hold
     C                     MOVELBEXJST    $CXJST           Production Hold
     C                     MOVELBEBZNA    $CBZNA           Carrier Code
     C                     MOVELBEU2ST    $CU2ST           Export Status
     C                     MOVELBER4CD    $CR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $CAJCD           Warehouse Code
     C                     MOVELBEB6NA    $CB6NA           Special Instruc
     C                     MOVELBEBYNA    $CBYNA           Special Instruc
     C                     Z-ADDBEVRVA    $CVRVA           A/R order Value
     C                     MOVELBEOBST    $COBST           Billing Activit
     C                     MOVELBEBCST    $CBCST           Block Order Fla
     C                     MOVELBEBDST    $CBDST           Order Certifica
     C                     Z-ADDBEB7VL    $CB7VL           Invoice Order V
     C                     MOVELBEGASX    $CGASX           Process Sts for
     C                     MOVELBEGBSX    $CGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $CGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $CGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $CFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $CFOSX           Email Cust On O
     C                     MOVELBEFPSX    $CFPSX           Order Emailed
     C                     MOVELBEFQSX    $CFQSX           Export Docs Go
     C                     MOVELBEFRSX    $CFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $CFSSX           Broker Order St
     C                     MOVELBEFTSX    $CFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $CFUSX           Order Requires
     C                     MOVELBEFVSX    $CFVSX           OH Load Plan Re
     C                     MOVELBEFWSX    $CFWSX           Export USDA App
     C                     MOVELBEFXSX    $CFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $CFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $CNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    $CNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    $CNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    $CNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    $CNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    $CBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $CBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $CBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    $CBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    $CBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    $CH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $CH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $CH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $CH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $CH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $CC0C7           Claim Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Load Summary Dtl   PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Load Summ Exp Inst PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $CCOWG    $HCOWG           USR Weight   9.
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEBZNA    WZA001           Carrier Code
     C                     MOVELBEBZNA    WZA001
     C           *LIKE     DEFN BERMNB    WZA002           Load ID
     C                     Z-ADDBERMNB    WZA002
     C           *LIKE     DEFN BEEIDT    WZA003           Requested Deliv
     C                     Z-ADDBEEIDT    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @BFCPRE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Select on Order Header Company number if company number was passe
      * CASE: PAR.Company Number is greater than zero
     C           P5AIC3    IFGT *ZERO                      *IF
      * CASE: PAR.Company Number EQ DB1.Company Number
     C           P5AIC3    IFEQ BEAIC3                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Select
     C           P9CYST    IFEQ 'S'                        *IF
      * Select only Order Detail records matching warehouse codes passed
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           P9CPCD    IFNE *BLANK                     *IF
     C           P9VSCD    ORNE *BLANK                     *OR
     C           P9VTCD    ORNE *BLANK                     *OR
     C           P9VUCD    ORNE *BLANK                     *OR
     C           P9VVCD    ORNE *BLANK                     *OR
     C           P9VWCD    ORNE *BLANK                     *OR
     C           P9VXCD    ORNE *BLANK                     *OR
     C           P9VYCD    ORNE *BLANK                     *OR
     C           P9VZCD    ORNE *BLANK                     *OR
     C           P9V0CD    ORNE *BLANK                     *OR
     C                     MOVEL'N'       WUDJST           Select Status
      * Check warehouse 1
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           P9CPCD    IFNE *BLANK                     *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9CPCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VSCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VSCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VTCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VTCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VUCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VUCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VVCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VVCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 6
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VWCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VWCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 7
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VXCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VXCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VYCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VYCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 9
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9VZCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9VZCD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 10
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9V0CD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0014           Company Number
     C                     Z-ADDBEC4NB    WL0015           Order Number
     C                     MOVELP9V0CD    WL0016    P      Warehouse Code
     C                     MOVELWUDJST    WL0017    P      Select Status
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WUDJST    P      Select Status
     C                     END                             *FI
      * If select status is no then do not select record
      * CASE: WRK.Select Status is no
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Omit passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Omit
     C           P9CYST    IFEQ 'O'                        *IF
      * Omit any Order Detail records matching warehouse codes passed in
      * Get the warehouse from the first order detail record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * RTV Warehouse code     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0001           Company Number
     C                     Z-ADDBEC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WUAJCD    P      Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           P9CPCD    IFNE *BLANK                     *IF
     C           P9VSCD    ORNE *BLANK                     *OR
     C           P9VTCD    ORNE *BLANK                     *OR
     C           P9VUCD    ORNE *BLANK                     *OR
     C           P9VVCD    ORNE *BLANK                     *OR
     C           P9VWCD    ORNE *BLANK                     *OR
     C           P9VXCD    ORNE *BLANK                     *OR
     C           P9VYCD    ORNE *BLANK                     *OR
     C           P9VZCD    ORNE *BLANK                     *OR
     C           P9V0CD    ORNE *BLANK                     *OR
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code EQ WRK.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ WRK.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ WRK.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ WRK.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ WRK.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ WRK.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ WRK.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ WRK.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ WRK.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ WRK.Warehouse Code
      *   '-
     C           P9CPCD    IFEQ WUAJCD                     *IF
     C           P9VSCD    OREQ WUAJCD                     *OR
     C           P9VTCD    OREQ WUAJCD                     *OR
     C           P9VUCD    OREQ WUAJCD                     *OR
     C           P9VVCD    OREQ WUAJCD                     *OR
     C           P9VWCD    OREQ WUAJCD                     *OR
     C           P9VXCD    OREQ WUAJCD                     *OR
     C           P9VYCD    OREQ WUAJCD                     *OR
     C           P9VZCD    OREQ WUAJCD                     *OR
     C           P9V0CD    OREQ WUAJCD                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Don't select caneceled orders
      * CASE: DB1.Header Status is Cancelled
     C           BEGWST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Don't select credit or debit memos
      * CASE: DB1.Billing Activity Type is Credit or Debit Memo
     C           BEOBST    IFEQ '2'                        *IF
     C           BEOBST    OREQ '3'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If Carrier code is entered omit all others
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR Carrier Code is entered
      *   |- c2    : DB1.Carrier Code NE PAR.USR Carrier Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6R6CD    IFNE *BLANK                     *IF
     C           BEBZNA    IFNE P6R6CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If Load ID is zeros, skip it
      * CASE: DB1.Load ID is Blank
     C           BERMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If Load number is entered omit all others
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Load ID is GT Zero
      *   |- c2    : DB1.Load ID NE PAR.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5RMNB    IFGT *ZERO                      *IF
     C           BERMNB    IFNE P5RMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If Load Type is entered omit all others
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.USR Load Type is Bulk
      *   |- c2    : PAR.USR Load Type is Regular
      *   '-
     C           P8WNST    IFEQ 'B'                        *IF
     C           P8WNST    OREQ 'R'                        *OR
      * CASE: DB1.Load Type NE PAR.USR Load Type
     C           BEVDST    IFNE P8WNST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * If Shipping Method is entered omit all others
      * CASE: PAR.Shipping Method NE WRK.BLANK
     C           P5Q2CD    IFNE WUGSTX                     *IF
      * CASE: DB1.Shipping Method NE PAR.Shipping Method
     C           BEQ2CD    IFNE P5Q2CD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * ** Check dates if entered: Appt confirmed, Rqs Deliv, or Sch Ship
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.From Date             USR is Entered
      *   |- c2    : PAR.Thru Date             USR is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9L9DT    IFNE *ZERO                      *IF
     C           P9OADT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Select by appointment confirmed or requested delivery date
      * RTV Stop Number       RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBERMNB    WL0006           Load ID
     C                     Z-ADDBEC4NB    WL0008           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YN0002           Stop/Drop
     C                     Z-ADDWL0009    YL0016           Appointment Con
     C                     Z-ADDWL0010    YL0017           Appointment Con
      * CASE: LCL.Appointment Confirm Date is Entered
     C           YL0016    IFNE *ZERO                      *IF
      * CASE: Test Appointment Confirm Date within range
      *  - c1 AND c2
      *   |- c1    : LCL.Appointment Confirm Date GE PAR.From Date
      *   |- c2    : LCL.Appointment Confirm Date LE PAR.Thru Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0016    IFGE P9L9DT                     *IF
     C           YL0016    IFLE P9OADT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Test Requested Delivery Date
      *  - c1 AND c2
      *   |- c1    : PAR.Prm From Date is GT Zero
      *   |- c2    : PAR.Prm To Date is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3FTDT    IFGT *ZERO                      *IF
     C           P4FUDT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Requested Delivery Date is within requested range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Requested Delivery Date GE PAR.Prm From Date
      *   |- c2    : DB1.Requested Delivery Date LE PAR.Prm To Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEEIDT    IFGE P3FTDT                     *IF
     C           BEEIDT    IFLE P4FUDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR From Date is Entered
      *   |- c2    : PAR.USR To Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BDDT    IFNE *ZERO                      *IF
     C           P2FDDT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: Test Scheduled Ship Date is within range
      *  - c1 AND c2
      *   |- c1    : DB1.Scheduled Ship Date GE PAR.USR From Date
      *   |- c2    : DB1.Scheduled Ship Date LE PAR.USR To Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEAODT    IFGE P1BDDT                     *IF
     C           BEAODT    IFLE P2FDDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Carrier Code
     C                     MOVEL*BLANK    W0AL01  1        Load ID
     C                     MOVEL*BLANK    W0AL02  1        Requested Deliv
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Carrier Code
     C                     MOVEL'Y'       W0AL01  1        Load ID
     C                     MOVEL'Y'       W0AL02  1        Requested Deliv
     C                     ELSE
      * Next record - Detect level breaks
     C           BEBZNA    IFNE WZA001                     Carrier Code
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BERMNB    IFNE WZA002                     Load ID
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           BEEIDT    IFNE WZA003                     Requested Deliv
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * PRTOBJ calls before print of Load ID format
      * Embedded PRTOBJ : PRT Print Comments     PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
     C                     Z-ADDP5A1WG    $HCOWG           USR Weight   9.
     C                     Z-ADD*ZERO     P5A1WG           Order Weight To
      * ***  PK0111
      * CASE: CUR.Load ID is 24036
     C           $HRMNB    IFEQ 84511                      *IF
     C                     MOVEL*BLANK    WUBDTX           Item Descriptio
     C                     MOVEL@CN,002   WUBDTX           Item Descriptio
     C                     END                             *FI
      * RTV Wgt Shipped Tot    RT - Order Header TRG  * 
     C                     EXSR SORVGN
      * CLC Misc Tare Wgt Tot  RT - Order Header TRG  * 
     C                     EXSR SQRVGN
      * CLC Pakg Tare Wgt Tot  RT - Order Header TRG  * 
     C                     EXSR STRVGN
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of Load ID format
     C                     ADD  $HCOWG    $ICOWG           USR Weight   9.
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Load Summary Dtl   PO: Mainline
      *================================================================
      * PRT Load Summary Dtl   PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQKB01           Company Number
     C           *LIKE     DEFN WAC4NB    WQKB02           Order Number
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADD$CAIC3    WQKB01           Company Number
     C                     Z-ADD$CC4NB    WQKB02           Order Number
      * Establish starting position
     C           KRSB      SETLL@BECPFK                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAC4NB    $DC4NB           Order Number
     C                     Z-ADDWAAIC3    $DAIC3           Company Number
     C                     MOVELWAJNCD    $DJNCD           Order Type - Sa
     C                     Z-ADDWAANC7    $DANC7           A/R Customer Nu
     C                     Z-ADDWABKC7    $DBKC7           Ship To Custome
     C                     MOVEL*BLANK    $DDMNA           USR Shortened n
     C                     MOVELWABRTX    $DBRTX           Ship To Name
     C                     MOVELWAHMNA    $DHMNA           Ship To Address
     C                     MOVELWAHONA    $DHONA           Ship To Address
     C                     MOVELWAHPNA    $DHPNA           Ship To Address
     C                     MOVELWAHNNA    $DHNNA           Ship To City
     C                     MOVELWADBCD    $DDBCD           Ship To State C
     C                     MOVELWACKTX    $DCKTX           Ship To Zip/Pos
     C                     Z-ADDWAB0C7    $DB0C7           Bill to Custome
     C                     MOVELWAAETX    $DAETX           Bill to Name
     C                     MOVELWAB1NA    $DB1NA           Bill to Address
     C                     MOVELWAB3NA    $DB3NA           Bill to Address
     C                     MOVELWAB4NA    $DB4NA           Bill to Address
     C                     MOVELWAB2NA    $DB2NA           Bill to City
     C                     MOVELWABHCD    $DBHCD           Bill to State C
     C                     MOVELWAC8TX    $DC8TX           Bill to Zip/Pos
     C                     MOVELWABCNA    $DBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $DR9NB           Order Quantity
     C                     Z-ADD*ZERO     $DCOWG           USR Weight   9.
     C                     MOVELWAQ2CD    $DQ2CD           Shipping Method
     C                     Z-ADDWARMNB    $DRMNB           Load ID
     C                     Z-ADD*ZERO     $DRVNB           Stop/Drop
     C                     Z-ADDWAEIDT    $DEIDT           Requested Deliv
     C                     Z-ADDWAAODT    $DAODT           Scheduled Ship
     C                     Z-ADD*ZERO     $DYANB           Deadline Depart
     C                     MOVELWAXIST    $DXIST           Credit Hold
     C                     MOVELWAXJST    $DXJST           Production Hold
     C                     MOVEL*BLANK    $DPKST           Load Status
     C                     MOVEL*BLANK    $DNGST           Flag 2
     C                     MOVEL*BLANK    $DFLG3           Flag 3
     C                     Z-ADDWAA0DT    $DA0DT           Order Date
     C                     Z-ADDWAA5DT    $DA5DT           Requested Ship
     C                     Z-ADDWAGNDT    $DGNDT           Actual Shipped
     C                     Z-ADDWAACDT    $DACDT           Cancel Date
     C                     MOVELWAAQCD    $DAQCD           Terms Code
     C                     MOVELWABZNA    $DBZNA           Carrier Code
     C                     MOVEL*BLANK    $DDXTX           Trailer Id
     C                     MOVEL*BLANK    $DS2TX           Trailer ID USR
     C                     MOVEL*BLANK    $DONTM           On Time - (Y/N)
     C                     MOVELWAVGST    $DVGST           Slip Sheet
     C                     MOVELWAVFST    $DVFST           Shrink Wrap
     C                     MOVELWAVEST    $DVEST           Palletize
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     MOVELWAGTST    $DGTST           Comment Print A
     C                     MOVELWAGVST    $DGVST           Comment Print I
     C                     MOVELWAGUST    $DGUST           Comment Print P
     C                     MOVELWAQFST    $DQFST           Comment Print S
     C                     MOVELWACQCD    $DCQCD           Reason Code
     C                     MOVELWAGJST    $DGJST           Order in Use
     C                     MOVELWAGWST    $DGWST           Header Status
     C                     MOVELWAGXST    $DGXST           Header Status L
     C                     MOVELWAGYST    $DGYST           Order Type Prin
     C                     MOVELWAAIVN    $DAIVN           User Original E
     C                     Z-ADDWACXDT    $DCXDT           Date of Origina
     C                     Z-ADDWAJZVA    $DJZVA           Order Value Tot
     C                     Z-ADDWAA1WG    $DA1WG           Order Weight To
     C                     MOVELWAXKST    $DXKST           New Customer Ho
     C                     MOVELWAE8CD    $DE8CD           Accounts Receiv
     C                     MOVELWAE9CD    $DE9CD           Accounts Receiv
     C                     Z-ADDWATBNB    $DTBNB           Absorbed Freigh
     C                     Z-ADDWAR1NB    $DR1NB           Rated Freight
     C                     MOVELWAPJST    $DPJST           LTL Flag
     C                     MOVELWAU0ST    $DU0ST           Price Audit
     C                     MOVELWAU1ST    $DU1ST           Price Status
     C                     MOVELWAU2ST    $DU2ST           Export Status
     C                     MOVELWARPCD    $DRPCD           Age Code
     C                     Z-ADDWARNNB    $DRNNB           Reefer Temperat
     C                     MOVELWAVDST    $DVDST           Load Type
     C                     Z-ADDWAATIN    $DATIN           Attach to Invoi
     C                     MOVELWAU4ST    $DU4ST           Load Plan Order
     C                     MOVELWAU5ST    $DU5ST           Print Pick Slip
     C                     Z-ADDWARSRN    $DRSRN           Resell Referenc
     C                     MOVELWAMHNA    $DMHNA           Special Comment
     C                     MOVELWAMINA    $DMINA           Special Comment
     C                     MOVELWAWBST    $DWBST           Affect Auto Acc
     C                     MOVELWAR4CD    $DR4CD           Sales Route Cod
     C                     Z-ADD*ZERO     $DBZC3           Load Company Nu
     C                     Z-ADDWAAFTM    $DAFTM           Requested Deliv
     C                     Z-ADD*ZERO     $DYBNB           Deadline Depart
     C                     Z-ADD*ZERO     $DT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     $DLRNX           Appointment Dat
     C                     Z-ADD*ZERO     $DLSNX           Appointment Tim
     C                     Z-ADD*ZERO     $DAXTM           Deadline Depart
     C                     MOVEL*BLANK    $DAJCD           Warehouse Code
     C                     MOVEL*BLANK    $DOANA           Port Delv Termi
     C                     MOVELWAB6NA    $DB6NA           Special Instruc
     C                     MOVELWABYNA    $DBYNA           Special Instruc
     C                     MOVELWABFCD    $DBFCD           Manager Level C
     C                     MOVELWAQ4CD    $DQ4CD           VP Level Code
     C                     Z-ADDWAT3NB    $DT3NB           Attach to Order
     C                     MOVELWASICD    $DSICD           Reason for Pric
     C                     Z-ADDWACONB    $DCONB           Invoice Number
     C                     MOVELWACEST    $DCEST           Invoice Suffix
     C                     Z-ADDWAAWDT    $DAWDT           Invoice Date
     C                     MOVELWAJPCD    $DJPCD           Event Code
     C                     MOVELWAXUST    $DXUST           Trans Contol AS
     C                     MOVELWAZ1ST    $DZ1ST           Modified Flag
     C                     Z-ADDWAVRVA    $DVRVA           A/R order Value
     C                     MOVELWAOBST    $DOBST           Billing Activit
     C                     MOVELWABCST    $DBCST           Block Order Fla
     C                     MOVELWABDST    $DBDST           Order Certifica
     C                     Z-ADDWAB7VL    $DB7VL           Invoice Order V
     C                     MOVELWAGASX    $DGASX           Process Sts for
     C                     MOVELWAGBSX    $DGBSX           Order Conf Fax
     C                     MOVELWAGCSX    $DGCSX           Manifest Fax St
     C                     MOVELWAGDSX    $DGDSX           Invoice Fax Sts
     C                     MOVELWAFNSX    $DFNSX           Transfer in Sto
     C                     MOVELWAFOSX    $DFOSX           Email Cust On O
     C                     MOVELWAFPSX    $DFPSX           Order Emailed
     C                     MOVELWAFQSX    $DFQSX           Export Docs Go
     C                     MOVELWAFRSX    $DFRSX           Shipping Temp C
     C                     MOVELWAFSSX    $DFSSX           Broker Order St
     C                     MOVELWAFTSX    $DFTSX           Air Freight Ord
     C                     MOVELWAFUSX    $DFUSX           Order Requires
     C                     MOVELWAFVSX    $DFVSX           OH Load Plan Re
     C                     MOVELWAFWSX    $DFWSX           Export USDA App
     C                     MOVELWAFXSX    $DFXSX           HPB Ship to War
     C                     MOVELWAFYSX    $DFYSX           OH TF Exempt Co
     C                     Z-ADDWANODT    $DNODT           OH Appt Confirm
     C                     Z-ADDWANPDT    $DNPDT           JPN Invoice Iss
     C                     Z-ADDWANQDT    $DNQDT           Load Actual Shi
     C                     Z-ADDWANRDT    $DNRDT           Load BOL Comple
     C                     Z-ADDWANSDT    $DNSDT           Load Truck Depa
     C                     Z-ADDWABPTM    $DBPTM           Maximum Gross W
     C                     Z-ADDWABQTM    $DBQTM           Time of Origina
     C                     Z-ADDWABRTM    $DBRTM           OH Appt Confirm
     C                     Z-ADDWABSTM    $DBSTM           Load BOL Comple
     C                     Z-ADDWABTTM    $DBTTM           Load Truck Depa
     C                     Z-ADDWAH0NX    $DH0NX           Act Frt Referen
     C                     Z-ADDWAH1NX    $DH1NX           Act Non-Ref Frt
     C                     Z-ADDWAH2NX    $DH2NX           OH Fuel Surchar
     C                     Z-ADDWAH3NX    $DH3NX           OH Total Non-Re
     C                     Z-ADDWAH4NX    $DH4NX           OH Total Ref Fr
     C                     Z-ADDWAC0C7    $DC0C7           Claim Number
     C                     MOVELWAUVST    $DUVST           EDI Status 1
     C                     MOVELWAUWST    $DUWST           EDI Status 2
     C                     MOVELWAUXST    $DUXST           EDI Status 3
     C                     Z-ADDWAAATM    $DAATM           Job Time
     C                     MOVELWAAYNA    $DAYNA           User Id
     C                     MOVELWAA0NA    $DA0NA           Job Name
     C                     Z-ADDWAAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Load Summ 1st Item PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAAIC3    WZB001           Company Number
     C                     Z-ADDWAAIC3    WZB001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BECPFK                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           WAAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Load Summ 1st Item PO: Mainline
      *================================================================
      * PRT Load Summ 1st Item PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQKC02           Order Number
      * Define keylist
     C           KPSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    WQKC01           Company Number
     C                     Z-ADD$DC4NB    WQKC02           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
      * Establish starting position
     C           KPSC      SETLL@BGWKAE                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $EAIC3           Company Number
     C                     Z-ADDWCC4NB    $EC4NB           Order Number
     C                     Z-ADDWCDPNB    $EDPNB           Order Sequence
     C                     Z-ADDWCUENB    $EUENB           Order Secondary
     C                     MOVELWCG7NA    $EG7NA           Order Desc. Lin
     C                     Z-ADDWCDUPR    $EDUPR           Invoice Unit Pr
     C                     Z-ADDWCB6VL    $EB6VL           Invoice Extende
     C                     Z-ADDWCA1AA    $EA1AA           Ham Group Numbe
     C                     MOVELWCFZSX    $EFZSX           OD Adj Type Ove
     C                     MOVELWCF0SX    $EF0SX           Affect Trade Fu
     C                     MOVELWCF1SX    $EF1SX           Affect Commissi
     C                     MOVELWCF2SX    $EF2SX           Affect Pricing
     C                     MOVELWCF3SX    $EF3SX           Released by Use
     C                     MOVELWCF4SX    $EF4SX           Ord TF Exempt C
     C                     MOVELWCF5SX    $EF5SX           OD Pallet Type
     C                     MOVELWCF6SX    $EF6SX           Production Ware
     C                     MOVELWCF7SX    $EF7SX           OD Price Type
     C                     Z-ADDWCNTDT    $ENTDT           Warehouse Palle
     C                     Z-ADDWCNUDT    $ENUDT           Consumed Item C
     C                     Z-ADDWCNVDT    $ENVDT           Deadline Depart
     C                     Z-ADDWCNWDT    $ENWDT           OD Price Type R
     C                     Z-ADDWCNXDT    $ENXDT           OD Unused Date
     C                     Z-ADDWCBUTM    $EBUTM           Deadline Depart
     C                     Z-ADDWCBVTM    $EBVTM           Price Code
     C                     Z-ADDWCBWTM    $EBWTM           Maximum Net Wei
     C                     Z-ADDWCBXTM    $EBXTM           Substitution Li
     C                     Z-ADDWCBYTM    $EBYTM           Max Qty to sche
     C                     Z-ADDWCH5NX    $EH5NX           Warehouse Palle
     C                     Z-ADDWCH6NX    $EH6NX           Warehouse Avg P
     C                     Z-ADDWCH7NX    $EH7NX           OD Item Target
     C                     Z-ADDWCH8NX    $EH8NX           OD Estimated Gr
     C                     Z-ADDWCH9NX    $EH9NX           OD Maximum Unit
     C                     Z-ADDWCDVPR    $EDVPR           Order Gate/Fina
     C                     Z-ADDWCDWPR    $EDWPR           OD Ceiling Pric
     C                     Z-ADDWCDXPR    $EDXPR           OD Gate/Final P
     C                     Z-ADDWCDYPR    $EDYPR           OD Weighted Avg
     C                     Z-ADDWCDZPR    $EDZPR           OD Unused Prc 5
     C                     Z-ADDWCGSPR    $EGSPR           OD Unused Prc 6
     C                     Z-ADDWCGTPR    $EGTPR           OD Unused Prc 7
     C                     Z-ADDWCGUPR    $EGUPR           OD Unused Prc 8
     C                     MOVELWCHOST    $EHOST           OD MPR Sent to
     C                     MOVELWCHPST    $EHPST           OD MPR Prc Read
     C                     MOVELWCIOST    $EIOST           OD UnUsed Price
     C                     Z-ADDWCPEWG    $EPEWG           Weight Amount E
     C                     Z-ADDWCRINY    $ERINY           Item Age Days
     C                     Z-ADDWCTIDT    $ETIDT           Production Ovr
     C                     Z-ADDWCTJDT    $ETJDT           Production Ovr
     C                     MOVELWCH2ST    $EH2ST           OD UnUsed Statu
     C                     MOVELWCH0ST    $EH0ST           OD Clm Full Ret
     C                     MOVELWCH1ST    $EH1ST           Order Line Erro
     C                     Z-ADDWCTKDT    $ETKDT           OD Market Begin
     C                     Z-ADDWCTLDT    $ETLDT           OD Market Endin
     C                     Z-ADDWCTMDT    $ETMDT           OD Atch to Ord
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZC001           Company Number
     C                     Z-ADDWCAIC3    WZC001
     C           *LIKE     DEFN WCC4NB    WZC002           Order Number
     C                     Z-ADDWCC4NB    WZC002
     C           *LIKE     DEFN WCDPNB    WZC003           Order Sequence
     C                     Z-ADDWCDPNB    WZC003
     C           *LIKE     DEFN WCUENB    WZC004           Order Secondary
     C                     Z-ADDWCUENB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@BGWKAE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: WRK.First Time Flag is NO
     C           WUTAST    IFEQ 'N'                        *IF
     C                     GOTO C3EXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WCC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WCDPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WCUENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Load Summ Exp Inst PO: Mainline
      *================================================================
      * PRT Load Summ Exp Inst PO: Initialise
     C                     EXSR ZDINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMAIC3    WQKD01           Company Number
     C           *LIKE     DEFN AMC4NB    WQKD02           Order Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
      * Setup key
     C                     Z-ADD$CAIC3    WQKD01           Company Number
     C                     Z-ADD$CC4NB    WQKD02           Order Number
      * Establish starting position
     C           KRSD      SETLL@AMREJF                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAMAIC3    $FAIC3           Company Number
     C                     Z-ADDAMC4NB    $FC4NB           Order Number
     C                     Z-ADDAMRMNB    $FRMNB           Load ID
     C                     Z-ADDAMRUNB    $FRUNB           Stop/Drop Seque
     C                     MOVELAMXACD    $FXACD           Shipping Line
     C                     MOVEL*BLANK    $FJNNA           USR Description
     C                     MOVELAMJ1T1    $FJ1T1           OHE Booking Num
     C                     Z-ADDAMQWDT    $FQWDT           OHE Sail/Flight
     C                     MOVELAMOANA    $FOANA           Port Delv Termi
     C                     MOVELAMHBAA    $FHBAA           OHE City
     C                     MOVELAMHCAA    $FHCAA           OHE Discharge P
     C                     Z-ADDAMQYDT    $FQYDT           OHE Arrival Dat
     C                     MOVELAMJ0T1    $FJ0T1           OHE Vessel/Airl
     C                     MOVELAMGENY    $FGENY           OHE Voyage/Flig
     C                     MOVELAMJ2T1    $FJ2T1           OHE Container N
     C                     Z-ADDAMQXDT    $FQXDT           OHE Port Cut Da
     C                     MOVELAMHDAA    $FHDAA           OHE Late Delive
     C                     MOVELAMCCTX    $FCCTX           OHE Ship Status
     C                     MOVELAMRLNA    $FRLNA           OHE Comment 1
     C                     MOVELAMRMNA    $FRMNA           OHE Comment 2
     C                     Z-ADDAMGINY    $FGINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    $FGFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    $FGGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    $FGHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    $FHEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    $FHFVL           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    $FHGVL           Transload Termi
     C                     Z-ADDAMQZDT    $FQZDT           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    $FQ0DT           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    $FQ1DT           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    $FQ2DT           OHE Actual Ship
     C                     MOVELAMC2TX    $FC2TX           OHE Carrier SCA
     C                     MOVELAMC3TX    $FC3TX           OHE Spot Buy
     C                     MOVELAMC6TX    $FC6TX           OHE PO ACK Flag
     C                     MOVELAMCHTX    $FCHTX           OHE Override Ty
     C                     MOVELAMCITX    $FCITX           OHE Backhaul St
     C                     MOVELAMCLTX    $FCLTX           OHE Backhaul ET
     C                     MOVELAMB4TX    $FB4TX           OHE Load Haul T
     C                     MOVELAMCUTX    $FCUTX           OHE Backhaul Ca
     C                     MOVELAMCVTX    $FCVTX           OHE Bookings Co
     C                     MOVELAMB9TX    $FB9TX           OHE EDI Error R
     C                     MOVELAMJWSC    $FJWSC           OHE EDI Error R
     C                     Z-ADDAMITNY    $FITNY           HPB COA Batch N
     C                     MOVELAMLMT1    $FLMT1           Delivery P.O. N
     C                     MOVELAMLWAA    $FLWAA           OHE Intended fo
     C                     MOVELAMFVST    $FFVST           OHE EDI 943 Act
     C                     MOVELAMF0ST    $FF0ST           OHE EDI 944 Act
     C                     MOVELAMF2ST    $FF2ST           OHE EDI 940 Act
     C                     MOVELAMF3ST    $FF3ST           OHE EDI 945 Act
     C                     MOVELAMJUSC    $FJUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    $FJVSC           OHE EDI 824 Act
     C                     MOVELAMV3T1    $FV3T1           OHE Transload S
     C                     MOVELAMV4T1    $FV4T1           OHE Abs Rate Ov
     C                     MOVELAMV5T1    $FV5T1           OHE Appt Confir
     C                     MOVELAMV6T1    $FV6T1           OHE Backhaul Co
     C                     MOVELAMV7T1    $FV7T1           OHE Backhaul Ch
     C                     MOVELAMV8T1    $FV8T1           OHE Transload C
     C                     MOVELAMV9T1    $FV9T1           OHE Pier Pass I
     C                     MOVELAMWAT1    $FWAT1           OHE Carrier Nm
     C                     MOVELAMWBT1    $FWBT1           OHE Appt Confir
     C                     MOVELAMWCT1    $FWCT1           OHE Backhaul Co
     C                     MOVELAMWDT1    $FWDT1           Letter of Credi
     C                     Z-ADDAMQJNY    $FQJNY           OHE Backhaul Re
     C                     Z-ADDAMQKNY    $FQKNY           LD Stop/Drop
     C                     Z-ADDAMQLNY    $FQLNY           OHE Unused Numb
     C                     Z-ADDAMP8NY    $FP8NY           OHE Pier Pass F
     C                     Z-ADDAMP9NY    $FP9NY           OHE Port Check
     C                     Z-ADDAMQANY    $FQANY           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    $FQCNY           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    $FQDNY           OHE Load Sched
     C                     Z-ADDAMQENY    $FQENY           Original Appoin
     C                     Z-ADDAMQFNY    $FQFNY           Original Appoin
     C                     Z-ADDAMQGNY    $FQGNY           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    $FQHNY           OHE PowerPro Lo
     C                     Z-ADDAMQINY    $FQINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    $FQMNY           OHE Orig ABS Fr
     C                     MOVELAMMYU1    $FMYU1           OHE Genset Numb
     C                     MOVELAMJXSC    $FJXSC           OHE Unused Stat
     C                     MOVELAMJYSC    $FJYSC           OHE Unused Stat
     C                     MOVELAMJZSC    $FJZSC           OHE Unused Stat
     C                     MOVELAMJ0SC    $FJ0SC           OHE Unused Stat
     C                     MOVELAMMZU1    $FMZU1           OHE Unused Text
     C                     MOVELAMM0U1    $FM0U1           OHE Unused Text
     C                     MOVELAMM1U1    $FM1U1           OHE Unused Text
     C                     MOVELAMM2U1    $FM2U1           OHE Unused Text
     C                     MOVELAMM3U1    $FM3U1           OHE Unused Text
     C                     Z-ADDAMW5DT    $FW5DT           OHE Unused Date
     C                     Z-ADDAMW6DT    $FW6DT           OHE Unused Date
     C                     MOVELAMUVST    $FUVST           EDI Status 1
     C                     MOVELAMUWST    $FUWST           EDI Status 2
     C                     MOVELAMUXST    $FUXST           EDI Status 3
     C                     MOVELAMVSST    $FVSST           Record Status
     C                     Z-ADDAMAATM    $FAATM           Job Time
     C                     MOVELAMAYNA    $FAYNA           User Id
     C                     MOVELAMA0NA    $FA0NA           Job Name
     C                     Z-ADDAMAXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AMAIC3    WZD001           Company Number
     C                     Z-ADDAMAIC3    WZD001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@AMREJF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Record Status is Deleted & Inactive
     C           AMVSST    IFEQ 'D'                        *IF
     C           AMVSST    OREQ 'I'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           AMAIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * PRT Print Traffic Cmts PO: Mainline
      *================================================================
      * PRT Print Traffic Cmts PO: Initialise
     C                     EXSR ZEINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQKE01           Load ID
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Load ID
      * Setup key
     C                     Z-ADD$HRMNB    WQKE01           Load ID
      * Establish starting position
     C           KRSE      SETLL@KECPGI                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $GO6TX           USR Carrier Upl
     C                     Z-ADDKERMNB    $GRMNB           Load ID
     C                     Z-ADDKEDXNB    $GDXNB           Sequence Number
     C                     MOVELKEGXTX    $GGXTX           Comment Line
     C                     MOVELKEUVST    $GUVST           EDI Status 1
     C                     MOVELKEUWST    $GUWST           EDI Status 2
     C                     MOVELKEUXST    $GUXST           EDI Status 3
     C                     MOVELKEVSST    $GVSST           Record Status
     C                     Z-ADDKEAATM    $GAATM           Job Time
     C                     MOVELKEAYNA    $GAYNA           User Id
     C                     MOVELKEA0NA    $GA0NA           Job Name
     C                     Z-ADDKEAXDT    $GAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: DB1.Job Name EQ WRK.Job Name
     C           KEA0NA    IFEQ WUA0NA                     *IF
     C                     MOVEL'*'       $GO6TX           USR Carrier Upl
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KERMNB    WZE001           Load ID
     C                     Z-ADDKERMNB    WZE001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@KECPGI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Load ID
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           KERMNB    IFNE WZE001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Load Summ By Carr  PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Load Summ By Carr  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Carrier Code of PRT Load Summ By Carr  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Load ID of PRT Load Summ By Carr  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Requested Delivery Date of PRT Load Summ By Carr  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of PRT Load Summ By Carr  PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'N'       WUB5SX           Print Yes/No
     C                     MOVEL'N'       W0PFM            *Print format
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Load Summary Dtl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Load Summary Dtl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Detail line. of PRT Load Summary Dtl   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RTV Total Qty & Weight RT - Order Detail  * 
     C                     EXSR SERVGN
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0001           Company Number
     C                     Z-ADD$DC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $DAJCD    P      Warehouse Code
      * Dont print special instructions if they are blank
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Special Instructions is Equal to Blank
      *   |- c2    : DB1.Special Instructions 2 is Equal to Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAB6NA    IFEQ *BLANK                     *IF
     C           WABYNA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0001           Comment Print S
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0001           Comment Print S
     C                     END                             *FI
      * RTV Stop Number       RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0006           Load ID
     C                     Z-ADD$DC4NB    WL0008           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    $DRVNB           Stop/Drop
     C                     Z-ADDWL0009    YL0001           Appointment Con
     C                     Z-ADDWL0010    YL0002           Appointment Con
      * appt conf date
      * CASE: LCL.Appointment Confirm Date is Entered
     C           YL0001    IFNE *ZERO                      *IF
      * CUR.Appointment Date MM/DD = LCL.Appointment Confirm Date
     C                     Z-ADDYL0001    $DLRNX           Appointment Dat
     C           YL0002    DIV  100       $DLSNX           Appointment Tim
     C                     ELSE
      * CASE: *OTHERWISE
      * CUR.Appointment Date MM/DD = DB1.Requested Delivery Date
     C                     Z-ADDWAEIDT    $DLRNX           Appointment Dat
     C                     Z-ADDWAAFTM    $DLSNX           Appointment Tim
     C                     END                             *FI
      * RTV Load Header fields RT - Load Header  * 
     C                     EXSR SHRVGN
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$DBZNA    WL0011    P      Carrier Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    $DNGST    P      Name
     C                     MOVELWL0013    WUVSST    P      Record Status
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUXCCD    WL0011    P      Carrier Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    $DFLG3    P      Name
     C                     MOVELWL0013    WUVSST    P      Record Status
      * RTV Deadln DepartDT/TM RT - Load Header  * 
     C                     EXSR SJRVGN
     C                     MOVELWABRTX    $DDMNA           USR Shortened n
      * RTV Telephone Number   RT - Customer  * 
     C                     EXSR SKRVGN
     C                     Z-ADDWUCCQT    $DR9NB           Order Quantity
     C                     ADD  $DCOWG    P5A1WG           Order Weight To
     C           $DAXTM    DIV  100       $DYBNB    H      Deadline Depart
     C                     MOVEL$DDXTX    $DS2TX           Trailer ID USR
      * ** Save export status to control print of constant    05/10/2007
     C                     MOVELWAU2ST    WUU2ST           Export Status
      * Check for Export - OMS228 - S. Schertz - 4/14/97
      * If Export replace address information with Sail Port information
      * CASE: DB1.Export Status is yes
     C           WAU2ST    IFEQ 'Y'                        *IF
      * ** Replace the load header export instr w/OHE export instr  05/04
      * RTV OHE Ship fields    RT - Order Header Extension  * 
     C                     EXSR SLRVGN
      * CASE: CUR.Port Delv Terminal is Entered
     C           $DOANA    IFNE *BLANK                     *IF
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
     C                     EXSR SMRVGN
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     MOVELWUSPPN    WUF6NA           Value Alpha 13
     C                     Z-ADD3         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00011
     C           ZQ        ORGT 00011
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUF6NA:ZQ WUNZCD    P  90  USR Reason Code
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD3         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00011
     C           ZQ        ORGT 00011
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUF6NA:ZQ WUEZTX    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD8         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00011
     C           ZQ        ORGT 00011
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUF6NA:ZQ WUN5CD    P  90  USR To Format
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNZCD    CAT  '-':ZQ    WUJUTX    P      CMS Contact Pho
     C                     Z-ADD*ZERO     ZQ      50
     C           WUEZTX    CAT  '-':ZQ    WUJWTX    P      CMS Primary SIC
     C                     Z-ADD*ZERO     ZQ      50
     C           WUJUTX    CAT  WUJWTX:ZQ WUN7NA    P      @Alpha 8
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN7NA    CAT  WUN5CD:ZQ WULETX    P      @Alpha 12
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     MOVELWULETX    $DBVTX           Telephone Numbe
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $DAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$DAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VDAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $DEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDEIDT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $DAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAODT
      * Convert Load Company Number Usr to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $DBZC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$DBZC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VDBZC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBZC3           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUU2ST    IFEQ *BLANK                     *IF
     C           WUU2ST    OREQ 'N'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Load Summ 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT Load Summ 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of PRT Load Summ 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Load Summ 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Load Summ 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of PRT Load Summ 1st Item PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT Load Summ Exp Inst PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of PRT Load Summ Exp Inst PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Detail line. of PRT Load Summ Exp Inst PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$FXACD    WL0011    P      Carrier Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    $FJNNA    P      Name
     C                     MOVELWL0013    YN0001    P      Record Status
      * CUR = DB1 By name
     C                     Z-ADDAMAIC3    $FAIC3           Company Number
     C                     Z-ADDAMC4NB    $FC4NB           Order Number
     C                     Z-ADDAMRMNB    $FRMNB           Load ID
     C                     Z-ADDAMRUNB    $FRUNB           Stop/Drop Seque
     C                     MOVELAMXACD    $FXACD           Shipping Line
     C                     MOVELAMJ1T1    $FJ1T1           OHE Booking Num
     C                     Z-ADDAMQWDT    $FQWDT           OHE Sail/Flight
     C                     MOVELAMOANA    $FOANA           Port Delv Termi
     C                     MOVELAMHBAA    $FHBAA           OHE City
     C                     MOVELAMHCAA    $FHCAA           OHE Discharge P
     C                     Z-ADDAMQYDT    $FQYDT           OHE Arrival Dat
     C                     MOVELAMJ0T1    $FJ0T1           OHE Vessel/Airl
     C                     MOVELAMGENY    $FGENY           OHE Voyage/Flig
     C                     MOVELAMJ2T1    $FJ2T1           OHE Container N
     C                     Z-ADDAMQXDT    $FQXDT           OHE Port Cut Da
     C                     MOVELAMHDAA    $FHDAA           OHE Late Delive
     C                     MOVELAMCCTX    $FCCTX           OHE Ship Status
     C                     MOVELAMRLNA    $FRLNA           OHE Comment 1
     C                     MOVELAMRMNA    $FRMNA           OHE Comment 2
     C                     Z-ADDAMGINY    $FGINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    $FGFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    $FGGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    $FGHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    $FHEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    $FHFVL           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    $FHGVL           Transload Termi
     C                     Z-ADDAMQZDT    $FQZDT           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    $FQ0DT           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    $FQ1DT           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    $FQ2DT           OHE Actual Ship
     C                     MOVELAMC2TX    $FC2TX           OHE Carrier SCA
     C                     MOVELAMC3TX    $FC3TX           OHE Spot Buy
     C                     MOVELAMC6TX    $FC6TX           OHE PO ACK Flag
     C                     MOVELAMCHTX    $FCHTX           OHE Override Ty
     C                     MOVELAMCITX    $FCITX           OHE Backhaul St
     C                     MOVELAMCLTX    $FCLTX           OHE Backhaul ET
     C                     MOVELAMB4TX    $FB4TX           OHE Load Haul T
     C                     MOVELAMCUTX    $FCUTX           OHE Backhaul Ca
     C                     MOVELAMCVTX    $FCVTX           OHE Bookings Co
     C                     MOVELAMB9TX    $FB9TX           OHE EDI Error R
     C                     MOVELAMJWSC    $FJWSC           OHE EDI Error R
     C                     Z-ADDAMITNY    $FITNY           HPB COA Batch N
     C                     MOVELAMLMT1    $FLMT1           Delivery P.O. N
     C                     MOVELAMLWAA    $FLWAA           OHE Intended fo
     C                     MOVELAMFVST    $FFVST           OHE EDI 943 Act
     C                     MOVELAMF0ST    $FF0ST           OHE EDI 944 Act
     C                     MOVELAMF2ST    $FF2ST           OHE EDI 940 Act
     C                     MOVELAMF3ST    $FF3ST           OHE EDI 945 Act
     C                     MOVELAMJUSC    $FJUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    $FJVSC           OHE EDI 824 Act
     C                     MOVELAMV3T1    $FV3T1           OHE Transload S
     C                     MOVELAMV4T1    $FV4T1           OHE Abs Rate Ov
     C                     MOVELAMV5T1    $FV5T1           OHE Appt Confir
     C                     MOVELAMV6T1    $FV6T1           OHE Backhaul Co
     C                     MOVELAMV7T1    $FV7T1           OHE Backhaul Ch
     C                     MOVELAMV8T1    $FV8T1           OHE Transload C
     C                     MOVELAMV9T1    $FV9T1           OHE Pier Pass I
     C                     MOVELAMWAT1    $FWAT1           OHE Carrier Nm
     C                     MOVELAMWBT1    $FWBT1           OHE Appt Confir
     C                     MOVELAMWCT1    $FWCT1           OHE Backhaul Co
     C                     MOVELAMWDT1    $FWDT1           Letter of Credi
     C                     Z-ADDAMQJNY    $FQJNY           OHE Backhaul Re
     C                     Z-ADDAMQKNY    $FQKNY           LD Stop/Drop
     C                     Z-ADDAMQLNY    $FQLNY           OHE Unused Numb
     C                     Z-ADDAMP8NY    $FP8NY           OHE Pier Pass F
     C                     Z-ADDAMP9NY    $FP9NY           OHE Port Check
     C                     Z-ADDAMQANY    $FQANY           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    $FQCNY           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    $FQDNY           OHE Load Sched
     C                     Z-ADDAMQENY    $FQENY           Original Appoin
     C                     Z-ADDAMQFNY    $FQFNY           Original Appoin
     C                     Z-ADDAMQGNY    $FQGNY           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    $FQHNY           OHE PowerPro Lo
     C                     Z-ADDAMQINY    $FQINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    $FQMNY           OHE Orig ABS Fr
     C                     MOVELAMMYU1    $FMYU1           OHE Genset Numb
     C                     MOVELAMJXSC    $FJXSC           OHE Unused Stat
     C                     MOVELAMJYSC    $FJYSC           OHE Unused Stat
     C                     MOVELAMJZSC    $FJZSC           OHE Unused Stat
     C                     MOVELAMJ0SC    $FJ0SC           OHE Unused Stat
     C                     MOVELAMMZU1    $FMZU1           OHE Unused Text
     C                     MOVELAMM0U1    $FM0U1           OHE Unused Text
     C                     MOVELAMM1U1    $FM1U1           OHE Unused Text
     C                     MOVELAMM2U1    $FM2U1           OHE Unused Text
     C                     MOVELAMM3U1    $FM3U1           OHE Unused Text
     C                     Z-ADDAMW5DT    $FW5DT           OHE Unused Date
     C                     Z-ADDAMW6DT    $FW6DT           OHE Unused Date
     C                     MOVELAMUVST    $FUVST           EDI Status 1
     C                     MOVELAMUWST    $FUWST           EDI Status 2
     C                     MOVELAMUXST    $FUXST           EDI Status 3
     C                     MOVELAMVSST    $FVSST           Record Status
     C                     Z-ADDAMAATM    $FAATM           Job Time
     C                     MOVELAMAYNA    $FAYNA           User Id
     C                     MOVELAMA0NA    $FA0NA           Job Name
     C                     Z-ADDAMAXDT    $FAXDT           Job Date
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OHE Sail/Flight Date to display format
      * Convert date
     C           1000000   ADD  $FQWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFQWDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  $FQYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFQYDT
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of PRT Print Traffic Cmts PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Load ID of PRT Print Traffic Cmts PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Detail line. of PRT Print Traffic Cmts PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Load Summ By Carr  PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Carrier Code of PRT Load Summ By Carr  PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Load Summ By Carr  PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Requested Delivery Date of PRT Load Summ By Carr  PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Summ By Carr  PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Summary Dtl   PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Load Summary Dtl   PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Summary Dtl   PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD5         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Summ 1st Item PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Load Summ 1st Item PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Load Summ 1st Item PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Load Summ 1st Item PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Load Summ 1st Item PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Summ 1st Item PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Summ Exp Inst PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Load Summ Exp Inst PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Summ Exp Inst PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD5         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Print Traffic Cmts PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Print Traffic Cmts PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Print Traffic Cmts PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP1BDDT    $BBDDT           USR From Date
     C                     Z-ADDP2FDDT    $BFDDT           USR To Date
     C                     Z-ADDP3FTDT    $BFTDT           Prm From Date
     C                     Z-ADDP4FUDT    $BFUDT           Prm To Date
     C                     Z-ADDP9L9DT    $BL9DT           From Date
     C                     Z-ADDP9OADT    $BOADT           Thru Date
     C                     Z-ADDP5AIC3    $BAIC3           Company Number
     C                     Z-ADDP5RMNB    $BRMNB           Load ID
     C                     MOVELP6R6CD    $BR6CD           USR Carrier Cod
     C                     MOVELP8WNST    $BWNST           USR Load Type
     C                     MOVELP5Q2CD    $BQ2CD           Shipping Method
     C                     MOVELP9CPCD    $BCPCD           USR Warehouse C
     C                     MOVELP9VSCD    $BVSCD           USR CDE Parm 1
     C                     MOVELP9VTCD    $BVTCD           USR CDE Parm 2
     C                     MOVELP9VUCD    $BVUCD           USR CDE Parm 3
     C                     MOVELP9VVCD    $BVVCD           USR CDE Parm 4
     C                     MOVELP9VWCD    $BVWCD           USR CDE Parm 5
     C                     MOVELP9VXCD    $BVXCD           USR CDE Parm 6
     C                     MOVELP9VYCD    $BVYCD           USR CDE Parm 7
     C                     MOVELP9VZCD    $BVZCD           USR CDE Parm 8
     C                     MOVELP9V0CD    $BV0CD           USR CDE Parm 9
      * CASE: PAR.Company Number is greater than zero
     C           P5AIC3    IFGT *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BAPTX           Company Name
     C                     MOVEL'*ALL'    $BAPTX           Company Name
     C                     END                             *FI
      * RTV Name, Status       RT - Carrier  * 
     C                     EXSR SDRVGN
      * TOP.USR Desc. 10 = Condition name of PAR.USR Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1271280   Y2LSNO  70       List number
     C                     PARM P8WNST    W0INVL 25        USR Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
      * Shipping method description
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           P5Q2CD    IFEQ WUGSTX                     *IF
     C                     MOVEL*BLANK    $BHLTX           Condition Desc.
     C                     MOVEL'*ALL'    $BHLTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * TOP.Condition Desc. 1  USR = Condition name of PAR.Shipping Metho
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM P5Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * Move warehouses to print fields
      * CASE:
      *  - c1ANDc2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9CPCD    IFEQ *BLANK                     *IF
     C           P9VSCD    IFEQ *BLANK                     *IF
     C           P9VTCD    IFEQ *BLANK                     *IF
     C           P9VUCD    IFEQ *BLANK                     *IF
     C           P9VVCD    IFEQ *BLANK                     *IF
     C           P9VWCD    IFEQ *BLANK                     *IF
     C           P9VXCD    IFEQ *BLANK                     *IF
     C           P9VYCD    IFEQ *BLANK                     *IF
     C           P9VZCD    IFEQ *BLANK                     *IF
     C           P9V0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ALL'     $BCPCD           USR Warehouse C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP9CPCD    $BCPCD           USR Warehouse C
     C                     END                             *FI
      * TOP.USR Description - 15 = Condition name of PAR.USR Select/Omit
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1377659   Y2LSNO  70       List number
     C                     PARM P9CYST    W0INVL 25        USR Select/Omit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BJUNA    PARM           W0CNNM 25        USR Description
      *
      * Convert fields to external form
      * Convert USR From Date to display format
      * Convert date
     C           1000000   ADD  $BBDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBBDDT
      * Convert USR To Date to display format
      * Convert date
     C           1000000   ADD  $BFDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFDDT
      * Convert Prm From Date to display format
      * Convert date
     C           1000000   ADD  $BFTDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFTDT
      * Convert Prm To Date to display format
      * Convert date
     C           1000000   ADD  $BFUDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFUDT
      * Convert From Date             USR to display format
      * Convert date
     C           1000000   ADD  $BL9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBL9DT
      * Convert Thru Date             USR to display format
      * Convert date
     C           1000000   ADD  $BOADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBOADT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUB5SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAPTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELP6R6CD    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSD     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BKMNA           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $BKMNA           Name
     C                     MOVELFFVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Total Qty & Weight RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  91       USR Weight   9.
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCCQT           Quantity Schedu
     C                     Z-ADD0         WUAUWG           Weight Schedule
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSE01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSE01           Company Number
     C                     Z-ADD$DC4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
     C                     ADD  OMCCQT    WUCCQT           Quantity Schedu
     C                     ADD  OMAUWG    WUAUWG           Weight Schedule
     C                     ADD  OMATWG    WUATWG           Weight Shipped
     C                     ADD  OMA4WG    WUA4WG           Tare Weight Tot
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
     C           WUCCQT    MULT 1         WUBVNB    H      USR Quantity, 9
     C           WUAUWG    MULT 1         $DCOWG    H      USR Weight   9.
     C           WUATWG    MULT 1         WN0007    H      USR Weight   9.
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSF01           Company Number
     C                     Z-ADDWL0002    WQSF02           Order Number
     C                     Z-ADDWL0003    OMDPNB           Order Sequence
     C                     Z-ADDWL0004    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Warehouse Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0005           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Stop Number       RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0007           Stop/Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSG01           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Load ID
      * Setup key
     C                     Z-ADDWL0006    WQSG01           Load ID
      * Establish starting position
     C           KRSSG     SETLL@FLCPBW                    *
     C           KRSSG     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0007           Stop/Drop
     C                     Z-ADD*ZERO     WL0009           Appointment Con
     C                     Z-ADD*ZERO     WL0010           Appointment Con
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order number is found, retrieve stop number
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           WL0008    IFEQ FLC4NB                     *IF
     C                     Z-ADDFLRVNB    WL0007           Stop/Drop
      * PAR = DB1 By name
     C                     Z-ADDFLRVNB    WL0007           Stop/Drop
     C                     Z-ADDFLKFDT    WL0009           Appointment Con
     C                     Z-ADDFLACTM    WL0010           Appointment Con
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Load Header fields RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    $DBZC3           Company Number
     C                     Z-ADDFJAODT    WUAODT           Scheduled Ship
     C                     MOVELFJPJST    WUPJST           LTL Flag
     C                     MOVELFJPKST    $DPKST           Load Status
     C                     Z-ADDFJRNNB    WURNNB           Reefer Temperat
     C                     Z-ADDFJRPNB    WURPNB           Total Load Orde
     C                     Z-ADDFJRRNB    WURRNB           Total Stops
     C                     MOVELFJDXTX    $DDXTX           Trailer Id
     C                     MOVELFJBZNA    $DBZNA           Carrier Code
     C                     MOVELFJRONB    WURONB           Truck Size
     C                     Z-ADDFJSQNB    WUSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    WUR1NB           Rated Freight
     C                     MOVELFJVCST    WUVCST           Ship Status
     C                     MOVELFJVDST    WUVDST           Load Type
     C                     Z-ADDFJT4NB    $DT4NB           Schedule Sequen
     C                     MOVELFJXCCD    WUXCCD           Carrier Broker
     C                     MOVELFJONTM    $DONTM           On Time - (Y/N)
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0011    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSI     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0012           Name
     C                     MOVEL*BLANK    WL0013           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0012           Name
     C                     MOVELFFVSST    WL0013           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSJ02           Load ID
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ02           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    WQSJ02           Load ID
      * Establish starting position
     C           KRSSJ     SETLL@FJCPSB                    *
     C           KRSSJ     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DYANB           Deadline Depart
     C                     Z-ADD*ZERO     $DAXTM           Deadline Depart
     C                     GOTO SJEXIT                     *QUIT
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBKZDT    $DYANB           Deadline Depart
     C                     Z-ADDWBAXTM    $DAXTM           Deadline Depart
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Telephone Number   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    $DBVTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    AMAIC3           Company Number
     C                     Z-ADD$DC4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0003           Shipping Line
     C                     MOVEL*BLANK    $DOANA           Port Delv Termi
     C                     MOVEL*BLANK    YL0003           OHE City
     C                     MOVEL*BLANK    YL0004           OHE Vessel/Airl
     C                     MOVEL*BLANK    YL0005           OHE Voyage/Flig
     C                     MOVEL*BLANK    YL0006           OHE Booking Num
     C                     MOVEL*BLANK    YL0007           OHE Discharge P
     C                     Z-ADD*ZERO     YL0008           OHE Sail/Flight
     C                     Z-ADD*ZERO     YL0009           OHE Port Cut Da
     C                     Z-ADD*ZERO     YL0010           OHE Arrival Dat
     C                     MOVEL*BLANK    YL0011           OHE Late Delive
     C                     MOVEL*BLANK    YL0012           OHE Ship Status
     C                     MOVEL*BLANK    YL0013           OHE Container N
     C                     MOVEL*BLANK    YL0014           OHE Comment 1
     C                     MOVEL*BLANK    YL0015           OHE Comment 2
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMXACD    WN0003           Shipping Line
     C                     MOVELAMOANA    $DOANA           Port Delv Termi
     C                     MOVELAMHBAA    YL0003           OHE City
     C                     MOVELAMJ0T1    YL0004           OHE Vessel/Airl
     C                     MOVELAMGENY    YL0005           OHE Voyage/Flig
     C                     MOVELAMJ1T1    YL0006           OHE Booking Num
     C                     MOVELAMHCAA    YL0007           OHE Discharge P
     C                     Z-ADDAMQWDT    YL0008           OHE Sail/Flight
     C                     Z-ADDAMQXDT    YL0009           OHE Port Cut Da
     C                     Z-ADDAMQYDT    YL0010           OHE Arrival Dat
     C                     MOVELAMHDAA    YL0011           OHE Late Delive
     C                     MOVELAMCCTX    YL0012           OHE Ship Status
     C                     MOVELAMJ2T1    YL0013           OHE Container N
     C                     MOVELAMRLNA    YL0014           OHE Comment 1
     C                     MOVELAMRMNA    YL0015           OHE Comment 2
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           LCXACD           Shipping Line
     C                     KFLD           LCOANA           Port Delv Termi
      * Setup key
     C                     MOVELWN0003    LCXACD           Shipping Line
     C                     MOVEL$DOANA    LCOANA           Port Delv Termi
      * Establish starting position
     C           KRSSM     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DHNNA           Port City
     C                     MOVEL*BLANK    WULBTX           Port Address Li
     C                     MOVEL*BLANK    WULATX           Port Address Li
     C                     MOVEL*BLANK    $DDBCD           Sail Port State
     C                     MOVEL*BLANK    WULCTX           Port Zip/Postal
     C                     Z-ADD*ZERO     WUSPPN           Port Phone Numb
     C                     MOVEL*BLANK    WULDTX           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLCOKTX    $DHNNA           Port City
     C                     MOVELLCLBTX    WULBTX           Port Address Li
     C                     MOVELLCLATX    WULATX           Port Address Li
     C                     MOVELLCXBCD    $DDBCD           Sail Port State
     C                     MOVELLCLCTX    WULCTX           Port Zip/Postal
     C                     Z-ADDLCSPPN    WUSPPN           Port Phone Numb
     C                     MOVELLCLDTX    WULDTX           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Check Warehouse    RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSN01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSN02           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADDWL0014    WQSN01           Company Number
     C                     Z-ADDWL0015    WQSN02           Order Number
      * Establish starting position
     C           KRSSN     SETLL@BGWKL1                    *
     C           KRSSN     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.Warehouse Code
     C           OMAJCD    IFEQ WL0016                     *IF
     C                     MOVEL'Y'       WL0017           Select Status
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Wgt Shipped Tot    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSO02           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO02           Load ID
      * Setup key
     C                     Z-ADD$HRMNB    WQSO02           Load ID
      * Establish starting position
     C           KRSSO     SETLL@BFCPD9                    *
     C           KRSSO     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WUH8WG           USR Weight   9.
      * RTV Weight Shipped Tot RT - PD Order Detail  * 
     C                     EXSR SPRVGN
     C                     Z-ADD0         WUH9WG           USR Weight   9.
      * CASE: WRK.USR Weight   9.1  3 EQ WRK.USR Weight   9.1  4
     C           WUH8WG    IFEQ WUH9WG                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WUH8WG    $HH8WG           USR Weight   9.
     C                     END                             *FI
     C           KRSSO     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Weight Shipped Tot RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUH8WG           USR Weight   9.
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSP01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSP02           Order Number
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSP01           Company Number
     C                     Z-ADDWDC4NB    WQSP02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  OMATWG    WUH8WG           USR Weight   9.
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * CLC Misc Tare Wgt Tot  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADD$HRMNB    WQSQ02           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@BFCPD9                    *
     C           KRSSQ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WUH9WG           USR Weight   9.
      * CLC Misc Tare Wgt Tot  RT - PD Order Detail  * 
     C                     EXSR SRRVGN
     C                     Z-ADD0         WUIAWG           USR Weight   9.
      * CASE: WRK.USR Weight   9.1  4 EQ WRK.USR Weight   9.1  5
     C           WUH9WG    IFEQ WUIAWG                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WUH9WG    $HH9WG           USR Weight   9.
     C                     END                             *FI
     C           KRSSQ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * CLC Misc Tare Wgt Tot  RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  52       Misc Tare Weigh
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSR01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSR02           Order Number
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSR01           Company Number
     C                     Z-ADDWDC4NB    WQSR02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSR     SETLL@BGWKL1                    *
     C           KRSSR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Tare Weight        RT - Company/Item  * 
     C                     EXSR SSRVGN
     C                     Z-ADD0         WUA3WG           Misc Tare Weigh
      * CASE: PAR.Misc Tare Weight EQ WRK.Misc Tare Weight
     C           WN0008    IFEQ WUA3WG                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           OMCBQT    MULT WN0008    WUH9WG    H      USR Weight   9.
     C                     END                             *FI
     C           KRSSR     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUG0TX           Description Lin
     C                     Z-ADDBZA3WG    WN0008           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * CLC Pakg Tare Wgt Tot  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQST02           Load ID
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST02           Load ID
      * Setup key
     C                     Z-ADD$HRMNB    WQST02           Load ID
      * Establish starting position
     C           KRSST     SETLL@BFCPD9                    *
     C           KRSST     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WUIAWG           USR Weight   9.
      * CLC Pakg Tare Wgt Tot  RT - PD Order Detail  * 
     C                     EXSR SURVGN
     C                     Z-ADD0         WUIBWG           USR Weight   9.
      * CASE: WRK.USR Weight   9.1  5 EQ WRK.USR Weight   9.1  6
     C           WUIAWG    IFEQ WUIBWG                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WUIAWG    $HIAWG           USR Weight   9.
     C                     END                             *FI
     C           KRSST     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * CLC Pakg Tare Wgt Tot  RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0009 112       Unit Weight
     C                     Z-ADD*ZERO     WN0010  70       Component Item
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSU01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSU02           Order Number
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSU01           Company Number
     C                     Z-ADDWDC4NB    WQSU02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSU     SETLL@BGWKL1                    *
     C           KRSSU     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Supply Code        RT - PD Item Bill Of Material  * 
     C                     EXSR SVRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WUC9NB           Component Item
      * CASE: PAR.Component Item Code EQ WRK.Component Item Code
     C           WN0010    IFEQ WUC9NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Pakg Tare Wgt Tot  RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0018           Company Number
     C                     Z-ADDWN0010    WL0019           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WN0009           Unit Weight
     C                     Z-ADD0         WUAIWG           Unit Weight
      * CASE: PAR.Unit Weight EQ WRK.Unit Weight
     C           WN0009    IFEQ WUAIWG                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           OMCBQT    MULT WN0009    WUIBWG    H      USR Weight   9.
     C                     ADD  WUIBWG    WUIAWG           USR Weight   9.
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSU     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Supply Code        RT - PD Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSV01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSV02           Item Code
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Item Code
      * Setup key
     C                     Z-ADDOMAIC3    WQSV01           Company Number
     C                     Z-ADDOMHGCD    WQSV02           Item Code
      * Establish starting position
     C           KRSSV     SETLL@IORETI                    *
     C           KRSSV     READE@IORETI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT                     *QUIT
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOM Type is Supplies
     C           IOV2ST    IFEQ 'S'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDIOC9NB    WN0010           Component Item
     C                     END                             *FI
     C           KRSSV     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Pakg Tare Wgt Tot  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0018    BZAIC3           Company Number
     C                     Z-ADDWL0019    BZHGCD           Item Code
      * Establish starting position
     C           KRSSW     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WL0020           Unit Weight
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Summary Dtl   PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Comment Print S
     C                     MOVEL*BLANK    WN0002  1        Export Status
     C                     MOVEL*BLANK    WN0003  3        Shipping Line
     C                     MOVEL*BLANK    WN0004 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0005  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0006  60       Deadline Depart
      *
      * PRT Load Summary Dtl   PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Summ 1st Item PO
      *================================================================
      * CASE: DB1.Load Type is Regular
     C           WAVDST    IFEQ 'R'                        *IF
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      * PRT Load Summ 1st Item PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Summ Exp Inst PO
      *================================================================
      * ** Only print export instructions if it is an export order
      * CASE: DB1.Export Status is Not Yes
     C           BEU2ST    IFEQ *BLANK                     *IF
     C           BEU2ST    OREQ 'N'
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
      * PRT Load Summ Exp Inst PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Print Comments     PO
      *================================================================
      * PRT Print Traffic Cmts PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Load Summary Dtl   PO: Initialise
      *================================================================
      * USER: Initialize program
      * ** 05/24/2016 RMC E4119 remove Live with TPM Checks
      * 06/10/2008 LJB Change to print for export and for non-export
      * 04/15/2004 slm Multi-company Order Header
      *               Added company to the order line remove co break
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * PRT Load Summ 1st Item PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUTAST           First Time Flag
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZDINIT    BEGSR
      *================================================================
      * PRT Load Summ Exp Inst PO: Initialise
      *================================================================
      * USER: Initialize program
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZEINIT    BEGSR
      *================================================================
      * PRT Print Traffic Cmts PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL@CN,001   WUA0NA           Job Name
      *================================================================
     CSR         ZEEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5C4NB           Order Number
     C                     Z-ADD*ZERO     P5A1WG           Order Weight To
     C                     MOVEL*BLANK    P5U2ST           Export Status
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Print Yes/No          USR
     C                     MOVEL*BLANK    WUB5SX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEBZNA           Carrier Code
     C                     MOVEL*LOVAL    BERMNB           Load ID
     C                     MOVEL*LOVAL    BEEIDT           Requested Deliv
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAAIC3           Company Number
     C                     MOVEL*LOVAL    WAC4NB           Order Number
      * Define work field USR Quantity, 9.0
     C                     Z-ADD*ZERO     WUBVNB  90
      * Define work field Quantity Scheduled
     C                     Z-ADD*ZERO     WUCCQT 112
      * Define work field Weight Scheduled
     C                     Z-ADD*ZERO     WUAUWG 112
      * Define work field Weight Shipped Total
     C                     Z-ADD*ZERO     WUATWG 112
      * Define work field Tare Weight Total
     C                     Z-ADD*ZERO     WUA4WG 112
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field LTL Flag
     C                     MOVEL*BLANK    WUPJST  1
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Stops
     C                     Z-ADD*ZERO     WURRNB  50
      * Define work field Truck Size
     C                     MOVEL*BLANK    WURONB  7
      * Define work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     WUSQNB  70
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Ship Status
     C                     MOVEL*BLANK    WUVCST  1
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Export Status
     C                     MOVEL*BLANK    WUU2ST  1
      * Define work field Port Address Line 1
     C                     MOVEL*BLANK    WULBTX 25
      * Define work field Port Address Line 2
     C                     MOVEL*BLANK    WULATX 25
      * Define work field Port Zip/Postal Code
     C                     MOVEL*BLANK    WULCTX 11
      * Define work field Port Phone Number
     C                     Z-ADD*ZERO     WUSPPN 110
      * Define work field Port Fax Number
     C                     MOVEL*BLANK    WULDTX 25
      * Define work field Value Alpha 13  (11)
     C                     MOVEL*BLANK    WUF6NA 11
      * Define work field USR Reason Code 3
     C                     MOVEL*BLANK    WUNZCD  3
      * Define work field USR Work Field 3A
     C                     MOVEL*BLANK    WUEZTX  3
      * Define work field USR To Format
     C                     MOVEL*BLANK    WUN5CD  4
      * Define work field CMS Contact Phone ext
     C                     MOVEL*BLANK    WUJUTX  4
      * Define work field CMS Primary SIC
     C                     MOVEL*BLANK    WUJWTX  4
      * Define work field @Alpha 8
     C                     MOVEL*BLANK    WUN7NA  8
      * Define work field @Alpha 12
     C                     MOVEL*BLANK    WULETX 12
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WCGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCC4NB           Order Number
     C                     MOVEL*LOVAL    WCDPNB           Order Sequence
     C                     MOVEL*LOVAL    WCUENB           Order Secondary
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AMAIC3           Company Number
     C                     MOVEL*LOVAL    AMC4NB           Order Number
      * Define work field Select Status
     C                     MOVEL*BLANK    WUDJST  1
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Job Name
     C                     MOVEL*BLANK    WUA0NA 10
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KERMNB           Load ID
     C                     MOVEL*LOVAL    KEDXNB           Sequence Number
      * Define work field Item Description Text
     C                     MOVEL*BLANK    WUBDTX 50
      * Define work field USR Weight   9.1  3
     C                     Z-ADD*ZERO     WUH8WG  91
      * Define work field USR Weight   9.1  4
     C                     Z-ADD*ZERO     WUH9WG  91
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Define work field USR Weight   9.1  5
     C                     Z-ADD*ZERO     WUIAWG  91
      * Define work field Component Item Code
     C                     Z-ADD*ZERO     WUC9NB  70
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field USR Weight   9.1  6
     C                     Z-ADD*ZERO     WUIBWG  91
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  3
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  50
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  60
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012 30
     C                     MOVEL*BLANK    WL0013  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  3
     C                     MOVEL*BLANK    WL0017  1
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020 112
      * Define local work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field OHE City
     C                     MOVEL*BLANK    YL0003 25
      * Define local work field OHE Vessel/Airline
     C                     MOVEL*BLANK    YL0004 30
      * Define local work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YL0005 15
      * Define local work field OHE Booking Number
     C                     MOVEL*BLANK    YL0006 15
      * Define local work field OHE Discharge Port/Airprt
     C                     MOVEL*BLANK    YL0007 20
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0011  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0013 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0014 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0015 75
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Stop/Drop
     C                     Z-ADD*ZERO     YN0002  50
      * Define local work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YL0017  60
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * When changing the print object be aware that there are 2 to chang
      * Load Summary and Load Summary by Carrier
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 CARRIERUPL
00002 ***  PK0111
00003 Y2U0005
