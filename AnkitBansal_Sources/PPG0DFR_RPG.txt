     H/TITLE WW Customer Credit     DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 03/04/25  Time  : 16:27:09
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPPG0DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Customer Credit     DF Display file
      *
     FCABBRELDIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Customer Master           RSQ By Name, Ship #
      *
     FPOAVCPL2IF  E           K        DISK
      * RSQ : Customer Comment          Cust/Type/Seq(D)
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOPBFCPLZIF  E           K        DISK
      * RSQ : Order Header TRG          Cust/Co/Order-not C or X
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCABBREL0UF  E           K        DISK
      * UPD : Customer Master           Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    AR1        30  1               ARRAY 2
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  09  6   @CN    25
     I@BBREE8
      * Customer Master           Update index
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      * Outward parameters
     IPARC        DS                            344
      * RCD : Company Customer          Retrieval index
      * B :  Company Number
     I                                    P   1   20PAAIC3
      * B :  Ship To Customer
     I                                    P   3   60PABKC7
      *
      * Outward parameters
     IPBRC        DS                            168
      * RCD : Security Parameter List
      * N :  Allow Multi_Company
     I                                       44  44 PBI6ST
      *
      * Outward parameters
     IPCRC        DS                            344
      * RCD : Company Customer          Retrieval index
      * B :  Company Number
     I                                    P   1   20PCAIC3
      * B :  Ship To Customer
     I                                    P   3   60PCBKC7
      *
      * Outward parameters
     IPDRC        DS                            168
      * RCD : Security Parameter List
      * N :  Allow Multi_Company
     I                                       44  44 PDI6ST
      *
      * Outward parameters
     IPERC        DS                              9
      * KEY : Customer Comment          Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PEBKC7
      * I : MAP Comment Type
     I                                        5   6 PEI1SX
      *
      * Outward parameters
     IPFRC        DS                              8
      * KEY : Customer Item Reference   Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PFBKC7
      *
      * Outward parameters
     IPGRC        DS                              4
      * KEY : Customer Master           Retrieval index       NV
      * I : RST Ship To Customer
     I                                    P   1   40PGBKC7
      *
     IQCABB1    E DSCABBREL0
      * UPD : Customer Master           Update index
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     IYARDCS      DS                            357
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  USR Search Request
     I                                        1   1 P1ELST
     IP2PARM      DS
      * FLD: Customer Master
      * N : MAP City
     I                                        1  20 P2AJNA
      * N : MAP State Code
     I                                       21  22 P2BGCD
      * N : MAP Record Status
     I                                       23  23 P2VSST
     IP3PARM      DS
      * N :  USR First New Subfile Rcd
     I                                        1   1 P3EZST
     IP4PARM      DS
      * I :  Origination Point
     I                                        1   1 P4QRST
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P5AJCD
      * N :  Company Number
     I                                    P   4   50P5AIC3
      * N :  Application Code
     I                                        6  11 P5DNCD
      * N :  Enterprise Code 1
     I                                       12  15 P5DQCD
      * N :  Enterprise Code 2
     I                                       16  27 P5DRCD
      * N :  Salesperson Code
     I                                       28  30 P5BCCD
      * N :  System Date Format
     I                                       31  33 P5B8NA
      * N :  User Profile Name
     I                                       34  43 P5AJVN
      * N :  Allow Multi_Company
     I                                       44  44 P5I6ST
      * N :  Default Printer
     I                                       45  54 P5MPNA
     IP6PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P6G3TX
      * N : MAP PRT Printer Device
     I                                       26  35 P6WRST
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P6WSST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P6WTST
      * N : MAP PRT Number of Copies
     I                                       44  450P6DYNB
      * N : MAP PRT Night Queue Run Sts
     I                                       46  46 P6WUST
      * N : MAP PRT Night Queue
     I                                       47  56 P6BVVN
      * N : MAP Customer Number Pass  USR
     I                                    P  57  645P6AJNC
     IP7PARM      DS
      * N :  System Value Numeric
     I                                    P   1   85P7M8NB
     IP8PARM      DS
      * N :  USR Return Code
     I                                        1   1 P8N7CD
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(CUSTT-    1 256 #S0001
     I              'RFFC) JOBD(*USRPRF) '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'SBMJOB Override String'
      * Job
     I                                        1  10 ZA0001
      * Jobq
     I                                       11  20 ZA0002
      * Log
     I                                       21  37 ZA0003
      * Hold
     I                                       38  42 ZA0004
      * Message data for 'Cust Ineligible Deletion'
      * Ship To Customer
     I                                        1   7 ZA0005
      * Message data for 'Customer Status changed'
      * Ship To Customer
     I                                        1   7 ZA0006
      * Message data for 'A/R Customer Dependencies'
      * AR Customer Number
     I                                        1   7 ZA0007
      * Message data for 'A/R Parent with Dependenc'
      * Ship To Customer
     I                                        1   7 ZA0008
      * Message data for 'Order is Block Order'
      * Order Number
     I                                        1   7 ZA0009
      * Message data for 'Order is still open'
      * Order Number
     I                                        1   7 ZA0010
      * Message data for 'Ord Dtl open ords exist'
      * Ship To Customer
     I                                        1   7 ZA0011
      * Message data for 'Customer Status changed'
      * Ship To Customer
     I                                        1   7 ZA0012
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0013
      * Application Code
     I                                       11  16 ZA0014
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0015
      * Application Code
     I                                       11  16 ZA0016
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P4QRST    PARM           WP0001  1        Origination Poi
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'A'       #2VSST           Record Status
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
     C                     MOVEL*BLANK    #2AJNA           City
     C                     MOVEL#CNLTX    #2AJNA           City
     C                     MOVEL#CSQSX    #CSSSX           Type of Custome
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BBAYTX           Customer Name
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     MOVEL#2AYTX    BBAYTX
     C                     Z-ADD#2BKC7    BBBKC7
     C           KPOS      SETLL@BBREJU
     C                     READ @BBREJU                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2AYTX    WZAYTX
     C                     MOVEL#2AYTX    WZAYTX           Customer Name
     C           *LIKE     DEFN #2AJNA    WZAJNA
     C                     MOVEL#2AJNA    WZAJNA           City
     C           *LIKE     DEFN #2BVTX    WZBVTX
     C                     MOVEL#2BVTX    WZBVTX           Telephone Numbe
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2BTC7    WZBTC7
     C                     MOVEL#2BTC7    WZBTC7           Parent Customer
     C           *LIKE     DEFN #2ANC7    WZANC7
     C                     MOVEL#2ANC7    WZANC7           AR Customer Num
     C           *LIKE     DEFN #2BGCD    WZBGCD
     C                     MOVEL#2BGCD    WZBGCD           State Code
     C           *LIKE     DEFN #2VSST    WZVSST
     C                     MOVEL#2VSST    WZVSST           Record Status
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2AJNA    WQAJNA           City
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 20        WQA5N   50
     C                     PARM #2AJNA    WQAJNA           City
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BBREJU                  90*
     C  N82                READ @BBREJU                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,39
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AJNA    IFNE *BLANK                     City
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           BBAJNA           City
      * Length
     C                     PARM 20        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQAJNA
      * Length
     C                     PARM 20        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABNE1         BB020
     C                     END
     C           #2BVTX    IFNE *BLANK                     Telephone Numbe
     C           BBBVTX    CABNE#2BVTX    BB020            Telephone Numbe
     C                     END
     C           #2AYTX    IFEQ *BLANK                     Customer Name
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BBBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C                     END
     C           #2BTC7    IFNE *ZERO                      Parent Customer
     C           BBBTC7    CABNE#2BTC7    BB020            Parent Customer
     C                     END
     C           #2ANC7    IFNE *ZERO                      AR Customer Num
     C           BBANC7    CABNE#2ANC7    BB020            AR Customer Num
     C                     END
     C           #2BGCD    IFNE *BLANK                     State Code
     C           BBBGCD    CABNE#2BGCD    BB020            State Code
     C                     END
     C           #2VSST    IFNE *BLANK                     Record Status
     C           BBVSST    CABNE#2VSST    BB020            Record Status
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL*BLANK    #RSQSX           Type of Custome
      * Create Type of Customer
      * CASE: DB1.Ship To Customer Flag is Allow Use as Ship To Cust
     C           BBRJST    IFEQ 'Y'                        *IF
     C                     MOVEL'S'       #RSQSX           Type of Custome
      * CASE: DB1.A/R Customer Number EQ DB1.Ship To Customer
     C           BBANC7    IFEQ BBBKC7                     *IF
     C                     MOVEL'X'       #RSQSX           Type of Custome
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.A/R Customer Number EQ DB1.Ship To Customer
     C           BBANC7    IFEQ BBBKC7                     *IF
     C                     MOVEL'B'       #RSQSX           Type of Custome
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Parent Customer EQ DB1.Ship To Customer
     C           BBBTC7    IFEQ BBBKC7                     *IF
      * CASE: DB1.Parent Customer NE DB1.A/R Customer Number
     C           BBBTC7    IFNE BBANC7                     *IF
     C                     MOVEL'P'       #RSQSX           Type of Custome
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Type of Customer select but not equal to db1 then do not selec
      * CASE: CTL.Type of Customer NE WRK.BLANK
     C           #CSQSX    IFNE WUGSTX                     *IF
      * CASE: CTL.Type of Customer EQ RCD.Type of Customer
     C           #CSQSX    IFEQ #RSQSX                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     MOVELBBAYTX    #RUJTX           Name 25A USR
      * Customer Name
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: CTL.Name  25A  USR NE WRK.BLANK
     C           #CUJTX    IFNE WUGSTX                     *IF
      * CLC Call Qclscan       UP - /UT User Source  * 
     C                     CALL 'QCLSCAN'              90  CLC Call Qclsca
     C                     PARM #RUJTX    WQ0001256        USR Qclscan fie
     C                     PARM 25        WQ0002  30       USR Qclscan Len
     C                     PARM 1         WQ0003  30       USR Qclscan Sta
     C                     PARM #CUJTX    WQ0004256        USR Qclscan Mas
     C                     PARM 25        WQ0005  30       USR Qclscan Mas
     C                     PARM '1'       WQ0006  1        USR Qclscan Tra
     C                     PARM '1'       WQ0007  1        USR Qclscan Tri
     C                     PARM *BLANK    WQ0008  1        USR Qclscan Wil
     C           WUY8NB    PARM WUY8NB    WQ0009  30       USR Qclscan Res
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'QCLSCAN' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
     C                     END
      * CASE: WRK.USR Qclscan Result ? is Does contain
     C           WUY8NB    IFGT 0                          *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Record Selected= yes
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     Z-ADD1         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00025
     C           ZQ        ORGT 00025
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#CUJTX:ZQ WUPFTX    P  90  Text 1 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVEL'Y'       #REZST           USR First New S
     C                     MOVELBBBVTX    #RNCNA           USR Desc. 10
     C                     Z-ADD999999    W0SLM            *Scan limit
      * PK0357  Display asterisk if A/R Comments exist  1/09/2002
      * Rtv Record count      RT - Customer Comment  * 
     C                     EXSR SARVGN
      * CASE: LCL.USR Count is GT 0
     C           YL0001    IFGT *ZERO                      *IF
     C                     MOVEL'*'       #RDZNA           USR Asterisk
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RDZNA           USR Asterisk
     C                     END                             *FI
      * ** ACTIVE Accrual Exists **
     C                     MOVEL'N'       #RHLSX           Reverse Image F
      * Val Accrual Exists    RT - Customer Accrual  * 
     C                     EXSR SBRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #RHLSX           Reverse Image F
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELBBVSST    WUVSST           Record Status
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BBREJU                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Parent Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BTC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BTC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BTC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate AR Customer Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2ANC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2ANC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2ANC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Type of Customer USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CSQSX'  IFEQ YPMTFD
      * Type of Customer USR
     C                     MOVEL#CSQSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFSQSX
     C                     SELEC
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD1         ZFSQSX
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD2         ZFSQSX
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFSQSX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZFSQSX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD5         ZFSQSX
     C                     ENDSL
     C                     EXFMTZESQSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFSQSX    WHEQ 1
     C                     MOVEL'P'       W0INVL           P
     C           ZFSQSX    WHEQ 2
     C                     MOVEL'B'       W0INVL           B
     C           ZFSQSX    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFSQSX    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFSQSX    WHEQ 5
     C                     MOVEL'X'       W0INVL           X
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CSQSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Record Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2VSST    W0NSRQ  1        Record Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2VSST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70
     C           #2VSST    PARM #2VSST    W0EXVL 25        Record Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZBTC7    CASNE#2BTC7    FBRQRL
     C           WZANC7    CASNE#2ANC7    FBRQRL
     C           WZBGCD    CASNE#2BGCD    FBRQRL
     C           WZVSST    CASNE#2VSST    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL*BLANK    #CA7TX           USR Name
     C                     MOVEL#CUJTX    #CA7TX           USR Name
      * CASE: CTL.USR Name NE WRK.USR Name
     C           #CA7TX    IFNE WUA7TX                     *IF
      * ** Allow and leave special characters when searching    FP1251
      * CVT to Upper w/SpclChr US - /UT User Source  * 
     C                     MOVEA#CA7TX    AR1              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR1,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 's'
     C                     MOVEL'S'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 't'
     C                     MOVEL'T'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR1,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR1       #CA7TX           LOAD OUTPUT
     C                     MOVEL#CA7TX    WUA7TX           USR Name
     C                     MOVEL#CA7TX    #CUJTX           Name 25A USR
     C                     MOVEL#CA7TX    WUUJTX           Name 25A USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CASE: CTL.Type of Customer Sav NE CTL.Type of Customer
     C           #CSSSX    IFNE #CSQSX                     *IF
     C                     MOVEL#CSQSX    #CSSSX           Type of Custome
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * NEW 12/20/04 RMC -  to position on customers ge ctl.ship to
      * CASE: CTL.Ship To Customer NE CTL.Ship to Customer      USR
     C           #2BKC7    IFNE #CD0C7                     *IF
     C                     Z-ADD#2BKC7    #CD0C7           Ship to Custome
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CASE: CTL.City NE CTL.USR 15 Text           USR
     C           #2AJNA    IFNE #CNLTX                     *IF
     C                     MOVEL*BLANK    #2AJNA           City
     C                     MOVEL#CNLTX    #2AJNA           City
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Process create customer request
      * CASE: CTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * CRT Customer New       XF - Customer  * 
     C                     CLEARPARC
     C                     Z-ADDP5AIC3    PAAIC3           Company Number
     C                     Z-ADD#2BKC7    PABKC7           Ship To Custome
     C                     CLEARPBRC
      *
     C                     CALL 'PPHBXFR'              90  CRT Customer/Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Company Cu
     C                     PARM           PBRC             RCD: *Arrays
      *
     C                     Z-ADDPAAIC3    P5AIC3           Company Number
     C                     Z-ADDPABKC7    #2BKC7           Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPHBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Process Print listing
      * CASE: CTL.*CMD key is CF21
     C           *IN21     IFEQ '1'                        *IF
     C                     Z-ADD#2BKC7    P6AJNC           Customer Number
      * PRT Pass Cst/Cty/St/StsUP - /UT User Programs  * 
     C                     CALL 'PDYQUPR'              90  PRT Pass Cst/Ct
     C           WUH3TX    PARM *BLANK    WQ0010  7        Return Code Usr
     C                     PARM 'A/R'     WQ0011  6        Application Cod
     C                     PARM @CN,002   WQ0012 10        Program name US
     C           P6AJNC    PARM P6AJNC    WQ0013 155       Customer Number
     C           #2AJNA    PARM #2AJNA    WQ0014 20        City
     C           #2BGCD    PARM #2BGCD    WQ0015  2        State Code
     C           #2VSST    PARM #2VSST    WQ0016  1        Record Status
     C           P7M8NB    PARM P7M8NB    WQ0017 155       System Value Nu
     C                     PARM @CN,003   WQ0018 25        PRT Description
     C           P6WRST    PARM P6WRST    WQ0019 10        PRT Printer Dev
     C           P6WSST    PARM P6WSST    WQ0020  4        PRT Hold Output
     C           P6WTST    PARM P6WTST    WQ0021  4        PRT Save Output
     C           P6WUST    PARM P6WUST    WQ0022  1        PRT Night Queue
     C           P6BVVN    PARM P6BVVN    WQ0023 10        PRT Night Queue
     C                     PARM *BLANK    WQ0024  6        EDI Trading Par
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYQUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993738*
     C                     END
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Process Print Accrual List
      * CASE: CTL.*CMD key is CF22
     C           *IN22     IFEQ '1'                        *IF
      * PK0519 11/21/03  New report by sales route
      * Pmt Cust Acrl b/SlsRt PV - Company Customer  * 
     C                     CALL 'PPBVPVR'              90  Pmt Cust Acrl -
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPBVPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F8=Phone lookup
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * PMT Phone Lookup      PV - Customer  * 
     C                     CALL 'PNXZPVR'              90  PMT Phone Looku
     C                     PARM *BLANK    W0RTN   7
     C           YL0005    PARM YL0005    WQ0025 25        Telephone Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNXZPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Telephone Number FF is Not equal to blanks
     C           YL0005    IFNE *BLANK                     *IF
      * Exc Phone Lookup      XF - Customer  * 
     C                     CALL 'PNX0XFR'              90  Exc Phone Looku
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0005    WQ0026 25        Telephone Numbe
     C           #2BKC7    PARM #2BKC7    WQ0027  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: CTL.Ship To Customer is not equal to zero
     C           #2BKC7    IFNE *ZERO                      *IF
     C                     Z-ADD#2BKC7    #CD0C7           Ship to Custome
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * F9=M3 Supplier. Live with E1 flag must be "N". JBB WI440 4/14/21
      * CASE: CTL.*CMD key is CF09
     C           *IN09     IFEQ '1'                        *IF
      * CASE: LCL.Live with E1 usr is No
     C           YL0006    IFEQ 'N'                        *IF
      * WW M3 Supplier        DF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWAZDFR'              90  WW M3 Supplier
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWAZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'FKey not allowed if E1LIV'
     C                     MOVEL'USR5200' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F23=Print Collection Notes
      * CASE: CTL.*CMD key is CF23
     C           *IN23     IFEQ '1'                        *IF
      * CASE: PAR.PRT Number of Copies is Zero
     C           P6DYNB    IFEQ *ZERO                      *IF
     C                     Z-ADD1         P6DYNB           PRT Number of C
     C                     END                             *FI
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,004   WQ0028 25        PRT Description
     C           P6WRST    PARM P6WRST    WQ0029 10        PRT Printer Dev
     C           P6WSST    PARM P6WSST    WQ0030  4        PRT Hold Output
     C           P6WTST    PARM P6WTST    WQ0031  4        PRT Save Output
     C           P6DYNB    PARM P6DYNB    WQ0032  20       PRT Number of C
     C           P6WUST    PARM P6WUST    WQ0033  1        PRT Night Queue
     C           P6BVVN    PARM P6BVVN    WQ0034 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0035  6        Application Cod
     C                     PARM '1'       WQ0036  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL@CN,006   ZA0001           Job
     C                     MOVELP6BVVN    ZA0002           PRT Night Queue
     C                     MOVEL@CN,007   ZA0003           Log
     C                     MOVEL'*JOBD'   ZA0004           Hold
      * Retrieve message SBMJOB Override String
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2684' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           W0SJO     PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVE P6DYNB    YL0007           Copies NBR USR
      * SBMJOB: Prt Collection Notes  CL - A/R Header Note Header  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PMYFUPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD*ZERO     #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Invoice Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Invoice Suffix
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       ARHN Note Date
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       ARHN Note Time
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      ARHN Note Creat
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       ARHN Follow Up
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      ARHN Follow Up
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2ANC7    #SPAK  309       AR Customer Num
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Sales Route Cod
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELP6WRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELP6WSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELP6WTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0007    #SPAK  309       Copies NBR USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PMYFUPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMYFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * F24=Work With Follow Up Notes
      * CASE: CTL.*CMD key is CF24
     C           *IN24     IFEQ '1'                        *IF
      * WW Follow Up Notes    DF - A/R Header Note Header  * 
     C                     CALL 'PMYKDFR'              90  WW Follow Up No
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMYKDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,39
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * 2: Process change customer request
      * CASE: RCD.*SFLSEL is *Edit
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * EDT Customer/Co Cust   E2 - Customer  * 
     C                     CALL 'PPG1E2R'              90  EDT Customer/Co
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0037  70       Ship To Custome
     C                     PARM P4QRST    WQ0038  1        Origination Poi
     C                     PARM *ZERO     WQ0039  70       Copy from Custo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPG1E2R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Val Cust/Plnt Ship/WareXF - Company Customer  * 
     C                     CALL 'PPINXFR'              90  Val Cust/Plnt S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0040  70       Ship To Custome
     C           YL0008    PARM *BLANK    WQ0041  1        Need Ship/Ware
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPINXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 3: Process copy customer request
      * CASE: RCD.*SFLSEL is *Copy request
     C           #1SEL     IFEQ '3'                        *IF
     C           #1SEL     OREQ ' 3'
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * EDT Customer Copy Prc  XF - Customer  * 
     C                     CLEARPCRC
     C                     Z-ADDP5AIC3    PCAIC3           Company Number
     C                     Z-ADD#1BKC7    PCBKC7           Ship To Custome
     C                     CLEARPDRC
      *
     C                     CALL 'PPHDXFR'              90  EDT Customer Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Company Cu
     C                     PARM           PDRC             RCD: *Arrays
      *
     C                     Z-ADDPCAIC3    P5AIC3           Company Number
     C                     Z-ADDPCBKC7    #1BKC7           Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPHDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  010       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * 4: Process Delete
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'D'       #1VSST           Record Status
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 5: Display A/R Summary
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * RMC 9/16/04  PKTR01
      * ** Put blanks in new input parm for the DSP A/R Summary  03/27/06
     C                     MOVEL*BLANK    WUJDST           USR Check Y/N S
      * DSP A/R Summary       XF - A/R Summary  * 
     C                     CALL 'PPG5XFR'              90  DSP A/R Summary
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P5AIC3    WQ0042  30       Company Number
     C                     PARM #1ANC7    WQ0043  70       AR Customer Num
     C                     PARM WUJDST    WQ0044  1        USR Check Y/N S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPG5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 7: Edit comment
      * CASE: RCD.*SFLSEL is Edit Opt7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Edt Customer Comment  EF - Customer Comment  * 
     C                     CLEARPERC
     C                     Z-ADD#1BKC7    PEBKC7           Ship To Custome
     C                     MOVELWUOTTX    PEI1SX    P      Comment Type
      *
     C                     CALL 'POF9EFR'              90  Edt Customer Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Customer C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POF9EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 9: Edit Customer Item Reference
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Edt Cust Item Ref     EF - Customer Item Reference  * 
     C                     CLEARPFRC
     C                     Z-ADD#1BKC7    PFBKC7           Ship To Custome
      *
     C                     CALL 'POMXEFR'              90  Edt Cust Item R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Customer I
     C                     PARM #1AYTX    WQ0045 30        Customer Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMXEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 10: WW Cust/Invs        PK0357   1/11/2002
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * WW Customer/Invoices   DF - A/R Header  * 
     C                     CALL 'POONDFR'              90  WW Customer/Inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0046  30       Company Number
     C                     PARM #1ANC7    WQ0047  70       AR Customer Num
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POONDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * The A/R Summary will automatically be added with the CO/Cust
      *      the user will not be able to update the A/R Summary Record
      * 8: WW Customer/company
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0009           Company Number
      * WW Customer/Company    EF - Company Customer  * 
     C                     CALL 'PPIQEFR'              90  WW Customer/Com
     C                     PARM *BLANK    W0RTN   7
     C           YL0009    PARM YL0009    WQ0048  30       Company Number
     C           #1BKC7    PARM #1BKC7    WQ0049  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPIQEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 11: Process cust accruals request- RMC EXPCM 10/22/04 moved f/ ww
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * WW Cust Accruals      DF - Customer Accrual  * 
     C                     CALL 'POAXDFR'              90  WW Cust Accrual
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0050  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POAXDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 15=Edit customer more        (new E01654 8/18/2011)
      * CASE: RCD.*SFLSEL is Option 15
     C           #1SEL     IFEQ '15'                       *IF
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * par.display -> allow edit to gl sales acct type
      * Edt More Customer     E1 - Customer  * 
     C                     CLEARPGRC
     C                     Z-ADD#1BKC7    PGBKC7           Ship To Custome
      *
     C                     CALL 'PNY7E1R'              90  Edt More Custom
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             KEY: Customer M
     C                     PARM 'Y'       WQ0051  1        Display Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNY7E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 16: Process Activate/Inactivate Customer       E002031 4/10/2012
      * CASE: RCD.*SFLSEL is *Active/Inactive
     C           #1SEL     IFEQ '16'                       *IF
      * 03/04/25 DN DO23471-Inform User to Use P2P to Perform Action.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : LCL.Restrict to P2P is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'S'                        *IF
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Use P2P Info Msg   PV - Company Defaults Internal  * 
     C                     CALL 'PVJ7PVR'              90  Pmt Use P2P Inf
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * ** Save the original record status in wrk. Update rcd record
      * ** status with the new status (Active or Inactive)
      * CASE: RCD.Record Status is Inactive
     C           #1VSST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUVSST           Record Status
     C                     MOVEL'A'       #1VSST           Record Status
     C                     ELSE
      * CASE: RCD.Record Status is Active
     C           #1VSST    IFEQ 'A'                        *IF
     C                     MOVEL'A'       WUVSST           Record Status
     C                     MOVEL'I'       #1VSST           Record Status
     C                     ELSE
      * CASE: RCD.Record Status is Deleted
     C           #1VSST    IFEQ 'D'                        *IF
     C                     MOVEL'D'       WUVSST           Record Status
     C                     MOVEL'A'       #1VSST           Record Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,39
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Process delete customer request
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ '4'                        *IF
      * Cannot delete if any of the following exist for the customer:
      * History, A/R Header, Order Header, Order Detail,
      * A/R Summary, Item Contract, Customer/Item Price Overage, Order Ev
      * IF Company/Customer exists, make inactive in delete routine E0009
      * First check for other customer dependencies
      * Changed tp remove hard coded company num 06/08/07 JRB
      * RTV Vry/Dlt Cust Rec   XF - Company Defaults Internal  * 
     C                     CALL 'PMHXXFR'              90  RTV Vry/Dlt Cus
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0052  70       Ship To Custome
     C           P8N7CD    PARM P8N7CD    WQ0053  1        USR Return Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMHXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PAR.USR Return Code is Exists
     C           P8N7CD    IFEQ 'E'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Cust Ineligible Deletion'
     C                     MOVEL'USR2470' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 16=Process Activate/Inactivate Customer request  E002031
      * CASE: RCD.*SFLSEL is *Active/Inactive
     C           #1SEL     IFEQ '16'                       *IF
     C                     MOVEL'N'       WUN7CD           USR Return Code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Status is Inactive
      *   |- c2    : WRK.Record Status is Deleted
      *   '-
     C           WUVSST    IFEQ 'I'                        *IF
     C           WUVSST    OREQ 'D'                        *OR
      * If record was inactive or deleted, set to active without validati
      * UPD Match Cust RecSts  XF - Customer  * 
     C                     CALL 'PBCXXFR'              90  UPD Match Cust
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0054  70       Ship To Custome
     C                     PARM #1VSST    WQ0055  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBCXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Customer           CH - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0001           Ship To Custome
     C                     MOVEL#1AYTX    WL0002    P      Customer Name
     C                     MOVEL#1ACNA    WL0003    P      Address Line 1
     C                     MOVEL#1ADNA    WL0004    P      Address Line 2
     C                     MOVEL#1AENA    WL0005    P      Address Line 3
     C                     MOVEL#1AJNA    WL0006    P      City
     C                     MOVEL#1BGCD    WL0007    P      State Code
     C                     MOVEL#1G5CD    WL0008    P      County Code
     C                     MOVEL#1BTTX    WL0009    P      Zip Postal Code
     C                     MOVEL#1BVTX    WL0010    P      Telephone Numbe
     C                     MOVEL#1BWTX    WL0011    P      Fax Number FF
     C                     MOVEL#1ABTX    WL0012    P      Alpha Search
     C                     MOVEL#1A2NA    WL0013    P      Federal Tax Id
     C                     MOVEL#1CBST    WL0014    P      New Customer St
     C                     MOVEL#1B0NA    WL0015    P      SIC Number
     C                     Z-ADD#1P3NB    WL0016           D_B Number
     C                     MOVEL#1AXNA    WL0017    P      D_B Rating
     C                     Z-ADD#1I6DT    WL0018           Date of D_B Rat
     C                     Z-ADD#1ANC7    WL0019           AR Customer Num
     C                     Z-ADD#1BTC7    WL0020           Parent Customer
     C                     MOVEL#1K6ST    WL0021    P      Credit Check AR
     C                     MOVEL#1UZST    WL0022    P      Credit Check Pa
     C                     MOVEL#1KXCD    WL0023    P      Country Code
     C                     MOVEL#1LTCD    WL0024    P      EDI Invoice Sts
     C                     MOVEL#1QNST    WL0025    P      Order Entry Hol
     C                     Z-ADD#1S2NB    WL0026           Parent Credit L
     C                     Z-ADD#1VHVA    WL0027           AR Credit Limit
     C                     Z-ADD#1I7DT    WL0028           Order Entry Hol
     C                     MOVEL#1RJST    WL0029    P      Ship To Custome
     C                     MOVEL#1RKST    WL0030    P      Field vs In_Hou
     C                     MOVEL#1QWST    WL0031    P      Email When Orde
     C                     MOVEL#1QXST    WL0032    P      Print Invoice S
     C                     MOVEL#1QYST    WL0033    P      Item Reference
     C                     MOVEL#1UNCS    WL0034    P      Statement Print
     C                     MOVEL#1UVST    WL0035    P      EDI Status 1
     C                     MOVEL#1UWST    WL0036    P      EDI Status 2
     C                     MOVEL#1UXST    WL0037    P      EDI Status 3
     C                     MOVEL#1VSST    WL0038    P      Record Status
     C                     EXSR SCCHRC
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Customer Status changed'
     C                     MOVEL'USR4513' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Cannot Inactivate customer if any of the following exist:
      * Order Header records, Order Detail records, A/R Summary,
      * Item Contract, Customer/Item Price Overage, Order Events
      * and other customer dependencies
      * Inactivate even if Sales History or A/R Header exists per Tim Woo
     C                     MOVEL*BLANK    P8N7CD           USR Return Code
      * RTV Match Cust RecSts  XF - Company Defaults Internal  * 
     C                     CALL 'PBCZXFR'              90  Zzz Match Cust
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0056  70       Ship To Custome
     C           P8N7CD    PARM P8N7CD    WQ0057  1        USR Return Code
     C                     PARM #1VSST    WQ0058  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBCZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Existing History or A/R Headers is valid, set var to "N" E0020
      * CASE: PAR.USR Return Code is A/R Header
     C           P8N7CD    IFEQ 'H'                        *IF
     C                     MOVEL'N'       P8N7CD           USR Return Code
     C                     ELSE
      * CASE: PAR.USR Return Code is Sales History
     C           P8N7CD    IFEQ 'S'                        *IF
     C                     MOVEL'N'       P8N7CD           USR Return Code
     C                     END                             *FI
     C                     END                             *FI
      * Send message if USR Return Code is not blank, else update Custome
      * CASE: if not blanks and not "N"
      *  - c1 AND c2
      *   |- c1    : PAR.USR Return Code NE WRK.USR Blank Field
      *   |- c2    : PAR.USR Return Code NE WRK.USR Return Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8N7CD    IFNE WUOINA                     *IF
     C           P8N7CD    IFNE WUN7CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.USR Return Code is A/R Customer
     C           P8N7CD    IFEQ 'A'                        *IF
      * Setup message data for message
      * Convert AR Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'A/R Customer Dependencies'
     C                     MOVEL'USR2473' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.USR Return Code is Parent Customer
     C           P8N7CD    IFEQ 'P'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0008           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'A/R Parent with Dependenc'
     C                     MOVEL'USR4511' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.USR Return Code is Open Orders
     C           P8N7CD    IFEQ 'O'                        *IF
     C                     Z-ADD*ZERO     WUC4NB           Order Number
     C                     MOVEL*BLANK    WUBCST           Block Order Fla
      * RTV Val Opn Block Ord  RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * send order still open message
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,008                    *IF
      * If Order is Block Order, display appropriate message
      * CASE: WRK.Block Order Flag is Block Order
     C           WUBCST    IFEQ 'B'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WUC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWUC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0009           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order is Block Order'
     C                     MOVEL'USR4508' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WUC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWUC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0010           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0010           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order is still open'
     C                     MOVEL'USR4509' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.USR Return Code is Order Detail
     C           P8N7CD    IFEQ 'D'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ord Dtl open ords exist'
     C                     MOVEL'USR4512' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Customer           CH - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0001           Ship To Custome
     C                     MOVEL#1AYTX    WL0002    P      Customer Name
     C                     MOVEL#1ACNA    WL0003    P      Address Line 1
     C                     MOVEL#1ADNA    WL0004    P      Address Line 2
     C                     MOVEL#1AENA    WL0005    P      Address Line 3
     C                     MOVEL#1AJNA    WL0006    P      City
     C                     MOVEL#1BGCD    WL0007    P      State Code
     C                     MOVEL#1G5CD    WL0008    P      County Code
     C                     MOVEL#1BTTX    WL0009    P      Zip Postal Code
     C                     MOVEL#1BVTX    WL0010    P      Telephone Numbe
     C                     MOVEL#1BWTX    WL0011    P      Fax Number FF
     C                     MOVEL#1ABTX    WL0012    P      Alpha Search
     C                     MOVEL#1A2NA    WL0013    P      Federal Tax Id
     C                     MOVEL#1CBST    WL0014    P      New Customer St
     C                     MOVEL#1B0NA    WL0015    P      SIC Number
     C                     Z-ADD#1P3NB    WL0016           D_B Number
     C                     MOVEL#1AXNA    WL0017    P      D_B Rating
     C                     Z-ADD#1I6DT    WL0018           Date of D_B Rat
     C                     Z-ADD#1ANC7    WL0019           AR Customer Num
     C                     Z-ADD#1BTC7    WL0020           Parent Customer
     C                     MOVEL#1K6ST    WL0021    P      Credit Check AR
     C                     MOVEL#1UZST    WL0022    P      Credit Check Pa
     C                     MOVEL#1KXCD    WL0023    P      Country Code
     C                     MOVEL#1LTCD    WL0024    P      EDI Invoice Sts
     C                     MOVEL#1QNST    WL0025    P      Order Entry Hol
     C                     Z-ADD#1S2NB    WL0026           Parent Credit L
     C                     Z-ADD#1VHVA    WL0027           AR Credit Limit
     C                     Z-ADD#1I7DT    WL0028           Order Entry Hol
     C                     MOVEL#1RJST    WL0029    P      Ship To Custome
     C                     MOVEL#1RKST    WL0030    P      Field vs In_Hou
     C                     MOVEL#1QWST    WL0031    P      Email When Orde
     C                     MOVEL#1QXST    WL0032    P      Print Invoice S
     C                     MOVEL#1QYST    WL0033    P      Item Reference
     C                     MOVEL#1UNCS    WL0034    P      Statement Print
     C                     MOVEL#1UVST    WL0035    P      EDI Status 1
     C                     MOVEL#1UWST    WL0036    P      EDI Status 2
     C                     MOVEL#1UXST    WL0037    P      EDI Status 3
     C                     MOVEL#1VSST    WL0038    P      Record Status
     C                     EXSR SCCHRC
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0012           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0012           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Customer Status changed'
     C                     MOVEL'USR4513' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN79
     C           #RHLSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BBREJU fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBBAYTX    #1AYTX           Customer Name
     C                     MOVELBBBVTX    #1BVTX           Telephone Numbe
     C                     MOVELBBBWTX    #1BWTX           Fax Number FF
     C                     MOVELBBACNA    #1ACNA           Address Line 1
     C                     MOVELBBADNA    #1ADNA           Address Line 2
     C                     MOVELBBAENA    #1AENA           Address Line 3
     C                     MOVELBBG5CD    #1G5CD           County Code
     C                     MOVELBBBTTX    #1BTTX           Zip Postal Code
     C                     MOVELBBABTX    #1ABTX           Alpha Search
     C                     MOVELBBA2NA    #1A2NA           Federal Tax Id
     C                     MOVELBBCBST    #1CBST           New Customer St
     C                     MOVELBBB0NA    #1B0NA           SIC Number
     C                     Z-ADDBBP3NB    #1P3NB           D_B Number
     C                     MOVELBBAXNA    #1AXNA           D_B Rating
     C                     Z-ADDBBI6DT    #1I6DT           Date of D_B Rat
     C                     Z-ADDBBAYDT    #1AYDT           Credit Line Exp
     C                     MOVELBBK6ST    #1K6ST           Credit Check AR
     C                     MOVELBBUZST    #1UZST           Credit Check Pa
     C                     MOVELBBKXCD    #1KXCD           Country Code
     C                     MOVELBBLTCD    #1LTCD           EDI Invoice Sts
     C                     Z-ADDBBS2NB    #1S2NB           Parent Credit L
     C                     Z-ADDBBVHVA    #1VHVA           AR Credit Limit
     C                     Z-ADDBBI7DT    #1I7DT           Order Entry Hol
     C                     MOVELBBRJST    #1RJST           Ship To Custome
     C                     MOVELBBRKST    #1RKST           Field vs In_Hou
     C                     MOVELBBQWST    #1QWST           Email When Orde
     C                     MOVELBBQXST    #1QXST           Print Invoice S
     C                     MOVELBBQYST    #1QYST           Item Reference
     C                     MOVELBBUNCS    #1UNCS           Statement Print
     C                     MOVELBBQNST    #1QNST           Order Entry Hol
     C                     MOVELBBUVST    #1UVST           EDI Status 1
     C                     MOVELBBUWST    #1UWST           EDI Status 2
     C                     MOVELBBUXST    #1UXST           EDI Status 3
     C                     Z-ADDBBAATM    #1AATM           Job Time
     C                     MOVELBBAYNA    #1AYNA           User Id
     C                     MOVELBBA0NA    #1A0NA           Job Name
     C                     Z-ADDBBAXDT    #1AXDT           Job Date
     C                     Z-ADDBBBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADDBBBTC7    #1BTC7           Parent Customer
      * Clear external version also
     C                     MOVEL*BLANK    V1BTC7
     C                     Z-ADDBBANC7    #1ANC7           AR Customer Num
      * Clear external version also
     C                     MOVEL*BLANK    V1ANC7
     C                     MOVELBBAJNA    #1AJNA           City
     C                     MOVELBBBGCD    #1BGCD           State Code
     C                     MOVELBBVSST    #1VSST           Record Status
     C                     MOVEL*BLANK    #RHLSX           Reverse Image F
     C                     MOVEL*BLANK    #REZST           USR First New S
     C                     MOVEL*BLANK    #RNCNA           USR Desc. 10
     C                     MOVEL*BLANK    #RJZNA           USR Shortened N
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RDZNA           USR Asterisk
     C                     MOVEL*BLANK    #RSQSX           Type of Custome
     C                     MOVEL*BLANK    #RUJTX           Name 25A USR
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP6G3TX    #PG3TX           PRT Description
     C                     MOVELP6WRST    #PWRST           PRT Printer Dev
     C                     MOVELP6WSST    #PWSST           PRT Hold Output
     C                     MOVELP6WTST    #PWTST           PRT Save Output
     C                     Z-ADDP6DYNB    #PDYNB           PRT Number of C
     C                     MOVELP6WUST    #PWUST           PRT Night Queue
     C                     MOVELP6BVVN    #PBVVN           PRT Night Queue
     C                     Z-ADDP6AJNC    #PAJNC           Customer Number
     C                     MOVEL*BLANK    #2AYTX           Customer Name
     C                     MOVELP2AJNA    #2AJNA           City
     C                     Z-ADD*ZERO     #CCHC7           Parent Number
     C                     Z-ADD*ZERO     #CDUC7           A_R Customer
     C                     Z-ADD*ZERO     #CD0C7           Ship to Custome
     C                     MOVEL*BLANK    #CA7TX           USR Name
     C                     MOVEL*BLANK    #CSSSX           Type of Custome
     C                     MOVEL*BLANK    #2BVTX           Telephone Numbe
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     Z-ADD*ZERO     #2BTC7           Parent Customer
      * Clear external version also
     C                     MOVEL*BLANK    V2BTC7
     C                     Z-ADD*ZERO     #2ANC7           AR Customer Num
      * Clear external version also
     C                     MOVEL*BLANK    V2ANC7
     C                     MOVEL*BLANK    #CSQSX           Type of Custome
     C                     MOVEL*BLANK    #CUJTX           Name 25A USR
     C                     MOVEL*BLANK    #CNLTX           USR 15 Text
     C                     MOVELP2BGCD    #2BGCD           State Code
     C                     MOVELP2VSST    #2VSST           Record Status
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BTC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BTC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert AR Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1ANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1ANC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BTC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BTC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert AR Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2ANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2ANC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Record count      RT - Customer Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AVBKC7    WQSA01           Ship To Custome
     C           *LIKE     DEFN AVI1SX    WQSA02           Comment Type
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
     C                     KFLD           WQSA02           Comment Type
      * Setup key
     C                     Z-ADD#1BKC7    WQSA01           Ship To Custome
     C                     MOVEL'AR'      WQSA02           Comment Type
      * Establish starting position
     C           KRSSA     SETLL@AVCPG5                    *
     C           KRSSA     READE@AVCPG5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2993' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD0         YL0001           USR Count
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0001           USR Count
     C           KRSSA     READE@AVCPG5                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val Accrual Exists    RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0002           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN HOBKC7    WQSB01           Ship To Custome
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WQSB01           Ship To Custome
      * Establish starting position
     C           KRSSB     SETLL@HORELA                    *
     C           KRSSB     READE@HORELA                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Period Ending Date GE JOB.*Job date
     C           HOA2DT    IFGE ##JDT                      *IF
     C                     MOVEL'Y'       YL0002           Record Found US
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * CHG Customer           CH - Customer  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Credit Line Exp
     C                     Z-ADD*ZERO     WN0002  60       Job Time
     C                     MOVEL*BLANK    WN0003 10        User Id
     C                     MOVEL*BLANK    WN0004 10        Job Name
     C                     Z-ADD*ZERO     WN0005  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BBREE8
     C                     Z-ADDWL0001    WABKC7           Ship To Custome
      *
     C           KLCHSC    KLIST
     C                     KFLD           WABKC7           Ship To Custome
     C           KLCHSC    CHAIN@BBREE8              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CABBREL0'MDACP
     C                     MOVEL'@BBREE8' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCABB1    YARDCS
      * Move non-key fields to @BBREE8
     C                     MOVELWL0002    WAAYTX    P      Customer Name
     C                     MOVELWL0003    WAACNA    P      Address Line 1
     C                     MOVELWL0004    WAADNA    P      Address Line 2
     C                     MOVELWL0005    WAAENA    P      Address Line 3
     C                     MOVELWL0006    WAAJNA    P      City
     C                     MOVELWL0007    WABGCD    P      State Code
     C                     MOVELWL0008    WAG5CD    P      County Code
     C                     MOVELWL0009    WABTTX    P      Zip Postal Code
     C                     MOVELWL0010    WABVTX    P      Telephone Numbe
     C                     MOVELWL0011    WABWTX    P      Fax Number FF
     C                     MOVELWL0012    WAABTX    P      Alpha Search
     C                     MOVELWL0013    WAA2NA    P      Federal Tax Id
     C                     MOVELWL0014    WACBST    P      New Customer St
     C                     MOVELWL0015    WAB0NA    P      SIC Number
     C                     Z-ADDWL0016    WAP3NB           D_B Number
     C                     MOVELWL0017    WAAXNA    P      D_B Rating
     C                     Z-ADDWL0018    WAI6DT           Date of D_B Rat
     C                     Z-ADDWL0019    WAANC7           AR Customer Num
     C                     Z-ADDWL0020    WABTC7           Parent Customer
     C                     MOVELWL0021    WAK6ST    P      Credit Check AR
     C                     MOVELWL0022    WAUZST    P      Credit Check Pa
     C                     MOVELWL0023    WAKXCD    P      Country Code
     C                     MOVELWL0024    WALTCD    P      EDI Invoice Sts
     C                     MOVELWL0025    WAQNST    P      Order Entry Hol
     C                     Z-ADDWL0026    WAS2NB           Parent Credit L
     C                     Z-ADDWL0027    WAVHVA           AR Credit Limit
     C                     Z-ADDWL0028    WAI7DT           Order Entry Hol
     C                     MOVELWL0029    WARJST    P      Ship To Custome
     C                     MOVELWL0030    WARKST    P      Field vs In_Hou
     C                     MOVELWL0031    WAQWST    P      Email When Orde
     C                     MOVELWL0032    WAQXST    P      Print Invoice S
     C                     MOVELWL0033    WAQYST    P      Item Reference
     C                     MOVELWL0034    WAUNCS    P      Statement Print
     C                     MOVELWL0035    WAUVST    P      EDI Status 1
     C                     MOVELWL0036    WAUWST    P      EDI Status 2
     C                     MOVELWL0037    WAUXST    P      EDI Status 3
     C                     MOVELWL0038    WAVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QCABB1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAAATM' defaulted for 'Job Time'.
      * Field '(DB1) WAAYNA' defaulted for 'User Id'.
      * Field '(DB1) WAA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WAAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCABB1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BBREE8                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABBREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Val Opn Block Ord  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEBKC7    WQSD01           Ship To Custome
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Ship To Custome
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WQSD01           Ship To Custome
     C                     Z-ADDP5AIC3    BEAIC3           Company Number
     C                     Z-ADDWUC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KPSSD     SETLL@BFCPC6                    *
     C           KRSSD     READE@BFCPC6                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * CASE: DB1.Block Order Flag is Block Order
     C           BEBCST    IFEQ 'B'                        *IF
     C                     MOVELBEBCST    WUBCST           Block Order Fla
     C                     Z-ADDBEC4NB    WUC4NB           Order Number
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@BFCPC6                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0006    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSE     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P5I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P5MPNA           Default Printer
     C                     MOVELDRBCCD    P5BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0010           Company Number
     C                     MOVELDRBUVN    WN0007           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0039    DTAJVN           User Profile Na
     C                     MOVELWL0040    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSF     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0041           Company Number
     C                     MOVELDTAJCD    WL0042           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSG01           Application Cod
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSG01           Application Cod
     C                     MOVEL'A/R'     WQSG01           Application Cod
      * Establish starting position
     C           KRSSG     SETLL@DNRESF                    *
     C           KRSSG     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C           KRSSG     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSH01           Application Cod
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSH01           Application Cod
      * Establish starting position
     C           KRSSH     SETLL@DNRESF                    *
     C           KRSSH     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSH     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Sys Date Format    RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELP5AJVN    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSI     CHAIN@DRRETH              90    *
      * Data record not found
     C   90                MOVEL'USR0763' W0RTN   7
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * E1LIVE
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDP5AIC3    KMAIC3           Company Number
     C                     MOVE *BLANK    KMV8CD           Company Value C
     C                     MOVEL'E1LIVE'  KMV8CD           Company Value C
      * Establish starting position
     C           KRSSJ     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    YL0006           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDP5AIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSK     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Company Organiz
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYJSX    YL0003           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ031
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CSQSX'  YPMTFD           Type of Custome
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ078
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2VSST'  YPMTFD           Record Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1ELST           USR Search Requ
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJNA           City
     C                     MOVEL*BLANK    P2BGCD           State Code
     C                     MOVEL*BLANK    P2VSST           Record Status
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3EZST           USR First New S
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P5AIC3           Company Number
     C                     MOVEL*BLANK    P5DNCD           Application Cod
     C                     MOVEL*BLANK    P5DQCD           Enterprise Code
     C                     MOVEL*BLANK    P5DRCD           Enterprise Code
     C                     MOVEL*BLANK    P5BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P5B8NA           System Date For
     C                     MOVEL*BLANK    P5AJVN           User Profile Na
     C                     MOVEL*BLANK    P5I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P5MPNA           Default Printer
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6G3TX           PRT Description
     C                     MOVEL*BLANK    P6WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P6WSST           PRT Hold Output
     C                     MOVEL*BLANK    P6WTST           PRT Save Output
     C                     Z-ADD*ZERO     P6DYNB           PRT Number of C
     C                     MOVEL*BLANK    P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P6AJNC           Customer Number
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7M8NB           System Value Nu
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8N7CD           USR Return Code
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Qclscan Result ?
     C                     Z-ADD*ZERO     WUY8NB  30
      * Define work field Text 1 Length USR
     C                     MOVEL*BLANK    WUPFTX  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR Name
     C                     MOVEL*BLANK    WUA7TX 30
      * Define work field Name 25A USR
     C                     MOVEL*BLANK    WUUJTX 25
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field USR Return Code
     C                     MOVEL*BLANK    WUN7CD  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D_B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Blank Field
     C                     MOVEL*BLANK    WUOINA  1
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field Block Order Flag
     C                     MOVEL*BLANK    WUBCST  1
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SCCHRC.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 20
     C                     MOVEL*BLANK    WL0007  2
     C                     MOVEL*BLANK    WL0008  6
     C                     MOVEL*BLANK    WL0009 11
     C                     MOVEL*BLANK    WL0010 25
     C                     MOVEL*BLANK    WL0011 25
     C                     MOVEL*BLANK    WL0012 25
     C                     MOVEL*BLANK    WL0013 20
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  8
     C                     Z-ADD*ZERO     WL0016  90
     C                     MOVEL*BLANK    WL0017  5
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  6
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0039 10
     C                     MOVEL*BLANK    WL0040  6
     C                     Z-ADD*ZERO     WL0041  30
     C                     MOVEL*BLANK    WL0042  3
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Restrict to P2P
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Telephone Number FF
     C                     MOVEL*BLANK    YL0005 25
      * Define local work field Live with E1 usr
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Copies NBR USR
     C                     Z-ADD*ZERO     YL0007  20
      * Define local work field Need Ship/Ware Info Usr
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0011  3
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD11        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * See Narrative for ARS032 changes in EDT Customer function
      *
     C                     MOVEL*BLANK    WN0006 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0006           User Profile Na
      *
     C                     MOVEL*BLANK    WN0007 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SERVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,009                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0006    ZA0013           User Profile Na
     C                     MOVEL'A/R'     ZA0014           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0007    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0006    WL0039    P      User Profile Na
     C                     MOVEL'A/R'     WL0040    P      Application Cod
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0041    P5AIC3           Company Number
     C                     MOVELWL0042    YL0011    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0007    WL0039    P      User Profile Na
     C                     MOVEL'A/R'     WL0040    P      Application Cod
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0041    P5AIC3           Company Number
     C                     MOVELWL0042    YL0011    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0011    P5AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0006    ZA0015           User Profile Na
     C                     MOVEL'A/R'     ZA0016           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0010    IFNE 0                          *IF
     C                     Z-ADDYL0010    P5AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0011    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P5AJCD    PARM *BLANK    WQ0059  3        Warehouse Code
     C                     PARM YL0010    WQ0060  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SGRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * RTV Sys Date Format    RT - User Profile Control  * 
     C                     EXSR SIRVGN
     C                     MOVEL##USR     P5AJVN           User Profile Na
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6WRST           PRT Printer Dev
      * JBB WI-440  4/14/21 - M3 to JDE E1 Financials
      * RTV Alpha Value        RT - Company Values  * E1LIVE
     C                     EXSR SJRVGN
      * 03/04/25 DN DO23471-Get 'Restrict to P2P' Flag for CST Module.
      * Rtv Restrict to P2P    XF - Program Option Access Ctl  * 
     C                     CALL 'PVKAXFR'              90  Rtv Restrict to
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'CST'     WQ0061  3        Module ID
     C                     PARM 1         WQ0062  30       Release Number
     C           YL0004    PARM *BLANK    WQ0063  1        Restrict to P2P
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVKAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 03/04/25 DN DO23471-Get 'Company Organization' Value.
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SKRVGN
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 USR0752
00002 PDCOPCLP
00003 Print Customer
00004 Collection Notes
00005 Y2U9999
00006 CLCTNNOTES
00007 *JOBD *JOBD *JOBD
00008 Y2U0003
00009 Y2U0005
