     H/TITLE Exc Get Fob Prc Adjs  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 04/02/19  Time  : 16:11:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FOMHPREL1IF  E           K        DISK
      * RTV : Customer Accrual Item     Retrieval index
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FPOC8REL1IF  E           K        DISK
      * RTV : Customer Accrual Str      Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMHQCPL1IF  E           K        DISK
      * RTV : Order Detail Accrual      Retrieval index
      *
     FOMHLREL3IF  E           K        DISK
      * RTV : Accrual Program           Active Records Only
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@HORELA
      * Customer Accrual          Retrieval index
      * Renamed input format fields
     I              HOBKC7                          WBBKC7
     I              HOOJCD                          WBOJCD
     I              HOGUNY                          WBGUNY
     I              HOBFDT                          WBBFDT
     I              HOA2DT                          WBA2DT
     I              HOBKPR                          WBBKPR
     I              HOTTST                          WBTTST
     I              HOSHSX                          WBSHSX
     I              HOQDSX                          WBQDSX
     I              HOPJDT                          WBPJDT
     I              HOPKDT                          WBPKDT
     I              HOECVL                          WBECVL
     I              HOQESX                          WBQESX
     I              HOQFSX                          WBQFSX
     I              HOHHAA                          WBHHAA
     I              HOHQVL                          WBHQVL
     I              HOQGSX                          WBQGSX
     I              HOQHSX                          WBQHSX
     I              HOQISX                          WBQISX
     I              HOQJSX                          WBQJSX
     I              HOUVST                          WBUVST
     I              HOUWST                          WBUWST
     I              HOUXST                          WBUXST
     I              HOAATM                          WBAATM
     I              HOAYNA                          WBAYNA
     I              HOA0NA                          WBA0NA
     I              HOAXDT                          WBAXDT
      *
     I@HLREK4
      * Accrual Program           Retrieval index
      * Renamed input format fields
     I              HLOJCD                          WCOJCD
     I              HLLENA                          WCLENA
     I              HLTOST                          WCTOST
     I              HLTQST                          WCTQST
     I              HLTRST                          WCTRST
     I              HLTSST                          WCTSST
     I              HLOKCD                          WCOKCD
     I              HLTYST                          WCTYST
     I              HLOQCD                          WCOQCD
     I              HLHHCD                          WCHHCD
     I              HLI2TX                          WCI2TX
     I              HLJFTX                          WCJFTX
     I              HLI3TX                          WCI3TX
     I              HLJGTX                          WCJGTX
     I              HLLEDG                          WCLEDG
     I              HLTTST                          WCTTST
     I              HLBKPR                          WCBKPR
     I              HLSHSX                          WCSHSX
     I              HLQFSX                          WCQFSX
     I              HLFDTX                          WCFDTX
     I              HLFETX                          WCFETX
     I              HLFFTX                          WCFFTX
     I              HLFGTX                          WCFGTX
     I              HLHQVL                          WCHQVL
     I              HLFHTX                          WCFHTX
     I              HLUVST                          WCUVST
     I              HLUWST                          WCUWST
     I              HLUXST                          WCUXST
     I              HLVSST                          WCVSST
     I              HLAATM                          WCAATM
     I              HLAYNA                          WCAYNA
     I              HLA0NA                          WCA0NA
     I              HLAXDT                          WCAXDT
      *
     I@HPRELD
      * Customer Accrual Item     Retrieval index
      * Renamed input format fields
     I              HPBKC7                          WDBKC7
     I              HPOJCD                          WDOJCD
     I              HPGUNY                          WDGUNY
     I              HPHGCD                          WDHGCD
     I              HPBKPR                          WDBKPR
     I              HPSHSX                          WDSHSX
     I              HPUVST                          WDUVST
     I              HPUWST                          WDUWST
     I              HPUXST                          WDUXST
     I              HPAATM                          WDAATM
     I              HPAYNA                          WDAYNA
     I              HPA0NA                          WDA0NA
     I              HPAXDT                          WDAXDT
      *
     I@BGWKFW
      * Order Detail              Co/Order#/Item/Whse Not
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@C8RES1
      * Customer Accrual Str      Retrieval index
      * Renamed input format fields
     I              C8BKC7                          WFBKC7
     I              C8OJCD                          WFOJCD
     I              C8GUNY                          WFGUNY
     I              C8RGNB                          WFRGNB
     I              C8RHNB                          WFRHNB
     I              C8RINB                          WFRINB
     I              C8BKPR                          WFBKPR
     I              C8SHSX                          WFSHSX
     I              C8QTSX                          WFQTSX
     I              C8QUSX                          WFQUSX
     I              C8FKPR                          WFFKPR
     I              C8FLPR                          WFFLPR
     I              C8UVST                          WFUVST
     I              C8UWST                          WFUWST
     I              C8UXST                          WFUXST
     I              C8VSST                          WFVSST
     I              C8AATM                          WFAATM
     I              C8AYNA                          WFAYNA
     I              C8A0NA                          WFA0NA
     I              C8AXDT                          WFAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     I@HQCPLJ
      * Order Detail Accrual      Retrieval index
      * Renamed input format fields
     I              HQAIC3                          WHAIC3
     I              HQC4NB                          WHC4NB
     I              HQDPNB                          WHDPNB
     I              HQUENB                          WHUENB
     I              HQDXNB                          WHDXNB
     I              HQBKPR                          WHBKPR
     I              HQSHSX                          WHSHSX
     I              HQOKCD                          WHOKCD
     I              HQTINA                          WHTINA
     I              HQDSCD                          WHDSCD
     I              HQHAST                          WHHAST
     I              HQHBST                          WHHBST
     I              HQHCST                          WHHCST
     I              HQHDST                          WHHDST
     I              HQHEST                          WHHEST
     I              HQHFST                          WHHFST
     I              HQOJCD                          WHOJCD
     I              HQL8AA                          WHL8AA
     I              HQVSST                          WHVSST
     I              HQMJDT                          WHMJDT
     I              HQBETM                          WHBETM
     I              HQCCVN                          WHCCVN
     I              HQCDVN                          WHCDVN
     I              HQMKDT                          WHMKDT
     I              HQBFTM                          WHBFTM
     I              HQCEVN                          WHCEVN
     I              HQCFVN                          WHCFVN
      *
     I@HLREU8
      * Accrual Program           Active Records Only
      * Renamed input format fields
     I              HLOJCD                          WIOJCD
     I              HLLENA                          WILENA
     I              HLTOST                          WITOST
     I              HLTQST                          WITQST
     I              HLTRST                          WITRST
     I              HLTSST                          WITSST
     I              HLOKCD                          WIOKCD
     I              HLTYST                          WITYST
     I              HLOQCD                          WIOQCD
     I              HLHHCD                          WIHHCD
     I              HLI2TX                          WII2TX
     I              HLJFTX                          WIJFTX
     I              HLI3TX                          WII3TX
     I              HLJGTX                          WIJGTX
     I              HLLEDG                          WILEDG
     I              HLTTST                          WITTST
     I              HLBKPR                          WIBKPR
     I              HLSHSX                          WISHSX
     I              HLQFSX                          WIQFSX
     I              HLFDTX                          WIFDTX
     I              HLFETX                          WIFETX
     I              HLFFTX                          WIFFTX
     I              HLFGTX                          WIFGTX
     I              HLHQVL                          WIHQVL
     I              HLFHTX                          WIFHTX
     I              HLUVST                          WIUVST
     I              HLUWST                          WIUWST
     I              HLUXST                          WIUXST
     I              HLVSST                          WIVSST
     I              HLAATM                          WIAATM
     I              HLAYNA                          WIAYNA
     I              HLA0NA                          WIA0NA
     I              HLAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * I :  Item Code
     I                                    P  11  140P1HGCD
      * I :  Ship To Customer
     I                                    P  15  180P1BKC7
      * I :  Price Method Code
     I                                       19  21 P1Q7CD
      * I :  Price Status
     I                                       22  22 P1U1ST
      * I :  Quantity Shipped Total
     I                                    P  23  282P1CBQT
      * I :  Weight Shipped Total
     I                                    P  29  342P1ATWG
      * I :  Requested Ship Date
     I                                    P  35  380P1A5DT
      * I :  Actual Shipped Date
     I                                    P  39  420P1GNDT
     IP2PARM      DS
      * B :  MPR Customer Accrual Rt
     I                                    P   1   54P2WZNY
     IP3PARM      DS
      * B :  MPR Absorbed Frt Rate
     I                                    P   1   54P3W4NY
     IP4PARM      DS
      * B :  MPR Order Accrual Rate
     I                                    P   1   54P4W1NY
     IP5PARM      DS
      * I :  Shipping Method
     I                                        1   2 P5Q2CD
     IP6PARM      DS
      * N :  SFC Accrual Exists    USR
     I                                        1   1 P6D5SC
     IP7PARM      DS
      * B :  MPR Price Calc Exception
     I                                        1   2 P7PXS2
     IP8PARM      DS
      * N :  FRC Accrual Exists    USR
     I                                        1   1 P8HPSC
     IP9PARM      DS
      * B :  MPR Freight Add On
     I                                    P   1   54P9W3NY
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1BKC7    PARM           WP0006  70       Ship To Custome
     C           P1Q7CD    PARM           WP0007  3        Price Method Co
     C           P1U1ST    PARM           WP0008  1        Price Status
     C           P1CBQT    PARM           WP0009 112       Quantity Shippe
     C           P1ATWG    PARM           WP0010 112       Weight Shipped
     C           P1A5DT    PARM           WP0011  70       Requested Ship
     C           P1GNDT    PARM           WP0012  70       Actual Shipped
     C           P2WZNY    PARM P2WZNY    WP0013  94       MPR Customer Ac
     C           P3W4NY    PARM P3W4NY    WP0014  94       MPR Absorbed Fr
     C           P4W1NY    PARM P4W1NY    WP0015  94       MPR Order Accru
     C           P5Q2CD    PARM           WP0016  2        Shipping Method
     C           P7PXS2    PARM P7PXS2    WP0017  2        MPR Price Calc
     C           P9W3NY    PARM P9W3NY    WP0018  94       MPR Freight Add
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Get Fob Prc Adjs  XF
      * *****************************************************************
      * Get Accruals:  Customer level, order Level, and product level
      * *****************************************************************
     C                     Z-ADD*ZERO     P9W3NY           MPR Freight Add
     C                     MOVEL*BLANK    P7PXS2           MPR Price Calc
      * 1. Get Absorbed Freight
     C                     Z-ADD*ZERO     P3W4NY           MPR Absorbed Fr
      * CASE: PAR.Shipping Method is Prepaid
     C           P5Q2CD    IFEQ 'PR'                       *IF
     C           P5Q2CD    OREQ 'PT'
      *
     C                     Z-ADD*ZERO     WN0001  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0002  70       Item Code
     C                     Z-ADD*ZERO     WN0003 114       Price based on
     C                     Z-ADD*ZERO     WN0004 114       Price based on
     C                     Z-ADD*ZERO     WN0005 114       Price based on
     C                     Z-ADD*ZERO     WN0006 114       Price Adjustmen
      *
      * RTV Pricing: CFRTAB   IF
      * Rtv Shipping Method   RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * CASE: LCL.Shipping Method is Prepaid
     C           YL0003    IFEQ 'PR'                       *IF
     C           YL0003    OREQ 'PT'
      * R12926 DN 04/24/18-At Order level, get Absorbed Freight Rate from
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Customer Absorbed Frieght is entered as Hundred weight, therefore
      * Converting to Hundred weight is not necessary.
     C                     Z-ADDWN0001    YL0001           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0001           Pricing Retriev
     C                     END                             *FI
     C                     Z-ADDYL0001    YL0004           Absorbed Freigh
     C                     Z-ADDYL0004    P3W4NY           MPR Absorbed Fr
     C                     END                             *FI
      * 2. Get Known Ledgered and Revenue Adjustments
      * ** This will read all accrual codes that are setup for the
      * ** ShipTo customer and accumulate the Accrual Rates.
      * ** If Actual Shipped Date is zeros, use Requested Ship Date
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE *ZERO                      *IF
     C                     Z-ADDP1GNDT    WUFADT           USR Date Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5DT    WUFADT           USR Date Shippe
     C                     END                             *FI
      * 04/01/19 Only do the SFC/FRC accruals if shipping method is PT (n
      * 05/02/18 DO  deduct Abs Freight if this SFC/FRC accruals exist.
      * 12/05/16 dont deduct Abs Freight if this accrual exists. the frt
      *    in the price on these sysco orders, so zero out abs, and upd s
      * Rtv Accrual Info-MPR  RT - Customer Accrual  * 
     C                     EXSR SCRVGN
      *  5/2/18 R13009
      * CASE: PAR.SFC Accrual Exists    USR is Yes
     C           P6D5SC    IFEQ 'Y'                        *IF
     C                     MOVEL'SF'      P7PXS2           MPR Price Calc
     C                     ELSE
      * CASE: PAR.FRC Accrual Exists    USR is Yes
     C           P8HPSC    IFEQ 'Y'                        *IF
     C                     MOVEL'FR'      P7PXS2           MPR Price Calc
     C                     END                             *FI
     C                     END                             *FI
      * Get Accruals:  Order Level
      * Rtv Deduct/Add-MPR    RT - Order Detail Accrual  * 
     C                     EXSR SJRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Shipping Method   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Shipping Method
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAQ2CD    YL0003           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Absorbed Freigh
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWATBNB    WN0001           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Accrual Info-MPR  RT - Customer Accrual  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  30       Item Structure
     C                     Z-ADD*ZERO     WN0008  30       Item Structure
     C                     Z-ADD*ZERO     WN0009  30       Item Structure
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S14765 RMC 4/1/19 Only include SFC/FRC if PT
      * S13009 RMC 5/2/18 changes for Sysco with SFC and Jetro with FRC r
      *   -- add those accrual rates and still subtract the absorbed frt.
     C                     Z-ADD0         P2WZNY           Pricing Retriev
     C                     MOVEL'N'       P6D5SC           SFC Accrual Exi
     C                     MOVEL'N'       P8HPSC           FRC Accrual Exi
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSC01           Ship To Custome
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSC01           Ship To Custome
      * Establish starting position
     C           KRSSC     SETLL@HORELA                    *
     C           KRSSC     READE@HORELA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBKPR           Accrual Rate
     C                     Z-ADD*ZERO     P2WZNY           Pricing Retriev
     C                     Z-ADD*ZERO     WN0007           Item Structure
     C                     Z-ADD*ZERO     WN0008           Item Structure
     C                     Z-ADD*ZERO     WN0009           Item Structure
     C                     MOVEL*BLANK    P6D5SC           SFC Accrual Exi
     C                     MOVEL*BLANK    P8HPSC           FRC Accrual Exi
     C                     Z-ADD*ZERO     P9W3NY           MPR Freight Add
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** The par.period begin date is either the Actual Shipped date
      * ** from the Order Detail file unless it is zeros, then it is
      * ** replaced by the Requested Ship Date.
      * ** Select the record where the ASD is within the date range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Period Beginning Date GE DB1.Period Beginning Da
      *   |- c2    : PAR.Period Beginning Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUFADT    IFGE WBBFDT                     *IF
     C           WUFADT    IFLE WBA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Accrual Info-All   RT - Accrual Program  * 
     C                     EXSR SDRVGN
      * CASE: LCL.Sales History Exp Bucket is Ledgered
     C           YL0006    IFEQ @CN,001                    *IF
      * {above had:   |c2: LCL.Sales History Exp Bucket is Revenue Adjust
      * {Above was:  lcl.affect invoice price}
      * ** Accumulate rate based on All Products Y/N value
      * CASE: DB1.All Products (Y/N) is Yes
     C           WBTTST    IFEQ 'Y'                        *IF
      * ** If YES, then use the rate from the Customer Accrual record
     C                     Z-ADDWBBKPR    YL0008           Accrual Rate
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0005    IFEQ 'S'                        *IF
     C           0         SUB  WBBKPR    YL0008           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0008    P2WZNY           Pricing Retriev
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
     C           WBTTST    IFEQ 'X'                        *IF
      * ** If YES + Exceptions, then add the rate from either the Custome
      * ** Accrual Str or Customer Accrual Item file. The value in
      * ** the Accrual Detail Search field will determine which file.
      * ** If no record in either file then add the Customer Accural rate
      * Retrieve Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C           WBQFSX    IFEQ 'I'                        *IF
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0001           Ship To Custome
     C                     MOVELWBOJCD    WL0002    P      Accrual Code
     C                     Z-ADDWBGUNY    WL0003           CAH Sequence No
     C                     Z-ADDP1HGCD    WL0004           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0008           Accrual Rate
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WBQFSX    IFEQ 'S'                        *IF
      * ** Retrieve the Item Structure fields from the Order Detail
      * Rtv Item FOB Price    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADDP1C4NB    WL0007           Order Number
     C                     Z-ADDP1HGCD    WL0008           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YN0033           Price Overage O
     C                     Z-ADDWL0010    YN0034           Contract Number
     C                     MOVELWL0011    YN0035    P      Price Status
     C                     MOVELWL0012    YN0036    P      U/M - Ordered
     C                     Z-ADDWL0013    YN0037           Unit Price
     C                     Z-ADDWL0014    YN0038           Unit Price - Cr
     C                     Z-ADDWL0015    YN0039           Unit Price Orde
     C                     Z-ADDWL0016    YN0040           Unit Weight Ord
     C                     Z-ADDWL0017    YN0041           Actual Shipped
     C                     MOVELWL0018    YN0042    P      Affect Inventor
     C                     MOVELWL0019    YN0043    P      Affect Sales Do
     C                     MOVELWL0020    YN0044    P      Affect Sales Pn
     C                     Z-ADDWL0021    WN0007           Item Structure
     C                     Z-ADDWL0022    WN0008           Item Structure
     C                     Z-ADDWL0023    WN0009           Item Structure
     C                     MOVELWL0024    YN0045    P      Affect Trade Fu
     C                     MOVELWL0025    YN0046    P      Affect Commissi
     C                     MOVELWL0026    YN0047    P      Affect Pricing
     C                     MOVELWL0027    YN0048    P      Ord TF Exempt C
      * PKD/SZ 07/20/09 Should check with Type/Group/Class first then jus
      *                 Type/Group.
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0028           Ship To Custome
     C                     MOVELWBOJCD    WL0029    P      Accrual Code
     C                     Z-ADDWBGUNY    WL0030           CAH Sequence No
     C                     Z-ADDWN0007    WL0031           Item Structure
     C                     Z-ADDWN0008    WL0032           Item Structure
     C                     Z-ADDWN0009    WL0033           Item Structure
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    YL0008           Accrual Rate
     C                     MOVELWL0035    YN0025    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0028           Ship To Custome
     C                     MOVELWBOJCD    WL0029    P      Accrual Code
     C                     Z-ADDWBGUNY    WL0030           CAH Sequence No
     C                     Z-ADDWN0007    WL0031           Item Structure
     C                     Z-ADDWN0008    WL0032           Item Structure
     C                     Z-ADD0         WL0033           Item Structure
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    YL0008           Accrual Rate
     C                     MOVELWL0035    YN0025    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PKD/SZ 07/20/09 -- Needed to check if the Item was found or not.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBBKPR    YL0008           Accrual Rate
     C                     END                             *FI
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0005    IFEQ 'S'                        *IF
     C           0         SUB  YL0008    YL0008           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0008    P2WZNY           Pricing Retriev
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is No
     C           WBTTST    IFEQ 'N'                        *IF
      * ** If NO, then only accumulate the rate if there is a record
      * ** in either the Customer Accrual Str or Customer Accrual Item
      * ** file. If no record in either file, just add zeros.
      * CASE: DB1.Accrual Detail Search is Item
     C           WBQFSX    IFEQ 'I'                        *IF
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0001           Ship To Custome
     C                     MOVELWBOJCD    WL0002    P      Accrual Code
     C                     Z-ADDWBGUNY    WL0003           CAH Sequence No
     C                     Z-ADDP1HGCD    WL0004           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0008           Accrual Rate
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WBQFSX    IFEQ 'S'                        *IF
      * Rtv Item FOB Price    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADDP1C4NB    WL0007           Order Number
     C                     Z-ADDP1HGCD    WL0008           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YN0033           Price Overage O
     C                     Z-ADDWL0010    YN0034           Contract Number
     C                     MOVELWL0011    YN0035    P      Price Status
     C                     MOVELWL0012    YN0036    P      U/M - Ordered
     C                     Z-ADDWL0013    YN0037           Unit Price
     C                     Z-ADDWL0014    YN0038           Unit Price - Cr
     C                     Z-ADDWL0015    YN0039           Unit Price Orde
     C                     Z-ADDWL0016    YN0040           Unit Weight Ord
     C                     Z-ADDWL0017    YN0041           Actual Shipped
     C                     MOVELWL0018    YN0042    P      Affect Inventor
     C                     MOVELWL0019    YN0043    P      Affect Sales Do
     C                     MOVELWL0020    YN0044    P      Affect Sales Pn
     C                     Z-ADDWL0021    WN0007           Item Structure
     C                     Z-ADDWL0022    WN0008           Item Structure
     C                     Z-ADDWL0023    WN0009           Item Structure
     C                     MOVELWL0024    YN0045    P      Affect Trade Fu
     C                     MOVELWL0025    YN0046    P      Affect Commissi
     C                     MOVELWL0026    YN0047    P      Affect Pricing
     C                     MOVELWL0027    YN0048    P      Ord TF Exempt C
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Type Code is Not Entered
      *   |- c2    : PAR.Item Structure Group Code is Not Entered
      *   '-
     C           WN0007    IFEQ 0                          *IF
     C           WN0008    OREQ 0                          *OR
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0028           Ship To Custome
     C                     MOVELWBOJCD    WL0029    P      Accrual Code
     C                     Z-ADDWBGUNY    WL0030           CAH Sequence No
     C                     Z-ADDWN0007    WL0031           Item Structure
     C                     Z-ADDWN0008    WL0032           Item Structure
     C                     Z-ADDWN0009    WL0033           Item Structure
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    YL0008           Accrual Rate
     C                     MOVELWL0035    YN0025    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0028           Ship To Custome
     C                     MOVELWBOJCD    WL0029    P      Accrual Code
     C                     Z-ADDWBGUNY    WL0030           CAH Sequence No
     C                     Z-ADDWN0007    WL0031           Item Structure
     C                     Z-ADDWN0008    WL0032           Item Structure
     C                     Z-ADD0         WL0033           Item Structure
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    YL0008           Accrual Rate
     C                     MOVELWL0035    YN0025    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0005    IFEQ 'S'                        *IF
     C           0         SUB  YL0008    YL0008           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0008    P2WZNY           Pricing Retriev
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Shipping Method is Prepaid
     C           P5Q2CD    IFEQ 'PR'                       *IF
     C           P5Q2CD    OREQ 'PT'
      * SFC and FRC Accruals only  5/2/18  RMC S13009
      * CASE: DB1.Accrual Code is Sysco Freight Charge
     C           WBOJCD    IFEQ 'SFC'                      *IF
     C                     MOVEL'Y'       P6D5SC           SFC Accrual Exi
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0005    IFEQ 'S'                        *IF
     C           0         SUB  WBBKPR    YL0008           Accrual Rate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBBKPR    YL0008           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0008    P9W3NY           MPR Freight Add
     C                     ELSE
      * CASE: DB1.Accrual Code is Freight Rate Charge-Jetro
     C           WBOJCD    IFEQ 'FRC'                      *IF
     C                     MOVEL'Y'       P8HPSC           FRC Accrual Exi
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0005    IFEQ 'S'                        *IF
     C           0         SUB  WBBKPR    YL0008           Accrual Rate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBBKPR    YL0008           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0008    P9W3NY           MPR Freight Add
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@HORELA                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.U/M - Pricing is Not Entered
     C           'CW'      IFEQ *BLANK                     *IF
      * RTV Item Pricing Info  RT - Company Item  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * mpr needs to be in cwt
     C                     MOVEL'CW'      YL0009           U/M - Pricing
     C                     END                             *FI
      * CASE:
      *  - c1 OR c3 OR c4
      *   |- c1    : LCL.U/M - Pricing is Carcass Hundred Weight
      *   |- c3    : LCL.U/M - Pricing is Thousand
      *   |- c4    : LCL.U/M - Pricing is Tons
      *   '-
     C           YL0009    IFEQ 'CW'                       *IF
     C           YL0009    OREQ 'M'                        *OR
     C           YL0009    OREQ 'TN'                       *OR
      * Hundred Weight
      * CASE: LCL.U/M - Pricing is Hundred Weight
     C           YL0009    IFEQ 'CW'                       *IF
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.100
     C           P2WZNY    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P2WZNY           Pricing Retriev
     C                     END                             *FI
      * Thousand
      * CASE: LCL.U/M - Pricing is Thousand
     C           YL0009    IFEQ 'M'                        *IF
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.1000
     C           P2WZNY    MULT 1000      W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P2WZNY           Pricing Retriev
     C                     END                             *FI
      * Tons
      * CASE: LCL.U/M - Pricing is Tons
     C           YL0009    IFEQ 'TN'                       *IF
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.2000
     C           P2WZNY    MULT 2000      W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P2WZNY           Pricing Retriev
     C                     END                             *FI
      * Calc CWT for Freight add on
      * Hundred Weight
      * CASE: LCL.U/M - Pricing is Hundred Weight
     C           YL0009    IFEQ 'CW'                       *IF
      * PAR.MPR Freight Add On =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.MPR Freight Add On
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.100
     C           P9W3NY    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P9W3NY           MPR Freight Add
     C                     END                             *FI
      * Thousand
      * CASE: LCL.U/M - Pricing is Thousand
     C           YL0009    IFEQ 'M'                        *IF
      * PAR.MPR Freight Add On =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.MPR Freight Add On
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.1000
     C           P9W3NY    MULT 1000      W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P9W3NY           MPR Freight Add
     C                     END                             *FI
      * Tons
      * CASE: LCL.U/M - Pricing is Tons
     C           YL0009    IFEQ 'TN'                       *IF
      * PAR.MPR Freight Add On =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.MPR Freight Add On
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.2000
     C           P9W3NY    MULT 2000      W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P9W3NY           MPR Freight Add
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Accrual Info-All   RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCOJCD           Accrual Code
      * Setup key
     C                     MOVELWBOJCD    WCOJCD           Accrual Code
      * Establish starting position
     C           KRSSD     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           Add-on/Allowanc
     C                     MOVEL*BLANK    YL0006           Sales History E
     C                     MOVEL*BLANK    YL0007           Affect Invoice
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWCTSST    YL0005           Add-on/Allowanc
     C                     MOVELWCJGTX    YL0006           Sales History E
     C                     MOVELWCFFTX    YL0007           Affect Invoice
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
     C                     KFLD           WDOJCD           Accrual Code
     C                     KFLD           WDGUNY           CAH Sequence No
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WDBKC7           Ship To Custome
     C                     MOVELWL0002    WDOJCD           Accrual Code
     C                     Z-ADDWL0003    WDGUNY           CAH Sequence No
     C                     Z-ADDWL0004    WDHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@HPRELD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1522' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Accrual Rate
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBKPR    WL0005           Accrual Rate
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Item FOB Price    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSF02           Order Number
     C           *LIKE     DEFN WEHGCD    WQSF03           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WQSF03           Item Code
      * Setup key
     C                     Z-ADDWL0006    WQSF01           Company Number
     C                     Z-ADDWL0007    WQSF02           Order Number
     C                     Z-ADDWL0008    WQSF03           Item Code
      * Establish starting position
     C           KRSSF     SETLL@BGWKFW                    *
     C           KRSSF     READE@BGWKFW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0009           Price Overage O
     C                     Z-ADD*ZERO     WL0010           Contract Number
     C                     MOVEL*BLANK    WL0011           Price Status
     C                     MOVEL*BLANK    WL0012           U/M - Ordered
     C                     Z-ADD*ZERO     WL0013           Unit Price
     C                     Z-ADD*ZERO     WL0014           Unit Price - Cr
     C                     Z-ADD*ZERO     WL0015           Unit Price Orde
     C                     Z-ADD*ZERO     WL0016           Unit Weight Ord
     C                     Z-ADD*ZERO     WL0017           Actual Shipped
     C                     MOVEL*BLANK    WL0018           Affect Inventor
     C                     MOVEL*BLANK    WL0019           Affect Sales Do
     C                     MOVEL*BLANK    WL0020           Affect Sales Pn
     C                     Z-ADD*ZERO     WL0021           Item Structure
     C                     Z-ADD*ZERO     WL0022           Item Structure
     C                     Z-ADD*ZERO     WL0023           Item Structure
     C                     MOVEL*BLANK    WL0024           Affect Trade Fu
     C                     MOVEL*BLANK    WL0025           Affect Commissi
     C                     MOVEL*BLANK    WL0026           Affect Pricing
     C                     MOVEL*BLANK    WL0027           Ord TF Exempt C
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBZPR    WL0009           Price Overage O
     C                     Z-ADDWEL6NB    WL0010           Contract Number
     C                     MOVELWEU1ST    WL0011           Price Status
     C                     MOVELWEAGCD    WL0012           U/M - Ordered
     C                     Z-ADDWEAKPR    WL0013           Unit Price
     C                     Z-ADDWEALPR    WL0014           Unit Price - Cr
     C                     Z-ADDWEAUPR    WL0015           Unit Price Orde
     C                     Z-ADDWEAVWG    WL0016           Unit Weight Ord
     C                     Z-ADDWEGNDT    WL0017           Actual Shipped
     C                     MOVELWEAMST    WL0018           Affect Inventor
     C                     MOVELWEANST    WL0019           Affect Sales Do
     C                     MOVELWEVAST    WL0020           Affect Sales Pn
     C                     Z-ADDWERGNB    WL0021           Item Structure
     C                     Z-ADDWERHNB    WL0022           Item Structure
     C                     Z-ADDWERINB    WL0023           Item Structure
     C                     MOVELWEF0SX    WL0024           Affect Trade Fu
     C                     MOVELWEF1SX    WL0025           Affect Commissi
     C                     MOVELWEF2SX    WL0026           Affect Pricing
     C                     MOVELWEF4SX    WL0027           Ord TF Exempt C
     C           KRSSF     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
     C                     KFLD           WFOJCD           Accrual Code
     C                     KFLD           WFGUNY           CAH Sequence No
     C                     KFLD           WFRGNB           Item Structure
     C                     KFLD           WFRHNB           Item Structure
     C                     KFLD           WFRINB           Item Structure
      * Setup key
     C                     Z-ADDWL0028    WFBKC7           Ship To Custome
     C                     MOVELWL0029    WFOJCD           Accrual Code
     C                     Z-ADDWL0030    WFGUNY           CAH Sequence No
     C                     Z-ADDWL0031    WFRGNB           Item Structure
     C                     Z-ADDWL0032    WFRHNB           Item Structure
     C                     Z-ADDWL0033    WFRINB           Item Structure
      * Establish starting position
     C           KRSSG     CHAIN@C8RES1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3294' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0034           Accrual Rate
     C                     MOVEL*BLANK    WL0035           Accrual Rate Ty
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFBKPR    WL0034           Accrual Rate
     C                     MOVELWFSHSX    WL0035           Accrual Rate Ty
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WGAIC3           Company Number
     C                     Z-ADDP1HGCD    WGHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGRINB    WN0009           Item Structure
     C                     Z-ADDWGRHNB    WN0008           Item Structure
     C                     Z-ADDWGRGNB    WN0007           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Item Pricing Info  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WGAIC3           Company Number
     C                     Z-ADDP1HGCD    WGHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAICD    YL0009           U/M - Pricing
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Deduct/Add-MPR    RT - Order Detail Accrual  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0010 30        Accrual Descrip
     C                     MOVEL*BLANK    WN0011  1        Automatic Accru
     C                     MOVEL*BLANK    WN0012  1        Print On Invoic
     C                     MOVEL*BLANK    WN0013  1        Rate Usage
     C                     MOVEL*BLANK    WN0014  1        Add-on/Allowanc
     C                     MOVEL*BLANK    WN0015  2        Accrual Type
     C                     MOVEL*BLANK    WN0016  2        Sub Ledger Code
     C                     MOVEL*BLANK    WN0017  3        Reverse Accrual
     C                     MOVEL*BLANK    WN0018  2        U/M - Primary D
     C                     MOVEL*BLANK    WN0019  8        G/L Code Dr
     C                     MOVEL*BLANK    WN0020  8        G/L Code Cr
     C                     MOVEL*BLANK    WN0021  8        G/L Sub Account
     C                     MOVEL*BLANK    WN0022  8        Sales History E
     C                     MOVEL*BLANK    WN0023  1        Post to G/L (Y/
     C                     MOVEL*BLANK    WN0024  1        All Products (Y
     C                     Z-ADD*ZERO     WN0025  96       Accrual Rate
     C                     MOVEL*BLANK    WN0026  2        Accrual Rate Ty
     C                     MOVEL*BLANK    WN0027  1        Standard Schedu
     C                     MOVEL*BLANK    WN0028  1        Affect Sales Re
     C                     MOVEL*BLANK    WN0029  1        Affect Invoice
     C                     MOVEL*BLANK    WN0030  2        Invoice Print T
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         P4W1NY           Extended Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSJ02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSJ03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSJ04           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WQSJ03           Order Sequence
     C                     KFLD           WQSJ04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSJ01           Company Number
     C                     Z-ADDP1C4NB    WQSJ02           Order Number
     C                     Z-ADDP1DPNB    WQSJ03           Order Sequence
     C                     Z-ADDP1UENB    WQSJ04           Order Secondary
      * Establish starting position
     C           KRSSJ     SETLL@HQCPLJ                    *
     C           KRSSJ     READE@HQCPLJ                  90*
      * Data record not found
     C   90                MOVEL'USR1524' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Values Act NEW RT - Accrual Program  * 
     C                     EXSR SKRVGN
      * Calc Accrual
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Accrual Rate Type is $/Lb
      *   |- c2    : DB1.Accrual Rate Type is $/Lb by Weight Billed
      *   '-
     C           WHSHSX    IFEQ 'W'                        *IF
     C           WHSHSX    OREQ 'WR'                       *OR
     C           WHBKPR    MULT P1ATWG    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Accrual Rate Type is $/Quantity
      *   |- c2    : DB1.Accrual Rate Type is $/Quantity by qty shipped
      *   '-
     C           WHSHSX    IFEQ 'Q'                        *IF
     C           WHSHSX    OREQ 'QR'                       *OR
     C           WHBKPR    MULT P1CBQT    WUAYVA           Extended Amount
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is Flat Amount
     C           WHSHSX    IFEQ 'FA'                       *IF
     C                     Z-ADDWHBKPR    WUAYVA           Extended Amount
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is % of Gross Extended Amt
     C           WHSHSX    IFEQ 'G'                        *IF
      * Accrual = gross extended amt from Order dtl * accrual rate
      * WRK.Extended Amount
      * WRK.Extended Amount =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : DB1.Accrual Rate
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Extended Amount
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WHBKPR    MULT P4W1NY    W0WA01    H      *Synon (15,2) w
     C           W0WA01    DIV  100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is $/Quantity/1000
     C           WHSHSX    IFEQ 'QT'                       *IF
     C                     Z-ADD0         WUAYVA           Extended Amount
      * CASE: PAR.Quantity Shipped Total is Greater than zero
     C           P1CBQT    IFGT 0                          *IF
      * Compute: Amt/1000 qty
      * WRK.Extended Amount =
      *    *COMPUTE (x1 * x2 / x3)
      * x1    : DB1.Accrual Rate
      * *     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Quantity Shipped Total
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.1000
     C           WHBKPR    MULT P1CBQT    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  1000      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0014    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           '1'       IFEQ '1'                        *IF
     C           '1'       OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Do for debit memo too     RMC    4/14/10
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     ADD  WUAYVA    P4W1NY           Extended Amount
     C           KRSSJ     READE@HQCPLJ                  90*
     C                     ENDDO
      * USER: Exit processing
      * calc amt per cwt
      * CASE: PAR.Weight Shipped Total is Greater than zero
     C           P1ATWG    IFGT 0                          *IF
     C                     DIV  P1ATWG    P4W1NY           Extended Amount
     C                     MULT 100       P4W1NY           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         P4W1NY           Extended Amount
     C                     END                             *FI
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV All Values Act NEW RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC DLY029 5/23/07 Db Change - this outputs the new fields
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WIOJCD           Accrual Code
      * Setup key
     C                     MOVELWHOJCD    WIOJCD           Accrual Code
      * Establish starting position
     C           KRSSK     CHAIN@HLREU8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0010           Accrual Descrip
     C                     MOVEL*BLANK    WN0011           Automatic Accru
     C                     MOVEL*BLANK    WN0012           Print On Invoic
     C                     MOVEL*BLANK    WN0013           Rate Usage
     C                     MOVEL*BLANK    WN0014           Add-on/Allowanc
     C                     MOVEL*BLANK    WN0015           Accrual Type
     C                     MOVEL*BLANK    WN0016           Sub Ledger Code
     C                     MOVEL*BLANK    WN0017           Reverse Accrual
     C                     MOVEL*BLANK    WN0018           U/M - Primary D
     C                     MOVEL*BLANK    WN0019           G/L Code Dr
     C                     MOVEL*BLANK    WN0020           G/L Code Cr
     C                     MOVEL*BLANK    WN0021           G/L Sub Account
     C                     MOVEL*BLANK    WN0022           Sales History E
     C                     MOVEL*BLANK    WN0023           Post to G/L (Y/
     C                     MOVEL*BLANK    WN0026           Accrual Rate Ty
     C                     MOVEL*BLANK    WN0028           Affect Sales Re
     C                     MOVEL*BLANK    WN0029           Affect Invoice
     C                     MOVEL*BLANK    WN0030           Invoice Print T
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWILENA    WN0010           Accrual Descrip
     C                     MOVELWITOST    WN0011           Automatic Accru
     C                     MOVELWITQST    WN0012           Print On Invoic
     C                     MOVELWITRST    WN0013           Rate Usage
     C                     MOVELWITSST    WN0014           Add-on/Allowanc
     C                     MOVELWIOKCD    WN0015           Accrual Type
     C                     MOVELWITYST    WN0016           Sub Ledger Code
     C                     MOVELWIOQCD    WN0017           Reverse Accrual
     C                     MOVELWIHHCD    WN0018           U/M - Primary D
     C                     MOVELWII2TX    WN0019           G/L Code Dr
     C                     MOVELWIJFTX    WN0020           G/L Code Cr
     C                     MOVELWII3TX    WN0021           G/L Sub Account
     C                     MOVELWIJGTX    WN0022           Sales History E
     C                     MOVELWILEDG    WN0023           Post to G/L (Y/
     C                     MOVELWISHSX    WN0026           Accrual Rate Ty
     C                     MOVELWIFETX    WN0028           Affect Sales Re
     C                     MOVELWIFFTX    WN0029           Affect Invoice
     C                     MOVELWIFGTX    WN0030           Invoice Print T
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6D5SC           SFC Accrual Exi
     C                     MOVEL*BLANK    P8HPSC           FRC Accrual Exi
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Date Shipped
     C                     Z-ADD*ZERO     WUFADT  70
      * Define work field Accrual Code
     C                     MOVEL*BLANK    WUOJCD  3
      * Define work field Period Ending Date
     C                     Z-ADD*ZERO     WUA2DT  70
      * Define work field Accrual Rate
     C                     Z-ADD*ZERO     WUBKPR  96
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WBBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WBA2DT           Period Ending D
     C                     Z-ADD*ZERO     WBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WBPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WBPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WBECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WBHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WCHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WECFC7           Order Group Cod
     C                     Z-ADD*ZERO     WEMAVA           Billing Detail
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEL8VA           Billing Detail
     C                     Z-ADD*ZERO     WEL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WEEXDT           Market Pricing
     C                     Z-ADD*ZERO     WEBZPR           Price Overage O
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WEAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WED0WG           Weight Ordered
     C                     Z-ADD*ZERO     WECCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WECBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WEATWG           Weight Shipped
     C                     Z-ADD*ZERO     WEAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAKPR           Unit Price
     C                     Z-ADD*ZERO     WEALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WEAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WEAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WEA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WEB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WEA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WENTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WENUDT           Consumed Item C
     C                     Z-ADD*ZERO     WENVDT           Deadline Depart
     C                     Z-ADD*ZERO     WENWDT           OD Price Type R
     C                     Z-ADD*ZERO     WENXDT           OD Unused Date
     C                     Z-ADD*ZERO     WEBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WEBVTM           Price Code
     C                     Z-ADD*ZERO     WEBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WEBXTM           Substitution Li
     C                     Z-ADD*ZERO     WEBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WEH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WEH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WEH7NX           OD Item Target
     C                     Z-ADD*ZERO     WEH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WEH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WEDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WEDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WEDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WEDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WEDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WEGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WEGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WEGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WEPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WERINY           Item Age Days
     C                     Z-ADD*ZERO     WETIDT           Production Ovr
     C                     Z-ADD*ZERO     WETJDT           Production Ovr
     C                     Z-ADD*ZERO     WETKDT           OD Market Begin
     C                     Z-ADD*ZERO     WETLDT           OD Market Endin
     C                     Z-ADD*ZERO     WETMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WFFKPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WFFLPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAIWG           Unit Weight
     C                     Z-ADD*ZERO     WGCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WGC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WGURTN           Number Cases On
     C                     Z-ADD*ZERO     WGAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGTFNB           Transportation
     C                     Z-ADD*ZERO     WGTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WGTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WGBLPR           Market Overage
     C                     Z-ADD*ZERO     WGBMPR           Standard Overag
     C                     Z-ADD*ZERO     WGCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WGCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WGSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WGPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WGICN1           Item Category N
     C                     Z-ADD*ZERO     WGICN2           Item Category N
     C                     Z-ADD*ZERO     WGV2NB           Item Category N
     C                     Z-ADD*ZERO     WGITCN           Item Category N
     C                     Z-ADD*ZERO     WGITC5           Item Category N
     C                     Z-ADD*ZERO     WGICN6           Item Category N
     C                     Z-ADD*ZERO     WGICN7           Item Category N
     C                     Z-ADD*ZERO     WGICN8           Item Category N
     C                     Z-ADD*ZERO     WGICN9           Item Category N
     C                     Z-ADD*ZERO     WGICN0           Item Category N
     C                     Z-ADD*ZERO     WGSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WGA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WGSJNB           Production Lead
     C                     Z-ADD*ZERO     WGSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WGSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WGSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WGCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WGCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WGILNB           Packages per ca
     C                     Z-ADD*ZERO     WGCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WGCINB           PM Batch Size
     C                     Z-ADD*ZERO     WGCJNB           Package Level s
     C                     Z-ADD*ZERO     WGCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WGCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WGCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WGCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WGCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WGCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WGCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WGCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WGC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WGB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WGB5NB           PM Line Number
     C                     Z-ADD*ZERO     WGBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WGBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WGF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WGF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WGF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WGBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WGBNNB           Production Qty
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHDXNB           Sequence Number
     C                     Z-ADD*ZERO     WHBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Define work field Extended Amount
     C                     Z-ADD*ZERO     WUAYVA 112
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  50
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  96
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009 114
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013 114
     C                     Z-ADD*ZERO     WL0014 114
     C                     Z-ADD*ZERO     WL0015 114
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  30
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  2
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  3
     C                     Z-ADD*ZERO     WL0030  50
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  30
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  96
     C                     MOVEL*BLANK    WL0035  2
      * Define local work field Pricing Retrieved Amount
     C                     Z-ADD*ZERO     YL0001 114
      * Define local work field Error Return
     C                     MOVEL*BLANK    YL0002  5
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0004  52
      * Define null work field All Products (Y/N)
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Accrual Rate Type
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field Comm Threshold Period
     C                     MOVEL*BLANK    YN0003  2
      * Define null work field CAH Unused Date 1
     C                     Z-ADD*ZERO     YN0004  70
      * Define null work field CAH Unused Date 2
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field Comm Min Amt /Period
     C                     Z-ADD*ZERO     YN0006 112
      * Define null work field Comm Retroactive Sts
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field Accrual Detail Search
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field Broker Code
     C                     MOVEL*BLANK    YN0009  6
      * Define null work field Max Accrual Amount
     C                     Z-ADD*ZERO     YN0010 112
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0011 30
      * Define null work field Automatic Accrual (Y/N)
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Print On Invoice (Y/N)
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0014  1
      * Define local work field Add-on/Allowance
     C                     MOVEL*BLANK    YL0005  1
      * Define null work field Accrual Type
     C                     MOVEL*BLANK    YN0015  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0016  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0017  3
      * Define null work field U/M - Primary Dft
     C                     MOVEL*BLANK    YN0018  2
      * Define null work field G/L Code Dr
     C                     MOVEL*BLANK    YN0019  8
      * Define null work field G/L Code Cr
     C                     MOVEL*BLANK    YN0020  8
      * Define null work field G/L Sub Account Code
     C                     MOVEL*BLANK    YN0021  8
      * Define local work field Sales History Exp Bucket
     C                     MOVEL*BLANK    YL0006  8
      * Define null work field Post to G/L (Y/N)
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field All Products (Y/N)
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field Accrual Rate
     C                     Z-ADD*ZERO     YN0024  96
      * Define null work field Accrual Rate Type
     C                     MOVEL*BLANK    YN0025  2
      * Define null work field Accrual Detail Search
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Standard Schedule (Y/N)
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field Affect Sales Realz Rpt
     C                     MOVEL*BLANK    YN0028  1
      * Define local work field Affect Invoice Price
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Invoice Print Type
     C                     MOVEL*BLANK    YN0029  2
      * Define null work field Max Accrual Amount
     C                     Z-ADD*ZERO     YN0030 112
      * Define null work field Max Accrual Amount Type
     C                     MOVEL*BLANK    YN0031  2
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0032  1
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0008  96
      * Define null work field Price Overage Override
     C                     Z-ADD*ZERO     YN0033 114
      * Define null work field Contract Number
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field U/M - Ordered
     C                     MOVEL*BLANK    YN0036  2
      * Define null work field Unit Price
     C                     Z-ADD*ZERO     YN0037 114
      * Define null work field Unit Price - Credit
     C                     Z-ADD*ZERO     YN0038 114
      * Define null work field Unit Price Ordered U/M
     C                     Z-ADD*ZERO     YN0039 114
      * Define null work field Unit Weight Ordered U/M
     C                     Z-ADD*ZERO     YN0040 112
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0041  70
      * Define null work field Affect Inventory Status
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Affect Sales Doll Status
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Affect Sales Pnds Status
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Affect Trade Fund
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Affect Commission
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Affect Pricing
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Ord TF Exempt Code
     C                     MOVEL*BLANK    YN0048  2
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0049  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0050  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0052  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0053  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0055  2
      * Define local work field U/M - Pricing
     C                     MOVEL*BLANK    YL0009  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0056 112
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0058  1
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0059  3
      * Define null work field Commodity Price Group
     C                     MOVEL*BLANK    YN0060  7
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 LEDGER
