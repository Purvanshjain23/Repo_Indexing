// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKV4XFR
// ?Date: 14.08.2025 Time: 02:50:39
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?MODIFICATIONS
//?11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5 TO 7
CASE;

// IF PAR.Tattoo Action Usr is *ALL values
IF PAR.Tattoo_Action_Usr = 'RH'/'SP'/'SK'/'SF'/'ST'/'TB'/'CV'/'PV'/'TT'/'HL'/'CL'/'LC'             +
/'DV'/'HA'/'SC'/'RP'/'AK'/'YA'/'CO'/'ER'/'TS';

// WRK.THC Comment = WRK.Blank USR
WRK.THC_Comment = WRK.Blank_USR;

CASE;

// IF PAR.Tattoo Action Usr is Received Hogs
IF PAR.Tattoo_Action_Usr = 'RH';

// WRK.Head   Alpha Usr = CVTVAR(PAR.TH Head Received)
WRK.Head_Alpha_Usr = CVTVAR(PAR.TH_Head_Received);

// WRK.THC Comment = CONCAT(WRK.Head   Alpha Usr,CON.Hogs Received,CON.1)
WRK.THC_Comment = WRK.Head_Alpha_Usr + 'Hogs Received' (1);

// IF PAR.Tattoo Action Usr is Scale Ticket Printed
IF PAR.Tattoo_Action_Usr = 'SP';

// WRK.THC Comment = CON.Scale Ticket Printed
WRK.THC_Comment = 'Scale Ticket Printed';

// IF PAR.Tattoo Action Usr is Re-Pay flag as Paid
IF PAR.Tattoo_Action_Usr = 'RP';

// WRK.THC Comment = CON.Re-Pay Flagged as Pd
WRK.THC_Comment = 'Re-Pay Flagged as Pd';

// IF PAR.Tattoo Action Usr is Shipped Scale Tck Prt
IF PAR.Tattoo_Action_Usr = 'SC';

// WRK.THC Comment = CON.Shipped Scl Tck Printed
WRK.THC_Comment = 'Shipped Scl Tck Printed';

// IF PAR.Tattoo Action Usr is Held Over After SnttoKill
IF PAR.Tattoo_Action_Usr = 'AK';

CASE;

// IF PAR.TH Held Over is greater than 0
IF PAR.TH_Held_Over > *ZERO;

// WRK.Head   Alpha Usr = CVTVAR(PAR.TH Held Over)
WRK.Head_Alpha_Usr = CVTVAR(PAR.TH_Held_Over);

// WRK.THC Comment = CONCAT(WRK.Head   Alpha Usr,CON.Held over after Snt to kl,CON.
WRK.THC_Comment = WRK.Head_Alpha_Usr + 'Held over after Snt to kl' (1);

ENDIF;

// IF PAR.Tattoo Action Usr is Yard Deads After Snttokil
IF PAR.Tattoo_Action_Usr = 'YA';

CASE;

// IF PAR.TH Head Received is Not Zero
IF PAR.TH_Head_Received <> *ZERO;

// WRK.Head   Alpha Usr = CVTVAR(PAR.TH Head Received)
WRK.Head_Alpha_Usr = CVTVAR(PAR.TH_Head_Received);

// WRK.THC Comment = CONCAT(WRK.Head   Alpha Usr,CON.Yard Deads Aft Snt to kl,CON.1
WRK.THC_Comment = WRK.Head_Alpha_Usr + 'Yard Deads Aft Snt to kl' (1);

ENDIF;

// IF PAR.Tattoo Action Usr is Sent to Kill
IF PAR.Tattoo_Action_Usr = 'SK';

// WRK.THC Comment = CON.Sent to Kill
WRK.THC_Comment = 'Sent to Kill';

// IF PAR.Tattoo Action Usr is Subject From Tattoo #
IF PAR.Tattoo_Action_Usr = 'SF';

// WRK.Tattoo Nbr Alpha Usr = CVTVAR(PAR.TH Tattoo Number)
WRK.Tattoo_Nbr_Alpha_Usr = CVTVAR(PAR.TH_Tattoo_Number);

// WRK.THC Comment = CONCAT(CON.Subjects Created From,CON.Tattoo #,CON.1)
WRK.THC_Comment = 'Subjects Created From' + 'Tattoo #' (1);

// WRK.THC Comment = CONCAT(WRK.THC Comment,PAR.Tattoo Nbr Alpha Usr,CON.1)
WRK.THC_Comment = WRK.THC_Comment + PAR.Tattoo_Nbr_Alpha_Usr (1);

// IF PAR.Tattoo Action Usr is Subject To Tattoo #
IF PAR.Tattoo_Action_Usr = 'ST';

// WRK.Tattoo Nbr Alpha Usr = CVTVAR(PAR.TH Tattoo Number)
WRK.Tattoo_Nbr_Alpha_Usr = CVTVAR(PAR.TH_Tattoo_Number);

// WRK.THC Comment = CONCAT(CON.Subjects Created To,CON.Tattoo #,CON.1)
WRK.THC_Comment = 'Subjects Created To' + 'Tattoo #' (1);

// WRK.THC Comment = CONCAT(WRK.THC Comment,PAR.Tattoo Nbr Alpha Usr,CON.1)
WRK.THC_Comment = WRK.THC_Comment + PAR.Tattoo_Nbr_Alpha_Usr (1);

// IF PAR.Tattoo Action Usr is Tattoo Balanced
IF PAR.Tattoo_Action_Usr = 'TB';

// WRK.THC Comment = CON.Tattoo Balanced
WRK.THC_Comment = 'Tattoo Balanced';

// IF PAR.Tattoo Action Usr is Created Voucher
IF PAR.Tattoo_Action_Usr = 'CV';

// WRK.THC Comment = CON.Created Voucher
WRK.THC_Comment = 'Created Voucher';

// IF PAR.Tattoo Action Usr is Deleted Voucher
IF PAR.Tattoo_Action_Usr = 'DV';

// WRK.THC Comment = CON.Deleted Voucher
WRK.THC_Comment = 'Deleted Voucher';

// IF PAR.Tattoo Action Usr is Posted Voucher #
IF PAR.Tattoo_Action_Usr = 'PV';

// WRK.THC Comment = CON.Posted Voucher #
WRK.THC_Comment = 'Posted Voucher #';

// WRK.Ap Vch/Doc Alpha Usr = CVTVAR(PAR.TH AP Voucher/Document#)
WRK.Ap_Vch_Doc_Alpha_Usr = CVTVAR(PAR.TH_AP_Voucher_Document#);

// WRK.THC Comment = CONCAT(CON.Posted Voucher #,WRK.Ap Vch/Doc Alpha Usr,CON.1)
WRK.THC_Comment = 'Posted Voucher #' + WRK.Ap_Vch_Doc_Alpha_Usr (1);

// IF PAR.Tattoo Action Usr is Tattoo Transfered From #
IF PAR.Tattoo_Action_Usr = 'TT';

// WRK.THC Comment = CONCAT(CON.Tattoo Transfer From #,PAR.Tattoo Nbr Alpha Usr,CON
WRK.THC_Comment = 'Tattoo Transfer From #' + PAR.Tattoo_Nbr_Alpha_Usr (1);

// IF PAR.Tattoo Action Usr is Held Over All
IF PAR.Tattoo_Action_Usr = 'HA';

// WRK.Head   Alpha Usr = CVTVAR(PAR.TH Held Over)
WRK.Head_Alpha_Usr = CVTVAR(PAR.TH_Held_Over);

// WRK.THC Comment = CONCAT(CON.ALL Held Over,WRK.Head   Alpha Usr,CON.1)
WRK.THC_Comment = 'ALL Held Over' + WRK.Head_Alpha_Usr (1);

// IF PAR.Tattoo Action Usr is Held Over
IF PAR.Tattoo_Action_Usr = 'HL';

// WRK.Head   Alpha Usr = CVTVAR(PAR.TH Held Over)
WRK.Head_Alpha_Usr = CVTVAR(PAR.TH_Held_Over);

// WRK.THC Comment = CONCAT(CON.Held Over,WRK.Head   Alpha Usr,CON.1)
WRK.THC_Comment = 'Held Over' + WRK.Head_Alpha_Usr (1);

// IF PAR.Tattoo Action Usr is Carcass Merit to Live Pay
IF PAR.Tattoo_Action_Usr = 'CL';

// WRK.THC Comment = CONCAT(CON.Chg from Carcass Merit to,CON.Live Payment,CON.1)
WRK.THC_Comment = 'Chg from Carcass Merit to' + 'Live Payment' (1);

// IF PAR.Tattoo Action Usr is Live Pay to Carcass Merit
IF PAR.Tattoo_Action_Usr = 'LC';

// WRK.THC Comment = CONCAT(CON.Chg from Live Payment to,CON.Carcass Merit,CON.1)
WRK.THC_Comment = 'Chg from Live Payment to' + 'Carcass Merit' (1);

ENDIF;

//?-- YYMMDD to MMDDYY --
// WRK.Date Alpha USR = CVTVAR(JOB.*Job date)
WRK.Date_Alpha_USR = CVTVAR(JOB.*Job_date);

// WRK.Date From Convert USR = WRK.Date Alpha USR
WRK.Date_From_Convert_USR = WRK.Date_Alpha_USR;

// Call program Cvt Date              UP.
CALL PROGRAM(Cvt Date              UP) ('PKPOUPR');
PARAMETER(WRK.Date_From_Convert_USR);
PARAMETER(WRK.Date_To_Convert_USR);
PARAMETER(*CYMD);
PARAMETER(*MDY);
PARAMETER(*NONE);

// WRK.Code USR = WRK.Date To Convert USR
WRK.Code_USR = WRK.Date_To_Convert_USR;

// WRK.Date Num 6 Usr = CVTVAR(WRK.Code USR)
WRK.Date_Num_6_Usr = CVTVAR(WRK.Code_USR);

//?----------------------
// WRK.Date Alpha Usr 3 = CVTVAR(WRK.Date Num 6 Usr)
WRK.Date_Alpha_Usr_3 = CVTVAR(WRK.Date_Num_6_Usr);

// WRK.THC Comment = CONCAT(WRK.THC Comment,CON.Dt:,CON.1)
WRK.THC_Comment = WRK.THC_Comment + 'Dt:' (1);

// WRK.THC Comment = CONCAT(WRK.THC Comment,WRK.Date Alpha Usr 3,CON.1)
WRK.THC_Comment = WRK.THC_Comment + WRK.Date_Alpha_Usr_3 (1);

// WRK.Time  Alpha Usr = CVTVAR(JOB.*Job time)
WRK.Time_Alpha_Usr = CVTVAR(JOB.*Job_time);

// WRK.THC Comment = CONCAT(WRK.THC Comment,CON.Tm:,CON.1)
WRK.THC_Comment = WRK.THC_Comment + 'Tm:' (1);

// WRK.THC Comment = CONCAT(WRK.THC Comment,WRK.Time  Alpha Usr,CON.1)
WRK.THC_Comment = WRK.THC_Comment + WRK.Time_Alpha_Usr (1);

EXECUTE FUNCTION(Rtv Next Line Nbr     RT) TYPE(RTVOBJ) FILE(PKA4CPP)           AB1115261;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(WRK.THC_Comment_Line);
{
 //?USER: Processing if Data record not found

 // PAR.THC Comment Line = CON.1
 PAR.THC_Comment_Line = 1;

 //?USER: Process Data record

 // PAR.THC Comment Line = DB1.THC Comment Line + CON.1
 PAR.THC_Comment_Line = DB1.THC_Comment_Line + 1;

 QUIT;

}


EXECUTE FUNCTION(Crt Tattoo Hdr Cmnt   CR) TYPE(CRTOBJ) FILE(PKA4CPP)           AB1113201;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(WRK.THC_Comment_Line);
PARAMETER(WRK.THC_Comment);
PARAMETER('S');
PARAMETER(*BLANK);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER('A');
PARAMETER(JOB.*JOB);
PARAMETER(JOB.*PROGRAM);
PARAMETER(JOB.*USER);
PARAMETER(JOB.*Job_date);
PARAMETER(JOB.*Job_time);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?Execute internal function

  // PAR.RS Record Status = CND.Active
  PAR.RS_Record_Status = 'A';

  // PAR.RS User Added = JOB.*USER
  PAR.RS_User_Added = JOB.*USER;

  // PAR.RS Date Added = JOB.*Job date
  PAR.RS_Date_Added = JOB.*Job_date;

  // PAR.RS Time Added = JOB.*Job time
  PAR.RS_Time_Added = JOB.*Job_time;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

 }

}


ENDIF;

