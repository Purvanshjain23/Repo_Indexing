     H/TITLE WW Producer           DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 12/06/21  Time  : 11:15:58
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKDTDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Producer           DF  Display file
      *
     FPKACREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Producer                  Retrieval index
      *
     FPLAOREL1IF  E           K        DISK
      * RTV : Producer EXT              Retrieval index
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPWAGREL1IF  E           K        DISK
      * RTV : Producer Address          Retrieval index
      *
     FPLA8REL1IF  E           K        DISK
      * RTV : Producer Subsidiary       Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKAPCPL3IF  E           K        DISK
      * RSQ : Producer Contract         Producer Contract Seq
      *
     FPKBKCPL6IF  E           K        DISK
      * RSQ : Hog Voucher Header        Producer/Reg Key
      *
     FPKACREL4IF  E           K        DISK
      * RSQ : Producer                  Associated Producer
      *
     FPKBFREL3IF  E           K        DISK
      * RSQ : Producer Std Split        Split producer
      *
     FPKCACPL2IF  E           K        DISK
      * RSQ : Hog Voucher Split         By Producer
      *
     FPKCZCPL4IF  E           K        DISK
      * RSQ : Crc Sum Prd          YTD  Producer
      *
     FPKC2CPL4IF  E           K        DISK
      * RSQ : Crc Sum Prd Wgt Lot  WK   Producer
      *
     FPKC5CPLBIF  E           K        DISK
      * RSQ : Crc Sum Tto Wgt Lot  WRK  Producer
      *
     FPKC0CPL4IF  E           K        DISK
      * RSQ : Crc Sum Prd Lean Dst YTD  Producer
      *
     FPKDACPL3IF  E           K        DISK
      * RSQ : Hog Population Rpt Hdr    Producer
      *
     FPKCGCPL2IF  E           K        DISK
      * RSQ : Producer History WKLY     Producer
      *
     FPKBEREL1IF  E           K        DISK
      * RTV : Producer Std D/A          Retrieval index
      *
     FPKAEREL1IF  E           K        DISK
      * RTV : Producer Comment          Retrieval index
      *
     FPKBEREL0UF  E           K        DISK
      * UPD : Producer Std D/A          Update index
      *
     FPKACREL0UF  E           K        DISK
      * UPD : Producer                  Update index
      *
     FPKAEREL0UF  E           K        DISK
      * UPD : Producer Comment          Update index
      *
     FPWAGREL0UF  E           K        DISK
      * UPD : Producer Address          Update index
      *
      * Screen: Field position and name array
     E                    W0BEG   7 033  5 0A
     E                    W0END   7 033  5 0A
     E                    W0NAM   7 033 10
      * Long constants
     E                    @CN#    1  33  6   @CN    25
     I@ACREKJ
      * Producer                  Associated Producer
      * Renamed input format fields
     I              ACABCD                          WAABCD
     I              ACAGTX                          WAAGTX
     I              ACALNB                          WAALNB
     I              ACAATH                          WAAATH
     I              ACAMNB                          WAAMNB
     I              ACIWST                          WAIWST
     I              ACAPST                          WAAPST
     I              ACGCNB                          WAGCNB
     I              ACGJNB                          WAGJNB
     I              ACC2TX                          WAC2TX
     I              ACAACD                          WAAACD
     I              ACACCD                          WAACCD
     I              ACADCD                          WAADCD
     I              ACAAVN                          WAAAVN
     I              ACAADT                          WAAADT
     I              ACAMTM                          WAAMTM
     I              ACAJST                          WAAJST
     I              ACAHVN                          WAAHVN
     I              ACAGVN                          WAAGVN
     I              ACABVN                          WAABVN
     I              ACABDT                          WAABDT
     I              ACABTM                          WAABTM
      *
     I@BEREEX
      * Producer Std D/A          Update index
      * Renamed input format fields
     I              BEABCD                          WBABCD
     I              BEZCA1                          WBZCA1
     I              BEBQCD                          WBBQCD
     I              BEEVST                          WBEVST
     I              BEA1VA                          WBA1VA
     I              BEJAST                          WBJAST
     I              BEC0DT                          WBC0DT
     I              BEC1DT                          WBC1DT
     I              BEN2ST                          WBN2ST
     I              BEN3ST                          WBN3ST
     I              BEN4ST                          WBN4ST
     I              BEN5ST                          WBN5ST
     I              BEN6ST                          WBN6ST
     I              BEN7ST                          WBN7ST
     I              BEN8ST                          WBN8ST
     I              BEN9ST                          WBN9ST
     I              BEOAST                          WBOAST
     I              BEOBST                          WBOBST
     I              BEAAVN                          WBAAVN
     I              BEAADT                          WBAADT
     I              BEAMTM                          WBAMTM
     I              BEAJST                          WBAJST
     I              BEAHVN                          WBAHVN
     I              BEAGVN                          WBAGVN
     I              BEABVN                          WBABVN
     I              BEABDT                          WBABDT
     I              BEABTM                          WBABTM
      *
     I@ACREAB
      * Producer                  Update index
      * Renamed input format fields
     I              ACABCD                          WCABCD
     I              ACAGTX                          WCAGTX
     I              ACALNB                          WCALNB
     I              ACAATH                          WCAATH
     I              ACAMNB                          WCAMNB
     I              ACIWST                          WCIWST
     I              ACAPST                          WCAPST
     I              ACGCNB                          WCGCNB
     I              ACGJNB                          WCGJNB
     I              ACC2TX                          WCC2TX
     I              ACAACD                          WCAACD
     I              ACACCD                          WCACCD
     I              ACADCD                          WCADCD
     I              ACAAVN                          WCAAVN
     I              ACAADT                          WCAADT
     I              ACAMTM                          WCAMTM
     I              ACAJST                          WCAJST
     I              ACAHVN                          WCAHVN
     I              ACAGVN                          WCAGVN
     I              ACABVN                          WCABVN
     I              ACABDT                          WCABDT
     I              ACABTM                          WCABTM
      *
     I@AERECT
      * Producer Comment          Update index
      * Renamed input format fields
     I              AEABCD                          WDABCD
     I              AEAPNB                          WDAPNB
     I              AEANTX                          WDANTX
     I              AEEOST                          WDEOST
     I              AEAAVN                          WDAAVN
     I              AEAADT                          WDAADT
     I              AEAMTM                          WDAMTM
     I              AEAJST                          WDAJST
     I              AEAHVN                          WDAHVN
     I              AEAGVN                          WDAGVN
     I              AEABVN                          WDABVN
     I              AEABDT                          WDABDT
     I              AEABTM                          WDABTM
      *
     I@AGREXP
      * Producer Address          Update index
      * Renamed input format fields
     I              AGABCD                          WEABCD
     I              AGIKNB                          WEIKNB
     I              AGDVTX                          WEDVTX
     I              AGDNTX                          WEDNTX
     I              AGDOTX                          WEDOTX
     I              AGDPTX                          WEDPTX
     I              AGDQTX                          WEDQTX
     I              AGDRTX                          WEDRTX
     I              AGDSTX                          WEDSTX
     I              AGDTTX                          WEDTTX
     I              AGDUTX                          WEDUTX
     I              AGLSTX                          WELSTX
     I              AGLRTX                          WELRTX
     I              AGNVTX                          WENVTX
     I              AGNGTX                          WENGTX
     I              AGNHTX                          WENHTX
     I              AGNWTX                          WENWTX
     I              AGGNST                          WEGNST
     I              AGDXTX                          WEDXTX
     I              AGE0CD                          WEE0CD
     I              AGAAVN                          WEAAVN
     I              AGAADT                          WEAADT
     I              AGAMTM                          WEAMTM
     I              AGAJST                          WEAJST
     I              AGAHVN                          WEAHVN
     I              AGAGVN                          WEAGVN
     I              AGABVN                          WEABVN
     I              AGABDT                          WEABDT
     I              AGABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      * Outward parameters
     IPARC        DS                             12
      * KEY : Producer Location         Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PAABCD
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : Producer Subsidiary       Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PBABCD
      *
      * Outward parameters
     IPCRC        DS                              6
      * KEY : Producer                  Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PCABCD
      *
      * Outward parameters
     IPDRC        DS                             13
      * KEY : Producer Std D/A          Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PDABCD
      * I : MAP PSDP Company Number
     I                                    P   7   80PDZCA1
      *
      * Outward parameters
     IPERC        DS                              6
      * KEY : Producer EXT              Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PEABCD
      *
      * Outward parameters
     IPFRC        DS                             16
      * KEY : Producer Site             Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PFABCD
      *
      * Outward parameters
     IPGRC        DS                             12
      * KEY : Producer EXT              Alt Producer Payee
      * I : RST Alt Producer Payee
     I                                        1   6 PGPBCD
      *
      * Outward parameters
     IPHRC        DS                              6
      * KEY : Producer EXT              Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PHABCD
      *
     IQPKBE1    E DSPKBEREL0
      * UPD : Producer Std D/A          Update index
      * Renamed input format fields
     I              BEABCD                          WBABCD
     I              BEZCA1                          WBZCA1
     I              BEBQCD                          WBBQCD
     I              BEEVST                          WBEVST
     I              BEA1VA                          WBA1VA
     I              BEJAST                          WBJAST
     I              BEC0DT                          WBC0DT
     I              BEC1DT                          WBC1DT
     I              BEN2ST                          WBN2ST
     I              BEN3ST                          WBN3ST
     I              BEN4ST                          WBN4ST
     I              BEN5ST                          WBN5ST
     I              BEN6ST                          WBN6ST
     I              BEN7ST                          WBN7ST
     I              BEN8ST                          WBN8ST
     I              BEN9ST                          WBN9ST
     I              BEOAST                          WBOAST
     I              BEOBST                          WBOBST
     I              BEAAVN                          WBAAVN
     I              BEAADT                          WBAADT
     I              BEAMTM                          WBAMTM
     I              BEAJST                          WBAJST
     I              BEAHVN                          WBAHVN
     I              BEAGVN                          WBAGVN
     I              BEABVN                          WBABVN
     I              BEABDT                          WBABDT
     I              BEABTM                          WBABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKAC1    E DSPKACREL0
      * UPD : Producer                  Update index
      * Renamed input format fields
     I              ACABCD                          WCABCD
     I              ACAGTX                          WCAGTX
     I              ACALNB                          WCALNB
     I              ACAATH                          WCAATH
     I              ACAMNB                          WCAMNB
     I              ACIWST                          WCIWST
     I              ACAPST                          WCAPST
     I              ACGCNB                          WCGCNB
     I              ACGJNB                          WCGJNB
     I              ACC2TX                          WCC2TX
     I              ACAACD                          WCAACD
     I              ACACCD                          WCACCD
     I              ACADCD                          WCADCD
     I              ACAAVN                          WCAAVN
     I              ACAADT                          WCAADT
     I              ACAMTM                          WCAMTM
     I              ACAJST                          WCAJST
     I              ACAHVN                          WCAHVN
     I              ACAGVN                          WCAGVN
     I              ACABVN                          WCABVN
     I              ACABDT                          WCABDT
     I              ACABTM                          WCABTM
      *
     IQPKAE1    E DSPKAEREL0
      * UPD : Producer Comment          Update index
      * Renamed input format fields
     I              AEABCD                          WDABCD
     I              AEAPNB                          WDAPNB
     I              AEANTX                          WDANTX
     I              AEEOST                          WDEOST
     I              AEAAVN                          WDAAVN
     I              AEAADT                          WDAADT
     I              AEAMTM                          WDAMTM
     I              AEAJST                          WDAJST
     I              AEAHVN                          WDAHVN
     I              AEAGVN                          WDAGVN
     I              AEABVN                          WDABVN
     I              AEABDT                          WDABDT
     I              AEABTM                          WDABTM
      *
     IQPWAG1    E DSPWAGREL0
      * UPD : Producer Address          Update index
      * Renamed input format fields
     I              AGABCD                          WEABCD
     I              AGIKNB                          WEIKNB
     I              AGDVTX                          WEDVTX
     I              AGDNTX                          WEDNTX
     I              AGDOTX                          WEDOTX
     I              AGDPTX                          WEDPTX
     I              AGDQTX                          WEDQTX
     I              AGDRTX                          WEDRTX
     I              AGDSTX                          WEDSTX
     I              AGDTTX                          WEDTTX
     I              AGDUTX                          WEDUTX
     I              AGLSTX                          WELSTX
     I              AGLRTX                          WELRTX
     I              AGNVTX                          WENVTX
     I              AGNGTX                          WENGTX
     I              AGNHTX                          WENHTX
     I              AGNWTX                          WENWTX
     I              AGGNST                          WEGNST
     I              AGDXTX                          WEDXTX
     I              AGE0CD                          WEE0CD
     I              AGAAVN                          WEAAVN
     I              AGAADT                          WEAADT
     I              AGAMTM                          WEAMTM
     I              AGAJST                          WEAJST
     I              AGAHVN                          WEAHVN
     I              AGAGVN                          WEAGVN
     I              AGABVN                          WEABVN
     I              AGABDT                          WEABDT
     I              AGABTM                          WEABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P1ETTX
      * N : MAP PRT Printer Device
     I                                       26  35 P1ACVN
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P1AKST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P1AMST
      * N : MAP PRT Copies
     I                                       44  450P1AKNB
      * N : MAP PRT Night Queue Run Sts
     I                                       46  46 P1ALST
      * N : MAP PRT Night Queue
     I                                       47  56 P1AIVN
      * N : MAP Oms Application Code
     I                                       57  62 P1C7CD
     IP2PARM      DS
      * FLD: *Arrays
      * N : MAP Oms Warehouse Code
     I                                        1   3 P2J8NB
      * N : MAP CC Company Number
     I                                    P   4   50P2HONB
      * N : MAP Oms SalesPerson Code
     I                                        6   8 P2C8CD
      * N : MAP Oms Allow Multi-Company
     I                                        9   9 P2G8ST
      * N : MAP Oms Default Printer
     I                                       10  19 P2G9ST
      * N : MAP Oms Name
     I                                       20  49 P2EUTX
      * N : MAP Oms System Value Alpha
     I                                       50  89 P2EVTX
      * N : MAP Oms Access Denied (Y/N)
     I                                       90  90 P2HAST
     IP3PARM      DS
      * N :  Live with M3   USR
     I                                        1   1 P3G4SS
     IP4PARM      DS
      * FLD: M3 Supplier
      * N :  M3 Supplier Division
     I                                        1   3 P4R8CD
     IP5PARM      DS
      * N :  Vendor Number USR
     I                                        1  10 P5TICD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'User not Authorized Fkey'
      * Text 3 USR
     I                                        1   3 ZA0001
      * Message data for 'SBM Prt Producer List'
      * PRT Printer Device
     I                                        1  10 ZA0002
      * PRT Hold Output Sts
     I                                       11  14 ZA0003
      * PRT Save Output Sts
     I                                       15  18 ZA0004
      * PRT Copies
     I                                    P  19  200ZA0005
      * PRT Night Queue
     I                                       21  30 ZA0006
      * SR Source Code
     I                                       31  33 ZA0007
      * HB Buyer Code
     I                                       34  36 ZA0008
      * RS Record Status
     I                                       37  37 ZA0009
      * Oms System Value Alpha
     I                                       38  77 ZA0010
      * Message data for 'SBM Prt Producer'
      * PRT Printer Device
     I                                        1  10 ZA0011
      * PRT Hold Output Sts
     I                                       11  14 ZA0012
      * PRT Save Output Sts
     I                                       15  18 ZA0013
      * PRT Copies
     I                                    P  19  200ZA0014
      * PRT Night Queue
     I                                       21  30 ZA0015
      * PD Producer Code
     I                                       31  36 ZA0016
      * Oms System Value Alpha
     I                                       37  76 ZA0017
      * Message data for 'User Not Authorized &Opt'
      * *SFLSEL
     I                                        1   1 ZA0018
      * Message data for 'No EDI Trading Partner'
      * PD EDI Trading Partner #
     I                                    P   1   50ZA0019
      * Message data for 'User Not Authorized &Opt'
      * *SFLSEL
     I                                        1   1 ZA0020
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: WRK.First Time Flag Usr EQ WRK.Blank USR
     C           WUHBST    IFEQ WUCRTX                     *IF
     C                     MOVEL'A'       #2AJST           RS Record Statu
     C                     MOVEL'Y'       WUHJST           Display Print P
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * R10690 JJH 06/07/17 - F8=Dsp Blank SupplierID/ALL
      * R17061 DN 4/21/21-Renamed 'Supplier' to 'Vendor'.
     C                     MOVEL'N'       YL0001           Dsp Blank Vendo
      * R17061 DN 04/20/21-Renamed 'Supplier ID' to 'Vendor'.
     C                     MOVEL@CN,001   #CUHTX           Text 25 #1 Usr
     C                     END                             *FI
     C                     MOVEL#COTST    WUOTST           Insurance flag
     C                     MOVEL#CDFSS    WUDFSS           Subsidiary Flag
     C                     MOVEL#CJTSS    YL0002           HPS Automation
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#2ABCD    ACABCD
     C           KPOS      SETLL@ACREAI
     C                     READ @ACREAI                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2GJNB    WZGJNB
     C                     MOVEL#2GJNB    WZGJNB           PD EDI Trading
     C           *LIKE     DEFN #2GCNB    WZGCNB
     C                     MOVEL#2GCNB    WZGCNB           PD VND Address
     C           *LIKE     DEFN #2ABCD    WZABCD
     C                     MOVEL#2ABCD    WZABCD           PD Producer Cod
     C           *LIKE     DEFN #2AGTX    WZAGTX
     C                     MOVEL#2AGTX    WZAGTX           PD Name
     C           *LIKE     DEFN #2AJST    WZAJST
     C                     MOVEL#2AJST    WZAJST           RS Record Statu
     C           *LIKE     DEFN #2AACD    WZAACD
     C                     MOVEL#2AACD    WZAACD           SR Source Code
     C           *LIKE     DEFN #2ACCD    WZACCD
     C                     MOVEL#2ACCD    WZACCD           HB Buyer Code
     C           *LIKE     DEFN #2IWST    WZIWST
     C                     MOVEL#2IWST    WZIWST           PD Freight Exp
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2AGTX    WQAGTX           PD Name
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 40        WQA5N   50
     C                     PARM #2AGTX    WQAGTX           PD Name
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@ACREAI                  90*
     C  N82                READ @ACREAI                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,42
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2GJNB    IFNE *ZERO                      PD EDI Trading
     C           ACGJNB    CABNE#2GJNB    BB020            PD EDI Trading
     C                     END
     C           #2GCNB    IFNE *ZERO                      PD VND Address
     C           ACGCNB    CABNE#2GCNB    BB020            PD VND Address
     C                     END
     C           #2AGTX    IFNE *BLANK                     PD Name
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           ACAGTX           PD Name
      * Length
     C                     PARM 40        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQAGTX
      * Length
     C                     PARM 40        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2AJST    IFNE *BLANK                     RS Record Statu
     C           ACAJST    CABNE#2AJST    BB020            RS Record Statu
     C                     END
     C           #2AACD    IFNE *BLANK                     SR Source Code
     C           ACAACD    CABNE#2AACD    BB020            SR Source Code
     C                     END
     C           #2ACCD    IFNE *BLANK                     HB Buyer Code
     C           ACACCD    CABNE#2ACCD    BB020            HB Buyer Code
     C                     END
     C           #2IWST    IFNE *BLANK                     PD Freight Exp
     C           ACIWST    CABNE#2IWST    BB020            PD Freight Exp
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * R10690 JJH 06/07/17 - Logic no longer required
      * E10812 SLM 11/28/17 - Retrieve hps Automation
      * S16226 DN 03/02/20-Get Both HPS Automation & Live Repayment Flags
      * Rtv HPS Auto/Live Repy RT - Producer EXT  * 
     C                     EXSR SARVGN
      * PUT into the screen 1 position HPS Autom
      * CASE: RCD.HPS Automation (Y/N) is Yes
     C           #RMLCD    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #RJTSS           HPS Automation
     C                     ELSE
      * CASE: RCD.HPS Automation (Y/N) is No
     C           #RMLCD    IFEQ 'N'                        *IF
     C                     MOVEL'N'       #RJTSS           HPS Automation
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RJTSS           HPS Automation
     C                     END                             *FI
     C                     END                             *FI
      * 12/03/2018  JBB Record selection process for Y, N, or blank
      * HPS Automation selection
      * CASE: CTL.HPS Automation Y/N Usr is BLANK
     C           #CJTSS    IFEQ *BLANK                     *IF
      * Select all records
     C                     ELSE
      * CASE: *OTHERWISE
      * Select HPE Automation records = user's selection
      * CASE: CTL.HPS Automation Y/N Usr EQ RCD.HPS Automation Y/N Usr
     C           #CJTSS    IFEQ #RJTSS                     *IF
      * Select record
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * S16226 DN 03/02/20-Live Repayment Selection.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Live Repayment USR is Blank
      *   |- c2    : CTL.Live Repayment USR EQ RCD.Live Repayment USR
      *   '-
     C           #CL5SS    IFEQ *BLANK                     *IF
     C           #CL5SS    OREQ #RL5SS                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * R10690 JJH 06/07/17 - Retrieve M3 Supplier ID
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR SBRVGN
      * R17061 DN 04/20/21-Commented Out M3 Supplier ID.
      * R17061 DN 04/21/21-Set JDE / M3 Prefix Based on 'E1LIVE' Flag.
      * CASE: LCL.JDE Live with E1 USR is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'JDE'     #CHDT1           JDE/M3 Prefix U
     C                     MOVEL*BLANK    #RTICD           Vendor Number U
      * Remove Leading Zero for JDE Vendor #.
      * CASE: RCD.PD VND Address Number is Not zero
     C           #1GCNB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    #RTICD           Vendor Number U
     C                     MOVEL#1GCNB    #RTICD           Vendor Number U
     C                     MOVEL#RTICD    P5TICD           Vendor Number U
     C                     Z-ADD*ZERO     YL0004           Count USR
     C                     MOVEL'0'       YL0005           Text Usr 1
      * Substring in the Value Without the Leading Zeros.
      * DO WHILE: LCL.Text Usr 1 is Zero
     C           YL0005    DOWEQ'0'                        *DOW
     C                     ADD  1         YL0004           Count USR
     C                     Z-ADD1         YRSW00
     C                     Z-ADDYL0004    ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP5TICD:ZQ YL0005    P  90  Text Usr 1
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * CASE: LCL.Text Usr 1 is Not Zero
     C           YL0005    IFNE '0'                        *IF
     C           9         SUB  YL0004    YL0006           For Length USR
     C                     Z-ADDYL0006    YRSW00
     C                     Z-ADDYL0004    ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP5TICD:ZQ P5TICD    P  90  Vendor Number U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVELP5TICD    #RTICD           Vendor Number U
     C                     END                             *FI
     C                     END                             *ITR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CHDT1           JDE/M3 Prefix U
     C                     MOVEL'M3'      #CHDT1           JDE/M3 Prefix U
     C                     MOVEL#RQHCD    #RTICD           Vendor Number U
     C                     END                             *FI
      * R17061 DN 04/21/21-Select By Vendor.
      * CASE: CTL.Vendor Number USR is Not Entered
     C           #CTICD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Vendor Number USR NE RCD.Vendor Number USR
     C           #CTICD    IFNE #RTICD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * R17061 DN 04/21/21-Changed Logic for F8.
      * If F8 Pressed Then Select Blank/ALL Vendor.   R17061 DN 04/21/21
      * CASE: LCL.Dsp Blank Vendor USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    #CTICD           Vendor Number U
      * CASE: RCD.Vendor Number USR is Not Entered
     C           #RTICD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * R10690 JJH 06/07/17 - Display Producer Address
      * Rtv Producer Address  RT - Producer Address  * 
     C                     EXSR SCRVGN
      * *****************************************************************
      * Rtv/Chk Prdcr for Ins XF - Deduction/Addition  * 
     C                     CALL 'PKGDXFR'              90  Rtv/Chk Prdcr f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ACABCD    WQ0001  6        PD Producer Cod
     C           #ROTST    PARM *BLANK    WQ0002  1        @Status (Yes/No
     C                     PARM YL0007    WQ0003  30       PSDP Company Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Insurance Flag
      * CASE: CTL.Insurance flag USR NE WRK.Blank USR
     C           #COTST    IFNE WUCRTX                     *IF
      * CASE: RCD.Insurance flag USR EQ CTL.Insurance flag USR
     C           #ROTST    IFEQ #COTST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Subsidary Flag
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Prodsubsidiary    RT - Producer Subsidiary  * 
     C                     EXSR SDRVGN
      * CASE: CTL.Subsidiary Flag Usr NE WRK.Blank USR
     C           #CDFSS    IFNE WUCRTX                     *IF
      * CASE: RCD.Subsidiary Flag Usr EQ CTL.Subsidiary Flag Usr
     C           #RDFSS    IFEQ #CDFSS                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @ACREAI                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN81     IFNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN81     CAIN81  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate RS Record Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2AJST    W0NSRQ  1        RS Record Statu
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2AJST'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100087   Y2LSNO  70
     C           #2AJST    PARM #2AJST    W0EXVL 25        RS Record Statu
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate PD Freight Exp Paid By
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2IWST'  IFEQ YPMTFD
      * PD Freight Exp Paid By
     C                     MOVEL#2IWST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFIWST
     C                     SELEC
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD1         ZFIWST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZFIWST
     C                     ENDSL
     C                     EXFMTZEIWST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFIWST    WHEQ 1
     C                     MOVEL'P'       W0INVL           P
     C           ZFIWST    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2IWST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Insurance flag USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#COTST    W0NSRQ  1        Insurance flag
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#COTST'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1189958   Y2LSNO  70
     C           #COTST    PARM #COTST    W0EXVL 25        Insurance flag
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Subsidiary Flag Usr
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CDFSS    W0NSRQ  1        Subsidiary Flag
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CDFSS'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1189958   Y2LSNO  70
     C           #CDFSS    PARM #CDFSS    W0EXVL 25        Subsidiary Flag
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate HPS Automation Y/N Usr
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CJTSS    W0NSRQ  1        HPS Automation
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CJTSS'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1342243   Y2LSNO  70
     C           #CJTSS    PARM #CJTSS    W0EXVL 25        HPS Automation
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Live Repayment USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CL5SS    W0NSRQ  1        Live Repayment
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CL5SS'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1256322   Y2LSNO  70
     C           #CL5SS    PARM #CL5SS    W0EXVL 25        Live Repayment
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZABCD    CASNE#2ABCD    FBRQRL
     C           WZAGTX    CASNE#2AGTX    FBRQRL
     C           WZAJST    CASNE#2AJST    FBRQRL
     C           WZAACD    CASNE#2AACD    FBRQRL
     C           WZACCD    CASNE#2ACCD    FBRQRL
     C           WZIWST    CASNE#2IWST    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * F4=Prompt on Source
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is CF04
      *   |- c2    : PGM.*Cursor field <IS> CTL.SR Source Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#2AACD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWUCRTX    #2AACD           SR Source Code
      * Sel Source            SR - Source  * 
     C                     CALL 'PKDRSRR'              90  Sel Source
     C                     PARM *BLANK    W0RTN   7
     C           #2AACD    PARM #2AACD    WQ0004  3        SR Source Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * F4=Prompt on Buyer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is CF04
      *   |- c2    : PGM.*Cursor field <IS> CTL.HB Buyer Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#2ACCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWUCRTX    #2ACCD           HB Buyer Code
      * Sel Hog Buyer         SR - Hog Buyer  * 
     C                     CALL 'PKD3SRR'              90  Sel Hog Buyer
     C                     PARM *BLANK    W0RTN   7
     C           #2ACCD    PARM #2ACCD    WQ0005  3        HB Buyer Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * R17061 DN 04/21/21-Allow M3 Vendor Prompt Only if E1LIVE=N.
      * F4=Prompt on M3 Supp                          R17061 DN 04/21/21
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : CTL.*CMD key is CF04
      *   |- c2    : PGM.*Cursor field <IS> CTL.Vendor Number USR
      *   |- c3    : LCL.JDE Live with E1 USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CTICD'                   *IF
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    WUZNTX           M3 Supplier Nam
      * T8163 DN  01/16/17 - Set M3 Supplier Group as Producer.
     C                     MOVEL'ZHP'     YL0008           M3 Supplier Gro
      * Sel M3 Suplr Same Div/Grp - M3 Supplier  * 
     C                     CALL 'PLX1SRR'              90  Sel M3 Suplr Sa
     C                     PARM *BLANK    W0RTN   7
     C           #CTICD    PARM #CTICD    WQ0006 10        M3 Supplier ID
     C           WUZNTX    PARM WUZNTX    WQ0007 36        M3 Supplier Nam
     C           WUZOTX    PARM WUZOTX    WQ0008 36        M3 Address Line
     C           WUZPTX    PARM WUZPTX    WQ0009 36        M3 Address Line
     C           WUZQTX    PARM WUZQTX    WQ0010 36        M3 Address Line
     C           WUZ5TX    PARM WUZ5TX    WQ0011 36        M3 Address Line
     C           WUZRTX    PARM WUZRTX    WQ0012 20        M3 City
     C           WUZSTX    PARM WUZSTX    WQ0013  2        M3 State
     C           WUZTTX    PARM WUZTTX    WQ0014 10        M3 Postal Code
     C           WUZVTX    PARM WUZVTX    WQ0015 16        M3 Telephone No
     C           WUZXTX    PARM WUZXTX    WQ0016 16        M3 Telephone No
     C           WUZZTX    PARM WUZZTX    WQ0017 16        M3 Fax Telephon
     C           WUZ0TX    PARM WUZ0TX    WQ0018 15        M3 Supplier Tax
     C           WUZ1TX    PARM WUZ1TX    WQ0019  3        M3 Country Code
     C           YL0008    PARM YL0008    WQ0020  3        M3 Supplier Gro
     C           P4R8CD    PARM P4R8CD    WQ0021  3        M3 Supplier Div
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLX1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * F6=Create
      * CASE: CTL.*CMD key is CF06
     C           *IN06     IFEQ '1'                        *IF
     C                     MOVELWUCRTX    #2ABCD           PD Producer Cod
      * Edt Producer          E1 - Producer  * 
     C                     CALL 'PKDXE1R'              90  Edt Producer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2ABCD    WQ0022  6        PD Producer Cod
     C                     PARM P2EVTX    WQ0023 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDXE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * R10690 JJH 06/07/17 - F8=Dsp Blank Vendor/ALL
      * F8=Dsp Blank Vendor/ALL
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * New.                                           R17061 DN 4/21/21
      * CASE: LCL.Dsp Blank Vendor USR is No
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0001           Dsp Blank Vendo
     C                     MOVEL@CN,002   #CUHTX           Text 25 #1 Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Dsp Blank Vendo
     C                     MOVEL@CN,001   #CUHTX           Text 25 #1 Usr
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * E14322 JJH 01/05/18 - Add F10=WW Producer Trading Partner
      * F10=Edit Producer Trading Partner  (if authorized)
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * New Authority logic
      * CASE: LCL.HPE Edit Authorization is Yes
     C           YL0009    IFEQ 'Y'                        *IF
      * Edt Producer Trade PtnEF - Producer Trading Partner  * 
     C                     CALL 'PLWAEFR'              90  Edt Producer Tr
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLWAEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL'F10'     ZA0001           Text 3 USR
      * Send message 'User not Authorized Fkey'
     C                     MOVEL'PRK1562' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F21=Print List
      * CASE: CTL.*CMD key is Print List
     C           *IN21     IFEQ '1'                        *IF
      * Pmt Print Options     XF - STR Order Management Sys  * 
     C                     CALL 'PDG0PVR'              90  Pmt Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,003   WQ0024 25        PRT Description
     C           P1ACVN    PARM P1ACVN    WQ0025 10        PRT Printer Dev
     C           P1AKST    PARM P1AKST    WQ0026  4        PRT Hold Output
     C           P1AMST    PARM P1AMST    WQ0027  4        PRT Save Output
     C           P1AKNB    PARM P1AKNB    WQ0028  20       PRT Copies
     C           P1ALST    PARM P1ALST    WQ0029  1        PRT Night Queue
     C           P1AIVN    PARM P1AIVN    WQ0030 10        PRT Night Queue
     C                     PARM 'P/S'     WQ0031  6        Oms Application
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVELP1ACVN    ZA0002           PRT Printer Dev
     C                     MOVELP1AKST    ZA0003           PRT Hold Output
     C                     MOVELP1AMST    ZA0004           PRT Save Output
     C                     Z-ADDP1AKNB    ZA0005           PRT Copies
     C                     MOVELP1AIVN    ZA0006           PRT Night Queue
     C                     MOVEL#2AACD    ZA0007           SR Source Code
     C                     MOVEL#2ACCD    ZA0008           HB Buyer Code
     C                     MOVEL#2AJST    ZA0009           RS Record Statu
     C                     MOVELP2EVTX    ZA0010           Oms System Valu
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     993435*
     C                     SETON                     33    *
     C                     END
      *
     C                     END                             *FI
     C                     MOVEL'Y'       WUHJST           Display Print P
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * R17061 DN 04/21/21-Reload When Vendor Changes.
      * New.                                          R17061 DN 04/21/21
      * CASE: CTL.Vendor Number USR NE LCL.Vendor Number USR
     C           #CTICD    IFNE YL0010                     *IF
     C                     MOVEL#CTICD    YL0010           Vendor Number U
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CASE: CTL.Insurance flag USR NE WRK.Insurance flag USR
     C           #COTST    IFNE WUOTST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * E14180 JBB 12/03/2018 - Prompt and select for HPS Automation flag
      * If HPS Automation flag changes value, reload subfile
      * CASE: CTL.HPS Automation Y/N Usr NE LCL.HPS Automation Y/N Usr
     C           #CJTSS    IFNE YL0002                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * S16226 DN 03/02/20-Reload Subfile When Live Repayment Selector Ch
      * CASE: CTL.Live Repayment USR NE LCL.Live Repayment USR
     C           #CL5SS    IFNE YL0011                     *IF
     C                     MOVEL#CL5SS    YL0011           Live Repayment
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     MOVEL'Y'       WUHJST           Display Print P
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * R17061 DN 04/20/21-Changed Opt 2 to Check E1LIVE Flag.
      * 2=Edit                                        R17061 DN 04/23/21
      * CASE: RCD.*SFLSEL is *Revise request
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * If E1LIVE = Y, Then Call PWLXE1R to Display JDE E1 Info.
      * CASE: LCL.JDE Live with E1 USR is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * Edt Producer JDE E1   ER - Producer  * 
     C                     CALL 'PWLXE1R'              90  Edt Producer JD
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0032  6        PD Producer Cod
     C                     PARM P2EVTX    WQ0033 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWLXE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Edt Producer          E1 - Producer  * 
     C                     CALL 'PKDXE1R'              90  Edt Producer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0034  6        PD Producer Cod
     C                     PARM P2EVTX    WQ0035 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDXE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * R17061 DN 04/30/21-Changed Opt 5 to Check E1LIVE Flag.
      * 5=Display
      * CASE: RCD.*SFLSEL is *WW/Display request
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * If E1LIVE = Y, Then Call PWLXE1R to Display JDE E1 Info.
      * CASE: LCL.JDE Live with E1 USR is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * Dsp Producer JDE E1   DR - Producer  * 
     C                     CALL 'PWMOD1R'              90  Dsp Producer JD
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0036  6        PD Producer Cod
     C                     PARM P2EVTX    WQ0037 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWMOD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Dsp Producer          DR - Producer  * 
     C                     CALL 'PKDYD1R'              90  Dsp Producer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0038  6        PD Producer Cod
     C                     PARM P2EVTX    WQ0039 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDYD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * *****************************************************************
      * R10690 JJH 06/14/17 - Temporaily disable 4=Delete
      * *****************************************************************
      * R10690 JJH 06/27/17 - Enable 4=Delete
      * 4=Delete
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Chk Loc for Prdcr dlt RT - Producer Location  * 
     C                     EXSR SERVGN
      * Rtv Prdcr Rels/PrdCnt RT - Producer Contract  * 
     C                     EXSR SFRVGN
      * Rtv Prdcr Rels/VchHdr RT - Hog Voucher Header  * 
     C                     EXSR SGRVGN
      * Rtv Prdcr Rels/Prdcr  RT - Producer  * 
     C                     EXSR SHRVGN
      * Chk Prdcr for Delete  RT - Producer Std Split  * 
     C                     EXSR SIRVGN
      * Rtv Prdcr Rels/CHKSPL RT - Hog Voucher Split  * 
     C                     EXSR SJRVGN
      * Chk PRdcr for delete  RT - Crc Sum Prd          YTD  * 
     C                     EXSR SKRVGN
      * Chg Prdcr for delete  RT - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SLRVGN
      * Chk Prdcr for delete   RT - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SMRVGN
      * Chk Prdcr for delete  RT - Crc Sum Prd Lean Dst YTD  * 
     C                     EXSR SNRVGN
      * Chk Prdcr for delete  RT - Hog Population Rpt Hdr  * 
     C                     EXSR SORVGN
      * Chk Prdcr for delete - Producer History WKLY  * 
     C                     EXSR SPRVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 6=Print
      * CASE: RCD.*SFLSEL is *Print request
     C           #1SEL     IFEQ ' 6'                       *IF
     C           #1SEL     OREQ '6'
      * Print Options Prompt
      * CASE: WRK.Display Print Prompt  Usr is Prompt is to be displayed
     C           WUHJST    IFEQ 'Y'                        *IF
      * Pmt Print Options     XF - STR Order Management Sys  * 
     C                     CALL 'PDG0PVR'              90  Pmt Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,004   WQ0040 25        PRT Description
     C           P1ACVN    PARM P1ACVN    WQ0041 10        PRT Printer Dev
     C           P1AKST    PARM P1AKST    WQ0042  4        PRT Hold Output
     C           P1AMST    PARM P1AMST    WQ0043  4        PRT Save Output
     C           P1AKNB    PARM P1AKNB    WQ0044  20       PRT Copies
     C           P1ALST    PARM P1ALST    WQ0045  1        PRT Night Queue
     C           P1AIVN    PARM P1AIVN    WQ0046 10        PRT Night Queue
     C                     PARM 'P/S'     WQ0047  6        Oms Application
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'N'       WUHJST           Display Print P
     C                     END                             *FI
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVELP1ACVN    ZA0011           PRT Printer Dev
     C                     MOVELP1AKST    ZA0012           PRT Hold Output
     C                     MOVELP1AMST    ZA0013           PRT Save Output
     C                     Z-ADDP1AKNB    ZA0014           PRT Copies
     C                     MOVELP1AIVN    ZA0015           PRT Night Queue
     C                     MOVEL#1ABCD    ZA0016           PD Producer Cod
     C                     MOVELP2EVTX    ZA0017           Oms System Valu
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0307' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     98    *
     C                     END
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * 7=WW Producer Location
      * CASE: RCD.*SFLSEL is *Option 7 request
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * WW Prdctn Location    DF - Producer Location  * 
     C                     CLEARPARC
     C                     MOVEL#1ABCD    PAABCD    P      PD Producer Cod
      *
     C                     CALL 'PKGTDFR'              90  WW Prdctn Locat
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Producer L
     C                     PARM P2EVTX    WQ0048 40        Oms System Valu
     C                     PARM YL0007    WQ0049  30       CC Company Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 8=WW Producer Subsidary
      * CASE: RCD.*SFLSEL is *Option 8 request
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * WW ProdSubsidiary     DF - Producer Subsidiary  * 
     C                     CLEARPBRC
     C                     MOVEL#1ABCD    PBABCD    P      PD Producer Cod
      *
     C                     CALL 'PLM0DFR'              90  WW ProdSubsidia
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Producer S
     C                     PARM P2EVTX    WQ0050 40        Oms System Valu
     C                     PARM #1AGTX    WQ0051 40        @Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLM0DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 9=Edit Producer Comments
      * CASE: RCD.*SFLSEL is *option 9 request
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Edt Producer Comment  EF - Producer Comment  * 
     C                     CALL 'PKD7EFR'              90  Edt Producer Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0052  6        PD Producer Cod
     C                     PARM #1AGTX    WQ0053 40        PD Name
     C                     PARM #1GCNB    WQ0054  80       PD VND Address
     C                     PARM #1GJNB    WQ0055  80       PD EDI Trading
     C                     PARM #RAITX    WQ0056 40        Producer Addres
     C                     PARM #RAJTX    WQ0057 40        Producer Addres
     C                     PARM #RAKTX    WQ0058 40        Producer City
     C                     PARM #RANST    WQ0059  3        Producer State
     C                     PARM #RCJTX    WQ0060 12        Producer Zip 10
     C                     PARM #RC9TX    WQ0061  6        Producer Area C
     C                     PARM #RDATX    WQ0062 20        Producer Phone
     C                     PARM P2EVTX    WQ0063 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD7EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 10=Edit Producer Split
      * CASE: RCD.*SFLSEL is *Option 10 (Reusable)
     C           #1SEL     IFEQ '10'                       *IF
      * Edt Prod/Prod Split   ET - Producer  * 
     C                     CLEARPCRC
     C                     MOVEL#1ABCD    PCABCD    P      PD Producer Cod
      *
     C                     CALL 'PKFOETR'              90  Edt Prod/Prod S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Producer
     C                     PARM P2EUTX    WQ0064 30        Oms Name
     C                     PARM P2EVTX    WQ0065 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKFOETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * *****************************************************************
      * 12=Edit Producer D/A
      * CASE: RCD.*SFLSEL is *Option 12 (Reusable)
     C           #1SEL     IFEQ '12'                       *IF
     C                     Z-ADDYL0007    YL0012           PSDP Company Nu
      * Change pgm to pass 1st company and 2 co can be loaded inside
      * Edt Producer D/A      EF - Producer Std D/A  * 
     C                     CLEARPDRC
     C                     MOVEL#1ABCD    PDABCD    P      PD Producer Cod
     C                     Z-ADDYL0012    PDZCA1           PSDP Company Nu
      *
     C                     CALL 'PKD1EFR'              90  Edt Producer D/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Producer S
     C                     PARM P2EVTX    WQ0066 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD1EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * *****************************************************************
      * 13=Web Access
      * CASE: RCD.*SFLSEL is *Option 13 (Reusable)
     C           #1SEL     IFEQ '13'                       *IF
      * Edt Web Access        ER - Producer EXT  * 
     C                     CLEARPERC
     C                     MOVEL#1ABCD    PEABCD    P      PD Producer Cod
      *
     C                     CALL 'PLD1E1R'              90  Edt Web Access
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Producer E
     C                     PARM #1AGTX    WQ0067 40        PD Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLD1E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * E11445 JJH 08/10/17 - Pass in SR Source Code to WW Producer Site
      * 14=Work With Sites
      * CASE: RCD.*SFLSEL is *Option 14 (Resuable)
     C           #1SEL     IFEQ '14'                       *IF
      * WW Producer Site      DF - Producer Site  * 
     C                     CLEARPFRC
     C                     MOVEL#1ABCD    PFABCD    P      PD Producer Cod
      *
     C                     CALL 'PLGNDFR'              90  WW Producer Sit
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Producer S
     C                     PARM P2EVTX    WQ0068 40        Oms System Valu
     C                     PARM #1AACD    WQ0069  3        SR Source Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLGNDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 15=Assign Payee
      * CASE: RCD.*SFLSEL is *Option 15 (Resuable)
     C           #1SEL     IFEQ '15'                       *IF
      * Edt Alt Prod Payee    ER - Producer EXT  * 
     C                     CALL 'PLO5E1R'              90  Edt Alt Prod Pa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0070  6        PD Producer Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLO5E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 16=Dsp Alt Producer Payee
      * CASE: RCD.*SFLSEL is *Option 16 (Reusable)
     C           #1SEL     IFEQ '16'                       *IF
      * Dsp Alt Prod Payee    DF - Producer EXT  * 
     C                     CLEARPGRC
     C                     MOVEL#1ABCD    PGPBCD    P      Alt Producer Pa
      *
     C                     CALL 'PLO6DFR'              90  Dsp Alt Prod Pa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             KEY: Producer E
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLO6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 17=Edt TF Prod/STF Prod
      * CASE: RCD.*SFLSEL is *Option 17 (Resuable)
     C           #1SEL     IFEQ '17'                       *IF
      * CASE: WRK.XrefPlanttoPlant  usr is Plant is allowed "From"
     C           WUI1SS    IFEQ 'FROM'                     *IF
      * Edt Producer Sent To  EF - Producer Location From/TO  * 
     C                     CALL 'PWB7EFR'              90  Edt Producer Se
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWB7EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: WRK.XrefPlanttoPlant  usr is Plant is allowed "To"
     C           WUI1SS    IFEQ 'TO'                       *IF
      * Dsp Producer Sent To  DF - Producer Location From/TO  * 
     C                     CALL 'PWB8DFR'              90  Dsp Producer Se
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWB8DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 18=Edit Producer Ext
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,005                    *IF
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
     C           ##USR     OREQ @CN,028
     C           ##USR     OREQ @CN,029
     C           ##USR     OREQ @CN,030
      * 18=Producer Configurations
      * CASE: RCD.*SFLSEL is *Option 18
     C           #1SEL     IFEQ '18'                       *IF
      * Edt Producer SelCnfg  ER - Producer EXT  * 
     C                     CLEARPHRC
     C                     MOVEL#1ABCD    PHABCD    P      PD Producer Cod
      *
     C                     CALL 'PWFEE1R'              90  Edt Producer Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PHRC             KEY: Producer E
     C                     PARM #1AGTX    WQ0071 40        PD Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWFEE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * E14322 JJH 01/04/19 - Add option to all IT to update EDI Trading
      * 20=Edit EDI Trading #  (if authorized)
      * CASE: RCD.*SFLSEL is *Option 20
     C           #1SEL     IFEQ '20'                       *IF
      * New Authority logic for option 20
      * CASE: LCL.HPE Edit Authorization is Yes
     C           YL0009    IFEQ 'Y'                        *IF
      * Edt Producer EDI #    E1 - Producer  * 
     C                     CALL 'PWHZE1R'              90  Edt Producer ED
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0072  6        PD Producer Cod
     C                     PARM #PEVTX    WQ0073 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWHZE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0018           *SFLSEL
      * Send message 'User Not Authorized &Opt'
     C                     MOVEL'PRK1563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * E14322 JJH 01/04/19 - Add option to Create Object Links for Brick
      * 21=Edit EDI Trading #  (if authorized)
      * CASE: RCD.*SFLSEL is *Option 21
     C           #1SEL     IFEQ '21'                       *IF
      * New Authority logic for option 21
      * CASE: LCL.HPE Edit Authorization is Yes
     C           YL0009    IFEQ 'Y'                        *IF
      * Create object link for BrickFTP
      * CASE: RCD.PD EDI Trading Partner # is Zero
     C           #1GJNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#1GJNB    ZA0019           PD EDI Trading
      * Send message 'No EDI Trading Partner'
     C                     MOVEL'PRK1522' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Add Leading 0 to 5-digit PD EDI Trading Partner #
     C                     Z-ADD#1GJNB    YL0013           PD EDI Trading
     C                     MOVEL*BLANK    YL0014           PD EDI Trade Pt
     C                     MOVELYL0013    YL0014           PD EDI Trade Pt
     C                     Z-ADD*ZEROS    ZQ      50
     C           '0'       CAT  YL0014:ZQ YL0015    P      PD EDI Trade Pt
      * Ext Obj Link BrickFTP XF - Producer  * 
     C                     CALL 'PWH7XFR'              90  Ext Obj Link Br
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0015    WQ0074  6        PD EDI Trade Pt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWH7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0020           *SFLSEL
      * Send message 'User Not Authorized &Opt'
     C                     MOVEL'PRK1563' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
      * Force PUTOVR
     C                     SETON                     86
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Susan Blakey * out to allow move to production
      * do not allow user to delete producer until 7/9/2017 is installed
      * Rtv/Dlt Producer D/A  RT - Producer Std D/A  * 
     C                     EXSR SQRVGN
      * Dlt Producer          DO - Producer  * 
     C                     EXSR SSDLRC
      * R10690 JJH 06/07/17 - Delete Producer Address
      * Dlt Producer Address  DR - Producer Address  * 
     C                     EXSR SVDLRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           WUI1SS    IFEQ 'NO'                       *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0016    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @ACREAI fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDACGCNB    #1GCNB           PD VND Address
     C                     Z-ADDACALNB    #1ALNB           PD Production C
     C                     Z-ADDACAATH    #1AATH           PD Std Delv Tim
     C                     Z-ADDACAMNB    #1AMNB           PD Std Truck Si
     C                     MOVELACAPST    #1APST           PD Fax Status
     C                     MOVELACC2TX    #1C2TX           PD VND Category
     C                     MOVELACADCD    #1ADCD           Commission Prod
     C                     MOVELACAAVN    #1AAVN           RS User Changed
     C                     Z-ADDACAADT    #1AADT           RS Date Changed
     C                     Z-ADDACAMTM    #1AMTM           RS Time Changed
     C                     MOVELACAHVN    #1AHVN           RS Job
     C                     MOVELACAGVN    #1AGVN           RS Program
     C                     MOVELACABVN    #1ABVN           RS User Added
     C                     Z-ADDACABDT    #1ABDT           RS Date Added
     C                     Z-ADDACABTM    #1ABTM           RS Time Added
     C                     MOVELACABCD    #1ABCD           PD Producer Cod
     C                     MOVELACAGTX    #1AGTX           PD Name
     C                     MOVELACAJST    #1AJST           RS Record Statu
     C                     MOVELACAACD    #1AACD           SR Source Code
     C                     MOVELACACCD    #1ACCD           HB Buyer Code
     C                     MOVELACIWST    #1IWST           PD Freight Exp
     C                     Z-ADDACGJNB    #1GJNB           PD EDI Trading
     C                     MOVEL*BLANK    #RQHCD           M3 Supplier ID
     C                     MOVEL*BLANK    #RMLCD           HPS Automation
     C                     MOVEL*BLANK    #RAJTX           Producer Addres
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #ROTST           Insurance flag
     C                     MOVEL*BLANK    #RDFSS           Subsidiary Flag
     C                     MOVEL*BLANK    #RTICD           Vendor Number U
     C                     MOVEL*BLANK    #RJTSS           HPS Automation
     C                     MOVEL*BLANK    #RL5SS           Live Repayment
     C                     MOVEL*BLANK    #RAITX           Producer Addres
     C                     MOVEL*BLANK    #RC9TX           Producer Area C
     C                     MOVEL*BLANK    #RDATX           Producer Phone
     C                     MOVEL*BLANK    #RAKTX           Producer City
     C                     MOVEL*BLANK    #RANST           Producer State
     C                     MOVEL*BLANK    #RCJTX           Producer Zip 10
     C                     MOVEL*BLANK    #REZCD           Country Code Us
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP1ETTX    #PETTX           PRT Description
     C                     MOVELP1ACVN    #PACVN           PRT Printer Dev
     C                     MOVELP1AKST    #PAKST           PRT Hold Output
     C                     MOVELP1AMST    #PAMST           PRT Save Output
     C                     Z-ADDP1AKNB    #PAKNB           PRT Copies
     C                     MOVELP1ALST    #PALST           PRT Night Queue
     C                     MOVELP1AIVN    #PAIVN           PRT Night Queue
     C                     MOVELP1C7CD    #PC7CD           Oms Application
     C                     MOVELP2J8NB    #PJ8NB           Oms Warehouse C
     C                     Z-ADDP2HONB    #PHONB           CC Company Numb
     C                     MOVELP2C8CD    #PC8CD           Oms SalesPerson
     C                     MOVELP2G8ST    #PG8ST           Oms Allow Multi
     C                     MOVELP2G9ST    #PG9ST           Oms Default Pri
     C                     MOVELP2EUTX    #PEUTX           Oms Name
     C                     MOVELP2EVTX    #PEVTX           Oms System Valu
     C                     MOVELP2HAST    #PHAST           Oms Access Deni
     C                     Z-ADD*ZERO     #2GJNB           PD EDI Trading
     C                     Z-ADD*ZERO     #2GCNB           PD VND Address
     C                     MOVEL*BLANK    #CQHCD           M3 Supplier ID
     C                     MOVEL*BLANK    #CMLCD           HPS Automation
     C                     MOVEL*BLANK    #CUHTX           Text 25 #1 Usr
     C                     MOVEL*BLANK    #CHDT1           JDE/M3 Prefix U
     C                     MOVEL*BLANK    #2ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #2AGTX           PD Name
     C                     MOVEL*BLANK    #2AJST           RS Record Statu
     C                     MOVEL*BLANK    #2AACD           SR Source Code
     C                     MOVEL*BLANK    #2ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #2IWST           PD Freight Exp
     C                     MOVEL*BLANK    #COTST           Insurance flag
     C                     MOVEL*BLANK    #CDFSS           Subsidiary Flag
     C                     MOVEL*BLANK    #CTICD           Vendor Number U
     C                     MOVEL*BLANK    #CJTSS           HPS Automation
     C                     MOVEL*BLANK    #CL5SS           Live Repayment
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv HPS Auto/Live Repy RT - Producer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #RMLCD           HPS Automation
     C                     MOVEL*BLANK    #RL5SS           Live Repayment
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AOABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    AOABCD           PD Producer Cod
      * Establish starting position
     C           KRSSA     CHAIN@AOREKK              90    *
      * Data record not found
     C   90                MOVEL'PRK1097' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAOMLCD    #RMLCD           HPS Automation
     C                     MOVELAOMMCD    #RL5SS           Live Repayment
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSSB     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RQHCD           M3 Supplier ID
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    #RQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Producer Address  RT - Producer Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           AGABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    AGABCD           PD Producer Cod
      * Establish starting position
     C           KRSSC     CHAIN@AGREXQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1440' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RAITX           Address 1
     C                     MOVEL*BLANK    #RAJTX           Address 2
     C                     MOVEL*BLANK    #RAKTX           City
     C                     MOVEL*BLANK    #RANST           State
     C                     MOVEL*BLANK    #RCJTX           Zip
     C                     MOVEL*BLANK    #RC9TX           Area Code
     C                     MOVEL*BLANK    #RDATX           Telephone
     C                     MOVEL*BLANK    #REZCD           Country Code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAGDNTX    #RAITX           Address 1
     C                     MOVELAGDOTX    #RAJTX           Address 2
     C                     MOVELAGDQTX    #RAKTX           City
     C                     MOVELAGDRTX    #RANST           State
     C                     MOVELAGDSTX    #RCJTX           Zip
     C                     MOVELAGDTTX    #RC9TX           Area Code
     C                     MOVELAGDUTX    #RDATX           Telephone
     C                     MOVELAGE0CD    #REZCD           Country Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Prodsubsidiary    RT - Producer Subsidiary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       #RDFSS           Subsidiary Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN A8ABCD    WQSD01           PD Producer Cod
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSD01           PD Producer Cod
      * Establish starting position
     C           KRSSD     SETLL@A8REPM                    *
     C           KRSSD     READE@A8REPM                  90*
      * Data record not found
     C   90                MOVEL'PRK1213' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       #RDFSS           Subsidiary Flag
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@A8REPM                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Chk Loc for Prdcr dlt RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFABCD    WQSE01           PD Producer Cod
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSE01           PD Producer Cod
      * Establish starting position
     C           KRSSE     SETLL@AFREAR                    *
     C           KRSSE     READE@AFREAR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Prdcr location exists.'
     C                     MOVEL'PRK0548' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@AFREAR                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Rels/PrdCnt RT - Producer Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN APABCD    WQSF01           PD Producer Cod
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSF01           PD Producer Cod
      * Establish starting position
     C           KRSSF     SETLL@APCPKL                    *
     C           KRSSF     READE@APCPKL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0035' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Prdcr Contract exists.'
     C                     MOVEL'PRK0549' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@APCPKL                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Rels/VchHdr RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKABCD    WQSG01           PD Producer Cod
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSG01           PD Producer Cod
      * Establish starting position
     C           KRSSG     SETLL@BKCPKO                    *
     C           KRSSG     READE@BKCPKO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Voucher exists.'
     C                     MOVEL'PRK0550' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@BKCPKO                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Rels/Prdcr  RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAADCD    WQSH01           Commission Prod
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Commission Prod
      * Setup key
     C                     MOVEL#1ABCD    WQSH01           Commission Prod
      * Establish starting position
     C           KRSSH     SETLL@ACREKJ                    *
     C           KRSSH     READE@ACREKJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@ACREKJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Chk Prdcr for Delete  RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BFBTCD    WQSI01           BOS Split Produ
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOS Split Produ
      * Setup key
     C                     MOVEL#1ABCD    WQSI01           BOS Split Produ
      * Establish starting position
     C           KRSSI     SETLL@BFRESO                    *
     C           KRSSI     READE@BFRESO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Producer split exists.'
     C                     MOVEL'PRK0552' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BFRESO                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Rels/CHKSPL RT - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CABTCD    WQSJ01           BOS Split Produ
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOS Split Produ
      * Setup key
     C                     MOVEL#1ABCD    WQSJ01           BOS Split Produ
      * Establish starting position
     C           KRSSJ     SETLL@CACPKI                    *
     C           KRSSJ     READE@CACPKI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0168' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Voucher split exists.'
     C                     MOVEL'PRK0551' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@CACPKI                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Chk PRdcr for delete  RT - Crc Sum Prd          YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CZABCD    WQSK01           PD Producer Cod
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSK01           PD Producer Cod
      * Establish starting position
     C           KRSSK     SETLL@CZCPSP                    *
     C           KRSSK     READE@CZCPSP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0424' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Crc Sum Prd exists'
     C                     MOVEL'PRK0553' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@CZCPSP                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Chg Prdcr for delete  RT - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN C2ABCD    WQSL01           PD Producer Cod
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSL01           PD Producer Cod
      * Establish starting position
     C           KRSSL     SETLL@C2CPSQ                    *
     C           KRSSL     READE@C2CPSQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0430' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Send message 'Crc Sum Prd exists'
     C                     MOVEL'PRK0553' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@C2CPSQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Chk Prdcr for delete   RT - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN C5ABCD    WQSM01           PD Producer Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSM01           PD Producer Cod
      * Establish starting position
     C           KRSSM     SETLL@C5CPSR                    *
     C           KRSSM     READE@C5CPSR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0444' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Send message 'Crc Sum Prd exists'
     C                     MOVEL'PRK0553' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@C5CPSR                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Chk Prdcr for delete  RT - Crc Sum Prd Lean Dst YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN C0ABCD    WQSN01           PD Producer Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSN01           PD Producer Cod
      * Establish starting position
     C           KRSSN     SETLL@C0CPSS                    *
     C           KRSSN     READE@C0CPSS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0426' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Crc Sum Prd exists'
     C                     MOVEL'PRK0553' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@C0CPSS                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Chk Prdcr for delete  RT - Hog Population Rpt Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DAABCD    WQSO01           PD Producer Cod
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSO01           PD Producer Cod
      * Establish starting position
     C           KRSSO     SETLL@DACPST                    *
     C           KRSSO     READE@DACPST                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0478' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Hog Pop Rpt Hdr exists'
     C                     MOVEL'PRK0527' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@DACPST                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Chk Prdcr for delete - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CGABCD    WQSP01           PD Producer Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSP01           PD Producer Cod
      * Establish starting position
     C           KRSSP     SETLL@CGCPSU                    *
     C           KRSSP     READE@CGCPSU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
      * Send message 'Prdcr History exists'
     C                     MOVEL'PRK0554' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@CGCPSU                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Producer D/A  RT - Producer Std D/A  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEABCD    WQSQ01           PD Producer Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQSQ01           PD Producer Cod
      * Establish starting position
     C           KRSSQ     SETLL@BEREEY                    *
     C           KRSSQ     READE@BEREEY                  90*
      * Data record not found
     C   90                MOVEL'PRK0087' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Producer D/A      DO - Producer Std D/A  * 
     C                     EXSR SRDLRC
     C           KRSSQ     READE@BEREEY                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRDLRC    BEGSR
      *================================================================
      * Dlt Producer D/A      DO - Producer Std D/A  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BEREEX
     C                     MOVELBEABCD    WBABCD           PD Producer Cod
     C                     Z-ADDBEZCA1    WBZCA1           PSDP Company Nu
     C                     MOVELBEBQCD    WBBQCD           DED D/A Code
      *
     C           KLDLSR    KLIST
     C                     KFLD           WBABCD           PD Producer Cod
     C                     KFLD           WBZCA1           PSDP Company Nu
     C                     KFLD           WBBQCD           DED D/A Code
     C           KLDLSR    CHAIN@BEREEX              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBEREL0'MDACP
     C                     MOVEL'@BEREEX' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BEREEX                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSDLRC    BEGSR
      *================================================================
      * Dlt Producer          DO - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data update
      * Rtv/Dlt Prod Comment  RT - Producer Comment  * 
     C                     EXSR STRVGN
      * Move key fields to @ACREAB
     C                     MOVEL#1ABCD    WCABCD           PD Producer Cod
      *
     C           KLDLSS    KLIST
     C                     KFLD           WCABCD           PD Producer Cod
     C           KLDLSS    CHAIN@ACREAB              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKACREL0'MDACP
     C                     MOVEL'@ACREAB' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@ACREAB                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Prod Comment  RT - Producer Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AEABCD    WQST01           PD Producer Cod
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WQST01           PD Producer Cod
      * Establish starting position
     C           KRSST     SETLL@AERECU                    *
     C           KRSST     READE@AERECU                  90*
      * Data record not found
     C   90                MOVEL'PRK0013' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Producer Comment - Producer Comment  * 
     C                     EXSR SUDLRC
     C           KRSST     READE@AERECU                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUDLRC    BEGSR
      *================================================================
      * Delete Producer Comment - Producer Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AERECT
     C                     MOVELAEABCD    WDABCD           PD Producer Cod
     C                     Z-ADDAEAPNB    WDAPNB           PDC Comment Lin
      *
     C           KLDLSU    KLIST
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDAPNB           PDC Comment Lin
     C           KLDLSU    CHAIN@AERECT              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAEREL0'MDACP
     C                     MOVEL'@AERECT' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AERECT                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVDLRC    BEGSR
      *================================================================
      * Dlt Producer Address  DR - Producer Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AGREXP
     C                     MOVEL#1ABCD    WEABCD           PD Producer Cod
      *
     C           KLDLSV    KLIST
     C                     KFLD           WEABCD           PD Producer Cod
     C           KLDLSV    CHAIN@AGREXP              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PWAGREL0'MDACP
     C                     MOVEL'@AGREXP' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AGREXP                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03072
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  12        W0CSRR  50
     C                     DIV  04        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  12        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD12        ZHSTRW  40
     C                     Z-ADD22        ZHNDRW  40
     C                     Z-ADD4         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ055
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2AJST'  YPMTFD           RS Record Statu
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ069
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2IWST'  YPMTFD           PD Freight Exp
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ073
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#COTST'  YPMTFD           Insurance flag
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ077
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CDFSS'  YPMTFD           Subsidiary Flag
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ099
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CJTSS'  YPMTFD           HPS Automation
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ111
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CL5SS'  YPMTFD           Live Repayment
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PKDTDFRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1ETTX           PRT Description
     C                     MOVEL*BLANK    P1ACVN           PRT Printer Dev
     C                     MOVEL*BLANK    P1AKST           PRT Hold Output
     C                     MOVEL*BLANK    P1AMST           PRT Save Output
     C                     Z-ADD*ZERO     P1AKNB           PRT Copies
     C                     MOVEL*BLANK    P1ALST           PRT Night Queue
     C                     MOVEL*BLANK    P1AIVN           PRT Night Queue
     C                     MOVEL*BLANK    P1C7CD           Oms Application
     C                     MOVEL*BLANK    P2J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P2HONB           CC Company Numb
     C                     MOVEL*BLANK    P2C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P2G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P2G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P2EUTX           Oms Name
     C                     MOVEL*BLANK    P2EVTX           Oms System Valu
     C                     MOVEL*BLANK    P2HAST           Oms Access Deni
     C                     MOVEL*BLANK    P3G4SS           Live with M3
     C                     MOVEL*BLANK    P4R8CD           M3 Supplier Div
     C                     MOVEL*BLANK    P5TICD           Vendor Number U
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Display Print Prompt  Usr
     C                     MOVEL*BLANK    WUHJST  1
      * Define work field Insurance flag USR
     C                     MOVEL*BLANK    WUOTST  1
      * Define work field Subsidiary Flag Usr
     C                     MOVEL*BLANK    WUDFSS  1
      * Define work field M3 Supplier Name
     C                     MOVEL*BLANK    WUZNTX 36
      * Define work field M3 Address Line 1
     C                     MOVEL*BLANK    WUZOTX 36
      * Define work field M3 Address Line 2
     C                     MOVEL*BLANK    WUZPTX 36
      * Define work field M3 Address Line 3
     C                     MOVEL*BLANK    WUZQTX 36
      * Define work field M3 Address Line 4
     C                     MOVEL*BLANK    WUZ5TX 36
      * Define work field M3 City
     C                     MOVEL*BLANK    WUZRTX 20
      * Define work field M3 State
     C                     MOVEL*BLANK    WUZSTX  2
      * Define work field M3 Postal Code
     C                     MOVEL*BLANK    WUZTTX 10
      * Define work field M3 Telephone No 1
     C                     MOVEL*BLANK    WUZVTX 16
      * Define work field M3 Telephone No 2
     C                     MOVEL*BLANK    WUZXTX 16
      * Define work field M3 Fax Telephone
     C                     MOVEL*BLANK    WUZZTX 16
      * Define work field M3 Supplier Tax ID
     C                     MOVEL*BLANK    WUZ0TX 15
      * Define work field M3 Country Code
     C                     MOVEL*BLANK    WUZ1TX  3
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAALNB           PD Production C
     C                     Z-ADD*ZERO     WAAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WAAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WAGCNB           PD VND Address
     C                     Z-ADD*ZERO     WAGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field XrefPlanttoPlant  usr
     C                     MOVEL*BLANK    WUI1SS 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBZCA1           PSDP Company Nu
     C                     Z-ADD*ZERO     WBA1VA           PSD Variable Am
     C                     Z-ADD*ZERO     WBC0DT           PSD Accept Date
     C                     Z-ADD*ZERO     WBC1DT           PSD Decline Dat
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAPNB           PDC Comment Lin
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEIKNB           Address Number
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field Dsp Blank Vendor USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field HPS Automation Y/N Usr
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field JDE Live with E1 USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Text Usr 1
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field For Length USR
     C                     Z-ADD*ZERO     YL0006  50
      * Define null work field Address Number
     C                     Z-ADD*ZERO     YN0001  80
      * Define null work field Pass Name
     C                     MOVEL*BLANK    YN0002 40
      * Define null work field Address 3
     C                     MOVEL*BLANK    YN0003 40
      * Define null work field Fax Area Code #
     C                     MOVEL*BLANK    YN0004  6
      * Define null work field Fax Telephone
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Fax Attn 1
     C                     MOVEL*BLANK    YN0006 40
      * Define null work field Fax Area Code # 2
     C                     MOVEL*BLANK    YN0007  6
      * Define null work field Fax Telephone 2
     C                     MOVEL*BLANK    YN0008 20
      * Define null work field Fax Attn 2
     C                     MOVEL*BLANK    YN0009 40
      * Define null work field Vendor 1099
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Vendor Tax Id.
     C                     MOVEL*BLANK    YN0011 16
      * Define local work field CC Company Number
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field M3 Supplier Group
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field HPE Edit Authorization
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Vendor Number USR
     C                     MOVEL*BLANK    YL0010 10
      * Define local work field Live Repayment USR
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field PSDP Company Number
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field PD EDI Trading Partner #5
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field PD EDI Trade Ptn Alpha5
     C                     MOVEL*BLANK    YL0014  5
      * Define local work field PD EDI Trade Ptn Alpha6
     C                     MOVEL*BLANK    YL0015  6
      * Define local work field F10=Display Emails
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Return Code USR
     C                     MOVEL*BLANK    YL0017  7
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD03        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * HPE048
      * Nppc by Origin State Report
      * Val Application/User  IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P2J8NB    PARM *BLANK    WQ0075  3        Oms Warehouse C
     C           YL0007    PARM *ZERO     WQ0076  30       CC Company Numb
     C                     PARM 'HPE'     WQ0077  6        Oms Application
     C           P2C8CD    PARM *BLANK    WQ0078  3        Oms SalesPerson
     C           P2G8ST    PARM *BLANK    WQ0079  1        Oms Allow Multi
     C           P2G9ST    PARM *BLANK    WQ0080 10        Oms Default Pri
     C           P2EUTX    PARM *BLANK    WQ0081 30        Oms Name
     C           P2EVTX    PARM *BLANK    WQ0082 40        Oms System Valu
     C           P2HAST    PARM *BLANK    WQ0083  1        Oms Access Deni
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
     C                     END                             *FI
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL'N'       P1ALST           PRT Night Queue
      * E10370 slm 6/08/17 - Cross Reference of the two plants
      * TF will use this and STF will display this and Guy will not use
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0007    WQ0084  30       BOH Company Num
     C                     PARM @CN,031   WQ0085 10        Company Value C
     C           WUI1SS    PARM *BLANK    WQ0086 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E3580 CGL 11/11/14 - M3 Vendor interfaces changes
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0007    WQ0087  30       BOH Company Num
     C                     PARM @CN,032   WQ0088 10        Company Value C
     C           P3G4SS    PARM *BLANK    WQ0089 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * T8163 DN  01/16/17 - Get M3 Division #.
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0007    WQ0090  30       BOH Company Num
     C                     PARM @CN,033   WQ0091 10        Company Value C
     C           P4R8CD    PARM *BLANK    WQ0092 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * R17061 DN 04/20/21 - Get JDE 'E1LIVE' Flag.
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0007    WQ0093  30       BOH Company Num
     C                     PARM 'E1LIVE'  WQ0094 10        Company Value C
     C           YL0003    PARM *BLANK    WQ0095 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 12/14/2020 JBB WHD72204 - Need access to addl options WW Producer
      * Ext Appl Allowed      XF - STR Order Management Sys  * HPEEDT
     C                     CALL 'PUJWXFR'              90  Ext Appl Allowe
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0096 10        User Profile Na
     C                     PARM 'HPEEDT'  WQ0097  6        Application Cod
     C           YL0017    PARM *BLANK    WQ0098  7        Return Code USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUJWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set Authorization Y/N Flag based on return code
      * CASE: LCL.Return Code USR is *Normal
     C           YL0017    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0009           HPE Edit Author
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0009           HPE Edit Author
     C                     END                             *FI
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01615023860282102829028710287402879
02885028890289302898029150292703074
03077030850312703130031350314103145
03149031540317103183033410338203386
0359703628036320364503656
** W0END
01639023880282602868028710287602881
02885028890289302907029150292703075
03082031240312703132031370314103145
03149031630317103183033800338403405
0362603630036430364703663
** W0NAM
#CUHTX    #CHDT1    #2ABCD    #2AGTX    #2AJST    #2AACD    #2ACCD
#2IWST    #COTST    #CDFSS    #CTICD    #CJTSS    #CL5SS    #1SEL
#1ABCD    #1AGTX    #1AJST    #1AACD    #1ACCD    #1IWST    #ROTST
#RDFSS    #RTICD    #RJTSS    #RL5SS    #RAITX    #RC9TX    #RDATX
#RAKTX    #RANST    #RCJTX    #REZCD    #1GJNB
** @CN
00001 **ALL Vendor**
00002 **Blank Vendor**
00003 Print Producer List
00004 Print Producer
00005 PRKTEST
00006 ISPPATE
00007 ISSMASO
00008 ISRCENT
00009 ISPURVAP
00010 ISROSEM
00011 ISSHARONZ
00012 ISSZURN
00013 ISJHIGH
00014 ISJBADE
00015 ISJAMESB
00016 ISDNGUY
00017 ISDANNYN
00018 PRKTESTGU
00019 PRKTESTST
00020 PRKTESTTF
00021 TPMTEST
00022 TFTST961
00023 ISSUSANM
00024 ISJULIUSH
00025 ISBGUTI
00026 ISBARBG
00027 ISBBARK
00028 ISNFOY
00029 ISNATHANF
00030 ISDREDD
00031 HPEXREFPLT
00032 M3VEND
00033 M3HPEDIV
