// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDS7XFR
// ?Date: 14.08.2025 Time: 03:36:03
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Documentation
DO;

//?PIO  AB  10/28/2024  OPBFCPM6 is now converted to Index, use OPNSQLF
ENDDO;

//?1. Convert Parameters to Numeric.
DO;

// PAR.From Date             USR = CVTVAR(PAR.From Date (alpha)     USR)
PAR.From_Date_USR = CVTVAR(PAR.From_Date_alpha_USR);

// PAR.To Date               USR = CVTVAR(PAR.To Date (alpha)       USR)
PAR.To_Date_USR = CVTVAR(PAR.To_Date_alpha_USR);

ENDDO;

//?2. Override Printer File.
DO;

// PAR.Nbr of Copies-Alpha   USR = CVTVAR(PAR.PRT Number of Copies)
PAR.Nbr_of_Copies_Alpha_USR = CVTVAR(PAR.PRT_Number_of_Copies);

// Call program EXC Command SBDOVR     UP.
CALL PROGRAM(EXC Command SBDOVR     UP) ('PDPOUPR');
PARAMETER('PDS8PFR$');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.Nbr_of_Copies_Alpha_USR);

ENDDO;

//?3. Build Open Query File.
DO;

//?Export Status = 'Y'.
DO;

//?BEU2ST *EQ 'Y'
// PAR.QRYSLT USR = CON.BEU2ST
PAR.QRYSLT_USR = 'BEU2ST';

//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. =,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' =' (1);

// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.'Y',CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ''Y'' (1);

ENDDO;

//?Header Status = 'A','E','H','L',or'R'.
DO;

//?*AND (
//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. AND,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' AND' (1);

// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CND.(,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + '(' (1);

//?BEGWST *EQ 'A'
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.BEGWST,CND.*None)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + 'BEGWST' (*ZERO);

//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. =,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' =' (1);

// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.'A',CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ''A'' (1);

//?*OR
//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. OR,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' OR' (1);

//?BEGWST *EQ 'E'
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.BEGWST,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + 'BEGWST' (1);

//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. =,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' =' (1);

// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.'E',CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ''E'' (1);

//?*OR
//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. OR,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' OR' (1);

//?BEGWST *EQ 'H'
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.BEGWST,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + 'BEGWST' (1);

//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. =,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' =' (1);

// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.'H',CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ''H'' (1);

//?*OR
//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. OR,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' OR' (1);

//?BEGWST *EQ 'L'
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.BEGWST,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + 'BEGWST' (1);

//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. =,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' =' (1);

// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.'L',CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ''L'' (1);

//?*OR
//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. OR,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' OR' (1);

//?BEGWST *EQ 'R'
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.BEGWST,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + 'BEGWST' (1);

//?OMS001  AB  Change OPNQRYF processing to OPNSQLF for DDL Index
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON. =,CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ' =' (1);

// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CON.'R',CND.*One)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ''R'' (1);

//?)
// PAR.QRYSLT USR = CONCAT(PAR.QRYSLT USR,CND.),CND.*None)
PAR.QRYSLT_USR = PAR.QRYSLT_USR + ')' (*ZERO);

ENDDO;

// Call program EXC Command OPNQRYF    UP.
CALL PROGRAM(EXC Command OPNQRYF    UP) ('PDS9UPR');
PARAMETER('OPBFCPM6');
PARAMETER(PAR.QRYSLT_USR);

ENDDO;

//?4. Print Report.
DO;

// Call program PRT Export Odr by Cust PF.
CALL PROGRAM(PRT Export Odr by Cust PF) ('PDS8PFR');
PARAMETER(PAR.From_Date_USR);
PARAMETER(PAR.To_Date_USR);

ENDDO;

//?5. Delete Overrides.
DO;

// Execute command - 'DLTOVR'
EXECUTE COMMAND(USR2787);

ENDDO;

