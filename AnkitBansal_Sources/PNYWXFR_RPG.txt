     H/TITLE EXC Crt JCO Ord Dtl-UplXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 04/18/13  Time  : 10:14:03
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNHHCPL1IF  E           K        DISK
      * RTV : WF Export Upload Detail   Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FPDIHREL3IF  E           K        DISK
      * RSQ : Price Method Header       System/Co/Price Method
      *
     FOPCIREL8IF  E           K        DISK
      * RTV : OPP Item Contract         Active only
      *
     FOPCIREL7IF  E           K        DISK
      * RSQ : OPP Item Contract         RSQ Cont#/Co/Cust/Item
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0IF  E           K        DISK                      A
      * UPD : Order Detail              Update index
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@HHCPK7
      * WF Export Upload Detail   Retrieval index
      * Renamed input format fields
     I              HHBKC7                          WABKC7
     I              HHBCNA                          WABCNA
     I              HHDPNB                          WADPNB
     I              HHHGCD                          WAHGCD
     I              HHAVQT                          WAAVQT
     I              HHD0WG                          WAD0WG
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WCAIC3
     I              BZHGCD                          WCHGCD
     I              BZAVNA                          WCAVNA
     I              BZAWNA                          WCAWNA
     I              BZL7NA                          WCL7NA
     I              BZL8NA                          WCL8NA
     I              BZL6NA                          WCL6NA
     I              BZMFNA                          WCMFNA
     I              BZADCD                          WCADCD
     I              BZAWPC                          WCAWPC
     I              BZLXST                          WCLXST
     I              BZAECD                          WCAECD
     I              BZAXPC                          WCAXPC
     I              BZLYST                          WCLYST
     I              BZAFCD                          WCAFCD
     I              BZAICD                          WCAICD
     I              BZAIWG                          WCAIWG
     I              BZHICD                          WCHICD
     I              BZRBCD                          WCRBCD
     I              BZFZST                          WCFZST
     I              BZAVST                          WCAVST
     I              BZCZWG                          WCCZWG
     I              BZC0WG                          WCC0WG
     I              BZURTN                          WCURTN
     I              BZAJC8                          WCAJC8
     I              BZRINB                          WCRINB
     I              BZRHNB                          WCRHNB
     I              BZRGNB                          WCRGNB
     I              BZLNCD                          WCLNCD
     I              BZTFNB                          WCTFNB
     I              BZN0CD                          WCN0CD
     I              BZX4ST                          WCX4ST
     I              BZTMVA                          WCTMVA
     I              BZTNVA                          WCTNVA
     I              BZBLPR                          WCBLPR
     I              BZBMPR                          WCBMPR
     I              BZLRCD                          WCLRCD
     I              BZU9ST                          WCU9ST
     I              BZCMCO                          WCCMCO
     I              BZQ1CD                          WCQ1CD
     I              BZQ8CD                          WCQ8CD
     I              BZCHTM                          WCCHTM
     I              BZQZCD                          WCQZCD
     I              BZXWST                          WCXWST
     I              BZXXST                          WCXXST
     I              BZVMST                          WCVMST
     I              BZSWGH                          WCSWGH
     I              BZPPHE                          WCPPHE
     I              BZR3CD                          WCR3CD
     I              BZSDCD                          WCSDCD
     I              BZICN1                          WCICN1
     I              BZSVCD                          WCSVCD
     I              BZICN2                          WCICN2
     I              BZSWCD                          WCSWCD
     I              BZV2NB                          WCV2NB
     I              BZSXCD                          WCSXCD
     I              BZITCN                          WCITCN
     I              BZSYCD                          WCSYCD
     I              BZITC5                          WCITC5
     I              BZSZCD                          WCSZCD
     I              BZICN6                          WCICN6
     I              BZS0CD                          WCS0CD
     I              BZICN7                          WCICN7
     I              BZS1CD                          WCS1CD
     I              BZICN8                          WCICN8
     I              BZS2CD                          WCS2CD
     I              BZICN9                          WCICN9
     I              BZS3CD                          WCS3CD
     I              BZICN0                          WCICN0
     I              BZS4CD                          WCS4CD
     I              BZSFNB                          WCSFNB
     I              BZA3WG                          WCA3WG
     I              BZSJNB                          WCSJNB
     I              BZLLCD                          WCLLCD
     I              BZLMCD                          WCLMCD
     I              BZP3ST                          WCP3ST
     I              BZSKNB                          WCSKNB
     I              BZSLNB                          WCSLNB
     I              BZSMNB                          WCSMNB
     I              BZP4ST                          WCP4ST
     I              BZCFNB                          WCCFNB
     I              BZCGNB                          WCCGNB
     I              BZILNB                          WCILNB
     I              BZCHNB                          WCCHNB
     I              BZCINB                          WCCINB
     I              BZCJNB                          WCCJNB
     I              BZCMNB                          WCCMNB
     I              BZCNNB                          WCCNNB
     I              BZCRNB                          WCCRNB
     I              BZCSNB                          WCCSNB
     I              BZCVNB                          WCCVNB
     I              BZCWNB                          WCCWNB
     I              BZCXNB                          WCCXNB
     I              BZCZNB                          WCCZNB
     I              BZC0NB                          WCC0NB
     I              BZN1CD                          WCN1CD
     I              BZB4NB                          WCB4NB
     I              BZB5NB                          WCB5NB
     I              BZX5ST                          WCX5ST
     I              BZX6ST                          WCX6ST
     I              BZX7ST                          WCX7ST
     I              BZPCCT                          WCPCCT
     I              BZBDNB                          WCBDNB
     I              BZBJNB                          WCBJNB
     I              BZSUST                          WCSUST
     I              BZSVST                          WCSVST
     I              BZSYST                          WCSYST
     I              BZSZST                          WCSZST
     I              BZS1ST                          WCS1ST
     I              BZXRCD                          WCXRCD
     I              BZXTCD                          WCXTCD
     I              BZXUCD                          WCXUCD
     I              BZF5WG                          WCF5WG
     I              BZF6WG                          WCF6WG
     I              BZF7WG                          WCF7WG
     I              BZBLNB                          WCBLNB
     I              BZBNNB                          WCBNNB
     I              BZS2ST                          WCS2ST
     I              BZS4ST                          WCS4ST
     I              BZS5ST                          WCS5ST
     I              BZS6ST                          WCS6ST
     I              BZS8ST                          WCS8ST
     I              BZS9ST                          WCS9ST
     I              BZTCST                          WCTCST
     I              BZTDST                          WCTDST
     I              BZUVST                          WCUVST
     I              BZUWST                          WCUWST
     I              BZUXST                          WCUXST
     I              BZVSST                          WCVSST
     I              BZAATM                          WCAATM
     I              BZAYNA                          WCAYNA
     I              BZA0NA                          WCA0NA
     I              BZAXDT                          WCAXDT
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          WDHGCD
     I              BYAVNA                          WDAVNA
     I              BYAWNA                          WDAWNA
     I              BYL7NA                          WDL7NA
     I              BYL8NA                          WDL8NA
     I              BYL6NA                          WDL6NA
     I              BYMFNA                          WDMFNA
     I              BYHHCD                          WDHHCD
     I              BYAWPC                          WDAWPC
     I              BYLXST                          WDLXST
     I              BYLGCD                          WDLGCD
     I              BYAXPC                          WDAXPC
     I              BYLYST                          WDLYST
     I              BYLHCD                          WDLHCD
     I              BYLICD                          WDLICD
     I              BYAIWG                          WDAIWG
     I              BYHICD                          WDHICD
     I              BYRBCD                          WDRBCD
     I              BYFZST                          WDFZST
     I              BYAVST                          WDAVST
     I              BYCZWG                          WDCZWG
     I              BYC0WG                          WDC0WG
     I              BYURTN                          WDURTN
     I              BYACC8                          WDACC8
     I              BYRINB                          WDRINB
     I              BYRHNB                          WDRHNB
     I              BYRGNB                          WDRGNB
     I              BYLNCD                          WDLNCD
     I              BYTFNB                          WDTFNB
     I              BYN0CD                          WDN0CD
     I              BYX4ST                          WDX4ST
     I              BYCHTM                          WDCHTM
     I              BYQZCD                          WDQZCD
     I              BYXWST                          WDXWST
     I              BYXXST                          WDXXST
     I              BYVMST                          WDVMST
     I              BYSWGH                          WDSWGH
     I              BYPPHE                          WDPPHE
     I              BYLRCD                          WDLRCD
     I              BYSFNB                          WDSFNB
     I              BYA3WG                          WDA3WG
     I              BYSJNB                          WDSJNB
     I              BYLLCD                          WDLLCD
     I              BYLMCD                          WDLMCD
     I              BYP3ST                          WDP3ST
     I              BYSKNB                          WDSKNB
     I              BYSLNB                          WDSLNB
     I              BYSMNB                          WDSMNB
     I              BYP4ST                          WDP4ST
     I              BYCFNB                          WDCFNB
     I              BYCGNB                          WDCGNB
     I              BYILNB                          WDILNB
     I              BYCHNB                          WDCHNB
     I              BYCINB                          WDCINB
     I              BYCJNB                          WDCJNB
     I              BYCMNB                          WDCMNB
     I              BYCNNB                          WDCNNB
     I              BYCRNB                          WDCRNB
     I              BYCSNB                          WDCSNB
     I              BYCVNB                          WDCVNB
     I              BYCWNB                          WDCWNB
     I              BYCXNB                          WDCXNB
     I              BYCZNB                          WDCZNB
     I              BYC0NB                          WDC0NB
     I              BYN1CD                          WDN1CD
     I              BYB4NB                          WDB4NB
     I              BYX5ST                          WDX5ST
     I              BYX6ST                          WDX6ST
     I              BYX7ST                          WDX7ST
     I              BYTMVA                          WDTMVA
     I              BYTNVA                          WDTNVA
     I              BYBLPR                          WDBLPR
     I              BYBMPR                          WDBMPR
     I              BYU9ST                          WDU9ST
     I              BYCMCO                          WDCMCO
     I              BYQ1CD                          WDQ1CD
     I              BYAIC3                          WDAIC3
     I              BYQ8CD                          WDQ8CD
     I              BYR3CD                          WDR3CD
     I              BYSDCD                          WDSDCD
     I              BYICN1                          WDICN1
     I              BYSVCD                          WDSVCD
     I              BYICN2                          WDICN2
     I              BYSWCD                          WDSWCD
     I              BYV2NB                          WDV2NB
     I              BYSXCD                          WDSXCD
     I              BYITCN                          WDITCN
     I              BYSYCD                          WDSYCD
     I              BYITC5                          WDITC5
     I              BYSZCD                          WDSZCD
     I              BYICN6                          WDICN6
     I              BYS0CD                          WDS0CD
     I              BYICN7                          WDICN7
     I              BYS1CD                          WDS1CD
     I              BYICN8                          WDICN8
     I              BYS2CD                          WDS2CD
     I              BYICN9                          WDICN9
     I              BYS3CD                          WDS3CD
     I              BYICN0                          WDICN0
     I              BYS4CD                          WDS4CD
     I              BYB5NB                          WDB5NB
     I              BYXRCD                          WDXRCD
     I              BYPCCT                          WDPCCT
     I              BYBDNB                          WDBDNB
     I              BYBJNB                          WDBJNB
     I              BYSUST                          WDSUST
     I              BYSVST                          WDSVST
     I              BYSYST                          WDSYST
     I              BYSZST                          WDSZST
     I              BYS1ST                          WDS1ST
     I              BYXTCD                          WDXTCD
     I              BYXUCD                          WDXUCD
     I              BYF5WG                          WDF5WG
     I              BYF6WG                          WDF6WG
     I              BYF7WG                          WDF7WG
     I              BYBLNB                          WDBLNB
     I              BYBNNB                          WDBNNB
     I              BYS2ST                          WDS2ST
     I              BYS4ST                          WDS4ST
     I              BYS5ST                          WDS5ST
     I              BYS6ST                          WDS6ST
     I              BYS8ST                          WDS8ST
     I              BYS9ST                          WDS9ST
     I              BYTCST                          WDTCST
     I              BYTDST                          WDTDST
     I              BYUVST                          WDUVST
     I              BYUWST                          WDUWST
     I              BYUXST                          WDUXST
     I              BYVSST                          WDVSST
     I              BYAHTM                          WDAHTM
     I              BYBEVN                          WDBEVN
     I              BYBFVN                          WDBFVN
     I              BYEKDT                          WDEKDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WFAIC3
     I              KMV8CD                          WFV8CD
     I              KMAUNA                          WFAUNA
     I              KMI5ST                          WFI5ST
     I              KMBXTX                          WFBXTX
     I              KMM8NB                          WFM8NB
     I              KMUVST                          WFUVST
     I              KMUWST                          WFUWST
     I              KMUXST                          WFUXST
     I              KMVSST                          WFVSST
     I              KMAATM                          WFAATM
     I              KMAYNA                          WFAYNA
     I              KMA0NA                          WFA0NA
     I              KMAXDT                          WFAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WHAIC3
     I              EOBKC7                          WHBKC7
     I              EOAQCD                          WHAQCD
     I              EOR4CD                          WHR4CD
     I              EOBYNA                          WHBYNA
     I              EOB6NA                          WHB6NA
     I              EOBZNA                          WHBZNA
     I              EOLLST                          WHLLST
     I              EOPPST                          WHPPST
     I              EOR5NB                          WHR5NB
     I              EOR6NB                          WHR6NB
     I              EOQGST                          WHQGST
     I              EOBOCD                          WHBOCD
     I              EOTBNB                          WHTBNB
     I              EOMTCU                          WHMTCU
     I              EOW2NB                          WHW2NB
     I              EORPCD                          WHRPCD
     I              EOAJCD                          WHAJCD
     I              EOX9ST                          WHX9ST
     I              EOT9CD                          WHT9CD
     I              EOUBCD                          WHUBCD
     I              EOISTX                          WHISTX
     I              EOLQCD                          WHLQCD
     I              EONJNA                          WHNJNA
     I              EOI0TX                          WHI0TX
     I              EONKNA                          WHNKNA
     I              EOI1TX                          WHI1TX
     I              EOVLST                          WHVLST
     I              EORLST                          WHRLST
     I              EOMMTX                          WHMMTX
     I              EOOHNA                          WHOHNA
     I              EOQ6ST                          WHQ6ST
     I              EOQ8ST                          WHQ8ST
     I              EORBST                          WHRBST
     I              EOREST                          WHREST
     I              EOUVST                          WHUVST
     I              EOUWST                          WHUWST
     I              EOUXST                          WHUXST
     I              EOVSST                          WHVSST
     I              EOAATM                          WHAATM
     I              EOAYNA                          WHAYNA
     I              EOA0NA                          WHA0NA
     I              EOAXDT                          WHAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WIAIC3
     I              IHQ7CD                          WIQ7CD
     I              IHMLNA                          WIMLNA
     I              IHU0ST                          WIU0ST
     I              IHV8ST                          WIV8ST
     I              IHBYST                          WIBYST
     I              IHRMNY                          WIRMNY
     I              IHH3ST                          WIH3ST
     I              IHH5ST                          WIH5ST
     I              IHH6ST                          WIH6ST
     I              IHH7ST                          WIH7ST
     I              IHUVST                          WIUVST
     I              IHUWST                          WIUWST
     I              IHUXST                          WIUXST
     I              IHAATM                          WIAATM
     I              IHAYNA                          WIAYNA
     I              IHA0NA                          WIA0NA
     I              IHAXDT                          WIAXDT
      *
     I@IHREFI
      * Price Method Header       System/Co/Price Method
      * Renamed input format fields
     I              IHAIC3                          WJAIC3
     I              IHQ7CD                          WJQ7CD
     I              IHMLNA                          WJMLNA
     I              IHU0ST                          WJU0ST
     I              IHV8ST                          WJV8ST
     I              IHBYST                          WJBYST
     I              IHRMNY                          WJRMNY
     I              IHH3ST                          WJH3ST
     I              IHH5ST                          WJH5ST
     I              IHH6ST                          WJH6ST
     I              IHH7ST                          WJH7ST
     I              IHUVST                          WJUVST
     I              IHUWST                          WJUWST
     I              IHUXST                          WJUXST
     I              IHAATM                          WJAATM
     I              IHAYNA                          WJAYNA
     I              IHA0NA                          WJA0NA
     I              IHAXDT                          WJAXDT
      *
     I@CIREWP
      * OPP Item Contract         Active only
      * Renamed input format fields
     I              CIAIC3                          WKAIC3
     I              CIBKC7                          WKBKC7
     I              CIHGCD                          WKHGCD
     I              CIAUDT                          WKAUDT
     I              CICWDT                          WKCWDT
     I              CIAUST                          WKAUST
     I              CIANDT                          WKANDT
     I              CIAUNA                          WKAUNA
     I              CIDQQT                          WKDQQT
     I              CIHFQT                          WKHFQT
     I              CIL6NB                          WKL6NB
     I              CIFSQT                          WKFSQT
     I              CIB0PR                          WKB0PR
     I              CIGBDT                          WKGBDT
     I              CIGCDT                          WKGCDT
     I              CIGDDT                          WKGDDT
     I              CIRDCD                          WKRDCD
     I              CIQ7CD                          WKQ7CD
     I              CIRQCD                          WKRQCD
     I              CIR4CD                          WKR4CD
     I              CIUVST                          WKUVST
     I              CIUWST                          WKUWST
     I              CIUXST                          WKUXST
     I              CIVSST                          WKVSST
     I              CIAATM                          WKAATM
     I              CIAYNA                          WKAYNA
     I              CIA0NA                          WKA0NA
     I              CIAXDT                          WKAXDT
      *
     I@CIREWO
      * OPP Item Contract         RSQ Cont#/Co/Cust/Item
      * Renamed input format fields
     I              CIAIC3                          WLAIC3
     I              CIBKC7                          WLBKC7
     I              CIHGCD                          WLHGCD
     I              CIAUDT                          WLAUDT
     I              CICWDT                          WLCWDT
     I              CIAUST                          WLAUST
     I              CIANDT                          WLANDT
     I              CIAUNA                          WLAUNA
     I              CIDQQT                          WLDQQT
     I              CIHFQT                          WLHFQT
     I              CIL6NB                          WLL6NB
     I              CIFSQT                          WLFSQT
     I              CIB0PR                          WLB0PR
     I              CIGBDT                          WLGBDT
     I              CIGCDT                          WLGCDT
     I              CIGDDT                          WLGDDT
     I              CIRDCD                          WLRDCD
     I              CIQ7CD                          WLQ7CD
     I              CIRQCD                          WLRQCD
     I              CIR4CD                          WLR4CD
     I              CIUVST                          WLUVST
     I              CIUWST                          WLUWST
     I              CIUXST                          WLUXST
     I              CIVSST                          WLVSST
     I              CIAATM                          WLAATM
     I              CIAYNA                          WLAYNA
     I              CIA0NA                          WLA0NA
     I              CIAXDT                          WLAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WMAIC3
     I              OMC4NB                          WMC4NB
     I              OMDPNB                          WMDPNB
     I              OMUENB                          WMUENB
     I              OMHGCD                          WMHGCD
     I              OMAJCD                          WMAJCD
     I              OMBKC7                          WMBKC7
     I              OMCFC7                          WMCFC7
     I              OMGMST                          WMGMST
     I              OMGNST                          WMGNST
     I              OMMAVA                          WMMAVA
     I              OMKDVA                          WMKDVA
     I              OML8VA                          WML8VA
     I              OML9VA                          WML9VA
     I              OMGTST                          WMGTST
     I              OMGVST                          WMGVST
     I              OMGUST                          WMGUST
     I              OMQFST                          WMQFST
     I              OMAYVA                          WMAYVA
     I              OMEXDT                          WMEXDT
     I              OMLQCD                          WMLQCD
     I              OMRDCD                          WMRDCD
     I              OMQ7CD                          WMQ7CD
     I              OMBZPR                          WMBZPR
     I              OML6NB                          WML6NB
     I              OMU1ST                          WMU1ST
     I              OMGIDT                          WMGIDT
     I              OMCRCD                          WMCRCD
     I              OMAGCD                          WMAGCD
     I              OMRZST                          WMRZST
     I              OMR0ST                          WMR0ST
     I              OMR1ST                          WMR1ST
     I              OMG7NA                          WMG7NA
     I              OMG8NA                          WMG8NA
     I              OMRPCD                          WMRPCD
     I              OMVEST                          WMVEST
     I              OMVGST                          WMVGST
     I              OMAVST                          WMAVST
     I              OMU0ST                          WMU0ST
     I              OMRFCD                          WMRFCD
     I              OMFZST                          WMFZST
     I              OMR1NB                          WMR1NB
     I              OMAVQT                          WMAVQT
     I              OMD0WG                          WMD0WG
     I              OMCCQT                          WMCCQT
     I              OMAUWG                          WMAUWG
     I              OMCBQT                          WMCBQT
     I              OMATWG                          WMATWG
     I              OMAQCS                          WMAQCS
     I              OMAGCS                          WMAGCS
     I              OMAKPR                          WMAKPR
     I              OMALPR                          WMALPR
     I              OMAUPR                          WMAUPR
     I              OMAVWG                          WMAVWG
     I              OMA4WG                          WMA4WG
     I              OMA5DT                          WMA5DT
     I              OMAODT                          WMAODT
     I              OMGNDT                          WMGNDT
     I              OMAMST                          WMAMST
     I              OMANST                          WMANST
     I              OMVAST                          WMVAST
     I              OMRGNB                          WMRGNB
     I              OMRHNB                          WMRHNB
     I              OMRINB                          WMRINB
     I              OMRBCD                          WMRBCD
     I              OMHICD                          WMHICD
     I              OMRNCD                          WMRNCD
     I              OMROCD                          WMROCD
     I              OMCXDT                          WMCXDT
     I              OMAJVN                          WMAJVN
     I              OMKXCD                          WMKXCD
     I              OMJPCD                          WMJPCD
     I              OMCQCD                          WMCQCD
     I              OMR4CD                          WMR4CD
     I              OMZ1ST                          WMZ1ST
     I              OMZ3ST                          WMZ3ST
     I              OMZ4ST                          WMZ4ST
     I              OMDUPR                          WMDUPR
     I              OMB6VL                          WMB6VL
     I              OMA1AA                          WMA1AA
     I              OMFZSX                          WMFZSX
     I              OMF0SX                          WMF0SX
     I              OMF1SX                          WMF1SX
     I              OMF2SX                          WMF2SX
     I              OMF3SX                          WMF3SX
     I              OMF4SX                          WMF4SX
     I              OMF5SX                          WMF5SX
     I              OMF6SX                          WMF6SX
     I              OMF7SX                          WMF7SX
     I              OMNTDT                          WMNTDT
     I              OMNUDT                          WMNUDT
     I              OMNVDT                          WMNVDT
     I              OMNWDT                          WMNWDT
     I              OMNXDT                          WMNXDT
     I              OMBUTM                          WMBUTM
     I              OMBVTM                          WMBVTM
     I              OMBWTM                          WMBWTM
     I              OMBXTM                          WMBXTM
     I              OMBYTM                          WMBYTM
     I              OMH5NX                          WMH5NX
     I              OMH6NX                          WMH6NX
     I              OMH7NX                          WMH7NX
     I              OMH8NX                          WMH8NX
     I              OMH9NX                          WMH9NX
     I              OMDVPR                          WMDVPR
     I              OMDWPR                          WMDWPR
     I              OMDXPR                          WMDXPR
     I              OMDYPR                          WMDYPR
     I              OMDZPR                          WMDZPR
     I              OMGSPR                          WMGSPR
     I              OMGTPR                          WMGTPR
     I              OMGUPR                          WMGUPR
     I              OMHOST                          WMHOST
     I              OMHPST                          WMHPST
     I              OMIOST                          WMIOST
     I              OMPEWG                          WMPEWG
     I              OMRINY                          WMRINY
     I              OMTIDT                          WMTIDT
     I              OMTJDT                          WMTJDT
     I              OMH2ST                          WMH2ST
     I              OMH0ST                          WMH0ST
     I              OMH1ST                          WMH1ST
     I              OMTKDT                          WMTKDT
     I              OMTLDT                          WMTLDT
     I              OMTMDT                          WMTMDT
     I              OMUVST                          WMUVST
     I              OMUWST                          WMUWST
     I              OMUXST                          WMUXST
     I              OMAATM                          WMAATM
     I              OMAYNA                          WMAYNA
     I              OMA0NA                          WMA0NA
     I              OMAXDT                          WMAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                             12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     I                                    P   1   40PABKC7
      * I :  Price Code
     I                                    P   5   80PABVTM
      * I :  Item Code
     I                                    P   9  120PAHGCD
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WMAIC3
     I              OMC4NB                          WMC4NB
     I              OMDPNB                          WMDPNB
     I              OMUENB                          WMUENB
     I              OMHGCD                          WMHGCD
     I              OMAJCD                          WMAJCD
     I              OMBKC7                          WMBKC7
     I              OMCFC7                          WMCFC7
     I              OMGMST                          WMGMST
     I              OMGNST                          WMGNST
     I              OMMAVA                          WMMAVA
     I              OMKDVA                          WMKDVA
     I              OML8VA                          WML8VA
     I              OML9VA                          WML9VA
     I              OMGTST                          WMGTST
     I              OMGVST                          WMGVST
     I              OMGUST                          WMGUST
     I              OMQFST                          WMQFST
     I              OMAYVA                          WMAYVA
     I              OMEXDT                          WMEXDT
     I              OMLQCD                          WMLQCD
     I              OMRDCD                          WMRDCD
     I              OMQ7CD                          WMQ7CD
     I              OMBZPR                          WMBZPR
     I              OML6NB                          WML6NB
     I              OMU1ST                          WMU1ST
     I              OMGIDT                          WMGIDT
     I              OMCRCD                          WMCRCD
     I              OMAGCD                          WMAGCD
     I              OMRZST                          WMRZST
     I              OMR0ST                          WMR0ST
     I              OMR1ST                          WMR1ST
     I              OMG7NA                          WMG7NA
     I              OMG8NA                          WMG8NA
     I              OMRPCD                          WMRPCD
     I              OMVEST                          WMVEST
     I              OMVGST                          WMVGST
     I              OMAVST                          WMAVST
     I              OMU0ST                          WMU0ST
     I              OMRFCD                          WMRFCD
     I              OMFZST                          WMFZST
     I              OMR1NB                          WMR1NB
     I              OMAVQT                          WMAVQT
     I              OMD0WG                          WMD0WG
     I              OMCCQT                          WMCCQT
     I              OMAUWG                          WMAUWG
     I              OMCBQT                          WMCBQT
     I              OMATWG                          WMATWG
     I              OMAQCS                          WMAQCS
     I              OMAGCS                          WMAGCS
     I              OMAKPR                          WMAKPR
     I              OMALPR                          WMALPR
     I              OMAUPR                          WMAUPR
     I              OMAVWG                          WMAVWG
     I              OMA4WG                          WMA4WG
     I              OMA5DT                          WMA5DT
     I              OMAODT                          WMAODT
     I              OMGNDT                          WMGNDT
     I              OMAMST                          WMAMST
     I              OMANST                          WMANST
     I              OMVAST                          WMVAST
     I              OMRGNB                          WMRGNB
     I              OMRHNB                          WMRHNB
     I              OMRINB                          WMRINB
     I              OMRBCD                          WMRBCD
     I              OMHICD                          WMHICD
     I              OMRNCD                          WMRNCD
     I              OMROCD                          WMROCD
     I              OMCXDT                          WMCXDT
     I              OMAJVN                          WMAJVN
     I              OMKXCD                          WMKXCD
     I              OMJPCD                          WMJPCD
     I              OMCQCD                          WMCQCD
     I              OMR4CD                          WMR4CD
     I              OMZ1ST                          WMZ1ST
     I              OMZ3ST                          WMZ3ST
     I              OMZ4ST                          WMZ4ST
     I              OMDUPR                          WMDUPR
     I              OMB6VL                          WMB6VL
     I              OMA1AA                          WMA1AA
     I              OMFZSX                          WMFZSX
     I              OMF0SX                          WMF0SX
     I              OMF1SX                          WMF1SX
     I              OMF2SX                          WMF2SX
     I              OMF3SX                          WMF3SX
     I              OMF4SX                          WMF4SX
     I              OMF5SX                          WMF5SX
     I              OMF6SX                          WMF6SX
     I              OMF7SX                          WMF7SX
     I              OMNTDT                          WMNTDT
     I              OMNUDT                          WMNUDT
     I              OMNVDT                          WMNVDT
     I              OMNWDT                          WMNWDT
     I              OMNXDT                          WMNXDT
     I              OMBUTM                          WMBUTM
     I              OMBVTM                          WMBVTM
     I              OMBWTM                          WMBWTM
     I              OMBXTM                          WMBXTM
     I              OMBYTM                          WMBYTM
     I              OMH5NX                          WMH5NX
     I              OMH6NX                          WMH6NX
     I              OMH7NX                          WMH7NX
     I              OMH8NX                          WMH8NX
     I              OMH9NX                          WMH9NX
     I              OMDVPR                          WMDVPR
     I              OMDWPR                          WMDWPR
     I              OMDXPR                          WMDXPR
     I              OMDYPR                          WMDYPR
     I              OMDZPR                          WMDZPR
     I              OMGSPR                          WMGSPR
     I              OMGTPR                          WMGTPR
     I              OMGUPR                          WMGUPR
     I              OMHOST                          WMHOST
     I              OMHPST                          WMHPST
     I              OMIOST                          WMIOST
     I              OMPEWG                          WMPEWG
     I              OMRINY                          WMRINY
     I              OMTIDT                          WMTIDT
     I              OMTJDT                          WMTJDT
     I              OMH2ST                          WMH2ST
     I              OMH0ST                          WMH0ST
     I              OMH1ST                          WMH1ST
     I              OMTKDT                          WMTKDT
     I              OMTLDT                          WMTLDT
     I              OMTMDT                          WMTMDT
     I              OMUVST                          WMUVST
     I              OMUWST                          WMUWST
     I              OMUXST                          WMUXST
     I              OMAATM                          WMAATM
     I              OMAYNA                          WMAYNA
     I              OMA0NA                          WMA0NA
     I              OMAXDT                          WMAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: WF Export Upload Detail
      * I : RST Ship To Customer
     I                                    P   1   40P1BKC7
      * I : RST Customer Purchase Order #
     I                                        5  19 P1BCNA
      * I :  Order Sequence Number
     I                                    P  20  210P1DPNB
     IP2PARM      DS
      * FLD: WF Export Upload Header
      * I :  Company Number
     I                                    P   1   20P2AIC3
      * I :  Warehouse Code
     I                                        3   5 P2AJCD
      * I :  Price Code
     I                                    P   6   90P2BVTM
      * I :  Item Age Days
     I                                    P  10  120P2RINY
     IP3PARM      DS
      * FLD: Customer Price Detail
      * O :  Customer Price /UM Prc
     I                                    P   1   64P3FIPR
      * O :  Price Method Code
     I                                        7   9 P3Q7CD
      * O :  Contract Unit Type
     I                                       10  10 P3QNSX
     IP4PARM      DS
      * FLD: Order Detail
      * I :  Order Number
     I                                    P   1   40P4C4NB
      * I :  Order Secondary Line Seq
     I                                    P   5   60P4UENB
      * I :  Order Group Code
     I                                    P   7  100P4CFC7
      * I :  Detail Line Status
     I                                       11  11 P4GMST
      * I :  Detail Line Status Last
     I                                       12  12 P4GNST
      * I :  Billing Detail Cost Dol.
     I                                    P  13  182P4MAVA
      * I :  Billing Detail Gross Dol.
     I                                    P  19  242P4KDVA
      * I :  Billing Detail Net Dol.
     I                                    P  25  302P4L8VA
      * I :  Quantity to Substitute
     I                                    P  31  362P4L9VA
      * I :  Comment Print Acknowledge
     I                                       37  37 P4GTST
      * I :  Comment Print Inv/Cr.Memo
     I                                       38  38 P4GVST
      * I :  Comment Print Pick Slip
     I                                       39  39 P4GUST
      * I :  Comment Print Ship Doc
     I                                       40  40 P4QFST
      * I :  Extended Amount
     I                                    P  41  462P4AYVA
      * I :  Market Pricing Date
     I                                    P  47  500P4EXDT
      * I :  Commodity Market Code
     I                                       51  53 P4LQCD
      * I :  Date Method Code
     I                                       54  56 P4RDCD
      * I :  Price Method Code
     I                                       57  59 P4Q7CD
      * I :  Price Overage Override
     I                                    P  60  654P4BZPR
      * I :  Contract Number
     I                                    P  66  690P4L6NB
      * I :  Price Status
     I                                       70  70 P4U1ST
      * I :  Pricing Date Used
     I                                    P  71  740P4GIDT
      * I :  U/M - Base Price
     I                                       75  76 P4CRCD
      * I :  U/M - Ordered
     I                                       77  78 P4AGCD
      * I :  Work Confirm Status
     I                                       79  79 P4RZST
      * I :  Work Over/Short Status
     I                                       80  80 P4R0ST
      * N :  OD Production Plan Sts
     I                                       81  81 P4R1ST
      * B :  Order Desc. Line One
     I                                       82 111 P4G7NA
      * B :  Order Desc. Line Two
     I                                      112 141 P4G8NA
      * I :  Palletize
     I                                      142 142 P4VEST
      * I :  Slip Sheet
     I                                      143 143 P4VGST
      * B :  Catch Weight Status
     I                                      144 144 P4AVST
      * I :  Price Audit
     I                                      145 145 P4U0ST
      * I :  Price Audit Reason Code
     I                                      146 148 P4RFCD
      * B :  Production Date Control
     I                                      149 149 P4FZST
      * I :  Rated Freight
     I                                    P 150 1552P4R1NB
      * I :  Quantity Ordered
     I                                    P 156 1612P4AVQT
      * I :  Weight Ordered
     I                                    P 162 1672P4D0WG
      * I :  Quantity Scheduled
     I                                    P 168 1732P4CCQT
      * I :  Weight Scheduled
     I                                    P 174 1792P4AUWG
      * I :  Unit Cost Pricing U/M
     I                                    P 180 1854P4AQCS
      * B :  Unit Cost Per Pound
     I                                    P 186 1914P4AGCS
      * I :  Unit Price
     I                                    P 192 1974P4AKPR
      * I :  Unit Price - Credit
     I                                    P 198 2034P4ALPR
      * I :  Unit Price Ordered U/M
     I                                    P 204 2094P4AUPR
      * B :  Unit Weight Ordered U/M
     I                                    P 210 2152P4AVWG
      * I :  Tare Weight Total
     I                                    P 216 2212P4A4WG
      * I :  Requested Ship Date
     I                                    P 222 2250P4A5DT
      * I :  Scheduled Ship Date
     I                                    P 226 2290P4AODT
      * I :  Affect Inventory Status
     I                                      230 230 P4AMST
      * I :  Affect Sales Doll Status
     I                                      231 231 P4ANST
      * I :  Affect Sales Pnds Status
     I                                      232 232 P4VAST
      * B :  Item Structure Type Code
     I                                    P 233 2340P4RGNB
      * B :  Item Structure Group Code
     I                                    P 235 2360P4RHNB
      * B :  Item Structure Class Code
     I                                    P 237 2380P4RINB
      * I :  Item Level
     I                                      239 240 P4RBCD
      * I :  Quality Level
     I                                      241 242 P4HICD
      * I :  Pricing Product Class Rep
     I                                      243 244 P4RNCD
      * I :  Season Product Class Repo
     I                                      245 246 P4ROCD
      * I :  Date of Original Entry
     I                                    P 247 2500P4CXDT
      * I :  User Profile Name
     I                                      251 260 P4AJVN
      * I :  Country Code
     I                                      261 266 P4KXCD
      * I :  Event Code
     I                                      267 268 P4JPCD
      * I :  Reason Code
     I                                      269 271 P4CQCD
      * I :  Sales Route Code
     I                                      272 274 P4R4CD
      * I :  Modified Flag
     I                                      275 275 P4Z1ST
      * I :  Substituted Flag
     I                                      276 276 P4Z3ST
      * I :  OD Schedule Override Sts
     I                                      277 277 P4Z4ST
      * I :  Invoice Unit Price
     I                                    P 278 2834P4DUPR
      * I :  Invoice Extended Amt
     I                                    P 284 2892P4B6VL
      * I :  Ham Group Number
     I                                    P 290 2910P4A1AA
      * I :  OD Adj Type Override
     I                                      292 292 P4FZSX
      * I :  Affect Trade Fund
     I                                      293 293 P4F0SX
      * I :  Affect Commission
     I                                      294 294 P4F1SX
      * I :  Affect Pricing
     I                                      295 295 P4F2SX
      * I :  Released by User Sts Y/N
     I                                      296 296 P4F3SX
      * I :  Ord TF Exempt Code
     I                                      297 298 P4F4SX
      * I :  OD Pallet Type
     I                                      299 300 P4F5SX
      * I :  Production Warehouse
     I                                      301 303 P4F6SX
      * I :  OD Price Type
     I                                      304 306 P4F7SX
      * I :  Warehouse Pallets Loaded
     I                                    P 307 3100P4NTDT
      * I :  Consumed Item Code
     I                                    P 311 3140P4NUDT
      * I :  Deadline Depart Date LH
     I                                    P 315 3180P4NVDT
      * I :  OD Unused Date 5
     I                                    P 319 3220P4NXDT
      * I :  Deadline Depart Time LH
     I                                    P 323 3260P4BUTM
      * I :  Maximum Net Weight
     I                                    P 327 3300P4BWTM
      * I :  Substitution Line Number
     I                                    P 331 3340P4BXTM
      * I :  Max Qty to sched per day
     I                                    P 335 3380P4BYTM
      * I :  Warehouse Pallet Tare
     I                                    P 339 3442P4H5NX
      * I :  Warehouse Avg Pallet Tare
     I                                    P 345 3502P4H6NX
      * I :  OD Item Target Price
     I                                    P 351 3562P4H7NX
      * I :  OD Minimum Unit Weight
     I                                    P 357 3622P4H8NX
      * I :  OD Maximum Unit Weight
     I                                    P 363 3682P4H9NX
      * I :  Order Gate Price
     I                                    P 369 3744P4DVPR
      * I :  OD Ceiling Price
     I                                    P 375 3804P4DWPR
      * I :  Order Line Error Type
     I                                      381 383 P4H1ST
     IP5PARM      DS
      * B :  Total Weight Ordered USR
     I                                    P   1   62P5IEWG
     IP6PARM      DS
      * I :  Requested Delivery Date
     I                                    P   1   40P6EIDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'TF Exempt-Item & Cust'
      * Item Code
     I                                        1   7 ZA0001
      * Message data for 'Tf Exempt - mix error'
      * Message data for 'TF Exempt-Item & Cust'
      * Item Code
     I                                        1   7 ZA0002
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0003
      * Weight Allocated USR
     I                                    P   5   92ZA0004
      * Maximum Contract Units
     I                                    P  10  152ZA0005
      * Item Code
     I                                       16  22 ZA0006
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0007
      * Weight Allocated USR
     I                                    P   5   92ZA0008
      * Maximum Contract Units
     I                                    P  10  152ZA0009
      * Item Code
     I                                       16  22 ZA0010
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0011
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0012
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0013
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0014
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0015
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0016
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0017
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0018
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0019
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0020
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0021
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0022
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0023
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0024
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0025
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0026
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0027
      * Production AgeDte To
     I                                    P   5   80ZA0028
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BKC7    PARM           WP0001  70       Ship To Custome
     C           P1BCNA    PARM           WP0002 15        Customer Purcha
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P2AIC3    PARM           WP0004  30       Company Number
     C           P2AJCD    PARM           WP0005  3        Warehouse Code
     C           P2BVTM    PARM           WP0006  60       Price Code
     C           P2RINY    PARM           WP0007  40       Item Age Days
     C           P3FIPR    PARM P3FIPR    WP0008 114       Customer Price
     C           P3Q7CD    PARM P3Q7CD    WP0009  3        Price Method Co
     C           P3QNSX    PARM P3QNSX    WP0010  1        Contract Unit T
     C           P4C4NB    PARM           WP0011  70       Order Number
     C           P4UENB    PARM           WP0012  30       Order Secondary
     C           P4CFC7    PARM           WP0013  70       Order Group Cod
     C           P4GMST    PARM           WP0014  1        Detail Line Sta
     C           P4GNST    PARM           WP0015  1        Detail Line Sta
     C           P4MAVA    PARM           WP0016 112       Billing Detail
     C           P4KDVA    PARM           WP0017 112       Billing Detail
     C           P4L8VA    PARM           WP0018 112       Billing Detail
     C           P4L9VA    PARM           WP0019 112       Quantity to Sub
     C           P4GTST    PARM           WP0020  1        Comment Print A
     C           P4GVST    PARM           WP0021  1        Comment Print I
     C           P4GUST    PARM           WP0022  1        Comment Print P
     C           P4QFST    PARM           WP0023  1        Comment Print S
     C           P4AYVA    PARM           WP0024 112       Extended Amount
     C           P4EXDT    PARM           WP0025  70       Market Pricing
     C           P4LQCD    PARM           WP0026  3        Commodity Marke
     C           P4RDCD    PARM           WP0027  3        Date Method Cod
     C           P4Q7CD    PARM           WP0028  3        Price Method Co
     C           P4BZPR    PARM           WP0029 114       Price Overage O
     C           P4L6NB    PARM           WP0030  70       Contract Number
     C           P4U1ST    PARM           WP0031  1        Price Status
     C           P4GIDT    PARM           WP0032  70       Pricing Date Us
     C           P4CRCD    PARM           WP0033  2        U/M - Base Pric
     C           P4AGCD    PARM           WP0034  2        U/M - Ordered
     C           P4RZST    PARM           WP0035  1        Work Confirm St
     C           P4R0ST    PARM           WP0036  1        Work Over/Short
     C           P4G7NA    PARM P4G7NA    WP0037 30        Order Desc. Lin
     C           P4G8NA    PARM P4G8NA    WP0038 30        Order Desc. Lin
     C           P4VEST    PARM           WP0039  1        Palletize
     C           P4VGST    PARM           WP0040  1        Slip Sheet
     C           P4AVST    PARM P4AVST    WP0041  1        Catch Weight St
     C           P4U0ST    PARM           WP0042  1        Price Audit
     C           P4RFCD    PARM           WP0043  3        Price Audit Rea
     C           P4FZST    PARM P4FZST    WP0044  1        Production Date
     C           P4R1NB    PARM           WP0045 112       Rated Freight
     C           P4AVQT    PARM           WP0046 112       Quantity Ordere
     C           P4D0WG    PARM           WP0047 112       Weight Ordered
     C           P4CCQT    PARM           WP0048 112       Quantity Schedu
     C           P4AUWG    PARM           WP0049 112       Weight Schedule
     C           P4AQCS    PARM           WP0050 114       Unit Cost Prici
     C           P4AGCS    PARM P4AGCS    WP0051 114       Unit Cost Per P
     C           P4AKPR    PARM           WP0052 114       Unit Price
     C           P4ALPR    PARM           WP0053 114       Unit Price - Cr
     C           P4AUPR    PARM           WP0054 114       Unit Price Orde
     C           P4AVWG    PARM P4AVWG    WP0055 112       Unit Weight Ord
     C           P4A4WG    PARM           WP0056 112       Tare Weight Tot
     C           P4A5DT    PARM           WP0057  70       Requested Ship
     C           P4AODT    PARM           WP0058  70       Scheduled Ship
     C           P4AMST    PARM           WP0059  1        Affect Inventor
     C           P4ANST    PARM           WP0060  1        Affect Sales Do
     C           P4VAST    PARM           WP0061  1        Affect Sales Pn
     C           P4RGNB    PARM P4RGNB    WP0062  30       Item Structure
     C           P4RHNB    PARM P4RHNB    WP0063  30       Item Structure
     C           P4RINB    PARM P4RINB    WP0064  30       Item Structure
     C           P4RBCD    PARM           WP0065  2        Item Level
     C           P4HICD    PARM           WP0066  2        Quality Level
     C           P4RNCD    PARM           WP0067  2        Pricing Product
     C           P4ROCD    PARM           WP0068  2        Season Product
     C           P4CXDT    PARM           WP0069  70       Date of Origina
     C           P4AJVN    PARM           WP0070 10        User Profile Na
     C           P4KXCD    PARM           WP0071  6        Country Code
     C           P4JPCD    PARM           WP0072  2        Event Code
     C           P4CQCD    PARM           WP0073  3        Reason Code
     C           P4R4CD    PARM           WP0074  3        Sales Route Cod
     C           P4Z1ST    PARM           WP0075  1        Modified Flag
     C           P4Z3ST    PARM           WP0076  1        Substituted Fla
     C           P4Z4ST    PARM           WP0077  1        OD Schedule Ove
     C           P4DUPR    PARM           WP0078 114       Invoice Unit Pr
     C           P4B6VL    PARM           WP0079 112       Invoice Extende
     C           P4A1AA    PARM           WP0080  30       Ham Group Numbe
     C           P4FZSX    PARM           WP0081  1        OD Adj Type Ove
     C           P4F0SX    PARM           WP0082  1        Affect Trade Fu
     C           P4F1SX    PARM           WP0083  1        Affect Commissi
     C           P4F2SX    PARM           WP0084  1        Affect Pricing
     C           P4F3SX    PARM           WP0085  1        Released by Use
     C           P4F4SX    PARM           WP0086  2        Ord TF Exempt C
     C           P4F5SX    PARM           WP0087  2        OD Pallet Type
     C           P4F6SX    PARM           WP0088  3        Production Ware
     C           P4F7SX    PARM           WP0089  3        OD Price Type
     C           P4NTDT    PARM           WP0090  70       Warehouse Palle
     C           P4NUDT    PARM           WP0091  70       Consumed Item C
     C           P4NVDT    PARM           WP0092  70       Deadline Depart
     C           P4NXDT    PARM           WP0093  70       OD Unused Date
     C           P4BUTM    PARM           WP0094  60       Deadline Depart
     C           P4BWTM    PARM           WP0095  60       Maximum Net Wei
     C           P4BXTM    PARM           WP0096  60       Substitution Li
     C           P4BYTM    PARM           WP0097  60       Max Qty to sche
     C           P4H5NX    PARM           WP0098 112       Warehouse Palle
     C           P4H6NX    PARM           WP0099 112       Warehouse Avg P
     C           P4H7NX    PARM           WP0100 112       OD Item Target
     C           P4H8NX    PARM           WP0101 112       OD Minimum Unit
     C           P4H9NX    PARM           WP0102 112       OD Maximum Unit
     C           P4DVPR    PARM           WP0103 114       Order Gate Pric
     C           P4DWPR    PARM           WP0104 114       OD Ceiling Pric
     C           P4H1ST    PARM           WP0105  3        Order Line Erro
     C           P5IEWG    PARM P5IEWG    WP0106 112       Total Weight Or
     C           P6EIDT    PARM           WP0107  70       Requested Deliv
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EXC Crt JCO Ord Dtl-UplXF
      * ** Create the order detail records for 1 Shipping Marks  P001251
      * RTV Crt JCO Ord Dtl-UplRT - WF Export Upload Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Crt JCO Ord Dtl-UplRT - WF Export Upload Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Order Secondary
     C                     MOVEL*BLANK    WN0002  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0003  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0004  1        OD Production P
     C                     Z-ADD*ZERO     WN0005 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0006 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0007 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0008  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0009  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0010  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0011 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0012  70       Production Ovr
     C                     Z-ADD*ZERO     WN0013  70       Production Ovr
     C                     MOVEL*BLANK    WN0014  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0015  2        OD UnUsed Statu
     C                     Z-ADD*ZERO     WN0016  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0017  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0018  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0019  3        OH TF Exempt Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0013           Order Sequence
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABKC7    WQSA01           Ship To Custome
     C           *LIKE     DEFN WABCNA    WQSA02           Customer Purcha
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
     C                     KFLD           WQSA02           Customer Purcha
     C                     KFLD           WADPNB           Order Sequence
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
     C                     KFLD           WQSA02           Customer Purcha
      * Setup key
     C                     Z-ADDP1BKC7    WQSA01           Ship To Custome
     C                     MOVELP1BCNA    WQSA02           Customer Purcha
     C                     Z-ADD1         WADPNB           Order Sequence
      * Establish starting position
     C           KPSSA     SETLL@HHCPK7                    *
     C           KRSSA     READE@HHCPK7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4444' W0RTN   7
      * USER: Processing if Data record not found
      * ** Error if no detail records in the Work File
      * CHG Ord Req's Rvw-JCO  CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0001           Company Number
     C                     Z-ADDP4C4NB    WL0002           Order Number
     C                     MOVEL'Y'       WL0003    P      Order Requires
     C                     EXSR SBCHRC
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Populate Order Detail Fields & create OD record
     C                     EXSR UASUBR                     ** Populate Ord
     C           KRSSA     READE@HHCPK7                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Ord Req's Rvw-JCO  CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0020  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0021  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0022  70       Ship To Custome
     C                     MOVEL*BLANK    WN0023 30        Ship To Name
     C                     MOVEL*BLANK    WN0024 30        Ship To Address
     C                     MOVEL*BLANK    WN0025 30        Ship To Address
     C                     MOVEL*BLANK    WN0026 30        Ship To Address
     C                     MOVEL*BLANK    WN0027 20        Ship To City
     C                     MOVEL*BLANK    WN0028  2        Ship To State C
     C                     MOVEL*BLANK    WN0029 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0030  70       Bill to Custome
     C                     MOVEL*BLANK    WN0031 30        Bill to Name
     C                     MOVEL*BLANK    WN0032 30        Bill to Address
     C                     MOVEL*BLANK    WN0033 30        Bill to Address
     C                     MOVEL*BLANK    WN0034 30        Bill to Address
     C                     MOVEL*BLANK    WN0035 20        Bill to City
     C                     MOVEL*BLANK    WN0036  2        Bill to State C
     C                     MOVEL*BLANK    WN0037 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0038 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0039  70       Order Date
     C                     Z-ADD*ZERO     WN0040  70       Requested Ship
     C                     Z-ADD*ZERO     WN0041  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0042  70       Cancel Date
     C                     MOVEL*BLANK    WN0043  2        Terms Code
     C                     MOVEL*BLANK    WN0044 40        Special Instruc
     C                     MOVEL*BLANK    WN0045 40        Special Instruc
     C                     MOVEL*BLANK    WN0046  3        Carrier Code
     C                     MOVEL*BLANK    WN0047  1        Comment Print A
     C                     MOVEL*BLANK    WN0048  1        Comment Print I
     C                     MOVEL*BLANK    WN0049  1        Comment Print P
     C                     MOVEL*BLANK    WN0050  1        Comment Print S
     C                     MOVEL*BLANK    WN0051  3        Reason Code
     C                     MOVEL*BLANK    WN0052  1        Order in Use
     C                     MOVEL*BLANK    WN0053  1        Header Status
     C                     MOVEL*BLANK    WN0054  1        Header Status L
     C                     MOVEL*BLANK    WN0055  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0056  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0057 10        User Original E
     C                     Z-ADD*ZERO     WN0058  70       Date of Origina
     C                     Z-ADD*ZERO     WN0059 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0060 112       Order Weight To
     C                     MOVEL*BLANK    WN0061  1        Credit Hold
     C                     MOVEL*BLANK    WN0062  1        Production Hold
     C                     MOVEL*BLANK    WN0063  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0064  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0065  40       Requested Deliv
     C                     MOVEL*BLANK    WN0066  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0067 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0068  70       Load ID
     C                     Z-ADD*ZERO     WN0069  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0070 112       Rated Freight
     C                     MOVEL*BLANK    WN0071  1        LTL Flag
     C                     MOVEL*BLANK    WN0072  1        Price Audit
     C                     MOVEL*BLANK    WN0073  1        Price Status
     C                     MOVEL*BLANK    WN0074  2        Shipping Method
     C                     MOVEL*BLANK    WN0075  1        Export Status
     C                     MOVEL*BLANK    WN0076  1        Palletize
     C                     MOVEL*BLANK    WN0077  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0078  1        Slip Sheet
     C                     MOVEL*BLANK    WN0079  1        Age Code
     C                     Z-ADD*ZERO     WN0080  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0081  1        Load Type
     C                     Z-ADD*ZERO     WN0082  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0083  1        Load Plan Order
     C                     MOVEL*BLANK    WN0084  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0085  70       Resell Referenc
     C                     MOVEL*BLANK    WN0086 30        Special Comment
     C                     MOVEL*BLANK    WN0087 30        Special Comment
     C                     MOVEL*BLANK    WN0088  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0089  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0090  2        Manager Level C
     C                     MOVEL*BLANK    WN0091  3        VP Level Code
     C                     Z-ADD*ZERO     WN0092  70       Attach to Order
     C                     MOVEL*BLANK    WN0093  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0094  70       Invoice Number
     C                     MOVEL*BLANK    WN0095  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0096  70       Invoice Date
     C                     MOVEL*BLANK    WN0097  2        Event Code
     C                     MOVEL*BLANK    WN0098  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0099  1        Modified Flag
     C                     Z-ADD*ZERO     WN0100 112       A/R order Value
     C                     MOVEL*BLANK    WN0101  1        Billing Activit
     C                     MOVEL*BLANK    WN0102  1        Block Order Fla
     C                     MOVEL*BLANK    WN0103  1        Order Certifica
     C                     Z-ADD*ZERO     WN0104 112       Invoice Order V
     C                     MOVEL*BLANK    WN0105  1        Process Sts for
     C                     MOVEL*BLANK    WN0106  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0107  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0108  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0109  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0110  1        Email Cust On O
     C                     MOVEL*BLANK    WN0111  1        Order Emailed
     C                     MOVEL*BLANK    WN0112  1        Export Docs Go
     C                     MOVEL*BLANK    WN0113  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0114  1        Broker Order St
     C                     MOVEL*BLANK    WN0115  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0116  2        TPM Freight Ord
     C                     MOVEL*BLANK    WN0117  2        Export USDA App
     C                     MOVEL*BLANK    WN0118  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0119  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0120  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0121  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0122  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0123  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0124  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0125  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0126  60       Time of Origina
     C                     Z-ADD*ZERO     WN0127  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0128  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0129  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0130 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0131 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0132 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0133 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0134 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0135  70       Claim Number
     C                     MOVEL*BLANK    WN0136  1        EDI Status 1
     C                     MOVEL*BLANK    WN0137  1        EDI Status 2
     C                     MOVEL*BLANK    WN0138  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0139  60       Job Time
     C                     MOVEL*BLANK    WN0140 10        User Id
     C                     MOVEL*BLANK    WN0141 10        Job Name
     C                     Z-ADD*ZERO     WN0142  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBC4NB           Order Number
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSB    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0003    WBFUSX    P      Order Requires
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * ** Chg line status to Entered when errors so Order will be review
     C                     MOVEL'E'       WBGWST           Header Status
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Primal Grp Code   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
      * Setup key
     C                     Z-ADDP2AIC3    WCAIC3           Company Number
     C                     Z-ADDWAHGCD    WCHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0026           Primal Group Co
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCXRCD    YL0026           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Item Def/TFExp/CO RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWAHGCD    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BYREA1              90    *
      * Data record not found
     C   90                MOVEL'USR1160' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDP3ST    YL0027           TF Co-Ownership
     C                     MOVELWDS9ST    YL0028           Item TF Exempt
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELP2AJCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEWPST    WUWPST           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV8CD           Company Value C
      * Setup key
     C                     Z-ADDP2AIC3    WFAIC3           Company Number
     C                     MOVEL@CN,002   WFV8CD           Company Value C
      * Establish starting position
     C           KRSSF     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFM8NB    WN0143           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELP2AJCD    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGF8NA    WUG0TX           Warehouse Descr
     C                     MOVELWGXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP2AIC3    WHAIC3           Company Number
     C                     Z-ADDWABKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0032           Type Code
     C                     Z-ADD*ZERO     YL0033           Absorbed Freigh
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHBOCD    YL0032           Type Code
     C                     Z-ADDWHTBNB    YL0033           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDP2AIC3    WIAIC3           Company Number
     C                     MOVELYL0044    WIQ7CD           Price Method Co
      * Establish starting position
     C           KRSSI     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0041           Price Method Ty
     C                     MOVEL*BLANK    YL0042           PMH Price Type
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIV8ST    YL0041           Price Method Ty
     C                     MOVELWIH3ST    YL0042           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Prc Mth Typ by Sys RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJBYST    WQSJ01           System Using Pr
     C           *LIKE     DEFN WJAIC3    WQSJ02           Company Number
     C           *LIKE     DEFN WJQ7CD    WQSJ03           Price Method Co
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           System Using Pr
     C                     KFLD           WQSJ02           Company Number
     C                     KFLD           WQSJ03           Price Method Co
      * Setup key
     C                     MOVEL'O'       WQSJ01           System Using Pr
     C                     Z-ADDP2AIC3    WQSJ02           Company Number
     C                     MOVELYL0002    WQSJ03           Price Method Co
      * Establish starting position
     C           KRSSJ     SETLL@IHREFI                    *
     C           KRSSJ     READE@IHREFI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0041           Price Method Ty
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJV8ST    YL0041           Price Method Ty
     C           KRSSJ     READE@IHREFI                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Edt for Existing   RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WKBKC7    WQSK02           Ship To Custome
     C           *LIKE     DEFN WKHGCD    WQSK03           Item Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Ship To Custome
     C                     KFLD           WQSK03           Item Code
      * Setup key
     C                     Z-ADDP2AIC3    WQSK01           Company Number
     C                     Z-ADDWABKC7    WQSK02           Ship To Custome
     C                     Z-ADDWAHGCD    WQSK03           Item Code
      * Establish starting position
     C           KRSSK     SETLL@CIREWP                    *
     C           KRSSK     READE@CIREWP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Effective Date GE DB1.Effective Date
      *   |- c2    : PAR.Effective Date LE DB1.End Date Effective
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           ##JDT     IFGE WKAUDT                     *IF
     C           ##JDT     IFLE WKCWDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,003   W0RTN            *Return code
     C                     END                             *FI
     C                     Z-ADDWKL6NB    YL0047           Contract Number
     C           KRSSK     READE@CIREWP                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Val. Contract #    RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLL6NB    WQSL01           Contract Number
     C           *LIKE     DEFN WLAIC3    WQSL02           Company Number
     C           *LIKE     DEFN WLBKC7    WQSL03           Ship To Custome
     C           *LIKE     DEFN WLHGCD    WQSL04           Item Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Contract Number
     C                     KFLD           WQSL02           Company Number
     C                     KFLD           WQSL03           Ship To Custome
     C                     KFLD           WQSL04           Item Code
      * Setup key
     C                     Z-ADDYL0047    WQSL01           Contract Number
     C                     Z-ADDP2AIC3    WQSL02           Company Number
     C                     Z-ADDWABKC7    WQSL03           Ship To Custome
     C                     Z-ADDWAHGCD    WQSL04           Item Code
      * Establish starting position
     C           KRSSL     SETLL@CIREWO                    *
     C           KRSSL     READE@CIREWO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWLAUDT    WN0149           Effective Date
     C                     Z-ADDWLCWDT    WN0150           End Date Effect
     C                     Z-ADDWLDQQT    WN0151           Maximum Quantit
     C                     Z-ADDWLHFQT    WN0152           Quantity Sold
     C           KRSSL     READE@CIREWO                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT PD Order Detail    CR - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0153  60       Job Time
     C                     MOVEL*BLANK    WN0154 10        User Id
     C                     MOVEL*BLANK    WN0155 10        Job Name
     C                     Z-ADD*ZERO     WN0156  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BGWKL0
     C                     Z-ADDP2AIC3    WMAIC3           Company Number
     C                     Z-ADDP4C4NB    WMC4NB           Order Number
     C                     Z-ADDYL0013    WMDPNB           Order Sequence
     C                     Z-ADDWN0001    WMUENB           Order Secondary
     C                     Z-ADDWAHGCD    WMHGCD           Item Code
     C                     MOVELP2AJCD    WMAJCD           Warehouse Code
     C                     Z-ADDP1BKC7    WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMCFC7           Order Group Cod
     C                     MOVELWUGMST    WMGMST           Detail Line Sta
     C                     MOVELP4GNST    WMGNST           Detail Line Sta
     C                     Z-ADD*ZERO     WMMAVA           Billing Detail
     C                     Z-ADD*ZERO     WMKDVA           Billing Detail
     C                     Z-ADD*ZERO     WML8VA           Billing Detail
     C                     Z-ADD*ZERO     WML9VA           Quantity to Sub
     C                     MOVELYL0068    WMGTST           Comment Print A
     C                     MOVELYL0069    WMGVST           Comment Print I
     C                     MOVELYL0070    WMGUST           Comment Print P
     C                     MOVELYL0071    WMQFST           Comment Print S
     C                     Z-ADDYL0066    WMAYVA           Extended Amount
     C                     Z-ADDP4EXDT    WMEXDT           Market Pricing
     C                     MOVELP4LQCD    WMLQCD           Commodity Marke
     C                     MOVELYL0001    WMRDCD           Date Method Cod
     C                     MOVELYL0002    WMQ7CD           Price Method Co
     C                     Z-ADDYL0039    WMBZPR           Price Overage O
     C                     Z-ADD*ZERO     WML6NB           Contract Number
     C                     MOVELP4U1ST    WMU1ST           Price Status
     C                     Z-ADD*ZERO     WMGIDT           Pricing Date Us
     C                     MOVELWN0002    WMCRCD           U/M - Base Pric
     C                     MOVELWN0003    WMAGCD           U/M - Ordered
     C                     MOVELYL0072    WMRZST           Work Confirm St
     C                     MOVELYL0073    WMR0ST           Work Over/Short
     C                     MOVELWN0004    WMR1ST           OD Production P
     C                     MOVELP4G7NA    WMG7NA           Order Desc. Lin
     C                     MOVELP4G8NA    WMG8NA           Order Desc. Lin
     C                     MOVEL*BLANK    WMRPCD           Age Code
     C                     MOVELP4VEST    WMVEST           Palletize
     C                     MOVEL'N'       WMVGST           Slip Sheet
     C                     MOVELP4AVST    WMAVST           Catch Weight St
     C                     MOVELP4U0ST    WMU0ST           Price Audit
     C                     MOVEL'MTH'     WMRFCD           Price Audit Rea
     C                     MOVELP4FZST    WMFZST           Production Date
     C                     Z-ADDP4R1NB    WMR1NB           Rated Freight
     C                     Z-ADDWAAVQT    WMAVQT           Quantity Ordere
     C                     Z-ADDYL0005    WMD0WG           Weight Ordered
     C                     Z-ADDYL0061    WMCCQT           Quantity Schedu
     C                     Z-ADDYL0060    WMAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WMCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WMATWG           Weight Shipped
     C                     Z-ADDP4AQCS    WMAQCS           Unit Cost Prici
     C                     Z-ADDP4AGCS    WMAGCS           Unit Cost Per P
     C                     Z-ADDYL0036    WMAKPR           Unit Price
     C                     Z-ADD*ZERO     WMALPR           Unit Price - Cr
     C                     Z-ADDP4AUPR    WMAUPR           Unit Price Orde
     C                     Z-ADDP4AVWG    WMAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WMA4WG           Tare Weight Tot
     C                     Z-ADDYL0008    WMA5DT           Requested Ship
     C                     Z-ADDYL0009    WMAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WMGNDT           Actual Shipped
     C                     MOVEL'Y'       WMAMST           Affect Inventor
     C                     MOVEL'Y'       WMANST           Affect Sales Do
     C                     MOVEL'Y'       WMVAST           Affect Sales Pn
     C                     Z-ADDP4RGNB    WMRGNB           Item Structure
     C                     Z-ADDP4RHNB    WMRHNB           Item Structure
     C                     Z-ADDP4RINB    WMRINB           Item Structure
     C                     MOVELP4RBCD    WMRBCD           Item Level
     C                     MOVEL*BLANK    WMHICD           Quality Level
     C                     MOVEL*BLANK    WMRNCD           Pricing Product
     C                     MOVEL*BLANK    WMROCD           Season Product
     C                     Z-ADDP4CXDT    WMCXDT           Date of Origina
     C                     MOVELP4AJVN    WMAJVN           User Profile Na
     C                     MOVELP4KXCD    WMKXCD           Country Code
     C                     MOVELP4JPCD    WMJPCD           Event Code
     C                     MOVEL*BLANK    WMCQCD           Reason Code
     C                     MOVELP4R4CD    WMR4CD           Sales Route Cod
     C                     MOVELYL0074    WMZ1ST           Modified Flag
     C                     MOVEL*BLANK    WMZ3ST           Substituted Fla
     C                     MOVELYL0075    WMZ4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     WMDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WMB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WMA1AA           Ham Group Numbe
     C                     MOVELYL0076    WMFZSX           OD Adj Type Ove
     C                     MOVELP4F0SX    WMF0SX           Affect Trade Fu
     C                     MOVELP4F1SX    WMF1SX           Affect Commissi
     C                     MOVELP4F2SX    WMF2SX           Affect Pricing
     C                     MOVELP4F3SX    WMF3SX           Released by Use
     C                     MOVELP4F4SX    WMF4SX           Ord TF Exempt C
     C                     MOVELP4F5SX    WMF5SX           OD Pallet Type
     C                     MOVELYL0077    WMF6SX           Production Ware
     C                     MOVELP4F7SX    WMF7SX           OD Price Type
     C                     Z-ADD*ZERO     WMNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WMNUDT           Consumed Item C
     C                     Z-ADDYL0064    WMNVDT           Deadline Depart
     C                     Z-ADDYL0034    WMNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WMNXDT           OD Unused Date
     C                     Z-ADDYL0065    WMBUTM           Deadline Depart
     C                     Z-ADDP2BVTM    WMBVTM           Price Code
     C                     Z-ADDP4BWTM    WMBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WMBXTM           Substitution Li
     C                     Z-ADD*ZERO     WMBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WMH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WMH6NX           Warehouse Avg P
     C                     Z-ADDP4H7NX    WMH7NX           OD Item Target
     C                     Z-ADD*ZERO     WMH8NX           OD Minimum Unit
     C                     Z-ADDP4H9NX    WMH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WMDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WMDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WMDXPR           OD Gate Price A
     C                     Z-ADD*ZERO     WMDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WMDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WMGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WMGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WMGUPR           OD Unused Prc 8
     C                     MOVEL*BLANK    WMHOST           OD MPR Sent to
     C                     MOVELYL0067    WMHPST           OD MPR Prc Read
     C                     MOVEL*BLANK    WMIOST           OD UnUsed Price
     C                     Z-ADD*ZERO     WMPEWG           Weight Amount E
     C                     Z-ADDP2RINY    WMRINY           Item Age Days
     C                     Z-ADDWN0012    WMTIDT           Production Ovr
     C                     Z-ADDWN0013    WMTJDT           Production Ovr
     C                     MOVEL*BLANK    WMH2ST           OD UnUsed Statu
     C                     MOVEL*BLANK    WMH0ST           OD UnUsed Statu
     C                     MOVELYL0014    WMH1ST           Order Line Erro
     C                     Z-ADD*ZERO     WMTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WMTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WMTMDT           OD UnUsed Date
     C                     MOVELYL0078    WMUVST           EDI Status 1
     C                     MOVELYL0079    WMUWST           EDI Status 2
     C                     MOVELYL0080    WMUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    WMRPCD           Age Code
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##PGM     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WMAIC3    WQ0088  30       Company Number
     C                     PARM WMHGCD    WQ0089  70       Item Code
     C           WMNUDT    PARM *ZERO     WQ0090  70       Component Item
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SNRVGN
     C           KLCRSM    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRSM    SETLL@BGWKL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1310' W0RTN   7
      * Send message 'Order Detail           EX'
     C                     MOVEL'USR1310' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@BGWKL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELWMAJCD    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WMF6SX           Production Ware
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAOCD    WMF6SX           Production Ware
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ** Populate Order Detail Fields & create OD record
      *================================================================
     C                     MOVELP4H1ST    YL0014           Order Line Erro
     C                     ADD  1         YL0013           Order Sequence
     C                     Z-ADD1         WN0001           Order Secondary
      * RTV for Ord.Detail     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDC3XFR'              90  RTV for Ord.Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0001  30       Company Number
     C                     PARM WAHGCD    WQ0002  70       Item Code
     C           P4G7NA    PARM *BLANK    WQ0003 30        Description Lin
     C           P4G8NA    PARM *BLANK    WQ0004 30        Description Lin
     C           WN0003    PARM *BLANK    WQ0005  2        U/M - Primary
     C           WN0002    PARM *BLANK    WQ0006  2        U/M - Pricing
     C           P4AVWG    PARM *ZERO     WQ0007 112       Unit Weight
     C           YL0015    PARM *BLANK    WQ0008  2        Item Level
     C           P4FZST    PARM *BLANK    WQ0009  1        Production Date
     C           P4AVST    PARM *BLANK    WQ0010  1        Catch Weight St
     C           P4RINB    PARM *ZERO     WQ0011  30       Item Structure
     C           P4RHNB    PARM *ZERO     WQ0012  30       Item Structure
     C           P4RGNB    PARM *ZERO     WQ0013  30       Item Structure
     C           YL0016    PARM *BLANK    WQ0014  3        Default Commod
     C           YL0017    PARM *ZERO     WQ0015  30       Transportation
     C           YL0018    PARM *BLANK    WQ0016  3        Item Type Code
     C           YL0019    PARM *BLANK    WQ0017  7        Commodity Price
     C           YL0020    PARM *BLANK    WQ0018  3        Default Warehou
     C           YL0021    PARM *BLANK    WQ0019  3        Price Method De
     C           YL0022    PARM *ZERO     WQ0020  52       Fresh Chilling
     C           YL0023    PARM *BLANK    WQ0021  1        Variety/Rendere
     C           YL0024    PARM *ZERO     WQ0022 112       Item Target Pri
     C           YL0025    PARM *BLANK    WQ0023  1        Error Status
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDC3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Primal Grp Code   RT - Company Item  * 
     C                     EXSR SCRVGN
      * Rtv Item Def/TFExp/CO RT - Item Default  * 
     C                     EXSR SDRVGN
     C                     Z-ADDWAHGCD    YL0029           Item Code
      * Set/Val OH TF Exempt  IF
      * Set / Validate TF Exempt code values              RMC 8/24/05
      * CASE: PAR.OH TF Exempt Code is Blank
     C           WN0019    IFEQ *BLANK                     *IF
      * VAL: Customer Exempt Code  w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C           YL0031    IFEQ 'NE'                       *IF
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Item Codes
     C           YL0030    IFEQ 'EP'                       *IF
     C           YL0030    OREQ 'NE'
     C                     MOVEL*BLANK    WN0019           OH TF Exempt Co
     C                     MOVELYL0030    WN0019           OH TF Exempt Co
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
     C           YL0031    IFEQ 'EC'                       *IF
     C                     MOVEL*BLANK    WN0019           OH TF Exempt Co
     C                     MOVELYL0031    WN0019           OH TF Exempt Co
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
     C           YL0030    IFEQ 'NE'                       *IF
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C           YL0027    IFEQ 'S'                        *IF
     C           YL0027    OREQ 'T'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0029    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0029    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'TF Exempt-Item & Cust'
     C                     MOVEL'USR4203' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EC'      YL0030           Ord TF Exempt C
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EP'      YL0030           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate after 1 line item has been entered
      * If not Pre-Commencement, set exempt code
      * CASE: PAR.OH TF Exempt Code is Not Pre-Commencement
     C           WN0019    IFEQ 'EC'                       *IF
     C           WN0019    OREQ 'EP'
     C           WN0019    OREQ 'NE'
      * VAL: Customer Exempt Code w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C           YL0031    IFEQ 'NE'                       *IF
      * Line item must eq whats in the header, else Error
      * CASE: PAR.OH TF Exempt Code NE PAR.Ord TF Exempt Code
     C           WN0019    IFNE YL0030                     *IF
      * Setup message data for message
      * Send message 'Tf Exempt - mix error'
     C                     MOVEL'USR3588' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       YL0025           Error Status
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
     C           YL0031    IFEQ 'EC'                       *IF
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
     C           YL0030    IFEQ 'NE'                       *IF
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C           YL0027    IFEQ 'S'                        *IF
     C           YL0027    OREQ 'T'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0029    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0029    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'TF Exempt-Item & Cust'
     C                     MOVEL'USR4203' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EC'      YL0030           Ord TF Exempt C
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EP'      YL0030           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'PC'      YL0030           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0143 155       System Value Nu
      *
      * Rtv Whs Typ/FZNCHLTME IF
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SERVGN
      * CASE: PAR.Warehouse Type is Frozen
     C           WUWPST    IFEQ 'FZ'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SFRVGN
     C                     Z-ADDWN0143    WUCHTM           Fresh Chilling
     C                     END                             *FI
      * Val ItmBal.Unit Cst    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDMCXFR'              90  Val ItmBal.Unit
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0024  30       Company Number
     C                     PARM WAHGCD    WQ0025  70       Item Code
     C                     PARM P2AJCD    WQ0026  3        Warehouse Code
     C           P4AGCS    PARM *ZERO     WQ0027 114       Unit Cost Per P
     C           YL0025    PARM *BLANK    WQ0028  1        Error Status
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
     C                     EXSR SGRVGN
      * Rtv Plan Prod Sts     XF - Company Item Ext  * 
     C                     CALL 'PNHKXFR'              90  Rtv Plan Prod S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0029  30       Company Number
     C                     PARM WAHGCD    WQ0030  70       Item Code
     C           WN0004    PARM *BLANK    WQ0031  1        Plan Production
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNHKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
     C                     EXSR SHRVGN
     C                     Z-ADD*ZERO     YL0034           OD Price Type R
     C                     MOVE P2BVTM    YL0034           OD Price Type R
     C                     MOVELP4GMST    WUGMST           Detail Line Sta
      * 4/18/13 put into par and use for output to OD
      * Rtv Max Wt and price  XF - Customer Price Detail  * 
     C                     CALL 'PNTBXFR'              90  Rtv Max Wt and
     C                     PARM *BLANK    W0RTN   7
     C           W0RTN     PARM *BLANK    WQ0032  7        *Return code
     C                     PARM P1BKC7    WQ0033  70       Ship To Custome
     C                     PARM P2BVTM    WQ0034  60       Price Code
     C                     PARM WAHGCD    WQ0035  70       Item Code
     C           YL0035    PARM *ZERO     WQ0036 112       Maximum Contrac
     C           YL0036    PARM *ZERO     WQ0037 114       Customer Price
     C           YL0037    PARM *BLANK    WQ0038  3        Commodity Marke
     C           YL0002    PARM *BLANK    WQ0039  3        Price Method Co
     C           YL0001    PARM *BLANK    WQ0040  3        Date Method Cod
     C           YL0038    PARM *BLANK    WQ0041  1        Contract Unit T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0036    YL0039           Price Overage O
     C                     MOVEL'N'       YL0025           Error Status
      *
     C                     Z-ADD*ZERO     WN0144 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0145 112       Total Quantity
     C                     Z-ADD*ZERO     WN0146 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0147 114       Customer Price
     C                     MOVEL*BLANK    WN0148  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       YL0025           Error Status
     C           WAAVQT    MULT P4AVWG    YL0043           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1BKC7    PABKC7           Ship To Custome
     C                     Z-ADDP2BVTM    PABVTM           Price Code
     C                     Z-ADDWAHGCD    PAHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C           WN0144    PARM WN0144    WQ0042 112       Total Weight Or
     C                     PARM P4C4NB    WQ0043  70       Order Number
     C           WN0145    PARM WN0145    WQ0044 112       Total Quantity
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  YL0043    WN0144           Total Weight Or
     C                     ADD  WAAVQT    WN0145           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1BKC7    WQ0045  70       Ship To Custome
     C                     PARM P2BVTM    WQ0046  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0047  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0048  70       Price End Date
     C                     PARM WAHGCD    WQ0049  70       Item Code
     C           WN0146    PARM *ZERO     WQ0050 112       Maximum Contrac
     C           WN0147    PARM *ZERO     WQ0051 114       Customer Price
     C                     PARM *BLANK    WQ0052  3        Commodity Marke
     C           YL0044    PARM *BLANK    WQ0053  3        Price Method Co
     C                     PARM *BLANK    WQ0054  3        Date Method Cod
     C           WN0148    PARM *BLANK    WQ0055  1        Contract Unit T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0044    YN0003           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
     C                     EXSR SIRVGN
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0148    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0144    IFGT WN0146                     *IF
     C                     MOVEL'Y'       YL0025           Error Status
     C           WN0144    SUB  WN0146    YL0045           Weight Allocate
      * Setup message data for message
     C                     Z-ADDP2BVTM    ZA0003           Price Code
     C                     Z-ADDYL0045    ZA0004           Weight Allocate
     C                     Z-ADDWN0146    ZA0005           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WAHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWAHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0145    IFGT WN0146                     *IF
     C                     MOVEL'Y'       YL0025           Error Status
     C           WN0145    SUB  WN0146    YL0045           Weight Allocate
      * Setup message data for message
     C                     Z-ADDP2BVTM    ZA0007           Price Code
     C                     Z-ADDYL0045    ZA0008           Weight Allocate
     C                     Z-ADDWN0146    ZA0009           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WAHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWAHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0010           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0010           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           YL0025    IFEQ 'N'                        *IF
     C                     Z-ADDWN0147    YN0004           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0042    IFEQ 'I'                        *IF
     C                     Z-ADDWN0147    YN0004           Price Overage O
     C                     Z-ADD*ZERO     YL0040           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0042    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     YN0004           Price Overage O
     C                     Z-ADDWN0147    YL0040           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Flag if Price Code Weight maximum has been reached
      * CASE: LCL.Error Status is yes
     C           YL0025    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0014           Order Line Erro
     C                     MOVEL'WT'      YL0014           Order Line Erro
     C                     MOVEL*BLANK    YL0046           Order Requires
     C                     MOVEL'Y'       YL0046           Order Requires
      * CHG Ord Req's Rvw-JCO  CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0001           Company Number
     C                     Z-ADDP4C4NB    WL0002           Order Number
     C                     MOVELYL0046    WL0003    P      Order Requires
     C                     EXSR SBCHRC
     C                     MOVEL*BLANK    YL0046           Order Requires
     C                     MOVEL'E'       WUGMST           Detail Line Sta
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0149  70       Effective Date
     C                     Z-ADD*ZERO     WN0150  70       End Date Effect
     C                     Z-ADD*ZERO     WN0151 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0152 112       Quantity Sold
      *
      * EDT Order Detail Edits IF
     C                     MOVEL*BLANK    YL0058           Contract Exists
     C                     MOVEL*BLANK    YL0048           Cntrt Enter no
     C                     MOVEL*BLANK    YL0049           Cntrt.# does no
     C                     MOVEL*BLANK    YL0050           Qty ordered > C
     C                     MOVEL*BLANK    YL0051           Contract Expire
     C                     MOVEL*BLANK    YL0052           Price Override
     C                     MOVEL*BLANK    YL0053           Price Method QT
     C                     MOVEL*BLANK    YL0054           Prc Code FRM or
     C                     MOVEL*BLANK    YL0055           Mkt Pricing Dat
     C                     MOVEL*BLANK    YL0056           Mkt Meth. and D
     C                     MOVEL*BLANK    YL0057           Price Override
     C                     MOVEL*BLANK    YL0059           Price Override
      * Get Price Method Type
      * RTV Prc Mth Typ by Sys RT - Price Method Header  * 
     C                     EXSR SJRVGN
      * Check if Contract exists for Item
      * A Contract Exists for this customer and item.
      * CASE: PAR.Contract Number is Zero
     C           YL0047    IFEQ *ZERO                      *IF
      * RTV Edt for Existing   RT - OPP Item Contract  * 
     C                     EXSR SKRVGN
     C                     Z-ADDYL0047    WUL6NB           Contract Number
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVEL'Y'       YL0058           Contract Exists
     C                     END                             *FI
     C                     END                             *FI
      * Edit Contract Number
      * CASE: PAR.Contract Number is Entered
     C           YL0047    IFGT *ZERO                      *IF
      * RTV Val. Contract #    RT - OPP Item Contract  * 
     C                     EXSR SLRVGN
      * Set Contract Error Parms
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       YL0049           Cntrt.# does no
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0152    ADD  WAAVQT    WUCAQT           Total Quantity
      * CASE: WRK.Total Quantity Ordered GT PAR.Maximum Quantity
     C           WUCAQT    IFGT WN0151                     *IF
     C                     MOVEL'Y'       YL0050           Qty ordered > C
     C                     END                             *FI
      * CASE: PAR.End Date Effective LE PAR.Order Date
     C           WN0150    IFLE ##JDT                      *IF
     C                     MOVEL'Y'       YL0051           Contract Expire
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validity Checking
      * Price Override and Manual Price Method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Type is Manual Pricing
      *   |- c2    : PAR.Price Overage Override is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0041    IFEQ 'M'                        *IF
     C           YL0039    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0052           Price Override
     C                     END                             *FI
      * Price override and EXT price method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Type is Extended Pricing
      *   |- c2    : PAR.Price Overage Override is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0041    IFEQ 'X'                        *IF
     C           YL0039    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0057           Price Override
     C                     END                             *FI
      * FRM / MKT Checks
      * CASE: PAR.Price Method Type is Market or Formula
     C           YL0041    IFEQ 'F'                        *IF
     C           YL0041    OREQ 'K'
      * Market Code Must be entered
      * CASE: PAR.Commodity Market Code is Not Entered
     C           P4LQCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0054           Prc Code FRM or
     C                     END                             *FI
      * Market Price Date field not zero
      * CASE: PAR.Market Pricing Date is NE Zero
     C           P4EXDT    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       YL0055           Mkt Pricing Dat
     C                     END                             *FI
      * CASE: PAR.Price Overage Override is Not Zeros
     C           YL0039    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       YL0059           Price Override
     C                     END                             *FI
     C                     END                             *FI
      * MKT date Method entered and Mkt Price Date both entered.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFNE *BLANK                     *IF
     C           P4EXDT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0056           Mkt Meth. and D
     C                     END                             *FI
     C           WAAVQT    MULT P4AVWG    YL0005           Weight Ordered
     C                     Z-ADD*ZERO     YL0060           Weight Schedule
     C                     Z-ADD*ZERO     YL0061           Quantity Schedu
     C                     MOVEL'N'       YL0025           Error Status
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    YL0025           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           P6EIDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  P6EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           YL0009    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  YL0009    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHGCD    WQ0056  70       Item Code
     C                     PARM P2AJCD    WQ0057  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0058  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0059 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0060 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0061 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0062 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0063 30        Error Reason De
     C                     PARM P2AIC3    WQ0064  30       Company Number
     C                     PARM YL0009    WQ0065  70       Scheduled Ship
     C                     PARM P6EIDT    WQ0066  70       Requested Deliv
     C                     PARM P2RINY    WQ0067  40       Item Age Days
     C                     PARM WN0012    WQ0068  70       Production Ovr
     C                     PARM WN0013    WQ0069  70       Production Ovr
     C           YL0062    PARM YL0062    WQ0070  70       Production AgeD
     C           YL0063    PARM YL0063    WQ0071  70       Production AgeD
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'V'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0062    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0013
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDP2RINY    ZA0014           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0012    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WN0013    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0016
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDP2RINY    ZA0017           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0012    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WN0013    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDP2RINY    ZA0020           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0012    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0021
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WN0013    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDP2RINY    ZA0023           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0012    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0024
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WN0013    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0025
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           WN0012    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADDP2RINY    ZA0026           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0062    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0027
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  YL0063    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0028
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       YL0025           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Flag if Age Days is invalid
      * CASE: LCL.Error Status is yes
     C           YL0025    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0014           Order Line Erro
     C                     MOVEL'AC'      YL0014           Order Line Erro
     C                     MOVEL*BLANK    YL0046           Order Requires
     C                     MOVEL'Y'       YL0046           Order Requires
      * CHG Ord Req's Rvw-JCO  CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0001           Company Number
     C                     Z-ADDP4C4NB    WL0002           Order Number
     C                     MOVELYL0046    WL0003    P      Order Requires
     C                     EXSR SBCHRC
     C                     MOVEL*BLANK    YL0046           Order Requires
     C                     MOVEL'E'       WUGMST           Detail Line Sta
     C                     END                             *FI
      * ** Default Deadline depart date if it is zeros
      * CASE: PAR.Deadline Depart Date LH is not entered
     C           P4NVDT    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0009    YL0064           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP4NVDT    YL0064           Deadline Depart
     C                     END                             *FI
      * ** Default Deadline depart time if it is zeros
      * CASE: PAR.Deadline Depart Time LH is not entered
     C           P4BUTM    IFEQ *ZERO                      *IF
     C                     Z-ADD080000    YL0065           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP4BUTM    YL0065           Deadline Depart
     C                     END                             *FI
      * ** Allocation
      * ** Allocate if Productio Plan Status = Yes (" ")
      * CASE: PAR.OD Production Plan Sts is Yes
     C           WN0004    IFEQ *BLANK                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0072  30       Company Number
     C                     PARM P4C4NB    WQ0073  70       Order Number
     C                     PARM YL0013    WQ0074  30       Order Sequence
     C                     PARM WN0001    WQ0075  30       Order Secondary
     C                     PARM WAHGCD    WQ0076  70       Item Code
     C                     PARM P2AJCD    WQ0077  3        Warehouse Code
     C                     PARM YL0009    WQ0078  70       Ship Date USR
     C                     PARM WAAVQT    WQ0079 112       Quantity Ordere
     C                     PARM YL0005    WQ0080 112       Weight Ordered
     C           YL0061    PARM YL0061    WQ0081 112       Quantity Schedu
     C           YL0060    PARM YL0060    WQ0082 112       Weight Schedule
     C                     PARM 'OA'      WQ0083  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0084 10        PSAA Program Na
     C                     PARM P2RINY    WQ0085  40       Item Age Days
     C                     PARM WN0012    WQ0086  70       Production Ovr
     C                     PARM WN0013    WQ0087  70       Production Ovr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Flag error if weight is not scheduled and Prod Plan Sts is Yes
      * CASE: LCL.Weight Scheduled is Equal to zero
     C           YL0060    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    YL0014           Order Line Erro
     C                     MOVEL'PA'      YL0014           Order Line Erro
     C                     MOVEL*BLANK    YL0046           Order Requires
     C                     MOVEL'Y'       YL0046           Order Requires
      * CHG Ord Req's Rvw-JCO  CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0001           Company Number
     C                     Z-ADDP4C4NB    WL0002           Order Number
     C                     MOVELYL0046    WL0003    P      Order Requires
     C                     EXSR SBCHRC
     C                     MOVEL*BLANK    YL0046           Order Requires
     C                     MOVEL'E'       WUGMST           Detail Line Sta
     C                     END                             *FI
     C                     END                             *FI
     C           YL0005    MULT YL0039    YL0066    H      Extended Amount
      * ** MPR Ready if weight ordered and price found
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Price Overage Override is Greater than zero
      *   |- c2    : PAR.Weight Ordered is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0039    IFGT *ZERO                      *IF
     C           YL0005    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0067           OD MPR Prc Read
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0067           OD MPR Prc Read
     C                     END                             *FI
      * ** Use qty/wgt scheduled from the Allocation routine
      * CRT PD Order Detail    CR - Order Detail  * 
     C                     EXSR SMCRRC
     C                     ADD  YL0005    P5IEWG           Total Weight Or
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4R1ST           OD Production P
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WCAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WCAIWG           Unit Weight
     C                     Z-ADD*ZERO     WCCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WCC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WCURTN           Number Cases On
     C                     Z-ADD*ZERO     WCAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCTFNB           Transportation
     C                     Z-ADD*ZERO     WCTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WCTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WCBLPR           Market Overage
     C                     Z-ADD*ZERO     WCBMPR           Standard Overag
     C                     Z-ADD*ZERO     WCCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WCCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WCSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WCPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WCICN1           Item Category N
     C                     Z-ADD*ZERO     WCICN2           Item Category N
     C                     Z-ADD*ZERO     WCV2NB           Item Category N
     C                     Z-ADD*ZERO     WCITCN           Item Category N
     C                     Z-ADD*ZERO     WCITC5           Item Category N
     C                     Z-ADD*ZERO     WCICN6           Item Category N
     C                     Z-ADD*ZERO     WCICN7           Item Category N
     C                     Z-ADD*ZERO     WCICN8           Item Category N
     C                     Z-ADD*ZERO     WCICN9           Item Category N
     C                     Z-ADD*ZERO     WCICN0           Item Category N
     C                     Z-ADD*ZERO     WCSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WCA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WCSJNB           Production Lead
     C                     Z-ADD*ZERO     WCSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WCSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WCSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WCCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WCCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WCILNB           Packages per ca
     C                     Z-ADD*ZERO     WCCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WCCINB           PM Batch Size
     C                     Z-ADD*ZERO     WCCJNB           Package Level s
     C                     Z-ADD*ZERO     WCCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WCCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WCCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WCCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WCCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WCCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WCCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WCCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WCC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WCB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WCB5NB           PM Line Number
     C                     Z-ADD*ZERO     WCBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WCBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WCF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WCF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WCF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WCBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WCBNNB           Production Qty
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDACC8           Vendor item Def
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           Packages per ca
     C                     Z-ADD*ZERO     WDCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           Package Level s
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAHTM           Job Time
     C                     Z-ADD*ZERO     WDEKDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFM8NB           System Value Nu
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHR5NB           Deliver after t
     C                     Z-ADD*ZERO     WHR6NB           Deliver before
     C                     Z-ADD*ZERO     WHTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WHMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WHW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Define work field Price Start Date
     C                     Z-ADD*ZERO     WUPLDT  70
      * Define work field Price End Date
     C                     Z-ADD*ZERO     WUPMDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIRMNY           Decimal Places
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKAUDT           Effective Date
     C                     Z-ADD*ZERO     WKCWDT           End Date Effect
     C                     Z-ADD*ZERO     WKANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WKDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WKHFQT           Quantity Sold
     C                     Z-ADD*ZERO     WKL6NB           Contract Number
     C                     Z-ADD*ZERO     WKFSQT           Open Commitment
     C                     Z-ADD*ZERO     WKB0PR           Contract Price
     C                     Z-ADD*ZERO     WKGBDT           Contract Mkt Pr
     C                     Z-ADD*ZERO     WKGCDT           Entered Date
     C                     Z-ADD*ZERO     WKGDDT           Date Sold
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Contract Number
     C                     Z-ADD*ZERO     WUL6NB  70
      * Define work field Total Quantity Ordered
     C                     Z-ADD*ZERO     WUCAQT 112
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMDPNB           Order Sequence
     C                     Z-ADD*ZERO     WMUENB           Order Secondary
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WMMAVA           Billing Detail
     C                     Z-ADD*ZERO     WMKDVA           Billing Detail
     C                     Z-ADD*ZERO     WML8VA           Billing Detail
     C                     Z-ADD*ZERO     WML9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WMAYVA           Extended Amount
     C                     Z-ADD*ZERO     WMEXDT           Market Pricing
     C                     Z-ADD*ZERO     WMBZPR           Price Overage O
     C                     Z-ADD*ZERO     WML6NB           Contract Number
     C                     Z-ADD*ZERO     WMGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WMR1NB           Rated Freight
     C                     Z-ADD*ZERO     WMAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WMD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WMCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WMAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WMCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WMATWG           Weight Shipped
     C                     Z-ADD*ZERO     WMAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WMAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WMAKPR           Unit Price
     C                     Z-ADD*ZERO     WMALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WMAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WMAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WMA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WMA5DT           Requested Ship
     C                     Z-ADD*ZERO     WMAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WMGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMCXDT           Date of Origina
     C                     Z-ADD*ZERO     WMDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WMB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WMA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WMNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WMNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WMNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WMNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WMNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WMBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WMBVTM           Price Code
     C                     Z-ADD*ZERO     WMBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WMBXTM           Substitution Li
     C                     Z-ADD*ZERO     WMBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WMH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WMH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WMH7NX           OD Item Target
     C                     Z-ADD*ZERO     WMH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WMH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WMDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WMDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WMDXPR           OD Gate Price A
     C                     Z-ADD*ZERO     WMDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WMDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WMGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WMGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WMGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WMPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WMRINY           Item Age Days
     C                     Z-ADD*ZERO     WMTIDT           Production Ovr
     C                     Z-ADD*ZERO     WMTJDT           Production Ovr
     C                     Z-ADD*ZERO     WMTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WMTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WMTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Age Code
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field Quantity Shipped Total
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Weight Shipped Total
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field Order Line Error Type
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Item Level
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field Transportation Temp
     C                     Z-ADD*ZERO     YL0017  30
      * Define local work field Item Type Code
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0019  7
      * Define local work field Default Warehouse
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field Price Method Default
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0022  52
      * Define local work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Item Target Price
     C                     Z-ADD*ZERO     YL0024 112
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0026  6
      * Define local work field TF Co-Ownership Sts
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field Item TF Exempt Code
     C                     MOVEL*BLANK    YL0028  2
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field Ord TF Exempt Code
     C                     MOVEL*BLANK    YL0030  2
      * Define local work field Customer TF Exempt Code
     C                     MOVEL*BLANK    YL0031  2
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0032  2
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0033  52
      * Define local work field OD Price Type Ref Num
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field Customer Price /UM Prc
     C                     Z-ADD*ZERO     YL0036 114
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0037  3
      * Define local work field Contract Unit Type
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0039 114
      * Define null work field Commodity Market Code
     C                     MOVEL*BLANK    YN0001  3
      * Define null work field Date Method Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Price Method Code
     C                     MOVEL*BLANK    YN0003  3
      * Define null work field Price Overage Override
     C                     Z-ADD*ZERO     YN0004 114
      * Define local work field OD Ceiling Price
     C                     Z-ADD*ZERO     YL0040 114
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0043 112
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0044  3
      * Define local work field Weight Allocated USR
     C                     Z-ADD*ZERO     YL0045  92
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0046  2
      * Define local work field Contract Number
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field Cntrt Enter no QT Price
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field Cntrt.# does not Exit
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field Qty ordered > Contract
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field Contract Expired
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field Price Override Required
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Price Method QT & Cntrt 0
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Prc Code FRM or MKT
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field Mkt Pricing Date not 0
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Mkt Meth. and Date both
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field Price Override Req. EXT
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field Contract Exists for Item
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field Price Override not Allowd
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0060 112
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0061 112
      * Define local work field Production AgeDte Fr
     C                     Z-ADD*ZERO     YL0062  70
      * Define local work field Production AgeDte To
     C                     Z-ADD*ZERO     YL0063  70
      * Define local work field Deadline Depart Date LH
     C                     Z-ADD*ZERO     YL0064  70
      * Define local work field Deadline Depart Time LH
     C                     Z-ADD*ZERO     YL0065  60
      * Define local work field Extended Amount
     C                     Z-ADD*ZERO     YL0066 112
      * Define local work field OD MPR Prc Ready to Send
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YL0068  1
      * Define local work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YL0069  1
      * Define local work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YL0070  1
      * Define local work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YL0071  1
      * Define local work field Work Confirm Status
     C                     MOVEL*BLANK    YL0072  1
      * Define local work field Work Over/Short Status
     C                     MOVEL*BLANK    YL0073  1
      * Define local work field Modified Flag
     C                     MOVEL*BLANK    YL0074  1
      * Define local work field OD Schedule Override Sts
     C                     MOVEL*BLANK    YL0075  1
      * Define local work field OD Adj Type Override
     C                     MOVEL*BLANK    YL0076  1
      * Define local work field Production Warehouse
     C                     MOVEL*BLANK    YL0077  3
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0078  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0079  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0080  1
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0005  30
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 FZNCHLTME
00003 Y2U0003
