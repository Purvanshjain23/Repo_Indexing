// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for E1MUSRR
// ?Date: 14.08.2025 Time: 02:43:48
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

EXECUTE FUNCTION(Val Application/UserRP4IF) TYPE(EXCINTFUN)                     AA1100551;
PARAMETER(PAR.OMS_Warehouse_Code);
PARAMETER(PAR.OMS_Company_Number);
PARAMETER('OMS');
PARAMETER(PAR.OMS_Salesperson_Code);
PARAMETER(PAR.OMS_Allow_Multi_Company);
PARAMETER(PAR.OMS_Default_Printer);
PARAMETER(PAR.OMS_NAME);
PARAMETER(PAR.OMS_System_Value_Alpha);
PARAMETER(PAR.OMS_Access_Denied_Y_N);
{
 //?Execute internal function

 // Call program Val Application/User  XF.
 CALL PROGRAM(Val Application/User  XF) ('PDGXXFR');
 PARAMETER(PAR.OMS_Warehouse_Code);
 PARAMETER(PAR.OMS_Company_Number);
 PARAMETER(PAR.OMS_Application_code);
 PARAMETER(PAR.OMS_Salesperson_Code);
 PARAMETER(PAR.OMS_Allow_Multi_Company);
 PARAMETER(PAR.OMS_Default_Printer);
 PARAMETER(PAR.OMS_NAME);
 PARAMETER(PAR.OMS_System_Value_Alpha);
 PARAMETER(PAR.OMS_Access_Denied_Y_N);

 CASE;

 // IF PAR.OMS Access Denied (Y/N) is Yes
 IF PAR.OMS_Access_Denied_Y_N = 'Y';

 // Send error message - 'Access Denied for User'
 ERROR(E1I0112);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Execute function Mov ApplN to CompanyRP4US.
 EXECUTE FUNCTION(Mov ApplN to CompanyRP4US) TYPE(EXCUSRSRC) ('E1BHUFR');
 PARAMETER(PAR.OMS_System_Value_Alpha);
 {
  C***   MOVE USER SOURCE                      ***
  C                   movel     #IkrTX        ##CMP
 }

 ENDIF;

}


//?USER: Load subfile record from DBF record

EXECUTE FUNCTION(Rtv JDE E1 Vendor Info IF) TYPE(EXCINTFUN)                     AA1104352;
PARAMETER(RCD.Address_Number);
PARAMETER(RCD.Address_Line_1);
PARAMETER(RCD.Address_Line_2);
PARAMETER(RCD.Address_Line_3);
PARAMETER(RCD.Address_Line_4);
PARAMETER(RCD.Postal_Code);
PARAMETER(RCD.City);
PARAMETER(RCD.County_Name);
PARAMETER(RCD.State);
PARAMETER(RCD.Country);
PARAMETER(RCD.Phone_Prefix);
PARAMETER(RCD.Phone_Number);
PARAMETER(RCD.Phone_Prefix_Fax_1_USR);
PARAMETER(RCD.Phone_Number_Fax_1_USR);
PARAMETER(RCD.Phone_Prefix_Fax_2_USR);
PARAMETER(RCD.Phone_Number_Fax_2_USR);
{
 //?Execute internal function

 EXECUTE FUNCTION(Rtv Address Info      RT) TYPE(RTVOBJ) FILE(E10116)            AA1104345;
 PARAMETER(PAR.Address_Number);
 PARAMETER(PAR.Address_Line_1);
 PARAMETER(PAR.Address_Line_2);
 PARAMETER(PAR.Address_Line_3);
 PARAMETER(PAR.Address_Line_4);
 PARAMETER(PAR.Postal_Code);
 PARAMETER(PAR.City);
 PARAMETER(PAR.County_Name);
 PARAMETER(PAR.State);
 PARAMETER(PAR.Country);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv Phone Numbers Info RT) TYPE(RTVOBJ) FILE(E10115)           AA1104353;
 PARAMETER(PAR.Address_Number);
 PARAMETER(PAR.Phone_Prefix);
 PARAMETER(PAR.Phone_Number);
 PARAMETER(PAR.Phone_Prefix_Fax_1_USR);
 PARAMETER(PAR.Phone_Number_Fax_1_USR);
 PARAMETER(PAR.Phone_Prefix_Fax_2_USR);
 PARAMETER(PAR.Phone_Number_Fax_2_USR);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?Send Back Phone Numbers Info.
  CASE;

  // IF DB1.Phone Number Type is Fax
  IF DB1.Phone_Number_Type = 'F';

  //?Fax Number 1.
  CASE;

  // IF DB1.Line Number ID is Fax Number 1
  IF DB1.Line_Number_ID = 3;

  // PAR.Phone Prefix Fax 1 USR = DB1.Phone Prefix
  PAR.Phone_Prefix_Fax_1_USR = DB1.Phone_Prefix;

  // PAR.Phone Number Fax 1 USR = DB1.Phone Number
  PAR.Phone_Number_Fax_1_USR = DB1.Phone_Number;

  ENDIF;

  //?Fax Number 2.
  CASE;

  // IF DB1.Line Number ID is Fax Number 2
  IF DB1.Line_Number_ID = 2;

  // PAR.Phone Prefix Fax 2 USR = DB1.Phone Prefix
  PAR.Phone_Prefix_Fax_2_USR = DB1.Phone_Prefix;

  // PAR.Phone Number Fax 2 USR = DB1.Phone Number
  PAR.Phone_Number_Fax_2_USR = DB1.Phone_Number;

  ENDIF;

  //?Send Back Phone Numbers Info.
  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Phone Number 1.
  CASE;

  // IF DB1.Line Number ID is Phone Number 1
  IF DB1.Line_Number_ID = 1;

  // PAR.Phone Prefix = DB1.Phone Prefix
  PAR.Phone_Prefix = DB1.Phone_Prefix;

  // PAR.Phone Number = DB1.Phone Number
  PAR.Phone_Number = DB1.Phone_Number;

  ENDIF;

  ENDIF;

 }

}


//?Set 1099 Flag.
CASE;

// IF RCD.Person/Corporation Code is Person
IF RCD.Person_Corporation_Code = 'P';

// RCD.Ten 99 = CND.Yes
RCD.Ten_99 = 'Y';

//?Set 1099 Flag.
// IF *OTHERWISE
IF *OTHERWISE;

// RCD.Ten 99 = CND.No
RCD.Ten_99 = 'N';

ENDIF;

//?USER: Process selected line

MOVE *ALL (To: PAR From: RCD);

// PAR.Address Line 4 = RCD.City
PAR.Address_Line_4 = RCD.City;

