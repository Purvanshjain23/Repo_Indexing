// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for OMCAPVR
// ?Date: 14.08.2025 Time: 03:27:00
// ?------------------------------------------------------------------------------------------------

//?USER: Load screen

// PAR.User Profile Name = JOB.*USER
PAR.User_Profile_Name = JOB.*USER;

EXECUTE FUNCTION(RTV Printer Values     RT) TYPE(RTVOBJ) FILE(OPC0REP)          AC1136055;
PARAMETER(PAR.User_Profile_Name);
PARAMETER('O/P');
PARAMETER(DTL.Pick_Slip_Printer);
PARAMETER(WRK.Immediate_Invoice_Printer);
PARAMETER(WRK.Sales_Printer);
PARAMETER(WRK.Production_Printer);
PARAMETER(WRK.BOL_Printer);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// PAR.Pick Slip Printer = DTL.Pick Slip Printer
PAR.Pick_Slip_Printer = DTL.Pick_Slip_Printer;

//?USER: Validate fields

// Execute function VAL object existence   US.
EXECUTE FUNCTION(VAL object existence   US) TYPE(EXCUSRSRC) ('JCOBJR');
PARAMETER(DTL.Pick_Slip_Printer);
PARAMETER(*OUTQ);
PARAMETER(PGM.*Return_code);
{
 C                     CALL 'JCOBJC'                   CL PROGRAM
 C                     PARM #IA8VN    UA8VN  10
 C                     PARM #IOBJT    UOBJT  10
 C           W0RTN     PARM           W0RTN
}


//?If printer not found then send error message
CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

//?If printer not found then send error message
// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - ''&1' is invalid, please re-enter.'
ERROR(USR0280);
MSGPARM(PAR.Pick_Slip_Printer);

ENDIF;

//?USER: User defined action

// PAR.Pick Slip Printer = DTL.Pick Slip Printer
PAR.Pick_Slip_Printer = DTL.Pick_Slip_Printer;

//?USER: Exit program processing

CASE;

// IF DTL.*CMD key is *Exit
IF DTL.*CMD_key = '03';

// Send error message - 'Exit is not allowed.  Enter a valid Printer and press Enter to continue.'
ERROR(USR1427);

QUIT;

ENDIF;

