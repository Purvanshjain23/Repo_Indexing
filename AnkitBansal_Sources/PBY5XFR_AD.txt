// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBY5XFR
// ?Date: 14.08.2025 Time: 03:49:50
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?READ THE RANGE OF INVOICE NUMBERS PASSED IN
//?Read not IC invoices  - create omp300 for AR interface
CASE;

// IF PAR.Type Code is EQ Blank
IF PAR.Type_Code = *BLANK;

EXECUTE FUNCTION(RTV Inv For M3-RANGE  RT) TYPE(RTVOBJ) FILE(ARBDCPP)           AC2129732;
PARAMETER(PAR.Invoice_Number);
PARAMETER(PAR.Invoice_Number_Usr_2);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.Invoice Suffix is IN, DM, or CM
 IF DB1.Invoice_Suffix = 'CM'/'DM'/'IN';

 // AND DB1.Invoice Number GE PAR.Invoice Number
 AND ( DB1.Invoice_Number >= PAR.Invoice_Number;

 // AND DB1.Invoice Number LE PAR.Invoice Number Usr 2
 AND DB1.Invoice_Number <= PAR.Invoice_Number_Usr_2 );

 // Call program M3 OMS GL Invoice Post ZZ.
 CALL PROGRAM(M3 OMS GL Invoice Post ZZ) ('M3GLINV');
 PARAMETER(LCL.Return_Code_Usr);
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number_Ref);

 //?dont do in this one
 ENDIF;

}


ENDIF;

//?Read IC invoices  - dont have ar header so read sales hist for GL intrfc
CASE;

// IF PAR.Type Code is Inter-Plant Transfer
IF PAR.Type_Code = 'IP';

EXECUTE FUNCTION(Rtv for M3 Int-RANGE  RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC2129733;
PARAMETER(PAR.Invoice_Number);
PARAMETER('IP');
PARAMETER(PAR.Invoice_Number_Usr_2);
{
 //?USER: Initialize routine

 // LCL.Invoice Number Usr 1 = CON.*ZERO
 LCL.Invoice_Number_Usr_1 = *ZERO;

 //?USER: Process Data record

 CASE;

 // IF DB1.Invoice Number GE PAR.Invoice Number
 IF ( DB1.Invoice_Number >= PAR.Invoice_Number;

 // AND DB1.Invoice Number LE PAR.Invoice Number Usr 2
 AND DB1.Invoice_Number <= PAR.Invoice_Number_Usr_2 );

 // AND PAR.Type Code EQ DB1.Type Code
 AND PAR.Type_Code = DB1.Type_Code;

 //?Do on invoice number break
 CASE;

 // IF DB1.Invoice Number NE LCL.Invoice Number Usr 1
 IF DB1.Invoice_Number <> LCL.Invoice_Number_Usr_1;

 // Call program M3 OMS GL Invoice Post ZZ.
 CALL PROGRAM(M3 OMS GL Invoice Post ZZ) ('M3GLINV');
 PARAMETER(LCL.Return_Code_Usr);
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);

 // LCL.Invoice Number Usr 1 = DB1.Invoice Number
 LCL.Invoice_Number_Usr_1 = DB1.Invoice_Number;

 ENDIF;

 ENDIF;

}


ENDIF;

