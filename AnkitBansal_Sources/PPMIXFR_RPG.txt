     H/TITLE Crt A/R Claim Apprl   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJHIGH
     H* Date          : 04/23/15  Time  : 09:42:34
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPAYCPL1IF  E           K        DISK
      * RTV : A/R Claim Approval        Retrieval index
      *
     FPPAWREL0IF  E           K        DISK
      * RTV : A/R Approval              Retrieval index
      *
     FPDMKCPL2IF  E           K        DISK
      * RSQ : A/R Claim                 claim number (d)
      *
     FPDMOCPL2IF  E           K        DISK
      * RSQ : A/R Claim Product  Claim/Co/Item/Seq/LnSeq
      *
     FPDMPCPL2IF  E           K        DISK
      * RSQ : A/R Claim Resale Product  Claim/Co/Item/Seq/LnSeq
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPDNFREL1IF  E           K        DISK
      * RTV : Salesperson Electronic CM Retrieval index
      *
     FPPAYCPL2IF  E           K        DISK
      * RSQ : A/R Claim Approval        A/R Approval
      *
     FPPAYCPL3IF  E           K        DISK
      * RSQ : A/R Claim Approval        Clm/Title/Seq(d)
      *
     FPDMOCPL1IF  E           K        DISK
      * RTV : A/R Claim Product         Retrieval index
      *
     FPDMPCPL1IF  E           K        DISK
      * RTV : A/R Claim Resale Product  Retrieval index
      *
     FPPAYCPL0UF  E           K        DISK                      A
      * UPD : A/R Claim Approval        Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@AYCPXN
      * A/R Claim Approval        Retrieval index
      * Renamed input format fields
     I              AYC0C7                          WAC0C7
     I              AYF0AA                          WAF0AA
     I              AYDXNB                          WADXNB
     I              AYQ7NA                          WAQ7NA
     I              AYFDT1                          WAFDT1
     I              AYFET1                          WAFET1
     I              AYYZNX                          WAYZNX
     I              AYTUSX                          WATUSX
     I              AYMODT                          WAMODT
     I              AYBHTM                          WABHTM
     I              AYTVSX                          WATVSX
     I              AYTWSX                          WATWSX
     I              AYP4DT                          WAP4DT
     I              AYP5DT                          WAP5DT
     I              AYVSST                          WAVSST
     I              AYMJDT                          WAMJDT
     I              AYBETM                          WABETM
     I              AYCCVN                          WACCVN
     I              AYCDVN                          WACDVN
     I              AYMKDT                          WAMKDT
     I              AYBFTM                          WABFTM
     I              AYCEVN                          WACEVN
     I              AYCFVN                          WACFVN
      *
     I@AYCPXM
      * A/R Claim Approval        Update index
      * Renamed input format fields
     I              AYC0C7                          WBC0C7
     I              AYF0AA                          WBF0AA
     I              AYDXNB                          WBDXNB
     I              AYQ7NA                          WBQ7NA
     I              AYFDT1                          WBFDT1
     I              AYFET1                          WBFET1
     I              AYYZNX                          WBYZNX
     I              AYTUSX                          WBTUSX
     I              AYMODT                          WBMODT
     I              AYBHTM                          WBBHTM
     I              AYTVSX                          WBTVSX
     I              AYTWSX                          WBTWSX
     I              AYP4DT                          WBP4DT
     I              AYP5DT                          WBP5DT
     I              AYVSST                          WBVSST
     I              AYMJDT                          WBMJDT
     I              AYBETM                          WBBETM
     I              AYCCVN                          WBCCVN
     I              AYCDVN                          WBCDVN
     I              AYMKDT                          WBMKDT
     I              AYBFTM                          WBBFTM
     I              AYCEVN                          WBCEVN
     I              AYCFVN                          WBCFVN
      *
     I@AWREXB
      * A/R Approval              Retrieval index
      * Renamed input format fields
     I              AWF0AA                          WCF0AA
     I              AWQ7NA                          WCQ7NA
     I              AWFDT1                          WCFDT1
     I              AWFET1                          WCFET1
     I              AWYZNX                          WCYZNX
     I              AWTUSX                          WCTUSX
     I              AWEKVL                          WCEKVL
     I              AWELVL                          WCELVL
     I              AWTVSX                          WCTVSX
     I              AWT3SX                          WCT3SX
     I              AWFUAA                          WCFUAA
     I              AWAIC3                          WCAIC3
     I              AWVSST                          WCVSST
     I              AWMJDT                          WCMJDT
     I              AWBETM                          WCBETM
     I              AWCCVN                          WCCCVN
     I              AWCDVN                          WCCDVN
     I              AWMKDT                          WCMKDT
     I              AWBFTM                          WCBFTM
     I              AWCEVN                          WCCEVN
     I              AWCFVN                          WCCFVN
      *
     I@MKCPW7
      * A/R Claim                 claim number (d)
      * Renamed input format fields
     I              MKC0C7                          WDC0C7
     I              MKZLCD                          WDZLCD
     I              MKBIC3                          WDBIC3
     I              MKALNX                          WDALNX
     I              MKRMNB                          WDRMNB
     I              MKC3C7                          WDC3C7
     I              MKRFTX                          WDRFTX
     I              MKCHSX                          WDCHSX
     I              MKCJSX                          WDCJSX
     I              MKAYVL                          WDAYVL
     I              MKAZVL                          WDAZVL
     I              MKA0VL                          WDA0VL
     I              MKPQTX                          WDPQTX
     I              MKCNSX                          WDCNSX
     I              MKPLTX                          WDPLTX
     I              MKCOSX                          WDCOSX
     I              MKPMTX                          WDPMTX
     I              MKCPSX                          WDCPSX
     I              MKA1VL                          WDA1VL
     I              MKPNTX                          WDPNTX
     I              MKPOTX                          WDPOTX
     I              MKMLDT                          WDMLDT
     I              MKEJDT                          WDEJDT
     I              MKCQSX                          WDCQSX
     I              MKPPTX                          WDPPTX
     I              MKMMDT                          WDMMDT
     I              MKMNDT                          WDMNDT
     I              MKBGTM                          WDBGTM
     I              MKCGVN                          WDCGVN
     I              MKC4C7                          WDC4C7
     I              MKO2NA                          WDO2NA
     I              MKNFDT                          WDNFDT
     I              MKBJTM                          WDBJTM
     I              MKCQVN                          WDCQVN
     I              MKMODT                          WDMODT
     I              MKBHTM                          WDBHTM
     I              MKCHVN                          WDCHVN
     I              MKCRSX                          WDCRSX
     I              MKMPDT                          WDMPDT
     I              MKBITM                          WDBITM
     I              MKCIVN                          WDCIVN
     I              MKTBTX                          WDTBTX
     I              MKEOVL                          WDEOVL
     I              MKEPVL                          WDEPVL
     I              MKP6DT                          WDP6DT
     I              MKCRTM                          WDCRTM
     I              MKYSNX                          WDYSNX
     I              MKT5SX                          WDT5SX
     I              MKF7PC                          WDF7PC
     I              MKF8PC                          WDF8PC
     I              MKF9PC                          WDF9PC
     I              MKEQVL                          WDEQVL
     I              MKERVL                          WDERVL
     I              MKESVL                          WDESVL
     I              MKETVL                          WDETVL
     I              MKT7SX                          WDT7SX
     I              MKT8SX                          WDT8SX
     I              MKT9SX                          WDT9SX
     I              MKUASX                          WDUASX
     I              MKUBSX                          WDUBSX
     I              MKGAPC                          WDGAPC
     I              MKGBPC                          WDGBPC
     I              MKVSST                          WDVSST
     I              MKMJDT                          WDMJDT
     I              MKBETM                          WDBETM
     I              MKCCVN                          WDCCVN
     I              MKCDVN                          WDCDVN
     I              MKMKDT                          WDMKDT
     I              MKBFTM                          WDBFTM
     I              MKCEVN                          WDCEVN
     I              MKCFVN                          WDCFVN
      *
     I@MOCPXL
      * A/R Claim Product  Claim/Co/Item/Seq/LnSeq
      * Renamed input format fields
     I              MOC0C7                          WEC0C7
     I              MOAFNX                          WEAFNX
     I              MOBIC3                          WEBIC3
     I              MOC1C7                          WEC1C7
     I              MOCQCD                          WECQCD
     I              MOHHCD                          WEHHCD
     I              MOCISX                          WECISX
     I              MOFUAA                          WEFUAA
     I              MODPNB                          WEDPNB
     I              MOUENB                          WEUENB
     I              MOKUQT                          WEKUQT
     I              MOHHWG                          WEHHWG
     I              MODIPR                          WEDIPR
     I              MOBNVL                          WEBNVL
     I              MOF0SX                          WEF0SX
     I              MOF1SX                          WEF1SX
     I              MOF2SX                          WEF2SX
     I              MOFXPR                          WEFXPR
     I              MOAMST                          WEAMST
     I              MOANST                          WEANST
     I              MOVAST                          WEVAST
     I              MOTNSX                          WETNSX
     I              MOALNX                          WEALNX
     I              MORMNB                          WERMNB
     I              MOYTNX                          WEYTNX
     I              MON0CD                          WEN0CD
     I              MOQYSX                          WEQYSX
     I              MOQZSX                          WEQZSX
     I              MOQ0SX                          WEQ0SX
     I              MOUCSX                          WEUCSX
     I              MOUDSX                          WEUDSX
     I              MOUESX                          WEUESX
     I              MOFYPR                          WEFYPR
     I              MOFZPR                          WEFZPR
     I              MOF0PR                          WEF0PR
     I              MOF1PR                          WEF1PR
     I              MOF2PR                          WEF2PR
     I              MOEUVL                          WEEUVL
     I              MOEVVL                          WEEVVL
     I              MOEWVL                          WEEWVL
     I              MOEXVL                          WEEXVL
     I              MOEYVL                          WEEYVL
     I              MOVSST                          WEVSST
     I              MOMJDT                          WEMJDT
     I              MOBETM                          WEBETM
     I              MOCCVN                          WECCVN
     I              MOCDVN                          WECDVN
     I              MOMKDT                          WEMKDT
     I              MOBFTM                          WEBFTM
     I              MOCEVN                          WECEVN
     I              MOCFVN                          WECFVN
      *
     I@MPCPXM
      * A/R Claim Resale Product  Claim/Co/Item/Seq/LnSeq
      * Renamed input format fields
     I              MPC0C7                          WFC0C7
     I              MPBKC7                          WFBKC7
     I              MPAKNX                          WFAKNX
     I              MPBHC3                          WFBHC3
     I              MPC5C7                          WFC5C7
     I              MPCQCD                          WFCQCD
     I              MPHHCD                          WFHHCD
     I              MPCISX                          WFCISX
     I              MPFUAA                          WFFUAA
     I              MPDPNB                          WFDPNB
     I              MPUENB                          WFUENB
     I              MPKVQT                          WFKVQT
     I              MPHIWG                          WFHIWG
     I              MPDJPR                          WFDJPR
     I              MPBOVL                          WFBOVL
     I              MPO2NA                          WFO2NA
     I              MPF0SX                          WFF0SX
     I              MPF1SX                          WFF1SX
     I              MPF2SX                          WFF2SX
     I              MPAMST                          WFAMST
     I              MPANST                          WFANST
     I              MPVAST                          WFVAST
     I              MPUFSX                          WFUFSX
     I              MPQVSX                          WFQVSX
     I              MPQWSX                          WFQWSX
     I              MPQXSX                          WFQXSX
     I              MPVSST                          WFVSST
     I              MPMJDT                          WFMJDT
     I              MPBETM                          WFBETM
     I              MPCCVN                          WFCCVN
     I              MPCDVN                          WFCDVN
     I              MPMKDT                          WFMKDT
     I              MPBFTM                          WFBFTM
     I              MPCEVN                          WFCEVN
     I              MPCFVN                          WFCFVN
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WGBCCD
     I              APALTX                          WGALTX
     I              APACNA                          WGACNA
     I              APADNA                          WGADNA
     I              APAENA                          WGAENA
     I              APAJNA                          WGAJNA
     I              APBGCD                          WGBGCD
     I              APBTTX                          WGBTTX
     I              APBVTX                          WGBVTX
     I              APBWTX                          WGBWTX
     I              APDZTX                          WGDZTX
     I              APD0TX                          WGD0TX
     I              APD1TX                          WGD1TX
     I              APLVCD                          WGLVCD
     I              APKZCD                          WGKZCD
     I              APAIC3                          WGAIC3
     I              APAVNB                          WGAVNB
     I              APDSCD                          WGDSCD
     I              APUVST                          WGUVST
     I              APUWST                          WGUWST
     I              APUXST                          WGUXST
     I              APVSST                          WGVSST
     I              APAATM                          WGAATM
     I              APAYNA                          WGAYNA
     I              APA0NA                          WGA0NA
     I              APAXDT                          WGAXDT
      *
     I@NFREAW
      * Salesperson Electronic CM Retrieval index
      * Renamed input format fields
     I              NFBCCD                          WHBCCD
     I              NFUGTX                          WHUGTX
     I              NFV4CD                          WHV4CD
     I              NFN1SX                          WHN1SX
     I              NFN2SX                          WHN2SX
     I              NFUVST                          WHUVST
     I              NFUWST                          WHUWST
     I              NFUXST                          WHUXST
     I              NFVSST                          WHVSST
     I              NFAATM                          WHAATM
     I              NFAYNA                          WHAYNA
     I              NFA0NA                          WHA0NA
     I              NFAXDT                          WHAXDT
      *
     I@AYCPXQ
      * A/R Claim Approval        A/R Approval
      * Renamed input format fields
     I              AYC0C7                          WIC0C7
     I              AYF0AA                          WIF0AA
     I              AYDXNB                          WIDXNB
     I              AYQ7NA                          WIQ7NA
     I              AYFDT1                          WIFDT1
     I              AYFET1                          WIFET1
     I              AYYZNX                          WIYZNX
     I              AYTUSX                          WITUSX
     I              AYMODT                          WIMODT
     I              AYBHTM                          WIBHTM
     I              AYTVSX                          WITVSX
     I              AYTWSX                          WITWSX
     I              AYP4DT                          WIP4DT
     I              AYP5DT                          WIP5DT
     I              AYVSST                          WIVSST
     I              AYMJDT                          WIMJDT
     I              AYBETM                          WIBETM
     I              AYCCVN                          WICCVN
     I              AYCDVN                          WICDVN
     I              AYMKDT                          WIMKDT
     I              AYBFTM                          WIBFTM
     I              AYCEVN                          WICEVN
     I              AYCFVN                          WICFVN
      *
     IZAYCPYG
      * A/R Claim Approval        Clm/Title/Seq(d)
      * Renamed input format fields
     I              AYC0C7                          WJC0C7
     I              AYF0AA                          WJF0AA
     I              AYDXNB                          WJDXNB
     I              AYQ7NA                          WJQ7NA
     I              AYFDT1                          WJFDT1
     I              AYFET1                          WJFET1
     I              AYYZNX                          WJYZNX
     I              AYTUSX                          WJTUSX
     I              AYMODT                          WJMODT
     I              AYBHTM                          WJBHTM
     I              AYTVSX                          WJTVSX
     I              AYTWSX                          WJTWSX
     I              AYP4DT                          WJP4DT
     I              AYP5DT                          WJP5DT
     I              AYVSST                          WJVSST
     I              AYMJDT                          WJMJDT
     I              AYBETM                          WJBETM
     I              AYCCVN                          WJCCVN
     I              AYCDVN                          WJCDVN
     I              AYMKDT                          WJMKDT
     I              AYBFTM                          WJBFTM
     I              AYCEVN                          WJCEVN
     I              AYCFVN                          WJCFVN
      *
     I@MOCPWK
      * A/R Claim Product         Retrieval index
      * Renamed input format fields
     I              MOC0C7                          WKC0C7
     I              MOAFNX                          WKAFNX
     I              MOBIC3                          WKBIC3
     I              MOC1C7                          WKC1C7
     I              MOCQCD                          WKCQCD
     I              MOHHCD                          WKHHCD
     I              MOCISX                          WKCISX
     I              MOFUAA                          WKFUAA
     I              MODPNB                          WKDPNB
     I              MOUENB                          WKUENB
     I              MOKUQT                          WKKUQT
     I              MOHHWG                          WKHHWG
     I              MODIPR                          WKDIPR
     I              MOBNVL                          WKBNVL
     I              MOF0SX                          WKF0SX
     I              MOF1SX                          WKF1SX
     I              MOF2SX                          WKF2SX
     I              MOFXPR                          WKFXPR
     I              MOAMST                          WKAMST
     I              MOANST                          WKANST
     I              MOVAST                          WKVAST
     I              MOTNSX                          WKTNSX
     I              MOALNX                          WKALNX
     I              MORMNB                          WKRMNB
     I              MOYTNX                          WKYTNX
     I              MON0CD                          WKN0CD
     I              MOQYSX                          WKQYSX
     I              MOQZSX                          WKQZSX
     I              MOQ0SX                          WKQ0SX
     I              MOUCSX                          WKUCSX
     I              MOUDSX                          WKUDSX
     I              MOUESX                          WKUESX
     I              MOFYPR                          WKFYPR
     I              MOFZPR                          WKFZPR
     I              MOF0PR                          WKF0PR
     I              MOF1PR                          WKF1PR
     I              MOF2PR                          WKF2PR
     I              MOEUVL                          WKEUVL
     I              MOEVVL                          WKEVVL
     I              MOEWVL                          WKEWVL
     I              MOEXVL                          WKEXVL
     I              MOEYVL                          WKEYVL
     I              MOVSST                          WKVSST
     I              MOMJDT                          WKMJDT
     I              MOBETM                          WKBETM
     I              MOCCVN                          WKCCVN
     I              MOCDVN                          WKCDVN
     I              MOMKDT                          WKMKDT
     I              MOBFTM                          WKBFTM
     I              MOCEVN                          WKCEVN
     I              MOCFVN                          WKCFVN
      *
     I@MPCPWQ
      * A/R Claim Resale Product  Retrieval index
      * Renamed input format fields
     I              MPC0C7                          WLC0C7
     I              MPBKC7                          WLBKC7
     I              MPAKNX                          WLAKNX
     I              MPBHC3                          WLBHC3
     I              MPC5C7                          WLC5C7
     I              MPCQCD                          WLCQCD
     I              MPHHCD                          WLHHCD
     I              MPCISX                          WLCISX
     I              MPFUAA                          WLFUAA
     I              MPDPNB                          WLDPNB
     I              MPUENB                          WLUENB
     I              MPKVQT                          WLKVQT
     I              MPHIWG                          WLHIWG
     I              MPDJPR                          WLDJPR
     I              MPBOVL                          WLBOVL
     I              MPO2NA                          WLO2NA
     I              MPF0SX                          WLF0SX
     I              MPF1SX                          WLF1SX
     I              MPF2SX                          WLF2SX
     I              MPAMST                          WLAMST
     I              MPANST                          WLANST
     I              MPVAST                          WLVAST
     I              MPUFSX                          WLUFSX
     I              MPQVSX                          WLQVSX
     I              MPQWSX                          WLQWSX
     I              MPQXSX                          WLQXSX
     I              MPVSST                          WLVSST
     I              MPMJDT                          WLMJDT
     I              MPBETM                          WLBETM
     I              MPCCVN                          WLCCVN
     I              MPCDVN                          WLCDVN
     I              MPMKDT                          WLMKDT
     I              MPBFTM                          WLBFTM
     I              MPCEVN                          WLCEVN
     I              MPCFVN                          WLCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPPAY1    E DSPPAYCPL0
      * UPD : A/R Claim Approval        Update index
      * Renamed input format fields
     I              AYC0C7                          WBC0C7
     I              AYF0AA                          WBF0AA
     I              AYDXNB                          WBDXNB
     I              AYQ7NA                          WBQ7NA
     I              AYFDT1                          WBFDT1
     I              AYFET1                          WBFET1
     I              AYYZNX                          WBYZNX
     I              AYTUSX                          WBTUSX
     I              AYMODT                          WBMODT
     I              AYBHTM                          WBBHTM
     I              AYTVSX                          WBTVSX
     I              AYTWSX                          WBTWSX
     I              AYP4DT                          WBP4DT
     I              AYP5DT                          WBP5DT
     I              AYVSST                          WBVSST
     I              AYMJDT                          WBMJDT
     I              AYBETM                          WBBETM
     I              AYCCVN                          WBCCVN
     I              AYCDVN                          WBCDVN
     I              AYMKDT                          WBMKDT
     I              AYBFTM                          WBBFTM
     I              AYCEVN                          WBCEVN
     I              AYCFVN                          WBCFVN
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Claim
      * I :  Claim Number
     I                                    P   1   40P1C0C7
      * I :  Salesperson to Rvw Claim
     I                                        5   7 P1ZLCD
      * I :  Claim Company Number
     I                                    P   8   90P1BIC3
      * I :  Claim Order Number
     I                                    P  10  130P1ALNX
      * I :  Load ID
     I                                    P  14  170P1RMNB
      * I :  Claim Ship to Customer
     I                                    P  18  210P1C3C7
      * I :  Claim Customer Name
     I                                       22  51 P1RFTX
      * I :  Claim Type
     I                                       52  53 P1CHSX
      * I :  Claim Status
     I                                       54  54 P1CJSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1C0C7    PARM           WP0001  70       Claim Number
     C           P1ZLCD    PARM           WP0002  3        Salesperson to
     C           P1BIC3    PARM           WP0003  30       Claim Company N
     C           P1ALNX    PARM           WP0004  70       Claim Order Num
     C           P1RMNB    PARM           WP0005  70       Load ID
     C           P1C3C7    PARM           WP0006  70       Claim Ship to C
     C           P1RFTX    PARM           WP0007 30        Claim Customer
     C           P1CHSX    PARM           WP0008  2        Claim Type
     C           P1CJSX    PARM           WP0009  1        Claim Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt A/R Claim Apprl   XF
      * E4057 JJH 04/22/15 - Delete Credit Manager Approval
      * - This logic was added to remove any Credit Manager Approval
      *   records in the event that they were created, and later not
      *   required due to the change of Department/Reason Codes that do
      *   require Credit Manager Approval.
      * Dlt A/R Claim Aprrl C RT - A/R Claim Approval  * 
     C                     EXSR SARVGN
      * E4057 JJH 04/22/15 - Create Credit Manager Approval
      * - If a record exists in the A/R Claim Product or A/R Claim Resale
      *   Product file with at least 1 record with Require Credit Manager
      *   = Y(Yes).
      * Crt A/R Claim Apprl    RT - A/R Approval  * 
     C                     EXSR SCRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Dlt A/R Claim Aprrl C RT - A/R Claim Approval  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAC0C7    WQSA01           Claim Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    WQSA01           Claim Number
      * Establish starting position
     C           KRSSA     SETLL@AYCPXN                    *
     C           KRSSA     READE@AYCPXN                  90*
      * Data record not found
     C   90                MOVEL'USR3431' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Approval Person Type is Credit Manager
     C           WATUSX    IFEQ 'C'                        *IF
      * Dlt A/R Claim Apprl   DO - A/R Claim Approval  * 
     C                     EXSR SBDLRC
     C                     END                             *FI
     C           KRSSA     READE@AYCPXN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Dlt A/R Claim Apprl   DO - A/R Claim Approval  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AYCPXM
     C                     Z-ADDWAC0C7    WBC0C7           Claim Number
     C                     MOVELWAF0AA    WBF0AA           Approval Title
     C                     Z-ADDWADXNB    WBDXNB           Sequence Number
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBC0C7           Claim Number
     C                     KFLD           WBF0AA           Approval Title
     C                     KFLD           WBDXNB           Sequence Number
     C           KLDLSB    CHAIN@AYCPXM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPAYCPL0'MDACP
     C                     MOVEL'@AYCPXM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AYCPXM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Crt A/R Claim Apprl    RT - A/R Approval  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@AWREXB                    *
     C                     READ @AWREXB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3427' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Approval Create Status = Standard
      * CASE: DB1.Approval Create Sts is Standard
     C           WCT3SX    IFEQ 'S'                        *IF
      * Rtv Claim Infor/Appr  RT - A/R Claim  * 
     C                     EXSR SDRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * SEL: Claim Amount
      * CASE: LCL.Claim Amount NE WRK.ZERO
     C           YL0002    IFNE WUW0NB                     *IF
     C                     Z-ADDYL0002    YL0005           Amount Paid
     C                     ELSE
      * CASE: LCL.Claim Net Loss NE WRK.ZERO
     C           YL0003    IFNE WUW0NB                     *IF
     C                     Z-ADDYL0003    YL0005           Amount Paid
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Amount Paid
      * CASE: LCL.Amount Paid is greater or equal to zero
     C           YL0005    IFGE 0                          *IF
      * Min Max Validtion applies to claim amount positive side
     C                     EXSR UASUBR                     Min Max Validti
     C                     ELSE
      * CASE: *OTHERWISE
      * Max or Min Validtion applies to claim amount negative check
     C                     EXSR UBSUBR                     Max or Min Vali
     C                     END                             *FI
      * Department Verified only if department was selected
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : DB1.Claim Department Code is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WCFUAA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : DB1.Claim Department Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WCFUAA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Vry Clm Prod/Appr     RT - A/R Claim Product  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
      * Vry Clm ResalePrd/ApprRT - A/R Claim Resale Product  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Company Number
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : DB1.Company Number is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WCAIC3    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : DB1.Company Number is greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WCAIC3    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Vry Clm Prod/Appr CO  RT - A/R Claim Product  * 
     C                     EXSR SGRVGN
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
      * Vry Clm RslPd/Appr CO RT - A/R Claim Resale Product  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: DB1.Approval Person Type is Order Salesperson
     C           WCTUSX    IFEQ 'O'                        *IF
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SIRVGN
      * Rtv All Fields         RT - Salesperson Electronic CM  * 
     C                     EXSR SJRVGN
      * Crt A/R Claim ApprlStdRT - A/R Claim Approval  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1C0C7    WL0001           Claim Number
     C                     MOVELWCF0AA    WL0002    P      Approval Title
     C                     MOVELWCQ7NA    WL0003    P      Approval Title
     C                     MOVELYL0008    WL0004    P      Approval Person
     C                     MOVELYL0010    WL0005    P      Approval Person
     C                     Z-ADDWCYZNX    WL0006           Approval Person
     C                     MOVELWCTUSX    WL0007    P      Approval Person
     C                     Z-ADD0         WL0008           Approved/Denied
     C                     Z-ADD0         WL0009           Approved/Denied
     C                     MOVELWCTVSX    WL0010    P      Approval Requir
     C                     MOVEL'N'       WL0011    P      Approval Status
     C                     Z-ADD0         WL0012           Emailed Date
     C                     Z-ADD0         WL0013           Emailed Time
     C                     MOVEL'A'       WL0014    P      Record Status
     C                     EXSR SKRVGN
      * E4057 JJH 04/22/15 - Create Credit Manager Approval
     C                     ELSE
      * CASE: DB1.Approval Person Type is Credit Manager
     C           WCTUSX    IFEQ 'C'                        *IF
      * Crt A/R Claim Aprl CRM IF
      * E4057 JJH 04/22/15 - Create Credit Manager Approval
      * - If a record exists in the A/R Claim Product or A/R Claim Resale
      *   Product file with at least 1 record with Require Credit Manager
      *   = Y(Yes).
      * Rtv Require CM Apv    RT - A/R Claim Product  * 
     C                     EXSR SNRVGN
      * CASE: LCL.*Record selected is *YES
     C           YL0013    IFEQ 'Y'                        *IF
      * Crt A/R Claim ApprlStdRT - A/R Claim Approval  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1C0C7    WL0001           Claim Number
     C                     MOVELWCF0AA    WL0002    P      Approval Title
     C                     MOVELWCQ7NA    WL0003    P      Approval Title
     C                     MOVELWCFDT1    WL0004    P      Approval Person
     C                     MOVELWCFET1    WL0005    P      Approval Person
     C                     Z-ADDWCYZNX    WL0006           Approval Person
     C                     MOVELWCTUSX    WL0007    P      Approval Person
     C                     Z-ADD0         WL0008           Approved/Denied
     C                     Z-ADD0         WL0009           Approved/Denied
     C                     MOVELWCTVSX    WL0010    P      Approval Requir
     C                     MOVEL'N'       WL0011    P      Approval Status
     C                     Z-ADD0         WL0012           Emailed Date
     C                     Z-ADD0         WL0013           Emailed Time
     C                     MOVEL'A'       WL0014    P      Record Status
     C                     EXSR SKRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Require CM Apv - A/R Claim Resale Product  * 
     C                     EXSR SORVGN
      * CASE: LCL.*Record selected is *YES
     C           YL0013    IFEQ 'Y'                        *IF
      * Crt A/R Claim ApprlStdRT - A/R Claim Approval  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1C0C7    WL0001           Claim Number
     C                     MOVELWCF0AA    WL0002    P      Approval Title
     C                     MOVELWCQ7NA    WL0003    P      Approval Title
     C                     MOVELWCFDT1    WL0004    P      Approval Person
     C                     MOVELWCFET1    WL0005    P      Approval Person
     C                     Z-ADDWCYZNX    WL0006           Approval Person
     C                     MOVELWCTUSX    WL0007    P      Approval Person
     C                     Z-ADD0         WL0008           Approved/Denied
     C                     Z-ADD0         WL0009           Approved/Denied
     C                     MOVELWCTVSX    WL0010    P      Approval Requir
     C                     MOVEL'N'       WL0011    P      Approval Status
     C                     Z-ADD0         WL0012           Emailed Date
     C                     Z-ADD0         WL0013           Emailed Time
     C                     MOVEL'A'       WL0014    P      Record Status
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt A/R Claim ApprlStdRT - A/R Claim Approval  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1C0C7    WL0001           Claim Number
     C                     MOVELWCF0AA    WL0002    P      Approval Title
     C                     MOVELWCQ7NA    WL0003    P      Approval Title
     C                     MOVELWCFDT1    WL0004    P      Approval Person
     C                     MOVELWCFET1    WL0005    P      Approval Person
     C                     Z-ADDWCYZNX    WL0006           Approval Person
     C                     MOVELWCTUSX    WL0007    P      Approval Person
     C                     Z-ADD0         WL0008           Approved/Denied
     C                     Z-ADD0         WL0009           Approved/Denied
     C                     MOVELWCTVSX    WL0010    P      Approval Requir
     C                     MOVEL'N'       WL0011    P      Approval Status
     C                     Z-ADD0         WL0012           Emailed Date
     C                     Z-ADD0         WL0013           Emailed Time
     C                     MOVEL'A'       WL0014    P      Record Status
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @AWREXB                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Claim Infor/Appr  RT - A/R Claim  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDC0C7    WQSD01           Claim Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    WQSD01           Claim Number
      * Establish starting position
     C           KRSSD     SETLL@MKCPW7                    *
     C           KRSSD     READE@MKCPW7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2729' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD0         YL0002           Claim Amount
     C                     Z-ADD0         YL0003           Claim Net Loss
     C                     Z-ADD0         YL0004           Approved Net Lo
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDZLCD    YL0001           Salesperson to
     C                     Z-ADDWDAYVL    YL0002           Claim Amount
     C                     Z-ADDWDAZVL    YL0003           Claim Net Loss
     C                     Z-ADDWDEOVL    YL0004           Approved Net Lo
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@MKCPW7                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Vry Clm Prod/Appr     RT - A/R Claim Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEC0C7    WQSE01           Claim Number
     C           *LIKE     DEFN WEBIC3    WQSE02           Claim Company N
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Claim Number
     C                     KFLD           WQSE02           Claim Company N
      * Setup key
     C                     Z-ADDP1C0C7    WQSE01           Claim Number
     C                     Z-ADDP1BIC3    WQSE02           Claim Company N
      * Establish starting position
     C           KRSSE     SETLL@MOCPXL                    *
     C           KRSSE     READE@MOCPXL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2737' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Claim Department Code EQ DB1.Claim Department Code
     C           WCFUAA    IFEQ WEFUAA                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     GOTO SEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C           KRSSE     READE@MOCPXL                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Vry Clm ResalePrd/ApprRT - A/R Claim Resale Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC0C7    WQSF01           Claim Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    WQSF01           Claim Number
      * Establish starting position
     C           KRSSF     SETLL@MPCPXM                    *
     C           KRSSF     READE@MPCPXM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2739' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Claim Department Code EQ DB1.Claim Department Code
     C           WCFUAA    IFEQ WFFUAA                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     GOTO SFEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C           KRSSF     READE@MPCPXM                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Vry Clm Prod/Appr CO  RT - A/R Claim Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEC0C7    WQSG01           Claim Number
     C           *LIKE     DEFN WEBIC3    WQSG02           Claim Company N
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Claim Number
     C                     KFLD           WQSG02           Claim Company N
      * Setup key
     C                     Z-ADDP1C0C7    WQSG01           Claim Number
     C                     Z-ADDWCAIC3    WQSG02           Claim Company N
      * Establish starting position
     C           KRSSG     SETLL@MOCPXL                    *
     C           KRSSG     READE@MOCPXL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2737' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@MOCPXL                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Vry Clm RslPd/Appr CO RT - A/R Claim Resale Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC0C7    WQSH01           Claim Number
     C           *LIKE     DEFN WFBHC3    WQSH02           Resale Company
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Claim Number
     C                     KFLD           WQSH02           Resale Company
      * Setup key
     C                     Z-ADDP1C0C7    WQSH01           Claim Number
     C                     Z-ADDWCAIC3    WQSH02           Resale Company
      * Establish starting position
     C           KRSSH     SETLL@MPCPXM                    *
     C           KRSSH     READE@MPCPXM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2739' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@MPCPXM                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0001    WGBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSI     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Salesperson Cod
     C                     MOVEL*BLANK    YL0008           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGBCCD    YL0001           Salesperson Cod
     C                     MOVELWGALTX    YL0008           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv All Fields         RT - Salesperson Electronic CM  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0009    WHBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSJ     CHAIN@NFREAW              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2882' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Email Address
     C                     MOVEL*BLANK    YL0011           Availability Gr
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHUGTX    YL0010           Email Address
     C                     MOVELWHV4CD    YL0011           Availability Gr
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Crt A/R Claim ApprlStdRT - A/R Claim Approval  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIF0AA    WQSK01           Approval Title
     C           *LIKE     DEFN WIC0C7    WQSK02           Claim Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Approval Title
     C                     KFLD           WQSK02           Claim Number
      * Setup key
     C                     MOVELWL0002    WQSK01           Approval Title
     C                     Z-ADDWL0001    WQSK02           Claim Number
      * Establish starting position
     C           KRSSK     SETLL@AYCPXQ                    *
     C           KRSSK     READE@AYCPXQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3431' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     Z-ADD*ZERO     WN0001  70       Create Date
     C                     Z-ADD*ZERO     WN0002  60       Create Time
     C                     MOVEL*BLANK    WN0003 10        Create User
     C                     MOVEL*BLANK    WN0004 10        Create Program
     C                     Z-ADD*ZERO     WN0005  70       Change Date
     C                     Z-ADD*ZERO     WN0006  60       Change Time
     C                     MOVEL*BLANK    WN0007 10        Change User
     C                     MOVEL*BLANK    WN0008 10        Change Program
      *
      * Crt A/R Claim Apprl   IF
      * Rtv Next Seq #        RT - A/R Claim Approval  * 
     C                     EXSR SLRVGN
      * Crt A/R Claim ApprlSA CR - A/R Claim Approval  * 
     C                     EXSR SMCRRC
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - A/R Claim Approval  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJC0C7    WQSL01           Claim Number
     C           *LIKE     DEFN WJF0AA    WQSL02           Approval Title
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Claim Number
     C                     KFLD           WQSL02           Approval Title
      * Setup key
     C                     Z-ADDWL0001    WQSL01           Claim Number
     C                     MOVELWL0002    WQSL02           Approval Title
      * Establish starting position
     C           KRSSL     SETLLZAYCPYG                    *
     C           KRSSL     READEZAYCPYG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3431' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0012           Sequence Number
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WJDXNB    ADD  1         YL0012           Sequence Number
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READEZAYCPYG                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt A/R Claim ApprlSA CR - A/R Claim Approval  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0009  70       Create Date
     C                     Z-ADD*ZERO     WN0010  60       Create Time
     C                     MOVEL*BLANK    WN0011 10        Create User
     C                     MOVEL*BLANK    WN0012 10        Create Program
     C                     Z-ADD*ZERO     WN0013  70       Change Date
     C                     Z-ADD*ZERO     WN0014  60       Change Time
     C                     MOVEL*BLANK    WN0015 10        Change User
     C                     MOVEL*BLANK    WN0016 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPXM
     C                     Z-ADDWL0001    WBC0C7           Claim Number
     C                     MOVELWL0002    WBF0AA           Approval Title
     C                     Z-ADDYL0012    WBDXNB           Sequence Number
     C                     MOVELWL0003    WBQ7NA           Approval Title
     C                     MOVELWL0004    WBFDT1           Approval Person
     C                     MOVELWL0005    WBFET1           Approval Person
     C                     Z-ADDWL0006    WBYZNX           Approval Person
     C                     MOVELWL0007    WBTUSX           Approval Person
     C                     Z-ADDWL0008    WBMODT           Approved/Denied
     C                     Z-ADDWL0009    WBBHTM           Approved/Denied
     C                     MOVELWL0010    WBTVSX           Approval Requir
     C                     MOVELWL0011    WBTWSX           Approval Status
     C                     Z-ADDWL0012    WBP4DT           Emailed Date
     C                     Z-ADDWL0013    WBP5DT           Emailed Time
     C                     MOVELWL0014    WBVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WBVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WBMJDT           Create Date
     C                     Z-ADD##JTM     WBBETM           Create Time
     C                     MOVEL##USR     WBCCVN           Create User
     C                     MOVEL##PGM     WBCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WBMKDT           Change Date
     C                     Z-ADD0         WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
     C           KLCRSM    KLIST
     C                     KFLD           WBC0C7           Claim Number
     C                     KFLD           WBF0AA           Approval Title
     C                     KFLD           WBDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSM    SETLL@AYCPXM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3432' W0RTN   7
      * Send message 'A/R Claim Approval     EX'
     C                     MOVEL'USR3432' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPXM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: PAR.Claim Audit Selection Usr is yes
     C           *BLANK    IFEQ 'Y'                        *IF
      * System generated action notes
      * Claim approval was added
      * Crt A/R Claim ExpComSG XF - A/R Claim Explanation  * 
     C                     CALL 'PMTNXFR'              90  Crt A/R Claim E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0001    WQ0001  70       Claim Number
     C                     PARM @CN,001   WQ0002 70        Claim Explanati
     C                     PARM 'S'       WQ0003  1        Claim Expl Type
     C                     PARM @CN,002   WQ0004 10        Claim Expl Acti
     C                     PARM 0         WQ0005  70       Claim Expl Acti
     C                     PARM 0         WQ0006  60       Claim Expl Acti
     C                     PARM 'CAR'     WQ0007  4        Claim Departmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMTNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Require CM Apv    RT - A/R Claim Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0013           *Record selecte
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKC0C7    WQSN01           Claim Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    WQSN01           Claim Number
      * Establish starting position
     C           KRSSN     SETLL@MOCPWK                    *
     C           KRSSN     READE@MOCPWK                  90*
      * Data record not found
     C   90                MOVEL'USR2737' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CP Require CM Approval is Approval Required
     C           WKQZSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0013           *Record selecte
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READE@MOCPWK                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Require CM Apv - A/R Claim Resale Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0013           *Record selecte
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLC0C7    WQSO01           Claim Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Claim Number
      * Setup key
     C                     Z-ADDP1C0C7    WQSO01           Claim Number
      * Establish starting position
     C           KRSSO     SETLL@MPCPWQ                    *
     C           KRSSO     READE@MPCPWQ                  90*
      * Data record not found
     C   90                MOVEL'USR2739' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CRP Require CM Approval is Approval Required
     C           WLQWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0013           *Record selecte
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@MPCPWQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Min Max Validtion applies to claim amount positive side
      *================================================================
      * MIN MAX ON CLAIM
      * CASE: DB1.Minimum Net Loss Amount is not equal to zeros
     C           WCEKVL    IFNE 0                          *IF
      * CASE: claim amount must be in range of min/max
      *  - c1 AND c2
      *   |- c1    : LCL.Amount Paid GE DB1.Minimum Net Loss Amount
      *   |- c2    : LCL.Amount Paid LE DB1.Maximum Net Loss Amount
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFGE WCEKVL                     *IF
     C           YL0005    IFLE WCELVL                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Max or Min Validtion applies to claim amount negative check
      *================================================================
      * Max or min on claim -- Neg check
      * CASE: DB1.Minimum Net Loss Amount is not equal to zeros
     C           WCEKVL    IFNE 0                          *IF
     C           WCEKVL    MULT -1        YL0006           Minimum Net Los
     C           WCELVL    MULT -1        YL0007           Maximum Net Los
      * Did not pass Positive Ranage now check Neg Ranage
      * CASE: net loss must be in range of min/max
      *  - c1 AND c2
      *   |- c1    : LCL.Amount Paid GE LCL.Maximum Net Loss Amount
      *   |- c2    : LCL.Amount Paid LE LCL.Minimum Net Loss Amount
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFGE YL0007                     *IF
     C           YL0005    IFLE YL0006                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAYZNX           Approval Person
     C                     Z-ADD*ZERO     WAMODT           Approved/Denied
     C                     Z-ADD*ZERO     WABHTM           Approved/Denied
     C                     Z-ADD*ZERO     WAP4DT           Emailed Date
     C                     Z-ADD*ZERO     WAP5DT           Emailed Time
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCYZNX           Approval Person
     C                     Z-ADD*ZERO     WCEKVL           Minimum Net Los
     C                     Z-ADD*ZERO     WCELVL           Maximum Net Los
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDBIC3           Claim Company N
     C                     Z-ADD*ZERO     WDALNX           Claim Order Num
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDC3C7           Claim Ship to C
     C                     Z-ADD*ZERO     WDAYVL           Claim Amount
     C                     Z-ADD*ZERO     WDAZVL           Claim Net Loss
     C                     Z-ADD*ZERO     WDA0VL           Claim Approved
     C                     Z-ADD*ZERO     WDA1VL           Lab Fee
     C                     Z-ADD*ZERO     WDMLDT           Resolve Claim b
     C                     Z-ADD*ZERO     WDEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WDMMDT           Claim Called in
     C                     Z-ADD*ZERO     WDMNDT           Claim Entry Dat
     C                     Z-ADD*ZERO     WDBGTM           Claim Entry Tim
     C                     Z-ADD*ZERO     WDC4C7           Resale Ship to
     C                     Z-ADD*ZERO     WDNFDT           Sales Approved
     C                     Z-ADD*ZERO     WDBJTM           Sales Approved
     C                     Z-ADD*ZERO     WDMODT           Approved/Denied
     C                     Z-ADD*ZERO     WDBHTM           Approved/Denied
     C                     Z-ADD*ZERO     WDMPDT           Memo Created Da
     C                     Z-ADD*ZERO     WDBITM           Memo Created Ti
     C                     Z-ADD*ZERO     WDEOVL           Approved Net Lo
     C                     Z-ADD*ZERO     WDEPVL           Total Expense A
     C                     Z-ADD*ZERO     WDP6DT           Memo Post Date
     C                     Z-ADD*ZERO     WDCRTM           Memo Post Time
     C                     Z-ADD*ZERO     WDYSNX           TFS Batch Numbe
     C                     Z-ADD*ZERO     WDF7PC           Avg TF Responsi
     C                     Z-ADD*ZERO     WDF8PC           Avg SBF Respons
     C                     Z-ADD*ZERO     WDF9PC           Unused % field
     C                     Z-ADD*ZERO     WDEQVL           AC Unused Value
     C                     Z-ADD*ZERO     WDERVL           AC Unused Value
     C                     Z-ADD*ZERO     WDESVL           AC Unused Value
     C                     Z-ADD*ZERO     WDETVL           AC Unused Value
     C                     Z-ADD*ZERO     WDGAPC           AC Unused % 1
     C                     Z-ADD*ZERO     WDGBPC           AC Unused % 2
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAFNX           Claim Item Line
     C                     Z-ADD*ZERO     WEBIC3           Claim Company N
     C                     Z-ADD*ZERO     WEC1C7           Claim Item Code
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEKUQT           Claim Item Quan
     C                     Z-ADD*ZERO     WEHHWG           Claim Item Weig
     C                     Z-ADD*ZERO     WEDIPR           Claim Item Unit
     C                     Z-ADD*ZERO     WEBNVL           Claim Item Amou
     C                     Z-ADD*ZERO     WEFXPR           Inventory Value
     C                     Z-ADD*ZERO     WEALNX           Claim Order Num
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEYTNX           Claim Memo Numb
     C                     Z-ADD*ZERO     WEFYPR           CP Unused Price
     C                     Z-ADD*ZERO     WEFZPR           CP Unused Price
     C                     Z-ADD*ZERO     WEF0PR           CP Unused Price
     C                     Z-ADD*ZERO     WEF1PR           CP Unused Price
     C                     Z-ADD*ZERO     WEF2PR           CP Unused Price
     C                     Z-ADD*ZERO     WEEUVL           CP Unused Value
     C                     Z-ADD*ZERO     WEEVVL           CP Unused Value
     C                     Z-ADD*ZERO     WEEWVL           CP Unused Value
     C                     Z-ADD*ZERO     WEEXVL           CP Unused Value
     C                     Z-ADD*ZERO     WEEYVL           CP Unused Value
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFAKNX           Resale Item Lin
     C                     Z-ADD*ZERO     WFBHC3           Resale Company
     C                     Z-ADD*ZERO     WFC5C7           Resale Item Cod
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFKVQT           Resale Item Qua
     C                     Z-ADD*ZERO     WFHIWG           Resale Item Wei
     C                     Z-ADD*ZERO     WFDJPR           Resale Item Uni
     C                     Z-ADD*ZERO     WFBOVL           Resale Item Amo
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Clear all neither parameters
      * Crt A/R Claim ApprlSA CR - A/R Claim Approval  * 
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 50
     C                     Z-ADD*ZERO     WL0006 110
     C                     MOVEL*BLANK    WL0007  1
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  60
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  60
     C                     MOVEL*BLANK    WL0014  1
      * Define local work field Salesperson to Rvw Claim
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Claim Amount
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Claim Net Loss
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Approved Net Loss
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Amount Paid
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field Minimum Net Loss Amount
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Maximum Net Loss Amount
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0010 50
      * Define local work field Availability Group Code
     C                     MOVEL*BLANK    YL0011  3
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field *Record selected
     C                     MOVEL*BLANK    YL0013  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Claim approval was added
00002 CLMCHANGE
