/***************************************************************** */
/*                                                                 */
/*  SYSTEM:          ORDER MANAGEMENT SYSTEM                       */
/*  PROGRAM NUMBER:  PBI2UPC                                       */
/*  PROGRAM NAME:    REPLACE BLANKS WITH VARIABLE VALUE            */
/*  PROGRAMMER:      LARA BUSER                                    */
/*  CREATE DATE:     06/14/2013                                    */
/*  PURPOSE:         REPLACE BLANKS AT THE END OF A STRING WITH A  */
/*                   REPLACEMENT CHARACTER TO MAKE HIGH VALUE.     */
/*                   FOR INSTANCE, IF A PO# IS PASSED IN WITH 9    */
/*                   AS THE REPLACEMENT CHAR, FLIP THROUGH TILL    */
/*                   THE FIRST BLANK THEN REPLACE THE REST OF THE  */
/*                   STRING WITH 9'S                               */
/*******************************************************************/
             PGM (&STRING &STRLENGTH &RPLCHAR)

             DCL        VAR(&STRING) TYPE(*CHAR) LEN(30)
             DCL        VAR(&STRLENGTH) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&RPLCHAR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&COUNTER) TYPE(*DEC) LEN(2 0)

             MONMSG     MSGID(CPF0000)
             CHGVAR     VAR(&COUNTER) VALUE(0)
             IF         COND(&STRLENGTH *EQ 0) THEN(CHGVAR +
                          VAR(&STRLENGTH) VALUE(30))
/*-----------------------------------------------------------------*/
/* LOOP THROUGH EACH CHARACTER IN THE STRING AND REPLACE ANY       */
/* BLANKS WITH THE PASSED IN REPLACEMENT CHARACTER                 */
/*-----------------------------------------------------------------*/
 LOOP:       IF         COND(&COUNTER *LE &STRLENGTH) THEN(CHGVAR +
                          VAR(&COUNTER) VALUE(&COUNTER + 1))
             IF         COND(&COUNTER *GT &STRLENGTH) THEN(GOTO +
                          CMDLBL(END))
             IF         COND(%SST(&STRING &COUNTER 1) *EQ ' ') +
                          THEN(CHGVAR VAR(%SST(&STRING &COUNTER 1)) +
                          VALUE(&RPLCHAR))
             GOTO       CMDLBL(LOOP)

 END:        ENDPGM
