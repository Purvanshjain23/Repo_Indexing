// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKSSXFR
// ?Date: 14.08.2025 Time: 02:52:39
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?MODIFICATIONS
//?11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5 TO 7
EXECUTE FUNCTION(Utl Upd Pricing Date  RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1224055;
PARAMETER(360);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.TH Hog Class Type is Not Resale
 IF DB1.TH_Hog_Class_Type = 'M'/'S';

 EXECUTE FUNCTION(Rtv PrchPrc Clc Info  RT) TYPE(RTVOBJ) FILE(PKAWCPP)           AB1116661;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(PAR.BOH_Market_Add_Deduct);
 PARAMETER(PAR.BOH_Quote_Price_Type);
 PARAMETER(PAR.BOH_Quoted_Base_Mkt_Price);
 PARAMETER(PAR.BOH_Commodity_Market_Code);
 PARAMETER(PAR.BOH_Commodity_Price_Group);
 PARAMETER(PAR.BOH_Market_Date_Method);
 PARAMETER(PAR.PC_Contract_Code);
 PARAMETER(PAR.PSC_Sub_Contract_Code);
 PARAMETER(PAR.PO_Option_Code);
 PARAMETER(PAR.CMP_Program_Code);
 {
  //?USER: Processing if Data record not found

  //?1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv PurchPrc Clc Info RT) TYPE(RTVOBJ) FILE(PKAQCPP)           AB1116645;
 PARAMETER(PAR.PC_Contract_Code);
 PARAMETER(PAR.PSC_Sub_Contract_Code);
 PARAMETER(PAR.PSC_Floor_Price);
 PARAMETER(PAR.PSC_Ceiling_Price);
 PARAMETER(PAR.PSC_Market_Percent_NU);
 PARAMETER(PAR.PSC_Break_Even_Percent);
 PARAMETER(PAR.PSC_FLoor_Price_+);
 PARAMETER(PAR.PSC_Sub_Contract_Type);
 PARAMETER(PAR.PSC_Mkt_Percent);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Call program Clc Base Mkt Price    XF.
 CALL PROGRAM(Clc Base Mkt Price    XF) ('PKJ7XFR');
 PARAMETER(PAR.BOH_Market_Add_Deduct);
 PARAMETER(PAR.BOH_Quote_Price_Type);
 PARAMETER(PAR.BOH_Quoted_Base_Mkt_Price);
 PARAMETER(PAR.BOH_Commodity_Market_Code);
 PARAMETER(PAR.BOH_Commodity_Price_Group);
 PARAMETER(PAR.BOH_Market_Date_Method);
 PARAMETER(PAR.PC_Contract_Code);
 PARAMETER(PAR.PSC_Sub_Contract_Code);
 PARAMETER(PAR.PO_Option_Code);
 PARAMETER(PAR.CMP_Program_Code);
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(DB1.TH_Purchase_Date);
 PARAMETER(DB1.TH_Live_Wgt);
 PARAMETER(LCL.TH_CM_Base_Mkt_Price);
 PARAMETER(PAR.PSC_Floor_Price);
 PARAMETER(PAR.PSC_Ceiling_Price);
 PARAMETER(PAR.PSC_Market_Percent_NU);
 PARAMETER(PAR.PSC_Mkt_Percent);
 PARAMETER(LCL.TH_CM_Market_Price);
 PARAMETER(LCL.Pricing_UOM_USR);
 PARAMETER(LCL.TH_Pricing_Date);

 EXECUTE FUNCTION(Chg Market Price/Dte  CH) TYPE(CHGOBJ) FILE(PKA1CPP)           AB1230640;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(LCL.TH_Pricing_Date);
 PARAMETER(LCL.TH_CM_Market_Price);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 ENDIF;

}


