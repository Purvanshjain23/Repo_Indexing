// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBJYXFR
// ?Date: 14.08.2025 Time: 03:48:16
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?DAY 0
// PAR.Date 0 RGF = PAR.Scheduled Ship Date + CON.-3 *DAYS
PAR.Date_0_RGF = DATEINCR(PAR.Scheduled_Ship_Date '-3' 'DY' 1111111 'NONE' 'N' 1);

EXECUTE FUNCTION(RTV Day of Week No.   RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1658821;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_0_RGF);
PARAMETER(LCL.Day_0_Usr);
{
 //?USER: Process Data record

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 MOVE *ALL (To: PAR From: DB1);

}


//?DAY 1
EXECUTE FUNCTION(RTV Next Date/DayNoHoldRT) TYPE(RTVOBJ) FILE(CAAFREP)          AC2073669;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Scheduled_Ship_Date);
PARAMETER(PAR.Date_1_RGF);
PARAMETER(LCL.Day_1_Usr);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
 IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Public Holiday Status is yes
 IF DB1.Public_Holiday_Status = 'Y';

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?this will cover production days and sunday
 // PAR.Production Date = DB1.Post to G/L Date
 PAR.Production_Date = DB1.Post_to_G_L_Date;

 // PAR.Day of Week = DB1.Day of Week
 PAR.Day_of_Week = DB1.Day_of_Week;

 QUIT;

 ENDIF;

 ENDIF;

}


//?DAY 2
EXECUTE FUNCTION(RTV Next Date/DayNoHoldRT) TYPE(RTVOBJ) FILE(CAAFREP)          AC2073669;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_1_RGF);
PARAMETER(PAR.Date_2_RGF);
PARAMETER(LCL.Day_2_Usr);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
 IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Public Holiday Status is yes
 IF DB1.Public_Holiday_Status = 'Y';

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?this will cover production days and sunday
 // PAR.Production Date = DB1.Post to G/L Date
 PAR.Production_Date = DB1.Post_to_G_L_Date;

 // PAR.Day of Week = DB1.Day of Week
 PAR.Day_of_Week = DB1.Day_of_Week;

 QUIT;

 ENDIF;

 ENDIF;

}


//?REMAINDING  BEGINNING
EXECUTE FUNCTION(RTV Next Date/DayNoHoldRT) TYPE(RTVOBJ) FILE(CAAFREP)          AC2073669;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_2_RGF);
PARAMETER(PAR.Date_3_RGF);
PARAMETER(WRK.Day_of_Week);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
 IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Public Holiday Status is yes
 IF DB1.Public_Holiday_Status = 'Y';

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?this will cover production days and sunday
 // PAR.Production Date = DB1.Post to G/L Date
 PAR.Production_Date = DB1.Post_to_G_L_Date;

 // PAR.Day of Week = DB1.Day of Week
 PAR.Day_of_Week = DB1.Day_of_Week;

 QUIT;

 ENDIF;

 ENDIF;

}


// PAR.Date 3 RGT = PAR.Date 3 RGF
PAR.Date_3_RGT = PAR.Date_3_RGF;

CASE;

// IF WRK.Day of Week is Sunday
IF WRK.Day_of_Week = '1';

EXECUTE FUNCTION(RTV Next Date/DayNoHoldRT) TYPE(RTVOBJ) FILE(CAAFREP)          AC2073669;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_3_RGF);
PARAMETER(PAR.Date_3_RGT);
PARAMETER(WRK.Day_of_Week);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
 IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Public Holiday Status is yes
 IF DB1.Public_Holiday_Status = 'Y';

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?this will cover production days and sunday
 // PAR.Production Date = DB1.Post to G/L Date
 PAR.Production_Date = DB1.Post_to_G_L_Date;

 // PAR.Day of Week = DB1.Day of Week
 PAR.Day_of_Week = DB1.Day_of_Week;

 QUIT;

 ENDIF;

 ENDIF;

}


ENDIF;

//?REMAINDING  ENDING
EXECUTE FUNCTION(RTV Next Sunday        RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1672814;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_3_RGT);
PARAMETER(PAR.Date_3_RGT);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Day of Week is Sunday
 IF DB1.Day_of_Week = '1';

 // PAR.Scheduled Ship Date = DB1.Post to G/L Date
 PAR.Scheduled_Ship_Date = DB1.Post_to_G_L_Date;

 QUIT;

 ENDIF;

}


