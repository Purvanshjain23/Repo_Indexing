     H/TITLE UPS Clc In/Nd/Std/BOM XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/12/01  Time  : 17:22:05
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDI8CPL5IF  E           K        DISK
      * RTV : PS Prod Item Schedule      RTV: FG *Sel All
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDI8CPL0UF  E           K        DISK
      * UPD : PS Prod Item Schedule     Update index
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WBAIC3
     I              JCV5ST                          WBV5ST
     I              JCELDT                          WBELDT
     I              JCHVHD                          WBHVHD
     I              JCZ6NB                          WBZ6NB
     I              JCZ7NB                          WBZ7NB
     I              JCDGPC                          WBDGPC
     I              JCAVCW                          WBAVCW
     I              JCDIPC                          WBDIPC
     I              JCZ0NB                          WBZ0NB
     I              JCAVLE                          WBAVLE
     I              JCECWG                          WBECWG
     I              JCUVST                          WBUVST
     I              JCUWST                          WBUWST
     I              JCUXST                          WBUXST
     I              JCVSST                          WBVSST
     I              JCAATM                          WBAATM
     I              JCAYNA                          WBAYNA
     I              JCA0NA                          WBA0NA
     I              JCAXDT                          WBAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WCAIC3
     I              AFBCDT                          WCBCDT
     I              AFCQNB                          WCCQNB
     I              AFESNB                          WCESNB
     I              AFETNB                          WCETNB
     I              AFBZNB                          WCBZNB
     I              AFA9ST                          WCA9ST
     I              AFEINB                          WCEINB
     I              AFC5ST                          WCC5ST
     I              AFAQNB                          WCAQNB
     I              AFCMST                          WCCMST
     I              AFV9ST                          WCV9ST
     I              AFWAST                          WCWAST
     I              AFX2ST                          WCX2ST
     I              AFOJDT                          WCOJDT
     I              AFNQNX                          WCNQNX
     I              AFNRNX                          WCNRNX
     I              AFI9SX                          WCI9SX
     I              AFJASX                          WCJASX
     I              AFOKDT                          WCOKDT
     I              AFOLDT                          WCOLDT
     I              AFUVST                          WCUVST
     I              AFUWST                          WCUWST
     I              AFUXST                          WCUXST
     I              AFAATM                          WCAATM
     I              AFAYNA                          WCAYNA
     I              AFA0NA                          WCA0NA
     I              AFAXDT                          WCAXDT
      *
     I@I8CPZZ
      * PS Prod Item Schedule      RTV: FG *Sel All
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WFAIC3
     I              I8V5ST                          WFV5ST
     I              I8ELDT                          WFELDT
     I              I8HGCD                          WFHGCD
     I              I8AJCD                          WFAJCD
     I              I8GPDT                          WFGPDT
     I              I8WTSP                          WFWTSP
     I              I8QTSP                          WFQTSP
     I              I8DJPC                          WFDJPC
     I              I8F8WG                          WFF8WG
     I              I8WTIN                          WFWTIN
     I              I8D5NB                          WFD5NB
     I              I8DXWG                          WFDXWG
     I              I8B2NB                          WFB2NB
     I              I8WTCN                          WFWTCN
     I              I8PSCV                          WFPSCV
     I              I8SAWT                          WFSAWT
     I              I8B9NB                          WFB9NB
     I              I8D1WG                          WFD1WG
     I              I8CBNB                          WFCBNB
     I              I8EZWG                          WFEZWG
     I              I8CCNB                          WFCCNB
     I              I8E0WG                          WFE0WG
     I              I8D6NB                          WFD6NB
     I              I8OAWT                          WFOAWT
     I              I8CDNB                          WFCDNB
     I              I8UNW2                          WFUNW2
     I              I8CENB                          WFCENB
     I              I8F9WG                          WFF9WG
     I              I8BPNB                          WFBPNB
     I              I8GAWG                          WFGAWG
     I              I8BQNB                          WFBQNB
     I              I8GBWG                          WFGBWG
     I              I8BRNB                          WFBRNB
     I              I8GCWG                          WFGCWG
     I              I8BSNB                          WFBSNB
     I              I8GDWG                          WFGDWG
     I              I8BWNB                          WFBWNB
     I              I8GEWG                          WFGEWG
     I              I8PS6U                          WFPS6U
     I              I8WCST                          WFWCST
     I              I8WPST                          WFWPST
     I              I8B5ST                          WFB5ST
     I              I8TFST                          WFTFST
     I              I8TEST                          WFTEST
     I              I8THST                          WFTHST
     I              I8UDST                          WFUDST
     I              I8UFST                          WFUFST
     I              I8UGST                          WFUGST
     I              I8UHST                          WFUHST
     I              I8B6ST                          WFB6ST
     I              I8B7ST                          WFB7ST
     I              I8DVWG                          WFDVWG
     I              I8D7NB                          WFD7NB
     I              I8FCAD                          WFFCAD
     I              I8D9NB                          WFD9NB
     I              I8DWWG                          WFDWWG
     I              I8EANB                          WFEANB
     I              I8SHWT                          WFSHWT
     I              I8EBNB                          WFEBNB
     I              I8AVWT                          WFAVWT
     I              I8ECNB                          WFECNB
     I              I8WTON                          WFWTON
     I              I8EDNB                          WFEDNB
     I              I8FNWT                          WFFNWT
     I              I8EENB                          WFEENB
     I              I8QTAS                          WFQTAS
     I              I8EFNB                          WFEFNB
     I              I8WAIO                          WFWAIO
     I              I8EGNB                          WFEGNB
     I              I8R3CD                          WFR3CD
     I              I8RGNB                          WFRGNB
     I              I8RHNB                          WFRHNB
     I              I8RINB                          WFRINB
     I              I8XRCD                          WFXRCD
     I              I8UVST                          WFUVST
     I              I8UWST                          WFUWST
     I              I8UXST                          WFUXST
     I              I8VSST                          WFVSST
     I              I8AATM                          WFAATM
     I              I8AYNA                          WFAYNA
     I              I8A0NA                          WFA0NA
     I              I8AXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                              9
      * KEY : Item Balance              Active/On-Hand > 0
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            326
     IYCRDCS      DS                            326
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Production Date RGF
     I                                    P   1   40P2GVDT
     IP3PARM      DS
      * I :  Production Date RGT
     I                                    P   1   40P3GWDT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2GVDT    PARM           WP0002  70       Production Date
     C           P3GWDT    PARM           WP0003  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPS Clc In/Nd/Std/BOM XF
      * UPS Clc Inv/Nd/Std/BOM RT - Calendar  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPS Clc Inv/Nd/Std/BOM RT - Calendar  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Production Date
     C                     MOVEL*BLANK    WN0002  1        Error Std Mix U
     C                     MOVEL*BLANK    WN0003  1        Error BOM USR
     C                     MOVEL*BLANK    WN0004  1        Production Type
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP2GVDT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFREBE                    *
     C           KRSSA     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Plant Date of Last Order GT PAR.Production Date RGT
     C           WABCDT    IFGT P3GWDT                     *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Sched Existance   RT - PS Production Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     MOVEL'S'       WL0002    P      Production Type
     C                     Z-ADDWABCDT    WL0003           Production Date
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUWXST    P      Record Found US
      * Determine Production Type
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
     C                     MOVEL'S'       WN0004           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       WN0004           Production Type
     C                     END                             *FI
      * CASE: DB1.Day of Week is Sunday
     C           WAA9ST    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Bld FG Items      XF - Company/Item  * Create Items
     C                     CALL 'PDQ7XFR'              90  UPS Bld FG Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0001  30       Company Number
     C                     PARM WN0004    WQ0002  1        Production Type
     C                     PARM WABCDT    WQ0003  70       Production Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Process Inventory/Need/Conv Dept/Fab Dept/Sched Prod
      * CASE: Kill Day=Y or Prod Day=Y
      *  - c1 OR c2
      *   |- c1    : DB1.Kill Day Status is yes
      *   |- c2    : DB1.Production Day Status is yes
      *   '-
     C           WAV9ST    IFEQ 'Y'                        *IF
     C           WAWAST    OREQ 'Y'                        *OR
      * Inventory / Available Production
      * CASE: PAR.Production Type is Schedule
     C           WN0004    IFEQ 'S'                        *IF
      * UPS Clc Inv/Shp/Avail PF - IC Item Balance  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
      *
     C                     CALL 'PDMVPFR'              90  UPS Clc Inv/Shp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Item Balan
     C                     PARM WABCDT    WQ0004  70       Production Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prev Prd Dte      RT - Calendar  * 
     C                     EXSR SCRVGN
      * UPS Clc Avail Prod    RT - PS Production Detail  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Val Sched Existance   RT - PS Production Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     MOVELWN0004    WL0002    P      Production Type
     C                     Z-ADDWABCDT    WL0003           Production Date
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUWXST    P      Record Found US
      * Calc Need/Conv Dept/Fab Dept/Sched Prod
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Needs         RT - PS Production Detail  * 
     C                     EXSR SFRVGN
      * UPS Sch Conv Depts    PF - PS Production Department  * 
     C                     CALL 'PDA9PFR'              90  UPS Sch Conv De
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0017  30       Company Number
     C                     PARM WN0004    WQ0018  1        Production Type
     C                     PARM WABCDT    WQ0019  70       Production Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDA9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Sch Fab Depts     PF - PS Production Department  * 
     C                     CALL 'PDBEPFR'              90  UPS Sch Fab Dep
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0020  30       Company Number
     C                     PARM WN0004    WQ0021  1        Production Type
     C                     PARM WABCDT    WQ0022  70       Production Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBEPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Clc Sched Prod    RT - PS Production Detail  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Production Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     MOVELWL0002    WBV5ST           Production Type
     C                     Z-ADDWL0003    WBELDT           Production Date
      * Establish starting position
     C           KRSSB     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0004           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0004           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Prev Prd Dte      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WCBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     Z-ADDWABCDT    WCBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSC     SETLL@AFREPU                    *
     C           KRSSC     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Orde
     C           WCBCDT    IFEQ WABCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           WCWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWCBCDT    WN0001           Production Date
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Prod    RT - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  92       PS Weight Avail
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDV5ST    WQSD02           Production Type
     C           *LIKE     DEFN WDELDT    WQSD03           Production Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Production Type
     C                     KFLD           WQSD03           Production Date
      * Setup key
     C                     Z-ADDWAAIC3    WQSD01           Company Number
     C                     MOVELWN0004    WQSD02           Production Type
     C                     Z-ADDWABCDT    WQSD03           Production Date
      * Establish starting position
     C           KRSSD     SETLL@I8CPZZ                    *
     C           KRSSD     READE@I8CPZZ                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Production Date Prev USR EQ PAR.Production Date RGF
     C           WN0001    IFEQ P2GVDT                     *IF
      * UPS Clc Avail Prd Pln XF - PS Production Detail  * 
     C                     CALL 'PDNIXFR'              90  UPS Clc Avail P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0005  30       Company Number
     C                     PARM 'S'       WQ0006  1        Production Type
     C                     PARM WN0001    WQ0007  70       Production Date
     C                     PARM WDHGCD    WQ0008  70       Item Code
     C                     PARM WDAJCD    WQ0009  3        Warehouse Code
     C           WN0005    PARM *ZERO     WQ0010  92       PS Weight Avail
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Prd Pln XF - PS Production Detail  * 
     C                     CALL 'PDNIXFR'              90  UPS Clc Avail P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0011  30       Company Number
     C                     PARM 'P'       WQ0012  1        Production Type
     C                     PARM WN0001    WQ0013  70       Production Date
     C                     PARM WDHGCD    WQ0014  70       Item Code
     C                     PARM WDAJCD    WQ0015  3        Warehouse Code
     C           WN0005    PARM *ZERO     WQ0016  92       PS Weight Avail
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * UPS Chg Avail Prod    CH - PS Production Detail  * 
     C                     EXSR SECHRC
     C           KRSSD     READE@I8CPZZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * UPS Chg Avail Prod    CH - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0007  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0008  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0009  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0010  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0011  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0012  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0015  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0016  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0017  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0018  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0019  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0020  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0021  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0022  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0023  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0024  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0025  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0026  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0027  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0028  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0029 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0030  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0031 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0032  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0033 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0034  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0035 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0036  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0037 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0038  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0039 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0040  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0041  3        PS Item Id
     C                     MOVEL*BLANK    WN0042  2        Warehouse Type
     C                     MOVEL*BLANK    WN0043  1        PS Lock Status
     C                     MOVEL*BLANK    WN0044  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0045  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0046  1        PS Piece Count
     C                     MOVEL*BLANK    WN0047  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0048  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0049  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0050  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0051  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0052  3        PS Unused Sts 6
     C                     Z-ADD*ZERO     WN0053  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0054  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0055  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0056  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0057  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0058  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0059  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0060  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0061  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0062  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0063  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0064  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0065  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0066  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0067  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0068  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0069  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0070  6        Department Code
     C                     Z-ADD*ZERO     WN0071  30       Item Structure
     C                     Z-ADD*ZERO     WN0072  30       Item Structure
     C                     Z-ADD*ZERO     WN0073  30       Item Structure
     C                     MOVEL*BLANK    WN0074  6        Primal Group Co
     C                     MOVEL*BLANK    WN0075  1        EDI Status 1
     C                     MOVEL*BLANK    WN0076  1        EDI Status 2
     C                     MOVEL*BLANK    WN0077  1        EDI Status 3
     C                     MOVEL*BLANK    WN0078  1        Record Status
     C                     Z-ADD*ZERO     WN0079  60       Job Time
     C                     MOVEL*BLANK    WN0080 10        User Id
     C                     MOVEL*BLANK    WN0081 10        Job Name
     C                     Z-ADD*ZERO     WN0082  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     MOVELWDV5ST    WEV5ST           Production Type
     C                     Z-ADDWDELDT    WEELDT           Production Date
     C                     Z-ADDWDHGCD    WEHGCD           Item Code
     C                     MOVELWDAJCD    WEAJCD           Warehouse Code
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHSE    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0005    WEAVWT           PS Weight Avail
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * UPS Clc Needs         RT - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0083  92       Weight Order Ne
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WDV5ST    WQSF02           Production Type
     C           *LIKE     DEFN WDELDT    WQSF03           Production Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Production Type
     C                     KFLD           WQSF03           Production Date
      * Setup key
     C                     Z-ADDWAAIC3    WQSF01           Company Number
     C                     MOVELWN0004    WQSF02           Production Type
     C                     Z-ADDWABCDT    WQSF03           Production Date
      * Establish starting position
     C           KRSSF     SETLL@I8CPZZ                    *
     C           KRSSF     READE@I8CPZZ                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.PS Item Identification is FG Seconds
     C           WDWCST    IFEQ 'FSC'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CALC: Forecast Adjustment Need (FAN)
     C                     Z-ADD*ZERO     WUFCOR           Weight FC Ad Nd
     C                     Z-ADDWDWTSP    WUEGWG           Weight AP + PP
      * FAN + FX
      * WRK.Weight FAN + FX USR =
      *    *COMPUTE (x2 + x3)
      * x2    : WRK.Weight FC Ad Nd (FAN) USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : DB1.PS Weight FX Adjusted
     C           WUFCOR    ADD  WDDWWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUWFFX           Weight FAN + FX
      * Production Order Need
      * CASE: WRK.Weight AP + PP USR LT DB1.PS Weight Ordered
     C           WUEGWG    IFLT WDDVWG                     *IF
     C           WDDVWG    SUB  WUEGWG    WN0083           Weight Order Ne
     C                     ELSE
      * CASE: WRK.Weight AP + PP USR GE DB1.PS Weight Ordered
     C           WUEGWG    IFGE WDDVWG                     *IF
     C                     Z-ADD*ZERO     WN0083           Weight Order Ne
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WUWFFX    WN0083           Weight Order Ne
      * UPS Chg Needs         CH - PS Production Detail  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C           KRSSF     READE@I8CPZZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * UPS Chg Needs         CH - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0084  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0085  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0086  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0087  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0088  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0089  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0090  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0091  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0092  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0093  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0094  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0095  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0096  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0097  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0098  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0099  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0100  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0101  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0102  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0103  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0104  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0105  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0106  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0107 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0108  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0109 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0110  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0111 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0112  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0113 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0114  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0115 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0116  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0117 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0118  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0119  3        PS Item Id
     C                     MOVEL*BLANK    WN0120  2        Warehouse Type
     C                     MOVEL*BLANK    WN0121  1        PS Lock Status
     C                     MOVEL*BLANK    WN0122  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0123  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0124  1        PS Piece Count
     C                     MOVEL*BLANK    WN0125  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0126  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0127  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0128  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0129  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0130  3        PS Unused Sts 6
     C                     Z-ADD*ZERO     WN0131  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0132  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0133  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0134  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0135  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0136  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0137  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0138  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0139  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0140  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0141  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0142  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0143  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0144  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0145  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0146  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0147  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0148  6        Department Code
     C                     Z-ADD*ZERO     WN0149  30       Item Structure
     C                     Z-ADD*ZERO     WN0150  30       Item Structure
     C                     Z-ADD*ZERO     WN0151  30       Item Structure
     C                     MOVEL*BLANK    WN0152  6        Primal Group Co
     C                     MOVEL*BLANK    WN0153  1        EDI Status 1
     C                     MOVEL*BLANK    WN0154  1        EDI Status 2
     C                     MOVEL*BLANK    WN0155  1        EDI Status 3
     C                     MOVEL*BLANK    WN0156  1        Record Status
     C                     Z-ADD*ZERO     WN0157  60       Job Time
     C                     MOVEL*BLANK    WN0158 10        User Id
     C                     MOVEL*BLANK    WN0159 10        Job Name
     C                     Z-ADD*ZERO     WN0160  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     MOVELWDV5ST    WEV5ST           Production Type
     C                     Z-ADDWDELDT    WEELDT           Production Date
     C                     Z-ADDWDHGCD    WEHGCD           Item Code
     C                     MOVELWDAJCD    WEAJCD           Warehouse Code
      *
     C           KLCHSG    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHSG    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YBRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0083    WEWTON           PS Weight Produ
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * UPS Clc Sched Prod    RT - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0161  92       PS Weight Sched
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WFV5ST    WQSH02           Production Type
     C           *LIKE     DEFN WFELDT    WQSH03           Production Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Production Type
     C                     KFLD           WQSH03           Production Date
      * Setup key
     C                     Z-ADDWAAIC3    WQSH01           Company Number
     C                     MOVELWN0004    WQSH02           Production Type
     C                     Z-ADDWABCDT    WQSH03           Production Date
      * Establish starting position
     C           KRSSH     SETLL@I8CPUS                    *
     C           KRSSH     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PS Item Identification is FG Seconds
      *   |- c2    : DB1.PS Item Identification is FG *All Loss
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WFWCST    IFEQ 'FSC'                      *IF
     C           WFWCST    IFEQ 'FLS'                      *IF
     C           WFWCST    OREQ 'FLC'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WN0161           PS Weight Sched
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Sched Production
      * PAR.PS Weight Sched Prod =
      *    *COMPUTE (x5 + x1 + x2 - x4 - x6)
      * x5    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (17,7) work field
      * x1    : DB1.PS Weight Sched Need
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Standard
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x6    : DB1.PS Weight Fab Needs
     C           WFWTSP    ADD  WFWAIO    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  WFDXWG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WFWTCN    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WFFNWT    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0161           PS Weight Sched
     C                     END                             *FI
      * UPS Chg Sched Prod    CH - PS Production Detail  * 
     C                     EXSR SICHRC
     C           KRSSH     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * UPS Chg Sched Prod    CH - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0162  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0163  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0164  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0165  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0166  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0167  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0168  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0169  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0170  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0171  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0172  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0173  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0174  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0175  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0176  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0177  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0178  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0179  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0180  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0181  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0182  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0183  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0184  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0185 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0186  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0187 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0188  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0189 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0190  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0191 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0192  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0193 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0194  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0195 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0196  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0197  3        PS Item Id
     C                     MOVEL*BLANK    WN0198  2        Warehouse Type
     C                     MOVEL*BLANK    WN0199  1        PS Lock Status
     C                     MOVEL*BLANK    WN0200  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0201  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0202  1        PS Piece Count
     C                     MOVEL*BLANK    WN0203  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0204  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0205  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0206  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0207  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0208  3        PS Unused Sts 6
     C                     Z-ADD*ZERO     WN0209  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0210  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0211  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0212  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0213  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0214  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0215  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0216  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0217  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0218  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0219  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0220  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0221  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0222  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0223  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0224  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0226  6        Department Code
     C                     Z-ADD*ZERO     WN0227  30       Item Structure
     C                     Z-ADD*ZERO     WN0228  30       Item Structure
     C                     Z-ADD*ZERO     WN0229  30       Item Structure
     C                     MOVEL*BLANK    WN0230  6        Primal Group Co
     C                     MOVEL*BLANK    WN0231  1        EDI Status 1
     C                     MOVEL*BLANK    WN0232  1        EDI Status 2
     C                     MOVEL*BLANK    WN0233  1        EDI Status 3
     C                     MOVEL*BLANK    WN0234  1        Record Status
     C                     Z-ADD*ZERO     WN0235  60       Job Time
     C                     MOVEL*BLANK    WN0236 10        User Id
     C                     MOVEL*BLANK    WN0237 10        Job Name
     C                     Z-ADD*ZERO     WN0238  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWFAIC3    WEAIC3           Company Number
     C                     MOVELWFV5ST    WEV5ST           Production Type
     C                     Z-ADDWFELDT    WEELDT           Production Date
     C                     Z-ADDWFHGCD    WEHGCD           Item Code
     C                     MOVELWFAJCD    WEAJCD           Warehouse Code
      *
     C           KLCHSI    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHSI    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YCRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0161    WEQTAS           PS Weight Sched
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBHVHD           Hog Volume
     C                     Z-ADD*ZERO     WBZ6NB           Average Live We
     C                     Z-ADD*ZERO     WBZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WBDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WBAVCW           Average Cold We
     C                     Z-ADD*ZERO     WBDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WBZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WBAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WBECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WDWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WDQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WDDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WDF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WDWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WDD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WDDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WDB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WDWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WDPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WDSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WDB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WDD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WDCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WDEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WDCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WDE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WDD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WDOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WDCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WDUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WDCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WDF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WDBPNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGAWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WDD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WDFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WDD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WDDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WDEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WDSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WDEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WDAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WDECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WDWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WDEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WDFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WDEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WDQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WDEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WDWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WDEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Weight FC Ad Nd (FAN) USR
     C                     Z-ADD*ZERO     WUFCOR  92
      * Define work field Weight AP + PP USR
     C                     Z-ADD*ZERO     WUEGWG 112
      * Define work field Weight FAN + FX USR
     C                     Z-ADD*ZERO     WUWFFX  92
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  1
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  1
      *================================================================
     CSR         ZZEXIT    ENDSR
