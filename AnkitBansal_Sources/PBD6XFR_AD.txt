// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBD6XFR
// ?Date: 14.08.2025 Time: 03:47:35
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// LCL.PSP Prod Run Sequence = CON.*ZERO
LCL.PSP_Prod_Run_Sequence = *ZERO;

// LCL.Company Number = CVTVAR(PAR.Company Alpha)
LCL.Company_Number = CVTVAR(PAR.Company_Alpha);

//?Information  1
DO;

//?This function will read all Item Category or
//?only the Item catefory that was selected from
//?the prompt screen
//?To drive the process to Create the Primal Group Report(s)
//?Reports will be Email but no spread sheet will be sent via
//?meeting with Curt.
//?If parms were established to send the data to Carlisle
//?then there are files that are created to perform this in
//?the next program PBD5UPC which will take care of the clp process
//?for this function.
//?The print program will test for the run number > 0
//?and if so then the work files will be created for all parties.
//?File PS Prod Item Schedule Summary
//?File PS Prod Item Schedule Detail
//?After the processing to print 1 report or all reports
//?and the run number is not = 0
//?then the last function in this process will read
//?File PS Prod Item Schedule Summary
//?and map the data that is place in the
//?File PFS Production Schedule
ENDDO;

EXECUTE FUNCTION(RTV Primal Sch Rpt AllRT) TYPE(RTVOBJ) FILE(PDJIREP)           AC2046739;
PARAMETER(LCL.Company_Number);
PARAMETER(06);
PARAMETER(PAR.Item_Primal_Sched_Report);
PARAMETER(PAR.Copies_Alpha_Usr);
PARAMETER(PAR.Company_Alpha);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.Application_Code);
PARAMETER(PAR.RqsShp_Date_Alpha_USR);
PARAMETER(PAR.Status_Y_or_N);
PARAMETER(PAR.Warehouse_Code);
PARAMETER(PAR.Email_Selection_usr);
PARAMETER(PAR.Print_HoldOvers_Usr);
PARAMETER(PAR.Summary_Selected_Usr);
PARAMETER(PAR.Item_Primal_Sched_Report);
PARAMETER(PAR.Snd_Data_Usr);
PARAMETER(LCL.PSP_Prod_Run_Sequence);
PARAMETER(PAR.Base_or_Not_Based_Usr);
{
 //?USER: Initialize routine

 // WRK.PSP Prod Run Sequence = CON.*ZERO
 WRK.PSP_Prod_Run_Sequence = *ZERO;

 //?Assign the production run number
 CASE;

 // IF PAR.Snd Data Usr is Yes
 IF PAR.Snd_Data_Usr = 'Y';

 //?Assign the Production Schedule Run number
 // WRK.EDI Status 3 = CND.Blank
 WRK.EDI_Status_3 = *BLANK;

 CASE;

 // IF PAR.Item Category Code is Not Entered
 IF PAR.Item_Category_Code = *BLANK;

 //?All is looking for at least 1 to do the run process
 //?if the run process is not selected for Carlisle then
 //?do not interface to Carlisle
 //?for this run
 EXECUTE FUNCTION(Val Carlisle IntfaceAlRT) TYPE(RTVOBJ) FILE(PDJIREP)           AC2055122;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Category_Number);
 PARAMETER(WRK.EDI_Status_3);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.EDI Status 3 is Send to Carlisle
  IF DB1.EDI_Status_3 = 'C'/'F';

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI Status 3 = CND.Blank
  PAR.EDI_Status_3 = *BLANK;

  ENDIF;

 }

 // IF PAR.Item Category Code is Entered
 IF PAR.Item_Category_Code > *BLANK;

 //?Specific Item Category is select for this process
 //?But if this is not flagged to interface Carlisle then do not
 //?assign a run sequence number
 EXECUTE FUNCTION(Val Carlisle Intface  RT) TYPE(RTVOBJ) FILE(PDJIREP)           AC2055120;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Category_Number);
 PARAMETER(PAR.Item_Category_Code);
 PARAMETER(WRK.EDI_Status_3);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

 CASE;

 // IF WRK.EDI Status 3 is Send to Carlisle
 IF WRK.EDI_Status_3 = 'C'/'F';

 // Call program RTV System Value Num   XF.
 CALL PROGRAM(RTV System Value Num   XF) ('PBE0XFR');
 PARAMETER('PSPRDRUN');
 PARAMETER(WRK.System_Value_Numeric);

 // WRK.System Value Numeric = WRK.System Value Numeric + CON.1.00000
 WRK.System_Value_Numeric = WRK.System_Value_Numeric + 1.00000;

 // Call program Upd System Value Num   XF.
 CALL PROGRAM(Upd System Value Num   XF) ('PBE1XFR');
 PARAMETER('PSPRDRUN');
 PARAMETER(WRK.System_Value_Numeric);

 // WRK.PSP Prod Run Sequence = WRK.System Value Numeric
 WRK.PSP_Prod_Run_Sequence = WRK.System_Value_Numeric;

 // PAR.PSP Prod Run Sequence = WRK.PSP Prod Run Sequence
 PAR.PSP_Prod_Run_Sequence = WRK.PSP_Prod_Run_Sequence;

 ENDIF;

 ENDIF;

 //?USER: Process Data record

 //?Modifications and Comments
 DO;

 //?E2745  9/4/2013 New Enhancement from Curt B
 //?09/04/13 Slm PS data being sent to carlisle (list)
 //?if this is "C" interface to Carlisle
 //?if this is "F" interface to Carlisle and send Future quantities
 //?if the run number > zero then these records will go to Carlisle
 //?E3796 JJH 02/19/15 - Requested Ship Date for Production Schedule
 ENDDO;

 CASE;

 // IF DB1.Record Status is Active
 IF DB1.Record_Status = 'A';

 // LCL.PSP Prod Run Sequence = CON.*ZERO
 LCL.PSP_Prod_Run_Sequence = *ZERO;

 CASE;

 // IF DB1.EDI Status 3 is Send to Carlisle
 IF DB1.EDI_Status_3 = 'C'/'F';

 // LCL.PSP Prod Run Sequence = WRK.PSP Prod Run Sequence
 LCL.PSP_Prod_Run_Sequence = WRK.PSP_Prod_Run_Sequence;

 ENDIF;

 //?Either all Primal Grp Reports, or a specific Primal Grp Report
 CASE;

 // IF PAR.Item Category Code EQ WRK.Blank for 3          USR
 IF PAR.Item_Category_Code = WRK.Blank_for_3_USR;

 //?selected *all if the parm on Item category code = blanks
 //?to run interactive then un * the print and * the message
 //?E3796 JJH 02/19/15 - Use RqsShp Date Alpha USR
 // Call program Prt Prd Schedule PrimalUP.
 CALL PROGRAM(Prt Prd Schedule PrimalUP) ('PBD5UPC');
 PARAMETER(WRK.Return_Code_Usr);
 PARAMETER(PAR.Copies_Alpha_Usr);
 PARAMETER(PAR.Company_Alpha);
 PARAMETER(PAR.PRT_Printer_Device);
 PARAMETER(PAR.PRT_Hold_Output_Sts);
 PARAMETER(PAR.PRT_Save_Output_Sts);
 PARAMETER(PAR.Application_Code);
 PARAMETER(PAR.RqsShp_Date_Alpha_USR);
 PARAMETER(PAR.Status_Y_or_N);
 PARAMETER(PAR.Warehouse_Code);
 PARAMETER(PAR.Email_Selection_usr);
 PARAMETER(PAR.Print_HoldOvers_Usr);
 PARAMETER(PAR.Summary_Selected_Usr);
 PARAMETER(DB1.Item_Category_Code);
 PARAMETER(LCL.PSP_Prod_Run_Sequence);
 PARAMETER(PAR.Base_or_Not_Based_Usr);

 //?Either all Primal Grp Reports, or a specific Primal Grp Report
 // IF PAR.Item Category Code EQ DB1.Item Category Code
 IF PAR.Item_Category_Code = DB1.Item_Category_Code;

 //?to run interactive then un * the print and * the message
 //?E3796 JJH 02/19/15 - Use RqsShp Date Alpha USR
 // Call program Prt Prd Schedule PrimalUP.
 CALL PROGRAM(Prt Prd Schedule PrimalUP) ('PBD5UPC');
 PARAMETER(WRK.Return_Code_Usr);
 PARAMETER(PAR.Copies_Alpha_Usr);
 PARAMETER(PAR.Company_Alpha);
 PARAMETER(PAR.PRT_Printer_Device);
 PARAMETER(PAR.PRT_Hold_Output_Sts);
 PARAMETER(PAR.PRT_Save_Output_Sts);
 PARAMETER(PAR.Application_Code);
 PARAMETER(PAR.RqsShp_Date_Alpha_USR);
 PARAMETER(PAR.Status_Y_or_N);
 PARAMETER(PAR.Warehouse_Code);
 PARAMETER(PAR.Email_Selection_usr);
 PARAMETER(PAR.Print_HoldOvers_Usr);
 PARAMETER(PAR.Summary_Selected_Usr);
 PARAMETER(DB1.Item_Category_Code);
 PARAMETER(LCL.PSP_Prod_Run_Sequence);
 PARAMETER(PAR.Base_or_Not_Based_Usr);

 QUIT;

 ENDIF;

 ENDIF;

}


CASE;

// IF LCL.PSP Prod Run Sequence is Not equal to zeros
IF LCL.PSP_Prod_Run_Sequence <> *ZERO;

//?Information  2
DO;

//?File PS Prod Item Schedule Summary
//?After the processing to print 1 report or all reports
//?and the run number is not = 0
//?then the next process will be to read all of the data
//?that was created in the PS Prod Item Sch Summary
//?equal to run number and write these records to the
//?PFS Production Schedule
ENDDO;

// Call program Crt ProdItemSch/PFS  SXF.
CALL PROGRAM(Crt ProdItemSch/PFS  SXF) ('PBE7XFR');
PARAMETER(LCL.PSP_Prod_Run_Sequence);
PARAMETER(PAR.Base_or_Not_Based_Usr);

ENDIF;

//?W118693 DN 01/30/23-Commented Out Emailing Call to PSORDCLP.
