      *
      * SYSTEM:      Hog Production System
      * PROGRAM:     HP40511
      * TITLE:       BGF Edit Listing - Check Object Locks
      * PROGRAMMER:  Barb Gutierrez
      * CREATED:     07/19/2021
      *
      *
      * FUNCTION: This function is used to read a spool file with the object lock results
      *           specified in HP40511CL.  If there is a lock on the file, return error
      *           message to calling program.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     FHSP4051   IF   e             DISK
      *
      /EJECT
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      *
      ****************************************************************
      * DATA STRUCTURES
      ****************************************************************
      *
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
      *
     D pgmds         esds                  extname(utpgfr)
      *
      *---------------------------------------------------------------
      *
      *---------------------------------------------------------------
      *  NAMED CONSTANTS
      *---------------------------------------------------------------
      *
     D mbrlck          C                   CONST('File has no member locks.')
      *
      ****************************************************************
      * STANDALONE FIELDS
      ****************************************************************
      *
      * Parm fields
      *
     D xxmsg           s              6
      *
      *---------------------------------------------------------------
      *
      *---------------------------------------------------------------
      * Break out single-field input record into individual fields
      *---------------------------------------------------------------
      *
     D inputrec        ds
     D   u1field                    132
     D   xxfield1                    25    overlay(u1field:2)
      *
      /EJECT
      ****************************************************************
      * MAINLINE
      ****************************************************************
      *
      * Read file for error
      *
     C                   dow       *in90 = *off                                 Main do
     C                   READ      hsp4051                                90
     C                   if        *in90 = *off                                 If not EOF
      *
     C                   if        xxfield1 = mbrlck
     C                   MOVEL     'NOTLCK'      xxmsg
     C                   endif
     C                   endif
     C                   enddo
      *
     C                   SETON                                            LR
      /eject
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
     C     *ENTRY        PLIST
     C                   PARM                    xxmsg
      *
     C                   endsr
