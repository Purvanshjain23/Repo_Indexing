     H/TITLE WW Whs Ord to Ship-EDI DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 06/15/21  Time  : 14:52:38
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUDYDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Whs Ord to Ship-EDI DF Display file
      *
     FOPBFCPLOIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPNG0REL1IF  E           K        DISK
      * RTV : EDI WHS Interchange       Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FECP057L3IF  E           K        DISK
      * RSQ : EDI WHS Shipping Adv HDR  Order Nbr/Sgte#
      *
     FECP050L4IF  E           K        DISK
      * RSQ : EDI WHS Shipping Ord HDR  Order/Surrogate
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FECP057L0UF  E           K        DISK
      * UPD : EDI WHS Shipping Adv HDR  Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FECP050L0UF  E           K        DISK
      * UPD : EDI WHS Shipping Ord HDR  Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  26  6   @CN    25
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@G7REKL
      * EDI WHS Shipping Adv HDR  Update index
      * Renamed input format fields
     I              G7H9NY                          WDH9NY
     I              G7MVST                          WDMVST
     I              G7T7NY                          WDT7NY
     I              G7T8DT                          WDT8DT
     I              G7T8NY                          WDT8NY
     I              G7X3T1                          WDX3T1
     I              G7TUNA                          WDTUNA
     I              G7HKSC                          WDHKSC
     I              G7MXST                          WDMXST
     I              G7X4T1                          WDX4T1
     I              G7T9NY                          WDT9NY
     I              G7MGVL                          WDMGVL
     I              G7N3AA                          WDN3AA
     I              G7JKU1                          WDJKU1
     I              G7JLU1                          WDJLU1
     I              G7XZAA                          WDXZAA
     I              G7JMU1                          WDJMU1
     I              G7DQNZ                          WDDQNZ
     I              G7G8SC                          WDG8SC
     I              G7A0ST                          WDA0ST
     I              G7WHAA                          WDWHAA
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WEAIC3
     I              AMC4NB                          WEC4NB
     I              AMRMNB                          WERMNB
     I              AMRUNB                          WERUNB
     I              AMXACD                          WEXACD
     I              AMOANA                          WEOANA
     I              AMHBAA                          WEHBAA
     I              AMJ0T1                          WEJ0T1
     I              AMGENY                          WEGENY
     I              AMJ1T1                          WEJ1T1
     I              AMHCAA                          WEHCAA
     I              AMQWDT                          WEQWDT
     I              AMQXDT                          WEQXDT
     I              AMQYDT                          WEQYDT
     I              AMHDAA                          WEHDAA
     I              AMCCTX                          WECCTX
     I              AMJ2T1                          WEJ2T1
     I              AMRLNA                          WERLNA
     I              AMRMNA                          WERMNA
     I              AMGINY                          WEGINY
     I              AMGFNY                          WEGFNY
     I              AMGGNY                          WEGGNY
     I              AMGHNY                          WEGHNY
     I              AMHEVL                          WEHEVL
     I              AMHFVL                          WEHFVL
     I              AMHGVL                          WEHGVL
     I              AMQZDT                          WEQZDT
     I              AMQ0DT                          WEQ0DT
     I              AMQ1DT                          WEQ1DT
     I              AMQ2DT                          WEQ2DT
     I              AMC2TX                          WEC2TX
     I              AMC3TX                          WEC3TX
     I              AMC6TX                          WEC6TX
     I              AMCHTX                          WECHTX
     I              AMCITX                          WECITX
     I              AMCLTX                          WECLTX
     I              AMB4TX                          WEB4TX
     I              AMCUTX                          WECUTX
     I              AMCVTX                          WECVTX
     I              AMB9TX                          WEB9TX
     I              AMJWSC                          WEJWSC
     I              AMITNY                          WEITNY
     I              AMLMT1                          WELMT1
     I              AMLWAA                          WELWAA
     I              AMFVST                          WEFVST
     I              AMF0ST                          WEF0ST
     I              AMF2ST                          WEF2ST
     I              AMF3ST                          WEF3ST
     I              AMJUSC                          WEJUSC
     I              AMJVSC                          WEJVSC
     I              AMV3T1                          WEV3T1
     I              AMV4T1                          WEV4T1
     I              AMV5T1                          WEV5T1
     I              AMV6T1                          WEV6T1
     I              AMV7T1                          WEV7T1
     I              AMV8T1                          WEV8T1
     I              AMV9T1                          WEV9T1
     I              AMWAT1                          WEWAT1
     I              AMWBT1                          WEWBT1
     I              AMWCT1                          WEWCT1
     I              AMWDT1                          WEWDT1
     I              AMQJNY                          WEQJNY
     I              AMQKNY                          WEQKNY
     I              AMQLNY                          WEQLNY
     I              AMP8NY                          WEP8NY
     I              AMP9NY                          WEP9NY
     I              AMQANY                          WEQANY
     I              AMQCNY                          WEQCNY
     I              AMQDNY                          WEQDNY
     I              AMQENY                          WEQENY
     I              AMQFNY                          WEQFNY
     I              AMQGNY                          WEQGNY
     I              AMQHNY                          WEQHNY
     I              AMQINY                          WEQINY
     I              AMQMNY                          WEQMNY
     I              AMMYU1                          WEMYU1
     I              AMJXSC                          WEJXSC
     I              AMJYSC                          WEJYSC
     I              AMJZSC                          WEJZSC
     I              AMJ0SC                          WEJ0SC
     I              AMMZU1                          WEMZU1
     I              AMM0U1                          WEM0U1
     I              AMM1U1                          WEM1U1
     I              AMM2U1                          WEM2U1
     I              AMM3U1                          WEM3U1
     I              AMW5DT                          WEW5DT
     I              AMW6DT                          WEW6DT
     I              AMUVST                          WEUVST
     I              AMUWST                          WEUWST
     I              AMUXST                          WEUXST
     I              AMVSST                          WEVSST
     I              AMAATM                          WEAATM
     I              AMAYNA                          WEAYNA
     I              AMA0NA                          WEA0NA
     I              AMAXDT                          WEAXDT
      *
     I@G1CPJ1
      * EDI WHS Shipping Ord HDR  Update index
      * Renamed input format fields
     I              G1H9NY                          WFH9NY
     I              G1HRU1                          WFHRU1
     I              G1HPAA                          WFHPAA
     I              G1A0ST                          WFA0ST
     I              G1MGST                          WFMGST
     I              G1TZNY                          WFTZNY
     I              G1T0NY                          WFT0NY
     I              G1T1NY                          WFT1NY
     I              G1T2NY                          WFT2NY
     I              G1MHST                          WFMHST
     I              G1MIST                          WFMIST
     I              G1MJST                          WFMJST
     I              G1T3NY                          WFT3NY
     I              G1HQU1                          WFHQU1
     I              G1HCSC                          WFHCSC
     I              G1G8SC                          WFG8SC
     I              G1HASC                          WFHASC
     I              G1HBSC                          WFHBSC
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQECP01    E DSECP057L0
      * UPD : EDI WHS Shipping Adv HDR  Update index
      * Renamed input format fields
     I              G7H9NY                          WDH9NY
     I              G7MVST                          WDMVST
     I              G7T7NY                          WDT7NY
     I              G7T8DT                          WDT8DT
     I              G7T8NY                          WDT8NY
     I              G7X3T1                          WDX3T1
     I              G7TUNA                          WDTUNA
     I              G7HKSC                          WDHKSC
     I              G7MXST                          WDMXST
     I              G7X4T1                          WDX4T1
     I              G7T9NY                          WDT9NY
     I              G7MGVL                          WDMGVL
     I              G7N3AA                          WDN3AA
     I              G7JKU1                          WDJKU1
     I              G7JLU1                          WDJLU1
     I              G7XZAA                          WDXZAA
     I              G7JMU1                          WDJMU1
     I              G7DQNZ                          WDDQNZ
     I              G7G8SC                          WDG8SC
     I              G7A0ST                          WDA0ST
     I              G7WHAA                          WDWHAA
      *
     IYBRDCS      DS                            105
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WEAIC3
     I              AMC4NB                          WEC4NB
     I              AMRMNB                          WERMNB
     I              AMRUNB                          WERUNB
     I              AMXACD                          WEXACD
     I              AMOANA                          WEOANA
     I              AMHBAA                          WEHBAA
     I              AMJ0T1                          WEJ0T1
     I              AMGENY                          WEGENY
     I              AMJ1T1                          WEJ1T1
     I              AMHCAA                          WEHCAA
     I              AMQWDT                          WEQWDT
     I              AMQXDT                          WEQXDT
     I              AMQYDT                          WEQYDT
     I              AMHDAA                          WEHDAA
     I              AMCCTX                          WECCTX
     I              AMJ2T1                          WEJ2T1
     I              AMRLNA                          WERLNA
     I              AMRMNA                          WERMNA
     I              AMGINY                          WEGINY
     I              AMGFNY                          WEGFNY
     I              AMGGNY                          WEGGNY
     I              AMGHNY                          WEGHNY
     I              AMHEVL                          WEHEVL
     I              AMHFVL                          WEHFVL
     I              AMHGVL                          WEHGVL
     I              AMQZDT                          WEQZDT
     I              AMQ0DT                          WEQ0DT
     I              AMQ1DT                          WEQ1DT
     I              AMQ2DT                          WEQ2DT
     I              AMC2TX                          WEC2TX
     I              AMC3TX                          WEC3TX
     I              AMC6TX                          WEC6TX
     I              AMCHTX                          WECHTX
     I              AMCITX                          WECITX
     I              AMCLTX                          WECLTX
     I              AMB4TX                          WEB4TX
     I              AMCUTX                          WECUTX
     I              AMCVTX                          WECVTX
     I              AMB9TX                          WEB9TX
     I              AMJWSC                          WEJWSC
     I              AMITNY                          WEITNY
     I              AMLMT1                          WELMT1
     I              AMLWAA                          WELWAA
     I              AMFVST                          WEFVST
     I              AMF0ST                          WEF0ST
     I              AMF2ST                          WEF2ST
     I              AMF3ST                          WEF3ST
     I              AMJUSC                          WEJUSC
     I              AMJVSC                          WEJVSC
     I              AMV3T1                          WEV3T1
     I              AMV4T1                          WEV4T1
     I              AMV5T1                          WEV5T1
     I              AMV6T1                          WEV6T1
     I              AMV7T1                          WEV7T1
     I              AMV8T1                          WEV8T1
     I              AMV9T1                          WEV9T1
     I              AMWAT1                          WEWAT1
     I              AMWBT1                          WEWBT1
     I              AMWCT1                          WEWCT1
     I              AMWDT1                          WEWDT1
     I              AMQJNY                          WEQJNY
     I              AMQKNY                          WEQKNY
     I              AMQLNY                          WEQLNY
     I              AMP8NY                          WEP8NY
     I              AMP9NY                          WEP9NY
     I              AMQANY                          WEQANY
     I              AMQCNY                          WEQCNY
     I              AMQDNY                          WEQDNY
     I              AMQENY                          WEQENY
     I              AMQFNY                          WEQFNY
     I              AMQGNY                          WEQGNY
     I              AMQHNY                          WEQHNY
     I              AMQINY                          WEQINY
     I              AMQMNY                          WEQMNY
     I              AMMYU1                          WEMYU1
     I              AMJXSC                          WEJXSC
     I              AMJYSC                          WEJYSC
     I              AMJZSC                          WEJZSC
     I              AMJ0SC                          WEJ0SC
     I              AMMZU1                          WEMZU1
     I              AMM0U1                          WEM0U1
     I              AMM1U1                          WEM1U1
     I              AMM2U1                          WEM2U1
     I              AMM3U1                          WEM3U1
     I              AMW5DT                          WEW5DT
     I              AMW6DT                          WEW6DT
     I              AMUVST                          WEUVST
     I              AMUWST                          WEUWST
     I              AMUXST                          WEUXST
     I              AMVSST                          WEVSST
     I              AMAATM                          WEAATM
     I              AMAYNA                          WEAYNA
     I              AMA0NA                          WEA0NA
     I              AMAXDT                          WEAXDT
      *
     IYCRDCS      DS                            894
      * Outward parameters
     IPARC        DS                              5
      * KEY : EDI WHS Shipping Adv HDR  Retrieval index
      * I : RST EDI SURROGATE NUMBER
     I                                    P   1   50PAH9NY
      *
     IQECP02    E DSECP050L0
      * UPD : EDI WHS Shipping Ord HDR  Update index
      * Renamed input format fields
     I              G1H9NY                          WFH9NY
     I              G1HRU1                          WFHRU1
     I              G1HPAA                          WFHPAA
     I              G1A0ST                          WFA0ST
     I              G1MGST                          WFMGST
     I              G1TZNY                          WFTZNY
     I              G1T0NY                          WFT0NY
     I              G1T1NY                          WFT1NY
     I              G1T2NY                          WFT2NY
     I              G1MHST                          WFMHST
     I              G1MIST                          WFMIST
     I              G1MJST                          WFMJST
     I              G1T3NY                          WFT3NY
     I              G1HQU1                          WFHQU1
     I              G1HCSC                          WFHCSC
     I              G1G8SC                          WFG8SC
     I              G1HASC                          WFHASC
     I              G1HBSC                          WFHBSC
      *
     IYDRDCS      DS                             70
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P1G3TX
      * N : MAP PRT Printer Device
     I                                       26  35 P1WRST
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P1WSST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P1WTST
      * N : MAP PRT Night Queue Run Sts
     I                                       44  44 P1WUST
      * N : MAP PRT Night Queue
     I                                       45  54 P1BVVN
      * N : MAP System Value Numeric
     I                                    P  55  625P1M8NB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  Allow Multi-Company
     I                                       13  13 P2I6ST
      * N :  Default Printer
     I                                       14  23 P2MPNA
     IP3PARM      DS
      * FLD: Order Header TRG
      * N : MAP Company Number
     I                                    P   1   20P3AIC3
      * N : MAP Order Type - Sales
     I                                        3   4 P3JNCD
      * N : MAP Actual Shipped Date
     I                                    P   5   80P3GNDT
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(PRTED-    1 256 #S0001
     I              'IWOTS) JOBD(*USRPRF)'
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'EDI WHS Interchg NF 4/Whs'
      * Warehouse Code
     I                                        1   3 ZA0002
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0003
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0004
      * USR Status (Y/N)
     I                                       81  81 ZA0005
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0006
      * USR Status (Y/N)
     I                                       81  81 ZA0007
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0008
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0009
      * USR Status (Y/N)
     I                                       81  81 ZA0010
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0011
      * USR Status (Y/N)
     I                                       81  81 ZA0012
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0013
      * USR Status (Y/N)
     I                                       81  81 ZA0014
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0015
      * USR Status (Y/N)
     I                                       81  81 ZA0016
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0017
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0018
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0019
      * USR Status (Y/N)
     I                                       81  81 ZA0020
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0021
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0022
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0023
      * USR Status (Y/N)
     I                                       81  81 ZA0024
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0025
      * Application Code
     I                                       11  16 ZA0026
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0027
      * Application Code
     I                                       11  16 ZA0028
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     MOVEL#CVPCD    YL0002           Ship From Wareh
     C                     MOVEL#2GWST    YL0003           Header Status
     C                     Z-ADD#2RMNB    YL0004           Load ID
     C                     MOVEL#CPKST    YL0005           Load Status
     C                     Z-ADD#2AODT    YL0006           Scheduled Ship
     C                     Z-ADD#2GNDT    YL0007           Actual Shipped
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEC4NB           Order Number
     C                     KFLD           BEAIC3           Company Number
      * Setup key
     C           #2C4NB    IFEQ *ZERO
     C                     MOVEL*HIVAL    BEC4NB           Order Number
     C                     ELSE
     C                     Z-ADD#2C4NB    BEC4NB
     C                     ENDIF
     C                     Z-ADD#2AIC3    BEAIC3
     C           KPOS      SETLL@BFCPY2
     C                     READ @BFCPY2                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type - Sa
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2BRTX    WZBRTX
     C                     MOVEL#2BRTX    WZBRTX           Ship To Name
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPY2                  90*
     C  N82                READ @BFCPY2                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,39
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2JNCD    IFNE *BLANK                     Order Type - Sa
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type - Sa
     C                     END
     C           #2C4NB    IFEQ *ZERO                      Order Number
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           BERMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           BEAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2GNDT    IFNE *ZERO                      Actual Shipped
     C           BEGNDT    CABNE#2GNDT    BB020            Actual Shipped
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Select Only Regular Orders 'OR' "TR"
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Order Type - Sales is Regular Order
      *   |- c2    : DB1.Order Type - Sales is Transfer Order
      *   '-
     C           BEJNCD    IFEQ 'OR'                       *IF
     C           BEJNCD    OREQ 'TR'                       *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Ship From Warehouse that are setup for EDI Transaction.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Whse/Non Cancelled RT - Order Detail  * Get Ship From Whse
     C                     EXSR SARVGN
      * Rtv WHS Interchg All  RT - EDI WHS Interchange  * Fm Whs is Setup
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RVPCD    WL0001    P      Warehouse Code
     C                     MOVEL'WSO'     WL0002    P      Interchange Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0001    P      Class Code
     C                     MOVELWL0004    YN0002    P      EDI Trading Par
     C                     MOVELWL0005    YN0003    P      EDI Whs Duns Nu
     C                     MOVELWL0006    YL0008    P      Record Status
     C                     Z-ADDWL0007    YN0004           Create Date
     C                     Z-ADDWL0008    YN0005           Create Time
     C                     MOVELWL0009    YN0006    P      Create User
     C                     MOVELWL0010    YN0007    P      Create Program
     C                     Z-ADDWL0011    YN0008           Change Date
     C                     Z-ADDWL0012    YN0009           Change Time
     C                     MOVELWL0013    YN0010    P      Change User
     C                     MOVELWL0014    YN0011    P      Change Program
      * CASE: LCL.Record Status is Active
     C           YL0008    IFEQ 'A'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select by User Defined Selectors.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Select By Ship From Warehouse.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Ship From Warehouse is Blanks
      *   |- c2    : CTL.Ship From Warehouse EQ RCD.Ship From Warehouse
      *   '-
     C           #CVPCD    IFEQ *BLANK                     *IF
     C           #CVPCD    OREQ #RVPCD                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Header Status.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Header Status is *None
      *   |- c2    : CTL.Header Status EQ RCD.Header Status
      *   '-
     C           #2GWST    IFEQ *BLANK                     *IF
     C           #2GWST    OREQ #1GWST                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Load ID.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Load ID is Blank
      *   |- c2    : CTL.Load ID EQ RCD.Load ID
      *   '-
     C           #2RMNB    IFEQ *ZERO                      *IF
     C           #2RMNB    OREQ #1RMNB                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Scheduled Ship Date.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Scheduled Ship Date is not entered
      *   |- c2    : CTL.Scheduled Ship Date EQ RCD.Scheduled Ship Date
      *   '-
     C           #2AODT    IFEQ *ZERO                      *IF
     C           #2AODT    OREQ #1AODT                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Actual Shipped Date.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Actual Shipped Date is not entered
      *   |- c2    : CTL.Actual Shipped Date EQ RCD.Actual Shipped Date
      *   '-
     C           #2GNDT    IFEQ *ZERO                      *IF
     C           #2GNDT    OREQ #1GNDT                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Load Status.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Load Status 2      RT - Load Header  * 
     C                     EXSR SCRVGN
      * Select By Load Status.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Load Status is *Blank
      *   |- c2    : CTL.Load Status EQ RCD.Load Status
      *   '-
     C           #CPKST    IFEQ *BLANK                     *IF
     C           #CPKST    OREQ #RPKST                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Sum Quantity & Populate Other Screen Data.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Sum Qty Ord/Ship   RT - Order Detail  * 
     C                     EXSR SDRVGN
      * Get/Set EDI 940/945 Status Info.
      * CASE: *OTHERWISE
      * RTV EDI 940/945 Sts    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0015           Company Number
     C                     Z-ADD#1C4NB    WL0016           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    #RB9TX    P      OHE EDI Error R
     C                     MOVELWL0018    #RF2ST    P      OHE EDI 940 Act
     C                     MOVELWL0019    #RF3ST    P      OHE EDI 945 Act
      * RTV Departure DT/TM   RT - Load Header  * 
     C                     EXSR SFRVGN
      * Set EDI 940 Action Desc.
      * CASE: RCD.OHE EDI 940 Action is Blanks
     C           #RF2ST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #RH0U1           EDI 940 Action
     C                     ELSE
      * CASE: *OTHERWISE
      * RCD.EDI 940 Action Dsc USR = Condition name of RCD.OHE EDI 940 Ac
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1953021   Y2LSNO  70       List number
     C                     PARM #RF2ST    W0INVL 25        OHE EDI 940 Act
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RH0U1    PARM           W0CNNM 25        EDI 940 Action
      *
     C                     END                             *FI
      * Set EDI 945 Action Desc.
      * CASE: RCD.OHE EDI 945 Action is Blanks
     C           #RF3ST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #RH1U1           EDI 945 Action
     C                     ELSE
      * CASE: *OTHERWISE
      * RCD.EDI 945 Action Dsc USR = Condition name of RCD.OHE EDI 945 Ac
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1953021   Y2LSNO  70       List number
     C                     PARM #RF3ST    W0INVL 25        OHE EDI 945 Act
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RH1U1    PARM           W0CNNM 25        EDI 945 Action
      *
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Truck Departure Date is Entered
      *   |- c2    : RCD.Header Status is Complete
      *   '-
     C           YL0009    IFNE *ZERO                      *IF
     C           #1GWST    OREQ 'C'                        *OR
     C                     Z-ADD0         ZQ      50
     C           #RH1U1    CAT  '*':ZQ    #RH1U1    P      EDI 945 Action
     C                     END                             *FI
     C                     END                             *FI
      * Set EDI Error Reason Desc.
      * CASE: RCD.OHE EDI Error Reasons is Blank
     C           #RB9TX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #RHMTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * RCD.Condition Desc. 2  USR = Condition name of RCD.OHE EDI Error
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1916502   Y2LSNO  70       List number
     C                     PARM #RB9TX    W0INVL 25        OHE EDI Error R
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPY2                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Header Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2GWST    W0NSRQ  1        Header Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2GWST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1160607   Y2LSNO  70
     C           #2GWST    PARM #2GWST    W0EXVL 25        Header Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CPKST    W0NSRQ  1        Load Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CPKST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70
     C           #CPKST    PARM #CPKST    W0EXVL 25        Load Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Actual Shipped Date
      * External date
     C                     Z-ADDV2GNDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     Z-ADDXDINDT    #2GNDT
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZGWST    CASNE#2GWST    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZGNDT    CASNE#2GNDT    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : CTL.Ship From Warehouse NE LCL.Ship From Warehouse
      *   |- c2    : CTL.Load ID NE LCL.Load ID
      *   |- c3    : CTL.Scheduled Ship Date NE LCL.Scheduled Ship Date
      *   |- c4    : CTL.Header Status NE LCL.Header Status
      *   |- c5    : CTL.Load Status NE LCL.Load Status
      *   |- c6    : CTL.Actual Shipped Date NE LCL.Actual Shipped Date
      *   '-
     C           #CVPCD    IFNE YL0002                     *IF
     C           #2RMNB    ORNE YL0004                     *OR
     C           #2AODT    ORNE YL0006                     *OR
     C           #2GWST    ORNE YL0003                     *OR
     C           #CPKST    ORNE YL0005                     *OR
     C           #2GNDT    ORNE YL0007                     *OR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F11=dsp edi 945 errors
      * CASE: CTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
      * Dsp EDI 945 Errors    DF - EDI WHS Shipping Adv HDR  * 
     C                     CALL 'PUI8DFR'              90  Dsp EDI 945 Pro
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUI8DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F22=Email Orders not billed
      * CASE: CTL.*CMD key is CF22
     C           *IN22     IFEQ '1'                        *IF
      * Validate Ship From Whs and Email Report via SEQUEL.
      * CASE: CTL.Ship From Warehouse is Blanks
     C           #CVPCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CVPCD    ZA0001           Ship From Wareh
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: CTL.Ship From Warehouse is Not Blanks
     C           #CVPCD    IFNE *BLANK                     *IF
      * Rtv WHS Interchg All  RT - EDI WHS Interchange  * Fr Whs is Setup
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CVPCD    WL0001    P      Warehouse Code
     C                     MOVEL'WSO'     WL0002    P      Interchange Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0001    P      Class Code
     C                     MOVELWL0004    YN0002    P      EDI Trading Par
     C                     MOVELWL0005    YN0003    P      EDI Whs Duns Nu
     C                     MOVELWL0006    YL0008    P      Record Status
     C                     Z-ADDWL0007    YN0004           Create Date
     C                     Z-ADDWL0008    YN0005           Create Time
     C                     MOVELWL0009    YN0006    P      Create User
     C                     MOVELWL0010    YN0007    P      Create Program
     C                     Z-ADDWL0011    YN0008           Change Date
     C                     Z-ADDWL0012    YN0009           Change Time
     C                     MOVELWL0013    YN0010    P      Change User
     C                     MOVELWL0014    YN0011    P      Change Program
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#CVPCD    ZA0002           Ship From Wareh
      * Send message 'EDI WHS Interchg NF 4/Whs'
     C                     MOVEL'USR5013' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0011           Email Address
      * Pmt Enter Email Addr  PV - /UT Report Prompts  * 
     C                     CALL 'POWGPVR'              90  Pmt Enter Email
     C                     PARM *BLANK    W0RTN   7
     C           YL0011    PARM YL0011    WQ0001 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POWGPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Export Data to Excel via SEQUEL.
      * CASE: LCL.Email Address is Entered
     C           YL0011    IFNE *BLANK                     *IF
      * SBMJOB: PRT Whs Orders to Ship CL - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PUD1UPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVEL#CVPCD    #SSTR     P      Ship From Wareh
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0011    #SSTR     P      Email Address
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 50        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PUD1UPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUD1UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * Setup message data for message
     C                     MOVEL@CN,002   ZA0003           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: Process command keys
      * CASE: CTL.*CMD key is *Reload
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CASE: CTL.*CMD key is *Print List
     C           *IN21     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P1WSST           PRT Hold Output
     C                     MOVEL'*NO'     P1WSST           PRT Hold Output
     C                     MOVEL*BLANK    P1WTST           PRT Save Output
     C                     MOVEL'*NO'     P1WTST           PRT Save Output
     C                     MOVEL'N'       P1WUST           PRT Night Queue
     C                     MOVEL*BLANK    P1BVVN           PRT Night Queue
     C                     Z-ADD1         P1M8NB           System Value Nu
     C                     MOVEL@CN,003   P1G3TX           PRT Description
      * !!!We don't need the From / To Date...
      * !!!Resetup Ship From/To Warehouse...
     C                     END                             *FI
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,39
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * Subfile Option Processing.
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * Display Order Inquiry.
      * CASE: RCD.Event Code is Shipped Thru 07 History
     C           #1JPCD    IFGE '04'                       *IF
     C           #1JPCD    ANDLE'07'
      * DSP Ord Inq Ship Dtl   DF - Order Detail  * 
     C                     CALL 'PDP3DFR'              90  DSP Ord Inq Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0002  30       Company Number
     C                     PARM #1C4NB    WQ0003  70       Order Number
     C                     PARM *ZERO     WQ0004  30       Order Sequence
     C           P2DNCD    PARM P2DNCD    WQ0005  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP3DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * DSP Ord Inquiry Detail DF - Order Detail  * 
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0006  30       Company Number
     C                     PARM #1C4NB    WQ0007  70       Order Number
     C                     PARM *ZERO     WQ0008  30       Order Sequence
     C                     PARM *ZERO     WQ0009  30       Order Secondary
     C           P2DNCD    PARM P2DNCD    WQ0010  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * Allow for Opt 7=Upd Depart f/Invoice?
      * CASE: RCD.OHE EDI 945 Action is Received
     C           #RF3ST    IFEQ 'R'                        *IF
      * Rtv for EDI 945 Info  RT - Load Header  * 
     C                     EXSR SGRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Truck Departure Date is not entered
      *   |- c2    : LCL.Truck Departure Time is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFEQ *ZERO                      *IF
     C           YL0010    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Opt7=Mark Rdy 4/InvRT - Load Detail  * 
     C                     EXSR SHRVGN
      * Update Truck Departure Dte/Tme or Throw Error Mesasge.
      * CASE: LCL.Last Stop/Drop is EDI 945 is No
     C           YL0014    IFEQ 'N'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,005:ZQYL0020    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0020    CAT  @CN,006:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0004           Generic Message
     C                     MOVEL#1SEL     ZA0005           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: LCL.All Orders Shipped 2 USR is No
     C           YL0015    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0006           Generic Message
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Update Truck Departure Date/Time with BOL Complete Date/Time.
      * CHG Truck Depart Dt/Tm CH - Load Header  * 
     C                     EXSR SJCHRC
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     Z-ADD1         ZQ      50
     C           @CN,009   CAT  @CN,010:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0008           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,011   CAT  @CN,012:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0009           Generic Message
     C                     MOVEL#1SEL     ZA0010           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,013   CAT  @CN,014:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0011           Generic Message
     C                     MOVEL#1SEL     ZA0012           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * DSP Order vs. Ship Dtl DF - Order Detail  * 
     C                     CALL 'PDP7DFR'              90  DSP Order vs. S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0011  30       Company Number
     C                     PARM #1C4NB    WQ0012  70       Order Number
     C                     PARM #1JNCD    WQ0013  2        Order Type - Sa
     C                     PARM #1BKC7    WQ0014  70       Ship To Custome
     C                     PARM #1BRTX    WQ0015 30        Ship To Name
     C                     PARM #1BCNA    WQ0016 15        Customer Purcha
     C                     PARM #1A0DT    WQ0017  70       Order Date
     C                     PARM #1GNDT    WQ0018  70       Actual Shipped
     C                     PARM #1GWST    WQ0019  1        Header Status
     C           #1XIST    PARM #1XIST    WQ0020  1        Credit Hold
     C           #1XJST    PARM #1XJST    WQ0021  1        Production Hold
     C           #1XKST    PARM #1XKST    WQ0022  1        New Customer Ho
     C                     PARM #1R4CD    WQ0023  3        Sales Route Cod
     C                     PARM P2DNCD    WQ0024  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP7DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * DSP Dispatch/Tracer    DF - Load Detail  * 
     C                     CALL 'PDT3DFR'              90  DSP Dispatch/Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0025  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT3DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 16
     C           #1SEL     IFEQ '16'                       *IF
      * Dsp Order Header       PV - Order Header TRG  * 
     C                     CALL 'OMB5PVR'              90  Dsp Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0026  30       Company Number
     C                     PARM #1C4NB    WQ0027  70       Order Number
     C                     PARM #1BCNA    WQ0028 15        Customer Purcha
     C                     PARM #1CXDT    WQ0029  70       Date of Origina
     C                     PARM #1AFTM    WQ0030  40       Requested Deliv
     C                     PARM P2DNCD    WQ0031  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMB5PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 17
     C           #1SEL     IFEQ '17'                       *IF
      * Update ECP057 to Unprocessed & Blank Out OHE EDI 945 Error Rsn/Ac
      * CASE: RCD.OHE EDI 945 Action is Rcv-Error
     C           #RF3ST    IFEQ 'E'                        *IF
      * RTV Cr/Pr Hold        RT - Order Header TRG  * Get up-to-date CR/
     C                     EXSR SKRVGN
      * Check Order HDR Credit/Production Hold Status.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Credit Hold is Yes
      *   |- c2    : RCD.OHE EDI Error Reasons is Credit Hold
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XIST    IFEQ 'Y'                        *IF
     C           #RB9TX    IFEQ 'CRDHD'                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,015   CAT  @CN,016:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0013           Generic Message
     C                     MOVEL#1SEL     ZA0014           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Production Hold is Yes
      *   |- c2    : RCD.OHE EDI Error Reasons is Product'n Hold
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XJST    IFEQ 'Y'                        *IF
     C           #RB9TX    IFEQ 'PRDHD'                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,015   CAT  @CN,017:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0015           Generic Message
     C                     MOVEL#1SEL     ZA0016           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Credit Hold cleared? Yes, check Prod Hold=Y to reset 945 Error to
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : RCD.Credit Hold is No
      *   |- c2    : RCD.OHE EDI Error Reasons is Credit Hold
      *   |- c3    : RCD.Production Hold is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XIST    IFEQ 'N'                        *IF
     C           #RB9TX    IFEQ 'CRDHD'                    *IF
     C           #1XJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update ECP057 & OHE files to show 'PRDHD' error.
      * Upd EDI Error Reason  RT - EDI WHS Shipping Adv HDR  * 
     C                     EXSR SLRVGN
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,018   CAT  @CN,019:ZQYL0020    P      Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0020    CAT  '.':ZQ    YL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0017           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * No Errors, Continue with Update.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Credit Hold is No
      *   |- c2    : RCD.Production Hold is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XIST    IFEQ 'N'                        *IF
     C           #1XJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update to 'Unprocessed' so next JS 'IB945AS400' run will process
      * Upd Reproces f/Hold RlsRT - EDI WHS Shipping Adv HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1C4NB    WL0029           W0602 Depositor
     C                     Z-ADD#1AIC3    WL0030           Company Number
     C                     MOVEL*BLANK    WL0031           OHE EDI Error R
     C                     Z-ADD#1GNDT    WL0032           Actual Shipped
     C                     Z-ADD#1RMNB    WL0033           Load ID
     C                     EXSR SQRVGN
      * Upd OHE EDI 945 Action RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0023           Company Number
     C                     Z-ADD#1C4NB    WL0024           Order Number
     C                     MOVEL*BLANK    WL0025           OHE EDI Error R
     C                     MOVEL*BLANK    WL0026           OHE EDI 945 Act
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     Z-ADD#1GNDT    WL0028           Actual Shipped
     C                     EXSR SNRVGN
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,020   CAT  @CN,021:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0018           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           @CN,022   CAT  @CN,023:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0019           Generic Message
     C                     MOVEL#1SEL     ZA0020           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 19
     C           #1SEL     IFEQ '19'                       *IF
      * Blank Out OHE EDI 945 Error Rsn/Action.
      * CASE: RCD.OHE EDI 945 Action is Rcv-Error
     C           #RF3ST    IFEQ 'E'                        *IF
      * No Errors, Continue with Update.
      * CASE: RCD.OHE EDI Error Reasons is Order Status
     C           #RB9TX    IFEQ 'ORDST'                    *IF
      * Upd OHE EDI 945 Action RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0023           Company Number
     C                     Z-ADD#1C4NB    WL0024           Order Number
     C                     MOVEL*BLANK    WL0025           OHE EDI Error R
     C                     MOVEL'R'       WL0026    P      OHE EDI 945 Act
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     Z-ADD#1GNDT    WL0028           Actual Shipped
     C                     EXSR SNRVGN
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,024   CAT  @CN,025:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0021           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * No Errors, Continue with Update- clear error, dont reprocess ecp0
      * CASE: RCD.OHE EDI Error Reasons is Order Load
     C           #RB9TX    IFEQ 'ORDLD'                    *IF
      * Upd OHE EDI 945 Action RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0023           Company Number
     C                     Z-ADD#1C4NB    WL0024           Order Number
     C                     MOVEL*BLANK    WL0025           OHE EDI Error R
     C                     MOVEL*BLANK    WL0026           OHE EDI 945 Act
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     Z-ADD#1GNDT    WL0028           Actual Shipped
     C                     EXSR SNRVGN
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,024   CAT  @CN,025:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0022           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           @CN,022   CAT  @CN,023:ZQYL0020    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0020    ZA0023           Generic Message
     C                     MOVEL#1SEL     ZA0024           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.*SFLSEL is Test
     C           #1SEL     IFEQ 'T'                        *IF
      * DISPLAY 945
     C                     Z-ADD#1C4NB    YL0021           W0602 Depositor
      * Rtv Last EDI 945 f/ord RT - EDI WHS Shipping Adv HDR  * 
     C                     EXSR SRRVGN
      * DSP EDI WHS 945 HEADER DR - EDI WHS Shipping Adv HDR  * 
     C                     CLEARPARC
     C                     Z-ADDYL0022    PAH9NY           EDI SURROGATE N
      *
     C                     CALL 'PUI0D1R'              90  DSP EDI WHS 945
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: EDI WHS Sh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUI0D1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: RCD.*SFLSEL is Market Price
     C           #1SEL     IFEQ 'M'                        *IF
      * MAKE EDI 945 AS NEW
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0032  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Rtv Chg STS to NEW    RT - EDI WHS Shipping Ord HDR  * 
     C                     EXSR SSRVGN
     C                     ELSE
      * CASE: RCD.*SFLSEL is Usage
     C           #1SEL     IFEQ 'U'                        *IF
      * DELETE MANIFEST AFTER UNSHIP- SO THEY CAN REBILL IT MANUALLY-RESE
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
     C                     MOVEL*BLANK    YL0023           Order Number Al
     C                     MOVEL#1C4NB    YL0023           Order Number Al
     C                     MOVEL*BLANK    YL0024           Company Number
     C                     MOVEL#1AIC3    YL0024           Company Number
      * Exc Undo EDI 945-unshp UP - EDI WHS Shipping Adv HDR  * 
     C                     CALL 'PUO0UPR'              90  Exc Undo EDI 94
     C                     PARM YL0024    WQ0033  3        Company Number
     C                     PARM YL0023    WQ0034  7        Order Number Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUO0UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPY2 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V1GNDT
     C                     Z-ADD*ZERO     #RAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #RCBQT           Quantity Shippe
     C                     MOVEL*BLANK    #RF2ST           OHE EDI 940 Act
     C                     MOVEL*BLANK    #RF3ST           OHE EDI 945 Act
     C                     MOVEL*BLANK    #RF0ST           OHE EDI 944 Act
     C                     MOVEL*BLANK    #RB9TX           OHE EDI Error R
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RVPCD           Ship From Wareh
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     Z-ADD*ZERO     #RC4QT           Quantity Ordere
     C                     Z-ADD*ZERO     #RSRQT           Quantity Shippe
     C                     MOVEL*BLANK    #RH0U1           EDI 940 Action
     C                     MOVEL*BLANK    #RH1U1           EDI 945 Action
     C                     MOVEL*BLANK    #RHMTX           Condition Desc.
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP1G3TX    #PG3TX           PRT Description
     C                     MOVELP1WRST    #PWRST           PRT Printer Dev
     C                     MOVELP1WSST    #PWSST           PRT Hold Output
     C                     MOVELP1WTST    #PWTST           PRT Save Output
     C                     MOVELP1WUST    #PWUST           PRT Night Queue
     C                     MOVELP1BVVN    #PBVVN           PRT Night Queue
     C                     Z-ADDP1M8NB    #PM8NB           System Value Nu
     C                     MOVEL*BLANK    #CAPTX           Company Name
     C                     Z-ADD*ZERO     #CMADT           To Date
     C                     MOVELP3JNCD    #2JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #CAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #CCBQT           Quantity Shippe
     C                     MOVEL*BLANK    #CF2ST           OHE EDI 940 Act
     C                     MOVEL*BLANK    #CF3ST           OHE EDI 945 Act
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADDP3AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CVPCD           Ship From Wareh
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #2BRTX           Ship To Name
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADDP3GNDT    #2GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V2GNDT
     C                     Z-ADD*ZERO     #CC4QT           Quantity Ordere
     C                     Z-ADD*ZERO     #CSRQT           Quantity Shippe
     C                     MOVEL*BLANK    #CH0U1           EDI 940 Action
     C                     MOVEL*BLANK    #CH1U1           EDI 945 Action
     C                     MOVEL*BLANK    #CHMTX           Condition Desc.
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #1GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1GNDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2GNDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * Get Ship From Whse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSA02           Order Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSA01           Company Number
     C                     Z-ADD#1C4NB    WQSA02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSA     SETLL@BGWKL1                    *
     C           KRSSA     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RVPCD           Warehouse Code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #RVPCD           Warehouse Code
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv WHS Interchg All  RT - EDI WHS Interchange  * Fm Whs is Setu
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Class Code
     C                     MOVEL*BLANK    WL0004           EDI Trading Par
     C                     MOVEL*BLANK    WL0005           EDI Whs Duns Nu
     C                     MOVEL*BLANK    WL0006           Record Status
     C                     Z-ADD*ZERO     WL0007           Create Date
     C                     Z-ADD*ZERO     WL0008           Create Time
     C                     MOVEL*BLANK    WL0009           Create User
     C                     MOVEL*BLANK    WL0010           Create Program
     C                     Z-ADD*ZERO     WL0011           Change Date
     C                     Z-ADD*ZERO     WL0012           Change Time
     C                     MOVEL*BLANK    WL0013           Change User
     C                     MOVEL*BLANK    WL0014           Change Program
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           G0AJCD           Warehouse Code
     C                     KFLD           G0M4AA           Interchange Cod
      * Setup key
     C                     MOVELWL0001    G0AJCD           Warehouse Code
     C                     MOVELWL0002    G0M4AA           Interchange Cod
      * Establish starting position
     C           KRSSB     CHAIN@G0REJZ              90    *
      * Data record not found
     C   90                MOVEL'USR4409' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELG0M7AA    WL0003           Class Code
     C                     MOVELG0J5NX    WL0004           EDI Trading Par
     C                     MOVELG0X2T1    WL0005           EDI Whs Duns Nu
     C                     MOVELG0VSST    WL0006           Record Status
     C                     Z-ADDG0MJDT    WL0007           Create Date
     C                     Z-ADDG0BETM    WL0008           Create Time
     C                     MOVELG0CCVN    WL0009           Create User
     C                     MOVELG0CDVN    WL0010           Create Program
     C                     Z-ADDG0MKDT    WL0011           Change Date
     C                     Z-ADDG0BFTM    WL0012           Change Time
     C                     MOVELG0CEVN    WL0013           Change User
     C                     MOVELG0CFVN    WL0014           Change Program
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Load Status 2      RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #RPKST           Load Status
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    #RPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Sum Qty Ord/Ship   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RC4QT           Total Quantity
     C                     Z-ADD*ZERO     #RSRQT           Total Quantity
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSD01           Company Number
     C                     Z-ADD#1C4NB    WQSD02           Order Number
      * Establish starting position
     C           KRSSD     SETLL@BGWKL1                    *
     C           KRSSD     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
     C                     ADD  OMAVQT    #RC4QT           Total Quantity
     C                     ADD  OMCBQT    #RSRQT           Total Quantity
     C                     END                             *FI
     C           KRSSD     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV EDI 940/945 Sts    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0017           OHE EDI Error R
     C                     MOVEL*BLANK    WL0018           OHE EDI 940 Act
     C                     MOVEL*BLANK    WL0019           OHE EDI 945 Act
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0015    AMAIC3           Company Number
     C                     Z-ADDWL0016    AMC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMB9TX    WL0017           OHE EDI Error R
     C                     MOVELAMF2ST    WL0018           OHE EDI 940 Act
     C                     MOVELAMF3ST    WL0019           OHE EDI 945 Act
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Departure DT/TM   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSF02           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSF02           Load ID
      * Establish starting position
     C           KRSSF     SETLL@FJCPSB                    *
     C           KRSSF     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0009           Truck Departure
     C                     Z-ADD*ZERO     YL0010           Truck Departure
     C                     GOTO SFEXIT                     *QUIT
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAKIDT    YL0009           Truck Departure
     C                     Z-ADDWAASTM    YL0010           Truck Departure
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv for EDI 945 Info  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0012           BOL Complete Da
     C                     Z-ADD*ZERO     YL0013           BOL Complete Ti
     C                     Z-ADD*ZERO     YL0009           Truck Departure
     C                     Z-ADD*ZERO     YL0010           Truck Departure
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSG     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJJ7DT    YL0012           BOL Complete Da
     C                     Z-ADDFJBOTM    YL0013           BOL Complete Ti
     C                     Z-ADDFJKIDT    YL0009           Truck Departure
     C                     Z-ADDFJASTM    YL0010           Truck Departure
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Opt7=Mark Rdy 4/InvRT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0014           Last Stop/Drop
     C                     MOVEL'Y'       YL0015           All Orders Ship
     C                     MOVEL'Y'       YL0016           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSH02           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSH02           Load ID
      * Establish starting position
     C           KRSSH     SETLL@FLCPE8                    *
     C           KRSSH     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Thru, Chk If Order from Last Stop/Drop has EDI945 Sts=
      * CASE: LCL.First Time Flag is Yes
     C           YL0016    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0016           First Time Flag
      * If Order # matches then we know it has an EDI 945 Status of R.
      * CASE: DB1.Order Number EQ PAR.Order Number
     C           FLC4NB    IFEQ #1C4NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV EDI 940/945 Sts    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0015           Company Number
     C                     Z-ADDFLC4NB    WL0016           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YN0014    P      OHE EDI Error R
     C                     MOVELWL0018    YL0017    P      OHE EDI 940 Act
     C                     MOVELWL0019    YL0018    P      OHE EDI 945 Act
      * CASE: LCL.OHE EDI 940 Action is Sent
     C           YL0017    IFEQ 'S'                        *IF
      * RMC only if 940 was sent - dont chk this for not EDI orders
      * Do NOT allow Opt 7 if NOT in 'R' (Received) status.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.OHE EDI 945 Action is Received
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0018    IFEQ 'R'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0014           Last Stop/Drop
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Check if All Orders for Load has been shipped.
      * CASE: *OTHERWISE
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * Do NOT allow Opt 7 if NOT in '5' (Shipped) Status.
      * CASE: LCL.Header Status is Not confirmed
     C           YL0019    IFEQ 'L'                        *IF
     C           YL0019    OREQ 'A'
     C           YL0019    OREQ 'X'
     C           YL0019    OREQ 'C'
     C           YL0019    OREQ 'E'
     C           YL0019    OREQ 'H'
     C                     MOVEL'N'       YL0015           All Orders Ship
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WBAIC3           Company Number
     C                     Z-ADDFLC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBGWST    YL0019           Header Status
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Truck Depart Dt/Tm CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Company Number
     C                     Z-ADD*ZERO     WN0002  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0003  1        LTL Flag
     C                     MOVEL*BLANK    WN0004  1        Load Status
     C                     Z-ADD*ZERO     WN0005  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0006 15        Seal 1
     C                     MOVEL*BLANK    WN0007 15        Seal 2
     C                     MOVEL*BLANK    WN0008 15        Seal 3
     C                     MOVEL*BLANK    WN0009 15        Seal 4
     C                     MOVEL*BLANK    WN0010 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0011  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0012 112       Flat Amount
     C                     MOVEL*BLANK    WN0013  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0014  50       Total Stops
     C                     MOVEL*BLANK    WN0015 20        Trailer Id
     C                     MOVEL*BLANK    WN0016  3        Transloader Car
     C                     Z-ADD*ZERO     WN0017  40       BOL Time
     C                     MOVEL*BLANK    WN0018  3        Carrier Code
     C                     MOVEL*BLANK    WN0019  7        Truck Size
     C                     Z-ADD*ZERO     WN0020  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0021 112       Rated Freight
     C                     MOVEL*BLANK    WN0022  1        Ship Status
     C                     MOVEL*BLANK    WN0023  1        Load Type
     C                     Z-ADD*ZERO     WN0024  50       Number Pallets
     C                     Z-ADD*ZERO     WN0025  50       Number Pallets
     C                     Z-ADD*ZERO     WN0026 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0027  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0028  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0029  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0030 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0031 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0032  70       Actual Departur
     C                     Z-ADD*ZERO     WN0033  40       Departure Time
     C                     Z-ADD*ZERO     WN0034  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0035  52       Product Tempera
     C                     Z-ADD*ZERO     WN0036  50       Number Spacers
     C                     MOVEL*BLANK    WN0037 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0038  70       Total Load Mile
     C                     MOVEL*BLANK    WN0039 12        Recorder ID
     C                     MOVEL*BLANK    WN0040  2        Shipping Method
     C                     MOVEL*BLANK    WN0041  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0042  2        Ship To State C
     C                     Z-ADD*ZERO     WN0043  70       Gross Weight
     C                     MOVEL*BLANK    WN0044  3        Carrier Broker
     C                     MOVEL*BLANK    WN0045  1        Export Status
     C                     Z-ADD*ZERO     WN0046  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0047  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0048  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0049  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0050  70       Spotted Date
     C                     Z-ADD*ZERO     WN0051  60       Spotted Time
     C                     Z-ADD*ZERO     WN0052  70       Load Finished D
     C                     Z-ADD*ZERO     WN0053  60       Load Finished T
     C                     Z-ADD*ZERO     WN0054  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0055  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0056  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0057  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0058  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0059  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0060  3        Shipping Line
     C                     MOVEL*BLANK    WN0061 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0062 30        Vessel Name
     C                     Z-ADD*ZERO     WN0063  50       Voyage
     C                     Z-ADD*ZERO     WN0064  70       Sail Date
     C                     MOVEL*BLANK    WN0065 12        Booking Number
     C                     MOVEL*BLANK    WN0066 20        Discharge Port
     C                     Z-ADD*ZERO     WN0067  70       Arrival Date
     C                     MOVEL*BLANK    WN0068 12        Container Numbe
     C                     Z-ADD*ZERO     WN0069  70       Date In
     C                     Z-ADD*ZERO     WN0070  60       Time In
     C                     Z-ADD*ZERO     WN0071  70       Date Out
     C                     Z-ADD*ZERO     WN0072  60       Time Out
     C                     Z-ADD*ZERO     WN0073 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0074  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0075  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0076  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0077  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0078  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0079  70       Requested Deliv
     C                     MOVEL*BLANK    WN0080  1        Load Acceptance
     C                     MOVEL*BLANK    WN0081  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0082  70       On Yard Date
     C                     Z-ADD*ZERO     WN0083  60       On Yard Time
     C                     Z-ADD*ZERO     WN0084  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0085  60       Deadline Depart
     C                     MOVEL*BLANK    WN0086  1        Load Held Over
     C                     MOVEL*BLANK    WN0087  1        Load Held Over
     C                     MOVEL*BLANK    WN0088 15        Load Held Over
     C                     MOVEL*BLANK    WN0089 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0090 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0091  70       Express Mail Da
     C                     MOVEL*BLANK    WN0092  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0093  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0094  70       Product Complet
     C                     Z-ADD*ZERO     WN0095  60       Product Complet
     C                     Z-ADD*ZERO     WN0096  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0097  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0098  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0099  1        Load Confirmed
     C                     MOVEL*BLANK    WN0100 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0101  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0102  60       Load Door 1
     C                     Z-ADD*ZERO     WN0103  70       Override Total
     C                     Z-ADD*ZERO     WN0104  60       Load Door 2
     C                     MOVEL*BLANK    WN0105  1        Partial Load
     C                     MOVEL*BLANK    WN0106  1        Load Confirmati
     C                     MOVEL*BLANK    WN0107  1        Export Load USD
     C                     MOVEL*BLANK    WN0108  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0109 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0110 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0111 15        Late Billing Em
     C                     MOVEL*BLANK    WN0112 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0113 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0114  1        Multi Company L
     C                     MOVEL*BLANK    WN0115  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0116  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0117  1        LH Power Only L
     C                     MOVEL*BLANK    WN0118  1        MG Created Load
     C                     MOVEL*BLANK    WN0119  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0120  2        Load U/M
     C                     MOVEL*BLANK    WN0121  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0122  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0123  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0124  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0125  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0126  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0127  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0128  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0129  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0130  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0131  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0132  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0133  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0134  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0135  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0136  60       LH Unused Time
     C                     MOVEL*BLANK    WN0137  1        EDI Status 1
     C                     MOVEL*BLANK    WN0138  1        EDI Status 2
     C                     MOVEL*BLANK    WN0139  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0140  60       Job Time
     C                     MOVEL*BLANK    WN0141 10        User Id
     C                     MOVEL*BLANK    WN0142 10        Job Name
     C                     Z-ADD*ZERO     WN0143  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WCRMNB           Load ID
     C           KLCHSJ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDYL0012    WCKIDT           Truck Departure
     C                     Z-ADDYL0013    WCASTM           Truck Departure
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Cr/Pr Hold        RT - Order Header TRG  * Get up-to-date CR
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBXIST    #1XIST           Credit Hold
     C                     MOVELWBXJST    #1XJST           Production Hold
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd EDI Error Reason  RT - EDI WHS Shipping Adv HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN G7T7NY    WQSL01           W0602 Depositor
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           W0602 Depositor
      * Setup key
     C                     Z-ADD#1C4NB    WQSL01           W0602 Depositor
      * Establish starting position
     C           KRSSL     SETLL@P057DR                    *
     C           KRSSL     READE@P057DR                  90*
      * Data record not found
     C   90                MOVEL'USR4424' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rcd Procd/Err Rsn CH - EDI WHS Shipping Adv HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDG7H9NY    WL0020           EDI SURROGATE N
     C                     MOVELG7A0ST    WL0021    P      EDI-Record Proc
     C                     MOVEL'PRDHD'   WL0022    P      EDI-Error Reaso
     C                     EXSR SMCHRC
      * Upd OHE EDI 945 Action RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0023           Company Number
     C                     Z-ADD#1C4NB    WL0024           Order Number
     C                     MOVEL'PRDHD'   WL0025    P      OHE EDI Error R
     C                     MOVEL'E'       WL0026    P      OHE EDI 945 Act
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     Z-ADD#1GNDT    WL0028           Actual Shipped
     C                     EXSR SNRVGN
     C           KRSSL     READE@P057DR                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Rcd Procd/Err Rsn CH - EDI WHS Shipping Adv HDR  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0144  1        W0601 Reporting
     C                     Z-ADD*ZERO     WN0145  70       W0602 Depositor
     C                     MOVEL*BLANK    WN0146  8        W0603 Date - ac
     C                     Z-ADD*ZERO     WN0147  70       W0604 Shipment
     C                     MOVEL*BLANK    WN0148 12        W0605 Agent Shi
     C                     MOVEL*BLANK    WN0149 15        W0606 Customer
     C                     MOVEL*BLANK    WN0150  2        N902 Order Stat
     C                     MOVEL*BLANK    WN0151  2        W2701 Transport
     C                     MOVEL*BLANK    WN0152  4        W2702 SCAC Carr
     C                     Z-ADD*ZERO     WN0153  50       W0301 Quantity
     C                     Z-ADD*ZERO     WN0154 112       W0302 Weight Sh
     C                     MOVEL*BLANK    WN0155  2        W0303 Unit of M
     C                     MOVEL*BLANK    WN0156  8        W6201 Actual De
     C                     MOVEL*BLANK    WN0157  8        W6204 Actual De
     C                     MOVEL*BLANK    WN0158  2        W6205 Actual De
     C                     MOVEL*BLANK    WN0159  8        W6201 Request S
     C                     Z-ADD*ZERO     WN0160  30       W1002 Nbr Palle
     C                     MOVEL*BLANK    WN0161  2        N0902 Pallet Ty
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @G7REKL
     C                     Z-ADDWL0020    WDH9NY           EDI SURROGATE N
      *
     C           KLCHSM    KLIST
     C                     KFLD           WDH9NY           EDI SURROGATE N
     C           KLCHSM    CHAIN@G7REKL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP057L0'MDACP
     C                     MOVEL'@G7REKL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QECP01    YBRDCS
      * Move non-key fields to @G7REKL
     C                     MOVELWL0021    WDA0ST    P      EDI-Record Proc
     C                     MOVELWL0022    WDWHAA    P      EDI-Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QECP01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@G7REKL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKECP057L0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Upd OHE EDI 945 Action RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0023    AMAIC3           Company Number
     C                     Z-ADDWL0024    AMC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * CRT OHE EDI 945 Action CR - Order Header Extension  * 
     C                     EXSR SOCRRC
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG OHE EDI 945 Action CH - Order Header Extension  * 
     C                     EXSR SPCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * CRT OHE EDI 945 Action CR - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0162  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0163  3        Shipping Line
     C                     MOVEL*BLANK    WN0164 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0165 25        OHE City
     C                     MOVEL*BLANK    WN0166 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0167 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0168 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0169 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0170  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0171  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0172  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0173  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0174  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0175 12        OHE Container N
     C                     MOVEL*BLANK    WN0176 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0177 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0178 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0179 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0180 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0181 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0182 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0183 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0184 112       Transload Termi
     C                     Z-ADD*ZERO     WN0185  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0186  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0187  70       OHE Port/Pier P
     C                     MOVEL*BLANK    WN0188  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0189  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0190  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0191  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0192  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0193  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0194  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0195  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0196  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0197  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0198  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0199 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0200  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0201  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0202  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0203  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0204  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0205  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0206 10        OHE Transload S
     C                     MOVEL*BLANK    WN0207 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0208 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0209 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0210 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0211 15        OHE Transload C
     C                     MOVEL*BLANK    WN0212 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0213 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0214 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0215 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0216 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0217  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0218  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0219  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0220  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0221  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0222  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0223  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0224  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0225  60       Original Appoin
     C                     Z-ADD*ZERO     WN0226  60       Original Appoin
     C                     Z-ADD*ZERO     WN0227  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0228  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0229  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0230  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0231 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0232  1        OHE Email BOL/S
     C                     MOVEL*BLANK    WN0233  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0234  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0235  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0236  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0237  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0238 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0239 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0240 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0241  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0242  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0243  1        EDI Status 1
     C                     MOVEL*BLANK    WN0244  1        EDI Status 2
     C                     MOVEL*BLANK    WN0245  1        EDI Status 3
     C                     MOVEL*BLANK    WN0246  1        Record Status
     C                     Z-ADD*ZERO     WN0247  60       Job Time
     C                     MOVEL*BLANK    WN0248 10        User Id
     C                     MOVEL*BLANK    WN0249 10        Job Name
     C                     Z-ADD*ZERO     WN0250  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDWL0023    WEAIC3           Company Number
     C                     Z-ADDWL0024    WEC4NB           Order Number
     C                     Z-ADDWL0027    WERMNB           Load ID
     C                     Z-ADDWL0028    WEQ2DT           OHE Actual Ship
     C                     MOVELWL0025    WEB9TX           OHE EDI Error R
     C                     MOVELWL0026    WEF3ST           OHE EDI 945 Act
      *
      * USER: Processing before Data update
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     MOVEL##USR     WEAYNA           User Id
     C           KLCRSO    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSO    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG OHE EDI 945 Action CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0251  70       Load ID
     C                     Z-ADD*ZERO     WN0252  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0253  3        Shipping Line
     C                     MOVEL*BLANK    WN0254 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0255 25        OHE City
     C                     MOVEL*BLANK    WN0256 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0257 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0258 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0259 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0260  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0261  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0262  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0263  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0264  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0265 12        OHE Container N
     C                     MOVEL*BLANK    WN0266 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0267 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0268 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0269 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0270 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0271 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0272 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0273 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0274 112       Transload Termi
     C                     Z-ADD*ZERO     WN0275  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0276  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0277  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0278  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0279  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0280  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0281  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0282  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0283  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0284  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0285  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0286  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0287  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0288  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0289  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0290 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0291  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0292  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0293  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0294  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0295  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0296  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0297 10        OHE Transload S
     C                     MOVEL*BLANK    WN0298 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0299 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0300 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0301 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0302 15        OHE Transload C
     C                     MOVEL*BLANK    WN0303 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0304 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0305 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0306 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0307 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0308  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0309  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0310  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0311  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0312  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0313  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0314  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0315  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0316  60       Original Appoin
     C                     Z-ADD*ZERO     WN0317  60       Original Appoin
     C                     Z-ADD*ZERO     WN0318  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0319  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0320  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0321  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0322 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0323  1        OHE Email BOL/S
     C                     MOVEL*BLANK    WN0324  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0325  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0326  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0327  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0328  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0329 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0330 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0331 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0332  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0333  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0334  1        EDI Status 1
     C                     MOVEL*BLANK    WN0335  1        EDI Status 2
     C                     MOVEL*BLANK    WN0336  1        EDI Status 3
     C                     MOVEL*BLANK    WN0337  1        Record Status
     C                     Z-ADD*ZERO     WN0338  60       Job Time
     C                     MOVEL*BLANK    WN0339 10        User Id
     C                     MOVEL*BLANK    WN0340 10        Job Name
     C                     Z-ADD*ZERO     WN0341  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDAMAIC3    WEAIC3           Company Number
     C                     Z-ADDAMC4NB    WEC4NB           Order Number
      *
     C           KLCHSP    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSP    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YCRDCS
      * Move non-key fields to @AMREJE
     C                     MOVELWL0025    WEB9TX    P      OHE EDI Error R
     C                     MOVELWL0026    WEF3ST    P      OHE EDI 945 Act
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     MOVEL##USR     WEAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Upd Reproces f/Hold RlsRT - EDI WHS Shipping Adv HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN G7T7NY    WQSQ01           W0602 Depositor
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           W0602 Depositor
      * Setup key
     C                     Z-ADDWL0029    WQSQ01           W0602 Depositor
      * Establish starting position
     C           KRSSQ     SETLL@P057DR                    *
     C           KRSSQ     READE@P057DR                  90*
      * Data record not found
     C   90                MOVEL'USR4424' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rcd Procd/Err Rsn CH - EDI WHS Shipping Adv HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDG7H9NY    WL0020           EDI SURROGATE N
     C                     MOVEL'N'       WL0021    P      EDI-Record Proc
     C                     MOVELWL0031    WL0022    P      EDI-Error Reaso
     C                     EXSR SMCHRC
     C           KRSSQ     READE@P057DR                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Last EDI 945 f/ord RT - EDI WHS Shipping Adv HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN G7T7NY    WQSR01           W0602 Depositor
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           W0602 Depositor
      * Setup key
     C                     Z-ADDYL0021    WQSR01           W0602 Depositor
      * Establish starting position
     C           KRSSR     SETLL@P057DR                    *
     C           KRSSR     READE@P057DR                  90*
      * Data record not found
     C   90                MOVEL'USR4424' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDG7H9NY    YL0022           EDI SURROGATE N
     C           KRSSR     READE@P057DR                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Chg STS to NEW    RT - EDI WHS Shipping Ord HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN G1TZNY    WQSS01           W0502 Order Num
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           W0502 Order Num
      * Setup key
     C                     Z-ADD#1C4NB    WQSS01           W0502 Order Num
      * Establish starting position
     C           KRSSS     SETLL@P050DU                    *
     C           KRSSS     READE@P050DU                  90*
      * Data record not found
     C   90                MOVEL'USR4411' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EDI-Record Processed is Not Processed
     C           G1A0ST    IFEQ 'N'                        *IF
      * CASE: DB1.W0501 Order Status Code is R-Change
     C           G1MGST    IFEQ 'R'                        *IF
      * Chg EDI WHS Ship Ord  CH - EDI WHS Shipping Ord HDR  * 
     C                     EXSR STCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSS     READE@P050DU                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg EDI WHS Ship Ord  CH - EDI WHS Shipping Ord HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @G1CPJ1
     C                     Z-ADDG1H9NY    WFH9NY           EDI SURROGATE N
      *
     C           KLCHST    KLIST
     C                     KFLD           WFH9NY           EDI SURROGATE N
     C           KLCHST    CHAIN@G1CPJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP050L0'MDACP
     C                     MOVEL'@G1CPJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QECP02    YDRDCS
      * Move non-key fields to @G1CPJ1
     C                     MOVELG1HRU1    WFHRU1    P      G6202-DELIVERY
     C                     MOVELG1HPAA    WFHPAA    P      TRADE PARTNER C
     C                     MOVELG1A0ST    WFA0ST    P      EDI-Record Proc
     C                     MOVEL'N'       WFMGST    P      W0501 Order Sta
     C                     Z-ADDG1TZNY    WFTZNY           W0502 Order Num
     C                     MOVELG1T0NY    WFT0NY    P      W0503 Customer
     C                     Z-ADDG1T1NY    WFT1NY           W0504 Load Posi
     C                     Z-ADDG1T2NY    WFT2NY           W0505 Shipment
     C                     MOVELG1MHST    WFMHST    P      W6601 Shipment
     C                     MOVELG1MIST    WFMIST    P      W6602 Transport
     C                     MOVELG1MJST    WFMJST    P      W6604 Unit Load
     C                     Z-ADDG1T3NY    WFT3NY           W7601 Tot Cases
     C                     MOVELG1HQU1    WFHQU1    P      G6202 Ship Date
     C                     MOVELG1HCSC    WFHCSC    P      N0902 Palletize
     C                     MOVELG1G8SC    WFG8SC    P      N0902 Pallet Ty
     C                     MOVELG1HASC    WFHASC    P      N0902 Shrink Wr
     C                     MOVELG1HBSC    WFHBSC    P      N0902 Slip Shee
      *
      * Set PGM.*Record Data Changed flag
     C           QECP02    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@G1CPJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKECP050L0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0342    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSU     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0025           Company Number
     C                     MOVELDRBUVN    WN0343           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0034    DTAJVN           User Profile Na
     C                     MOVELWL0035    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSV     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0036           Company Number
     C                     MOVELDTAJCD    WL0037           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSW01           Application Cod
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Application Cod
      * Setup key
     C                     MOVELP2DNCD    WQSW01           Application Cod
      * Establish starting position
     C           KRSSW     SETLL@DNRESF                    *
     C           KRSSW     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C           KRSSW     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSX01           Application Cod
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSX01           Application Cod
      * Establish starting position
     C           KRSSX     SETLL@DNRESF                    *
     C           KRSSX     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSX     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ021
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2GWST'  YPMTFD           Header Status
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ031
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CPKST'  YPMTFD           Load Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1G3TX           PRT Description
     C                     MOVEL*BLANK    P1WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P1WSST           PRT Hold Output
     C                     MOVEL*BLANK    P1WTST           PRT Save Output
     C                     MOVEL*BLANK    P1WUST           PRT Night Queue
     C                     MOVEL*BLANK    P1BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P1M8NB           System Value Nu
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     MOVEL*BLANK    P3JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     P3GNDT           Actual Shipped
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WDT7NY           W0602 Depositor
     C                     Z-ADD*ZERO     WDT8NY           W0604 Shipment
     C                     Z-ADD*ZERO     WDT9NY           W0301 Quantity
     C                     Z-ADD*ZERO     WDMGVL           W0302 Weight Sh
     C                     Z-ADD*ZERO     WDDQNZ           W1002 Nbr Palle
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WERUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WEQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WEQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WEQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WEGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WEHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WEHGVL           Transload Termi
     C                     Z-ADD*ZERO     WEQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WEQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WEQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WEQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WEITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WEQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WEQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WEQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WEP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WEQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WEQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WEQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WEQENY           Original Appoin
     C                     Z-ADD*ZERO     WEQFNY           Original Appoin
     C                     Z-ADD*ZERO     WEQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WEQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WEQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WEQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WEW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WEW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WFTZNY           W0502 Order Num
     C                     Z-ADD*ZERO     WFT1NY           W0504 Load Posi
     C                     Z-ADD*ZERO     WFT2NY           W0505 Shipment
     C                     Z-ADD*ZERO     WFT3NY           W7601 Tot Cases
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  6
     C                     MOVEL*BLANK    WL0005 20
     C                     MOVEL*BLANK    WL0006  1
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  60
     C                     MOVEL*BLANK    WL0009 10
     C                     MOVEL*BLANK    WL0010 10
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  60
     C                     MOVEL*BLANK    WL0013 10
     C                     MOVEL*BLANK    WL0014 10
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  5
     C                     MOVEL*BLANK    WL0018  6
     C                     MOVEL*BLANK    WL0019  6
      * Define local variables for subroutine SMCHRC.
     C                     Z-ADD*ZERO     WL0020  90
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  6
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025  5
     C                     MOVEL*BLANK    WL0026  6
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  70
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  30
     C                     MOVEL*BLANK    WL0031  5
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  70
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0034 10
     C                     MOVEL*BLANK    WL0035  6
     C                     Z-ADD*ZERO     WL0036  30
     C                     MOVEL*BLANK    WL0037  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Ship From Warehouse
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define null work field Class Code
     C                     MOVEL*BLANK    YN0001  3
      * Define null work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YN0002  6
      * Define null work field EDI Whs Duns Number
     C                     MOVEL*BLANK    YN0003 20
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field Create Date
     C                     Z-ADD*ZERO     YN0004  70
      * Define null work field Create Time
     C                     Z-ADD*ZERO     YN0005  60
      * Define null work field Create User
     C                     MOVEL*BLANK    YN0006 10
      * Define null work field Create Program
     C                     MOVEL*BLANK    YN0007 10
      * Define null work field Change Date
     C                     Z-ADD*ZERO     YN0008  70
      * Define null work field Change Time
     C                     Z-ADD*ZERO     YN0009  60
      * Define null work field Change User
     C                     MOVEL*BLANK    YN0010 10
      * Define null work field Change Program
     C                     MOVEL*BLANK    YN0011 10
      * Define local work field Truck Departure Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Truck Departure Time
     C                     Z-ADD*ZERO     YL0010  60
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0011 50
      * Define null work field Order Sequence Number
     C                     Z-ADD*ZERO     YN0012  30
      * Define null work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YN0013  30
      * Define local work field BOL Complete Date
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field BOL Complete Time
     C                     Z-ADD*ZERO     YL0013  60
      * Define local work field Last Stop/Drop is EDI 945
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field All Orders Shipped 2 USR
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0016  1
      * Define null work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YN0014  5
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0017  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0018  6
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0020 80
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0015  70
      * Define local work field W0602 Depositor Order Nbr
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field EDI SURROGATE NUMBER
     C                     Z-ADD*ZERO     YL0022  90
      * Define local work field Order Number Alpha
     C                     MOVEL*BLANK    YL0023  7
      * Define local work field Company Number Alpha
     C                     MOVEL*BLANK    YL0024  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0025  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0026  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD14        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL'OMS'     P2DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0342 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0342           User Profile Na
      *
     C                     MOVEL*BLANK    WN0343 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SURVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,026                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0342    ZA0025           User Profile Na
     C                     MOVELP2DNCD    ZA0026           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0343    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0342    WL0034    P      User Profile Na
     C                     MOVELP2DNCD    WL0035    P      Application Cod
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    P3AIC3           Company Number
     C                     MOVELWL0037    YL0026    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0343    WL0034    P      User Profile Na
     C                     MOVELP2DNCD    WL0035    P      Application Cod
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    P3AIC3           Company Number
     C                     MOVELWL0037    YL0026    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0026    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0342    ZA0027           User Profile Na
     C                     MOVELP2DNCD    ZA0028           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0025    IFNE 0                          *IF
     C                     Z-ADDYL0025    P3AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0026    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0035  3        Warehouse Code
     C                     PARM YL0025    WQ0036  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SWRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       YL0001           First Time Flag
     C                     Z-ADD50000     W0SLM            *Scan limit
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 USR0752
00002 Job submitted.
00003 Shipped Whs Transfer Rpt
00004 Order from last Stop/Drop
00005 for EDI 945 is not in
00006 'Received' status.
00007 Option not allowed. Multi
00008 -Warehouse Load.
00009 Truck Departure Date/Time
00010 was updated.
00011 BOL already completed. Op
00012 tion invalid.
00013 EDI 945 is not in 'Receiv
00014 ed' status.
00015 Cannot ship Order due to
00016 Credit Hold.
00017 Production Hold.
00018 Order cannot be reprocess
00019 ed due to Production Hold
00020 Order for EDI 945 has bee
00021 n updated to reprocess.
00022 EDI 945 status is not in
00023 error. Option invalid.
00024 Error for EDI 945 has bee
00025 n cleared.
00026 Y2U0005
