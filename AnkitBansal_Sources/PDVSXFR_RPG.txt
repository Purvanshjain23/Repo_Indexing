     H/TITLE CRT Crd-A/R G/L acct   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 03/02/10  Time  : 11:33:04
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJ5CPL4IF  E           K        DISK
      * RSQ : A/R Posting and Reporting Bank/DepDt/comp/Cust
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDJ3CPL2IF  E           K        DISK
      * RSQ : A/R Adjustment Type       Co/Type Active Records
      *
     FPDJ5CPL0IF  E           K        DISK                      A
      * UPD : A/R Posting and Reporting Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@J5CPYM
      * A/R Posting and Reporting Bank/DepDt/comp/Cust
      * Renamed input format fields
     I              J5AIC3                          WAAIC3
     I              J5G4CD                          WAG4CD
     I              J5HXDT                          WAHXDT
     I              J5ANC7                          WAANC7
     I              J5CONB                          WACONB
     I              J5CEST                          WACEST
     I              J5DXNB                          WADXNB
     I              J5UHCD                          WAUHCD
     I              J5BSVA                          WABSVA
     I              J5CPTX                          WACPTX
     I              J5C1NY                          WAC1NY
     I              J5IZTX                          WAIZTX
     I              J5H0DT                          WAH0DT
     I              J5ATDT                          WAATDT
     I              J5C4NB                          WAC4NB
     I              J5ABST                          WAABST
     I              J5NGNA                          WANGNA
     I              J5UJCD                          WAUJCD
     I              J5AJST                          WAAJST
     I              J5ADST                          WAADST
     I              J5CKNB                          WACKNB
     I              J5BCDT                          WABCDT
     I              J5BGLC                          WABGLC
     I              J5GLVL                          WAGLVL
     I              J5UVST                          WAUVST
     I              J5UWST                          WAUWST
     I              J5UXST                          WAUXST
     I              J5VSST                          WAVSST
     I              J5AATM                          WAAATM
     I              J5AYNA                          WAAYNA
     I              J5A0NA                          WAA0NA
     I              J5AXDT                          WAAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@J3CPCZ
      * A/R Adjustment Type       Co/Type Active Records
      * Renamed input format fields
     I              J3AIC3                          WCAIC3
     I              J3UHCD                          WCUHCD
     I              J3NFNA                          WCNFNA
     I              J3EAZT                          WCEAZT
     I              J3IZTX                          WCIZTX
     I              J3UKVA                          WCUKVA
     I              J3A5ST                          WCA5ST
     I              J3GLTS                          WCGLTS
     I              J3SYSC                          WCSYSC
     I              J3UVST                          WCUVST
     I              J3UWST                          WCUWST
     I              J3UXST                          WCUXST
     I              J3VSST                          WCVSST
     I              J3AATM                          WCAATM
     I              J3AYNA                          WCAYNA
     I              J3A0NA                          WCA0NA
     I              J3AXDT                          WCAXDT
      *
     I@J5CPDL
      * A/R Posting and Reporting Update index
      * Renamed input format fields
     I              J5AIC3                          WDAIC3
     I              J5G4CD                          WDG4CD
     I              J5HXDT                          WDHXDT
     I              J5ANC7                          WDANC7
     I              J5CONB                          WDCONB
     I              J5CEST                          WDCEST
     I              J5DXNB                          WDDXNB
     I              J5UHCD                          WDUHCD
     I              J5BSVA                          WDBSVA
     I              J5CPTX                          WDCPTX
     I              J5C1NY                          WDC1NY
     I              J5IZTX                          WDIZTX
     I              J5H0DT                          WDH0DT
     I              J5ATDT                          WDATDT
     I              J5C4NB                          WDC4NB
     I              J5ABST                          WDABST
     I              J5NGNA                          WDNGNA
     I              J5UJCD                          WDUJCD
     I              J5AJST                          WDAJST
     I              J5ADST                          WDADST
     I              J5CKNB                          WDCKNB
     I              J5BCDT                          WDBCDT
     I              J5BGLC                          WDBGLC
     I              J5GLVL                          WDGLVL
     I              J5UVST                          WDUVST
     I              J5UWST                          WDUWST
     I              J5UXST                          WDUXST
     I              J5VSST                          WDVSST
     I              J5AATM                          WDAATM
     I              J5AYNA                          WDAYNA
     I              J5A0NA                          WDA0NA
     I              J5AXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDJ51    E DSPDJ5CPL0
      * UPD : A/R Posting and Reporting Update index
      * Renamed input format fields
     I              J5AIC3                          WDAIC3
     I              J5G4CD                          WDG4CD
     I              J5HXDT                          WDHXDT
     I              J5ANC7                          WDANC7
     I              J5CONB                          WDCONB
     I              J5CEST                          WDCEST
     I              J5DXNB                          WDDXNB
     I              J5UHCD                          WDUHCD
     I              J5BSVA                          WDBSVA
     I              J5CPTX                          WDCPTX
     I              J5C1NY                          WDC1NY
     I              J5IZTX                          WDIZTX
     I              J5H0DT                          WDH0DT
     I              J5ATDT                          WDATDT
     I              J5C4NB                          WDC4NB
     I              J5ABST                          WDABST
     I              J5NGNA                          WDNGNA
     I              J5UJCD                          WDUJCD
     I              J5AJST                          WDAJST
     I              J5ADST                          WDADST
     I              J5CKNB                          WDCKNB
     I              J5BCDT                          WDBCDT
     I              J5BGLC                          WDBGLC
     I              J5GLVL                          WDGLVL
     I              J5UVST                          WDUVST
     I              J5UWST                          WDUWST
     I              J5UXST                          WDUXST
     I              J5VSST                          WDVSST
     I              J5AATM                          WDAATM
     I              J5AYNA                          WDAYNA
     I              J5A0NA                          WDA0NA
     I              J5AXDT                          WDAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Bank Deposit
      * I :  Bank Code
     I                                        1   6 P1G4CD
      * I :  Deposit Date
     I                                    P   7  100P1HXDT
      * I :  Deposit Time
     I                                    P  11  130P1YXNX
      * I :  A/R Processing Status
     I                                       14  14 P1AJST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1G4CD    PARM           WP0001  6        Bank Code
     C           P1HXDT    PARM           WP0002  70       Deposit Date
     C           P1YXNX    PARM           WP0003  40       Deposit Time
     C           P1AJST    PARM           WP0004  1        A/R Processing
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CRT Crd-A/R G/L acct   XF
      * RTV Cust. Detail       RT - A/R Posting and Reporting  * 
     C                     EXSR SARVGN
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Cust. Detail       RT - A/R Posting and Reporting  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       G/L Posting Com
     C                     MOVEL*BLANK    WN0002  1        USR First Time
     C                     Z-ADD*ZERO     WN0003 112       USR Check Amoun
     C                     Z-ADD*ZERO     WN0004 112       USR Amount Appl
     C                     MOVEL*BLANK    WN0005 30        Adjustment Desc
     C                     MOVEL*BLANK    WN0006  1        Effect on Accou
     C                     MOVEL*BLANK    WN0007  8        G/L ID Code JDE
     C                     Z-ADD*ZERO     WN0008 112       Adjustment Limi
     C                     MOVEL*BLANK    WN0009  3        Cash/Adj
     C                     MOVEL*BLANK    WN0010  1        User Enter G/L
     C                     MOVEL*BLANK    WN0011  8        G/L Alpha Code
     C                     Z-ADD*ZERO     WN0012  70       USR A/R Custome
     C                     Z-ADD*ZERO     WN0013  30       Company Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0002           USR First Time
     C                     Z-ADD*ZERO     WN0004           USR Amount Appl
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAG4CD    WQSA01           Bank Code
     C           *LIKE     DEFN WAHXDT    WQSA02           Deposit Date
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Bank Code
     C                     KFLD           WQSA02           Deposit Date
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAANC7           A/R Customer Nu
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Bank Code
     C                     KFLD           WQSA02           Deposit Date
      * Setup key
     C                     MOVELP1G4CD    WQSA01           Bank Code
     C                     Z-ADDP1HXDT    WQSA02           Deposit Date
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
      * Establish starting position
     C           KPSSA     SETLL@J5CPYM                    *
     C           KRSSA     READE@J5CPYM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2078' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SAEXIT                     *QUIT
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First time flag
      * CASE: PAR.USR First Time is Yes
     C           WN0002    IFEQ 'Y'                        *IF
     C                     Z-ADDWAANC7    WUANC7           A/R Customer Nu
     C                     Z-ADDWAAIC3    WUAIC3           Company Number
     C                     MOVEL'N'       WN0002           USR First Time
     C                     END                             *FI
      * CASE: PAR.A/R Processing Status EQ DB1.A/R Processing Status
     C           P1AJST    IFEQ WAAJST                     *IF
      * Break on A/R Cust or Company (1/09/06 RMC added company break)
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.A/R Customer Number EQ WRK.A/R Customer Number
      *   |- c2    : DB1.Company Number EQ WRK.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAANC7    IFEQ WUANC7                     *IF
     C           WAAIC3    IFEQ WUAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WABSVA    WN0004           USR Amount Appl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUB8ST           Status - Y or N
      * Get Customers G/L A/R Code
      * Get A/R G/L if cust# or Non Cash A/R if no cust #
      * CASE: WRK.A/R Customer Number is not equal to zero
     C           WUANC7    IFNE *ZERO                      *IF
      * RTV G/L Code           RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0001           Company Number
     C                     Z-ADDWUANC7    WL0002           Ship To Custome
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0011    P      G/L Code
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0001  30       Company Number
     C                     PARM WN0011    WQ0002  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0003 25        G/L Code Desc U
     C           WN0007    PARM *BLANK    WQ0004  8        G/L Account Id
     C                     PARM *BLANK    WQ0005  3        G/L Account Typ
     C                     PARM *BLANK    WQ0006  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0007  1        Record Found US
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'ARC'     WUUHCD           Adjustment Type
     C                     ELSE
      * CASE: *OTHERWISE
      *    If Customer number is zero the record is a non-a/r cash
      * RTV G/L Code           RT - A/R Adjustment Type  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0004           Company Number
     C                     MOVEL'ARM'     WL0005    P      Adjustment Type
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0007    P      G/L ID Code JDE
     C                     MOVEL'ARM'     WUUHCD           Adjustment Type
     C                     END                             *FI
      *   A/R G/L account code is a Credit Entry - Reverse the sign
     C           *ZERO     SUB  WN0004    WN0004           USR Amount Appl
      *   Save Data from record just read into buffer
     C                     Z-ADDWAANC7    WN0012           USR A/R Custome
     C                     Z-ADDWAAIC3    WN0013           Company Number
     C                     Z-ADDWABSVA    WN0003           USR Check Amoun
      *    Create Credit to A/R Record
      *    OMS036 RMC 4/4/05 with DB1.company.. not par.company
      *    E000512 LJB 02/23/2010   Rcv new post edit code
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WN0007    WQ0008  8        G/L ID Code Alp
     C           WUMCUX    PARM *BLANK    WQ0009 12        Cost Center. .
     C           WUOBJX    PARM *BLANK    WQ0010  6        Object Account
     C           WUSUBX    PARM *BLANK    WQ0011  8        Subsidiary . .
     C                     PARM *BLANK    WQ0012 30        Description
     C           WN0001    PARM *ZERO     WQ0013  30       G/L Posting Com
     C           WUHNST    PARM *BLANK    WQ0014  1        JDE Posting Edi
     C           WUUNCD    PARM *BLANK    WQ0015  7        Error Return te
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Rtv sub ledger if GMPEC = "L", else set to zeros   E000512
      * CASE: WRK.JDE Posting Edit Code USR is Ledger Required
     C           WUHNST    IFEQ 'L'                        *IF
      * RTV G/L Sub Ledger Cd  XF - A/R Detail  * 
     C                     CALL 'PNG4XFR'              90  RTV G/L Sub Led
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0016  30       Company Number
     C                     PARM WACONB    WQ0017  70       Invoice Number
     C                     PARM WACEST    WQ0018  2        Invoice Suffix
     C                     PARM WADXNB    WQ0019  30       Sequence Number
     C           WUGLVL    PARM *ZERO     WQ0020 112       G/L Sub-Ledger
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNG4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUGLVL           G/L Sub-Ledger
     C                     END                             *FI
      * CRT Crd-A/R to G/L     CR - A/R Posting and Reporting  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0007           Company Number
     C                     MOVELP1G4CD    WL0008    P      Bank Code
     C                     Z-ADDP1HXDT    WL0009           Deposit Date
     C                     Z-ADDWUANC7    WL0010           A/R Customer Nu
     C                     Z-ADD*ZERO     WL0011           Invoice Number
     C                     MOVEL*BLANK    WL0012           Invoice Suffix
     C                     Z-ADD*ZERO     WL0013           Sequence Number
     C                     MOVELWUUHCD    WL0014    P      Adjustment Type
     C                     Z-ADDWN0004    WL0015           Transaction Amo
     C                     MOVEL*BLANK    WL0016           A/R Check Numbe
     C                     Z-ADDWN0001    WL0017           G/L Posting Com
     C                     MOVELWN0007    WL0018    P      G/L ID Code JDE
     C                     Z-ADD*ZERO     WL0019           Last Payment Da
     C                     Z-ADD*ZERO     WL0020           Due Date
     C                     Z-ADD*ZERO     WL0021           Order Number
     C                     MOVELWAABST    WL0022    P      Effect Cust. Ac
     C                     MOVEL@CN,01    WL0023    P      Explanation
     C                     MOVELWAUJCD    WL0024    P      Reference Field
     C                     MOVELP1AJST    WL0025    P      A/R Processing
     C                     MOVELWAADST    WL0026    P      Originating Fil
     C                     Z-ADDWACKNB    WL0027           G/L Document Nu
     C                     Z-ADDWABCDT    WL0028           Post to G/L Dat
     C                     MOVELWUBGLC    WL0029    P      Bank G/L ID Cod
     C                     Z-ADDWUGLVL    WL0030           G/L Sub-Ledger
     C                     MOVELWAUVST    WL0031    P      EDI Status 1
     C                     MOVELWAUWST    WL0032    P      EDI Status 2
     C                     MOVELWAUXST    WL0033    P      EDI Status 3
     C                     MOVEL'A'       WL0034    P      Record Status
     C                     Z-ADD##JTM     WL0035           Job Time
     C                     MOVEL##USR     WL0036    P      User Id
     C                     MOVEL##PGM     WL0037    P      Job Name
     C                     Z-ADD##JDT     WL0038           Job Date
     C                     EXSR SDCRRC
     C                     Z-ADDWN0003    WN0004           USR Amount Appl
     C                     Z-ADDWN0012    WUANC7           A/R Customer Nu
     C                     Z-ADDWN0013    WUAIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@J5CPYM                  90*
     C                     ENDDO
      * USER: Exit processing
      * Get Customers G/L A/R Code
      * CASE: WRK.A/R Customer Number is not equal to zero
     C           WUANC7    IFNE *ZERO                      *IF
      * RTV G/L Code           RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0001           Company Number
     C                     Z-ADDWUANC7    WL0002           Ship To Custome
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0011    P      G/L Code
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0021  30       Company Number
     C                     PARM WN0011    WQ0022  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0023 25        G/L Code Desc U
     C           WN0007    PARM *BLANK    WQ0024  8        G/L Account Id
     C                     PARM *BLANK    WQ0025  3        G/L Account Typ
     C                     PARM *BLANK    WQ0026  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0027  1        Record Found US
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'ARC'     WUUHCD           Adjustment Type
     C                     ELSE
      * CASE: *OTHERWISE
      *    If Customer number is zero the record is a non-a/r cash
      * RTV G/L Code           RT - A/R Adjustment Type  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0004           Company Number
     C                     MOVEL'ARM'     WL0005    P      Adjustment Type
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0007    P      G/L ID Code JDE
     C                     MOVEL'ARM'     WUUHCD           Adjustment Type
     C                     END                             *FI
      *     A/R G/L account code is a Credit Entry
     C           *ZERO     SUB  WN0004    WN0004           USR Amount Appl
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WN0007    WQ0028  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0029 12        Cost Center. .
     C                     PARM *BLANK    WQ0030  6        Object Account
     C                     PARM *BLANK    WQ0031  8        Subsidiary . .
     C                     PARM *BLANK    WQ0032 30        Description
     C           WN0001    PARM *ZERO     WQ0033  30       G/L Posting Com
     C           WUHNST    PARM *BLANK    WQ0034  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0035  7        Error Return te
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Rtv sub ledger if GMPEC = "L", else set to zeros   E000512
      * CASE: WRK.JDE Posting Edit Code USR is Ledger Required
     C           WUHNST    IFEQ 'L'                        *IF
      * RTV G/L Sub Ledger Cd  XF - A/R Detail  * 
     C                     CALL 'PNG4XFR'              90  RTV G/L Sub Led
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0036  30       Company Number
     C                     PARM WACONB    WQ0037  70       Invoice Number
     C                     PARM WACEST    WQ0038  2        Invoice Suffix
     C                     PARM WADXNB    WQ0039  30       Sequence Number
     C           WUGLVL    PARM *ZERO     WQ0040 112       G/L Sub-Ledger
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNG4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUGLVL           G/L Sub-Ledger
     C                     END                             *FI
      * CRT Crd-A/R to G/L     CR - A/R Posting and Reporting  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0007           Company Number
     C                     MOVELP1G4CD    WL0008    P      Bank Code
     C                     Z-ADDP1HXDT    WL0009           Deposit Date
     C                     Z-ADDWUANC7    WL0010           A/R Customer Nu
     C                     Z-ADD*ZERO     WL0011           Invoice Number
     C                     MOVEL*BLANK    WL0012           Invoice Suffix
     C                     Z-ADD*ZERO     WL0013           Sequence Number
     C                     MOVELWUUHCD    WL0014    P      Adjustment Type
     C                     Z-ADDWN0004    WL0015           Transaction Amo
     C                     MOVEL*BLANK    WL0016           A/R Check Numbe
     C                     Z-ADDWN0001    WL0017           G/L Posting Com
     C                     MOVELWN0007    WL0018    P      G/L ID Code JDE
     C                     Z-ADD*ZERO     WL0019           Last Payment Da
     C                     Z-ADD*ZERO     WL0020           Due Date
     C                     Z-ADD*ZERO     WL0021           Order Number
     C                     MOVELWAABST    WL0022    P      Effect Cust. Ac
     C                     MOVEL@CN,01    WL0023    P      Explanation
     C                     MOVELWAUJCD    WL0024    P      Reference Field
     C                     MOVELP1AJST    WL0025    P      A/R Processing
     C                     MOVELWAADST    WL0026    P      Originating Fil
     C                     Z-ADDWACKNB    WL0027           G/L Document Nu
     C                     Z-ADDWABCDT    WL0028           Post to G/L Dat
     C                     MOVELWUBGLC    WL0029    P      Bank G/L ID Cod
     C                     Z-ADDWUGLVL    WL0030           G/L Sub-Ledger
     C                     MOVELWAUVST    WL0031    P      EDI Status 1
     C                     MOVELWAUWST    WL0032    P      EDI Status 2
     C                     MOVELWAUXST    WL0033    P      EDI Status 3
     C                     MOVEL'A'       WL0034    P      Record Status
     C                     Z-ADDWAAATM    WL0035           Job Time
     C                     MOVELWAAYNA    WL0036    P      User Id
     C                     MOVELWAA0NA    WL0037    P      Job Name
     C                     Z-ADDWAAXDT    WL0038           Job Date
     C                     EXSR SDCRRC
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV G/L Code           RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSB     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWBISTX    WL0003           G/L Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV G/L Code           RT - A/R Adjustment Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCUHCD    WQSC02           Adjustment Type
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Adjustment Type
      * Setup key
     C                     Z-ADDWL0004    WQSC01           Company Number
     C                     MOVELWL0005    WQSC02           Adjustment Type
      * Establish starting position
     C           KRSSC     SETLL@J3CPCZ                    *
     C           KRSSC     READE@J3CPCZ                  90*
      * Data record not found
     C   90                MOVEL'USR2041' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWCIZTX    WL0006           G/L ID Code JDE
     C           KRSSC     READE@J3CPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * CRT Crd-A/R to G/L     CR - A/R Posting and Reporting  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J5CPDL
     C                     Z-ADDWL0007    WDAIC3           Company Number
     C                     MOVELWL0008    WDG4CD           Bank Code
     C                     Z-ADDWL0009    WDHXDT           Deposit Date
     C                     Z-ADDWL0010    WDANC7           A/R Customer Nu
     C                     Z-ADDWL0011    WDCONB           Invoice Number
     C                     MOVELWL0012    WDCEST           Invoice Suffix
     C                     Z-ADDWL0013    WDDXNB           Sequence Number
     C                     MOVELWL0014    WDUHCD           Adjustment Type
     C                     Z-ADDWL0015    WDBSVA           Transaction Amo
     C                     MOVELWL0016    WDCPTX           A/R Check Numbe
     C                     Z-ADDWL0017    WDC1NY           G/L Posting Com
     C                     MOVELWL0018    WDIZTX           G/L ID Code JDE
     C                     Z-ADDWL0019    WDH0DT           Last Payment Da
     C                     Z-ADDWL0020    WDATDT           Due Date
     C                     Z-ADDWL0021    WDC4NB           Order Number
     C                     MOVELWL0022    WDABST           Effect Cust. Ac
     C                     MOVELWL0023    WDNGNA           Explanation
     C                     MOVELWL0024    WDUJCD           Reference Field
     C                     MOVELWL0025    WDAJST           A/R Processing
     C                     MOVELWL0026    WDADST           Originating Fil
     C                     Z-ADDWL0027    WDCKNB           G/L Document Nu
     C                     Z-ADDWL0028    WDBCDT           Post to G/L Dat
     C                     MOVELWL0029    WDBGLC           Bank G/L ID Cod
     C                     Z-ADDWL0030    WDGLVL           G/L Sub-Ledger
     C                     MOVELWL0031    WDUVST           EDI Status 1
     C                     MOVELWL0032    WDUWST           EDI Status 2
     C                     MOVELWL0033    WDUXST           EDI Status 3
     C                     MOVELWL0034    WDVSST           Record Status
     C                     Z-ADDWL0035    WDAATM           Job Time
     C                     MOVELWL0036    WDAYNA           User Id
     C                     MOVELWL0037    WDA0NA           Job Name
     C                     Z-ADDWL0038    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDG4CD           Bank Code
     C                     KFLD           WDHXDT           Deposit Date
     C                     KFLD           WDANC7           A/R Customer Nu
     C                     KFLD           WDCONB           Invoice Number
     C                     KFLD           WDCEST           Invoice Suffix
     C                     KFLD           WDDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSD    SETLL@J5CPDL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2079' W0RTN   7
      * Send message 'A/R Posting and Report EX'
     C                     MOVEL'USR2079' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@J5CPDL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 02/08/2010 LJB E000512   New field added to ARACTRET. Retrieve
      * ** to a null field value
      * **
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * 02/08/2010 LJB E000512  New field added to ARACTRET, ARACTEDT.
      *   Subledger entered on Edit Cash App and validated there
      * OMS036 RMC - 01/09/6 break on Cust or Company, not just customer
      * Create Credit G/L Entry for a credit to A/R
      * OMS036 RMC - 12/23/5 output g/l posting company to a/r posting fi
      * OMS036 RMC - 4/4/05 Read file without Co as part of the key. want
      *   read all of the records for that bank/date
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHXDT           Deposit Date
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WABSVA           Transaction Amo
     C                     Z-ADD*ZERO     WAC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WAH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WAATDT           Due Date
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WAGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field A/R Customer Number
     C                     Z-ADD*ZERO     WUANC7  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field G/L Code Desc USR
     C                     MOVEL*BLANK    WUIYTX 25
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field Adjustment Type Code
     C                     MOVEL*BLANK    WUUHCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCUKVA           Adjustment Limi
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    WUMCUX 12
      * Define work field Object Account . . . . .
     C                     MOVEL*BLANK    WUOBJX  6
      * Define work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    WUSUBX  8
      * Define work field JDE Posting Edit Code USR
     C                     MOVEL*BLANK    WUHNST  1
      * Define work field Error Return text
     C                     MOVEL*BLANK    WUUNCD  7
      * Define work field G/L Sub-Ledger Code
     C                     Z-ADD*ZERO     WUGLVL 112
      * Define work field Bank G/L ID Code
     C                     MOVEL*BLANK    WUBGLC  8
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  8
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  3
     C                     MOVEL*BLANK    WL0006  8
      * Define local variables for subroutine SDCRRC.
     C                     Z-ADD*ZERO     WL0007  30
     C                     MOVEL*BLANK    WL0008  6
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013  30
     C                     MOVEL*BLANK    WL0014  3
     C                     Z-ADD*ZERO     WL0015 112
     C                     MOVEL*BLANK    WL0016 10
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  8
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  70
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023 30
     C                     MOVEL*BLANK    WL0024 15
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     Z-ADD*ZERO     WL0027  80
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  8
     C                     Z-ADD*ZERO     WL0030 112
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  60
     C                     MOVEL*BLANK    WL0036 10
     C                     MOVEL*BLANK    WL0037 10
     C                     Z-ADD*ZERO     WL0038  70
      * Define null work field Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    YN0002 12
      * Define null work field Object Account . . . . .
     C                     MOVEL*BLANK    YN0003  6
      * Define null work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    YN0004  8
      * Define null work field Error Return text
     C                     MOVEL*BLANK    YN0005  7
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 A/R Account Number
