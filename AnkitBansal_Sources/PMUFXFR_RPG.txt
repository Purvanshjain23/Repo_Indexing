     H/TITLE Bld EDI DistAllowance XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSZURN
     H* Date          : 10/05/16  Time  : 15:56:16
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOC5REL5IF  E           K        DISK
      * RSQ : Broker                    EDI Trade Partner
      *
     FPDICCPL8IF  E           K        DISK
      * RSQ : History Dtl Accrual       BrkrCde/Accrcde
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FPBB8REL1IF  E           K        DISK
      * RTV : Trade Partner Control     Retrieval index
      *
     FECP017L3IF  E           K        DISK
      * RTV : EDI DIST Allow Header     Rtv/Crt/Chg
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCABZREL7IF  E           K        DISK
      * RSQ : Company Item              RSQ by Item only      NV
      *
     FECP017L0UF  E           K        DISK                      A
      * UPD : EDI DIST Allow Header     Update index
      *
     FECP019L0IF  E           K        DISK                      A
      * UPD : EDI Dist Allow Cust Name  Update index
      *
     FECP018L0IF  E           K        DISK                      A
      * UPD : EDI Dist Allow Detail     Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@C5RESR
      * Broker                    EDI Trade Partner
      * Renamed input format fields
     I              C5HHAA                          WAHHAA
     I              C5C4T1                          WAC4T1
     I              C5QMNA                          WAQMNA
     I              C5QNNA                          WAQNNA
     I              C5QONA                          WAQONA
     I              C5QPNA                          WAQPNA
     I              C5C5T1                          WAC5T1
     I              C5C6T1                          WAC6T1
     I              C5C7T1                          WAC7T1
     I              C5C8T1                          WAC8T1
     I              C5C9T1                          WAC9T1
     I              C5DAT1                          WADAT1
     I              C5DBT1                          WADBT1
     I              C5DCT1                          WADCT1
     I              C5DDT1                          WADDT1
     I              C5PWSX                          WAPWSX
     I              C5PXSX                          WAPXSX
     I              C5PYSX                          WAPYSX
     I              C5PZSX                          WAPZSX
     I              C5BCCD                          WABCCD
     I              C5UVST                          WAUVST
     I              C5UWST                          WAUWST
     I              C5UXST                          WAUXST
     I              C5VSST                          WAVSST
     I              C5AATM                          WAAATM
     I              C5AYNA                          WAAYNA
     I              C5A0NA                          WAA0NA
     I              C5AXDT                          WAAXDT
      *
     I@ICCPS1
      * History Dtl Accrual       BrkrCde/Accrcde
      * Renamed input format fields
     I              ICAIC3                          WBAIC3
     I              ICC4NB                          WBC4NB
     I              ICDPNB                          WBDPNB
     I              ICUENB                          WBUENB
     I              ICDXNB                          WBDXNB
     I              ICBKPR                          WBBKPR
     I              ICAYVA                          WBAYVA
     I              ICEDVL                          WBEDVL
     I              ICHGCD                          WBHGCD
     I              ICBKC7                          WBBKC7
     I              ICPTDT                          WBPTDT
     I              ICBYWG                          WBBYWG
     I              ICBVST                          WBBVST
     I              ICP7SX                          WBP7SX
     I              ICOKCD                          WBOKCD
     I              ICQQSX                          WBQQSX
     I              ICQRSX                          WBQRSX
     I              ICFLTX                          WBFLTX
     I              ICQSSX                          WBQSSX
     I              ICPRDT                          WBPRDT
     I              ICPSDT                          WBPSDT
     I              ICEGVL                          WBEGVL
     I              ICEHVL                          WBEHVL
     I              ICAVNB                          WBAVNB
     I              ICDSCD                          WBDSCD
     I              ICFMTX                          WBFMTX
     I              ICFNTX                          WBFNTX
     I              ICQ9DT                          WBQ9DT
     I              ICFOTX                          WBFOTX
     I              ICH1NY                          WBH1NY
     I              ICKRT1                          WBKRT1
     I              ICKST1                          WBKST1
     I              ICHJAA                          WBHJAA
     I              ICHKAA                          WBHKAA
     I              ICHHAA                          WBHHAA
     I              ICOJCD                          WBOJCD
     I              ICAATM                          WBAATM
     I              ICAYNA                          WBAYNA
     I              ICA0NA                          WBA0NA
     I              ICAXDT                          WBAXDT
      *
     I@FHSTD3
      * Sales History             Retrieval index
      * Renamed input format fields
     I              F4AIC3                          WCAIC3
     I              F4C4NB                          WCC4NB
     I              F4DPNB                          WCDPNB
     I              F4UENB                          WCUENB
     I              F4MONA                          WCMONA
     I              F4RJCD                          WCRJCD
     I              F4RKCD                          WCRKCD
     I              F4GPTX                          WCGPTX
     I              F4ABTX                          WCABTX
     I              F4KXCD                          WCKXCD
     I              F4BOCD                          WCBOCD
     I              F4BTC7                          WCBTC7
     I              F4ANC7                          WCANC7
     I              F4AQTX                          WCAQTX
     I              F4BKC7                          WCBKC7
     I              F4BRTX                          WCBRTX
     I              F4HNNA                          WCHNNA
     I              F4DBCD                          WCDBCD
     I              F4CKTX                          WCCKTX
     I              F4BCNA                          WCBCNA
     I              F4A0DT                          WCA0DT
     I              F4ACDT                          WCACDT
     I              F4R4CD                          WCR4CD
     I              F4R5CD                          WCR5CD
     I              F4BFCD                          WCBFCD
     I              F4Q4CD                          WCQ4CD
     I              F4AQCD                          WCAQCD
     I              F4TBNB                          WCTBNB
     I              F4BZNA                          WCBZNA
     I              F4RLCD                          WCRLCD
     I              F4JNCD                          WCJNCD
     I              F4Q2CD                          WCQ2CD
     I              F4U2ST                          WCU2ST
     I              F4ATIN                          WCATIN
     I              F4T3NB                          WCT3NB
     I              F4RSRN                          WCRSRN
     I              F4ORIT                          WCORIT
     I              F4AJCD                          WCAJCD
     I              F4AVQT                          WCAVQT
     I              F4D0WG                          WCD0WG
     I              F4CCQT                          WCCCQT
     I              F4AUWG                          WCAUWG
     I              F4AGCD                          WCAGCD
     I              F4AKPR                          WCAKPR
     I              F4AUPR                          WCAUPR
     I              F4CRCD                          WCCRCD
     I              F4A5DT                          WCA5DT
     I              F4AWDT                          WCAWDT
     I              F4HDDT                          WCHDDT
     I              F4AGCS                          WCAGCS
     I              F4AQCS                          WCAQCS
     I              F4AVWG                          WCAVWG
     I              F4AYVA                          WCAYVA
     I              F4AMST                          WCAMST
     I              F4ANST                          WCANST
     I              F4VAST                          WCVAST
     I              F4L6NB                          WCL6NB
     I              F4UMCD                          WCUMCD
     I              F4HCDT                          WCHCDT
     I              F4ESNB                          WCESNB
     I              F4ETNB                          WCETNB
     I              F4BZNB                          WCBZNB
     I              F4EXQT                          WCEXQT
     I              F4BYWG                          WCBYWG
     I              F4S5NB                          WCS5NB
     I              F4MAVA                          WCMAVA
     I              F4KDVA                          WCKDVA
     I              F4USVA                          WCUSVA
     I              F4UTVA                          WCUTVA
     I              F4A4WG                          WCA4WG
     I              F4CKNB                          WCCKNB
     I              F4BMST                          WCBMST
     I              F4R8NB                          WCR8NB
     I              F4RMCD                          WCRMCD
     I              F4BZPR                          WCBZPR
     I              F4RDCD                          WCRDCD
     I              F4Q7CD                          WCQ7CD
     I              F4EXDT                          WCEXDT
     I              F4LQCD                          WCLQCD
     I              F4HICD                          WCHICD
     I              F4RBCD                          WCRBCD
     I              F4RGNB                          WCRGNB
     I              F4RHNB                          WCRHNB
     I              F4RINB                          WCRINB
     I              F4R1NB                          WCR1NB
     I              F4CONB                          WCCONB
     I              F4CEST                          WCCEST
     I              F4GNDT                          WCGNDT
     I              F4RMNB                          WCRMNB
     I              F4AODT                          WCAODT
     I              F4LLCD                          WCLLCD
     I              F4LMCD                          WCLMCD
     I              F4SKNB                          WCSKNB
     I              F4SLNB                          WCSLNB
     I              F4SMNB                          WCSMNB
     I              F4G7NA                          WCG7NA
     I              F4ONVA                          WCONVA
     I              F4N0CD                          WCN0CD
     I              F4B4NB                          WCB4NB
     I              F4B5NB                          WCB5NB
     I              F4N1CD                          WCN1CD
     I              F4GIDT                          WCGIDT
     I              F4Z1ST                          WCZ1ST
     I              F4ULVA                          WCULVA
     I              F4UNVA                          WCUNVA
     I              F4UOVA                          WCUOVA
     I              F4UPVA                          WCUPVA
     I              F4UQVA                          WCUQVA
     I              F4SDCD                          WCSDCD
     I              F4QZCD                          WCQZCD
     I              F4XWST                          WCXWST
     I              F4T9CD                          WCT9CD
     I              F4UBCD                          WCUBCD
     I              F4CFC7                          WCCFC7
     I              F4X1CD                          WCX1CD
     I              F4GASX                          WCGASX
     I              F4DUPR                          WCDUPR
     I              F4B6VL                          WCB6VL
     I              F4IANX                          WCIANX
     I              F4IBNX                          WCIBNX
     I              F4RPCD                          WCRPCD
     I              F4NYDT                          WCNYDT
     I              F4BZTM                          WCBZTM
     I              F4Z4NB                          WCZ4NB
     I              F4XACD                          WCXACD
     I              F4OANA                          WCOANA
     I              F4OKTX                          WCOKTX
     I              F4K4TX                          WCK4TX
     I              F4NBBO                          WCNBBO
     I              F4OCFR                          WCOCFR
     I              F4C0C7                          WCC0C7
     I              F4A1AA                          WCA1AA
     I              F4VEST                          WCVEST
     I              F4A5PR                          WCA5PR
     I              F4CDPR                          WCCDPR
     I              F4D0PR                          WCD0PR
     I              F4D0VL                          WCD0VL
     I              F4IRSX                          WCIRSX
     I              F4CEVL                          WCCEVL
     I              F4ISSX                          WCISSX
     I              F4ITSX                          WCITSX
     I              F4IUSX                          WCIUSX
     I              F4OHDT                          WCOHDT
     I              F4D9PR                          WCD9PR
     I              F4CFVL                          WCCFVL
     I              F4UVST                          WCUVST
     I              F4UWST                          WCUWST
     I              F4UXST                          WCUXST
     I              F4AATM                          WCAATM
     I              F4AYNA                          WCAYNA
     I              F4A0NA                          WCA0NA
     I              F4AXDT                          WCAXDT
      *
     I@B8REVF
      * Trade Partner Control     Retrieval index
      * Renamed input format fields
     I              B8J5NX                          WDJ5NX
     I              B8CBSC                          WDCBSC
     I              B8CCSC                          WDCCSC
     I              B8CDSC                          WDCDSC
     I              B8CESC                          WDCESC
     I              B8CFSC                          WDCFSC
     I              B8CGSC                          WDCGSC
     I              B8CHSC                          WDCHSC
     I              B8CISC                          WDCISC
     I              B8CJSC                          WDCJSC
     I              B8CKSC                          WDCKSC
     I              B8CLSC                          WDCLSC
     I              B8CMSC                          WDCMSC
     I              B8CNSC                          WDCNSC
     I              B8EHU1                          WDEHU1
     I              B8EIU1                          WDEIU1
     I              B8EJU1                          WDEJU1
     I              B8EKU1                          WDEKU1
     I              B8V1DT                          WDV1DT
     I              B8V2DT                          WDV2DT
     I              B8VSST                          WDVSST
     I              B8MJDT                          WDMJDT
     I              B8BETM                          WDBETM
     I              B8CCVN                          WDCCVN
     I              B8CDVN                          WDCDVN
     I              B8MKDT                          WDMKDT
     I              B8BFTM                          WDBFTM
     I              B8CEVN                          WDCEVN
     I              B8CFVN                          WDCFVN
      *
     I@P017ZI
      * EDI DIST Allow Header     Rtv/Crt/Chg
      * Renamed input format fields
     I              DUBNC3                          WEBNC3
     I              DUHHAA                          WEHHAA
     I              DULTNY                          WELTNY
     I              DUFLGX                          WEFLGX
     I              DUJWAA                          WEJWAA
     I              DUMONY                          WEMONY
     I              DULUNY                          WELUNY
     I              DUJHAA                          WEJHAA
     I              DUOHT1                          WEOHT1
     I              DULVNY                          WELVNY
     I              DUIYVL                          WEIYVL
     I              DUJIAA                          WEJIAA
     I              DUIZVL                          WEIZVL
     I              DULZNY                          WELZNY
     I              DUMVVL                          WEMVVL
     I              DURUAA                          WERUAA
     I              DUAJU1                          WEAJU1
     I              DURVAA                          WERVAA
      *
     I@DUCPSZ
      * EDI DIST Allow Header     Update index
      * Renamed input format fields
     I              DUBNC3                          WFBNC3
     I              DUHHAA                          WFHHAA
     I              DULTNY                          WFLTNY
     I              DUFLGX                          WFFLGX
     I              DUJWAA                          WFJWAA
     I              DUMONY                          WFMONY
     I              DULUNY                          WFLUNY
     I              DUJHAA                          WFJHAA
     I              DUOHT1                          WFOHT1
     I              DULVNY                          WFLVNY
     I              DUIYVL                          WFIYVL
     I              DUJIAA                          WFJIAA
     I              DUIZVL                          WFIZVL
     I              DULZNY                          WFLZNY
     I              DUMVVL                          WFMVVL
     I              DURUAA                          WFRUAA
     I              DUAJU1                          WFAJU1
     I              DURVAA                          WFRVAA
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WGBKC7
     I              BBAYTX                          WGAYTX
     I              BBACNA                          WGACNA
     I              BBADNA                          WGADNA
     I              BBAENA                          WGAENA
     I              BBAJNA                          WGAJNA
     I              BBBGCD                          WGBGCD
     I              BBG5CD                          WGG5CD
     I              BBBTTX                          WGBTTX
     I              BBBVTX                          WGBVTX
     I              BBBWTX                          WGBWTX
     I              BBABTX                          WGABTX
     I              BBA2NA                          WGA2NA
     I              BBCBST                          WGCBST
     I              BBB0NA                          WGB0NA
     I              BBP3NB                          WGP3NB
     I              BBAXNA                          WGAXNA
     I              BBI6DT                          WGI6DT
     I              BBAYDT                          WGAYDT
     I              BBANC7                          WGANC7
     I              BBBTC7                          WGBTC7
     I              BBK6ST                          WGK6ST
     I              BBUZST                          WGUZST
     I              BBKXCD                          WGKXCD
     I              BBLTCD                          WGLTCD
     I              BBQNST                          WGQNST
     I              BBS2NB                          WGS2NB
     I              BBVHVA                          WGVHVA
     I              BBI7DT                          WGI7DT
     I              BBRJST                          WGRJST
     I              BBRKST                          WGRKST
     I              BBQWST                          WGQWST
     I              BBQXST                          WGQXST
     I              BBQYST                          WGQYST
     I              BBUNCS                          WGUNCS
     I              BBUVST                          WGUVST
     I              BBUWST                          WGUWST
     I              BBUXST                          WGUXST
     I              BBVSST                          WGVSST
     I              BBAATM                          WGAATM
     I              BBAYNA                          WGAYNA
     I              BBA0NA                          WGA0NA
     I              BBAXDT                          WGAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WHBKC7
     I              NEUFTX                          WHUFTX
     I              NEUGTX                          WHUGTX
     I              NEPFNA                          WHPFNA
     I              NEJ5NX                          WHJ5NX
     I              NEU5TX                          WHU5TX
     I              NEU6TX                          WHU6TX
     I              NEW0TX                          WHW0TX
     I              NEHSSX                          WHHSSX
     I              NEHUSX                          WHHUSX
     I              NEHVSX                          WHHVSX
     I              NEAAC8                          WHAAC8
     I              NEP0SX                          WHP0SX
     I              NEP1SX                          WHP1SX
     I              NEP2SX                          WHP2SX
     I              NEP3SX                          WHP3SX
     I              NEP4SX                          WHP4SX
     I              NEP5SX                          WHP5SX
     I              NEP6SX                          WHP6SX
     I              NEUVST                          WHUVST
     I              NEUWST                          WHUWST
     I              NEUXST                          WHUXST
     I              NEVSST                          WHVSST
     I              NEAATM                          WHAATM
     I              NEAYNA                          WHAYNA
     I              NEA0NA                          WHA0NA
     I              NEAXDT                          WHAXDT
      *
     I@DTCPSW
      * EDI Dist Allow Cust Name  Update index
      * Renamed input format fields
     I              DWBNC3                          WIBNC3
     I              DWHHAA                          WIHHAA
     I              DWLSNY                          WILSNY
     I              DWOFT1                          WIOFT1
     I              DWOAT1                          WIOAT1
     I              DWJFAA                          WIJFAA
     I              DWOBT1                          WIOBT1
     I              DWOCT1                          WIOCT1
     I              DWODT1                          WIODT1
     I              DWOET1                          WIOET1
     I              DWJGAA                          WIJGAA
     I              DWOGT1                          WIOGT1
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WJAIC3
     I              ABADTX                          WJADTX
     I              ABACNA                          WJACNA
     I              ABADNA                          WJADNA
     I              ABAENA                          WJAENA
     I              ABAJNA                          WJAJNA
     I              ABBTTX                          WJBTTX
     I              ABBVTX                          WJBVTX
     I              ABBWTX                          WJBWTX
     I              ABA2NA                          WJA2NA
     I              ABABTX                          WJABTX
     I              ABBGCD                          WJBGCD
     I              ABKXCD                          WJKXCD
     I              ABUVST                          WJUVST
     I              ABUWST                          WJUWST
     I              ABUXST                          WJUXST
     I              ABVSST                          WJVSST
     I              ABAATM                          WJAATM
     I              ABAYNA                          WJAYNA
     I              ABA0NA                          WJA0NA
     I              ABAXDT                          WJAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WKAIC3
     I              KMV8CD                          WKV8CD
     I              KMAUNA                          WKAUNA
     I              KMI5ST                          WKI5ST
     I              KMBXTX                          WKBXTX
     I              KMM8NB                          WKM8NB
     I              KMUVST                          WKUVST
     I              KMUWST                          WKUWST
     I              KMUXST                          WKUXST
     I              KMVSST                          WKVSST
     I              KMAATM                          WKAATM
     I              KMAYNA                          WKAYNA
     I              KMA0NA                          WKA0NA
     I              KMAXDT                          WKAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WLDOCD
     I              DPAUNA                          WLAUNA
     I              DPI5ST                          WLI5ST
     I              DPBXTX                          WLBXTX
     I              DPM8NB                          WLM8NB
     I              DPUVST                          WLUVST
     I              DPUWST                          WLUWST
     I              DPUXST                          WLUXST
     I              DPVSST                          WLVSST
     I              DPAATM                          WLAATM
     I              DPAYNA                          WLAYNA
     I              DPA0NA                          WLA0NA
     I              DPAXDT                          WLAXDT
      *
     I@BZRED0
      * Company Item              RSQ by Item only      NV
      * Renamed input format fields
     I              BZAIC3                          WMAIC3
     I              BZHGCD                          WMHGCD
     I              BZAVNA                          WMAVNA
     I              BZAWNA                          WMAWNA
     I              BZL7NA                          WML7NA
     I              BZL8NA                          WML8NA
     I              BZL6NA                          WML6NA
     I              BZMFNA                          WMMFNA
     I              BZADCD                          WMADCD
     I              BZAWPC                          WMAWPC
     I              BZLXST                          WMLXST
     I              BZAECD                          WMAECD
     I              BZAXPC                          WMAXPC
     I              BZLYST                          WMLYST
     I              BZAFCD                          WMAFCD
     I              BZAICD                          WMAICD
     I              BZAIWG                          WMAIWG
     I              BZHICD                          WMHICD
     I              BZRBCD                          WMRBCD
     I              BZFZST                          WMFZST
     I              BZAVST                          WMAVST
     I              BZCZWG                          WMCZWG
     I              BZC0WG                          WMC0WG
     I              BZURTN                          WMURTN
     I              BZAJC8                          WMAJC8
     I              BZRINB                          WMRINB
     I              BZRHNB                          WMRHNB
     I              BZRGNB                          WMRGNB
     I              BZLNCD                          WMLNCD
     I              BZTFNB                          WMTFNB
     I              BZN0CD                          WMN0CD
     I              BZX4ST                          WMX4ST
     I              BZTMVA                          WMTMVA
     I              BZTNVA                          WMTNVA
     I              BZBLPR                          WMBLPR
     I              BZBMPR                          WMBMPR
     I              BZLRCD                          WMLRCD
     I              BZU9ST                          WMU9ST
     I              BZCMCO                          WMCMCO
     I              BZQ1CD                          WMQ1CD
     I              BZQ8CD                          WMQ8CD
     I              BZCHTM                          WMCHTM
     I              BZQZCD                          WMQZCD
     I              BZXWST                          WMXWST
     I              BZXXST                          WMXXST
     I              BZVMST                          WMVMST
     I              BZSWGH                          WMSWGH
     I              BZPPHE                          WMPPHE
     I              BZR3CD                          WMR3CD
     I              BZSDCD                          WMSDCD
     I              BZICN1                          WMICN1
     I              BZSVCD                          WMSVCD
     I              BZICN2                          WMICN2
     I              BZSWCD                          WMSWCD
     I              BZV2NB                          WMV2NB
     I              BZSXCD                          WMSXCD
     I              BZITCN                          WMITCN
     I              BZSYCD                          WMSYCD
     I              BZITC5                          WMITC5
     I              BZSZCD                          WMSZCD
     I              BZICN6                          WMICN6
     I              BZS0CD                          WMS0CD
     I              BZICN7                          WMICN7
     I              BZS1CD                          WMS1CD
     I              BZICN8                          WMICN8
     I              BZS2CD                          WMS2CD
     I              BZICN9                          WMICN9
     I              BZS3CD                          WMS3CD
     I              BZICN0                          WMICN0
     I              BZS4CD                          WMS4CD
     I              BZSFNB                          WMSFNB
     I              BZA3WG                          WMA3WG
     I              BZSJNB                          WMSJNB
     I              BZLLCD                          WMLLCD
     I              BZLMCD                          WMLMCD
     I              BZP3ST                          WMP3ST
     I              BZSKNB                          WMSKNB
     I              BZSLNB                          WMSLNB
     I              BZSMNB                          WMSMNB
     I              BZP4ST                          WMP4ST
     I              BZCFNB                          WMCFNB
     I              BZCGNB                          WMCGNB
     I              BZILNB                          WMILNB
     I              BZCHNB                          WMCHNB
     I              BZCINB                          WMCINB
     I              BZCJNB                          WMCJNB
     I              BZCMNB                          WMCMNB
     I              BZCNNB                          WMCNNB
     I              BZCRNB                          WMCRNB
     I              BZCSNB                          WMCSNB
     I              BZCVNB                          WMCVNB
     I              BZCWNB                          WMCWNB
     I              BZCXNB                          WMCXNB
     I              BZCZNB                          WMCZNB
     I              BZC0NB                          WMC0NB
     I              BZN1CD                          WMN1CD
     I              BZB4NB                          WMB4NB
     I              BZB5NB                          WMB5NB
     I              BZX5ST                          WMX5ST
     I              BZX6ST                          WMX6ST
     I              BZX7ST                          WMX7ST
     I              BZPCCT                          WMPCCT
     I              BZBDNB                          WMBDNB
     I              BZBJNB                          WMBJNB
     I              BZSUST                          WMSUST
     I              BZSVST                          WMSVST
     I              BZSYST                          WMSYST
     I              BZSZST                          WMSZST
     I              BZS1ST                          WMS1ST
     I              BZXRCD                          WMXRCD
     I              BZXTCD                          WMXTCD
     I              BZXUCD                          WMXUCD
     I              BZF5WG                          WMF5WG
     I              BZF6WG                          WMF6WG
     I              BZF7WG                          WMF7WG
     I              BZBLNB                          WMBLNB
     I              BZBNNB                          WMBNNB
     I              BZS2ST                          WMS2ST
     I              BZS4ST                          WMS4ST
     I              BZS5ST                          WMS5ST
     I              BZS6ST                          WMS6ST
     I              BZS8ST                          WMS8ST
     I              BZS9ST                          WMS9ST
     I              BZTCST                          WMTCST
     I              BZTDST                          WMTDST
     I              BZUVST                          WMUVST
     I              BZUWST                          WMUWST
     I              BZUXST                          WMUXST
     I              BZVSST                          WMVSST
     I              BZAATM                          WMAATM
     I              BZAYNA                          WMAYNA
     I              BZA0NA                          WMA0NA
     I              BZAXDT                          WMAXDT
      *
     I@DVCPST
      * EDI Dist Allow Detail     Update index
      * Renamed input format fields
     I              DBBNC3                          WOBNC3
     I              DBHHAA                          WOHHAA
     I              DBLWNY                          WOLWNY
     I              DBL0NY                          WOL0NY
     I              DBLXNY                          WOLXNY
     I              DBLYNY                          WOLYNY
     I              DBL7NY                          WOL7NY
     I              DBOLT1                          WOOLT1
     I              DBJTAA                          WOJTAA
     I              DBOMT1                          WOOMT1
     I              DBJLAA                          WOJLAA
     I              DBLZNY                          WOLZNY
     I              DBL1NY                          WOL1NY
     I              DBI4VL                          WOI4VL
     I              DBI0VL                          WOI0VL
     I              DBJMAA                          WOJMAA
     I              DBOKT1                          WOOKT1
     I              DBJNAA                          WOJNAA
     I              DBNPNY                          WONPNY
     I              DBJJAA                          WOJJAA
     I              DBJOAA                          WOJOAA
     I              DBI1VL                          WOI1VL
     I              DBOIT1                          WOOIT1
     I              DBJPAA                          WOJPAA
     I              DBJQAA                          WOJQAA
     I              DBJRAA                          WOJRAA
     I              DBJSAA                          WOJSAA
     I              DBJKAA                          WOJKAA
     I              DBI2VL                          WOI2VL
     I              DBI3VL                          WOI3VL
     I              DBOJT1                          WOOJT1
     I              DBNONY                          WONONY
     I              DBOJCD                          WOOJCD
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQECP01    E DSECP017L0
      * UPD : EDI DIST Allow Header     Update index
      * Renamed input format fields
     I              DUBNC3                          WFBNC3
     I              DUHHAA                          WFHHAA
     I              DULTNY                          WFLTNY
     I              DUFLGX                          WFFLGX
     I              DUJWAA                          WFJWAA
     I              DUMONY                          WFMONY
     I              DULUNY                          WFLUNY
     I              DUJHAA                          WFJHAA
     I              DUOHT1                          WFOHT1
     I              DULVNY                          WFLVNY
     I              DUIYVL                          WFIYVL
     I              DUJIAA                          WFJIAA
     I              DUIZVL                          WFIZVL
     I              DULZNY                          WFLZNY
     I              DUMVVL                          WFMVVL
     I              DURUAA                          WFRUAA
     I              DUAJU1                          WFAJU1
     I              DURVAA                          WFRVAA
      *
     IYARDCS      DS                            114
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQECP02    E DSECP019L0
      * UPD : EDI Dist Allow Cust Name  Update index
      * Renamed input format fields
     I              DWBNC3                          WIBNC3
     I              DWHHAA                          WIHHAA
     I              DWLSNY                          WILSNY
     I              DWOFT1                          WIOFT1
     I              DWOAT1                          WIOAT1
     I              DWJFAA                          WIJFAA
     I              DWOBT1                          WIOBT1
     I              DWOCT1                          WIOCT1
     I              DWODT1                          WIODT1
     I              DWOET1                          WIOET1
     I              DWJGAA                          WIJGAA
     I              DWOGT1                          WIOGT1
      *
     IQECP03    E DSECP018L0
      * UPD : EDI Dist Allow Detail     Update index
      * Renamed input format fields
     I              DBBNC3                          WOBNC3
     I              DBHHAA                          WOHHAA
     I              DBLWNY                          WOLWNY
     I              DBL0NY                          WOL0NY
     I              DBLXNY                          WOLXNY
     I              DBLYNY                          WOLYNY
     I              DBL7NY                          WOL7NY
     I              DBOLT1                          WOOLT1
     I              DBJTAA                          WOJTAA
     I              DBOMT1                          WOOMT1
     I              DBJLAA                          WOJLAA
     I              DBLZNY                          WOLZNY
     I              DBL1NY                          WOL1NY
     I              DBI4VL                          WOI4VL
     I              DBI0VL                          WOI0VL
     I              DBJMAA                          WOJMAA
     I              DBOKT1                          WOOKT1
     I              DBJNAA                          WOJNAA
     I              DBNPNY                          WONPNY
     I              DBJJAA                          WOJJAA
     I              DBJOAA                          WOJOAA
     I              DBI1VL                          WOI1VL
     I              DBOIT1                          WOOIT1
     I              DBJPAA                          WOJPAA
     I              DBJQAA                          WOJQAA
     I              DBJRAA                          WOJRAA
     I              DBJSAA                          WOJSAA
     I              DBJKAA                          WOJKAA
     I              DBI2VL                          WOI2VL
     I              DBI3VL                          WOI3VL
     I              DBOJT1                          WOOJT1
     I              DBNONY                          WONONY
     I              DBOJCD                          WOOJCD
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             20
      * KEY: Broker                    EDI Trade Partner
      * I :  Broker EDI Trade Partner
     I                                        1  20 P1DDT1
     IP2PARM      DS
      * I :  Date From             USR
     I                                    P   1   40P2JEDT
     IP3PARM      DS
      * I :  Date To               USR
     I                                    P   1   40P3JFDT
     IP4PARM      DS
      * I :  Broker Code
     I                                        1   6 P4HHAA
     IP5PARM      DS
      * B :  Total Amount
     I                                    P   1   62P5MFQT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Broker
     C           P2JEDT    PARM           WP0001  70       Date From
     C           P3JFDT    PARM           WP0002  70       Date To
     C           P4HHAA    PARM           WP0003  6        Broker Code
     C           P5MFQT    PARM P5MFQT    WP0004 112       Total Amount
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld EDI DistAllowance XF
      * RTV Brkr trading part RT - Broker  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Brkr trading part RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         P5MFQT           Total Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN WADDT1    WQSA01           Broker EDI Trad
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Broker EDI Trad
      * Setup key
     C                     MOVELP1DDT1    WQSA01           Broker EDI Trad
      * Establish starting position
     C           KRSSA     SETLL@C5RESR                    *
     C           KRSSA     READE@C5RESR                  90*
      * Data record not found
     C   90                MOVEL'USR3288' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Broker/Accrcde    RT - History Dtl Accrual  * 
     C                     EXSR SBRVGN
     C           KRSSA     READE@C5RESR                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Broker/Accrcde    RT - History Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications:
      * SAZ 10/05/16 added missing code in last record processing to get
      * EXTOL control Flag.
      * SAZ 06/02/11 Moved the Sales hist routine out so that it is read
      * detail rcd. Unit price routine was not getting the right price &
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHHAA    WQSB01           Broker Code
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Broker Code
     C                     KFLD           WBPTDT           HDA Actual Ship
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Broker Code
      * Setup key
     C                     MOVELWAHHAA    WQSB01           Broker Code
     C                     Z-ADDP2JEDT    WBPTDT           HDA Actual Ship
      * Establish starting position
     C           KPSSB     SETLL@ICCPS1                    *
     C           KRSSB     READE@ICCPS1                  90*
      * Data record not found
     C   90                MOVEL'USR1655' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First time process.
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Rtv Qty/Inv/Prc/Add   RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0002    P      A/R City
     C                     MOVELWL0006    YL0003    P      A/R State
     C                     MOVELWL0007    YL0004    P      A/R County Code
     C                     MOVELWL0008    YL0005    P      A/R Zip/Postal
     C                     Z-ADDWL0009    YL0006           Parent Customer
     C                     Z-ADDWL0010    YL0007           A/R Customer Nu
     C                     MOVELWL0011    YL0008    P      A/R Customer Na
     C                     Z-ADDWL0012    YL0009           Ship To Custome
     C                     MOVELWL0013    YL0010    P      Ship To Name
     C                     MOVELWL0014    YL0011    P      Ship To City
     C                     MOVELWL0015    YL0012    P      Ship To State C
     C                     MOVELWL0016    YL0013    P      Ship To Zip/Pos
     C                     MOVELWL0017    YL0014    P      Customer Purcha
     C                     Z-ADDWL0018    YL0015           Weight Ordered
     C                     Z-ADDWL0019    YL0016           Unit Price
     C                     Z-ADDWL0020    YL0017           Unit Price Orde
     C                     MOVELWL0021    YL0018    P      U/M - Base Pric
     C                     Z-ADDWL0022    YL0019           Invoice Date
     C                     Z-ADDWL0023    YL0020           Unit Cost Per P
     C                     Z-ADDWL0024    YL0021           Unit Cost Prici
     C                     Z-ADDWL0025    YL0022           Unit Weight Ord
     C                     Z-ADDWL0026    YL0023           Extended Amount
     C                     Z-ADDWL0027    YL0024           Accounting Year
     C                     Z-ADDWL0028    YL0025           Accounting Peri
     C                     Z-ADDWL0029    YL0026           OM Week
     C                     Z-ADDWL0030    YL0027           Quantity Billed
     C                     Z-ADDWL0031    YL0028           Weight Billed
     C                     Z-ADDWL0032    YL0029           Shipped Item Co
     C                     Z-ADDWL0033    YL0030           Shipping Compan
     C                     MOVELWL0034    YL0031    P      Order Detail Re
     C                     Z-ADDWL0035    YL0032           Invoice Number
     C                     Z-ADDWL0036    YL0033           Actual Shipped
     C                     MOVELWL0037    YL0034    P      Order Desc. Lin
     C                     Z-ADDYL0009    YL0035           USR Ship To Cus
     C                     Z-ADDYL0032    YL0036           USR Invoice Num
     C                     Z-ADDWBC4NB    YL0037           Order Number Sa
     C                     Z-ADDWBDPNB    YL0038           Order Sequence
     C                     Z-ADDWBUENB    YL0039           Order Secondary
     C                     Z-ADDWBDXNB    YL0040           Sequence Number
     C                     Z-ADDWBAIC3    YL0041           Company Number
     C                     Z-ADDYL0030    YL0042           USR Company Num
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     MOVELWBOJCD    YL0043           Accrual Code
     C                     MOVELWBHHAA    YL0044           Broker Code
     C                     END                             *FI
      * Quit when actual ship date greater than TO date.
      * CASE: DB1.HDA Actual Ship Date GT PAR.Date To               USR
     C           WBPTDT    IFGT P3JFDT                     *IF
      * Write header rcd or update
      * RTV Trade Partner Ctrl RT - Trade Partner Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWADDT1    WL0038    P      EDI Trading Par
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YL0045    P      Extol Control F
     C                     MOVELWL0040    YL0046    P      Live with ERP
      * RTV/CHG/CRT Dist Allo RT - EDI DIST Allow Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0041           Company
     C                     MOVELYL0044    WL0042    P      Broker Code
     C                     Z-ADDYL0036    WL0043           D-BPT02-INV SUR
     C                     MOVEL*BLANK    WL0044           D-EDI INV PROC
     C                     MOVELWADDT1    WL0045    P      D-TRADE PARTNER
     C                     Z-ADDYL0032    WL0046           D-INVOICE NUMBE
     C                     Z-ADDYL0019    WL0047           D-BPT03-INVOICE
     C                     MOVEL'PO'      WL0048    P      D-REF01-REF NBR
     C                     MOVELYL0014    WL0049    P      D-REF02 PO NUMB
     C                     Z-ADDYL0047    WL0050           D-CTT01 LIN SEG
     C                     Z-ADDYL0048    WL0051           D-CTT02-TOT QTY
     C                     MOVEL'5'       WL0052    P      D-AMT01-AMT QUA
     C                     Z-ADDYL0049    WL0053           D-AMT02-INVOICE
     C                     Z-ADDYL0033    WL0054           D-Actual Ship D
     C                     Z-ADDYL0050    WL0055           D-Unused amount
     C                     MOVELYL0051    WL0056    P      D-Unused code
     C                     MOVELYL0052    WL0057    P      D-Unused text
     C                     MOVELYL0045    WL0058    P      D-Unused code 2
     C                     EXSR SERVGN
     C                     ADD  YL0049    P5MFQT           Total Amount
     C                     Z-ADD0         YL0047           Count Records
     C                     Z-ADD0         YL0048           Weight Billed A
     C                     Z-ADD0         YL0049           Invoiced Amount
      * Write Bill To Name/Address record
     C                     MOVEL'BT'      YL0056           USR Address Qua
      * RTV Cust A/r,Sls Rte  RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0059           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YN0001    P      Customer Name
     C                     Z-ADDWL0061    YL0007           A/R Customer Nu
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0062           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YL0057    P      Customer Name
     C                     MOVELWL0064    YL0058    P      Address Line 1
     C                     MOVELWL0065    YL0059    P      Address Line 2
     C                     MOVELWL0066    YN0002    P      Address Line 3
     C                     MOVELWL0067    YL0060    P      City
     C                     MOVELWL0068    YL0061    P      State Code
     C                     MOVELWL0069    YL0062    P      Zip/Postal Code
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0070           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YN0003    P      Internet Passwo
     C                     MOVELWL0072    YN0004    P      Email Address
     C                     MOVELWL0073    YN0005    P      Email User ID
     C                     MOVELWL0074    YN0006    P      EDI Trading Par
     C                     MOVELWL0075    YL0063    P      EDI Cust Duns N
     C                     MOVELWL0076    YN0007    P      EDI Warehouse/S
     C                     MOVELWL0077    YN0008    P      State Tax ID
     C                     MOVELWL0078    YN0009    P      Cust Shipping T
     C                     MOVELWL0079    YN0010    P      One Invoice Per
     C                     MOVELWL0080    YN0011    P      EDI Advanced Sh
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0063    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
      * Ship to address
     C                     MOVEL'ST'      YL0056           USR Address Qua
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0062           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YL0057    P      Customer Name
     C                     MOVELWL0064    YL0058    P      Address Line 1
     C                     MOVELWL0065    YL0059    P      Address Line 2
     C                     MOVELWL0066    YN0002    P      Address Line 3
     C                     MOVELWL0067    YL0060    P      City
     C                     MOVELWL0068    YL0061    P      State Code
     C                     MOVELWL0069    YL0062    P      Zip/Postal Code
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0070           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YN0003    P      Internet Passwo
     C                     MOVELWL0072    YN0004    P      Email Address
     C                     MOVELWL0073    YN0005    P      Email User ID
     C                     MOVELWL0074    YN0006    P      EDI Trading Par
     C                     MOVELWL0075    YL0063    P      EDI Cust Duns N
     C                     MOVELWL0076    YN0007    P      EDI Warehouse/S
     C                     MOVELWL0077    YN0008    P      State Tax ID
     C                     MOVELWL0078    YN0009    P      Cust Shipping T
     C                     MOVELWL0079    YN0010    P      One Invoice Per
     C                     MOVELWL0080    YN0011    P      EDI Advanced Sh
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0063    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
      * Ship From Address
     C                     MOVEL'SF'      YL0056           USR Address Qua
      * RTV Company Address    RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0042    WL0093           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    YL0057    P      Name
     C                     MOVELWL0095    YL0058    P      Address Line 1
     C                     MOVELWL0096    YL0059    P      Address Line 2
     C                     MOVELWL0097    YN0002    P      Address Line 3
     C                     MOVELWL0098    YL0060    P      City
     C                     MOVELWL0099    YL0062    P      Zip/Postal Code
     C                     MOVELWL0100    YL0061    P      State Code
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0042    WL0101           Company Number
     C                     MOVEL@CN,001   WL0102    P      Company Value C
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0103    YL0064    P      System Value Al
      * Move company to a 4 position numeric
     C                     Z-ADDYL0030    YL0065           Calc 4
      * Move company to a 4 position numeric to a alpha 4 field
     C                     MOVELYL0065    YL0066           Amount Right 4
     C                     MOVELYL0064    YL0067           Text USR 9
     C                     Z-ADD0         ZQ      50
     C           YL0067    CAT  YL0066:ZQ YL0068    P      D-N104-ID CODE
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0068    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
      * Write Header and Cust records when key changes.
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Company Number NE LCL.Company Number
      *   |- c2    : DB1.Order Number NE LCL.Order Number Saved USR
      *   '-
     C           WBAIC3    IFNE YL0041                     *IF
     C           WBC4NB    ORNE YL0037                     *OR
      * Create or update header rcd
      * RTV Trade Partner Ctrl RT - Trade Partner Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWADDT1    WL0038    P      EDI Trading Par
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YL0045    P      Extol Control F
     C                     MOVELWL0040    YL0046    P      Live with ERP
      * RTV/CHG/CRT Dist Allo RT - EDI DIST Allow Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0041           Company
     C                     MOVELWAHHAA    WL0042    P      Broker Code
     C                     Z-ADDYL0036    WL0043           D-BPT02-INV SUR
     C                     MOVEL*BLANK    WL0044           D-EDI INV PROC
     C                     MOVELWADDT1    WL0045    P      D-TRADE PARTNER
     C                     Z-ADDYL0032    WL0046           D-INVOICE NUMBE
     C                     Z-ADDYL0019    WL0047           D-BPT03-INVOICE
     C                     MOVEL'PO'      WL0048    P      D-REF01-REF NBR
     C                     MOVELYL0014    WL0049    P      D-REF02 PO NUMB
     C                     Z-ADDYL0047    WL0050           D-CTT01 LIN SEG
     C                     Z-ADDYL0048    WL0051           D-CTT02-TOT QTY
     C                     MOVEL'5'       WL0052    P      D-AMT01-AMT QUA
     C                     Z-ADDYL0049    WL0053           D-AMT02-INVOICE
     C                     Z-ADDYL0033    WL0054           D-Actual Ship D
     C                     Z-ADDYL0050    WL0055           D-Unused amount
     C                     MOVELYL0051    WL0056    P      D-Unused code
     C                     MOVELYL0052    WL0057    P      D-Unused text
     C                     MOVELYL0045    WL0058    P      D-Unused code 2
     C                     EXSR SERVGN
     C                     ADD  YL0049    P5MFQT           Total Amount
      * Initialize accumulators.
     C                     Z-ADD0         YL0047           Count Records
     C                     Z-ADD0         YL0048           Weight Billed A
     C                     Z-ADD0         YL0049           Invoiced Amount
      * Write Customer Addy records.
      * Bill to address
     C                     MOVEL'BT'      YL0056           USR Address Qua
      * RTV Cust A/r,Sls Rte  RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0059           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YN0001    P      Customer Name
     C                     Z-ADDWL0061    YL0007           A/R Customer Nu
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0062           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YL0057    P      Customer Name
     C                     MOVELWL0064    YL0058    P      Address Line 1
     C                     MOVELWL0065    YL0059    P      Address Line 2
     C                     MOVELWL0066    YN0002    P      Address Line 3
     C                     MOVELWL0067    YL0060    P      City
     C                     MOVELWL0068    YL0061    P      State Code
     C                     MOVELWL0069    YL0062    P      Zip/Postal Code
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0070           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YN0003    P      Internet Passwo
     C                     MOVELWL0072    YN0004    P      Email Address
     C                     MOVELWL0073    YN0005    P      Email User ID
     C                     MOVELWL0074    YN0006    P      EDI Trading Par
     C                     MOVELWL0075    YL0063    P      EDI Cust Duns N
     C                     MOVELWL0076    YN0007    P      EDI Warehouse/S
     C                     MOVELWL0077    YN0008    P      State Tax ID
     C                     MOVELWL0078    YN0009    P      Cust Shipping T
     C                     MOVELWL0079    YN0010    P      One Invoice Per
     C                     MOVELWL0080    YN0011    P      EDI Advanced Sh
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0063    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
      * Ship to address
     C                     MOVEL'ST'      YL0056           USR Address Qua
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0062           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YL0057    P      Customer Name
     C                     MOVELWL0064    YL0058    P      Address Line 1
     C                     MOVELWL0065    YL0059    P      Address Line 2
     C                     MOVELWL0066    YN0002    P      Address Line 3
     C                     MOVELWL0067    YL0060    P      City
     C                     MOVELWL0068    YL0061    P      State Code
     C                     MOVELWL0069    YL0062    P      Zip/Postal Code
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0070           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YN0003    P      Internet Passwo
     C                     MOVELWL0072    YN0004    P      Email Address
     C                     MOVELWL0073    YN0005    P      Email User ID
     C                     MOVELWL0074    YN0006    P      EDI Trading Par
     C                     MOVELWL0075    YL0063    P      EDI Cust Duns N
     C                     MOVELWL0076    YN0007    P      EDI Warehouse/S
     C                     MOVELWL0077    YN0008    P      State Tax ID
     C                     MOVELWL0078    YN0009    P      Cust Shipping T
     C                     MOVELWL0079    YN0010    P      One Invoice Per
     C                     MOVELWL0080    YN0011    P      EDI Advanced Sh
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0063    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
      * Ship From Address
     C                     MOVEL'SF'      YL0056           USR Address Qua
      * RTV Company Address    RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0042    WL0093           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    YL0057    P      Name
     C                     MOVELWL0095    YL0058    P      Address Line 1
     C                     MOVELWL0096    YL0059    P      Address Line 2
     C                     MOVELWL0097    YN0002    P      Address Line 3
     C                     MOVELWL0098    YL0060    P      City
     C                     MOVELWL0099    YL0062    P      Zip/Postal Code
     C                     MOVELWL0100    YL0061    P      State Code
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0042    WL0101           Company Number
     C                     MOVEL@CN,001   WL0102    P      Company Value C
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0103    YL0064    P      System Value Al
     C                     MOVEL'0000'    YL0069           Text USR 4
     C                     MOVELYL0064    YL0067           Text USR 9
     C                     Z-ADD0         ZQ      50
     C           YL0067    CAT  YL0069:ZQ YL0064    P      D-N104-DUNS NBR
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0064    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
     C                     END                             *FI
      * Rtv Qty/Inv/Prc/Add   RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0002    P      A/R City
     C                     MOVELWL0006    YL0003    P      A/R State
     C                     MOVELWL0007    YL0004    P      A/R County Code
     C                     MOVELWL0008    YL0005    P      A/R Zip/Postal
     C                     Z-ADDWL0009    YL0006           Parent Customer
     C                     Z-ADDWL0010    YL0007           A/R Customer Nu
     C                     MOVELWL0011    YL0008    P      A/R Customer Na
     C                     Z-ADDWL0012    YL0009           Ship To Custome
     C                     MOVELWL0013    YL0010    P      Ship To Name
     C                     MOVELWL0014    YL0011    P      Ship To City
     C                     MOVELWL0015    YL0012    P      Ship To State C
     C                     MOVELWL0016    YL0013    P      Ship To Zip/Pos
     C                     MOVELWL0017    YL0014    P      Customer Purcha
     C                     Z-ADDWL0018    YL0015           Weight Ordered
     C                     Z-ADDWL0019    YL0016           Unit Price
     C                     Z-ADDWL0020    YL0017           Unit Price Orde
     C                     MOVELWL0021    YL0018    P      U/M - Base Pric
     C                     Z-ADDWL0022    YL0019           Invoice Date
     C                     Z-ADDWL0023    YL0020           Unit Cost Per P
     C                     Z-ADDWL0024    YL0021           Unit Cost Prici
     C                     Z-ADDWL0025    YL0022           Unit Weight Ord
     C                     Z-ADDWL0026    YL0023           Extended Amount
     C                     Z-ADDWL0027    YL0024           Accounting Year
     C                     Z-ADDWL0028    YL0025           Accounting Peri
     C                     Z-ADDWL0029    YL0026           OM Week
     C                     Z-ADDWL0030    YL0027           Quantity Billed
     C                     Z-ADDWL0031    YL0028           Weight Billed
     C                     Z-ADDWL0032    YL0029           Shipped Item Co
     C                     Z-ADDWL0033    YL0030           Shipping Compan
     C                     MOVELWL0034    YL0031    P      Order Detail Re
     C                     Z-ADDWL0035    YL0032           Invoice Number
     C                     Z-ADDWL0036    YL0033           Actual Shipped
     C                     MOVELWL0037    YL0034    P      Order Desc. Lin
      * Save new order stuff
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Company Number NE LCL.Company Number
      *   |- c2    : DB1.Order Number NE LCL.Order Number Saved USR
      *   '-
     C           WBAIC3    IFNE YL0041                     *IF
     C           WBC4NB    ORNE YL0037                     *OR
     C                     Z-ADDYL0009    YL0035           USR Ship To Cus
     C                     Z-ADDYL0032    YL0036           USR Invoice Num
     C                     Z-ADDWBC4NB    YL0037           Order Number Sa
     C                     Z-ADDWBDPNB    YL0038           Order Sequence
     C                     Z-ADDWBUENB    YL0039           Order Secondary
     C                     Z-ADDWBDXNB    YL0040           Sequence Number
     C                     Z-ADDWBAIC3    YL0041           Company Number
     C                     Z-ADDYL0030    YL0042           USR Company Num
     C                     MOVELWBHHAA    YL0044           Broker Code
     C                     MOVELWBOJCD    YL0043           Accrual Code
     C                     END                             *FI
      * A rcd is written to ECP018 for every Accrual record
     C                     ADD  1         YL0047           Count Records
      * RTV Federal ID         RT - Company Name and Address  * 
     C                     EXSR SNRVGN
      * -----------
      * 07/08/08 PKD Using the System Value for the name
      * RTV System Value Alpha RT - System Values  * LCL D-N102-ITEM MANU
      * Move input parameters to subroutine local variables.
     C                     MOVEL'ORGNAM'  WL0104    P      System Value Co
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0105    YL0071    P      System Value Al
      * RTV System Value Alpha RT - System Values  * D-N104-DUNS NBR
      * Move input parameters to subroutine local variables.
     C                     MOVEL'ORGDUNS' WL0104    P      System Value Co
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0105    YL0064    P      System Value Al
      * -----------
      * Rtv Item Description   RT - Company Item  * 
     C                     EXSR SPRVGN
      * Cat Federal ID with the item code to make UPC
     C                     MOVELYL0070    YL0073           USR Text 7
     C                     Z-ADDWBHGCD    YL0074           Item Code 5.0
     C                     MOVEL*BLANK    YL0075           Item Code 5A
     C                     MOVELYL0074    YL0075           Item Code 5A
     C                     Z-ADDWBBKPR    YL0076           D-ITA06-ALLW DO
     C                     Z-ADDWBAYVA    YL0077           D-ITA07-TOT DOL
     C           WBBKPR    MULT 100       YL0078           D-ITA09-Allow %
     C                     Z-ADD0         ZQ      50
     C           YL0073    CAT  YL0075:ZQ YL0079    P      Item Meat Cost
      * Calculate net price per unit
      * CASE: LCL.U/M - Base Price is Carcass Hundred Weight
     C           YL0018    IFEQ 'CW'                       *IF
     C           YL0016    DIV  100       YL0080           D-UIT02-NET PRI
     C                     Z-ADDWBBYWG    YL0081           D-QTY ORDERED
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0016    YL0080           D-UIT02-NET PRI
     C                     Z-ADDYL0027    YL0081           D-QTY ORDERED
     C                     END                             *FI
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBKC7    WL0070           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YN0003    P      Internet Passwo
     C                     MOVELWL0072    YN0004    P      Email Address
     C                     MOVELWL0073    YN0005    P      Email User ID
     C                     MOVELWL0074    YL0082    P      EDI Trading Par
     C                     MOVELWL0075    YL0063    P      EDI Cust Duns N
     C                     MOVELWL0076    YN0007    P      EDI Warehouse/S
     C                     MOVELWL0077    YN0008    P      State Tax ID
     C                     MOVELWL0078    YN0009    P      Cust Shipping T
     C                     MOVELWL0079    YN0010    P      One Invoice Per
     C                     MOVELWL0080    YN0011    P      EDI Advanced Sh
      * CASE: DB1.Accrual Rate is Negative
     C           WBBKPR    IFLT 0                          *IF
      * Sending blank until we know what they want here.
     C                     MOVEL*BLANK    YL0083           D-1TA13-DESC IT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0083           D-1TA13-DESC IT
     C                     END                             *FI
      * CRT Dist Allow Dtl    CR - EDI Dist Allow Detail  * 
     C                     EXSR SQCRRC
      * Accumulate totals for Header Rcd.
     C                     ADD  WBAYVA    YL0049           Invoiced Amount
     C                     ADD  WBBYWG    YL0048           Weight Billed A
     C                     Z-ADDYL0032    YL0036           USR Invoice Num
     C                     Z-ADDWBC4NB    YL0037           Order Number Sa
     C                     Z-ADDWBDPNB    YL0038           Order Sequence
     C                     Z-ADDWBUENB    YL0039           Order Secondary
     C                     Z-ADDWBDXNB    YL0040           Sequence Number
     C                     Z-ADDWBAIC3    YL0041           Company Number
     C           KRSSB     READE@ICCPS1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Create or update header record
      * RTV Trade Partner Ctrl RT - Trade Partner Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWADDT1    WL0038    P      EDI Trading Par
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YL0045    P      Extol Control F
     C                     MOVELWL0040    YL0046    P      Live with ERP
      * RTV/CHG/CRT Dist Allo RT - EDI DIST Allow Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0041           Company
     C                     MOVELWBHHAA    WL0042    P      Broker Code
     C                     Z-ADDYL0036    WL0043           D-BPT02-INV SUR
     C                     MOVEL*BLANK    WL0044           D-EDI INV PROC
     C                     MOVELWADDT1    WL0045    P      D-TRADE PARTNER
     C                     Z-ADDYL0032    WL0046           D-INVOICE NUMBE
     C                     Z-ADDYL0019    WL0047           D-BPT03-INVOICE
     C                     MOVEL'PO'      WL0048    P      D-REF01-REF NBR
     C                     MOVELYL0014    WL0049    P      D-REF02 PO NUMB
     C                     Z-ADDYL0047    WL0050           D-CTT01 LIN SEG
     C                     Z-ADDYL0048    WL0051           D-CTT02-TOT QTY
     C                     MOVEL'5'       WL0052    P      D-AMT01-AMT QUA
     C                     Z-ADDYL0049    WL0053           D-AMT02-INVOICE
     C                     Z-ADDP2JEDT    WL0054           D-Actual Ship D
     C                     Z-ADDYL0050    WL0055           D-Unused amount
     C                     MOVELYL0051    WL0056    P      D-Unused code
     C                     MOVELYL0052    WL0057    P      D-Unused text
     C                     MOVELYL0045    WL0058    P      D-Unused code 2
     C                     EXSR SERVGN
     C                     ADD  YL0049    P5MFQT           Total Amount
     C                     Z-ADD0         YL0047           Count Records
     C                     Z-ADD0         YL0048           Weight Billed A
     C                     Z-ADD0         YL0049           Invoiced Amount
      * Write Customer Addy records.
     C                     MOVEL'BT'      YL0056           USR Address Qua
      * RTV Cust A/r,Sls Rte  RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0059           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YN0001    P      Customer Name
     C                     Z-ADDWL0061    YL0007           A/R Customer Nu
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0062           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YL0057    P      Customer Name
     C                     MOVELWL0064    YL0058    P      Address Line 1
     C                     MOVELWL0065    YL0059    P      Address Line 2
     C                     MOVELWL0066    YN0002    P      Address Line 3
     C                     MOVELWL0067    YL0060    P      City
     C                     MOVELWL0068    YL0061    P      State Code
     C                     MOVELWL0069    YL0062    P      Zip/Postal Code
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0070           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YN0003    P      Internet Passwo
     C                     MOVELWL0072    YN0004    P      Email Address
     C                     MOVELWL0073    YN0005    P      Email User ID
     C                     MOVELWL0074    YN0006    P      EDI Trading Par
     C                     MOVELWL0075    YL0063    P      EDI Cust Duns N
     C                     MOVELWL0076    YN0007    P      EDI Warehouse/S
     C                     MOVELWL0077    YN0008    P      State Tax ID
     C                     MOVELWL0078    YN0009    P      Cust Shipping T
     C                     MOVELWL0079    YN0010    P      One Invoice Per
     C                     MOVELWL0080    YN0011    P      EDI Advanced Sh
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0063    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
      * Ship to address
     C                     MOVEL'ST'      YL0056           USR Address Qua
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0062           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YL0057    P      Customer Name
     C                     MOVELWL0064    YL0058    P      Address Line 1
     C                     MOVELWL0065    YL0059    P      Address Line 2
     C                     MOVELWL0066    YN0002    P      Address Line 3
     C                     MOVELWL0067    YL0060    P      City
     C                     MOVELWL0068    YL0061    P      State Code
     C                     MOVELWL0069    YL0062    P      Zip/Postal Code
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0070           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YN0003    P      Internet Passwo
     C                     MOVELWL0072    YN0004    P      Email Address
     C                     MOVELWL0073    YN0005    P      Email User ID
     C                     MOVELWL0074    YN0006    P      EDI Trading Par
     C                     MOVELWL0075    YL0063    P      EDI Cust Duns N
     C                     MOVELWL0076    YN0007    P      EDI Warehouse/S
     C                     MOVELWL0077    YN0008    P      State Tax ID
     C                     MOVELWL0078    YN0009    P      Cust Shipping T
     C                     MOVELWL0079    YN0010    P      One Invoice Per
     C                     MOVELWL0080    YN0011    P      EDI Advanced Sh
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0063    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
      * Ship From Address
     C                     MOVEL'SF'      YL0056           USR Address Qua
      * RTV Company Address    RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0042    WL0093           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    YL0057    P      Name
     C                     MOVELWL0095    YL0058    P      Address Line 1
     C                     MOVELWL0096    YL0059    P      Address Line 2
     C                     MOVELWL0097    YN0002    P      Address Line 3
     C                     MOVELWL0098    YL0060    P      City
     C                     MOVELWL0099    YL0062    P      Zip/Postal Code
     C                     MOVELWL0100    YL0061    P      State Code
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0042    WL0101           Company Number
     C                     MOVEL@CN,001   WL0102    P      Company Value C
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0103    YL0064    P      System Value Al
      * Move company to a 4 position numeric
     C                     Z-ADDYL0030    YL0065           Calc 4
      * Move company to a 4 position numeric to a alpha 4 field
     C                     MOVELYL0065    YL0066           Amount Right 4
     C                     MOVELYL0064    YL0067           Text USR 9
     C                     Z-ADD0         ZQ      50
     C           YL0067    CAT  YL0066:ZQ YL0068    P      D-N104-ID CODE
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0041    WL0081           Company
     C                     MOVELWBHHAA    WL0082    P      Broker Code
     C                     Z-ADDYL0036    WL0083           D-INVOICE SURRO
     C                     MOVELYL0056    WL0084    P      D-N101-ADDRESS
     C                     MOVELYL0057    WL0085    P      D-N102-NAME
     C                     MOVEL'9'       WL0086    P      D-N103-ID CODE
     C                     MOVELYL0068    WL0087    P      D-N104-ID CODE
     C                     MOVELYL0058    WL0088    P      D-N301-ADDRESS
     C                     MOVELYL0059    WL0089    P      D-N302-ADDRESS
     C                     MOVELYL0060    WL0090    P      D-N401-CITY
     C                     MOVELYL0061    WL0091    P      D-N402-STATE
     C                     MOVELYL0062    WL0092    P      D-N403-POSTAL C
     C                     EXSR SKCRRC
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Qty/Inv/Prc/Add   RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0001    WCAIC3           Company Number
     C                     Z-ADDWL0002    WCC4NB           Order Number
     C                     Z-ADDWL0003    WCDPNB           Order Sequence
     C                     Z-ADDWL0004    WCUENB           Order Secondary
      * Establish starting position
     C           KRSSC     CHAIN@FHSTD3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           A/R City
     C                     MOVEL*BLANK    WL0006           A/R State
     C                     MOVEL*BLANK    WL0007           A/R County Code
     C                     MOVEL*BLANK    WL0008           A/R Zip/Postal
     C                     Z-ADD*ZERO     WL0009           Parent Customer
     C                     Z-ADD*ZERO     WL0010           A/R Customer Nu
     C                     MOVEL*BLANK    WL0011           A/R Customer Na
     C                     Z-ADD*ZERO     WL0012           Ship To Custome
     C                     MOVEL*BLANK    WL0013           Ship To Name
     C                     MOVEL*BLANK    WL0014           Ship To City
     C                     MOVEL*BLANK    WL0015           Ship To State C
     C                     MOVEL*BLANK    WL0016           Ship To Zip/Pos
     C                     MOVEL*BLANK    WL0017           Customer Purcha
     C                     Z-ADD*ZERO     WL0018           Weight Ordered
     C                     Z-ADD*ZERO     WL0019           Unit Price
     C                     Z-ADD*ZERO     WL0020           Unit Price Orde
     C                     MOVEL*BLANK    WL0021           U/M - Base Pric
     C                     Z-ADD*ZERO     WL0022           Invoice Date
     C                     Z-ADD*ZERO     WL0023           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0024           Unit Cost Prici
     C                     Z-ADD*ZERO     WL0025           Unit Weight Ord
     C                     Z-ADD*ZERO     WL0026           Extended Amount
     C                     Z-ADD*ZERO     WL0027           Accounting Year
     C                     Z-ADD*ZERO     WL0028           Accounting Peri
     C                     Z-ADD*ZERO     WL0029           OM Week
     C                     Z-ADD*ZERO     WL0030           Quantity Billed
     C                     Z-ADD*ZERO     WL0031           Weight Billed
     C                     Z-ADD*ZERO     WL0032           Shipped Item Co
     C                     Z-ADD*ZERO     WL0033           Shipping Compan
     C                     MOVEL*BLANK    WL0034           Order Detail Re
     C                     Z-ADD*ZERO     WL0035           Invoice Number
     C                     Z-ADD*ZERO     WL0036           Actual Shipped
     C                     MOVEL*BLANK    WL0037           Order Desc. Lin
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCMONA    WL0005           A/R City
     C                     MOVELWCRJCD    WL0006           A/R State
     C                     MOVELWCRKCD    WL0007           A/R County Code
     C                     MOVELWCGPTX    WL0008           A/R Zip/Postal
     C                     Z-ADDWCBTC7    WL0009           Parent Customer
     C                     Z-ADDWCANC7    WL0010           A/R Customer Nu
     C                     MOVELWCAQTX    WL0011           A/R Customer Na
     C                     Z-ADDWCBKC7    WL0012           Ship To Custome
     C                     MOVELWCBRTX    WL0013           Ship To Name
     C                     MOVELWCHNNA    WL0014           Ship To City
     C                     MOVELWCDBCD    WL0015           Ship To State C
     C                     MOVELWCCKTX    WL0016           Ship To Zip/Pos
     C                     MOVELWCBCNA    WL0017           Customer Purcha
     C                     Z-ADDWCD0WG    WL0018           Weight Ordered
     C                     Z-ADDWCAKPR    WL0019           Unit Price
     C                     Z-ADDWCAUPR    WL0020           Unit Price Orde
     C                     MOVELWCCRCD    WL0021           U/M - Base Pric
     C                     Z-ADDWCAWDT    WL0022           Invoice Date
     C                     Z-ADDWCAGCS    WL0023           Unit Cost Per P
     C                     Z-ADDWCAQCS    WL0024           Unit Cost Prici
     C                     Z-ADDWCAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWCAYVA    WL0026           Extended Amount
     C                     Z-ADDWCESNB    WL0027           Accounting Year
     C                     Z-ADDWCETNB    WL0028           Accounting Peri
     C                     Z-ADDWCBZNB    WL0029           OM Week
     C                     Z-ADDWCEXQT    WL0030           Quantity Billed
     C                     Z-ADDWCBYWG    WL0031           Weight Billed
     C                     Z-ADDWCS5NB    WL0032           Shipped Item Co
     C                     Z-ADDWCR8NB    WL0033           Shipping Compan
     C                     MOVELWCRMCD    WL0034           Order Detail Re
     C                     Z-ADDWCCONB    WL0035           Invoice Number
     C                     Z-ADDWCGNDT    WL0036           Actual Shipped
     C                     MOVELWCG7NA    WL0037           Order Desc. Lin
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Trade Partner Ctrl RT - Trade Partner Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDJ5NX           EDI Trading Par
      * Setup key
     C                     MOVELWL0038    WDJ5NX           EDI Trading Par
      * Establish starting position
     C           KRSSD     CHAIN@B8REVF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4842' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0039           Extol Control F
     C                     MOVEL*BLANK    WL0040           Live with ERP
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDCBSC    WL0039           Extol Control F
     C                     MOVELWDCCSC    WL0040           Live with ERP
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV/CHG/CRT Dist Allo RT - EDI DIST Allow Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBNC3           Company
     C                     KFLD           WEHHAA           Broker Code
     C                     KFLD           WELTNY           D-BPT02-INV SUR
      * Setup key
     C                     Z-ADDWL0041    WEBNC3           Company
     C                     MOVELWL0042    WEHHAA           Broker Code
     C                     Z-ADDWL0043    WELTNY           D-BPT02-INV SUR
      * Establish starting position
     C           KRSSE     CHAIN@P017ZI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3930' W0RTN   7
      * USER: Processing if Data record not found
      * CRT DIST Allow Header CR - EDI DIST Allow Header  * 
     C                     EXSR SFCRRC
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEIZVL    ADD  WL0053    YL0053           D-AMT02-INVOICE
     C           WEIYVL    ADD  WL0051    YL0054           D-CTT02-TOT QTY
     C           WELVNY    ADD  WL0050    YL0055           D-CTT01 LIN SEG
      * CHG DIST Allow Header CH - EDI DIST Allow Header  * 
     C                     EXSR SGCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT DIST Allow Header CR - EDI DIST Allow Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DUCPSZ
     C                     Z-ADDWL0041    WFBNC3           Company
     C                     MOVELWL0042    WFHHAA           Broker Code
     C                     Z-ADDWL0043    WFLTNY           D-BPT02-INV SUR
     C                     MOVELWL0044    WFFLGX           D-EDI INV PROC
     C                     MOVELWL0045    WFJWAA           D-TRADE PARTNER
     C                     Z-ADDWL0046    WFMONY           D-INVOICE NUMBE
     C                     Z-ADDWL0047    WFLUNY           D-BPT03-INVOICE
     C                     MOVELWL0048    WFJHAA           D-REF01-REF NBR
     C                     MOVELWL0049    WFOHT1           D-REF02 PO NUMB
     C                     Z-ADDWL0050    WFLVNY           D-CTT01 LIN SEG
     C                     Z-ADDWL0051    WFIYVL           D-CTT02-TOT QTY
     C                     MOVELWL0052    WFJIAA           D-AMT01-AMT QUA
     C                     Z-ADDWL0053    WFIZVL           D-AMT02-INVOICE
     C                     Z-ADDWL0054    WFLZNY           D-Actual Ship D
     C                     Z-ADDWL0055    WFMVVL           D-Unused amount
     C                     MOVELWL0056    WFRUAA           D-Unused code
     C                     MOVELWL0057    WFAJU1           D-Unused text
     C                     MOVELWL0058    WFRVAA           D-Unused code 2
      *
     C           KLCRSF    KLIST
     C                     KFLD           WFBNC3           Company
     C                     KFLD           WFHHAA           Broker Code
     C                     KFLD           WFLTNY           D-BPT02-INV SUR
      * Check for duplicate primary key
     C           KLCRSF    SETLL@DUCPSZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3931' W0RTN   7
      * Send message 'EDI DIST Allow Header  EX'
     C                     MOVEL'USR3931' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@DUCPSZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * CHG DIST Allow Header CH - EDI DIST Allow Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  90       D-BPT02-INV SUR
     C                     MOVEL*BLANK    WN0002  1        D-EDI INV PROC
     C                     MOVEL*BLANK    WN0003  6        D-TRADE PARTNER
     C                     Z-ADD*ZERO     WN0004  90       D-INVOICE NUMBE
     C                     Z-ADD*ZERO     WN0005  70       D-BPT03-INVOICE
     C                     MOVEL*BLANK    WN0006  2        D-REF01-REF NBR
     C                     MOVEL*BLANK    WN0007 22        D-REF02 PO NUMB
     C                     Z-ADD*ZERO     WN0008  50       D-CTT01 LIN SEG
     C                     Z-ADD*ZERO     WN0009 112       D-CTT02-TOT QTY
     C                     MOVEL*BLANK    WN0010  1        D-AMT01-AMT QUA
     C                     Z-ADD*ZERO     WN0011 152       D-AMT02-INVOICE
     C                     Z-ADD*ZERO     WN0012  70       D-Actual Ship D
     C                     Z-ADD*ZERO     WN0013 112       D-Unused amount
     C                     MOVEL*BLANK    WN0014  6        D-Unused code
     C                     MOVEL*BLANK    WN0015 25        D-Unused text
     C                     MOVEL*BLANK    WN0016  2        D-Unused code 2
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @DUCPSZ
     C                     Z-ADDWEBNC3    WFBNC3           Company
     C                     MOVELWEHHAA    WFHHAA    P      Broker Code
     C                     Z-ADDWN0001    WFLTNY           D-BPT02-INV SUR
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFBNC3           Company
     C                     KFLD           WFHHAA           Broker Code
     C                     KFLD           WFLTNY           D-BPT02-INV SUR
     C           KLCHSG    CHAIN@DUCPSZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP017L0'MDACP
     C                     MOVEL'@DUCPSZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QECP01    YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QECP01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@DUCPSZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKECP017L0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Cust A/r,Sls Rte  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0059    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAYTX    WL0060           Customer Name
     C                     Z-ADDWGANC7    WL0061           A/R Customer Nu
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0062    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAYTX    WL0063           Customer Name
     C                     MOVELWGACNA    WL0064           Address Line 1
     C                     MOVELWGADNA    WL0065           Address Line 2
     C                     MOVELWGAENA    WL0066           Address Line 3
     C                     MOVELWGAJNA    WL0067           City
     C                     MOVELWGBGCD    WL0068           State Code
     C                     MOVELWGBTTX    WL0069           Zip/Postal Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv All Values        RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0070    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0071           Internet Passwo
     C                     MOVEL*BLANK    WL0072           Email Address
     C                     MOVEL*BLANK    WL0073           Email User ID
     C                     MOVEL*BLANK    WL0074           EDI Trading Par
     C                     MOVEL*BLANK    WL0075           EDI Cust Duns N
     C                     MOVEL*BLANK    WL0076           EDI Warehouse/S
     C                     MOVEL*BLANK    WL0077           State Tax ID
     C                     MOVEL*BLANK    WL0078           Cust Shipping T
     C                     MOVEL*BLANK    WL0079           One Invoice Per
     C                     MOVEL*BLANK    WL0080           EDI Advanced Sh
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHUFTX    WL0071           Internet Passwo
     C                     MOVELWHUGTX    WL0072           Email Address
     C                     MOVELWHPFNA    WL0073           Email User ID
     C                     MOVELWHJ5NX    WL0074           EDI Trading Par
     C                     MOVELWHU5TX    WL0075           EDI Cust Duns N
     C                     MOVELWHU6TX    WL0076           EDI Warehouse/S
     C                     MOVELWHW0TX    WL0077           State Tax ID
     C                     MOVELWHHSSX    WL0078           Cust Shipping T
     C                     MOVELWHHUSX    WL0079           One Invoice Per
     C                     MOVELWHHVSX    WL0080           EDI Advanced Sh
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT Dist Allow Cus    CR - EDI Dist Allow Cust Name  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DTCPSW
     C                     Z-ADDWL0081    WIBNC3           Company
     C                     MOVELWL0082    WIHHAA           Broker Code
     C                     Z-ADDWL0083    WILSNY           D-INVOICE SURRO
     C                     MOVELWL0084    WIOFT1           D-N101-ADDRESS
     C                     MOVELWL0085    WIOAT1           D-N102-NAME
     C                     MOVELWL0086    WIJFAA           D-N103-ID CODE
     C                     MOVELWL0087    WIOBT1           D-N104-ID CODE
     C                     MOVELWL0088    WIOCT1           D-N301-ADDRESS
     C                     MOVELWL0089    WIODT1           D-N302-ADDRESS
     C                     MOVELWL0090    WIOET1           D-N401-CITY
     C                     MOVELWL0091    WIJGAA           D-N402-STATE
     C                     MOVELWL0092    WIOGT1           D-N403-POSTAL C
      *
     C           KLCRSK    KLIST
     C                     KFLD           WIBNC3           Company
     C                     KFLD           WIHHAA           Broker Code
     C                     KFLD           WILSNY           D-INVOICE SURRO
     C                     KFLD           WIOFT1           D-N101-ADDRESS
     C                     KFLD           WIOAT1           D-N102-NAME
      * Check for duplicate primary key
     C           KLCRSK    SETLL@DTCPSW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3929' W0RTN   7
      * Send message 'EDI Dist Allow Cust Na EX'
     C                     MOVEL'USR3929' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@DTCPSW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Company Address    RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WJAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0093    WJAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@ABREG3              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJADTX    WL0094           Name
     C                     MOVELWJACNA    WL0095           Address Line 1
     C                     MOVELWJADNA    WL0096           Address Line 2
     C                     MOVELWJAENA    WL0097           Address Line 3
     C                     MOVELWJAJNA    WL0098           City
     C                     MOVELWJBTTX    WL0099           Zip/Postal Code
     C                     MOVELWJBGCD    WL0100           State Code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0101    WKAIC3           Company Number
     C                     MOVELWL0102    WKV8CD           Company Value C
      * Establish starting position
     C           KRSSM     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKBXTX    WL0103           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Federal ID         RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAIC3           Company Number
      * Setup key
     C                     Z-ADDWBAIC3    WJAIC3           Company Number
      * Establish starting position
     C           KRSSN     CHAIN@ABREG3              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJA2NA    YL0070           Federal Tax Id.
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * LCL D-N102-ITEM MAN
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WLDOCD           System Value Co
      * Setup key
     C                     MOVELWL0104    WLDOCD           System Value Co
      * Establish starting position
     C           KRSSO     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0105           System Value Al
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLBXTX    WL0105           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Item Description   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMHGCD    WQSP01           Item Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Item Code
      * Setup key
     C                     Z-ADDWBHGCD    WQSP01           Item Code
      * Establish starting position
     C           KRSSP     SETLL@BZRED0                    *
     C           KRSSP     READE@BZRED0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0072           Description Lin
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMAVNA    YL0072           Description Lin
     C           KRSSP     READE@BZRED0                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * CRT Dist Allow Dtl    CR - EDI Dist Allow Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DVCPST
     C                     Z-ADDWBAIC3    WOBNC3           Company
     C                     MOVELWBHHAA    WOHHAA           Broker Code
     C                     Z-ADDYL0036    WOLWNY           D-BPT01 INV SUR
     C                     Z-ADDWBC4NB    WOL0NY           D-ORDER NBR
     C                     Z-ADDWBDPNB    WOLXNY           D-ORD SEQ NBR
     C                     Z-ADDWBUENB    WOLYNY           D-ORD SECONDARY
     C                     Z-ADDWBDXNB    WOL7NY           D-Sequence numb
     C                     MOVELYL0083    WOOLT1           D-1TA13-DESC IT
     C                     MOVEL'F'       WOJTAA           D-PID01-ITEM DE
     C                     MOVELYL0072    WOOMT1           D-PID02-ITEM DE
     C                     MOVEL'32'      WOJLAA           D-QTY01-QTY QUA
     C                     Z-ADDWBPTDT    WOLZNY           D-Actual Ship D
     C                     Z-ADDYL0041    WOL1NY           D-COMPANY
     C                     Z-ADDYL0081    WOI4VL           D-QTY ORDERED
     C                     Z-ADDWBBYWG    WOI0VL           D-QTY02-QUANTIT
     C                     MOVEL'UA'      WOJMAA           D-LIN02-UPC FOR
     C                     MOVELYL0079    WOOKT1           D-LIN03-UPC NBR
     C                     MOVEL'VN'      WOJNAA           D-LIN04-SKU NBR
     C                     Z-ADDYL0084    WONPNY           D-LIN05-SKU FOR
     C                     MOVEL'VN'      WOJJAA           D-N101-ADD QUAL
     C                     MOVEL'UN'      WOJOAA           D-UIT01-PRICE Q
     C                     Z-ADDYL0080    WOI1VL           D-UIT02-NET PRI
     C                     MOVELYL0071    WOOIT1           D-N102-ITEM MAN
     C                     MOVEL'PE'      WOJPAA           D-UIT03-BASIS O
     C                     MOVEL'1'       WOJQAA           D-AMT01-AMT QUA
     C                     MOVEL'A'       WOJRAA           D-ITA01-ALL IND
     C                     MOVEL'EDA'     WOJSAA           D-ITA05-ALL IND
     C                     MOVEL'9'       WOJKAA           D-N103-ID NBR Q
     C                     Z-ADDYL0076    WOI2VL           D-ITA06-ALLW DO
     C                     Z-ADDYL0077    WOI3VL           D-ITA07-TOT DOL
     C                     MOVELYL0064    WOOJT1           D-N104-DUNS NBR
     C                     Z-ADDYL0078    WONONY           D-ITA09-Allow %
     C                     MOVELWBOJCD    WOOJCD           Accrual Code
      *
     C           KLCRSQ    KLIST
     C                     KFLD           WOBNC3           Company
     C                     KFLD           WOHHAA           Broker Code
     C                     KFLD           WOLWNY           D-BPT01 INV SUR
     C                     KFLD           WOL0NY           D-ORDER NBR
     C                     KFLD           WOLXNY           D-ORD SEQ NBR
     C                     KFLD           WOLYNY           D-ORD SECONDARY
     C                     KFLD           WOL7NY           D-Sequence numb
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@DVCPST                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3933' W0RTN   7
      * Send message 'EDI Dist Allow Detail  EX'
     C                     MOVEL'USR3933' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@DVCPST                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADAT1           Broker G/L Vend
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEDVL           Item Accrual Am
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBPTDT           HDA Actual Ship
     C                     Z-ADD*ZERO     WBBYWG           Weight Billed
     C                     Z-ADD*ZERO     WBPRDT           HDA SA Week End
     C                     Z-ADD*ZERO     WBPSDT           HDA Atch to Ord
     C                     Z-ADD*ZERO     WBEGVL           HDA Unused Amt
     C                     Z-ADD*ZERO     WBEHVL           HDA Unused Amt
     C                     Z-ADD*ZERO     WBQ9DT           HDA Invoice Dat
     C                     Z-ADD*ZERO     WBH1NY           HDA G/L Sub Led
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCBTC7           Parent Customer
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCORIT           Original Item
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WCESNB           Accounting Year
     C                     Z-ADD*ZERO     WCETNB           Accounting Peri
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WCBYWG           Weight Billed
     C                     Z-ADD*ZERO     WCS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WCUTVA           Standard Overag
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WCR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WCSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WCSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WCONVA           Actual Freight
     C                     Z-ADD*ZERO     WCB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WCB5NB           PM Line Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WCUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WCUOVA           Commission Amou
     C                     Z-ADD*ZERO     WCUPVA           Financials Amou
     C                     Z-ADD*ZERO     WCUQVA           Financials Amou
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WCIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WCNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WCBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCCDPR           Market Value
     C                     Z-ADD*ZERO     WCD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WCD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WCCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WCOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WCD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WCCFVL           HST Item Target
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDV1DT           TPC Unused Date
     C                     Z-ADD*ZERO     WDV2DT           TPC Unused date
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBNC3           Company
     C                     Z-ADD*ZERO     WELTNY           D-BPT02-INV SUR
     C                     Z-ADD*ZERO     WEMONY           D-INVOICE NUMBE
     C                     Z-ADD*ZERO     WELUNY           D-BPT03-INVOICE
     C                     Z-ADD*ZERO     WELVNY           D-CTT01 LIN SEG
     C                     Z-ADD*ZERO     WEIYVL           D-CTT02-TOT QTY
     C                     Z-ADD*ZERO     WEIZVL           D-AMT02-INVOICE
     C                     Z-ADD*ZERO     WELZNY           D-Actual Ship D
     C                     Z-ADD*ZERO     WEMVVL           D-Unused amount
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGP3NB           D & B Number
     C                     Z-ADD*ZERO     WGI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WGAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WGANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WGBTC7           Parent Customer
     C                     Z-ADD*ZERO     WGS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WGVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WGI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIBNC3           Company
     C                     Z-ADD*ZERO     WILSNY           D-INVOICE SURRO
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKM8NB           System Value Nu
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLM8NB           System Value Nu
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WMAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WMAIWG           Unit Weight
     C                     Z-ADD*ZERO     WMCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WMC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WMURTN           Number Cases On
     C                     Z-ADD*ZERO     WMAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMTFNB           Transportation
     C                     Z-ADD*ZERO     WMTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WMTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WMBLPR           Market Overage
     C                     Z-ADD*ZERO     WMBMPR           Standard Overag
     C                     Z-ADD*ZERO     WMCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WMCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WMSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WMPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WMICN1           Item Category N
     C                     Z-ADD*ZERO     WMICN2           Item Category N
     C                     Z-ADD*ZERO     WMV2NB           Item Category N
     C                     Z-ADD*ZERO     WMITCN           Item Category N
     C                     Z-ADD*ZERO     WMITC5           Item Category N
     C                     Z-ADD*ZERO     WMICN6           Item Category N
     C                     Z-ADD*ZERO     WMICN7           Item Category N
     C                     Z-ADD*ZERO     WMICN8           Item Category N
     C                     Z-ADD*ZERO     WMICN9           Item Category N
     C                     Z-ADD*ZERO     WMICN0           Item Category N
     C                     Z-ADD*ZERO     WMSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WMA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WMSJNB           Production Lead
     C                     Z-ADD*ZERO     WMSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WMSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WMSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WMCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WMCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WMILNB           Packages per ca
     C                     Z-ADD*ZERO     WMCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WMCINB           PM Batch Size
     C                     Z-ADD*ZERO     WMCJNB           Package Level s
     C                     Z-ADD*ZERO     WMCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WMCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WMCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WMCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WMCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WMCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WMCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WMCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WMC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WMB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WMB5NB           PM Line Number
     C                     Z-ADD*ZERO     WMBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WMBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WMF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WMF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WMF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WMBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WMBNNB           Production Qty
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOBNC3           Company
     C                     Z-ADD*ZERO     WOLWNY           D-BPT01 INV SUR
     C                     Z-ADD*ZERO     WOL0NY           D-ORDER NBR
     C                     Z-ADD*ZERO     WOLXNY           D-ORD SEQ NBR
     C                     Z-ADD*ZERO     WOLYNY           D-ORD SECONDARY
     C                     Z-ADD*ZERO     WOL7NY           D-Sequence numb
     C                     Z-ADD*ZERO     WOLZNY           D-Actual Ship D
     C                     Z-ADD*ZERO     WOL1NY           D-COMPANY
     C                     Z-ADD*ZERO     WOI4VL           D-QTY ORDERED
     C                     Z-ADD*ZERO     WOI0VL           D-QTY02-QUANTIT
     C                     Z-ADD*ZERO     WONPNY           D-LIN05-SKU FOR
     C                     Z-ADD*ZERO     WOI1VL           D-UIT02-NET PRI
     C                     Z-ADD*ZERO     WOI2VL           D-ITA06-ALLW DO
     C                     Z-ADD*ZERO     WOI3VL           D-ITA07-TOT DOL
     C                     Z-ADD*ZERO     WONONY           D-ITA09-Allow %
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005 20
     C                     MOVEL*BLANK    WL0006  2
     C                     MOVEL*BLANK    WL0007  6
     C                     MOVEL*BLANK    WL0008 11
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011 30
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013 30
     C                     MOVEL*BLANK    WL0014 20
     C                     MOVEL*BLANK    WL0015  2
     C                     MOVEL*BLANK    WL0016 11
     C                     MOVEL*BLANK    WL0017 15
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 114
     C                     Z-ADD*ZERO     WL0020 114
     C                     MOVEL*BLANK    WL0021  2
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023 114
     C                     Z-ADD*ZERO     WL0024 114
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027  40
     C                     Z-ADD*ZERO     WL0028  20
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  30
     C                     MOVEL*BLANK    WL0034  3
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037 30
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0038  6
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0041  30
     C                     MOVEL*BLANK    WL0042  6
     C                     Z-ADD*ZERO     WL0043  90
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  6
     C                     Z-ADD*ZERO     WL0046  90
     C                     Z-ADD*ZERO     WL0047  70
     C                     MOVEL*BLANK    WL0048  2
     C                     MOVEL*BLANK    WL0049 22
     C                     Z-ADD*ZERO     WL0050  50
     C                     Z-ADD*ZERO     WL0051 112
     C                     MOVEL*BLANK    WL0052  1
     C                     Z-ADD*ZERO     WL0053 152
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055 112
     C                     MOVEL*BLANK    WL0056  6
     C                     MOVEL*BLANK    WL0057 25
     C                     MOVEL*BLANK    WL0058  2
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060 30
     C                     Z-ADD*ZERO     WL0061  70
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0062  70
     C                     MOVEL*BLANK    WL0063 30
     C                     MOVEL*BLANK    WL0064 30
     C                     MOVEL*BLANK    WL0065 30
     C                     MOVEL*BLANK    WL0066 30
     C                     MOVEL*BLANK    WL0067 20
     C                     MOVEL*BLANK    WL0068  2
     C                     MOVEL*BLANK    WL0069 11
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0070  70
     C                     MOVEL*BLANK    WL0071 10
     C                     MOVEL*BLANK    WL0072 50
     C                     MOVEL*BLANK    WL0073  8
     C                     MOVEL*BLANK    WL0074  6
     C                     MOVEL*BLANK    WL0075 20
     C                     MOVEL*BLANK    WL0076 20
     C                     MOVEL*BLANK    WL0077 20
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  1
     C                     MOVEL*BLANK    WL0080  1
      * Define local variables for subroutine SKCRRC.
     C                     Z-ADD*ZERO     WL0081  30
     C                     MOVEL*BLANK    WL0082  6
     C                     Z-ADD*ZERO     WL0083  90
     C                     MOVEL*BLANK    WL0084  2
     C                     MOVEL*BLANK    WL0085 30
     C                     MOVEL*BLANK    WL0086  2
     C                     MOVEL*BLANK    WL0087 20
     C                     MOVEL*BLANK    WL0088 55
     C                     MOVEL*BLANK    WL0089 55
     C                     MOVEL*BLANK    WL0090 20
     C                     MOVEL*BLANK    WL0091  2
     C                     MOVEL*BLANK    WL0092 15
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0093  30
     C                     MOVEL*BLANK    WL0094 30
     C                     MOVEL*BLANK    WL0095 30
     C                     MOVEL*BLANK    WL0096 30
     C                     MOVEL*BLANK    WL0097 30
     C                     MOVEL*BLANK    WL0098 20
     C                     MOVEL*BLANK    WL0099 11
     C                     MOVEL*BLANK    WL0100  2
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0101  30
     C                     MOVEL*BLANK    WL0102 10
     C                     MOVEL*BLANK    WL0103 40
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0104 10
     C                     MOVEL*BLANK    WL0105 40
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field A/R City
     C                     MOVEL*BLANK    YL0002 20
      * Define local work field A/R State
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field A/R County Code
     C                     MOVEL*BLANK    YL0004  6
      * Define local work field A/R Zip/Postal Code
     C                     MOVEL*BLANK    YL0005 11
      * Define local work field Parent Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field A/R Customer Name
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Ship to Customer Ship To
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0011 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0013 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0014 15
      * Define local work field Weight Ordered SUM
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field Unit Price
     C                     Z-ADD*ZERO     YL0016 114
      * Define local work field Unit Price Ordered U/M
     C                     Z-ADD*ZERO     YL0017 114
      * Define local work field U/M - Base Price
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     YL0020 114
      * Define local work field Unit Cost Pricing U/M
     C                     Z-ADD*ZERO     YL0021 114
      * Define local work field Unit Weight Ordered U/M
     C                     Z-ADD*ZERO     YL0022 112
      * Define local work field Extended Amount
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field Accounting Year Code
     C                     Z-ADD*ZERO     YL0024  40
      * Define local work field Accounting Period Code
     C                     Z-ADD*ZERO     YL0025  20
      * Define local work field OM Week
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field Quantity Billed
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field Shipped Item Code
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field Shipping Company Number
     C                     Z-ADD*ZERO     YL0030  30
      * Define local work field Order Detail Reason
     C                     MOVEL*BLANK    YL0031  3
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field Order Desc. Line One
     C                     MOVEL*BLANK    YL0034 30
      * Define local work field USR Ship To Customer
     C                     Z-ADD*ZERO     YL0035  70
      * Define local work field USR Invoice Number
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field Order Number Saved USR
     C                     Z-ADD*ZERO     YL0037  70
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0038  30
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0039  30
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0040  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0041  30
      * Define local work field USR Company Number
     C                     Z-ADD*ZERO     YL0042  30
      * Define local work field Accrual Code
     C                     MOVEL*BLANK    YL0043  3
      * Define local work field Broker Code
     C                     MOVEL*BLANK    YL0044  6
      * Define local work field Extol Control Flag
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Live with ERP
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field Count Records        USR
     C                     Z-ADD*ZERO     YL0047  50
      * Define local work field Weight Billed Actual  SUM
     C                     Z-ADD*ZERO     YL0048 112
      * Define local work field Invoiced Amount
     C                     Z-ADD*ZERO     YL0049 112
      * Define local work field D-Unused amount
     C                     Z-ADD*ZERO     YL0050 112
      * Define local work field D-Unused code
     C                     MOVEL*BLANK    YL0051  6
      * Define local work field D-Unused text
     C                     MOVEL*BLANK    YL0052 25
      * Define local work field D-AMT02-INVOICE TOTAL
     C                     Z-ADD*ZERO     YL0053 152
      * Define local work field D-CTT02-TOT QTY SHIPPED
     C                     Z-ADD*ZERO     YL0054 112
      * Define local work field D-CTT01 LIN SEG COUNT
     C                     Z-ADD*ZERO     YL0055  50
      * Define local work field USR Address Qualifier
     C                     MOVEL*BLANK    YL0056  2
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0001 30
      * Define local work field D-N102-NAME
     C                     MOVEL*BLANK    YL0057 30
      * Define local work field D-N301-ADDRESS 1
     C                     MOVEL*BLANK    YL0058 55
      * Define local work field D-N302-ADDRESS 2
     C                     MOVEL*BLANK    YL0059 55
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0002 30
      * Define local work field D-N401-CITY
     C                     MOVEL*BLANK    YL0060 20
      * Define local work field D-N402-STATE
     C                     MOVEL*BLANK    YL0061  2
      * Define local work field D-N403-POSTAL CODE
     C                     MOVEL*BLANK    YL0062 15
      * Define null work field Internet Password
     C                     MOVEL*BLANK    YN0003 10
      * Define null work field Email Address
     C                     MOVEL*BLANK    YN0004 50
      * Define null work field Email User ID
     C                     MOVEL*BLANK    YN0005  8
      * Define null work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YN0006  6
      * Define local work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YL0063 20
      * Define null work field EDI Warehouse/Store No.
     C                     MOVEL*BLANK    YN0007 20
      * Define null work field State Tax ID
     C                     MOVEL*BLANK    YN0008 20
      * Define null work field Cust Shipping Temp C/F
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field One Invoice Per PO
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field EDI Advanced Ship Notice
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field D-N104-DUNS NBR
     C                     MOVEL*BLANK    YL0064 20
      * Define local work field Calc 4
     C                     Z-ADD*ZERO     YL0065  40
      * Define local work field Amount Right 4 position
     C                     MOVEL*BLANK    YL0066  4
      * Define local work field Text USR 9
     C                     MOVEL*BLANK    YL0067  9
      * Define local work field D-N104-ID CODE
     C                     MOVEL*BLANK    YL0068 20
      * Define local work field Text USR 4
     C                     MOVEL*BLANK    YL0069  4
      * Define local work field Federal Tax Id.
     C                     MOVEL*BLANK    YL0070 20
      * Define local work field D-N102-ITEM MANUFACT NAME
     C                     MOVEL*BLANK    YL0071 60
      * Define local work field D-PID02-ITEM DESC
     C                     MOVEL*BLANK    YL0072 60
      * Define local work field USR Text 7            USR
     C                     MOVEL*BLANK    YL0073  7
      * Define local work field Item Code 5.0
     C                     Z-ADD*ZERO     YL0074  50
      * Define local work field Item Code 5A
     C                     MOVEL*BLANK    YL0075  5
      * Define local work field D-ITA06-ALLW DOL AMT/UNIT
     C                     Z-ADD*ZERO     YL0076 112
      * Define local work field D-ITA07-TOT DOL AMT/LINE
     C                     Z-ADD*ZERO     YL0077 112
      * Define local work field D-ITA09-Allow %/Unit
     C                     Z-ADD*ZERO     YL0078  50
      * Define local work field Item Meat Cost Group Code
     C                     MOVEL*BLANK    YL0079 12
      * Define local work field D-UIT02-NET PRICE PER UNT
     C                     Z-ADD*ZERO     YL0080 112
      * Define local work field D-QTY ORDERED
     C                     Z-ADD*ZERO     YL0081 112
      * Define local work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YL0082  6
      * Define local work field D-1TA13-DESC ITA06 NEG
     C                     MOVEL*BLANK    YL0083 60
      * Define local work field D-LIN05-SKU FOR TRDE PTNR
     C                     Z-ADD*ZERO     YL0084  50
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 DUNSNUM
