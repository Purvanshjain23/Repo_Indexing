     H/TITLE Rtv Discount Rate     XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJHIGH
     H* Date          : 05/06/15  Time  : 15:42:05
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMHLREL7IF  E           K        DISK
      * RSQ : Accrual Program           Discount Programs
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOMHPREL1IF  E           K        DISK
      * RTV : Customer Accrual Item     Retrieval index
      *
     FPOC8REL1IF  E           K        DISK
      * RTV : Customer Accrual Str      Retrieval index
      *
     FPMD2REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm          Retrieval index
      *
     FPMD3REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Item     Retrieval index
      *
     FPNFJREL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Cust     Retrieval index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@HLRELX
      * Accrual Program           Discount Programs
      * Renamed input format fields
     I              HLOJCD                          WBOJCD
     I              HLLENA                          WBLENA
     I              HLTOST                          WBTOST
     I              HLTQST                          WBTQST
     I              HLTRST                          WBTRST
     I              HLTSST                          WBTSST
     I              HLOKCD                          WBOKCD
     I              HLTYST                          WBTYST
     I              HLOQCD                          WBOQCD
     I              HLHHCD                          WBHHCD
     I              HLI2TX                          WBI2TX
     I              HLJFTX                          WBJFTX
     I              HLI3TX                          WBI3TX
     I              HLJGTX                          WBJGTX
     I              HLLEDG                          WBLEDG
     I              HLTTST                          WBTTST
     I              HLBKPR                          WBBKPR
     I              HLSHSX                          WBSHSX
     I              HLQFSX                          WBQFSX
     I              HLFDTX                          WBFDTX
     I              HLFETX                          WBFETX
     I              HLFFTX                          WBFFTX
     I              HLFGTX                          WBFGTX
     I              HLHQVL                          WBHQVL
     I              HLFHTX                          WBFHTX
     I              HLUVST                          WBUVST
     I              HLUWST                          WBUWST
     I              HLUXST                          WBUXST
     I              HLVSST                          WBVSST
     I              HLAATM                          WBAATM
     I              HLAYNA                          WBAYNA
     I              HLA0NA                          WBA0NA
     I              HLAXDT                          WBAXDT
      *
     I@HORELA
      * Customer Accrual          Retrieval index
      * Renamed input format fields
     I              HOBKC7                          WCBKC7
     I              HOOJCD                          WCOJCD
     I              HOGUNY                          WCGUNY
     I              HOBFDT                          WCBFDT
     I              HOA2DT                          WCA2DT
     I              HOBKPR                          WCBKPR
     I              HOTTST                          WCTTST
     I              HOSHSX                          WCSHSX
     I              HOQDSX                          WCQDSX
     I              HOPJDT                          WCPJDT
     I              HOPKDT                          WCPKDT
     I              HOECVL                          WCECVL
     I              HOQESX                          WCQESX
     I              HOQFSX                          WCQFSX
     I              HOHHAA                          WCHHAA
     I              HOHQVL                          WCHQVL
     I              HOQGSX                          WCQGSX
     I              HOQHSX                          WCQHSX
     I              HOQISX                          WCQISX
     I              HOQJSX                          WCQJSX
     I              HOUVST                          WCUVST
     I              HOUWST                          WCUWST
     I              HOUXST                          WCUXST
     I              HOAATM                          WCAATM
     I              HOAYNA                          WCAYNA
     I              HOA0NA                          WCA0NA
     I              HOAXDT                          WCAXDT
      *
     I@HPRELD
      * Customer Accrual Item     Retrieval index
      * Renamed input format fields
     I              HPBKC7                          WDBKC7
     I              HPOJCD                          WDOJCD
     I              HPGUNY                          WDGUNY
     I              HPHGCD                          WDHGCD
     I              HPBKPR                          WDBKPR
     I              HPSHSX                          WDSHSX
     I              HPUVST                          WDUVST
     I              HPUWST                          WDUWST
     I              HPUXST                          WDUXST
     I              HPAATM                          WDAATM
     I              HPAYNA                          WDAYNA
     I              HPA0NA                          WDA0NA
     I              HPAXDT                          WDAXDT
      *
     I@C8RES1
      * Customer Accrual Str      Retrieval index
      * Renamed input format fields
     I              C8BKC7                          WEBKC7
     I              C8OJCD                          WEOJCD
     I              C8GUNY                          WEGUNY
     I              C8RGNB                          WERGNB
     I              C8RHNB                          WERHNB
     I              C8RINB                          WERINB
     I              C8BKPR                          WEBKPR
     I              C8SHSX                          WESHSX
     I              C8QTSX                          WEQTSX
     I              C8QUSX                          WEQUSX
     I              C8FKPR                          WEFKPR
     I              C8FLPR                          WEFLPR
     I              C8UVST                          WEUVST
     I              C8UWST                          WEUWST
     I              C8UXST                          WEUXST
     I              C8VSST                          WEVSST
     I              C8AATM                          WEAATM
     I              C8AYNA                          WEAYNA
     I              C8A0NA                          WEA0NA
     I              C8AXDT                          WEAXDT
      *
     I@D2RET9
      * Accrual Prod Pgm          Retrieval index
      * Renamed input format fields
     I              D2OJCD                          WFOJCD
     I              D2MSNY                          WFMSNY
     I              D2SCDT                          WFSCDT
     I              D2SDDT                          WFSDDT
     I              D2O9TX                          WFO9TX
     I              D2EWST                          WFEWST
     I              D2VSST                          WFVSST
     I              D2MJDT                          WFMJDT
     I              D2BETM                          WFBETM
     I              D2CCVN                          WFCCVN
     I              D2CDVN                          WFCDVN
     I              D2MKDT                          WFMKDT
     I              D2BFTM                          WFBFTM
     I              D2CEVN                          WFCEVN
     I              D2CFVN                          WFCFVN
      *
     I@D3REUC
      * Accrual Prod Pgm Item     Retrieval index
      * Renamed input format fields
     I              D3OJCD                          WGOJCD
     I              D3MSNY                          WGMSNY
     I              D3HGCD                          WGHGCD
     I              D3SHSX                          WGSHSX
     I              D3BKPR                          WGBKPR
     I              D3VSST                          WGVSST
     I              D3MJDT                          WGMJDT
     I              D3BETM                          WGBETM
     I              D3CCVN                          WGCCVN
     I              D3CDVN                          WGCDVN
     I              D3MKDT                          WGMKDT
     I              D3BFTM                          WGBFTM
     I              D3CEVN                          WGCEVN
     I              D3CFVN                          WGCFVN
      *
     I@FJREBY
      * Accrual Prod Pgm Cust     Retrieval index
      * Renamed input format fields
     I              FJOJCD                          WHOJCD
     I              FJMSNY                          WHMSNY
     I              FJBKC7                          WHBKC7
     I              FJVSST                          WHVSST
     I              FJMJDT                          WHMJDT
     I              FJBETM                          WHBETM
     I              FJCCVN                          WHCCVN
     I              FJCDVN                          WHCDVN
     I              FJMKDT                          WHMKDT
     I              FJBFTM                          WHBFTM
     I              FJCEVN                          WHCEVN
     I              FJCFVN                          WHCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Ship To Customer
     I                                    P   7  100P1BKC7
      * I :  U/M - Base Price
     I                                       11  12 P1CRCD
      * I :  Scheduled Ship Date
     I                                    P  13  160P1AODT
      * I :  Item Structure Type Code
     I                                    P  17  180P1RGNB
      * I :  Item Structure Group Code
     I                                    P  19  200P1RHNB
      * I :  Item Structure Class Code
     I                                    P  21  220P1RINB
     IP2PARM      DS
      * B :  Accrual Rate
     I                                    P   1   56P2BKPR
     IP3PARM      DS
      * B :  Accrual Rate Type
     I                                        1   2 P3SHSX
     IP4PARM      DS
      * N :  Unit Weight
     I                                    P   1   62P4AIWG
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1CRCD    PARM           WP0004  2        U/M - Base Pric
     C           P1AODT    PARM           WP0005  70       Scheduled Ship
     C           P1RGNB    PARM           WP0006  30       Item Structure
     C           P1RHNB    PARM           WP0007  30       Item Structure
     C           P1RINB    PARM           WP0008  30       Item Structure
     C           P2BKPR    PARM P2BKPR    WP0009  96       Accrual Rate
     C           P3SHSX    PARM P3SHSX    WP0010  2        Accrual Rate Ty
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv Discount Rate     XF
      * Modificaitions and Comments
     C                     EXSR UASUBR                     Modificaitions
     C                     Z-ADD*ZERO     P2BKPR           Accrual Rate
     C                     MOVELWUGSTX    P3SHSX           Accrual Rate Ty
      * RTV Unit Weight        RT - Company Item  * 
     C                     EXSR SARVGN
      * Rtv Discount Rate     RT - Accrual Program  * 
     C                     EXSR SBRVGN
      * CASE: PAR.U/M - Base Price is Cases
     C           P1CRCD    IFEQ 'CS'                       *IF
     C                     MOVEL*BLANK    P3SHSX           Accrual Rate Ty
     C                     MOVEL'Q'       P3SHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P3SHSX           Accrual Rate Ty
     C                     MOVEL'W'       P3SHSX           Accrual Rate Ty
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P4AIWG           Unit Weight
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAIWG    P4AIWG           Unit Weight
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Discount Rate     RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@HLRELX                    *
     C                     READ @HLRELX                  90*
      * Data record not found
     C   90                MOVEL'USR1514' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Rate Usage is Customer Accrual
     C           WBTRST    IFEQ 'C'                        *IF
      * Rtv Discount Rate     RT - Customer Accrual  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: DB1.Rate Usage is Product Accrual
     C           WBTRST    IFEQ 'P'                        *IF
      * Rtv Discount Rate     RT - Accrual Prod Pgm  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @HLRELX                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Discount Rate     RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBKC7    WQSC01           Ship To Custome
     C           *LIKE     DEFN WCOJCD    WQSC02           Accrual Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
     C                     KFLD           WQSC02           Accrual Code
      * Setup key
     C                     Z-ADDP1BKC7    WQSC01           Ship To Custome
     C                     MOVELWBOJCD    WQSC02           Accrual Code
      * Establish starting position
     C           KRSSC     SETLL@HORELA                    *
     C           KRSSC     READE@HORELA                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.Period Beginning Date
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFGE WCBFDT                     *IF
     C           P1AODT    IFLE WCA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * LCL.Accrual Rate
      * CASE: DB1.All Products (Y/N) is Yes
     C           WCTTST    IFEQ 'Y'                        *IF
     C                     Z-ADDWCBKPR    YL0001           Accrual Rate
     C                     MOVELWCSHSX    P3SHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is No
     C           WCTTST    IFEQ 'N'                        *IF
      * ALL Product = No
      * CASE: DB1.Accrual Detail Search is Item
     C           WCQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCBKC7    WL0001           Ship To Custome
     C                     MOVELWCOJCD    WL0002    P      Accrual Code
     C                     Z-ADDWCGUNY    WL0003           CAH Sequence No
     C                     Z-ADDP1HGCD    WL0004           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0001           Accrual Rate
     C                     MOVELWL0006    P3SHSX    P      Accrual Rate Ty
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WCQFSX    IFEQ 'S'                        *IF
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCBKC7    WL0007           Ship To Custome
     C                     MOVELWCOJCD    WL0008    P      Accrual Code
     C                     Z-ADDWCGUNY    WL0009           CAH Sequence No
     C                     Z-ADDP1RGNB    WL0010           Item Structure
     C                     Z-ADDP1RHNB    WL0011           Item Structure
     C                     Z-ADDP1RINB    WL0012           Item Structure
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0001           Accrual Rate
     C                     MOVELWL0014    P3SHSX    P      Accrual Rate Ty
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV & Chk Rate n/clas RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCBKC7    WL0015           Ship To Custome
     C                     MOVELWCOJCD    WL0016    P      Accrual Code
     C                     Z-ADDWCGUNY    WL0017           CAH Sequence No
     C                     Z-ADDP1RGNB    WL0018           Item Structure
     C                     Z-ADDP1RHNB    WL0019           Item Structure
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    YL0001           Accrual Rate
     C                     MOVELWL0021    P3SHSX    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
     C           WCTTST    IFEQ 'X'                        *IF
     C                     Z-ADDWCBKPR    YL0001           Accrual Rate
      * ALL Product Except
      * CASE: DB1.Accrual Detail Search is Item
     C           WCQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCBKC7    WL0001           Ship To Custome
     C                     MOVELWCOJCD    WL0002    P      Accrual Code
     C                     Z-ADDWCGUNY    WL0003           CAH Sequence No
     C                     Z-ADDP1HGCD    WL0004           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0002           Accrual Rate
     C                     MOVELWL0006    P3SHSX    P      Accrual Rate Ty
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0002    YL0001           Accrual Rate
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WCQFSX    IFEQ 'S'                        *IF
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCBKC7    WL0007           Ship To Custome
     C                     MOVELWCOJCD    WL0008    P      Accrual Code
     C                     Z-ADDWCGUNY    WL0009           CAH Sequence No
     C                     Z-ADDP1RGNB    WL0010           Item Structure
     C                     Z-ADDP1RHNB    WL0011           Item Structure
     C                     Z-ADDP1RINB    WL0012           Item Structure
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0002           Accrual Rate
     C                     MOVELWL0014    P3SHSX    P      Accrual Rate Ty
      * CHK: Without Class Code
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV & Chk Rate n/clas RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCBKC7    WL0015           Ship To Custome
     C                     MOVELWCOJCD    WL0016    P      Accrual Code
     C                     Z-ADDWCGUNY    WL0017           CAH Sequence No
     C                     Z-ADDP1RGNB    WL0018           Item Structure
     C                     Z-ADDP1RHNB    WL0019           Item Structure
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    YL0002           Accrual Rate
     C                     MOVELWL0021    P3SHSX    P      Accrual Rate Ty
      * LCL. Accrual Rate
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0002    YL0001           Accrual Rate
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0002    YL0001           Accrual Rate
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CVT: Pounds to Case
      * CASE: PAR.U/M - Base Price is Cases
     C           P1CRCD    IFEQ 'CS'                       *IF
      * CASE: PAR.Accrual Rate Type is Cases
     C           P3SHSX    IFEQ 'Q'                        *IF
     C                     Z-ADDYL0001    YL0002           Accrual Rate US
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0001    MULT P4AIWG    YL0002    H      Accrual Rate US
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0001    YL0002           Accrual Rate US
     C                     END                             *FI
     C                     ADD  YL0002    P2BKPR           Accrual Rate
     C                     END                             *FI
     C           KRSSC     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
     C                     KFLD           WDOJCD           Accrual Code
     C                     KFLD           WDGUNY           CAH Sequence No
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WDBKC7           Ship To Custome
     C                     MOVELWL0002    WDOJCD           Accrual Code
     C                     Z-ADDWL0003    WDGUNY           CAH Sequence No
     C                     Z-ADDWL0004    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@HPRELD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1522' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Accrual Rate
     C                     MOVEL*BLANK    WL0006           Accrual Rate Ty
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWDBKPR    WL0005           Accrual Rate
     C                     MOVELWDSHSX    WL0006           Accrual Rate Ty
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBKC7           Ship To Custome
     C                     KFLD           WEOJCD           Accrual Code
     C                     KFLD           WEGUNY           CAH Sequence No
     C                     KFLD           WERGNB           Item Structure
     C                     KFLD           WERHNB           Item Structure
     C                     KFLD           WERINB           Item Structure
      * Setup key
     C                     Z-ADDWL0007    WEBKC7           Ship To Custome
     C                     MOVELWL0008    WEOJCD           Accrual Code
     C                     Z-ADDWL0009    WEGUNY           CAH Sequence No
     C                     Z-ADDWL0010    WERGNB           Item Structure
     C                     Z-ADDWL0011    WERHNB           Item Structure
     C                     Z-ADDWL0012    WERINB           Item Structure
      * Establish starting position
     C           KRSSE     CHAIN@C8RES1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3294' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0013           Accrual Rate
     C                     MOVEL*BLANK    WL0014           Accrual Rate Ty
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKPR    WL0013           Accrual Rate
     C                     MOVELWESHSX    WL0014           Accrual Rate Ty
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate n/clas RT - Customer Accrual Str  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSF01           Ship To Custome
     C           *LIKE     DEFN WEOJCD    WQSF02           Accrual Code
     C           *LIKE     DEFN WEGUNY    WQSF03           CAH Sequence No
     C           *LIKE     DEFN WERGNB    WQSF04           Item Structure
     C           *LIKE     DEFN WERHNB    WQSF05           Item Structure
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Ship To Custome
     C                     KFLD           WQSF02           Accrual Code
     C                     KFLD           WQSF03           CAH Sequence No
     C                     KFLD           WQSF04           Item Structure
     C                     KFLD           WQSF05           Item Structure
      * Setup key
     C                     Z-ADDWL0015    WQSF01           Ship To Custome
     C                     MOVELWL0016    WQSF02           Accrual Code
     C                     Z-ADDWL0017    WQSF03           CAH Sequence No
     C                     Z-ADDWL0018    WQSF04           Item Structure
     C                     Z-ADDWL0019    WQSF05           Item Structure
      * Establish starting position
     C           KRSSF     SETLL@C8RES1                    *
     C           KRSSF     READE@C8RES1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3294' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0020           Accrual Rate
     C                     MOVEL*BLANK    WL0021           Accrual Rate Ty
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Item Structure Class Code is Equal Zero
     C           WERINB    IFEQ 0                          *IF
      * PAR = DB1 By name
     C                     Z-ADDWEBKPR    WL0020           Accrual Rate
     C                     MOVELWESHSX    WL0021           Accrual Rate Ty
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@C8RES1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Discount Rate     RT - Accrual Prod Pgm  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFOJCD    WQSG01           Accrual Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Accrual Code
      * Setup key
     C                     MOVELWBOJCD    WQSG01           Accrual Code
      * Establish starting position
     C           KRSSG     SETLL@D2RET9                    *
     C           KRSSG     READE@D2RET9                  90*
      * Data record not found
     C   90                MOVEL'USR3972' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.AD Period Beginning D
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.AD Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFGE WFSCDT                     *IF
     C           P1AODT    IFLE WFSDDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV & Chk Rate Exists  RT - Accrual Prod Pgm Item  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADDYL0003    YL0004           Accrual Rate
     C                     ELSE
      * CASE: *OTHERWISE
      * ALL Customer = Y/N
      * CASE: DB1.AD All Customers is yes
     C           WFEWST    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0003    YL0004           Accrual Rate
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Cust Exists  RT - Accrual Prod Pgm Cust  * 
     C                     EXSR SIRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0005    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0003    YL0004           Accrual Rate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0004           Accrual Rate
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CVT: Pounds to Case
      * CASE: PAR.U/M - Base Price is Cases
     C           P1CRCD    IFEQ 'CS'                       *IF
      * CASE: PAR.Accrual Rate Type is Cases
     C           P3SHSX    IFEQ 'Q'                        *IF
     C                     Z-ADDYL0004    YL0003           Accrual Rate US
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0004    MULT P4AIWG    YL0003    H      Accrual Rate US
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0004    YL0003           Accrual Rate US
     C                     END                             *FI
     C                     ADD  YL0003    P2BKPR           Accrual Rate
     C                     END                             *FI
     C           KRSSG     READE@D2RET9                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists  RT - Accrual Prod Pgm Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGOJCD           Accrual Code
     C                     KFLD           WGMSNY           AD Program Numb
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     MOVELWFOJCD    WGOJCD           Accrual Code
     C                     Z-ADDWFMSNY    WGMSNY           AD Program Numb
     C                     Z-ADDP1HGCD    WGHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@D3REUC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3974' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    P3SHSX           Accrual Rate Ty
     C                     Z-ADD*ZERO     YL0003           Accrual Rate
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWGSHSX    P3SHSX           Accrual Rate Ty
     C                     Z-ADDWGBKPR    YL0003           Accrual Rate
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV & Chk Cust Exists  RT - Accrual Prod Pgm Cust  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHOJCD           Accrual Code
     C                     KFLD           WHMSNY           AD Program Numb
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     MOVELWFOJCD    WHOJCD           Accrual Code
     C                     Z-ADDWFMSNY    WHMSNY           AD Program Numb
     C                     Z-ADDP1BKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@FJREBY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4157' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0005           Record Found US
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0005           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modificaitions and Comments
      *================================================================
      * E4057 JJH 05/06/15 - Price Credit Memo Fixes
      * - Recompiled because $/Quantity by qty shipped QR
      *   removed from Cases LST of Accrual Rate Type.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4AIWG           Unit Weight
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WBHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WCBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WCA2DT           Period Ending D
     C                     Z-ADD*ZERO     WCBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WCPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WCPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WCECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WCHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WEBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WEFKPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WEFLPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WFSCDT           AD Period Begin
     C                     Z-ADD*ZERO     WFSDDT           AD Period Endin
     C                     Z-ADD*ZERO     WFO9TX           AD Sub Ledger
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  50
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  96
     C                     MOVEL*BLANK    WL0006  2
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009  50
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  96
     C                     MOVEL*BLANK    WL0014  2
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  3
     C                     Z-ADD*ZERO     WL0017  50
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  96
     C                     MOVEL*BLANK    WL0021  2
      * Define null work field Quality Level
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0001  96
      * Define local work field Accrual Rate USR
     C                     Z-ADD*ZERO     YL0002  96
      * Define local work field Accrual Rate USR
     C                     Z-ADD*ZERO     YL0003  96
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0004  96
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
