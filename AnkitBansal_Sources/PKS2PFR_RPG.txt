     H/TITLE Prt Payment Edit/Post PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 02/09/22  Time  : 15:11:13
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBKCPL7IF  E           K        DISK
      * RSQ : Hog Voucher Header        Lst Vch Batch #
      *
     FPKA1CPO7IF  E           K        DISK
      * RSQ : Tattoo Header             Co/Prd/Loc/KlDte/Tto/Unp
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPLAZREL1IF  E           K        DISK
      * RTV : Producer Email Hdr        Retrieval index
      *
     FPLA1REL1IF  E           K        DISK
      * RTV : Producer Email Detail     Retrieval index
      *
     FPLA0REL1IF  E           K        DISK
      * RTV : Producer Loc Email Hdr    Retrieval index
      *
     FPLA2REL1IF  E           K        DISK
      * RTV : Producer Loc Email Detail Retrieval index
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKEFCPL1IF  E           K        DISK
      * RTV : Producer Cntrct RsvAct Dt Retrieval index
      *
     FPKBKCPL5IF  E           K        DISK
      * RSQ : Hog Voucher Header        Lst Vch Hdr #
      *
     FPKBFREL1IF  E           K        DISK
      * RTV : Producer Std Split        Retrieval index
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKBKCPL0IF  E           K        DISK
      * RTV : Hog Voucher Header        Retrieval index
      *
     FPKBFREL2IF  E           K        DISK
      * RSQ : Producer Std Split        Active Prdcr Splits
      *
     FPKBLCPL1IF  E           K        DISK
      * RTV : Hog Voucher Detail        Retrieval index
      *
     FPKEFCPL0IF  E           K        DISK                      A
      * UPD : Producer Cntrct RsvAct Dt Update index
      *
     FPKEECPL1UF  E           K        DISK
      * UPD : Producer Cntrct RsvAct Hd Update index
      *
     FPKD7CPL0IF  E           K        DISK                      A
      * UPD : Tattoo Fax Driver         Update index
      *
     FPKBKCPL1UF  E           K        DISK                      A
      * UPD : Hog Voucher Header        Update index
      *
     FPKBLCPL0IF  E           K        DISK                      A
      * UPD : Hog Voucher Detail        Update index
      *
     FPKCACPL0IF  E           K        DISK                      A
      * UPD : Hog Voucher Split         Update index
      *
     FPKS2PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Payment Edit/Post PF  Print file
      *
      * Long constants
     E                    @CN#    1  27  6   @CN    25
     I@EFCPAO
      * Producer Cntrct RsvAct Dt Update index
      * Renamed input format fields
     I              EFAKCD                          WAAKCD
     I              EFDMDT                          WADMDT
     I              EFPADS                          WAPADS
     I              EFEKVA                          WAEKVA
     I              EFSKST                          WASKST
     I              EFHMNB                          WAHMNB
     I              EFBNNB                          WABNNB
     I              EFBONB                          WABONB
     I              EFCVNB                          WACVNB
     I              EFB0DT                          WAB0DT
     I              EFAAVN                          WAAAVN
     I              EFAADT                          WAAADT
     I              EFAMTM                          WAAMTM
     I              EFAJST                          WAAJST
     I              EFAHVN                          WAAHVN
     I              EFAGVN                          WAAGVN
     I              EFABVN                          WAABVN
     I              EFABDT                          WAABDT
     I              EFABTM                          WAABTM
      *
     I@BKCPJR
      * Hog Voucher Header        Lst Vch Hdr #
      * Renamed input format fields
     I              BKHNNB                          WBHNNB
     I              BKLWNB                          WBLWNB
     I              BKG9NB                          WBG9NB
     I              BKLXNB                          WBLXNB
     I              BKLYNB                          WBLYNB
     I              BKCSST                          WBCSST
     I              BKDKNB                          WBDKNB
     I              BKA2DT                          WBA2DT
     I              BKCIPR                          WBCIPR
     I              BKCJPR                          WBCJPR
     I              BKCKPR                          WBCKPR
     I              BKCLPR                          WBCLPR
     I              BKCMPR                          WBCMPR
     I              BKAUVA                          WBAUVA
     I              BKAVVA                          WBAVVA
     I              BKCHPR                          WBCHPR
     I              BKAJVA                          WBAJVA
     I              BKBUPC                          WBBUPC
     I              BKJHST                          WBJHST
     I              BKC0ST                          WBC0ST
     I              BKA4DT                          WBA4DT
     I              BKCUST                          WBCUST
     I              BKABCD                          WBABCD
     I              BKBNCD                          WBBNCD
     I              BKCFCD                          WBCFCD
     I              BKAAVN                          WBAAVN
     I              BKAADT                          WBAADT
     I              BKAMTM                          WBAMTM
     I              BKAJST                          WBAJST
     I              BKAHVN                          WBAHVN
     I              BKAGVN                          WBAGVN
     I              BKABVN                          WBABVN
     I              BKABDT                          WBABDT
     I              BKABTM                          WBABTM
      *
     I@BKCPEK
      * Hog Voucher Header        Update index
      * Renamed input format fields
     I              BKHNNB                          WCHNNB
     I              BKLWNB                          WCLWNB
     I              BKG9NB                          WCG9NB
     I              BKLXNB                          WCLXNB
     I              BKLYNB                          WCLYNB
     I              BKCSST                          WCCSST
     I              BKDKNB                          WCDKNB
     I              BKA2DT                          WCA2DT
     I              BKCIPR                          WCCIPR
     I              BKCJPR                          WCCJPR
     I              BKCKPR                          WCCKPR
     I              BKCLPR                          WCCLPR
     I              BKCMPR                          WCCMPR
     I              BKAUVA                          WCAUVA
     I              BKAVVA                          WCAVVA
     I              BKCHPR                          WCCHPR
     I              BKAJVA                          WCAJVA
     I              BKBUPC                          WCBUPC
     I              BKJHST                          WCJHST
     I              BKC0ST                          WCC0ST
     I              BKA4DT                          WCA4DT
     I              BKCUST                          WCCUST
     I              BKABCD                          WCABCD
     I              BKBNCD                          WCBNCD
     I              BKCFCD                          WCCFCD
     I              BKAAVN                          WCAAVN
     I              BKAADT                          WCAADT
     I              BKAMTM                          WCAMTM
     I              BKAJST                          WCAJST
     I              BKAHVN                          WCAHVN
     I              BKAGVN                          WCAGVN
     I              BKABVN                          WCABVN
     I              BKABDT                          WCABDT
     I              BKABTM                          WCABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@BKCPEJ
      * Hog Voucher Header        Retrieval index
      * Renamed input format fields
     I              BKHNNB                          WEHNNB
     I              BKLWNB                          WELWNB
     I              BKG9NB                          WEG9NB
     I              BKLXNB                          WELXNB
     I              BKLYNB                          WELYNB
     I              BKCSST                          WECSST
     I              BKDKNB                          WEDKNB
     I              BKA2DT                          WEA2DT
     I              BKCIPR                          WECIPR
     I              BKCJPR                          WECJPR
     I              BKCKPR                          WECKPR
     I              BKCLPR                          WECLPR
     I              BKCMPR                          WECMPR
     I              BKAUVA                          WEAUVA
     I              BKAVVA                          WEAVVA
     I              BKCHPR                          WECHPR
     I              BKAJVA                          WEAJVA
     I              BKBUPC                          WEBUPC
     I              BKJHST                          WEJHST
     I              BKC0ST                          WEC0ST
     I              BKA4DT                          WEA4DT
     I              BKCUST                          WECUST
     I              BKABCD                          WEABCD
     I              BKBNCD                          WEBNCD
     I              BKCFCD                          WECFCD
     I              BKAAVN                          WEAAVN
     I              BKAADT                          WEAADT
     I              BKAMTM                          WEAMTM
     I              BKAJST                          WEAJST
     I              BKAHVN                          WEAHVN
     I              BKAGVN                          WEAGVN
     I              BKABVN                          WEABVN
     I              BKABDT                          WEABDT
     I              BKABTM                          WEABTM
      *
     I@BFREOG
      * Producer Std Split        Active Prdcr Splits
      * Renamed input format fields
     I              BFABCD                          WFABCD
     I              BFBTCD                          WFBTCD
     I              BFAYDT                          WFAYDT
     I              BFABPC                          WFABPC
     I              BFAAVN                          WFAAVN
     I              BFAADT                          WFAADT
     I              BFAMTM                          WFAMTM
     I              BFAJST                          WFAJST
     I              BFAHVN                          WFAHVN
     I              BFAGVN                          WFAGVN
     I              BFABVN                          WFABVN
     I              BFABDT                          WFABDT
     I              BFABTM                          WFABTM
      *
     I@BLCPEP
      * Hog Voucher Detail        Retrieval index
      * Renamed input format fields
     I              BLHNNB                          WGHNNB
     I              BLLWNB                          WGLWNB
     I              BLG9NB                          WGG9NB
     I              BLDLNB                          WGDLNB
     I              BLCNPR                          WGCNPR
     I              BLCOPR                          WGCOPR
     I              BLCPPR                          WGCPPR
     I              BLCQPR                          WGCQPR
     I              BLCRPR                          WGCRPR
     I              BLAKVA                          WGAKVA
     I              BLALVA                          WGALVA
     I              BLCVPR                          WGCVPR
     I              BLAMVA                          WGAMVA
     I              BLAEPC                          WGAEPC
     I              BLI6ST                          WGI6ST
     I              BLJIST                          WGJIST
     I              BLJPST                          WGJPST
     I              BLC2SS                          WGC2SS
     I              BLOTCD                          WGOTCD
     I              BLF5TX                          WGF5TX
     I              BLL5A1                          WGL5A1
     I              BLL6A1                          WGL6A1
     I              BLJQST                          WGJQST
     I              BLC4SS                          WGC4SS
     I              BLC5SS                          WGC5SS
     I              BLC3SS                          WGC3SS
     I              BLOKA1                          WGOKA1
     I              BLOLA1                          WGOLA1
     I              BLOMA1                          WGOMA1
     I              BLQ0CD                          WGQ0CD
     I              BLWSA1                          WGWSA1
     I              BLWOA1                          WGWOA1
     I              BLHFDT                          WGHFDT
     I              BLB2TM                          WGB2TM
     I              BLHMNB                          WGHMNB
     I              BLBNNB                          WGBNNB
     I              BLBONB                          WGBONB
     I              BLCVNB                          WGCVNB
     I              BLB0DT                          WGB0DT
     I              BLABCD                          WGABCD
     I              BLAECD                          WGAECD
     I              BLAAVN                          WGAAVN
     I              BLAADT                          WGAADT
     I              BLAMTM                          WGAMTM
     I              BLAJST                          WGAJST
     I              BLAHVN                          WGAHVN
     I              BLAGVN                          WGAGVN
     I              BLABVN                          WGABVN
     I              BLABDT                          WGABDT
     I              BLABTM                          WGABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKEF1    E DSPKEFCPL0
      * UPD : Producer Cntrct RsvAct Dt Update index
      * Renamed input format fields
     I              EFAKCD                          WAAKCD
     I              EFDMDT                          WADMDT
     I              EFPADS                          WAPADS
     I              EFEKVA                          WAEKVA
     I              EFSKST                          WASKST
     I              EFHMNB                          WAHMNB
     I              EFBNNB                          WABNNB
     I              EFBONB                          WABONB
     I              EFCVNB                          WACVNB
     I              EFB0DT                          WAB0DT
     I              EFAAVN                          WAAAVN
     I              EFAADT                          WAAADT
     I              EFAMTM                          WAAMTM
     I              EFAJST                          WAAJST
     I              EFAHVN                          WAAHVN
     I              EFAGVN                          WAAGVN
     I              EFABVN                          WAABVN
     I              EFABDT                          WAABDT
     I              EFABTM                          WAABTM
      *
     IQPKEE1    E DSPKEECPL1
      * UPD : Producer Cntrct RsvAct Hd Update index
      *
     IYARDCS      DS                             74
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKD71    E DSPKD7CPL0
      * UPD : Tattoo Fax Driver         Update index
      *
     IQPKBK1    E DSPKBKCPL1
      * UPD : Hog Voucher Header        Update index
      * Renamed input format fields
     I              BKHNNB                          WCHNNB
     I              BKLWNB                          WCLWNB
     I              BKG9NB                          WCG9NB
     I              BKLXNB                          WCLXNB
     I              BKLYNB                          WCLYNB
     I              BKCSST                          WCCSST
     I              BKDKNB                          WCDKNB
     I              BKA2DT                          WCA2DT
     I              BKCIPR                          WCCIPR
     I              BKCJPR                          WCCJPR
     I              BKCKPR                          WCCKPR
     I              BKCLPR                          WCCLPR
     I              BKCMPR                          WCCMPR
     I              BKAUVA                          WCAUVA
     I              BKAVVA                          WCAVVA
     I              BKCHPR                          WCCHPR
     I              BKAJVA                          WCAJVA
     I              BKBUPC                          WCBUPC
     I              BKJHST                          WCJHST
     I              BKC0ST                          WCC0ST
     I              BKA4DT                          WCA4DT
     I              BKCUST                          WCCUST
     I              BKABCD                          WCABCD
     I              BKBNCD                          WCBNCD
     I              BKCFCD                          WCCFCD
     I              BKAAVN                          WCAAVN
     I              BKAADT                          WCAADT
     I              BKAMTM                          WCAMTM
     I              BKAJST                          WCAJST
     I              BKAHVN                          WCAHVN
     I              BKAGVN                          WCAGVN
     I              BKABVN                          WCABVN
     I              BKABDT                          WCABDT
     I              BKABTM                          WCABTM
      *
     IQPKBL1    E DSPKBLCPL0
      * UPD : Hog Voucher Detail        Update index
      *
     IYBRDCS      DS                            157
     IYCRDCS      DS                            157
     IQPKCA1    E DSPKCACPL0
      * UPD : Hog Voucher Split         Update index
      *
     IYDRDCS      DS                            157
     IYERDCS      DS                            157
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             21
      * KEY: Tattoo Header             Co/Prd/Loc/KlDte/Tto/Unp
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP TH Kill Date
     I                                    P  15  180P1B0DT
     IP2PARM      DS
      * I : MAP @Status Edit/Post
     I                                        1   1 P2J2ST
     IP3PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P3EVTX
     IP4PARM      DS
      * I : MAP @Status Unpaid/All Usr
     I                                        1   1 P4J4ST
     IP5PARM      DS
      * B : MAP Pmt Payment Error
     I                                        1   1 P5KLST
     IP6PARM      DS
      * FLD: Producer Location
      * N :  Pl VND Address Number
     I                                        1   80P6GLNB
      * N :  PL Fax Status
     I                                        9   9 P6AUST
      * N :  PL Fax   Carcass Summary
     I                                       10  10 P6QNST
      * N :  PL Unused
     I                                       11  11 P6QOST
      * N :  PL Fax   Carcass Detail
     I                                       12  12 P6QPST
      * N :  PL Fax to Producer
     I                                       13  13 P6QQST
      * N :  PL Producer Fax Sequence
     I                                       14  14 P6QRST
     IP7PARM      DS
      * FLD: STR VND Common Routines
      * N :  Fax Area Code #
     I                                        1   6 P7LSTX
      * N :  Fax Telephone
     I                                        7  26 P7LRTX
      * N :  Fax Attn 1
     I                                       27  66 P7NVTX
      * N :  Fax Area Code # 2
     I                                       67  72 P7NGTX
      * N :  Fax Telephone 2
     I                                       73  92 P7NHTX
      * N :  Fax Attn 2
     I                                       93 132 P7NWTX
     IP8PARM      DS
      * FLD: Producer
      * N :  PD VND Address Number
     I                                        1   80P8GCNB
      * N :  Commission Producer Payee
     I                                        9  14 P8ADCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Alt Prd Payee message'
      * PD Producer Code
     I                                        1   6 ZA0001
      * Alt Producer Payee
     I                                        7  12 ZA0002
      * BOH Company Number
     I                                    P  13  140ZA0003
      * BOH Buy Order Number
     I                                    P  15  180ZA0004
      * BOL Load Number
     I                                    P  19  210ZA0005
      * TH Tattoo Number
     I                                    P  22  240ZA0006
      * TH Kill Date
     I                                    P  25  280ZA0007
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Tattoo Hea
     C           P2J2ST    PARM           WP0001  1        @Status Edit/Po
     C           P3EVTX    PARM           WP0002 40        Oms System Valu
     C           P4J4ST    PARM           WP0003  1        @Status Unpaid/
     C           P5KLST    PARM P5KLST    WP0004  1        Pmt Payment Err
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Payment Edit/Post PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$NENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Payment Edit/Post PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
      * Establish starting position
     C           KRSA      SETLL@A1CPZL                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL02  1        PL Location Cod
     C                     MOVEL'Y'       W0AL03  1        TH Kill Date
     C                     MOVEL'Y'       W0AL04  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $MB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $MLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     $MBBVA           Gross Total SUM
     C                     Z-ADD*ZERO     $MBCVA           Ded Total SUM
     C                     Z-ADD*ZERO     $MBDVA           Net Total SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     MOVELA1ABCD    $DABCD           PD Producer Cod
     C                     MOVELA1AECD    $DAECD           PL Location Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $EHMNB           BOH Company Num
     C                     MOVELA1ABCD    $EABCD           PD Producer Cod
     C                     Z-ADDA1CVNB    $ECVNB           TH Tattoo Numbe
     C                     Z-ADDA1FENB    $EFENB           TH Head Killed
     C                     Z-ADDA1AWPC    $EAWPC           TH Actual Yield
     C                     Z-ADDA1CYNB    $ECYNB           TH Live Wgt
     C                     Z-ADDA1F4NB    $EF4NB           TH Avg Lean Per
     C                     Z-ADDA1ANPR    $EANPR           TH CM Base Mkt
     C                     Z-ADDA1AXVA    $EAXVA           TH CM LN AddOn/
     C                     Z-ADDA1AWVA    $EAWVA           TH CM Yield Gai
     C                     Z-ADDA1AYVA    $EAYVA           TH CM Sort Disc
     C                     Z-ADDA1AOPR    $EAOPR           TH CM Base Carc
     C                     Z-ADDA1CBPR    $ECBPR           TH Payment Gros
     C                     Z-ADDA1A5VA    $EA5VA           TH Additions Am
     C                     Z-ADDA1ASPR    $EASPR           TH Deduction Am
     C                     Z-ADDA1CCPR    $ECCPR           Th Payment Net
     C                     MOVELA1BICD    $EBICD           TH Group Refere
     C                     MOVELA1CPST    $ECPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $EACPR           TH Live Purchas
     C                     Z-ADDA1HENB    $EHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $EHFNB           TH Head Accepte
     C                     Z-ADDA1LRNB    $ELRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $EE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $EA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $EFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $EA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $EF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    $EHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    $EF5NB           TH Avg Light Re
     C                     Z-ADDA1F3NB    $EF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $EF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    $EAVPC           TH Std Yield Pe
     C                     Z-ADDA1CWPC    $ECWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    $EA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $EA7PC           TH Recalc Live
     C                     Z-ADDA1B0DT    $EB0DT           TH Kill Date
     C                     Z-ADDA1AMPR    $EAMPR           TH CM Base Mkt
     C                     Z-ADDA1TBPR    $ETBPR           TH Excluded Gro
     C                     Z-ADDA1B9PR    $EB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $ECAPR           TH LIve Net Amt
     C                     Z-ADDA1BNNB    $EBNNB           BOH Buy Order N
     C                     Z-ADDA1CWNB    $ECWNB           TH Head Receive
     C                     Z-ADDA1B8PR    $EB8PR           TH CM Market Pr
     C                     MOVELA1CSCD    $ECSCD           THP Process Cod
     C                     Z-ADDA1APPR    $EAPPR           TH CM Carcass G
     C                     Z-ADDA1ATPR    $EATPR           TH Carcass Net
     C                     Z-ADDA1BONB    $EBONB           BOL Load Number
     C                     Z-ADDA1H9NB    $EH9NB           TH Held Over
     C                     Z-ADDA1AWDT    $EAWDT           TH Purchase Dat
     C                     MOVELA1BECD    $EBECD           HC Class Code
     C                     Z-ADDA1CXNB    $ECXNB           TH Dead On Arri
     C                     Z-ADDA1FCNB    $EFCNB           TH Yard Deads
     C                     Z-ADDA1FDNB    $EFDNB           TH Head Condemn
     C                     Z-ADDA1A4VA    $EA4VA           TH Total Net WO
     C                     Z-ADDA1LPNB    $ELPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $ECDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $EA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $EA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $EJWST           TH Calc Net Sts
     C                     MOVELA1D7ST    $ED7ST           TH Header Error
     C                     MOVELA1D8ST    $ED8ST           TH Detail Error
     C                     MOVELA1DWST    $EDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $ED6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $EGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $EBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $EE0ST           TH User Error O
     C                     MOVELA1E1ST    $EE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $EE2ST           TH Sex
     C                     Z-ADDA1BSDT    $EBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $EBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $EBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $EHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $EHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $EHINB           TH FFLI
     C                     Z-ADDA1A3PR    $EA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $EA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $EA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $EJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $ED6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $ED7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $ED8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $ED9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $EEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $EEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $EECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $EEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $EEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $EEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $EEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $EEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $EKAST           TH Source Type
     C                     MOVELA1J7ST    $EJ7ST           TH Scale Ticket
     C                     MOVELA1J8ST    $EJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $ELIST           TH Schedule Kil
     C                     MOVELA1LJST    $ELJST           TH Shift Held O
     C                     MOVELA1NZTX    $ENZTX           TH State
     C                     MOVELA1HJCD    $EHJCD           TH Unused Code
     C                     MOVELA1R4ST    $ER4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $ER5ST           TH Commission S
     C                     MOVELA1R6ST    $ER6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $ER7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $ETHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $ET2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $ETHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $ET2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $EOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $EKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $EOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $EOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $EIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $EOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $EOQET           TH PHA Add Type
     C                     MOVELA1URST    $EURST           TH PHA Average
     C                     MOVELA1USST    $EUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $EHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $ES9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $ETAPR           TH VC Gross Val
     C                     Z-ADDA1JFUR    $EJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $EKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $EKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $EKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $EKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $EOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $EIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $EIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $EIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $EKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $EOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $EKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $EORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $EOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $EMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $EMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $ENCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $ENCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $EIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $EKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $EEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $EEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    $EECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $EEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    $EEEDT           TH Unused Date
     C                     MOVELA1U4ST    $EU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $EU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $EU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $EU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $EU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $EU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $EVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $EVBST           TH Unused Sts 8
     C                     MOVELA1J9ST    $EJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    $EOXNB           TH HPS Movement
     C                     MOVELA1LKST    $ELKST           TH Source Code
     C                     MOVELA1LLST    $ELLST           TH Hog Class Ty
     C                     MOVELA1AGCD    $EAGCD           GN Genetic Code
     C                     MOVELA1C4ST    $EC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $EAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $EA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $EC2ST           TH Resale Sprea
     C                     MOVELA1CWST    $ECWST           TH Payment Sts
     C                     MOVELA1BDCD    $EBDCD           DF Defect Code
     C                     MOVELA1AECD    $EAECD           PL Location Cod
     C                     MOVELA1ACCD    $EACCD           HB Buyer Code
     C                     MOVELA1AAVN    $EAAVN           RS User Changed
     C                     Z-ADDA1AADT    $EAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $EAMTM           RS Time Changed
     C                     MOVELA1AJST    $EAJST           RS Record Statu
     C                     MOVELA1AHVN    $EAHVN           RS Job
     C                     MOVELA1AGVN    $EAGVN           RS Program
     C                     MOVELA1ABVN    $EABVN           RS User Added
     C                     Z-ADDA1ABDT    $EABDT           RS Date Added
     C                     Z-ADDA1ABTM    $EABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PO BO Header
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Ttt D/A,Accum Comm PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt PrdEmailHdr       PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt PrdEmlDtl         PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt PrdLocEmlHdr      PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt PrdLocEmlDtl      PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $EFENB    $MB4NB           Head Total SUM
     C                     ADD  $ECBPR    $MBBVA           Gross Total SUM
     C                     ADD  WUBEVA    $MBCVA           Ded Total SUM
     C                     ADD  $ECCPR    $MBDVA           Net Total SUM
      * If Posting rtn then Post unpd Producer's  OR Programmer Testing
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * Process unpaid producers
      * CASE: CUR.TH Payment Sts is Unpaid Producer
     C           $ECWST    IFEQ 'ML'                       *IF
     C           $ECWST    OREQ 'SL'
     C           $ECWST    OREQ 'SC'
     C           $ECWST    OREQ 'IC'
     C           $ECWST    OREQ 'IL'
     C           $ECWST    OREQ *BLANK
      *
     C                     MOVEL*BLANK    WN0001  5        PC Contract Cod
     C                     Z-ADD*ZERO     WN0002  50       PAD Transaction
     C                     Z-ADD*ZERO     WN0003 152       PAD Transaction
     C                     Z-ADD*ZERO     WN0004  52       PSC FLoor Price
     C                     MOVEL*BLANK    WN0005  1        PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0006  72       THD Ded/Add Amo
      *
      * Upd Reserv Acct Trans IF
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
     C                     EXSR SDRVGN
      * CASE: PAR.PSC Sub-Contract Type is Market/Carcass Merit
     C           WN0005    IFEQ 'M'                        *IF
      * Rtv Reserve Acct D/A  RT - Tattoo Ded/Add  * 
     C                     EXSR SFRVGN
      * CASE: PAR.THD Ded/Add Amount NE WRK.Zero USR
     C           WN0006    IFNE WUE9NB                     *IF
     C                     Z-ADDWN0006    WN0003           PAD Transaction
      * Rtv Last Seq# for Dte RT - Producer Cntrct RsvAct Dt  * 
     C                     EXSR SGRVGN
     C                     ADD  1         WN0002           PAD Transaction
      * this also updates the header balance
      * Crt Reserve Acct Dtl  CR - Producer Cntrct RsvAct Dt  * 
     C                     EXSR SHCRRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CUR.TH Held Over Record is Not a Held Over Ttt Rcd
     C           $EE1ST    IFEQ *BLANK                     *IF
     C           $EE1ST    OREQ 'N'
      * All records except the last held over record
      * the held over record will be accumulate in the next section
      * Tattoo Fax Driver used to create carc sum/dtl for print and fax
      * CASE: Market or subject create a tattoo header driver
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'                        *OR
      * CASE: DB1.TH Source Type is External
     C           A1KAST    IFEQ 'E'                        *IF
      * Externals check to create a tattoo driver- 1 rcd for carc sum/dtl
      * CASE: select live, or mark live
      *  - c1 OR c2
      *   |- c1    : CUR.TH Payment Sts is Mark Live Payment
      *   |- c2    : CUR.TH Payment Sts is Select Live
      *   '-
     C           $ECWST    IFEQ 'ML'                       *IF
     C           $ECWST    OREQ 'SL'                       *OR
      * Output one record to print both Carc Sum and Carc Dtl
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * 8/25/98  Output blank in TFD Header Action-Crc Dtl so dtls wont p
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SJCRRC
      * Fax Crc Sum/Dtl    - change text 12/14/2007 slm
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PL Fax Status is Yes
      *   |- c2    : PAR.PL Fax to Producer is Yes
      *   '-
     C           P6AUST    IFEQ 'Y'                        *IF
     C           P6QQST    OREQ 'Y'                        *OR
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PL Fax   Carcass Summary is Yes
     C           P6QNST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.TFD Header Action-Crc Dtl NE WRK.Blank USR
      *   |- c2    : WRK.TFD Header Action-Crc Sum NE WRK.Blank USR
      *   '-
     C           WUNPTX    IFNE WUCRTX                     *IF
     C           WUNKTX    ORNE WUCRTX                     *OR
      * CASE: PAR.Fax Telephone is Not Blank
     C           P7LRTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
      * CASE: PAR.Fax Telephone 2 is Not Blank
     C           P7NHTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SLCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 1 USR is Not Blank
     C           WUNNTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SMCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 2 USR is Not Blank
     C           WUNOTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SNCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: CUR.TH Payment Sts is Sl Carcass Merit
     C           $ECWST    IFEQ 'SC'                       *IF
      * Output one record to print both Carc Sum and Carc Dtl
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SOCRRC
      * NEW Fax Crc Sum/Dtl
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PL Fax Status is Yes
      *   |- c2    : PAR.PL Fax to Producer is Yes
      *   '-
     C           P6AUST    IFEQ 'Y'                        *IF
     C           P6QQST    OREQ 'Y'                        *OR
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PL Fax   Carcass Summary is Yes
     C           P6QNST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE: PAR.PL Fax   Carcass Detail is Yes
     C           P6QPST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   WUNPTX           TFD Header Acti
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.TFD Header Action-Crc Dtl NE WRK.Blank USR
      *   |- c2    : WRK.TFD Header Action-Crc Sum NE WRK.Blank USR
      *   '-
     C           WUNPTX    IFNE WUCRTX                     *IF
     C           WUNKTX    ORNE WUCRTX                     *OR
      * CASE: PAR.Fax Telephone is Not Blank
     C           P7LRTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SPCRRC
     C                     END                             *FI
      * CASE: PAR.Fax Telephone 2 is Not Blank
     C           P7NHTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SQCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 1 USR is Not Blank
     C           WUNNTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SRCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 2 USR is Not Blank
     C           WUNOTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * EMAIL RECORDS TO THE TATTOO FAX DRIVER
     C                     EXSR UHSUBR                     EMAIL RECORDS T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Live Vchr Detail  IF
      * E004069 RMC 6/5/15 Recompile for new ERP Fields
      * Accumulate gross, net, d/a amts and create voucher header, detail
      * Break in producer  or kill date
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PD Producer Code NE WRK.Producer Code         US
      *   |- c2    : PAR.TH Kill Date NE WRK.TH Kill Date
      *   '-
     C           $EABCD    IFNE WUARCD                     *IF
     C           $EB0DT    ORNE WUB0DT                     *OR
     C                     MOVEL$EABCD    WUARCD           Producer Code
     C                     Z-ADD$EB0DT    WUB0DT           TH Kill Date
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
     C                     EXSR TARVGN
      * Rtv Producer Split    RT - Producer Std Split  * 
     C                     EXSR TBRVGN
      * VCH AP Address Number
     C                     EXSR UISUBR                     VCH AP Address
      * Payee type values
      * CASE: PAR.TH Source Type is Internal
     C           $EKAST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUCSST           VCH Payee Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUCSST           VCH Payee Type
     C                     END                             *FI
      * Changed back to TH Kill date 12/22/99.  -Purva
      * Crt Voucher Header    CR - Hog Voucher Header  * 
     C                     EXSR TECRRC
     C                     Z-ADD*ZERO     WUAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WUAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WUCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WUCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WUCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WUCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WUCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WUCMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     WUDLNB           VCD Line
     C                     END                             *FI
     C                     ADD  1         WUDLNB           VCD Line
      * Detail totals
      * Accum total Tattoo amounts into work fields for Voucher Header
      * CASE: If held over, call tattoo total function
      *  - c1 OR c2
      *   |- c1    : PAR.TH Held Over is greater than 0
      *   |- c2    : PAR.TH Held/Ovr Completed Dte is Greater than 0
      *   '-
     C           $EH9NB    IFGT 0                          *IF
     C           $EBSDT    ORGT 0                          *OR
      * If Held over then head will be accumulated in the combined accum
      *
     C                     Z-ADD*ZERO     WN0120 152       Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0121 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0122 152       Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0123 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0124 152       Loin-Eye * Wgt
      *
      * Prt Crc Sum (Hld Ovr) IF
      * Modification History Created Str slm 061208
     C                     EXSR UJSUBR                     Modification Hi
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB5DT           TH Kill Date
     C                     Z-ADD*ZERO     WUCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHENB           TH Head Adds
     C                     Z-ADD*ZERO     WUCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WUF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WUAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WUCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WUAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WUASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WUCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WUCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WUA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WUHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WUHINB           TH FFLI
     C                     Z-ADD*ZERO     WUJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WUD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WUD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WUD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WUD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WUEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WUEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WUECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WUEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WUEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WUEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WUIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WUOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WUTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WUKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WUOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WUKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WUMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WUECDT           TH Head LFT
     C                     Z-ADD*ZERO     WUEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0120           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0121           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0122           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0123           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0124           Loin-Eye * Wgt
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
     C                     EXSR TFRVGN
      * Calculate Live /CWT and Carc /CWT
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * Calculate Carc/CWT if Par.Th Hot Wt is n= 0
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           WUE0NB    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Carc /CWT
      * PAR.TH CM Bse Mkt Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUANPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD7PR           TH CM Bse Mkt C
      * TH CM Srt Dsc Carc /CWT
      * PAR.TH CM Srt Dsc Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD9PR           TH CM Srt Dsc C
      * TH CM Crc Val Carc /CWT
      * WRK.TH CM Crc Val Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAOPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEDPR           TH CM Crc Val C
     C                     Z-ADDWUEDPR    WUEDPR           TH CM Crc Val C
      * TH CM Lean Prem Carc /CWT
      * PAR.TH CM Lean Prem Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAXVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEFPR           TH CM Lean Prem
      * TH CM Gross Carc /CWT
      * PAR.TH CM Gross Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAPPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEHPR           TH CM Gross Car
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WUD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WUEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WUEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WUEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEHPR           TH CM Gross Car
     C                     END                             *FI
      * Calculate Live/CWT if Par.Th live wt is n= 0
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           WUCYNB    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Live /CWT
      * PAR.TH CM Bse Mkt Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUANPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD6PR           TH CM Bse Mkt L
      * TH CM Srt Dsc Live /CWT
      * PAR.TH CM Srt Dsc Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD8PR           TH CM Srt Dsc L
      * TH CM Yld G/L live /CWT
      * PAR.TH CM Yld G/L Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEAPR           TH CM Yld G/L L
      * TH CM Crc Val Live /CWT
      * PAR.TH CM Crc Val Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAOPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUECPR           TH CM Crc Val L
      * TH CM Lean Prem Live /CWT
      * PAR.TH CM Lean Prem Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAXVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEEPR           TH CM Lean Prem
      * TH CM Gross Live /CWT
      * PAR.TH CM Gross Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUAPPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEGPR           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WUD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WUEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WUECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WUEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEGPR           TH CM Gross Liv
     C                     END                             *FI
     C                     END                             *FI
      * Calc Avg Live Wt
      * CASE: PAR.TH Head Received is *Zeros
     C           WUCWNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUCYNB    DIV  WUCWNB    WUF7NB           TH Avg Live Wgt
     C                     END                             *FI
      * Calc Adj Live Weight
      * CASE: PAR.TH Head Received EQ PAR.TH Head Killed
     C           WUCWNB    IFEQ WUFENB                     *IF
     C                     Z-ADDWUCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUFENB    MULT WUF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     Z-ADDWUF7NB    WUF7NB           TH Avg Live Wgt
     C                     Z-ADDWULRNB    WULRNB           TH Adj Live Wgt
      * Calc Actual Yield %
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           WUCYNB    IFNE WUE9NB                     *IF
      * TH Actual Yield %
      * PAR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  WUCYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAWPC           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAWPC           TH Actual Yield
     C                     END                             *FI
      * Calc Adj Actual Yield %
      * CASE: PAR.TH Adj Live Wgt NE WRK.Zero USR
     C           WULRNB    IFNE WUE9NB                     *IF
      * TH Adj Actual Yield %
      * PAR.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  WULRNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCWPC           TH Adj Actual Y
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCWPC           TH Adj Actual Y
     C                     END                             *FI
      * Calc Avg Hot Wt
      * CASE: PAR.TH Head Killed NE WRK.Zero USR
     C           WUFENB    IFNE WUE9NB                     *IF
     C           WUE0NB    DIV  WUFENB    WUHDNB    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUHDNB           TH Avg Hot Wgt
     C                     END                             *FI
      * Calc Avg Lean %, Loin eye, & Backfat
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           WUE0NB    IFNE WUE9NB                     *IF
     C           WN0120    DIV  WUE0NB    WUF4NB    H      TH Avg Lean Per
     C           WN0122    DIV  WUE0NB    WUF3NB    H      TH Avg Loin Eye
     C           WN0121    DIV  WUE0NB    WUF2NB    H      TH Avg Backfat
     C           WN0124    DIV  WUE0NB    WUMVNF    H      TH Avg Loin Eye
     C           WN0123    DIV  WUE0NB    WUMCNF    H      TH Avg Backfat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WUF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WUMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUMCNF           TH Avg Backfat
     C                     END                             *FI
      * TH FFLI
      * PAR.TH FFLI =
      *    *COMPUTE (x1 + (x2 * x3) - (x4 * x5))
      * x1    : CON.51.537
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON..035
      * *     : PGM.*Synon (17,7) work field *
      * x3    : PAR.TH Hot Wgt
      * -     : PGM.*Synon (17,7) work field
      * x4    : CON.12.26
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.TH Avg Backfat
     C           .035      MULT WUE0NB    W0WD02           *Synon (17,7) w
     C           51.537    ADD  W0WD02    W0WD01           *Synon (17,7) w
     C           12.26     MULT WUF2NB    W0WD03           *Synon (17,7) w
     C           W0WD01    SUB  W0WD03    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUHINB           TH FFLI
     C           WUA5VA    SUB  WUASPR    WUA9VA           Net Ded/Add amo
     C                     Z-ADDWUCCPR    WUAMVA           VCD Net Amt
      * Header Totals
     C                     ADD  WUCBPR    WUAUVA           VCH Gross Amt
     C                     ADD  WUCCPR    WUAJVA           VCH Net Amt
     C                     ADD  WUA9VA    WUAVVA           VCH Deduction A
      * If carcass payment, output carcass related fields; else zero them
      * CASE: PAR.TH Payment Type is Carcass Merit
     C           $EJ9ST    IFEQ 'C'                        *IF
     C                     ADD  WUANPR    WUCIPR           VCH Base Mkt Pr
     C                     ADD  WUAYVA    WUCJPR           VCH Sort Disc A
     C                     ADD  WUAWVA    WUCKPR           VCH Yield Gain/
     C                     ADD  WUAOPR    WUCLPR           VCH Base Carcas
     C                     ADD  WUAXVA    WUCMPR           VCH LN Add on/D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           $EA5VA    SUB  $EASPR    WUA9VA           Net Ded/Add amo
     C                     Z-ADD$ECCPR    WUAMVA           VCD Net Amt
      * Header Totals
     C                     ADD  $ECBPR    WUAUVA           VCH Gross Amt
     C                     ADD  $ECCPR    WUAJVA           VCH Net Amt
     C                     ADD  WUA9VA    WUAVVA           VCH Deduction A
      * If Carcass payment, output carcass related fields; else zero them
      * CASE: PAR.TH Payment Type is Carcass Merit
     C           $EJ9ST    IFEQ 'C'                        *IF
     C                     ADD  $EANPR    WUCIPR           VCH Base Mkt Pr
     C                     ADD  $EAYVA    WUCJPR           VCH Sort Disc A
     C                     ADD  $EAWVA    WUCKPR           VCH Yield Gain/
     C                     ADD  $EAOPR    WUCLPR           VCH Base Carcas
     C                     ADD  $EAXVA    WUCMPR           VCH LN Add on/D
     C                     Z-ADD$EANPR    WUANPR           TH CM Base Mkt
     C                     Z-ADD$EAYVA    WUAYVA           TH CM Sort Disc
     C                     Z-ADD$EAWVA    WUAWVA           TH CM Yield Gai
     C                     Z-ADD$EAOPR    WUAOPR           TH CM Base Carc
     C                     Z-ADD$EAXVA    WUAXVA           TH CM LN AddOn/
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     END                             *FI
     C                     Z-ADD$ECCPR    WUCCPR           Th Payment Net
     C                     Z-ADD$ECBPR    WUCBPR           TH Payment Gros
      * IF NOT HELD OVER THEN USE HEAD COUNT FROM PAR
     C                     Z-ADD$ECWNB    WUCWNB           TH Head Receive
     C                     Z-ADD$EFENB    WUFENB           TH Head Killed
     C                     END                             *FI
      * If Split producer - calc split amt and new net amount
      * CASE: WRK.VCH Split % is Not 100 %
     C           WUBUPC    IFNE 100                        *IF
     C           WUBUPC    DIV  100       WUL9NB           Percent Decimal
     C           WUL9NB    MULT WUCCPR    WUAMVA    H      VCD Net Amt
     C           WUAMVA    SUB  WUCCPR    WUCVPR           VCD Less Split
     C                     ADD  WUCVPR    WUCHPR           VCH Less Split
     C                     ADD  WUCVPR    WUAJVA           VCH Net Amt
      * (Split amount is negative in voucher header,detail files.)
     C                     END                             *FI
      * Rtv BOH Py Typ,BO Typ RT - Buy Order Header  * 
     C                     EXSR THRVGN
      * WRK.HC Description = Condition name of PAR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $ELLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUBDTX    PARM           W0CNNM 25        HC Description
      *
     C                     Z-ADD$ECVNB    WUMLNB           Tattoo Nbr 4
     C                     MOVEL*BLANK    WUDUCD           Tattoo Nbr Alph
     C                     MOVELWUMLNB    WUDUCD           Tattoo Nbr Alph
     C                     Z-ADD2         ZQ      50
     C           WUDUCD    CAT  WUBDTX:ZQ WUF5TX    P      VCD Check Descr
     C                     MOVEL$ELLST    WUJIST           VCD Hog Class T
      * TATTOO ACTION OF CARCASS TO LIVE, OR LIVE TO CARCASS
      * CASE: WRK.BOH Payment Type NE PAR.TH Payment Type
     C           WUA4ST    IFNE $EJ9ST                     *IF
      * CASE: PAR.TH Hog Class Type is Not Subject
     C           $ELLST    IFEQ 'M'                        *IF
     C           $ELLST    OREQ 'R'
      * CASE: PAR.TH Payment Type is Live
     C           $EJ9ST    IFEQ 'L'                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $EHMNB    WQ0052  30       BOH Company Num
     C                     PARM $EBNNB    WQ0053  70       BOH Buy Order N
     C                     PARM $EBONB    WQ0054  50       BOL Load Number
     C                     PARM $ECVNB    WQ0055  50       TH Tattoo Numbe
     C                     PARM $EB0DT    WQ0056  70       TH Kill Date
     C                     PARM *ZERO     WQ0057  50       TH Head Receive
     C                     PARM *ZERO     WQ0058  50       TH Held Over
     C                     PARM *ZERO     WQ0059  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0060  70       TH Voucher Paym
     C                     PARM 'CL'      WQ0061  2        Tattoo Action U
     C                     PARM *BLANK    WQ0062  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $EHMNB    WQ0063  30       BOH Company Num
     C                     PARM $EBNNB    WQ0064  70       BOH Buy Order N
     C                     PARM $EBONB    WQ0065  50       BOL Load Number
     C                     PARM $ECVNB    WQ0066  50       TH Tattoo Numbe
     C                     PARM $EB0DT    WQ0067  70       TH Kill Date
     C                     PARM *ZERO     WQ0068  50       TH Head Receive
     C                     PARM *ZERO     WQ0069  50       TH Held Over
     C                     PARM *ZERO     WQ0070  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0071  70       TH Voucher Paym
     C                     PARM 'LC'      WQ0072  2        Tattoo Action U
     C                     PARM *BLANK    WQ0073  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * fp1284 get the Source Contract Type
      * Rtv Prdcr Vnd#,Src,CntRT - Producer  * 
     C                     EXSR TIRVGN
      * SDN440 10/07/21 Added this to format the supplier like we do for
      * Format Supplier invoice number -  prints on check stub  SDN440 ad
      * CASE: PAR.BOH Company Number is Greater Then *zero
     C           $EHMNB    IFGT 0                          *IF
     C                     MOVEL$EBNNB    YL0004           Buy Order Numbe
     C                     Z-ADD$EBONB    YL0005           Buy Order Load
     C                     MOVELYL0005    YL0006           Buy Order Load
     C                     Z-ADD$ECVNB    YL0007           Tattoo Nbr 4
     C                     MOVELYL0007    YL0008           Tattoo Nbr Alph
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0006    CAT  '-':ZQ    YL0009    P      Buy Order Load
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0004    CAT  '-':ZQ    YL0010    P      Text 8 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0010    CAT  YL0009:ZQ YL0011    P      Text 13 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0011    CAT  YL0008:ZQ YL0012    P      Text 17 USR
     C                     MOVEL*BLANK    YL0013           MGL Supplier In
     C                     MOVELYL0012    YL0013           MGL Supplier In
     C                     END                             *FI
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
     C                     EXSR TKCRRC
     C                     MOVEL'R'       WUKFST           @Status Crt Vch
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.@Status Edit/Post is Edit
     C           P2J2ST    IFEQ 'E'                        *IF
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,002                    *IF
     C           ##USR     OREQ @CN,003
     C           ##USR     OREQ @CN,004
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Process Create of the Tattoo Fax Driver only
      * CASE: CUR.TH Payment Sts is Unpaid Producer
     C           $ECWST    IFEQ 'ML'                       *IF
     C           $ECWST    OREQ 'SL'
     C           $ECWST    OREQ 'SC'
     C           $ECWST    OREQ 'IC'
     C           $ECWST    OREQ 'IL'
     C           $ECWST    OREQ *BLANK
      * CASE: CUR.TH Held Over Record is Not a Held Over Ttt Rcd
     C           $EE1ST    IFEQ *BLANK                     *IF
     C           $EE1ST    OREQ 'N'
      * All records except the last held over record
      * the held over record will be accumulate in the next section
      * Tattoo Fax Driver used to create carc sum/dtl for print and fax
      * CASE: Market or subject create a tattoo header driver
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'                        *OR
      * CASE: DB1.TH Source Type is External
     C           A1KAST    IFEQ 'E'                        *IF
      * Externals check to create a tattoo driver- 1 rcd for carc sum/dtl
      * CASE: select live, or mark live
      *  - c1 OR c2
      *   |- c1    : CUR.TH Payment Sts is Mark Live Payment
      *   |- c2    : CUR.TH Payment Sts is Select Live
      *   '-
     C           $ECWST    IFEQ 'ML'                       *IF
     C           $ECWST    OREQ 'SL'                       *OR
      * Output one record to print both Carc Sum and Carc Dtl
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * 8/25/98  Output blank in TFD Header Action-Crc Dtl so dtls wont p
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TLCRRC
      * Fax Crc Sum/Dtl    - change text 12/14/2007 slm
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PL Fax Status is Yes
      *   |- c2    : PAR.PL Fax to Producer is Yes
      *   '-
     C           P6AUST    IFEQ 'Y'                        *IF
     C           P6QQST    OREQ 'Y'                        *OR
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PL Fax   Carcass Summary is Yes
     C           P6QNST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.TFD Header Action-Crc Dtl NE WRK.Blank USR
      *   |- c2    : WRK.TFD Header Action-Crc Sum NE WRK.Blank USR
      *   '-
     C           WUNPTX    IFNE WUCRTX                     *IF
     C           WUNKTX    ORNE WUCRTX                     *OR
      * CASE: PAR.Fax Telephone is Not Blank
     C           P7LRTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TMCRRC
     C                     END                             *FI
      * CASE: PAR.Fax Telephone 2 is Not Blank
     C           P7NHTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TNCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 1 USR is Not Blank
     C           WUNNTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TOCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 2 USR is Not Blank
     C           WUNOTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TPCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: CUR.TH Payment Sts is Sl Carcass Merit
     C           $ECWST    IFEQ 'SC'                       *IF
      * Output one record to print both Carc Sum and Carc Dtl
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TQCRRC
      * NEW Fax Crc Sum/Dtl
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PL Fax Status is Yes
      *   |- c2    : PAR.PL Fax to Producer is Yes
      *   '-
     C           P6AUST    IFEQ 'Y'                        *IF
     C           P6QQST    OREQ 'Y'                        *OR
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PL Fax   Carcass Summary is Yes
     C           P6QNST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE: PAR.PL Fax   Carcass Detail is Yes
     C           P6QPST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   WUNPTX           TFD Header Acti
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.TFD Header Action-Crc Dtl NE WRK.Blank USR
      *   |- c2    : WRK.TFD Header Action-Crc Sum NE WRK.Blank USR
      *   '-
     C           WUNPTX    IFNE WUCRTX                     *IF
     C           WUNKTX    ORNE WUCRTX                     *OR
      * CASE: PAR.Fax Telephone is Not Blank
     C           P7LRTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TRCRRC
     C                     END                             *FI
      * CASE: PAR.Fax Telephone 2 is Not Blank
     C           P7NHTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TSCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 1 USR is Not Blank
     C           WUNNTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TTCRRC
     C                     END                             *FI
      * CASE: WRK.Fax Telephone Prdcr 2 USR is Not Blank
     C           WUNOTX    IFNE *BLANK                     *IF
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TUCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * EMAIL RECORDS TO THE TATTOO FAX DRIVER
     C                     EXSR UKSUBR                     EMAIL RECORDS T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WUKTST           @Status Kill Dt
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1ABCD    WZA002           PD Producer Cod
     C                     MOVELA1ABCD    WZA002
     C           *LIKE     DEFN A1AECD    WZA003           PL Location Cod
     C                     MOVELA1AECD    WZA003
     C           *LIKE     DEFN A1B0DT    WZA004           TH Kill Date
     C                     Z-ADDA1B0DT    WZA004
     C           *LIKE     DEFN A1CVNB    WZA005           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPZL                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Kill Date/ Also Check Held Over's
      * CASE: DB1.TH Kill Date LE PAR.TH Kill Date
     C           A1B0DT    IFLE P1B0DT                     *IF
      * Held over
      * CASE: DB1.TH Held Over NE WRK.Zero USR
     C           A1H9NB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Held/Ovr Completed Dte NE WRK.Zero USR
     C           A1BSDT    IFNE WUE9NB                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        PD Producer Cod
     C                     MOVEL*BLANK    W0AL02  1        PL Location Cod
     C                     MOVEL*BLANK    W0AL03  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL04  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL02  1        PL Location Cod
     C                     MOVEL'Y'       W0AL03  1        TH Kill Date
     C                     MOVEL'Y'       W0AL04  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1ABCD    IFNE WZA002                     PD Producer Cod
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1AECD    IFNE WZA003                     PL Location Cod
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1B0DT    IFNE WZA004                     TH Kill Date
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           A1CVNB    IFNE WZA005                     TH Tattoo Numbe
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
      * USER: Process after print of TH Kill Date format
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * Crt Live Vchr Totals  IF
      * CASE: WRK.Producer Code         USR NE WRK.Blank USR
     C           WUARCD    IFNE WUCRTX                     *IF
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
     C                     EXSR NCRVGN
     C                     MOVEL'Y'       WUABST           @Status (Yes/No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUABST           @Status (Yes/No
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WUAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WUCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WUCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WUCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WUCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WUCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WUCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WUA9VA           Net Ded/Add amo
     C                     Z-ADD*ZERO     WUAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WUAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WUCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WUCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WUCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WUCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WUCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WUCMPR           VCH LN Add on/D
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
     C                     EXSR NERVGN
     C                     MOVEL'Y'       WUKTST           @Status Kill Dt
     C                     END                             *FI
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of PD Producer Code format
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * CASE: WRK.@Status Kill Dt Break is Yes
     C           WUKTST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Live Vchr Totals  IF
      * CASE: WRK.Producer Code         USR NE WRK.Blank USR
     C           WUARCD    IFNE WUCRTX                     *IF
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
     C                     EXSR NQRVGN
     C                     MOVEL'Y'       WUABST           @Status (Yes/No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUABST           @Status (Yes/No
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WUAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WUCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WUCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WUCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WUCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WUCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WUCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WUA9VA           Net Ded/Add amo
     C                     Z-ADD*ZERO     WUAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WUAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WUCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WUCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WUCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WUCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WUCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WUCMPR           VCH LN Add on/D
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
     C                     EXSR NSRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * CASE: WRK.@Status Crt Vch Rec usr is Records written
     C           WUKFST    IFEQ 'R'                        *IF
      * E004069  RMC 5-14-15 Add check of Live with M3 sts:Orig HPEVCH pg
      * CASE: LCL.Live with M3   USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: LCL.Live with M3 - interco is No/Parallel
     C           YL0002    IFEQ 'N'                        *IF
     C           YL0002    OREQ 'P'
     C                     MOVEL'Y'       WUP4ST           Status 1
      * Natv Crt Vchrs Batch UP - STR VND Common Routines  * 
     C                     CALL 'HPEVCHCL'             90  Natv Crt Vchrs
     C                     PARM W0RTN     WQ0107  7        *Return code
     C                     PARM P1HMNB    WQ0108  30       VCH Company num
     C                     PARM WULWNB    WQ0109  50       VCH Batch Numbe
     C                     PARM WUP4ST    WQ0110  1        Status 1
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HPEVCHCL'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Call orig pgm if Not live or if Parallel
     C                     MOVEL*BLANK    WUP4ST           Status 1
      * Natv Crt Vchrs Batch UP - STR VND Common Routines  * 
     C                     CALL 'HPEVCHCL'             90  Natv Crt Vchrs
     C                     PARM W0RTN     WQ0111  7        *Return code
     C                     PARM P1HMNB    WQ0112  30       VCH Company num
     C                     PARM WULWNB    WQ0113  50       VCH Batch Numbe
     C                     PARM WUP4ST    WQ0114  1        Status 1
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HPEVCHCL'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * E004069  RMC 5-14-15 Add check of Live with M3 sts:new M3 Vchr pg
      * CASE: LCL.Live with M3   USR is No
     C           YL0001    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Call M3 Voucher create if Live or Parallel
      * Exc Crt Prd Vch p/BatchXF - M3 Supplier Payment Head  * 
     C                     CALL 'PLW4XFR'              90  Exc Crt Prd Vch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0115  30       VCH Company num
     C                     PARM WULWNB    WQ0116  50       VCH Batch Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLW4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.BOH Company Number is SBD Farms of Guymon, Ok
     C           P1HMNB    IFEQ 360                        *IF
      * Exc Crt IntPrd GLIntfc UP - M3 GL Interface Head  * 
     C                     CALL 'M3APINT'              90  Exc Crt IntPrd
     C                     PARM WULMST    WQ0117  7        Return Code USR
     C                     PARM P1HMNB    WQ0118  30       VCH Company num
     C                     PARM WULWNB    WQ0119  50       VCH Batch Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'M3APINT' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Prt Tattoo Fax Driver IS
      * Prt Tattoo Print DRV  PF - Tattoo Fax Driver  * 
     C                     CALL 'PLLBPFR'              90  Prt Tattoo Prin
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLLBPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Tattoo Fax Drv    PF - Tattoo Fax Driver  * 
     C                     CALL 'PLLAPFR'              90  Prt Tattoo Fax
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLLAPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Tattoo Email Drv  PF - Tattoo Fax Driver  * 
     C                     CALL 'PLK9PFR'              90  Prt Tattoo Emai
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLK9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * For Testing only Susan Mason will * out when through Testing
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,002                    *IF
     C           ##USR     OREQ @CN,003
     C           ##USR     OREQ @CN,004
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
      * Prt Tattoo Fax Driver IS
      * Prt Tattoo Print DRV  PF - Tattoo Fax Driver  * 
     C                     CALL 'PLLBPFR'              90  Prt Tattoo Prin
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLLBPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Tattoo Fax Drv    PF - Tattoo Fax Driver  * 
     C                     CALL 'PLLAPFR'              90  Prt Tattoo Fax
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLLAPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Tattoo Email Drv  PF - Tattoo Fax Driver  * 
     C                     CALL 'PLK9PFR'              90  Prt Tattoo Emai
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLK9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$MFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PO BO Header: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN AWBNNB    WQKB02           BOH Buy Order N
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
      * Setup key
     C                     Z-ADD$EHMNB    WQKB01           BOH Company Num
     C                     Z-ADD$EBNNB    WQKB02           BOH Buy Order N
      * Establish starting position
     C           KRSB      SETLL@AWCPBI                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAWHMNB    $FHMNB           BOH Company Num
     C                     Z-ADDAWBNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDAWARDT    $FARDT           BOH Buy Order D
     C                     Z-ADDAWASDT    $FASDT           BOH Kill Date
     C                     MOVELAWA4ST    $FA4ST           BOH Payment Typ
     C                     MOVELAWA5ST    $FA5ST           BOH Buy Order T
     C                     Z-ADDAWAAPR    $FAAPR           BOH Market Add/
     C                     MOVELAWA6ST    $FA6ST           BOH Status
     C                     MOVELAWA7ST    $FA7ST           BOH Delv Plan P
     C                     MOVELAWB3ST    $FB3ST           BOH Quote Price
     C                     Z-ADDAWALPR    $FALPR           BOH Quoted Base
     C                     MOVELAWETCD    $FETCD           BOH Commodity M
     C                     MOVELAWEUCD    $FEUCD           BOH Commodity P
     C                     MOVELAWJ5TX    $FJ5TX           BOH Market Date
     C                     Z-ADDAWD5DT    $FD5DT           BOH MPR Reporti
     C                     Z-ADDAWD6DT    $FD6DT           BOH Hedge Date
     C                     Z-ADDAWD7DT    $FD7DT           BOH Unused Date
     C                     Z-ADDAWD8DT    $FD8DT           BOH Unused Date
     C                     Z-ADDAWD9DT    $FD9DT           BOH Unused Date
     C                     Z-ADDAWJOEJ    $FJOEJ           BOH Hedge Head
     C                     Z-ADDAWKOFF    $FKOFF           BOH Hedge Refer
     C                     Z-ADDAWKWPE    $FKWPE           BOH Hedge Time
     C                     Z-ADDAWIMBF    $FIMBF           BOH Unused Nbr
     C                     Z-ADDAWOPTR    $FOPTR           BOH Unused Nbr
     C                     Z-ADDAWOEJD    $FOEJD           BOH Unused Nbr
     C                     Z-ADDAWIRMF    $FIRMF           BOH Unused Nbr
     C                     Z-ADDAWJIRM    $FJIRM           BOH Unused Nbr
     C                     Z-ADDAWJRKF    $FJRKF           BOH Unused Nbr
     C                     Z-ADDAWKFIR    $FKFIR           BOH Unused Nbr
     C                     MOVELAWUZST    $FUZST           BOH MPR Reporti
     C                     MOVELAWU0ST    $FU0ST           BOH MPR EST RPT
     C                     MOVELAWU1ST    $FU1ST           BOH MPR Purchas
     C                     MOVELAWU2ST    $FU2ST           BOH Status 4
     C                     MOVELAWU3ST    $FU3ST           BOH Status 5
     C                     Z-ADDAWHXNB    $FHXNB           PPWS Company Nu
     C                     Z-ADDAWGANB    $FGANB           CW Year
     C                     Z-ADDAWGBNB    $FGBNB           CW Week Number
     C                     MOVELAWABCD    $FABCD           PD Producer Cod
     C                     MOVELAWAECD    $FAECD           PL Location Cod
     C                     MOVELAWAKCD    $FAKCD           PC Contract Cod
     C                     MOVELAWALCD    $FALCD           PSC Sub-Contrac
     C                     MOVELAWAGCD    $FAGCD           GN Genetic Code
     C                     MOVELAWAICD    $FAICD           PO Option Code
     C                     MOVELAWAMCD    $FAMCD           CMP Program Cod
     C                     MOVELAWACCD    $FACCD           HB Buyer Code
     C                     MOVELAWAAVN    $FAAVN           RS User Changed
     C                     Z-ADDAWAADT    $FAADT           RS Date Changed
     C                     Z-ADDAWAMTM    $FAMTM           RS Time Changed
     C                     MOVELAWAJST    $FAJST           RS Record Statu
     C                     MOVELAWAHVN    $FAHVN           RS Job
     C                     MOVELAWAGVN    $FAGVN           RS Program
     C                     MOVELAWABVN    $FABVN           RS User Added
     C                     Z-ADDAWABDT    $FABDT           RS Date Added
     C                     Z-ADDAWABTM    $FABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AWHMNB    WZB001           BOH Company Num
     C                     Z-ADDAWHMNB    WZB001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@AWCPBI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     ELSE
      * Next record - Detect level breaks
     C           AWHMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Ttt D/A            PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN CDHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN CDBNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN CDBONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN CDCVNB    WQKC04           TH Tattoo Numbe
     C           *LIKE     DEFN CDB0DT    WQKC05           TH Kill Date
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
     C                     KFLD           WQKC05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$EBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQKC03           BOL Load Number
     C                     Z-ADD$ECVNB    WQKC04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQKC05           TH Kill Date
      * Establish starting position
     C           KRSC      SETLL@CDCPIU                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDCDHMNB    $HHMNB           BOH Company Num
     C                     Z-ADDCDBNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDCDBONB    $HBONB           BOL Load Number
     C                     Z-ADDCDCVNB    $HCVNB           TH Tattoo Numbe
     C                     Z-ADDCDB0DT    $HB0DT           TH Kill Date
     C                     MOVELCDBQCD    $HBQCD           DED D/A Code
     C                     Z-ADDCDAZVA    $HAZVA           THD Unit Amt
     C                     Z-ADDCDA0VA    $HA0VA           THD Ded/Add Amo
     C                     MOVELCDJBST    $HJBST           THD Unit Amt Si
     C                     MOVELCDEIST    $HEIST           THD UOM
     C                     MOVELCDJDST    $HJDST           THD Transaction
     C                     MOVELCDDPCD    $HDPCD           THD GL Code
     C                     MOVELCDAAVN    $HAAVN           RS User Changed
     C                     Z-ADDCDAADT    $HAADT           RS Date Changed
     C                     Z-ADDCDAMTM    $HAMTM           RS Time Changed
     C                     MOVELCDAJST    $HAJST           RS Record Statu
     C                     MOVELCDAHVN    $HAHVN           RS Job
     C                     MOVELCDAGVN    $HAGVN           RS Program
     C                     MOVELCDABVN    $HABVN           RS User Added
     C                     Z-ADDCDABDT    $HABDT           RS Date Added
     C                     Z-ADDCDABTM    $HABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCDHMNB    $GHMNB           BOH Company Num
     C                     Z-ADDCDBNNB    $GBNNB           BOH Buy Order N
     C                     Z-ADDCDBONB    $GBONB           BOL Load Number
     C                     Z-ADDCDCVNB    $GCVNB           TH Tattoo Numbe
     C                     Z-ADDCDB0DT    $GB0DT           TH Kill Date
     C                     MOVELCDBQCD    $GBQCD           DED D/A Code
     C                     Z-ADDCDAZVA    $GAZVA           THD Unit Amt
     C                     Z-ADDCDA0VA    $GA0VA           THD Ded/Add Amo
     C                     MOVELCDJBST    $GJBST           THD Unit Amt Si
     C                     MOVELCDEIST    $GEIST           THD UOM
     C                     MOVELCDJDST    $GJDST           THD Transaction
     C                     MOVELCDDPCD    $GDPCD           THD GL Code
     C                     MOVELCDE3CD    $GE3CD           THD Contra Gl C
     C                     Z-ADDCDAQNB    $GAQNB           THD Re-imbursem
     C                     MOVELCDOCST    $GOCST           THD Payment Sts
     C                     MOVELCDPEST    $GPEST           THD Expense Pai
     C                     MOVELCDPFST    $GPFST           THD Expense Typ
     C                     MOVELCDPGST    $GPGST           THD Reserve Acc
     C                     MOVELCDPIST    $GPIST           THD Commission
     C                     MOVELCDPJST    $GPJST           THD Deferred Pa
     C                     MOVELCDPKST    $GPKST           THD Status 4
     C                     MOVELCDPLST    $GPLST           THD Status 5
     C                     MOVELCDAAVN    $GAAVN           RS User Changed
     C                     Z-ADDCDAADT    $GAADT           RS Date Changed
     C                     Z-ADDCDAMTM    $GAMTM           RS Time Changed
     C                     MOVELCDAJST    $GAJST           RS Record Statu
     C                     MOVELCDAHVN    $GAHVN           RS Job
     C                     MOVELCDAGVN    $GAGVN           RS Program
     C                     MOVELCDABVN    $GABVN           RS User Added
     C                     Z-ADDCDABDT    $GABDT           RS Date Added
     C                     Z-ADDCDABTM    $GABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN CDHMNB    WZC001           BOH Company Num
     C                     Z-ADDCDHMNB    WZC001
     C           *LIKE     DEFN CDBNNB    WZC002           BOH Buy Order N
     C                     Z-ADDCDBNNB    WZC002
     C           *LIKE     DEFN CDBONB    WZC003           BOL Load Number
     C                     Z-ADDCDBONB    WZC003
     C           *LIKE     DEFN CDCVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDCDCVNB    WZC004
     C           *LIKE     DEFN CDB0DT    WZC005           TH Kill Date
     C                     Z-ADDCDB0DT    WZC005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@CDCPIU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0CL04  1        TH Kill Date
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           CDHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           CDBNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           CDBONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           CDCVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           CDB0DT    IFNE WZC005                     TH Kill Date
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL04    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           $EHMNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$HKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt PrdEmailHdr       PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN RBABCD    WQKD01           PD Producer Cod
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           PD Producer Cod
      * Setup key
     C                     MOVEL$EABCD    WQKD01           PD Producer Cod
      * Establish starting position
     C           KRSD      SETLL@AZREN3                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELRBABCD    $IABCD           PD Producer Cod
     C                     MOVELRBBHSS    $IBHSS           PEH Email Statu
     C                     MOVELRBAAVN    $IAAVN           RS User Changed
     C                     Z-ADDRBAADT    $IAADT           RS Date Changed
     C                     Z-ADDRBAMTM    $IAMTM           RS Time Changed
     C                     MOVELRBAJST    $IAJST           RS Record Statu
     C                     MOVELRBAHVN    $IAHVN           RS Job
     C                     MOVELRBAGVN    $IAGVN           RS Program
     C                     MOVELRBABVN    $IABVN           RS User Added
     C                     Z-ADDRBABDT    $IABDT           RS Date Added
     C                     Z-ADDRBABTM    $IABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@AZREN3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     ELSE
      * Next record - Detect level breaks
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * Prt PrdEmlDtl         PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN RAABCD    WQKE01           PD Producer Cod
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           PD Producer Cod
      * Setup key
     C                     MOVEL$EABCD    WQKE01           PD Producer Cod
      * Establish starting position
     C           KRSE      SETLL@A1REN9                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        PD Producer Cod
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELRAABCD    $JABCD           PD Producer Cod
     C                     Z-ADDRANHA1    $JNHA1           PED Sequence
     C                     MOVELRAVMTX    $JVMTX           PED Email Line
     C                     MOVELRAAAVN    $JAAVN           RS User Changed
     C                     Z-ADDRAAADT    $JAADT           RS Date Changed
     C                     Z-ADDRAAMTM    $JAMTM           RS Time Changed
     C                     MOVELRAAJST    $JAJST           RS Record Statu
     C                     MOVELRAAHVN    $JAHVN           RS Job
     C                     MOVELRAAGVN    $JAGVN           RS Program
     C                     MOVELRAABVN    $JABVN           RS User Added
     C                     Z-ADDRAABDT    $JABDT           RS Date Added
     C                     Z-ADDRAABTM    $JABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN RAABCD    WZE001           PD Producer Cod
     C                     MOVELRAABCD    WZE001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@A1REN9                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        PD Producer Cod
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        PD Producer Cod
     C                     ELSE
      * Next record - Detect level breaks
     C           RAABCD    IFNE WZE001                     PD Producer Cod
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * Prt PrdLocEmlHdr      PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN RDABCD    WQKF01           PD Producer Cod
     C           *LIKE     DEFN RDAECD    WQKF02           PL Location Cod
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           PD Producer Cod
     C                     KFLD           WQKF02           PL Location Cod
      * Setup key
     C                     MOVEL$EABCD    WQKF01           PD Producer Cod
     C                     MOVEL$EAECD    WQKF02           PL Location Cod
      * Establish starting position
     C           KRSF      SETLL@A0REN6                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        PD Producer Cod
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELRDABCD    $KABCD           PD Producer Cod
     C                     MOVELRDAECD    $KAECD           PL Location Cod
     C                     MOVELRDBKSS    $KBKSS           PLEH Email Stat
     C                     MOVELRDBLSS    $KBLSS           PLEH Email Carc
     C                     MOVELRDBMSS    $KBMSS           PLEH Email Carc
     C                     MOVELRDBNSS    $KBNSS           PLEH Email to P
     C                     MOVELRDBOSS    $KBOSS           PLEH Producer E
     C                     MOVELRDAAVN    $KAAVN           RS User Changed
     C                     Z-ADDRDAADT    $KAADT           RS Date Changed
     C                     Z-ADDRDAMTM    $KAMTM           RS Time Changed
     C                     MOVELRDAJST    $KAJST           RS Record Statu
     C                     MOVELRDAHVN    $KAHVN           RS Job
     C                     MOVELRDAGVN    $KAGVN           RS Program
     C                     MOVELRDABVN    $KABVN           RS User Added
     C                     Z-ADDRDABDT    $KABDT           RS Date Added
     C                     Z-ADDRDABTM    $KABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN RDABCD    WZF001           PD Producer Cod
     C                     MOVELRDABCD    WZF001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@A0REN6                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        PD Producer Cod
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        PD Producer Cod
     C                     ELSE
      * Next record - Detect level breaks
     C           RDABCD    IFNE WZF001                     PD Producer Cod
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * Prt PrdLocEmlDtl      PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN RCABCD    WQKG01           PD Producer Cod
     C           *LIKE     DEFN RCAECD    WQKG02           PL Location Cod
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG01           PD Producer Cod
     C                     KFLD           WQKG02           PL Location Cod
      * Setup key
     C                     MOVEL$EABCD    WQKG01           PD Producer Cod
     C                     MOVEL$EAECD    WQKG02           PL Location Cod
      * Establish starting position
     C           KRSG      SETLL@A2REOD                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        PD Producer Cod
     C                     MOVEL'Y'       W0GL01  1        PL Location Cod
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP01  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELRCABCD    $LABCD           PD Producer Cod
     C                     MOVELRCAECD    $LAECD           PL Location Cod
     C                     Z-ADDRCNIA1    $LNIA1           PLED Sequence
     C                     MOVELRCVNTX    $LVNTX           PLED Email Line
     C                     MOVELRCAAVN    $LAAVN           RS User Changed
     C                     Z-ADDRCAADT    $LAADT           RS Date Changed
     C                     Z-ADDRCAMTM    $LAMTM           RS Time Changed
     C                     MOVELRCAJST    $LAJST           RS Record Statu
     C                     MOVELRCAHVN    $LAHVN           RS Job
     C                     MOVELRCAGVN    $LAGVN           RS Program
     C                     MOVELRCABVN    $LABVN           RS User Added
     C                     Z-ADDRCABDT    $LABDT           RS Date Added
     C                     Z-ADDRCABTM    $LABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN RCABCD    WZG001           PD Producer Cod
     C                     MOVELRCABCD    WZG001
     C           *LIKE     DEFN RCAECD    WZG002           PL Location Cod
     C                     MOVELRCAECD    WZG002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@A2REOD                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        PD Producer Cod
     C                     MOVEL*BLANK    W0GL01  1        PL Location Cod
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        PD Producer Cod
     C                     MOVEL'Y'       W0GL01  1        PL Location Cod
     C                     ELSE
      * Next record - Detect level breaks
     C           RCABCD    IFNE WZG001                     PD Producer Cod
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C           RCAECD    IFNE WZG002                     PL Location Cod
     C           W0GL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL01
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP01
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
     C                     END
      *
     C           W0EOFG    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * CrtPrdLocEmlDtlTatFax2 RT - Producer Loc Email Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN RCABCD    WQNA01           PD Producer Cod
     C           *LIKE     DEFN RCAECD    WQNA02           PL Location Cod
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA01           PD Producer Cod
     C                     KFLD           WQNA02           PL Location Cod
      * Setup key
     C                     MOVELA1ABCD    WQNA01           PD Producer Cod
     C                     MOVELA1AECD    WQNA02           PL Location Cod
      * Establish starting position
     C           KRSNA     SETLL@A2REOD                    *
     C           KRSNA     READE@A2REOD                  90*
      * Data record not found
     C   90                MOVEL'PRK1185' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           RCAJST    IFEQ 'A'                        *IF
      * create information for Carcass Summary/Carcass Detail
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PLEH Email Status is Yes
      *   |- c2    : PAR.PLEH Email to Producer is Yes
      *   '-
     C           WUBKSS    IFEQ 'Y'                        *IF
     C           WUBNSS    OREQ 'Y'                        *OR
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PLEH Email Carcass Sum is Yes
     C           WUBLSS    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE: PAR.PLEH Email Carcass Detail is Yes
     C           WUBMSS    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   WUNPTX           TFD Header Acti
     C                     END                             *FI
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR NBCRRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNA     READE@A2REOD                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0230 10        RS User Changed
     C                     Z-ADD*ZERO     WN0231  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0232  60       RS Time Changed
     C                     MOVEL*BLANK    WN0233  1        RS Record Statu
     C                     MOVEL*BLANK    WN0234 10        RS Job
     C                     MOVEL*BLANK    WN0235 10        RS Program
     C                     MOVEL*BLANK    WN0236 10        RS User Added
     C                     Z-ADD*ZERO     WN0237  70       RS Date Added
     C                     Z-ADD*ZERO     WN0238  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELWUBOSS    D7RKST           TFD Producer Se
     C                     MOVEL'E'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVELRCVNTX    D7NJTX           TFD Phone # or
     C                     Z-ADDA1BYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADDA1LPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADDA1HMNB    D7HMNB           BOH Company Num
     C                     Z-ADDA1BNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    D7BONB           BOL Load Number
     C                     Z-ADDA1CVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRNB    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRNB    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WEHNNB           VCH Company num
     C                     KFLD           WELWNB           VCH Batch Numbe
     C                     KFLD           WEG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WEHNNB           VCH Company num
     C                     Z-ADDWULWNB    WELWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WEG9NB           VCH Header Numb
      * Establish starting position
     C           KRSNC     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR NDCHRC
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWEHNNB    WCHNNB           VCH Company num
     C                     Z-ADDWELWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WCG9NB           VCH Header Numb
      *
     C           KLCHND    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
     C           KLCHND    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YBRDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWELXNB    WCLXNB           VCH AP Address
     C                     Z-ADDWELYNB    WCLYNB           VCH AP Voucher
     C                     MOVELWECSST    WCCSST    P      VCH Payee Type
     C                     Z-ADDWEDKNB    WCDKNB           VCH Manual Chec
     C                     Z-ADDWEA2DT    WCA2DT           VCH Manual Chec
     C                     Z-ADDWUCIPR    WCCIPR           VCH Base Mkt Pr
     C                     Z-ADDWUCJPR    WCCJPR           VCH Sort Disc A
     C                     Z-ADDWUCKPR    WCCKPR           VCH Yield Gain/
     C                     Z-ADDWUCLPR    WCCLPR           VCH Base Carcas
     C                     Z-ADDWUCMPR    WCCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    WCAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    WCAVVA           VCH Deduction A
     C                     Z-ADDWUCHPR    WCCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    WCAJVA           VCH Net Amt
     C                     Z-ADDWEBUPC    WCBUPC           VCH Split %
     C                     MOVELWEJHST    WCJHST    P      VCH Split Check
     C                     MOVEL'C'       WCC0ST    P      VCH Process Sta
     C                     Z-ADDWEA4DT    WCA4DT           VCH G/L Date
     C                     MOVELWECUST    WCCUST    P      VCH Check Type
     C                     MOVELWEABCD    WCABCD    P      PD Producer Cod
     C                     MOVELWEBNCD    WCBNCD    P      TRK Trucker Cod
     C                     MOVELWECFCD    WCCFCD    P      VR Reason Code
     C                     MOVELWEAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WCAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WCAMTM           RS Time Changed
     C                     MOVELWEAJST    WCAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WCAHVN    P      RS Job
     C                     MOVELWEAGVN    WCAGVN    P      RS Program
     C                     MOVELWEABVN    WCABVN    P      RS User Added
     C                     Z-ADDWEABDT    WCABDT           RS Date Added
     C                     Z-ADDWEABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WEHNNB           VCH Company num
     C                     KFLD           WELWNB           VCH Batch Numbe
     C                     KFLD           WEG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WEHNNB           VCH Company num
     C                     Z-ADDWULWNB    WELWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WEG9NB           VCH Header Numb
      * Establish starting position
     C           KRSNE     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Recalc Net and Deduction amts if a Manual Check was written for a
      * CASE: PAR.Manual Chk Adj Diff   USR is Not Zero
     C           *ZERO     IFNE 0                          *IF
     C           WEAVVA    ADD  *ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADDWUAJVA    WUAJVA           VCH Net Amt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEAVVA    WUAVVA           VCH Deduction A
     C                     Z-ADDWEAJVA    WUAJVA           VCH Net Amt
     C                     END                             *FI
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR NFCHRC
      * Create Split Voucher Hdr/Dtl if Split Producer
      * CASE: DB1.VCH Less Split Amount is Not equal to Zero
     C           WECHPR    IFNE 0                          *IF
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
     C                     EXSR NGRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWEHNNB    WCHNNB           VCH Company num
     C                     Z-ADDWELWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WCG9NB           VCH Header Numb
      *
     C           KLCHNF    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
     C           KLCHNF    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YCRDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWELXNB    WCLXNB           VCH AP Address
     C                     Z-ADDWELYNB    WCLYNB           VCH AP Voucher
     C                     MOVELWECSST    WCCSST    P      VCH Payee Type
     C                     Z-ADDWEDKNB    WCDKNB           VCH Manual Chec
     C                     Z-ADDWEA2DT    WCA2DT           VCH Manual Chec
     C                     Z-ADDWECIPR    WCCIPR           VCH Base Mkt Pr
     C                     Z-ADDWECJPR    WCCJPR           VCH Sort Disc A
     C                     Z-ADDWECKPR    WCCKPR           VCH Yield Gain/
     C                     Z-ADDWECLPR    WCCLPR           VCH Base Carcas
     C                     Z-ADDWECMPR    WCCMPR           VCH LN Add on/D
     C                     Z-ADDWEAUVA    WCAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    WCAVVA           VCH Deduction A
     C                     Z-ADDWECHPR    WCCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    WCAJVA           VCH Net Amt
     C                     Z-ADDWEBUPC    WCBUPC           VCH Split %
     C                     MOVELWEJHST    WCJHST    P      VCH Split Check
     C                     MOVEL'C'       WCC0ST    P      VCH Process Sta
     C                     Z-ADDWEA4DT    WCA4DT           VCH G/L Date
     C                     MOVELWECUST    WCCUST    P      VCH Check Type
     C                     MOVELWEABCD    WCABCD    P      PD Producer Cod
     C                     MOVELWEBNCD    WCBNCD    P      TRK Trucker Cod
     C                     MOVELWECFCD    WCCFCD    P      VR Reason Code
     C                     MOVELWEAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WCAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WCAMTM           RS Time Changed
     C                     MOVELWEAJST    WCAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WCAHVN    P      RS Job
     C                     MOVELWEAGVN    WCAGVN    P      RS Program
     C                     MOVELWEABVN    WCABVN    P      RS User Added
     C                     Z-ADDWEABDT    WCABDT           RS Date Added
     C                     Z-ADDWEABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFABCD    WQNG01           PD Producer Cod
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WQNG01           PD Producer Cod
      * Setup key
     C                     MOVELWEABCD    WQNG01           PD Producer Cod
      * Establish starting position
     C           KRSNG     SETLL@BFREOG                    *
     C           KRSNG     READE@BFREOG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR NHCRRC
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR NICRRC
      * Create Split producer voucher header and detail rcds ...
      * CASE: DB1.BOS Split Producer Code NE PAR.PD Producer Code
     C           WFBTCD    IFNE WEABCD                     *IF
      *   ... If not the original producer's split record
      * Create Header record for split producer
      * (Split amount is negative in voucher header,detail files.)
     C           WEAJVA    SUB  WECHPR    WUA8VA           Net Amount
     C           WFABPC    DIV  100       WUL9NB           Percent Decimal
     C           WUA8VA    MULT WUL9NB    WUAJVA    H      VCH Net Amt
     C                     Z-ADDWUAJVA    WUAUVA           VCH Gross Amt
      * RMC SDN440 get m3 supplier too
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
     C                     EXSR NJRVGN
      * RMC SDN440 Added 2/9/22
      * CASE: PAR.Live with M3   USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUQHCD:ZQ WUSTTX    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     WULXNB           VCH AP Address
     C                     MOVE WUSTTX    WULXNB           VCH AP Address
     C                     END                             *FI
      * Rtv Source Type       RT - Source  * 
     C                     EXSR NLRVGN
      * Payee type values
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUCSST           VCH Payee Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUCSST           VCH Payee Type
     C                     END                             *FI
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
     C                     EXSR NMRVGN
      * Crt Voucher Header    CR - Hog Voucher Header  * 
     C                     EXSR NNCRRC
      * Create Detail records for split producer
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
     C                     EXSR NORVGN
     C                     END                             *FI
     C           KRSNG     READE@BFREOG                  90*
     C                     ENDDO
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWEHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWELWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWEABCD    CABTCD           BOS Split Produ
     C                     MOVELWEABCD    CAABCD           PD Producer Cod
     C                     Z-ADD100       CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRNH    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRNH    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NICRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWEHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWELWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWFBTCD    CABTCD           BOS Split Produ
     C                     MOVELWFABCD    CAABCD           PD Producer Cod
     C                     Z-ADDWFABPC    CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRNI    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRNI    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELWFBTCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSNJ     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WULXNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WULXNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR NKRVGN
     C                     GOTO NJEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVELACABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSNK     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    WUQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNL     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSNL     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHNNB    WQNM01           VCH Company num
     C           *LIKE     DEFN WBLWNB    WQNM02           VCH Batch Numbe
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WQNM01           VCH Company num
     C                     KFLD           WQNM02           VCH Batch Numbe
      * Setup key
     C                     Z-ADDWEHNNB    WQNM01           VCH Company num
     C                     Z-ADDWELWNB    WQNM02           VCH Batch Numbe
      * Establish starting position
     C           KRSNM     SETLL@BKCPJR                    *
     C           KRSNM     READE@BKCPJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD00001     WUL4NB           VCH Header Numb
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBG9NB    ADD  1         WUL4NB           VCH Header Numb
     C                     GOTO NMEXIT                     *QUIT
     C           KRSNM     READE@BKCPJR                  90*
     C                     ENDDO
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNCRRC    BEGSR
      *================================================================
      * Crt Voucher Header    CR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPEK
     C                     Z-ADDWEHNNB    WCHNNB           VCH Company num
     C                     Z-ADDWELWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    WCG9NB           VCH Header Numb
     C                     Z-ADDWULXNB    WCLXNB           VCH AP Address
     C                     Z-ADDWELYNB    WCLYNB           VCH AP Voucher
     C                     MOVELWUCSST    WCCSST           VCH Payee Type
     C                     Z-ADDWEDKNB    WCDKNB           VCH Manual Chec
     C                     Z-ADDWEA2DT    WCA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     WCCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WCCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WCCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WCCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WCCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    WCAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WCAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WCCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    WCAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WCBUPC           VCH Split %
     C                     MOVEL'Y'       WCJHST           VCH Split Check
     C                     MOVEL'C'       WCC0ST           VCH Process Sta
     C                     Z-ADDWEA4DT    WCA4DT           VCH G/L Date
     C                     MOVELWECUST    WCCUST           VCH Check Type
     C                     MOVELWFBTCD    WCABCD           PD Producer Cod
     C                     MOVELWEBNCD    WCBNCD           TRK Trucker Cod
     C                     MOVELWECFCD    WCCFCD           VR Reason Code
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRNN    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCRNN    SETLL@BKCPEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHNNB    WQNO01           VCH Company num
     C           *LIKE     DEFN WGLWNB    WQNO02           VCH Batch Numbe
     C           *LIKE     DEFN WGG9NB    WQNO03           VCH Header Numb
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WQNO01           VCH Company num
     C                     KFLD           WQNO02           VCH Batch Numbe
     C                     KFLD           WQNO03           VCH Header Numb
      * Setup key
     C                     Z-ADDWEHNNB    WQNO01           VCH Company num
     C                     Z-ADDWELWNB    WQNO02           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WQNO03           VCH Header Numb
      * Establish starting position
     C           KRSNO     SETLL@BLCPEP                    *
     C           KRSNO     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Net to Split amt to get Net amt before the split was calc'd.
      * (Split amount is negative in the voucher detail,header files)
     C           WGAMVA    SUB  WGCVPR    WUAMVA           VCD Net Amt
      * Calc net and gross for the splitee producer
     C           WFABPC    DIV  100       WUL9NB           Percent Decimal
     C                     MULT WUL9NB    WUAMVA    H      VCD Net Amt
     C                     Z-ADDWUAMVA    WUAKVA           VCD Gross Amt
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
     C                     EXSR NPCRRC
     C           KRSNO     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCRRC    BEGSR
      *================================================================
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPEI
     C                     Z-ADDWGHNNB    BLHNNB           VCH Company num
     C                     Z-ADDWGLWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWGDLNB    BLDLNB           VCD Line
     C                     Z-ADD*ZERO     BLCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     BLCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     BLCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     BLCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     BLCRPR           VCD LN Add on/D
     C                     Z-ADDWUAKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     BLALVA           VCD Deduction A
     C                     Z-ADD*ZERO     BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     BLAEPC           VCD Split Perce
     C                     MOVELWGI6ST    BLI6ST           VCD Payment Typ
     C                     MOVELWGJIST    BLJIST           VCD Hog Class T
     C                     MOVELWGJPST    BLJPST           VCD BO Type
     C                     MOVELWGC2SS    BLC2SS           VCD Source Cont
     C                     MOVELWGOTCD    BLOTCD           VCD Source Code
     C                     MOVELWGF5TX    BLF5TX           VCD Check Descr
     C                     Z-ADDWGL5A1    BLL5A1           VCD Received He
     C                     Z-ADDWGL6A1    BLL6A1           VCD Head Killed
     C                     MOVEL*BLANK    BLJQST           VCD Push Paymen
     C                     MOVELWGC4SS    BLC4SS           VCD Repayment F
     C                     MOVELWGC5SS    BLC5SS           VCD Unused Stat
     C                     MOVELWGC3SS    BLC3SS           VCD Unused Stat
     C                     Z-ADDWGOKA1    BLOKA1           VCD Unused Head
     C                     Z-ADDWGOLA1    BLOLA1           VCD UnUsed Head
     C                     Z-ADDWGOMA1    BLOMA1           VCD UnUsed Head
     C                     MOVELWGQ0CD    BLQ0CD           MGL Supplier In
     C                     Z-ADDWGWSA1    BLWSA1           MGL Voucher Num
     C                     Z-ADDWGWOA1    BLWOA1           MGL Invoice Bat
     C                     Z-ADDWGHFDT    BLHFDT           MGL Process to
     C                     Z-ADDWGB2TM    BLB2TM           MGL Process to
     C                     Z-ADDWGHMNB    BLHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    BLBONB           BOL Load Number
     C                     Z-ADDWGCVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    BLB0DT           TH Kill Date
     C                     MOVELWGABCD    BLABCD           PD Producer Cod
     C                     MOVELWGAECD    BLAECD           PL Location Cod
     C                     MOVELWGAAVN    BLAAVN           RS User Changed
     C                     Z-ADDWGAADT    BLAADT           RS Date Changed
     C                     Z-ADDWGAMTM    BLAMTM           RS Time Changed
     C                     MOVELWGAJST    BLAJST           RS Record Statu
     C                     MOVELWGAHVN    BLAHVN           RS Job
     C                     MOVELWGAGVN    BLAGVN           RS Program
     C                     MOVELWGABVN    BLABVN           RS User Added
     C                     Z-ADDWGABDT    BLABDT           RS Date Added
     C                     Z-ADDWGABTM    BLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL##USR     BLABVN           RS User Added
     C                     Z-ADD##JDT     BLABDT           RS Date Added
     C                     Z-ADD##JTM     BLABTM           RS Time Added
     C                     MOVEL##PGM     BLAGVN           RS Program
     C                     MOVEL##JOB     BLAHVN           RS Job
     C           KLCRNP    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCRNP    SETLL@BLCPEI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPEI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0085  30       BOH Company Num
     C                     PARM BLBNNB    WQ0086  70       BOH Buy Order N
     C                     PARM BLBONB    WQ0087  50       BOL Load Number
     C                     PARM BLCVNB    WQ0088  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0089  70       TH Kill Date
     C                     PARM *ZERO     WQ0090  50       TH Head Receive
     C                     PARM *ZERO     WQ0091  50       TH Held Over
     C                     PARM *ZERO     WQ0092  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0093  70       TH Voucher Paym
     C                     PARM 'CV'      WQ0094  2        Tattoo Action U
     C                     PARM *BLANK    WQ0095  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WEHNNB           VCH Company num
     C                     KFLD           WELWNB           VCH Batch Numbe
     C                     KFLD           WEG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WEHNNB           VCH Company num
     C                     Z-ADDWULWNB    WELWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WEG9NB           VCH Header Numb
      * Establish starting position
     C           KRSNQ     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR NRCHRC
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWEHNNB    WCHNNB           VCH Company num
     C                     Z-ADDWELWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WCG9NB           VCH Header Numb
      *
     C           KLCHNR    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
     C           KLCHNR    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YDRDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWELXNB    WCLXNB           VCH AP Address
     C                     Z-ADDWELYNB    WCLYNB           VCH AP Voucher
     C                     MOVELWECSST    WCCSST    P      VCH Payee Type
     C                     Z-ADDWEDKNB    WCDKNB           VCH Manual Chec
     C                     Z-ADDWEA2DT    WCA2DT           VCH Manual Chec
     C                     Z-ADDWUCIPR    WCCIPR           VCH Base Mkt Pr
     C                     Z-ADDWUCJPR    WCCJPR           VCH Sort Disc A
     C                     Z-ADDWUCKPR    WCCKPR           VCH Yield Gain/
     C                     Z-ADDWUCLPR    WCCLPR           VCH Base Carcas
     C                     Z-ADDWUCMPR    WCCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    WCAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    WCAVVA           VCH Deduction A
     C                     Z-ADDWUCHPR    WCCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    WCAJVA           VCH Net Amt
     C                     Z-ADDWEBUPC    WCBUPC           VCH Split %
     C                     MOVELWEJHST    WCJHST    P      VCH Split Check
     C                     MOVEL'C'       WCC0ST    P      VCH Process Sta
     C                     Z-ADDWEA4DT    WCA4DT           VCH G/L Date
     C                     MOVELWECUST    WCCUST    P      VCH Check Type
     C                     MOVELWEABCD    WCABCD    P      PD Producer Cod
     C                     MOVELWEBNCD    WCBNCD    P      TRK Trucker Cod
     C                     MOVELWECFCD    WCCFCD    P      VR Reason Code
     C                     MOVELWEAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WCAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WCAMTM           RS Time Changed
     C                     MOVELWEAJST    WCAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WCAHVN    P      RS Job
     C                     MOVELWEAGVN    WCAGVN    P      RS Program
     C                     MOVELWEABVN    WCABVN    P      RS User Added
     C                     Z-ADDWEABDT    WCABDT           RS Date Added
     C                     Z-ADDWEABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           WEHNNB           VCH Company num
     C                     KFLD           WELWNB           VCH Batch Numbe
     C                     KFLD           WEG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WEHNNB           VCH Company num
     C                     Z-ADDWULWNB    WELWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WEG9NB           VCH Header Numb
      * Establish starting position
     C           KRSNS     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Recalc Net and Deduction amts if a Manual Check was written for a
      * CASE: PAR.Manual Chk Adj Diff   USR is Not Zero
     C           *ZERO     IFNE 0                          *IF
     C           WEAVVA    ADD  *ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADDWUAJVA    WUAJVA           VCH Net Amt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEAVVA    WUAVVA           VCH Deduction A
     C                     Z-ADDWEAJVA    WUAJVA           VCH Net Amt
     C                     END                             *FI
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR NTCHRC
      * Create Split Voucher Hdr/Dtl if Split Producer
      * CASE: DB1.VCH Less Split Amount is Not equal to Zero
     C           WECHPR    IFNE 0                          *IF
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
     C                     EXSR NURVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWEHNNB    WCHNNB           VCH Company num
     C                     Z-ADDWELWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WCG9NB           VCH Header Numb
      *
     C           KLCHNT    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
     C           KLCHNT    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YERDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWELXNB    WCLXNB           VCH AP Address
     C                     Z-ADDWELYNB    WCLYNB           VCH AP Voucher
     C                     MOVELWECSST    WCCSST    P      VCH Payee Type
     C                     Z-ADDWEDKNB    WCDKNB           VCH Manual Chec
     C                     Z-ADDWEA2DT    WCA2DT           VCH Manual Chec
     C                     Z-ADDWECIPR    WCCIPR           VCH Base Mkt Pr
     C                     Z-ADDWECJPR    WCCJPR           VCH Sort Disc A
     C                     Z-ADDWECKPR    WCCKPR           VCH Yield Gain/
     C                     Z-ADDWECLPR    WCCLPR           VCH Base Carcas
     C                     Z-ADDWECMPR    WCCMPR           VCH LN Add on/D
     C                     Z-ADDWEAUVA    WCAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    WCAVVA           VCH Deduction A
     C                     Z-ADDWECHPR    WCCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    WCAJVA           VCH Net Amt
     C                     Z-ADDWEBUPC    WCBUPC           VCH Split %
     C                     MOVELWEJHST    WCJHST    P      VCH Split Check
     C                     MOVEL'C'       WCC0ST    P      VCH Process Sta
     C                     Z-ADDWEA4DT    WCA4DT           VCH G/L Date
     C                     MOVELWECUST    WCCUST    P      VCH Check Type
     C                     MOVELWEABCD    WCABCD    P      PD Producer Cod
     C                     MOVELWEBNCD    WCBNCD    P      TRK Trucker Cod
     C                     MOVELWECFCD    WCCFCD    P      VR Reason Code
     C                     MOVELWEAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WCAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WCAMTM           RS Time Changed
     C                     MOVELWEAJST    WCAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WCAHVN    P      RS Job
     C                     MOVELWEAGVN    WCAGVN    P      RS Program
     C                     MOVELWEABVN    WCABVN    P      RS User Added
     C                     Z-ADDWEABDT    WCABDT           RS Date Added
     C                     Z-ADDWEABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFABCD    WQNU01           PD Producer Cod
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           WQNU01           PD Producer Cod
      * Setup key
     C                     MOVELWEABCD    WQNU01           PD Producer Cod
      * Establish starting position
     C           KRSNU     SETLL@BFREOG                    *
     C           KRSNU     READE@BFREOG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR NVCRRC
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR NWCRRC
      * Create Split producer voucher header and detail rcds ...
      * CASE: DB1.BOS Split Producer Code NE PAR.PD Producer Code
     C           WFBTCD    IFNE WEABCD                     *IF
      *   ... If not the original producer's split record
      * Create Header record for split producer
      * (Split amount is negative in voucher header,detail files.)
     C           WEAJVA    SUB  WECHPR    WUA8VA           Net Amount
     C           WFABPC    DIV  100       WUL9NB           Percent Decimal
     C           WUA8VA    MULT WUL9NB    WUAJVA    H      VCH Net Amt
     C                     Z-ADDWUAJVA    WUAUVA           VCH Gross Amt
      * RMC SDN440 get m3 supplier too
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
     C                     EXSR NXRVGN
      * RMC SDN440 Added 2/9/22
      * CASE: PAR.Live with M3   USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUQHCD:ZQ WUSTTX    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     WULXNB           VCH AP Address
     C                     MOVE WUSTTX    WULXNB           VCH AP Address
     C                     END                             *FI
      * Rtv Source Type       RT - Source  * 
     C                     EXSR NZRVGN
      * Payee type values
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUCSST           VCH Payee Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUCSST           VCH Payee Type
     C                     END                             *FI
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
     C                     EXSR OARVGN
      * Crt Voucher Header    CR - Hog Voucher Header  * 
     C                     EXSR OBCRRC
      * Create Detail records for split producer
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
     C                     EXSR OCRVGN
     C                     END                             *FI
     C           KRSNU     READE@BFREOG                  90*
     C                     ENDDO
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWEHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWELWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWEABCD    CABTCD           BOS Split Produ
     C                     MOVELWEABCD    CAABCD           PD Producer Cod
     C                     Z-ADD100       CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRNV    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRNV    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWEHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWELWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWFBTCD    CABTCD           BOS Split Produ
     C                     MOVELWFABCD    CAABCD           PD Producer Cod
     C                     Z-ADDWFABPC    CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRNW    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRNW    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELWFBTCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSNX     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WULXNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WULXNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR NYRVGN
     C                     GOTO NXEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVELACABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSNY     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    WUQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSNZ     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHNNB    WQOA01           VCH Company num
     C           *LIKE     DEFN WBLWNB    WQOA02           VCH Batch Numbe
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           WQOA01           VCH Company num
     C                     KFLD           WQOA02           VCH Batch Numbe
      * Setup key
     C                     Z-ADDWEHNNB    WQOA01           VCH Company num
     C                     Z-ADDWELWNB    WQOA02           VCH Batch Numbe
      * Establish starting position
     C           KRSOA     SETLL@BKCPJR                    *
     C           KRSOA     READE@BKCPJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD00001     WUL4NB           VCH Header Numb
     C                     GOTO OAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBG9NB    ADD  1         WUL4NB           VCH Header Numb
     C                     GOTO OAEXIT                     *QUIT
     C           KRSOA     READE@BKCPJR                  90*
     C                     ENDDO
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBCRRC    BEGSR
      *================================================================
      * Crt Voucher Header    CR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPEK
     C                     Z-ADDWEHNNB    WCHNNB           VCH Company num
     C                     Z-ADDWELWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    WCG9NB           VCH Header Numb
     C                     Z-ADDWULXNB    WCLXNB           VCH AP Address
     C                     Z-ADDWELYNB    WCLYNB           VCH AP Voucher
     C                     MOVELWUCSST    WCCSST           VCH Payee Type
     C                     Z-ADDWEDKNB    WCDKNB           VCH Manual Chec
     C                     Z-ADDWEA2DT    WCA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     WCCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WCCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WCCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WCCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WCCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    WCAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WCAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WCCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    WCAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WCBUPC           VCH Split %
     C                     MOVEL'Y'       WCJHST           VCH Split Check
     C                     MOVEL'C'       WCC0ST           VCH Process Sta
     C                     Z-ADDWEA4DT    WCA4DT           VCH G/L Date
     C                     MOVELWECUST    WCCUST           VCH Check Type
     C                     MOVELWFBTCD    WCABCD           PD Producer Cod
     C                     MOVELWEBNCD    WCBNCD           TRK Trucker Cod
     C                     MOVELWECFCD    WCCFCD           VR Reason Code
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCROB    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCROB    SETLL@BKCPEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OBEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHNNB    WQOC01           VCH Company num
     C           *LIKE     DEFN WGLWNB    WQOC02           VCH Batch Numbe
     C           *LIKE     DEFN WGG9NB    WQOC03           VCH Header Numb
      * Define keylist
     C           KRSOC     KLIST
     C                     KFLD           WQOC01           VCH Company num
     C                     KFLD           WQOC02           VCH Batch Numbe
     C                     KFLD           WQOC03           VCH Header Numb
      * Setup key
     C                     Z-ADDWEHNNB    WQOC01           VCH Company num
     C                     Z-ADDWELWNB    WQOC02           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WQOC03           VCH Header Numb
      * Establish starting position
     C           KRSOC     SETLL@BLCPEP                    *
     C           KRSOC     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Net to Split amt to get Net amt before the split was calc'd.
      * (Split amount is negative in the voucher detail,header files)
     C           WGAMVA    SUB  WGCVPR    WUAMVA           VCD Net Amt
      * Calc net and gross for the splitee producer
     C           WFABPC    DIV  100       WUL9NB           Percent Decimal
     C                     MULT WUL9NB    WUAMVA    H      VCD Net Amt
     C                     Z-ADDWUAMVA    WUAKVA           VCD Gross Amt
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
     C                     EXSR ODCRRC
     C           KRSOC     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODCRRC    BEGSR
      *================================================================
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPEI
     C                     Z-ADDWGHNNB    BLHNNB           VCH Company num
     C                     Z-ADDWGLWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWGDLNB    BLDLNB           VCD Line
     C                     Z-ADD*ZERO     BLCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     BLCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     BLCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     BLCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     BLCRPR           VCD LN Add on/D
     C                     Z-ADDWUAKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     BLALVA           VCD Deduction A
     C                     Z-ADD*ZERO     BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     BLAEPC           VCD Split Perce
     C                     MOVELWGI6ST    BLI6ST           VCD Payment Typ
     C                     MOVELWGJIST    BLJIST           VCD Hog Class T
     C                     MOVELWGJPST    BLJPST           VCD BO Type
     C                     MOVELWGC2SS    BLC2SS           VCD Source Cont
     C                     MOVELWGOTCD    BLOTCD           VCD Source Code
     C                     MOVELWGF5TX    BLF5TX           VCD Check Descr
     C                     Z-ADDWGL5A1    BLL5A1           VCD Received He
     C                     Z-ADDWGL6A1    BLL6A1           VCD Head Killed
     C                     MOVEL*BLANK    BLJQST           VCD Push Paymen
     C                     MOVELWGC4SS    BLC4SS           VCD Repayment F
     C                     MOVELWGC5SS    BLC5SS           VCD Unused Stat
     C                     MOVELWGC3SS    BLC3SS           VCD Unused Stat
     C                     Z-ADDWGOKA1    BLOKA1           VCD Unused Head
     C                     Z-ADDWGOLA1    BLOLA1           VCD UnUsed Head
     C                     Z-ADDWGOMA1    BLOMA1           VCD UnUsed Head
     C                     MOVELWGQ0CD    BLQ0CD           MGL Supplier In
     C                     Z-ADDWGWSA1    BLWSA1           MGL Voucher Num
     C                     Z-ADDWGWOA1    BLWOA1           MGL Invoice Bat
     C                     Z-ADDWGHFDT    BLHFDT           MGL Process to
     C                     Z-ADDWGB2TM    BLB2TM           MGL Process to
     C                     Z-ADDWGHMNB    BLHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    BLBONB           BOL Load Number
     C                     Z-ADDWGCVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    BLB0DT           TH Kill Date
     C                     MOVELWGABCD    BLABCD           PD Producer Cod
     C                     MOVELWGAECD    BLAECD           PL Location Cod
     C                     MOVELWGAAVN    BLAAVN           RS User Changed
     C                     Z-ADDWGAADT    BLAADT           RS Date Changed
     C                     Z-ADDWGAMTM    BLAMTM           RS Time Changed
     C                     MOVELWGAJST    BLAJST           RS Record Statu
     C                     MOVELWGAHVN    BLAHVN           RS Job
     C                     MOVELWGAGVN    BLAGVN           RS Program
     C                     MOVELWGABVN    BLABVN           RS User Added
     C                     Z-ADDWGABDT    BLABDT           RS Date Added
     C                     Z-ADDWGABTM    BLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL##USR     BLABVN           RS User Added
     C                     Z-ADD##JDT     BLABDT           RS Date Added
     C                     Z-ADD##JTM     BLABTM           RS Time Added
     C                     MOVEL##PGM     BLAGVN           RS Program
     C                     MOVEL##JOB     BLAHVN           RS Job
     C           KLCROD    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCROD    SETLL@BLCPEI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO ODEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPEI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0096  30       BOH Company Num
     C                     PARM BLBNNB    WQ0097  70       BOH Buy Order N
     C                     PARM BLBONB    WQ0098  50       BOL Load Number
     C                     PARM BLCVNB    WQ0099  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0100  70       TH Kill Date
     C                     PARM *ZERO     WQ0101  50       TH Head Receive
     C                     PARM *ZERO     WQ0102  50       TH Held Over
     C                     PARM *ZERO     WQ0103  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0104  70       TH Voucher Paym
     C                     PARM 'CV'      WQ0105  2        Tattoo Action U
     C                     PARM *BLANK    WQ0106  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Payment Edit/Post PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Payment Edit/Post PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Payment Edit/Post PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print PD Producer Code of Prt Payment Edit/Post PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print PL Location Code of Prt Payment Edit/Post PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * USER: On print of PL Location Code format
     C                     MOVEL*BLANK    P7LSTX           Fax Area Code #
     C                     MOVEL*BLANK    P7LRTX           Fax Telephone
     C                     MOVEL*BLANK    P7NGTX           Fax Area Code #
     C                     MOVEL*BLANK    P7NHTX           Fax Telephone 2
     C                     MOVEL*BLANK    WUNLTX           Fax Area Code P
     C                     MOVEL*BLANK    WUNNTX           Fax Telephone P
     C                     MOVEL*BLANK    WUNMTX           Fax Area Code P
     C                     MOVEL*BLANK    WUNOTX           Fax Telephone P
      * Retrieve Fax Status
      * Rtv Fax Status        RT - Producer Location  * 
     C                     EXSR SBRVGN
      * R10690 JJH 06/12/17 - Get Fax from Producer Location Address
      * Retrieve Location Fax Phone Nbrs
      * CASE: PAR.PL Fax Status is Yes
     C           P6AUST    IFEQ 'Y'                        *IF
      * R10690 JJH 06/12/17 - Get Fax from Producer Location Address
      * Rtv Producer Loc Addr XF - Producer Location Address  * 
     C                     CALL 'PWC6XFR'              90  Rtv Producer Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DABCD    WQ0007  6        PD Producer Cod
     C                     PARM $DAECD    WQ0008  6        PL Location Cod
     C           WUIKNB    PARM *ZERO     WQ0009  80       Address Number
     C           WUDVTX    PARM *BLANK    WQ0010 40        Pass Name
     C           WUDNTX    PARM *BLANK    WQ0011 40        Address 1
     C           WUDOTX    PARM *BLANK    WQ0012 40        Address 2
     C           WUDPTX    PARM *BLANK    WQ0013 40        Address 3
     C           WUDQTX    PARM *BLANK    WQ0014 40        City
     C           WUDRTX    PARM *BLANK    WQ0015  3        State
     C           WUDSTX    PARM *BLANK    WQ0016 12        Zip
     C           WUDTTX    PARM *BLANK    WQ0017  6        Area Code
     C           WUE0CD    PARM *BLANK    WQ0018  3        Country Code
     C           WUDUTX    PARM *BLANK    WQ0019 20        Telephone
     C           P7LSTX    PARM *BLANK    WQ0020  6        Fax Area Code #
     C           P7LRTX    PARM *BLANK    WQ0021 20        Fax Telephone
     C           P7NVTX    PARM *BLANK    WQ0022 40        Fax Attn 1
     C           P7NGTX    PARM *BLANK    WQ0023  6        Fax Area Code #
     C           P7NHTX    PARM *BLANK    WQ0024 20        Fax Telephone 2
     C           P7NWTX    PARM *BLANK    WQ0025 40        Fax Attn 2
     C           WUGNST    PARM *BLANK    WQ0026  1        Vendor 1099
     C           WUDXTX    PARM *BLANK    WQ0027 16        Vendor Tax Id.
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWC6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * R10690 JJH 06/12/17 - Get Fax from Producer Address
      * If Fax to Producer, Rtv producer's fax nbrs.,
      * CASE: PAR.PL Fax to Producer is Yes
     C           P6QQST    IFEQ 'Y'                        *IF
      * Rtv Prdcr Vnd#, Faxsts RT - Producer  * 
     C                     EXSR SCRVGN
      * Rtv Producer Address  XF - Producer Address  * 
     C                     CALL 'PWCZXFR'              90  Rtv Producer Ad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DABCD    WQ0028  6        PD Producer Cod
     C           WUIKNB    PARM *ZERO     WQ0029  80       Address Number
     C           WUDVTX    PARM *BLANK    WQ0030 40        Pass Name
     C           WUDNTX    PARM *BLANK    WQ0031 40        Address 1
     C           WUDOTX    PARM *BLANK    WQ0032 40        Address 2
     C           WUDPTX    PARM *BLANK    WQ0033 40        Address 3
     C           WUDQTX    PARM *BLANK    WQ0034 40        City
     C           WUDRTX    PARM *BLANK    WQ0035  3        State
     C           WUDSTX    PARM *BLANK    WQ0036 12        Zip
     C           WUDTTX    PARM *BLANK    WQ0037  6        Area Code
     C           WUDUTX    PARM *BLANK    WQ0038 20        Telephone
     C           WUNLTX    PARM *BLANK    WQ0039  6        Fax Area Code #
     C           WUNNTX    PARM *BLANK    WQ0040 20        Fax Telephone
     C           WUNVTX    PARM *BLANK    WQ0041 40        Fax Attn 1
     C           WUNMTX    PARM *BLANK    WQ0042  6        Fax Area Code #
     C           WUNOTX    PARM *BLANK    WQ0043 20        Fax Telephone 2
     C           WUNWTX    PARM *BLANK    WQ0044 40        Fax Attn 2
     C           WUGNST    PARM *BLANK    WQ0045  1        Vendor 1099
     C           WUDXTX    PARM *BLANK    WQ0046 16        Vendor Tax Id.
     C           WUE0CD    PARM *BLANK    WQ0047  3        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWCZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Kill Date of Prt Payment Edit/Post PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print TH Tattoo Number of Prt Payment Edit/Post PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Prt Payment Edit/Post PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MULT -1        $ETBPR           TH Excluded Gro
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $EB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEB0DT
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  $EAWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEAWDT
      * Convert TH Pricing Date to display format
      * Convert date
     C           1000000   ADD  $EA6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEA6DT
     C                     MOVEL'0'       *IN79
     C           $ECWST    IFEQ 'ML'                       *IF
     C           $ECWST    OREQ 'SL'
     C           $ECWST    OREQ 'SC'
     C           $ECWST    OREQ 'IC'
     C           $ECWST    OREQ 'IL'
     C           $ECWST    OREQ *BLANK
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           $EH9NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PO BO Header
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of PO BO Header
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Detail line. of PO BO Header
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Ttt D/A            PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Ttt D/A            PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Ttt D/A            PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Ttt D/A            PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Ttt D/A            PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print TH Kill Date of Prt Ttt D/A            PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Detail line. of Prt Ttt D/A            PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt PrdEmailHdr       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Detail line. of Prt PrdEmailHdr       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of Prt PrdEmlDtl         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print PD Producer Code of Prt PrdEmlDtl         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Detail line. of Prt PrdEmlDtl         PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of Prt PrdLocEmlHdr      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print PD Producer Code of Prt PrdLocEmlHdr      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print Detail line. of Prt PrdLocEmlHdr      PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of Prt PrdLocEmlDtl      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print PD Producer Code of Prt PrdLocEmlDtl      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print PL Location Code of Prt PrdLocEmlDtl      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP01
     C                     END                             FI
      * Print Detail line. of Prt PrdLocEmlDtl      PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$LCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$LDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Payment Edit/Post PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Payment Edit/Post PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt Payment Edit/Post PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PL Location Code of Prt Payment Edit/Post PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Payment Edit/Post PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Payment Edit/Post PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Payment Edit/Post PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD6         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD5         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PO BO Header
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of PO BO Header
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PO BO Header
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Ttt D/A            PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Ttt D/A            PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Ttt D/A            PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Ttt D/A            PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Ttt D/A            PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Ttt D/A            PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Ttt D/A            PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt PrdEmailHdr       PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt PrdEmailHdr       PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt PrdEmlDtl         PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt PrdEmlDtl         PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt PrdEmlDtl         PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt PrdLocEmlHdr      PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt PrdLocEmlHdr      PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt PrdLocEmlHdr      PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt PrdLocEmlDtl      PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt PrdLocEmlDtl      PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PL Location Code of Prt PrdLocEmlDtl      PO
     C           W0GP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt PrdLocEmlDtl      PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * 08/04/17 JBB E9904 - Add Company Number to Top of Page
     C                     Z-ADDP1HMNB    $BHMNB           BOH Company Num
     C                     Z-ADDP1B0DT    $BB0DT           TH Kill Date
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $BB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBB0DT
     C                     MOVEL'0'       *IN79
     C           P2J2ST    IFEQ 'E'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P2J2ST    IFEQ 'P'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Batch #   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKHNNB    WQSA01           VCH Company num
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           VCH Company num
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           VCH Company num
      * Establish starting position
     C           KRSSA     SETLL@BKCPN2                    *
     C           KRSSA     READE@BKCPN2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WULWNB           VCH Batch Numbe
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           BKLWNB    ADD  1         WULWNB           VCH Batch Numbe
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@BKCPN2                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Fax Status        RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL$DABCD    AFABCD           PD Producer Cod
     C                     MOVEL$DAECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSB     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P6GLNB           Pl VND Address
     C                     MOVEL*BLANK    P6AUST           PL Fax Status
     C                     MOVEL*BLANK    P6QNST           PL Fax   Carcas
     C                     MOVEL*BLANK    P6QOST           PL Unused
     C                     MOVEL*BLANK    P6QPST           PL Fax   Carcas
     C                     MOVEL*BLANK    P6QQST           PL Fax to Produ
     C                     MOVEL*BLANK    P6QRST           PL Producer Fax
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFGLNB    P6GLNB           Pl VND Address
     C                     MOVELAFAUST    P6AUST           PL Fax Status
     C                     MOVELAFQNST    P6QNST           PL Fax   Carcas
     C                     MOVELAFQOST    P6QOST           PL Unused
     C                     MOVELAFQPST    P6QPST           PL Fax   Carcas
     C                     MOVELAFQQST    P6QQST           PL Fax to Produ
     C                     MOVELAFQRST    P6QRST           PL Producer Fax
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vnd#, Faxsts RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$DABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSC     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P8GCNB           PD VND Address
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    P8GCNB           PD VND Address
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$EHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSD     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWAKCD    WN0001           PC Contract Cod
     C                     MOVELAWALCD    WUOCTX           PSC Sub-Contrac
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
     C                     EXSR SERVGN
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AQAKCD           PC Contract Cod
     C                     KFLD           AQALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELAWAKCD    AQAKCD           PC Contract Cod
     C                     MOVELAWALCD    AQALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSE     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0004           PSC FLoor Price
     C                     MOVEL*BLANK    WN0005           PSC Sub-Contrac
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAQA8PR    WN0004           PSC FLoor Price
     C                     MOVELAQF3ST    WN0005           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Reserve Acct D/A  RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CDHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN CDBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN CDBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN CDCVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN CDB0DT    WQSF05           TH Kill Date
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
     C                     KFLD           CDBQCD           DED D/A Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQSF01           BOH Company Num
     C                     Z-ADD$EBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQSF03           BOL Load Number
     C                     Z-ADD$ECVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQSF05           TH Kill Date
     C                     MOVEL*BLANK    CDBQCD           DED D/A Code
      * Establish starting position
     C           KPSSF     SETLL@CDCPIU                    *
     C           KRSSF     READE@CDCPIU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * CASE: DB1.THD Reserve Account Upd is Yes
     C           CDPGST    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDCDA0VA    WN0006           THD Ded/Add Amo
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Last Seq# for Dte RT - Producer Cntrct RsvAct Dt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EFAKCD    WQSG01           PC Contract Cod
     C           *LIKE     DEFN EFDMDT    WQSG02           PAD Transaction
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           PC Contract Cod
     C                     KFLD           WQSG02           PAD Transaction
      * Setup key
     C                     MOVELWN0001    WQSG01           PC Contract Cod
     C                     Z-ADD##JDT     WQSG02           PAD Transaction
      * Establish starting position
     C           KRSSG     SETLL@EFCPAS                    *
     C           KRSSG     READE@EFCPAS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0822' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0002           PAD Transaction
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEFPADS    WN0002           PAD Transaction
     C           KRSSG     READE@EFCPAS                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Reserve Acct Dtl  CR - Producer Cntrct RsvAct Dt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EFCPAO
     C                     MOVELWN0001    WAAKCD           PC Contract Cod
     C                     Z-ADD##JDT     WADMDT           PAD Transaction
     C                     Z-ADDWN0002    WAPADS           PAD Transaction
     C                     Z-ADDWN0003    WAEKVA           PAD Transaction
     C                     MOVEL'BOL'     WASKST           PAD Transaction
     C                     Z-ADD$EHMNB    WAHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    WABONB           BOL Load Number
     C                     Z-ADD$ECVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WAB0DT           TH Kill Date
     C                     MOVEL*BLANK    WAAAVN           RS User Changed
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
      *
     C           KLCRSH    KLIST
     C                     KFLD           WAAKCD           PC Contract Cod
     C                     KFLD           WADMDT           PAD Transaction
     C                     KFLD           WAPADS           PAD Transaction
      * Check for duplicate primary key
     C           KLCRSH    SETLL@EFCPAO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0823' W0RTN   7
      * Send message 'Producer Cntrct1208335'
     C                     MOVEL'PRK0823' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@EFCPAO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Chg Account Balance   CH - Producer Cntrct RsvAct Hd  * 
     C                     EXSR SICHRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Account Balance   CH - Producer Cntrct RsvAct Hd  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007 152       PAH Account Bal
     C                     Z-ADD*ZERO     WN0008  70       PAH Activation
     C                     MOVEL*BLANK    WN0009 10        RS User Added
     C                     Z-ADD*ZERO     WN0010  70       RS Date Added
     C                     Z-ADD*ZERO     WN0011  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @EECPAQ
     C                     MOVELWAAKCD    EEAKCD    P      PC Contract Cod
      *
     C           KLCHSI    KLIST
     C                     KFLD           EEAKCD           PC Contract Cod
     C           KLCHSI    CHAIN@EECPAQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEECPL1'MDACP
     C                     MOVEL'@EECPAQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKEE1    YARDCS
      * USER: Processing after Data read
     C                     ADD  WAEKVA    EEEJVA           PAH Account Bal
      * Move non-key fields to @EECPAQ
     C                     MOVELWAAAVN    EEAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    EEAADT           RS Date Changed
     C                     Z-ADDWAAMTM    EEAMTM           RS Time Changed
     C                     MOVELWAAJST    EEAJST    P      RS Record Statu
     C                     MOVELWAAHVN    EEAHVN    P      RS Job
     C                     MOVELWAAGVN    EEAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKEE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@EECPAQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKEECPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0012 10        RS User Changed
     C                     Z-ADD*ZERO     WN0013  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0014  60       RS Time Changed
     C                     MOVEL*BLANK    WN0015  1        RS Record Statu
     C                     MOVEL*BLANK    WN0016 10        RS Job
     C                     MOVEL*BLANK    WN0017 10        RS Program
     C                     MOVEL*BLANK    WN0018 10        RS User Added
     C                     Z-ADD*ZERO     WN0019  70       RS Date Added
     C                     Z-ADD*ZERO     WN0020  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'P'       D7RLST           TFD Driver Type
     C                     MOVE *BLANK    D7NKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'D7NKTX           TFD Header Acti
     C                     MOVELWUCRTX    D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVEL*BLANK    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0021 10        RS User Changed
     C                     Z-ADD*ZERO     WN0022  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0023  60       RS Time Changed
     C                     MOVEL*BLANK    WN0024  1        RS Record Statu
     C                     MOVEL*BLANK    WN0025 10        RS Job
     C                     MOVEL*BLANK    WN0026 10        RS Program
     C                     MOVEL*BLANK    WN0027 10        RS User Added
     C                     Z-ADD*ZERO     WN0028  70       RS Date Added
     C                     Z-ADD*ZERO     WN0029  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7LSTX    D7NITX           TFD Area Code
     C                     MOVELP7LRTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSK    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0030 10        RS User Changed
     C                     Z-ADD*ZERO     WN0031  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0032  60       RS Time Changed
     C                     MOVEL*BLANK    WN0033  1        RS Record Statu
     C                     MOVEL*BLANK    WN0034 10        RS Job
     C                     MOVEL*BLANK    WN0035 10        RS Program
     C                     MOVEL*BLANK    WN0036 10        RS User Added
     C                     Z-ADD*ZERO     WN0037  70       RS Date Added
     C                     Z-ADD*ZERO     WN0038  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7NGTX    D7NITX           TFD Area Code
     C                     MOVELP7NHTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSL    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSL    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0039 10        RS User Changed
     C                     Z-ADD*ZERO     WN0040  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0041  60       RS Time Changed
     C                     MOVEL*BLANK    WN0042  1        RS Record Statu
     C                     MOVEL*BLANK    WN0043 10        RS Job
     C                     MOVEL*BLANK    WN0044 10        RS Program
     C                     MOVEL*BLANK    WN0045 10        RS User Added
     C                     Z-ADD*ZERO     WN0046  70       RS Date Added
     C                     Z-ADD*ZERO     WN0047  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNLTX    D7NITX           TFD Area Code
     C                     MOVELWUNNTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSM    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0048 10        RS User Changed
     C                     Z-ADD*ZERO     WN0049  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0050  60       RS Time Changed
     C                     MOVEL*BLANK    WN0051  1        RS Record Statu
     C                     MOVEL*BLANK    WN0052 10        RS Job
     C                     MOVEL*BLANK    WN0053 10        RS Program
     C                     MOVEL*BLANK    WN0054 10        RS User Added
     C                     Z-ADD*ZERO     WN0055  70       RS Date Added
     C                     Z-ADD*ZERO     WN0056  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNMTX    D7NITX           TFD Area Code
     C                     MOVELWUNOTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSN    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSN    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0057 10        RS User Changed
     C                     Z-ADD*ZERO     WN0058  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0059  60       RS Time Changed
     C                     MOVEL*BLANK    WN0060  1        RS Record Statu
     C                     MOVEL*BLANK    WN0061 10        RS Job
     C                     MOVEL*BLANK    WN0062 10        RS Program
     C                     MOVEL*BLANK    WN0063 10        RS User Added
     C                     Z-ADD*ZERO     WN0064  70       RS Date Added
     C                     Z-ADD*ZERO     WN0065  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'P'       D7RLST           TFD Driver Type
     C                     MOVE *BLANK    D7NKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'D7NKTX           TFD Header Acti
     C                     MOVEL@CN,001   D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVEL*BLANK    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSO    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0066 10        RS User Changed
     C                     Z-ADD*ZERO     WN0067  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0068  60       RS Time Changed
     C                     MOVEL*BLANK    WN0069  1        RS Record Statu
     C                     MOVEL*BLANK    WN0070 10        RS Job
     C                     MOVEL*BLANK    WN0071 10        RS Program
     C                     MOVEL*BLANK    WN0072 10        RS User Added
     C                     Z-ADD*ZERO     WN0073  70       RS Date Added
     C                     Z-ADD*ZERO     WN0074  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7LSTX    D7NITX           TFD Area Code
     C                     MOVELP7LRTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSP    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSP    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0075 10        RS User Changed
     C                     Z-ADD*ZERO     WN0076  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0077  60       RS Time Changed
     C                     MOVEL*BLANK    WN0078  1        RS Record Statu
     C                     MOVEL*BLANK    WN0079 10        RS Job
     C                     MOVEL*BLANK    WN0080 10        RS Program
     C                     MOVEL*BLANK    WN0081 10        RS User Added
     C                     Z-ADD*ZERO     WN0082  70       RS Date Added
     C                     Z-ADD*ZERO     WN0083  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7NGTX    D7NITX           TFD Area Code
     C                     MOVELP7NHTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0084 10        RS User Changed
     C                     Z-ADD*ZERO     WN0085  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0086  60       RS Time Changed
     C                     MOVEL*BLANK    WN0087  1        RS Record Statu
     C                     MOVEL*BLANK    WN0088 10        RS Job
     C                     MOVEL*BLANK    WN0089 10        RS Program
     C                     MOVEL*BLANK    WN0090 10        RS User Added
     C                     Z-ADD*ZERO     WN0091  70       RS Date Added
     C                     Z-ADD*ZERO     WN0092  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNLTX    D7NITX           TFD Area Code
     C                     MOVELWUNNTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSR    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSR    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0093 10        RS User Changed
     C                     Z-ADD*ZERO     WN0094  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0095  60       RS Time Changed
     C                     MOVEL*BLANK    WN0096  1        RS Record Statu
     C                     MOVEL*BLANK    WN0097 10        RS Job
     C                     MOVEL*BLANK    WN0098 10        RS Program
     C                     MOVEL*BLANK    WN0099 10        RS User Added
     C                     Z-ADD*ZERO     WN0100  70       RS Date Added
     C                     Z-ADD*ZERO     WN0101  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNMTX    D7NITX           TFD Area Code
     C                     MOVELWUNOTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSS    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Crt ProdEm - TattDrv  RT - Producer Email Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           RBABCD           PD Producer Cod
      * Setup key
     C                     MOVELA1ABCD    RBABCD           PD Producer Cod
      * Establish starting position
     C           KRSST     CHAIN@AZREN3              90    *
      * Data record not found
     C   90                MOVEL'PRK1179' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           RBAJST    IFEQ 'A'                        *IF
      * Rtv Email Status      RT - Producer Loc Email Hdr  * 
     C                     EXSR SURVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is Record Found
      *   |- c2    : WRK.PLEH Email to Producer is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ '999'                      *IF
     C           WUBNSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * * creation of the tattoo fax driver for the emails by producer
      * Crt PrdEmlDtlTatFax   RT - Producer Email Detail  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Email Status      RT - Producer Loc Email Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           RDABCD           PD Producer Cod
     C                     KFLD           RDAECD           PL Location Cod
      * Setup key
     C                     MOVELA1ABCD    RDABCD           PD Producer Cod
     C                     MOVELA1AECD    RDAECD           PL Location Cod
      * Establish starting position
     C           KRSSU     CHAIN@A0REN6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1181' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBKSS           PLEH Email Stat
     C                     MOVEL*BLANK    WUBLSS           PLEH Email Carc
     C                     MOVEL*BLANK    WUBMSS           PLEH Email Carc
     C                     MOVEL*BLANK    WUBNSS           PLEH Email to P
     C                     MOVEL*BLANK    WUBOSS           PLEH Producer E
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELRDBKSS    WUBKSS           PLEH Email Stat
     C                     MOVELRDBLSS    WUBLSS           PLEH Email Carc
     C                     MOVELRDBMSS    WUBMSS           PLEH Email Carc
     C                     MOVELRDBNSS    WUBNSS           PLEH Email to P
     C                     MOVELRDBOSS    WUBOSS           PLEH Producer E
     C                     MOVELRDAJST    WUAJST           RS Record Statu
      * CASE: DB1.RS Record Status is Active
     C           RDAJST    IFEQ 'A'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Crt PrdEmlDtlTatFax   RT - Producer Email Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN RAABCD    WQSV01           PD Producer Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           PD Producer Cod
      * Setup key
     C                     MOVELA1ABCD    WQSV01           PD Producer Cod
      * Establish starting position
     C           KRSSV     SETLL@A1REN9                    *
     C           KRSSV     READE@A1REN9                  90*
      * Data record not found
     C   90                MOVEL'PRK1183' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Test Record Status
      * CASE: DB1.RS Record Status is Active
     C           RAAJST    IFEQ 'A'                        *IF
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PLEH Email Carcass Sum is Yes
     C           WUBLSS    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE: PAR.PLEH Email Carcass Detail is Yes
     C           WUBMSS    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   WUNPTX           TFD Header Acti
     C                     END                             *FI
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SWCRRC
     C                     END                             *FI
     C           KRSSV     READE@A1REN9                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0102 10        RS User Changed
     C                     Z-ADD*ZERO     WN0103  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0104  60       RS Time Changed
     C                     MOVEL*BLANK    WN0105  1        RS Record Statu
     C                     MOVEL*BLANK    WN0106 10        RS Job
     C                     MOVEL*BLANK    WN0107 10        RS Program
     C                     MOVEL*BLANK    WN0108 10        RS User Added
     C                     Z-ADD*ZERO     WN0109  70       RS Date Added
     C                     Z-ADD*ZERO     WN0110  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELWUBOSS    D7RKST           TFD Producer Se
     C                     MOVEL'E'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVELRAVMTX    D7NJTX           TFD Phone # or
     C                     Z-ADDA1BYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADDA1LPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADDA1HMNB    D7HMNB           BOH Company Num
     C                     Z-ADDA1BNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    D7BONB           BOL Load Number
     C                     Z-ADDA1CVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSW    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSW    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Crt PrdLodEm-TattDrvT RT - Producer Loc Email Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           RDABCD           PD Producer Cod
     C                     KFLD           RDAECD           PL Location Cod
      * Setup key
     C                     MOVELA1ABCD    RDABCD           PD Producer Cod
     C                     MOVELA1AECD    RDAECD           PL Location Cod
      * Establish starting position
     C           KRSSX     CHAIN@A0REN6              90    *
      * Data record not found
     C   90                MOVEL'PRK1181' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           RDAJST    IFEQ 'A'                        *IF
      * CASE: DB1.PLEH Email Status is Yes
     C           RDBKSS    IFEQ 'Y'                        *IF
      * CrtPrdLocEmlDtlTatFax2 RT - Producer Loc Email Detail  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * CrtPrdLocEmlDtlTatFax2 RT - Producer Loc Email Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN RCABCD    WQSY01           PD Producer Cod
     C           *LIKE     DEFN RCAECD    WQSY02           PL Location Cod
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           PD Producer Cod
     C                     KFLD           WQSY02           PL Location Cod
      * Setup key
     C                     MOVELA1ABCD    WQSY01           PD Producer Cod
     C                     MOVELA1AECD    WQSY02           PL Location Cod
      * Establish starting position
     C           KRSSY     SETLL@A2REOD                    *
     C           KRSSY     READE@A2REOD                  90*
      * Data record not found
     C   90                MOVEL'PRK1185' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           RCAJST    IFEQ 'A'                        *IF
      * create information for Carcass Summary/Carcass Detail
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PLEH Email Status is Yes
      *   |- c2    : PAR.PLEH Email to Producer is Yes
      *   '-
     C           WUBKSS    IFEQ 'Y'                        *IF
     C           WUBNSS    OREQ 'Y'                        *OR
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PLEH Email Carcass Sum is Yes
     C           WUBLSS    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE: PAR.PLEH Email Carcass Detail is Yes
     C           WUBMSS    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   WUNPTX           TFD Header Acti
     C                     END                             *FI
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR SZCRRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSY     READE@A2REOD                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0111 10        RS User Changed
     C                     Z-ADD*ZERO     WN0112  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0113  60       RS Time Changed
     C                     MOVEL*BLANK    WN0114  1        RS Record Statu
     C                     MOVEL*BLANK    WN0115 10        RS Job
     C                     MOVEL*BLANK    WN0116 10        RS Program
     C                     MOVEL*BLANK    WN0117 10        RS User Added
     C                     Z-ADD*ZERO     WN0118  70       RS Date Added
     C                     Z-ADD*ZERO     WN0119  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELWUBOSS    D7RKST           TFD Producer Se
     C                     MOVEL'E'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVELRCVNTX    D7NJTX           TFD Phone # or
     C                     Z-ADDA1BYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADDA1LPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADDA1HMNB    D7HMNB           BOH Company Num
     C                     Z-ADDA1BNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    D7BONB           BOL Load Number
     C                     Z-ADDA1CVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRSZ    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHNNB    WQTA01           VCH Company num
     C           *LIKE     DEFN WBLWNB    WQTA02           VCH Batch Numbe
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           VCH Company num
     C                     KFLD           WQTA02           VCH Batch Numbe
      * Setup key
     C                     Z-ADD$EHMNB    WQTA01           VCH Company num
     C                     Z-ADDWULWNB    WQTA02           VCH Batch Numbe
      * Establish starting position
     C           KRSTA     SETLL@BKCPJR                    *
     C           KRSTA     READE@BKCPJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD00001     WUG9NB           VCH Header Numb
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBG9NB    ADD  1         WUG9NB           VCH Header Numb
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@BKCPJR                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Producer Split    RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           BFABCD           PD Producer Cod
     C                     KFLD           BFBTCD           BOS Split Produ
      * Setup key
     C                     MOVEL$EABCD    BFABCD           PD Producer Cod
     C                     MOVEL$EABCD    BFBTCD           BOS Split Produ
      * Establish starting position
     C           KRSTB     CHAIN@BFREE4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD100       WUBUPC           PSS Split Perce
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBFABPC    WUBUPC           PSS Split Perce
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$EABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTC     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WULXNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WULXNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR TDRVGN
     C                     GOTO TCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVELACABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSTD     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    WUQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Crt Voucher Header    CR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPEK
     C                     Z-ADD$EHMNB    WCHNNB           VCH Company num
     C                     Z-ADDWULWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WCG9NB           VCH Header Numb
     C                     Z-ADDWULXNB    WCLXNB           VCH AP Address
     C                     Z-ADD*ZERO     WCLYNB           VCH AP Voucher
     C                     MOVELWUCSST    WCCSST           VCH Payee Type
     C                     Z-ADD*ZERO     WCDKNB           VCH Manual Chec
     C                     Z-ADD*ZERO     WCA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     WCCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WCCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WCCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WCCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WCCMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     WCAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WCAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WCCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WCAJVA           VCH Net Amt
     C                     Z-ADDWUBUPC    WCBUPC           VCH Split %
     C                     MOVEL'N'       WCJHST           VCH Split Check
     C                     MOVEL'O'       WCC0ST           VCH Process Sta
     C                     Z-ADD$EB0DT    WCA4DT           VCH G/L Date
     C                     MOVEL'R'       WCCUST           VCH Check Type
     C                     MOVEL$EABCD    WCABCD           PD Producer Cod
     C                     MOVEL*BLANK    WCBNCD           TRK Trucker Cod
     C                     MOVEL*BLANK    WCCFCD           VR Reason Code
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTE    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCRTE    SETLL@BKCPEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0125  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0126  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0127  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0128  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0129  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0130  72       TH CA Carcass G
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB5DT           TH Kill Date
     C                     Z-ADD*ZERO     WUCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHENB           TH Head Adds
     C                     Z-ADD*ZERO     WUCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WUAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WUASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WUCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WUCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WUA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WUJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WUIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WUOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WUTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WUKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WUOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WUKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WUECDT           TH Head LFT
     C                     Z-ADD*ZERO     WUEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0120           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0121           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0122           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0125           TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0126           TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0127           TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0128           TH CA Base Carc
     C                     Z-ADD*ZERO     WN0129           TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0130           TH CA Carcass G
     C                     Z-ADD*ZERO     WN0123           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0124           Loin-Eye * Wgt
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQTF01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQTF02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQTF03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQTF04           TH Tattoo Numbe
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           BOH Company Num
     C                     KFLD           WQTF02           BOH Buy Order N
     C                     KFLD           WQTF03           BOL Load Number
     C                     KFLD           WQTF04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$EHMNB    WQTF01           BOH Company Num
     C                     Z-ADD$EBNNB    WQTF02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQTF03           BOL Load Number
     C                     Z-ADD$ECVNB    WQTF04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTF     SETLL@A1CPC4                    *
     C           KRSTF     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 061208 slm E00144 LFT and eut/koa
      * 050108 slm get TH Fixed Cost Amount
      *                TH Meat Value Factor Amt
      * First Kill Date
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
     C                     Z-ADDWDB0DT    WUB5DT           TH Kill Date
     C                     ADD  WDCXNB    WUCXNB           TH Dead On Arri
     C                     ADD  WDECDT    WUECDT           TH Head LFT
     C                     ADD  WDEDDT    WUEDDT           TH Head EUT/KOA
     C                     ADD  WDCWNB    WUCWNB           TH Head Receive
     C                     ADD  WDFCNB    WUFCNB           TH Yard Deads
     C                     ADD  WDFDNB    WUFDNB           TH Head Condemn
     C                     ADD  WDFENB    WUFENB           TH Head Killed
     C                     ADD  WDHENB    WUHENB           TH Head Adds
     C                     ADD  WDCYNB    WUCYNB           TH Live Wgt
     C                     ADD  WDLRNB    WULRNB           TH Adj Live Wgt
     C                     ADD  WDE0NB    WUE0NB           TH Hot Wgt
     C                     ADD  WDANPR    WUANPR           TH CM Base Mkt
      * 5/29/03 new for sort loss print
      * CASE: PAR.Status 3 is Yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     ADD  WDNCHF    WUAYVA           TH CM Sort Disc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WDAYVA    WUAYVA           TH CM Sort Disc
     C                     END                             *FI
     C                     ADD  WDAWVA    WUAWVA           TH CM Yield Gai
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WUDLST    IFEQ 'M'                        *IF
     C                     ADD  WDA2PR    WUAOPR           TH CM Base Carc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WDAOPR    WUAOPR           TH CM Base Carc
     C                     END                             *FI
     C                     ADD  WDAXVA    WUAXVA           TH CM LN AddOn/
     C                     ADD  WDAPPR    WUAPPR           TH CM Carcass G
     C                     ADD  WDATPR    WUATPR           TH Carcass Net
     C                     ADD  WDCBPR    WUCBPR           TH Payment Gros
     C                     ADD  WDCCPR    WUCCPR           Th Payment Net
      * Lean % * Wgt USR
      * PAR.Lean % * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Lean % * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Lean Percent
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WDF4NB    MULT WDE0NB    W0WD01           *Synon (17,7) w
     C           WN0120    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0120           Lean % * Wgt US
      * Backfat * Wgt USR
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WDF2NB    MULT WDE0NB    W0WD01           *Synon (17,7) w
     C           WN0121    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0121           Backfat * Wgt U
      * Loin-Eye * Wgt USR
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye Depth
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WDF3NB    MULT WDE0NB    W0WD01           *Synon (17,7) w
     C           WN0122    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0122           Loin-Eye * Wgt
      * Backfat2 * Wgt USR
      * PAR.Backfat * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat - 2 Dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WDMCNF    MULT WDE0NB    W0WD01           *Synon (17,7) w
     C           WN0123    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0123           Backfat * Wgt U
      * Loin-Eye2 * Wgt USR
      * PAR.Loin-Eye * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye - 2 dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WDMVNF    MULT WDE0NB    W0WD01           *Synon (17,7) w
     C           WN0124    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0124           Loin-Eye * Wgt
     C                     ADD  WDASPR    WUASPR           TH Deduction Am
     C                     ADD  WDA5VA    WUA5VA           TH Additions Am
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           WUMVST    IFEQ 'Y'                        *IF
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
     C                     EXSR TGRVGN
     C                     ADD  WUI6PR    WN0125           TH CA Base Mkt
     C                     ADD  WUI7PR    WN0126           TH CA Sort Disc
     C                     ADD  WUI8PR    WN0127           TH CA Yield Gai
     C                     ADD  WUI9PR    WN0128           TH CA Base Carc
     C                     ADD  WUJAPR    WN0129           TH CA Lean Prem
     C                     ADD  WUJCPR    WN0130           TH CA Carcass G
     C                     END                             *FI
      * PK0166 - New fields
     C                     ADD  WDJ9NB    WUJ9NB           TH Head Exclude
     C                     ADD  WDTBPR    WUTBPR           TH Excluded Gro
     C                     ADD  WDKROT    WUKROT           TH Excluded Car
     C                     ADD  WDOTJG    WUOTJG           TH Excluded Pre
     C                     ADD  WDIORP    WUIORP           TH Head Adjuste
     C                     ADD  WDOWEO    WUOWEO           TH PHA Head Add
      * 050108 slm get TH Fixed Cost Amount
     C                     ADD  WDA2PR    WUA2PR           TH Fixed Cost A
     C                     ADD  WDKFOR    WUKFOR           TH Meat Value F
     C           KRSTF     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           WUMVST    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0125    WUANPR           TH CM Base Mkt
     C                     Z-ADDWN0126    WUAYVA           TH CM Sort Disc
     C                     Z-ADDWN0127    WUAWVA           TH CM Yield Gai
     C                     Z-ADDWN0128    WUAOPR           TH CM Base Carc
     C                     Z-ADDWN0129    WUAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0130    WUAPPR           TH CM Carcass G
     C                     END                             *FI
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWDHMNB    DNHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    DNBONB           BOL Load Number
     C                     Z-ADDWDCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSTG     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WUI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WUI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WUI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WUJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WUJCPR           TH CA Carcass G
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDNI6PR    WUI6PR           TH CA Base Mkt
     C                     Z-ADDDNI7PR    WUI7PR           TH CA Sort Disc
     C                     Z-ADDDNI8PR    WUI8PR           TH CA Yield Gai
     C                     Z-ADDDNI9PR    WUI9PR           TH CA Base Carc
     C                     Z-ADDDNJAPR    WUJAPR           TH CA Lean Prem
     C                     Z-ADDDNJCPR    WUJCPR           TH CA Carcass G
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv BOH Py Typ,BO Typ RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$EHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTH     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'L'       WUA4ST           BOH Payment Typ
     C                     MOVEL'O'       WUA5ST           BOH Buy Order T
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA4ST    WUA4ST           BOH Payment Typ
     C                     MOVELAWA5ST    WUA5ST           BOH Buy Order T
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vnd#,Src,CntRT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$EABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTI     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUCYSS           SR Source Contr
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
      * Rtv Src Cntrt Type    RT - Source  * 
     C                     EXSR TJRVGN
     C                     GOTO TIEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Src Cntrt Type    RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELACAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSTJ     CHAIN@AAREAC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUCYSS           SR Source Contr
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAACYSS    WUCYSS           SR Source Contr
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPEI
     C                     Z-ADD$EHMNB    BLHNNB           VCH Company num
     C                     Z-ADDWULWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWUDLNB    BLDLNB           VCD Line
     C                     Z-ADDWUANPR    BLCNPR           VCD Base Mkt Pr
     C                     Z-ADDWUAYVA    BLCOPR           VCD Sort Disc A
     C                     Z-ADDWUAWVA    BLCPPR           VCD Yield Gain/
     C                     Z-ADDWUAOPR    BLCQPR           VCD Base Carcas
     C                     Z-ADDWUAXVA    BLCRPR           VCD LN Add on/D
     C                     Z-ADDWUCBPR    BLAKVA           VCD Gross Amt
     C                     Z-ADDWUA9VA    BLALVA           VCD Deduction A
     C                     Z-ADDWUCVPR    BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADDWUBUPC    BLAEPC           VCD Split Perce
     C                     MOVEL$EJ9ST    BLI6ST           VCD Payment Typ
     C                     MOVELWUJIST    BLJIST           VCD Hog Class T
     C                     MOVELWUA5ST    BLJPST           VCD BO Type
     C                     MOVELWUCYSS    BLC2SS           VCD Source Cont
     C                     MOVEL$ELKST    BLOTCD           VCD Source Code
     C                     MOVELWUF5TX    BLF5TX           VCD Check Descr
     C                     Z-ADDWUCWNB    BLL5A1           VCD Received He
     C                     Z-ADDWUFENB    BLL6A1           VCD Head Killed
     C                     MOVELWUJQST    BLJQST           VCD Push Paymen
     C                     MOVELWUC4SS    BLC4SS           VCD Repayment F
     C                     MOVELWUCRTX    BLC5SS           VCD Unused Stat
     C                     MOVELWUCRTX    BLC3SS           VCD Unused Stat
     C                     Z-ADD*ZERO     BLOKA1           VCD Unused Head
     C                     Z-ADD*ZERO     BLOLA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     BLOMA1           VCD UnUsed Head
     C                     MOVELYL0013    BLQ0CD           MGL Supplier In
     C                     Z-ADD*ZERO     BLWSA1           MGL Voucher Num
     C                     Z-ADD*ZERO     BLWOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     BLHFDT           MGL Process to
     C                     Z-ADD*ZERO     BLB2TM           MGL Process to
     C                     Z-ADD$EHMNB    BLHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    BLBONB           BOL Load Number
     C                     Z-ADD$ECVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    BLB0DT           TH Kill Date
     C                     MOVEL$EABCD    BLABCD           PD Producer Cod
     C                     MOVEL$EAECD    BLAECD           PL Location Cod
     C                     MOVEL*BLANK    BLAAVN           RS User Changed
     C                     Z-ADD*ZERO     BLAADT           RS Date Changed
     C                     Z-ADD*ZERO     BLAMTM           RS Time Changed
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL*BLANK    BLAHVN           RS Job
     C                     MOVEL*BLANK    BLAGVN           RS Program
     C                     MOVEL*BLANK    BLABVN           RS User Added
     C                     Z-ADD*ZERO     BLABDT           RS Date Added
     C                     Z-ADD*ZERO     BLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL##USR     BLABVN           RS User Added
     C                     Z-ADD##JDT     BLABDT           RS Date Added
     C                     Z-ADD##JTM     BLABTM           RS Time Added
     C                     MOVEL##PGM     BLAGVN           RS Program
     C                     MOVEL##JOB     BLAHVN           RS Job
     C           KLCRTK    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCRTK    SETLL@BLCPEI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPEI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0074  30       BOH Company Num
     C                     PARM BLBNNB    WQ0075  70       BOH Buy Order N
     C                     PARM BLBONB    WQ0076  50       BOL Load Number
     C                     PARM BLCVNB    WQ0077  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0078  70       TH Kill Date
     C                     PARM *ZERO     WQ0079  50       TH Head Receive
     C                     PARM *ZERO     WQ0080  50       TH Held Over
     C                     PARM *ZERO     WQ0081  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0082  70       TH Voucher Paym
     C                     PARM 'CV'      WQ0083  2        Tattoo Action U
     C                     PARM *BLANK    WQ0084  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0131 10        RS User Changed
     C                     Z-ADD*ZERO     WN0132  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0133  60       RS Time Changed
     C                     MOVEL*BLANK    WN0134  1        RS Record Statu
     C                     MOVEL*BLANK    WN0135 10        RS Job
     C                     MOVEL*BLANK    WN0136 10        RS Program
     C                     MOVEL*BLANK    WN0137 10        RS User Added
     C                     Z-ADD*ZERO     WN0138  70       RS Date Added
     C                     Z-ADD*ZERO     WN0139  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'P'       D7RLST           TFD Driver Type
     C                     MOVE *BLANK    D7NKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'D7NKTX           TFD Header Acti
     C                     MOVELWUCRTX    D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVEL*BLANK    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTL    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTL    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0140 10        RS User Changed
     C                     Z-ADD*ZERO     WN0141  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0142  60       RS Time Changed
     C                     MOVEL*BLANK    WN0143  1        RS Record Statu
     C                     MOVEL*BLANK    WN0144 10        RS Job
     C                     MOVEL*BLANK    WN0145 10        RS Program
     C                     MOVEL*BLANK    WN0146 10        RS User Added
     C                     Z-ADD*ZERO     WN0147  70       RS Date Added
     C                     Z-ADD*ZERO     WN0148  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7LSTX    D7NITX           TFD Area Code
     C                     MOVELP7LRTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTM    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTM    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0149 10        RS User Changed
     C                     Z-ADD*ZERO     WN0150  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0151  60       RS Time Changed
     C                     MOVEL*BLANK    WN0152  1        RS Record Statu
     C                     MOVEL*BLANK    WN0153 10        RS Job
     C                     MOVEL*BLANK    WN0154 10        RS Program
     C                     MOVEL*BLANK    WN0155 10        RS User Added
     C                     Z-ADD*ZERO     WN0156  70       RS Date Added
     C                     Z-ADD*ZERO     WN0157  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7NGTX    D7NITX           TFD Area Code
     C                     MOVELP7NHTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTN    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTN    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0158 10        RS User Changed
     C                     Z-ADD*ZERO     WN0159  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0160  60       RS Time Changed
     C                     MOVEL*BLANK    WN0161  1        RS Record Statu
     C                     MOVEL*BLANK    WN0162 10        RS Job
     C                     MOVEL*BLANK    WN0163 10        RS Program
     C                     MOVEL*BLANK    WN0164 10        RS User Added
     C                     Z-ADD*ZERO     WN0165  70       RS Date Added
     C                     Z-ADD*ZERO     WN0166  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNLTX    D7NITX           TFD Area Code
     C                     MOVELWUNNTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTO    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTO    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0167 10        RS User Changed
     C                     Z-ADD*ZERO     WN0168  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0169  60       RS Time Changed
     C                     MOVEL*BLANK    WN0170  1        RS Record Statu
     C                     MOVEL*BLANK    WN0171 10        RS Job
     C                     MOVEL*BLANK    WN0172 10        RS Program
     C                     MOVEL*BLANK    WN0173 10        RS User Added
     C                     Z-ADD*ZERO     WN0174  70       RS Date Added
     C                     Z-ADD*ZERO     WN0175  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNMTX    D7NITX           TFD Area Code
     C                     MOVELWUNOTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTP    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTP    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0176 10        RS User Changed
     C                     Z-ADD*ZERO     WN0177  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0178  60       RS Time Changed
     C                     MOVEL*BLANK    WN0179  1        RS Record Statu
     C                     MOVEL*BLANK    WN0180 10        RS Job
     C                     MOVEL*BLANK    WN0181 10        RS Program
     C                     MOVEL*BLANK    WN0182 10        RS User Added
     C                     Z-ADD*ZERO     WN0183  70       RS Date Added
     C                     Z-ADD*ZERO     WN0184  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'P'       D7RLST           TFD Driver Type
     C                     MOVE *BLANK    D7NKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'D7NKTX           TFD Header Acti
     C                     MOVEL@CN,001   D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVEL*BLANK    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTQ    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0185 10        RS User Changed
     C                     Z-ADD*ZERO     WN0186  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0187  60       RS Time Changed
     C                     MOVEL*BLANK    WN0188  1        RS Record Statu
     C                     MOVEL*BLANK    WN0189 10        RS Job
     C                     MOVEL*BLANK    WN0190 10        RS Program
     C                     MOVEL*BLANK    WN0191 10        RS User Added
     C                     Z-ADD*ZERO     WN0192  70       RS Date Added
     C                     Z-ADD*ZERO     WN0193  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7LSTX    D7NITX           TFD Area Code
     C                     MOVELP7LRTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTR    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTR    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0194 10        RS User Changed
     C                     Z-ADD*ZERO     WN0195  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0196  60       RS Time Changed
     C                     MOVEL*BLANK    WN0197  1        RS Record Statu
     C                     MOVEL*BLANK    WN0198 10        RS Job
     C                     MOVEL*BLANK    WN0199 10        RS Program
     C                     MOVEL*BLANK    WN0200 10        RS User Added
     C                     Z-ADD*ZERO     WN0201  70       RS Date Added
     C                     Z-ADD*ZERO     WN0202  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELP7NGTX    D7NITX           TFD Area Code
     C                     MOVELP7NHTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTS    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTS    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0203 10        RS User Changed
     C                     Z-ADD*ZERO     WN0204  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0205  60       RS Time Changed
     C                     MOVEL*BLANK    WN0206  1        RS Record Statu
     C                     MOVEL*BLANK    WN0207 10        RS Job
     C                     MOVEL*BLANK    WN0208 10        RS Program
     C                     MOVEL*BLANK    WN0209 10        RS User Added
     C                     Z-ADD*ZERO     WN0210  70       RS Date Added
     C                     Z-ADD*ZERO     WN0211  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNLTX    D7NITX           TFD Area Code
     C                     MOVELWUNNTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTT    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTT    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0212 10        RS User Changed
     C                     Z-ADD*ZERO     WN0213  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0214  60       RS Time Changed
     C                     MOVEL*BLANK    WN0215  1        RS Record Statu
     C                     MOVEL*BLANK    WN0216 10        RS Job
     C                     MOVEL*BLANK    WN0217 10        RS Program
     C                     MOVEL*BLANK    WN0218 10        RS User Added
     C                     Z-ADD*ZERO     WN0219  70       RS Date Added
     C                     Z-ADD*ZERO     WN0220  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELP6QRST    D7RKST           TFD Producer Se
     C                     MOVEL'F'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVELWUNMTX    D7NITX           TFD Area Code
     C                     MOVELWUNOTX    D7NJTX           TFD Phone # or
     C                     Z-ADD$EBYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADD$ELPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADD$EHMNB    D7HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    D7BONB           BOL Load Number
     C                     Z-ADD$ECVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTU    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTU    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Crt ProdEm - TattDrv  RT - Producer Email Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           RBABCD           PD Producer Cod
      * Setup key
     C                     MOVELA1ABCD    RBABCD           PD Producer Cod
      * Establish starting position
     C           KRSTV     CHAIN@AZREN3              90    *
      * Data record not found
     C   90                MOVEL'PRK1179' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           RBAJST    IFEQ 'A'                        *IF
      * Rtv Email Status      RT - Producer Loc Email Hdr  * 
     C                     EXSR TWRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is Record Found
      *   |- c2    : WRK.PLEH Email to Producer is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ '999'                      *IF
     C           WUBNSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * * creation of the tattoo fax driver for the emails by producer
      * Crt PrdEmlDtlTatFax   RT - Producer Email Detail  * 
     C                     EXSR TXRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv Email Status      RT - Producer Loc Email Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           RDABCD           PD Producer Cod
     C                     KFLD           RDAECD           PL Location Cod
      * Setup key
     C                     MOVELA1ABCD    RDABCD           PD Producer Cod
     C                     MOVELA1AECD    RDAECD           PL Location Cod
      * Establish starting position
     C           KRSTW     CHAIN@A0REN6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1181' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBKSS           PLEH Email Stat
     C                     MOVEL*BLANK    WUBLSS           PLEH Email Carc
     C                     MOVEL*BLANK    WUBMSS           PLEH Email Carc
     C                     MOVEL*BLANK    WUBNSS           PLEH Email to P
     C                     MOVEL*BLANK    WUBOSS           PLEH Producer E
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELRDBKSS    WUBKSS           PLEH Email Stat
     C                     MOVELRDBLSS    WUBLSS           PLEH Email Carc
     C                     MOVELRDBMSS    WUBMSS           PLEH Email Carc
     C                     MOVELRDBNSS    WUBNSS           PLEH Email to P
     C                     MOVELRDBOSS    WUBOSS           PLEH Producer E
     C                     MOVELRDAJST    WUAJST           RS Record Statu
      * CASE: DB1.RS Record Status is Active
     C           RDAJST    IFEQ 'A'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Crt PrdEmlDtlTatFax   RT - Producer Email Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN RAABCD    WQTX01           PD Producer Cod
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           PD Producer Cod
      * Setup key
     C                     MOVELA1ABCD    WQTX01           PD Producer Cod
      * Establish starting position
     C           KRSTX     SETLL@A1REN9                    *
     C           KRSTX     READE@A1REN9                  90*
      * Data record not found
     C   90                MOVEL'PRK1183' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Test Record Status
      * CASE: DB1.RS Record Status is Active
     C           RAAJST    IFEQ 'A'                        *IF
     C                     MOVELWUCRTX    WUNKTX           TFD Header Acti
     C                     MOVELWUCRTX    WUNPTX           TFD Header Acti
      * CASE: PAR.PLEH Email Carcass Sum is Yes
     C           WUBLSS    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUNKTX           TFD Header Acti
     C                     MOVEL'Carc Sum'WUNKTX           TFD Header Acti
     C                     END                             *FI
      * CASE: PAR.PLEH Email Carcass Detail is Yes
     C           WUBMSS    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   WUNPTX           TFD Header Acti
     C                     END                             *FI
     C                     ADD  1         WUZWNB           TFD Sequence Nu
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     EXSR TYCRRC
     C                     END                             *FI
     C           KRSTX     READE@A1REN9                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCRRC    BEGSR
      *================================================================
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0221 10        RS User Changed
     C                     Z-ADD*ZERO     WN0222  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0223  60       RS Time Changed
     C                     MOVEL*BLANK    WN0224  1        RS Record Statu
     C                     MOVEL*BLANK    WN0225 10        RS Job
     C                     MOVEL*BLANK    WN0226 10        RS Program
     C                     MOVEL*BLANK    WN0227 10        RS User Added
     C                     Z-ADD*ZERO     WN0228  70       RS Date Added
     C                     Z-ADD*ZERO     WN0229  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D7CPZJ
     C                     Z-ADDWUZWNB    D7ZWNB           TFD Sequence Nu
     C                     MOVELWUBOSS    D7RKST           TFD Producer Se
     C                     MOVEL'E'       D7RLST           TFD Driver Type
     C                     MOVELWUNKTX    D7NKTX           TFD Header Acti
     C                     MOVELWUNPTX    D7NPTX           TFD Header Acti
     C                     MOVEL*BLANK    D7NITX           TFD Area Code
     C                     MOVELRAVMTX    D7NJTX           TFD Phone # or
     C                     Z-ADDA1BYDT    D7BYDT           TH Voucher Paym
     C                     Z-ADDA1LPNB    D7LPNB           TH AP Voucher/D
     C                     Z-ADDA1HMNB    D7HMNB           BOH Company Num
     C                     Z-ADDA1BNNB    D7BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    D7BONB           BOL Load Number
     C                     Z-ADDA1CVNB    D7CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    D7B0DT           TH Kill Date
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       D7AJST           RS Record Statu
     C                     MOVEL##USR     D7ABVN           RS User Added
     C                     Z-ADD##JDT     D7ABDT           RS Date Added
     C                     Z-ADD##JTM     D7ABTM           RS Time Added
     C                     MOVEL##PGM     D7AGVN           RS Program
     C                     MOVEL##JOB     D7AHVN           RS Job
     C           KLCRTY    KLIST
     C                     KFLD           D7ZWNB           TFD Sequence Nu
      * Check for duplicate primary key
     C           KLCRTY    SETLL@D7CPZJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0778' W0RTN   7
      * Send message 'Tattoo Fax Driver      EX'
     C                     MOVEL'PRK0778' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C                     WRITE@D7CPZJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * Crt PrdLodEm-TattDrvT RT - Producer Loc Email Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           RDABCD           PD Producer Cod
     C                     KFLD           RDAECD           PL Location Cod
      * Setup key
     C                     MOVELA1ABCD    RDABCD           PD Producer Cod
     C                     MOVELA1AECD    RDAECD           PL Location Cod
      * Establish starting position
     C           KRSTZ     CHAIN@A0REN6              90    *
      * Data record not found
     C   90                MOVEL'PRK1181' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           RDAJST    IFEQ 'A'                        *IF
      * CASE: DB1.PLEH Email Status is Yes
     C           RDBKSS    IFEQ 'Y'                        *IF
      * CrtPrdLocEmlDtlTatFax2 RT - Producer Loc Email Detail  * 
     C                     EXSR NARVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * SDN440 RMC 02/09/22 - pass m3 live to split routine in post secti
      * SDN440 RMC 08/17/21 - move company to kill date line.
      *   It was overlaying the date on the Post print.
      * S11786  RMC 10/02/17 get m3 supplier if pd address is 0, in:
      *   Rtv Prdcr Vendor#,Src RT
      * E9904  JBB 08/04/17 - TF2 Push Payments
      * - Added Company number to the report on the Top of Page section
      * R10690 JJH 06/12/17 - Producer Address
      * - Get Producer Fax Numbers from Producer Address
      * R10690 JJH 06/12/17 - Producer Location Address
      * - Get Producer Location Fax Numbers from Producer Location Addres
      * E3635 JJH 04/17/17 - Recompiled with no logic changes.
      * - This corrects problem with missing parameter in PRKTESTP.
      * - After promotion into PRKHPETST,lock transferred to ISRCENT/T816
      * E3814 JJH 10/07/15 - Recompile because PS Premises ID added to
      *   Producer Site. - No logic changes.
      * E004069 RMC 5/14/15 Get live with M3 company value - check in Fin
      *   Totals and call M3 Post pgm if Live / Parallel
      * E3635 JJH 12/04/14 - Recompile because PrklISTesting List for
      *  field *USER to add users Julius High (ISJHIGH) and Collin Lynch
      *  ISCLYNC.
      * H16853 ISE 01/23/21 - Increased the length from 5 to 7 and correc
      *                       the alignment of Buy Order Number field
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PO BO Header
      *================================================================
      * PO BO Header: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Ttt D/A,Accum Comm PO
      *================================================================
      * Prt Ttt D/A            PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt PrdEmailHdr       PO
      *================================================================
      * Prt PrdEmailHdr       PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt PrdEmlDtl         PO
      *================================================================
      * Prt PrdEmlDtl         PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt PrdLocEmlHdr      PO
      *================================================================
      * Prt PrdLocEmlHdr      PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt PrdLocEmlDtl      PO
      *================================================================
      * Prt PrdLocEmlDtl      PO: Mainline
     C                     EXSR G0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * EMAIL RECORDS TO THE TATTOO FAX DRIVER
      *================================================================
      * Build Email Records.  for Producer emails first
      * Crt ProdEm - TattDrv  RT - Producer Email Hdr  * 
     C                     EXSR STRVGN
      * Build Email Records.  for Producer location emails
      * Crt PrdLodEm-TattDrvT RT - Producer Loc Email Hdr  * 
     C                     EXSR SXRVGN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * VCH AP Address Number
      *================================================================
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
     C                     EXSR TCRVGN
      * CASE: PAR.Live with M3   USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUQHCD:ZQ WUSTTX    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     WULXNB           VCH AP Address
     C                     MOVE WUSTTX    WULXNB           VCH AP Address
     C                     END                             *FI
      * Rtv Alt Prd Py Nm&Vn# XF - Producer EXT  * 
     C                     CALL 'PLO7XFR'              90  Rtv Alt Prd Py
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $EABCD    WQ0048  6        PD Producer Cod
     C           YL0003    PARM YL0003    WQ0049  6        Alt Producer Pa
     C           WUSVA1    PARM WUSVA1    WQ0050  80       Alt Prod Payee
     C           WUR6CD    PARM WUR6CD    WQ0051 10        M3 Supplier ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Alt Prod Payee Vnd AddUsr is Not zero
     C           WUSVA1    IFNE 0                          *IF
      * CASE: PAR.Live with M3   USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUR6CD:ZQ WUSTTX    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     WUSVA1           Alt Prod Payee
     C                     MOVE WUSTTX    WUSVA1           Alt Prod Payee
     C                     Z-ADDWUSVA1    WULXNB           VCH AP Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUSVA1    WULXNB           VCH AP Address
     C                     END                             *FI
      * Setup message data for message
     C                     MOVEL$EABCD    ZA0001           PD Producer Cod
     C                     MOVELYL0003    ZA0002           Alt Producer Pa
     C                     Z-ADD$EHMNB    ZA0003           BOH Company Num
     C                     Z-ADD$EBNNB    ZA0004           BOH Buy Order N
     C                     Z-ADD$EBONB    ZA0005           BOL Load Number
     C                     Z-ADD$ECVNB    ZA0006           TH Tattoo Numbe
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $EB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
      * Send message 'Alt Prd Payee message'
     C                     MOVEL'PRK1237' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Modification History Created Str slm 061208
      *================================================================
      * 9/24/02 RMC Calc 2 dec backfat and loin eye
      * 050108 slm e00216 need additional fields on ho for meat
      * 061208 SLM E00144 LFT Head and Uat/Koa Head
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * EMAIL RECORDS TO THE TATTOO FAX DRIVER
      *================================================================
      * Build Email Records.  for Producer emails first
      * Crt ProdEm - TattDrv  RT - Producer Email Hdr  * 
     C                     EXSR TVRVGN
      * Build Email Records.  for Producer location emails
      * Crt PrdLodEm-TattDrvT RT - Producer Loc Email Hdr  * 
     C                     EXSR TZRVGN
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6GLNB           Pl VND Address
     C                     MOVEL*BLANK    P6AUST           PL Fax Status
     C                     MOVEL*BLANK    P6QNST           PL Fax   Carcas
     C                     MOVEL*BLANK    P6QOST           PL Unused
     C                     MOVEL*BLANK    P6QPST           PL Fax   Carcas
     C                     MOVEL*BLANK    P6QQST           PL Fax to Produ
     C                     MOVEL*BLANK    P6QRST           PL Producer Fax
     C                     MOVEL*BLANK    P7LSTX           Fax Area Code #
     C                     MOVEL*BLANK    P7LRTX           Fax Telephone
     C                     MOVEL*BLANK    P7NVTX           Fax Attn 1
     C                     MOVEL*BLANK    P7NGTX           Fax Area Code #
     C                     MOVEL*BLANK    P7NHTX           Fax Telephone 2
     C                     MOVEL*BLANK    P7NWTX           Fax Attn 2
     C                     Z-ADD*ZERO     P8GCNB           PD VND Address
     C                     MOVEL*BLANK    P8ADCD           Commission Prod
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field VCH Batch Number
     C                     Z-ADD*ZERO     WULWNB  50
      * Define work field Producer Code         USR
     C                     MOVEL*BLANK    WUARCD  6
      * Define work field @Status Crt Vch Rec usr
     C                     MOVEL*BLANK    WUKFST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1ABCD           PD Producer Cod
     C                     MOVEL*LOVAL    A1AECD           PL Location Cod
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
      * Define work field Fax Area Code Prdcr 1 USR
     C                     MOVEL*BLANK    WUNLTX  6
      * Define work field Fax Telephone Prdcr 1 USR
     C                     MOVEL*BLANK    WUNNTX 20
      * Define work field Fax Area Code Prdcr 2 USR
     C                     MOVEL*BLANK    WUNMTX  6
      * Define work field Fax Telephone Prdcr 2 USR
     C                     MOVEL*BLANK    WUNOTX 20
      * Define work field Address Number
     C                     Z-ADD*ZERO     WUIKNB  80
      * Define work field Pass Name
     C                     MOVEL*BLANK    WUDVTX 40
      * Define work field Address 1
     C                     MOVEL*BLANK    WUDNTX 40
      * Define work field Address 2
     C                     MOVEL*BLANK    WUDOTX 40
      * Define work field Address 3
     C                     MOVEL*BLANK    WUDPTX 40
      * Define work field City
     C                     MOVEL*BLANK    WUDQTX 40
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Define work field Zip
     C                     MOVEL*BLANK    WUDSTX 12
      * Define work field Area Code
     C                     MOVEL*BLANK    WUDTTX  6
      * Define work field Country Code
     C                     MOVEL*BLANK    WUE0CD  3
      * Define work field Telephone
     C                     MOVEL*BLANK    WUDUTX 20
      * Define work field Vendor 1099
     C                     MOVEL*BLANK    WUGNST  1
      * Define work field Vendor Tax Id.
     C                     MOVEL*BLANK    WUDXTX 16
      * Define work field Fax Attn 1
     C                     MOVEL*BLANK    WUNVTX 40
      * Define work field Fax Attn 2
     C                     MOVEL*BLANK    WUNWTX 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AWHMNB           BOH Company Num
     C                     MOVEL*LOVAL    AWBNNB           BOH Buy Order N
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    CDHMNB           BOH Company Num
     C                     MOVEL*LOVAL    CDBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    CDBONB           BOL Load Number
     C                     MOVEL*LOVAL    CDCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    CDB0DT           TH Kill Date
     C                     MOVEL*LOVAL    CDBQCD           DED D/A Code
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    RBABCD           PD Producer Cod
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    RAABCD           PD Producer Cod
     C                     MOVEL*LOVAL    RANHA1           PED Sequence
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    RDABCD           PD Producer Cod
     C                     MOVEL*LOVAL    RDAECD           PL Location Cod
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    RCABCD           PD Producer Cod
     C                     MOVEL*LOVAL    RCAECD           PL Location Cod
     C                     MOVEL*LOVAL    RCNIA1           PLED Sequence
      * Define work field Deds/Add Totals Usr
     C                     Z-ADD*ZERO     WUBEVA  92
      * Define work field Txt Field Not Needed
     C                     MOVEL*BLANK    WUOCTX 25
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADMDT           PAD Transaction
     C                     Z-ADD*ZERO     WAPADS           PAD Transaction
     C                     Z-ADD*ZERO     WAEKVA           PAD Transaction
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field TFD Sequence Number
     C                     Z-ADD*ZERO     WUZWNB  50
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Clear all neither parameters
      * Crt Tattoo Fax Driver CR - Tattoo Fax Driver  * 
     C                     Z-ADD*ZERO     D7AADT           RS Date Changed
     C                     Z-ADD*ZERO     D7AMTM           RS Time Changed
     C                     Z-ADD*ZERO     D7ABDT           RS Date Added
     C                     Z-ADD*ZERO     D7ABTM           RS Time Added
      * Define work field TFD Header Action-Crc Sum
     C                     MOVEL*BLANK    WUNKTX 10
      * Define work field TFD Header Action-Crc Dtl
     C                     MOVEL*BLANK    WUNPTX 10
      * Define work field PLEH Email Status
     C                     MOVEL*BLANK    WUBKSS  1
      * Define work field PLEH Email Carcass Sum
     C                     MOVEL*BLANK    WUBLSS  1
      * Define work field PLEH Email Carcass Detail
     C                     MOVEL*BLANK    WUBMSS  1
      * Define work field PLEH Email to Producer
     C                     MOVEL*BLANK    WUBNSS  1
      * Define work field PLEH Producer Email Seq
     C                     MOVEL*BLANK    WUBOSS  1
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field VCH Header Number
     C                     Z-ADD*ZERO     WUG9NB  50
      * Define work field TH Kill Date
     C                     Z-ADD*ZERO     WUB0DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHNNB           VCH Company num
     C                     Z-ADD*ZERO     WBLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WBG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WBLXNB           VCH AP Address
     C                     Z-ADD*ZERO     WBLYNB           VCH AP Voucher
     C                     Z-ADD*ZERO     WBDKNB           VCH Manual Chec
     C                     Z-ADD*ZERO     WBA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     WBCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WBCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WBCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WBCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WBCMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     WBAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WBAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WBCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WBAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WBBUPC           VCH Split %
     C                     Z-ADD*ZERO     WBA4DT           VCH G/L Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field VCH Split %
     C                     Z-ADD*ZERO     WUBUPC  30
      * Define work field VCH AP Address Number
     C                     Z-ADD*ZERO     WULXNB  80
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Define work field M3 Supplier ID
     C                     MOVEL*BLANK    WUQHCD 10
      * Define work field Text 7 USR
     C                     MOVEL*BLANK    WUSTTX  7
      * Define work field Alt Prod Payee Vnd AddUsr
     C                     Z-ADD*ZERO     WUSVA1  80
      * Define work field M3 Supplier ID  Alt Payee
     C                     MOVEL*BLANK    WUR6CD 10
      * Define work field VCH Payee Type
     C                     MOVEL*BLANK    WUCSST  1
      * Define work field VCH Gross Amt
     C                     Z-ADD*ZERO     WUAUVA  92
      * Define work field VCH Net Amt
     C                     Z-ADD*ZERO     WUAJVA  92
      * Define work field VCH Less Split Amount
     C                     Z-ADD*ZERO     WUCHPR  92
      * Define work field VCH Deduction Amt
     C                     Z-ADD*ZERO     WUAVVA  92
      * Define work field VCH Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUCIPR  92
      * Define work field VCH Sort Disc Amt
     C                     Z-ADD*ZERO     WUCJPR  92
      * Define work field VCH Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUCKPR  92
      * Define work field VCH Base Carcass Value
     C                     Z-ADD*ZERO     WUCLPR  92
      * Define work field VCH LN Add on/Deduct Amt
     C                     Z-ADD*ZERO     WUCMPR  92
      * Define work field VCD Line
     C                     Z-ADD*ZERO     WUDLNB  30
      * Define work field Date USR
     C                     Z-ADD*ZERO     WUB5DT  70
      * Define work field TH Dead On Arrival
     C                     Z-ADD*ZERO     WUCXNB  50
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Head Adds
     C                     Z-ADD*ZERO     WUHENB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUHDNB  51
      * Define work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     WUF4NB  31
      * Define work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     WUF3NB  31
      * Define work field TH Avg Backfat
     C                     Z-ADD*ZERO     WUF2NB  31
      * Define work field TH Actual Yield %
     C                     Z-ADD*ZERO     WUAWPC  52
      * Define work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     WUCWPC  52
      * Define work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUANPR  72
      * Define work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     WUAYVA  72
      * Define work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUAWVA  72
      * Define work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     WUAOPR  72
      * Define work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     WUAXVA  72
      * Define work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     WUAPPR  72
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field TH Payment Gross
     C                     Z-ADD*ZERO     WUCBPR  72
      * Define work field Th Payment Net Amt
     C                     Z-ADD*ZERO     WUCCPR  72
      * Define work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     WUA2PR  72
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Define work field TH FFLI
     C                     Z-ADD*ZERO     WUHINB  31
      * Define work field TH Head Excluded
     C                     Z-ADD*ZERO     WUJ9NB  50
      * Define work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     WUD6PR  52
      * Define work field TH CM Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     WUD7PR  52
      * Define work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     WUD8PR  52
      * Define work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     WUD9PR  52
      * Define work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     WUEAPR  52
      * Define work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     WUEBPR  52
      * Define work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     WUECPR  52
      * Define work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     WUEDPR  52
      * Define work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     WUEEPR  52
      * Define work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     WUEFPR  52
      * Define work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     WUEGPR  52
      * Define work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     WUEHPR  52
      * Define work field TH Head Adjusted-LN%
     C                     Z-ADD*ZERO     WUIORP  50
      * Define work field TH PHA Head Adds
     C                     Z-ADD*ZERO     WUOWEO  50
      * Define work field TH Excluded Gross Value
     C                     Z-ADD*ZERO     WUTBPR  72
      * Define work field TH Excluded Carc Val
     C                     Z-ADD*ZERO     WUKROT  72
      * Define work field TH Excluded Premium
     C                     Z-ADD*ZERO     WUOTJG  72
      * Define work field TH Meat Value Factor Amt
     C                     Z-ADD*ZERO     WUKFOR 112
      * Define work field TH Avg Loin Eye - 2 dec
     C                     Z-ADD*ZERO     WUMVNF  52
      * Define work field TH Avg Backfat - 2 Dec
     C                     Z-ADD*ZERO     WUMCNF  52
      * Define work field TH Head LFT
     C                     Z-ADD*ZERO     WUECDT  70
      * Define work field TH Head EUT/KOA
     C                     Z-ADD*ZERO     WUEDDT  70
      * Define work field Print Carcass Analysis Us
     C                     MOVEL*BLANK    WUMVST  1
      * Define work field CMP Grading Type
     C                     MOVEL*BLANK    WUDLST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field TH CA Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUI6PR  72
      * Define work field TH CA Sort Discount Amt
     C                     Z-ADD*ZERO     WUI7PR  72
      * Define work field TH CA Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUI8PR  72
      * Define work field TH CA Base Carcass Value
     C                     Z-ADD*ZERO     WUI9PR  72
      * Define work field TH CA Lean Premium Amt
     C                     Z-ADD*ZERO     WUJAPR  72
      * Define work field TH CA Carcass Gross Amt
     C                     Z-ADD*ZERO     WUJCPR  72
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUJ0ST  1
      * Define work field Net Ded/Add amount    USR
     C                     Z-ADD*ZERO     WUA9VA  92
      * Define work field VCD Net Amt
     C                     Z-ADD*ZERO     WUAMVA  92
      * Define work field Percent Decimal       USR
     C                     Z-ADD*ZERO     WUL9NB  74
      * Define work field VCD Less Split Amount
     C                     Z-ADD*ZERO     WUCVPR  72
      * Define work field BOH Payment Type
     C                     MOVEL*BLANK    WUA4ST  1
      * Define work field BOH Buy Order Type
     C                     MOVEL*BLANK    WUA5ST  1
      * Define work field HC Description
     C                     MOVEL*BLANK    WUBDTX 25
      * Define work field Tattoo Nbr 4          USR
     C                     Z-ADD*ZERO     WUMLNB  40
      * Define work field Tattoo Nbr Alpha 4    USR
     C                     MOVEL*BLANK    WUDUCD  4
      * Define work field VCD Check Description
     C                     MOVEL*BLANK    WUF5TX 20
      * Define work field VCD Hog Class Type
     C                     MOVEL*BLANK    WUJIST  1
      * Define work field SR Source Contract Type
     C                     MOVEL*BLANK    WUCYSS  1
      * Define work field VCD Push Payment Status
     C                     MOVEL*BLANK    WUJQST  1
      * Define work field VCD Repayment Flag
     C                     MOVEL*BLANK    WUC4SS  1
      * Define work field @Status Kill Dt Break
     C                     MOVEL*BLANK    WUKTST  1
      * Define work field VCD Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUCNPR  72
      * Define work field VCD Sort Disc Amt
     C                     Z-ADD*ZERO     WUCOPR  72
      * Define work field VCD Yield Gain/Loss
     C                     Z-ADD*ZERO     WUCPPR  72
      * Define work field VCD Base Carcass Value
     C                     Z-ADD*ZERO     WUCQPR  72
      * Define work field VCD LN Add on/Deduct Amt
     C                     Z-ADD*ZERO     WUCRPR  72
      * Define work field VCD Gross Amt
     C                     Z-ADD*ZERO     WUAKVA  92
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAYDT           PSS Split Last
     C                     Z-ADD*ZERO     WFABPC           PSS Split Perce
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Net Amount           USR
     C                     Z-ADD*ZERO     WUA8VA  92
      * Define work field SR Type
     C                     MOVEL*BLANK    WUIXST  1
      * Define work field Header Number   USR
     C                     Z-ADD*ZERO     WUL4NB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHNNB           VCH Company num
     C                     Z-ADD*ZERO     WGLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WGG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WGDLNB           VCD Line
     C                     Z-ADD*ZERO     WGCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WGCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WGCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WGCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WGCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WGAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WGALVA           VCD Deduction A
     C                     Z-ADD*ZERO     WGCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WGAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WGAEPC           VCD Split Perce
     C                     Z-ADD*ZERO     WGL5A1           VCD Received He
     C                     Z-ADD*ZERO     WGL6A1           VCD Head Killed
     C                     Z-ADD*ZERO     WGOKA1           VCD Unused Head
     C                     Z-ADD*ZERO     WGOLA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WGOMA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WGWSA1           MGL Voucher Num
     C                     Z-ADD*ZERO     WGWOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     WGHFDT           MGL Process to
     C                     Z-ADD*ZERO     WGB2TM           MGL Process to
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Status 1
     C                     MOVEL*BLANK    WUP4ST  1
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Live with M3   USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Live with M3 - interco
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Alt Producer Payee
     C                     MOVEL*BLANK    YL0003  6
      * Define null work field PD VND Address Number
     C                     Z-ADD*ZERO     YN0001  80
      * Define null work field SR Source Code
     C                     MOVEL*BLANK    YN0002  3
      * Define local work field Buy Order Number Alpha
     C                     MOVEL*BLANK    YL0004  7
      * Define local work field Buy Order Load 4 USR
     C                     Z-ADD*ZERO     YL0005  40
      * Define local work field Buy Order Load Alpha 4
     C                     MOVEL*BLANK    YL0006  4
      * Define local work field Tattoo Nbr 4          USR
     C                     Z-ADD*ZERO     YL0007  40
      * Define local work field Tattoo Nbr Alpha 4    USR
     C                     MOVEL*BLANK    YL0008  4
      * Define local work field Buy Order Load Alpha
     C                     MOVEL*BLANK    YL0009  5
      * Define local work field Text 8 USR
     C                     MOVEL*BLANK    YL0010  8
      * Define local work field Text 13 USR
     C                     MOVEL*BLANK    YL0011 13
      * Define local work field Text 17 USR
     C                     MOVEL*BLANK    YL0012 17
      * Define local work field MGL Supplier Invoice Nbr
     C                     MOVEL*BLANK    YL0013 24
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP3EVTX    $ACMP
     C                     MOVEL'N'       YL0001           Live with M3
     C                     MOVEL'X'       YL0002           Live with M3 -
      * ONLY on Posting Init routine for vouchers
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * Crt Live Vchr Init    IF
     C                     MOVEL*BLANK    WUARCD           Producer Code
      * Rtv Nxt Vch Batch #   RT - Hog Voucher Header  * 
     C                     EXSR SARVGN
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       BOH Company Num
     C                     PARM 'M3HPEVCH'WQ0002 10        Company Value C
     C           YL0001    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.BOH Company Number is SBD Farms of Guymon, Ok
     C           P1HMNB    IFEQ 360                        *IF
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 350       WQ0004  30       BOH Company Num
     C                     PARM 'M3HPEVCH'WQ0005 10        Company Value C
     C           YL0002    PARM *BLANK    WQ0006 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WUKFST           @Status Crt Vch
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Prt CrcDtl
00002 PRKTEST
00003 ISPPATE
00004 ISSMASO
00005 ISRCENT
00006 ISPURVAP
00007 ISROSEM
00008 ISSHARONZ
00009 ISSZURN
00010 ISJHIGH
00011 ISJBADE
00012 ISJAMESB
00013 ISDNGUY
00014 ISDANNYN
00015 PRKTESTGU
00016 PRKTESTST
00017 PRKTESTTF
00018 TPMTEST
00019 TFTST961
00020 ISSUSANM
00021 ISJULIUSH
00022 ISBGUTI
00023 ISBARBG
00024 ISBBARK
00025 ISNFOY
00026 ISNATHANF
00027 ISDREDD
