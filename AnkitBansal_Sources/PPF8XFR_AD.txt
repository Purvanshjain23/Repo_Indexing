// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPF8XFR
// ?Date: 14.08.2025 Time: 03:40:21
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Upd Fix TF/CM/SB Amt  RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1703995;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv TF/CM/SB Amount   RT) TYPE(RTVOBJ) FILE(PDICCPP)           AC1767407;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(PAR.Ledgrd_Trd_Fund_Accrl_Amt);
 PARAMETER(PAR.Commission_Amount);
 PARAMETER(PAR.NonLedgrd_TrdFnd_Acrl_Amt);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?new code
  CASE;

  // IF DB1.HDA Affect Sales Realz is No
  IF DB1.HDA_Affect_Sales_Realz = 'N';

  // AND DB1.HDA Ledger Accrual Y/N is yes
  AND DB1.HDA_Post_to_G_L_Y_N = 'Y';

  // PAR.Commission Amount = PAR.Commission Amount + DB1.Extended Amount
  PAR.Commission_Amount = PAR.Commission_Amount + DB1.Extended_Amount;

  //?new code
  // IF DB1.HDA Ledger Accrual Y/N is yes
  IF DB1.HDA_Post_to_G_L_Y_N = 'Y';

  // AND DB1.HDA Affect Sales Realz is Yes
  AND DB1.HDA_Affect_Sales_Realz = 'Y';

  // PAR.Ledgrd Trd Fund Accrl Amt = PAR.Ledgrd Trd Fund Accrl Amt + DB1.Extended Amount
  PAR.Ledgrd_Trd_Fund_Accrl_Amt = PAR.Ledgrd_Trd_Fund_Accrl_Amt + DB1.Extended_Amount;

  //?new code
  // IF *OTHERWISE
  IF *OTHERWISE;

  ENDIF;

  //?new code
  CASE;

  // IF DB1.HDA Ledger Accrual Y/N is no
  IF DB1.HDA_Post_to_G_L_Y_N = 'N';

  // AND DB1.HDA Affect Sales Realz is Yes
  AND DB1.HDA_Affect_Sales_Realz = 'Y';

  // PAR.NonLedgrd TrdFnd Acrl Amt = PAR.NonLedgrd TrdFnd Acrl Amt + DB1.Extended Amount
  PAR.NonLedgrd_TrdFnd_Acrl_Amt = PAR.NonLedgrd_TrdFnd_Acrl_Amt + DB1.Extended_Amount;

  ENDIF;

 }

 CASE;

 // IF DB1.Ledgrd Trd Fund Accrl Amt NE PAR.Ledgrd Trd Fund Accrl Amt
 IF DB1.Ledgrd_Trd_Fund_Accrl_Amt <> PAR.Ledgrd_Trd_Fund_Accrl_Amt;

 // OR DB1.Commission Amount NE PAR.Commission Amount
 OR DB1.Commission_Amount <> PAR.Commission_Amount;

 // OR DB1.NonLedgrd TrdFnd Acrl Amt NE PAR.NonLedgrd TrdFnd Acrl Amt
 OR DB1.NonLedgrd_TrdFnd_Acrl_Amt <> PAR.NonLedgrd_TrdFnd_Acrl_Amt;

 //?RMC Adjust fob gross by change in Ledgered TF amt  4/10/08
 // LCL.FOB Gross Amount = DB1.FOB Gross Amount - DB1.Ledgrd Trd Fund Accrl Amt
 LCL.FOB_Gross_Amount = DB1.FOB_Gross_Amount - DB1.Ledgrd_Trd_Fund_Accrl_Amt;

 // LCL.FOB Gross Amount = LCL.FOB Gross Amount + PAR.Ledgrd Trd Fund Accrl Amt
 LCL.FOB_Gross_Amount = LCL.FOB_Gross_Amount + PAR.Ledgrd_Trd_Fund_Accrl_Amt;

 EXECUTE FUNCTION(Chg TF/CM/SB Amount   CH) TYPE(CHGOBJ) FILE(OMHSTPP)           AC1767409;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(LCL.FOB_Gross_Amount);
 PARAMETER(PAR.Ledgrd_Trd_Fund_Accrl_Amt);
 PARAMETER(PAR.Commission_Amount);
 PARAMETER(PAR.NonLedgrd_TrdFnd_Acrl_Amt);
 {
  //?USER: Processing after Data read

  // DB1.Process Sts for 3C = CND.No
  DB1.Process_Sts_for_3C = 'N';

  // DB1.Data Mart Process Sts = CND.no
  DB1.Data_Mart_Process_Sts = 'N';

  EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 ENDIF;

}


