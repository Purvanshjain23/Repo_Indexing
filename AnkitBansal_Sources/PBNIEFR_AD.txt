// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBNIEFR
// ?Date: 14.08.2025 Time: 03:48:37
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?***** Change Log and Comments
DO;

//?** 07/08/2014 JJH E3160
//?The purpose of this function is to maintain the Company Items
//?that will utilize the "Update Standard Production" field on the
//?"Edit Company Item BOM". It is intended to only include Company
//?Items that will have a value of "N" for the "Upd Std Prd" field.
//?Company Items that are entered in this function that are listed
//?as P=Produced Items on the Company Item BOM will not update the
//?Production Schedule, when the Production Schedule quantites are
//?changed.
//?Intially, Company Items that are designated as "By-Products" are
//?being added in this file so that there quantities will not change
//?on the Production Schedules, as there values are being maintained
//?manually.
ENDDO;

//?USER: Validate subfile record relations

CASE;

// IF RCD.Company Number is greater than zero
IF RCD.Company_Number > *ZERO;

// AND RCD.Item Code is Entered
AND RCD.Item_Code <> *ZERO;

// RCD.Company Item Upd Std Prd = CND.no
RCD.Company_Item_Upd_Std_Prd = 'N';

ENDIF;

//?USER: Create DBF record

EXECUTE FUNCTION(Crt Co Itm Std Prd Dft CR) TYPE(CRTOBJ) FILE(PBBLREP)          AC2091988;
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(UPS CRTOBJ Stamp      IF) TYPE(EXCINTFUN)                      AC1359517;
 PARAMETER(DB1.Record_Status);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Record Status = CND.Active
  PAR.Record_Status = 'A';

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


//?USER: Delete DBF record

EXECUTE FUNCTION(Del Co Itm Std Prd Dft DL) TYPE(DLTOBJ) FILE(PBBLREP)          AC2091990;

//?USER: Change DBF record

EXECUTE FUNCTION(Chg Co Itm Std Prd Dft CH) TYPE(CHGOBJ) FILE(PBBLREP)          AC2091989;
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(UPS CHGOBJ Stamp      IF) TYPE(EXCINTFUN)                      AC1359518;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


