     H/TITLE RTV/Chg TTD,Pen,Hdr   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:28:52
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKDRCPL1IF  E           K        DISK
      * RTV : Tattoo Detail Wrk         Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKA3REL5IF  E           K        DISK
      * RSQ : Pen                       Co/Pen/Open
      *
     FPKA2CPL5IF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Pn/Open
      *
     FPKA2CPL8IF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Pen
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKA2CPL0UF  E           K        DISK
      * UPD : Tattoo Detail             Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKCDCPL0UF  E           K        DISK
      * UPD : Tattoo Ded/Add            Update index
      *
     FPKA3REL0UF  E           K        DISK
      * UPD : Pen                       Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@DRCPVZ
      * Tattoo Detail Wrk         Retrieval index
      * Renamed input format fields
     I              DRHMNB                          WAHMNB
     I              DRBNNB                          WABNNB
     I              DRBONB                          WABONB
     I              DRCVNB                          WACVNB
     I              DRB0DT                          WAB0DT
     I              DRAVNB                          WAAVNB
     I              DRARTM                          WAARTM
     I              DRC2DT                          WAC2DT
     I              DRDZNB                          WADZNB
     I              DRD0NB                          WAD0NB
     I              DRD9NB                          WAD9NB
     I              DRHDHO                          WAHDHO
     I              DROEST                          WAOEST
     I              DRD8CD                          WAD8CD
     I              DRAVLV                          WAAVLV
     I              DROFST                          WAOFST
     I              DROGST                          WAOGST
     I              DROHST                          WAOHST
     I              DRC3DT                          WAC3DT
     I              DRC4DT                          WAC4DT
     I              DRJFA1                          WAJFA1
     I              DRORCO                          WAORCO
     I              DRF4CD                          WAF4CD
     I              DRF6CD                          WAF6CD
     I              DRCQNB                          WACQNB
     I              DRF5CD                          WAF5CD
     I              DRBQNB                          WABQNB
     I              DRBTNB                          WABTNB
     I              DRWYDD                          WAWYDD
     I              DRB1NB                          WAB1NB
     I              DROIST                          WAOIST
     I              DRWAGL                          WAWAGL
     I              DRCONM                          WACONM
     I              DRF7CD                          WAF7CD
     I              DRCANB                          WACANB
     I              DRCENB                          WACENB
     I              DRCINB                          WACINB
     I              DRF2CD                          WAF2CD
     I              DRCFNB                          WACFNB
     I              DRF3CD                          WAF3CD
     I              DRC5DT                          WAC5DT
     I              DRC1NB                          WAC1NB
     I              DRC3NB                          WAC3NB
     I              DRC7NB                          WAC7NB
     I              DRC8NB                          WAC8NB
     I              DRF8CD                          WAF8CD
     I              DRF1CD                          WAF1CD
     I              DROJST                          WAOJST
     I              DROKST                          WAOKST
     I              DRC9NB                          WAC9NB
     I              DRDANB                          WADANB
     I              DRAAVN                          WAAAVN
     I              DRAADT                          WAAADT
     I              DRAMTM                          WAAMTM
     I              DRAJST                          WAAJST
     I              DRAHVN                          WAAHVN
     I              DRAGVN                          WAAGVN
     I              DRABVN                          WAABVN
     I              DRABDT                          WAABDT
     I              DRABTM                          WAABTM
      *
     I@A2CPDF
      * Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WBHMNB
     I              A2BNNB                          WBBNNB
     I              A2BONB                          WBBONB
     I              A2CVNB                          WBCVNB
     I              A2B0DT                          WBB0DT
     I              A2C2NB                          WBC2NB
     I              A2CZNB                          WBCZNB
     I              A2C0NB                          WBC0NB
     I              A2D8NB                          WBD8NB
     I              A2H7NB                          WBH7NB
     I              A2GGST                          WBGGST
     I              A2AJTM                          WBAJTM
     I              A2JEA1                          WBJEA1
     I              A2B7CD                          WBB7CD
     I              A2D7NB                          WBD7NB
     I              A2D9ST                          WBD9ST
     I              A2E3ST                          WBE3ST
     I              A2E4ST                          WBE4ST
     I              A2E5ST                          WBE5ST
     I              A2BVDT                          WBBVDT
     I              A2BWDT                          WBBWDT
     I              A2BXDT                          WBBXDT
     I              A2HVNB                          WBHVNB
     I              A2CMCD                          WBCMCD
     I              A2B9CD                          WBB9CD
     I              A2H8NB                          WBH8NB
     I              A2CYCD                          WBCYCD
     I              A2AAVN                          WBAAVN
     I              A2AADT                          WBAADT
     I              A2AMTM                          WBAMTM
     I              A2AJST                          WBAJST
     I              A2AHVN                          WBAHVN
     I              A2AGVN                          WBAGVN
     I              A2ABVN                          WBABVN
     I              A2ABDT                          WBABDT
     I              A2ABTM                          WBABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@CDCPIU
      * Tattoo Ded/Add            Retrieval index
      * Renamed input format fields
     I              CDHMNB                          WEHMNB
     I              CDBNNB                          WEBNNB
     I              CDBONB                          WEBONB
     I              CDCVNB                          WECVNB
     I              CDB0DT                          WEB0DT
     I              CDBQCD                          WEBQCD
     I              CDAZVA                          WEAZVA
     I              CDA0VA                          WEA0VA
     I              CDJBST                          WEJBST
     I              CDEIST                          WEEIST
     I              CDJDST                          WEJDST
     I              CDDPCD                          WEDPCD
     I              CDE3CD                          WEE3CD
     I              CDAQNB                          WEAQNB
     I              CDOCST                          WEOCST
     I              CDPEST                          WEPEST
     I              CDPFST                          WEPFST
     I              CDPGST                          WEPGST
     I              CDPIST                          WEPIST
     I              CDPJST                          WEPJST
     I              CDPKST                          WEPKST
     I              CDPLST                          WEPLST
     I              CDAAVN                          WEAAVN
     I              CDAADT                          WEAADT
     I              CDAMTM                          WEAMTM
     I              CDAJST                          WEAJST
     I              CDAHVN                          WEAHVN
     I              CDAGVN                          WEAGVN
     I              CDABVN                          WEABVN
     I              CDABDT                          WEABDT
     I              CDABTM                          WEABTM
      *
     I@CDCPIT
      * Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WFHMNB
     I              CDBNNB                          WFBNNB
     I              CDBONB                          WFBONB
     I              CDCVNB                          WFCVNB
     I              CDB0DT                          WFB0DT
     I              CDBQCD                          WFBQCD
     I              CDAZVA                          WFAZVA
     I              CDA0VA                          WFA0VA
     I              CDJBST                          WFJBST
     I              CDEIST                          WFEIST
     I              CDJDST                          WFJDST
     I              CDDPCD                          WFDPCD
     I              CDE3CD                          WFE3CD
     I              CDAQNB                          WFAQNB
     I              CDOCST                          WFOCST
     I              CDPEST                          WFPEST
     I              CDPFST                          WFPFST
     I              CDPGST                          WFPGST
     I              CDPIST                          WFPIST
     I              CDPJST                          WFPJST
     I              CDPKST                          WFPKST
     I              CDPLST                          WFPLST
     I              CDAAVN                          WFAAVN
     I              CDAADT                          WFAADT
     I              CDAMTM                          WFAMTM
     I              CDAJST                          WFAJST
     I              CDAHVN                          WFAHVN
     I              CDAGVN                          WFAGVN
     I              CDABVN                          WFABVN
     I              CDABDT                          WFABDT
     I              CDABTM                          WFABTM
      *
     I@A2CPDG
      * Tattoo Detail             Retrieval index
      * Renamed input format fields
     I              A2HMNB                          WGHMNB
     I              A2BNNB                          WGBNNB
     I              A2BONB                          WGBONB
     I              A2CVNB                          WGCVNB
     I              A2B0DT                          WGB0DT
     I              A2C2NB                          WGC2NB
     I              A2CZNB                          WGCZNB
     I              A2C0NB                          WGC0NB
     I              A2D8NB                          WGD8NB
     I              A2H7NB                          WGH7NB
     I              A2GGST                          WGGGST
     I              A2AJTM                          WGAJTM
     I              A2JEA1                          WGJEA1
     I              A2B7CD                          WGB7CD
     I              A2D7NB                          WGD7NB
     I              A2D9ST                          WGD9ST
     I              A2E3ST                          WGE3ST
     I              A2E4ST                          WGE4ST
     I              A2E5ST                          WGE5ST
     I              A2BVDT                          WGBVDT
     I              A2BWDT                          WGBWDT
     I              A2BXDT                          WGBXDT
     I              A2HVNB                          WGHVNB
     I              A2CMCD                          WGCMCD
     I              A2B9CD                          WGB9CD
     I              A2H8NB                          WGH8NB
     I              A2CYCD                          WGCYCD
     I              A2AAVN                          WGAAVN
     I              A2AADT                          WGAADT
     I              A2AMTM                          WGAMTM
     I              A2AJST                          WGAJST
     I              A2AHVN                          WGAHVN
     I              A2AGVN                          WGAGVN
     I              A2ABVN                          WGABVN
     I              A2ABDT                          WGABDT
     I              A2ABTM                          WGABTM
      *
     I@A3REKF
      * Pen                       Co/Pen/Open
      * Renamed input format fields
     I              A3HVNB                          WHHVNB
     I              A3CMCD                          WHCMCD
     I              A3BBTX                          WHBBTX
     I              A3CTNB                          WHCTNB
     I              A3D6NB                          WHD6NB
     I              A3B6CD                          WHB6CD
     I              A3DGST                          WHDGST
     I              A3EBNB                          WHEBNB
     I              A3FWST                          WHFWST
     I              A3HBNB                          WHHBNB
     I              A3AGCD                          WHAGCD
     I              A3AAVN                          WHAAVN
     I              A3AADT                          WHAADT
     I              A3AMTM                          WHAMTM
     I              A3AJST                          WHAJST
     I              A3AHVN                          WHAHVN
     I              A3AGVN                          WHAGVN
     I              A3ABVN                          WHABVN
     I              A3ABDT                          WHABDT
     I              A3ABTM                          WHABTM
      *
     I@A2CPI7
      * Tattoo Detail             Co/Pn/Open
      * Renamed input format fields
     I              A2HMNB                          WIHMNB
     I              A2BNNB                          WIBNNB
     I              A2BONB                          WIBONB
     I              A2CVNB                          WICVNB
     I              A2B0DT                          WIB0DT
     I              A2C2NB                          WIC2NB
     I              A2CZNB                          WICZNB
     I              A2C0NB                          WIC0NB
     I              A2D8NB                          WID8NB
     I              A2H7NB                          WIH7NB
     I              A2GGST                          WIGGST
     I              A2AJTM                          WIAJTM
     I              A2JEA1                          WIJEA1
     I              A2B7CD                          WIB7CD
     I              A2D7NB                          WID7NB
     I              A2D9ST                          WID9ST
     I              A2E3ST                          WIE3ST
     I              A2E4ST                          WIE4ST
     I              A2E5ST                          WIE5ST
     I              A2BVDT                          WIBVDT
     I              A2BWDT                          WIBWDT
     I              A2BXDT                          WIBXDT
     I              A2HVNB                          WIHVNB
     I              A2CMCD                          WICMCD
     I              A2B9CD                          WIB9CD
     I              A2H8NB                          WIH8NB
     I              A2CYCD                          WICYCD
     I              A2AAVN                          WIAAVN
     I              A2AADT                          WIAADT
     I              A2AMTM                          WIAMTM
     I              A2AJST                          WIAJST
     I              A2AHVN                          WIAHVN
     I              A2AGVN                          WIAGVN
     I              A2ABVN                          WIABVN
     I              A2ABDT                          WIABDT
     I              A2ABTM                          WIABTM
      *
     I@A3REDC
      * Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WJHVNB
     I              A3CMCD                          WJCMCD
     I              A3BBTX                          WJBBTX
     I              A3CTNB                          WJCTNB
     I              A3D6NB                          WJD6NB
     I              A3B6CD                          WJB6CD
     I              A3DGST                          WJDGST
     I              A3EBNB                          WJEBNB
     I              A3FWST                          WJFWST
     I              A3HBNB                          WJHBNB
     I              A3AGCD                          WJAGCD
     I              A3AAVN                          WJAAVN
     I              A3AADT                          WJAADT
     I              A3AMTM                          WJAMTM
     I              A3AJST                          WJAJST
     I              A3AHVN                          WJAHVN
     I              A3AGVN                          WJAGVN
     I              A3ABVN                          WJABVN
     I              A3ABDT                          WJABDT
     I              A3ABTM                          WJABTM
      *
     I@A2CPKE
      * Tattoo Detail             Co/Pen
      * Renamed input format fields
     I              A2HMNB                          WKHMNB
     I              A2BNNB                          WKBNNB
     I              A2BONB                          WKBONB
     I              A2CVNB                          WKCVNB
     I              A2B0DT                          WKB0DT
     I              A2C2NB                          WKC2NB
     I              A2CZNB                          WKCZNB
     I              A2C0NB                          WKC0NB
     I              A2D8NB                          WKD8NB
     I              A2H7NB                          WKH7NB
     I              A2GGST                          WKGGST
     I              A2AJTM                          WKAJTM
     I              A2JEA1                          WKJEA1
     I              A2B7CD                          WKB7CD
     I              A2D7NB                          WKD7NB
     I              A2D9ST                          WKD9ST
     I              A2E3ST                          WKE3ST
     I              A2E4ST                          WKE4ST
     I              A2E5ST                          WKE5ST
     I              A2BVDT                          WKBVDT
     I              A2BWDT                          WKBWDT
     I              A2BXDT                          WKBXDT
     I              A2HVNB                          WKHVNB
     I              A2CMCD                          WKCMCD
     I              A2B9CD                          WKB9CD
     I              A2H8NB                          WKH8NB
     I              A2CYCD                          WKCYCD
     I              A2AAVN                          WKAAVN
     I              A2AADT                          WKAADT
     I              A2AMTM                          WKAMTM
     I              A2AJST                          WKAJST
     I              A2AHVN                          WKAHVN
     I              A2AGVN                          WKAGVN
     I              A2ABVN                          WKABVN
     I              A2ABDT                          WKABDT
     I              A2ABTM                          WKABTM
      *
     I@AIREA9
      * Genetic                   Retrieval index
      * Renamed input format fields
     I              AIAGCD                          WLAGCD
     I              AIAWTX                          WLAWTX
     I              AIAAVN                          WLAAVN
     I              AIAADT                          WLAADT
     I              AIAMTM                          WLAMTM
     I              AIAJST                          WLAJST
     I              AIAHVN                          WLAHVN
     I              AIAGVN                          WLAGVN
     I              AIABVN                          WLABVN
     I              AIABDT                          WLABDT
     I              AIABTM                          WLABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKA21    E DSPKA2CPL0
      * UPD : Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WBHMNB
     I              A2BNNB                          WBBNNB
     I              A2BONB                          WBBONB
     I              A2CVNB                          WBCVNB
     I              A2B0DT                          WBB0DT
     I              A2C2NB                          WBC2NB
     I              A2CZNB                          WBCZNB
     I              A2C0NB                          WBC0NB
     I              A2D8NB                          WBD8NB
     I              A2H7NB                          WBH7NB
     I              A2GGST                          WBGGST
     I              A2AJTM                          WBAJTM
     I              A2JEA1                          WBJEA1
     I              A2B7CD                          WBB7CD
     I              A2D7NB                          WBD7NB
     I              A2D9ST                          WBD9ST
     I              A2E3ST                          WBE3ST
     I              A2E4ST                          WBE4ST
     I              A2E5ST                          WBE5ST
     I              A2BVDT                          WBBVDT
     I              A2BWDT                          WBBWDT
     I              A2BXDT                          WBBXDT
     I              A2HVNB                          WBHVNB
     I              A2CMCD                          WBCMCD
     I              A2B9CD                          WBB9CD
     I              A2H8NB                          WBH8NB
     I              A2CYCD                          WBCYCD
     I              A2AAVN                          WBAAVN
     I              A2AADT                          WBAADT
     I              A2AMTM                          WBAMTM
     I              A2AJST                          WBAJST
     I              A2AHVN                          WBAHVN
     I              A2AGVN                          WBAGVN
     I              A2ABVN                          WBABVN
     I              A2ABDT                          WBABDT
     I              A2ABTM                          WBABTM
      *
     IYARDCS      DS                            133
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            133
     IYCRDCS      DS                            133
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     IYDRDCS      DS                            583
     IQPKCD1    E DSPKCDCPL0
      * UPD : Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WFHMNB
     I              CDBNNB                          WFBNNB
     I              CDBONB                          WFBONB
     I              CDCVNB                          WFCVNB
     I              CDB0DT                          WFB0DT
     I              CDBQCD                          WFBQCD
     I              CDAZVA                          WFAZVA
     I              CDA0VA                          WFA0VA
     I              CDJBST                          WFJBST
     I              CDEIST                          WFEIST
     I              CDJDST                          WFJDST
     I              CDDPCD                          WFDPCD
     I              CDE3CD                          WFE3CD
     I              CDAQNB                          WFAQNB
     I              CDOCST                          WFOCST
     I              CDPEST                          WFPEST
     I              CDPFST                          WFPFST
     I              CDPGST                          WFPGST
     I              CDPIST                          WFPIST
     I              CDPJST                          WFPJST
     I              CDPKST                          WFPKST
     I              CDPLST                          WFPLST
     I              CDAAVN                          WFAAVN
     I              CDAADT                          WFAADT
     I              CDAMTM                          WFAMTM
     I              CDAJST                          WFAJST
     I              CDAHVN                          WFAHVN
     I              CDAGVN                          WFAGVN
     I              CDABVN                          WFABVN
     I              CDABDT                          WFABDT
     I              CDABTM                          WFABTM
      *
     IYERDCS      DS                            118
     IYFRDCS      DS                            118
     IYGRDCS      DS                            583
     IYHRDCS      DS                            583
     IYIRDCS      DS                            583
     IYJRDCS      DS                            583
     IYKRDCS      DS                            133
     IQPKA31    E DSPKA3REL0
      * UPD : Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WJHVNB
     I              A3CMCD                          WJCMCD
     I              A3BBTX                          WJBBTX
     I              A3CTNB                          WJCTNB
     I              A3D6NB                          WJD6NB
     I              A3B6CD                          WJB6CD
     I              A3DGST                          WJDGST
     I              A3EBNB                          WJEBNB
     I              A3FWST                          WJFWST
     I              A3HBNB                          WJHBNB
     I              A3AGCD                          WJAGCD
     I              A3AAVN                          WJAAVN
     I              A3AADT                          WJAADT
     I              A3AMTM                          WJAMTM
     I              A3AJST                          WJAJST
     I              A3AHVN                          WJAHVN
     I              A3AGVN                          WJAGVN
     I              A3ABVN                          WJABVN
     I              A3ABDT                          WJABDT
     I              A3ABTM                          WJABTM
      *
     IYLRDCS      DS                            107
     IYMRDCS      DS                            107
     IYNRDCS      DS                            107
     IYORDCS      DS                            107
     IYPRDCS      DS                            107
     IYQRDCS      DS                            107
     IYRRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Detail Wrk
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : MAP TH Kill Date
     I                                    P  13  160P1B0DT
     IP2PARM      DS
      * I :  Kill Date 2 USR
     I                                    P   1   40P2CWDT
     IP3PARM      DS
      * I : MAP Held Over Records Y/N
     I                                        1   1 P3NFST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P2CWDT    PARM           WP0006  70       Kill Date 2 USR
     C           P3NFST    PARM           WP0007  1        Held Over Recor
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * RTV/Chg TTD,Pen,Hdr   XF
      * Modification History
     C                     EXSR UASUBR                     Modification Hi
      * Routine to read the tattoo detail wrk and update the tattoo detai
      * Rtv/Chg TTDW/CHG TTD2 RT - Tattoo Detail Wrk  * 
     C                     EXSR SARVGN
      * Routine to read the tattoo detail wrk and accumulate the tattoo h
      * add all totals to the header, and zero out the next day
      * Then the split routing
      * Rtv/Chg TTDW Aft Snt  RT - Tattoo Detail Wrk  * 
     C                     EXSR SERVGN
      * Update the Balance to Kill (Only) because of report after edit
      * Chg THdr Bal To Err   IF
      * Chg THdr Bal to Err   RT - Tattoo Header  * 
     C                     EXSR TQRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv/Chg TTDW/CHG TTD2 RT - Tattoo Detail Wrk  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * MODIFICATION HISTORY
     C                     EXSR UBSUBR                     MODIFICATION HI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSA02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSA03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSA04           TH Tattoo Numbe
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOH Buy Order N
     C                     KFLD           WQSA03           BOL Load Number
     C                     KFLD           WQSA04           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOH Buy Order N
     C                     KFLD           WQSA03           BOL Load Number
     C                     KFLD           WQSA04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSA04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@DRCPVZ                    *
     C           KRSSA     READE@DRCPVZ                  90*
      * Data record not found
     C   90                MOVEL'PRK0672' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Change all tattoo details, and zero out next rec lv and pd hd
      * totals together
      * H16749 use the system date instead of the job date
      * Change the Tattoo detail and the next tattoo detail
     C                     EXSR UCSUBR                     Change the Tatt
     C           KRSSA     READE@DRCPVZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg TDtl Aft SntKil2Sydch - Tattoo Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       TD Drive Time
     C                     Z-ADD*ZERO     WN0002  20       TD Drive Hour
     C                     Z-ADD*ZERO     WN0003  30       TD Drive Card N
     C                     Z-ADD*ZERO     WN0004  70       TD Drive Date
     C                     MOVEL*BLANK    WN0005  6        TDP Process Cod
     C                     MOVEL*BLANK    WN0006 10        RS User Changed
     C                     Z-ADD*ZERO     WN0007  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0008  60       RS Time Changed
     C                     MOVEL*BLANK    WN0009  1        RS Record Statu
     C                     MOVEL*BLANK    WN0010 10        RS Job
     C                     MOVEL*BLANK    WN0011 10        RS Program
     C                     MOVEL*BLANK    WN0012 10        RS User Added
     C                     Z-ADD*ZERO     WN0013  70       RS Date Added
     C                     Z-ADD*ZERO     WN0014  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
     C                     Z-ADDWAAVNB    WBC2NB           TD Sequence Num
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C                     KFLD           WBC2NB           TD Sequence Num
     C           KLCHSB    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA21    YARDCS
      * USER: Processing after Data read
      * H16749 SLM 8/20/2020 use the system date instead of the job date
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WBAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WBAADT    PARM *ZERO     WQ0001  70       *DATE
     C           WBAMTM    PARM *ZERO     WQ0002  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Move non-key fields to @A2CPDF
     C                     Z-ADDWUCZNB    WBCZNB           TD Live Wgt
     C                     Z-ADDWABTNB    WBC0NB           TD Pen Head
     C                     Z-ADDWAWYDD    WBD8NB           TD Yard Dead
     C                     Z-ADDWAB1NB    WBH7NB           TD Held Over
     C                     MOVELWUGGST    WBGGST    P      TD Held Over St
     C                     Z-ADDWAAVLV    WBD7NB           TD Avg Live Wgt
     C                     MOVELWAOFST    WBD9ST    P      TD Gen Bal To K
     C                     MOVELWAOGST    WBE3ST    P      TD Recs Created
     C                     MOVELWAOHST    WBE4ST    P      TD User Status
     C                     MOVELWUE5ST    WBE5ST    P      TD User Status
     C                     Z-ADDWAC2DT    WBBVDT           TD User Date 1
     C                     Z-ADDWAC3DT    WBBWDT           TD User Date 2
     C                     Z-ADDWAORCO    WBHVNB           Pen Company Num
     C                     MOVELWAF4CD    WBCMCD    P      Pen Number
     C                     Z-ADDWACONM    WBH8NB           Held Over Pen C
     C                     MOVELWAF7CD    WBCYCD    P      Held Over Pen N
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg TDtl Aft SntKil2Sydch - Tattoo Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0015  60       TD Drive Time
     C                     Z-ADD*ZERO     WN0016  20       TD Drive Hour
     C                     Z-ADD*ZERO     WN0017  30       TD Drive Card N
     C                     Z-ADD*ZERO     WN0018  70       TD Drive Date
     C                     MOVEL*BLANK    WN0019  6        TDP Process Cod
     C                     MOVEL*BLANK    WN0020 10        RS User Changed
     C                     Z-ADD*ZERO     WN0021  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0022  60       RS Time Changed
     C                     MOVEL*BLANK    WN0023  1        RS Record Statu
     C                     MOVEL*BLANK    WN0024 10        RS Job
     C                     MOVEL*BLANK    WN0025 10        RS Program
     C                     MOVEL*BLANK    WN0026 10        RS User Added
     C                     Z-ADD*ZERO     WN0027  70       RS Date Added
     C                     Z-ADD*ZERO     WN0028  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
     C                     Z-ADDWAAVNB    WBC2NB           TD Sequence Num
      *
     C           KLCHSC    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C                     KFLD           WBC2NB           TD Sequence Num
     C           KLCHSC    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA21    YBRDCS
      * USER: Processing after Data read
      * H16749 SLM 8/20/2020 use the system date instead of the job date
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WBAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WBAADT    PARM *ZERO     WQ0003  70       *DATE
     C           WBAMTM    PARM *ZERO     WQ0004  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Move non-key fields to @A2CPDF
     C                     Z-ADDWUCZNB    WBCZNB           TD Live Wgt
     C                     Z-ADDWABTNB    WBC0NB           TD Pen Head
     C                     Z-ADDWAWYDD    WBD8NB           TD Yard Dead
     C                     Z-ADDWAB1NB    WBH7NB           TD Held Over
     C                     MOVELWUGGST    WBGGST    P      TD Held Over St
     C                     Z-ADDWAAVLV    WBD7NB           TD Avg Live Wgt
     C                     MOVELWAOFST    WBD9ST    P      TD Gen Bal To K
     C                     MOVELWAOGST    WBE3ST    P      TD Recs Created
     C                     MOVELWAOHST    WBE4ST    P      TD User Status
     C                     MOVELWUE5ST    WBE5ST    P      TD User Status
     C                     Z-ADDWAC2DT    WBBVDT           TD User Date 1
     C                     Z-ADDWAC3DT    WBBWDT           TD User Date 2
     C                     Z-ADDWAORCO    WBHVNB           Pen Company Num
     C                     MOVELWAF4CD    WBCMCD    P      Pen Number
     C                     Z-ADD*ZERO     WBH8NB           Held Over Pen C
     C                     MOVEL*BLANK    WBCYCD    P      Held Over Pen N
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg TDtl A/SntKilNR SydCH - Tattoo Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0029  50       TD Yard Dead
     C                     Z-ADD*ZERO     WN0030  50       TD Held Over
     C                     MOVEL*BLANK    WN0031  1        TD Held Over St
     C                     Z-ADD*ZERO     WN0032  60       TD Drive Time
     C                     Z-ADD*ZERO     WN0033  20       TD Drive Hour
     C                     Z-ADD*ZERO     WN0034  30       TD Drive Card N
     C                     Z-ADD*ZERO     WN0035  51       TD Avg Live Wgt
     C                     MOVEL*BLANK    WN0036  1        TD Gen Bal To K
     C                     MOVEL*BLANK    WN0037  1        TD Recs Created
     C                     MOVEL*BLANK    WN0038  1        TD User Status
     C                     MOVEL*BLANK    WN0039  1        TD User Status
     C                     Z-ADD*ZERO     WN0040  70       TD User Date 1
     C                     Z-ADD*ZERO     WN0041  70       TD User Date 2
     C                     Z-ADD*ZERO     WN0042  70       TD Drive Date
     C                     MOVEL*BLANK    WN0043  6        TDP Process Cod
     C                     Z-ADD*ZERO     WN0044  30       Held Over Pen C
     C                     MOVEL*BLANK    WN0045  3        Held Over Pen N
     C                     MOVEL*BLANK    WN0046 10        RS User Changed
     C                     Z-ADD*ZERO     WN0047  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0048  60       RS Time Changed
     C                     MOVEL*BLANK    WN0049  1        RS Record Statu
     C                     MOVEL*BLANK    WN0050 10        RS Job
     C                     MOVEL*BLANK    WN0051 10        RS Program
     C                     MOVEL*BLANK    WN0052 10        RS User Added
     C                     Z-ADD*ZERO     WN0053  70       RS Date Added
     C                     Z-ADD*ZERO     WN0054  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAC5DT    WBB0DT           TH Kill Date
     C                     Z-ADDWAAVNB    WBC2NB           TD Sequence Num
      *
     C           KLCHSD    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C                     KFLD           WBC2NB           TD Sequence Num
     C           KLCHSD    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA21    YCRDCS
      * USER: Processing after Data read
      * H163749 SLM 8/18/2020
      * change from jobdate to system date
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WBAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WBAADT    PARM *ZERO     WQ0005  70       *DATE
     C           WBAMTM    PARM *ZERO     WQ0006  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Move non-key fields to @A2CPDF
     C                     Z-ADD*ZERO     WBCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WBC0NB           TD Pen Head
     C                     Z-ADDWACONM    WBHVNB           Pen Company Num
     C                     MOVELWAF7CD    WBCMCD    P      Pen Number
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv/Chg TTDW Aft Snt  RT - Tattoo Detail Wrk  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * MODIFICATION HISTORY
     C                     EXSR UDSUBR                     MODIFICATION HI
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSE02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSE03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSE04           TH Tattoo Numbe
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           BOH Buy Order N
     C                     KFLD           WQSE03           BOL Load Number
     C                     KFLD           WQSE04           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           BOH Buy Order N
     C                     KFLD           WQSE03           BOL Load Number
     C                     KFLD           WQSE04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQSE01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSE02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSE03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSE04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSE     SETLL@DRCPVZ                    *
     C           KRSSE     READE@DRCPVZ                  90*
      * Data record not found
     C   90                MOVEL'PRK0672' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0007  30       CC Company Numb
     C                     PARM WAB0DT    WQ0008  70       Kill Date Usr
     C           WUB2DT    PARM *ZERO     WQ0009  70       Next Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
      * Count the total yard deads and the total held over for the tattoo
      * header
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUH9NB           TH Held Over
     C                     MOVEL'N'       WUHBST           First Time Flag
      * The follow routine will update or create the Tattoo headers
      * If this record is held over then add the tattoo hdr/tattoo d/a/ze
      * CASE: DB1.TDWC Held Over Status is Ready-Hld Over Processing
     C           WAOIST    IFEQ 'Y'                        *IF
      * This fun will accumulate the tattoo postion by date to eof
      * RTV Tattoo Totals Add RT - Tattoo Header  * 
     C                     EXSR SFRVGN
      * This tattoo header should be update will the totals for both days
      * Crt TTO HDR Add/AfKil RT - Tattoo Header  * 
     C                     EXSR SGRVGN
      * Update the yard deads and held over in first record only
      * Rtv TTD Tot Yard/Hld  RT - Tattoo Detail  * 
     C                     EXSR SLRVGN
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
     C                     EXSR SMCHRC
      * This tattoo header totals should be zero out IF THERE IS A NEXT
      * CASE: PAR.Kill Date 2 USR NE WRK.Zero USR
     C           P2CWDT    IFNE WUE9NB                     *IF
      * Chg TTO HDR Zero/Afkil RT - Tattoo Header  * 
     C                     EXSR SNRVGN
      * Rtv TTD Tot Yard/Hld  RT - Tattoo Detail  * 
     C                     EXSR SPRVGN
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
     C                     EXSR SQCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Update the yard deads and held over in first record only
      * Rtv TTD Tot Yard/Hld  RT - Tattoo Detail  * 
     C                     EXSR SRRVGN
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
     C                     EXSR SSCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Now split out the tattoo detail, tattoo header
      * This routine will now read the tattoo detail and split the
      * tattoo header
      * Sent to kill processing Yard Deads, and Held Overs
     C                     EXSR UKSUBR                     Sent to kill pr
      * RECOUNT PENS
     C                     EXSR UMSUBR                     RECOUNT PENS
     C           KRSSE     READE@DRCPVZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Tattoo Totals Add RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * MODIFICATION HISTORY
     C                     EXSR UESUBR                     MODIFICATION HI
      * Set Par add fields to zero
     C                     EXSR UFSUBR                     Set Par add fie
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSF04           TH Tattoo Numbe
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSF01           BOH Company Num
     C                     Z-ADDWABNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSF03           BOL Load Number
     C                     Z-ADDWACVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
      * Establish starting position
     C           KPSSF     SETLL@A1CPC4                    *
     C           KRSSF     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Load kill dates
      * CASE: PAR.Kill Date 1 Usr EQ WRK.Zero USR
     C           WUC6DT    IFEQ WUE9NB                     *IF
     C                     Z-ADDWCB0DT    WUC6DT           Kill Date 1 Usr
     C                     ELSE
      * CASE: PAR.Kill Date 2 USR EQ WRK.Zero USR
     C           WUCWDT    IFEQ WUE9NB                     *IF
     C                     Z-ADDWCB0DT    WUCWDT           Kill Date 2 USR
     C                     ELSE
      * CASE: PAR.Kill Date 3 Usr EQ WRK.Zero USR
     C           WUC7DT    IFEQ WUE9NB                     *IF
     C                     Z-ADDWCB0DT    WUC7DT           Kill Date 3 Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Kill Date 3 Usr is Not Found Kill Date
     C           WUC7DT    IFEQ 0                          *IF
      * accumulate detail or move detail
     C                     EXSR UGSUBR                     accumulate deta
     C                     END                             *FI
     C           KRSSF     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Crt TTO HDR Add/AfKil RT - Tattoo Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0055 10        TH Group Refere
     C                     MOVEL*BLANK    WN0056  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0057  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0058  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0059  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0060  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0061  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0062  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0063  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0064  50       TH Held Over
     C                     Z-ADD*ZERO     WN0065  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0066  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0067  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0068  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0069  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0070  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0071  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0072  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0073  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0074  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0075  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0076  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0077  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0078  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0079  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0080  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0081  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0082  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0083  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0084  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0085  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0086  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0087  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0088  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0089  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0090  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0091  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0092  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0093  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0094  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0095  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0096  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0097  1        TH Header Error
     C                     MOVEL*BLANK    WN0098  1        TH Detail Error
     C                     MOVEL*BLANK    WN0099  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0100  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0101  80       TH Commission A
     C                     Z-ADD*ZERO     WN0102  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0103  1        TH User Error O
     C                     MOVEL*BLANK    WN0104  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0105  1        TH Sex
     C                     Z-ADD*ZERO     WN0106  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0107  70       TH Commission P
     C                     Z-ADD*ZERO     WN0108  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0109  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0110  31       TH FFLI
     C                     Z-ADD*ZERO     WN0111  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0112  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0113  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0114  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0115  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0116  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0117  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0118  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0119  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0120  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0121  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0122  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0123  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0124  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0125  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0126  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0127  1        TH Source Type
     C                     MOVEL*BLANK    WN0128  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0129  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0130  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0131  3        TH Source Code
     C                     MOVEL*BLANK    WN0132  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0133  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0134  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0135  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0136  6        DF Defect Code
     C                     MOVEL*BLANK    WN0137  6        THP Process Cod
     C                     MOVEL*BLANK    WN0138  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0139  6        PL Location Cod
     C                     MOVEL*BLANK    WN0140  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0141  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0142  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modification History
     C                     EXSR UHSUBR                     Modification Hi
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
      * Establish starting position
     C           KRSSG     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWUB9PR    WUB9PR           TH Live Gross A
     C                     Z-ADDWUCAPR    WUCAPR           TH LIve Net Amt
     C                     Z-ADDWUCWNB    WUCWNB           TH Head Receive
     C                     Z-ADDWUCYNB    WUCYNB           TH Live Wgt
     C                     Z-ADDWUASPR    WUASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WUA4VA           TH Total Net WO
     C                     Z-ADDWUA5VA    WUA5VA           TH Additions Am
     C                     Z-ADDWUCBPR    WUCBPR           TH Payment Gros
     C                     Z-ADDWUCCPR    WUCCPR           Th Payment Net
     C                     Z-ADDWUCDPR    WUCDPR           TH Freight Amou
     C                     Z-ADDWUHGNB    WUHGNB           TH Shipped Weig
     C                     Z-ADDWUA7VA    WUA7VA           TH Accrual Amou
      * Crt Tto Hdr Add/Afkil CH - Tattoo Header  * 
     C                     EXSR SHCHRC
      * Read the Tattoo ded/add by key but for next kill date
      * then delete record and add back to orginal record
      * Rtv/Chg Tttoo D/A  ADD RT - Tattoo Ded/Add  * 
     C                     EXSR SIRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Crt Tto Hdr Add/Afkil CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0143  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0144  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0145  50       TH Held Over
     C                     Z-ADD*ZERO     WN0146  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0147  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0148  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0149  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0150  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0151  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0152  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0153  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0154  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0155  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0156  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0157  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0158  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0159  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0160  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0161  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0162  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0163  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0164  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0165  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0166  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0167  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0168  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0169  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0170  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0171  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0172  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0173  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0174  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0175  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0176  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0177  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0178  1        TH Header Error
     C                     MOVEL*BLANK    WN0179  1        TH Detail Error
     C                     MOVEL*BLANK    WN0180  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0181  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0182  80       TH Commission A
     C                     MOVEL*BLANK    WN0183  1        TH User Error O
     C                     MOVEL*BLANK    WN0184  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0185  1        TH Sex
     C                     Z-ADD*ZERO     WN0186  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0187  70       TH Commission P
     C                     Z-ADD*ZERO     WN0188  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0189  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0190  31       TH FFLI
     C                     Z-ADD*ZERO     WN0191  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0192  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0193  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0194  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0195  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0196  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0197  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0198  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0199  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0200  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0201  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0202  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0203  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0204  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0205  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0206  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0207  1        TH Source Type
     C                     MOVEL*BLANK    WN0208  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0209  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0210  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0211  3        TH Source Code
     C                     MOVEL*BLANK    WN0212  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0213  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0214  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0215  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0216  3        TH State
     C                     MOVEL*BLANK    WN0217  3        TH Unused Code
     C                     MOVEL*BLANK    WN0218  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0219  1        TH Commission S
     C                     MOVEL*BLANK    WN0220  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0221  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0222  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0223  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0224  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0225  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0226  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0227  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0228  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0229  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0230  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0231  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0232  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0233  3        TH PHA Average
     C                     MOVEL*BLANK    WN0234  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0235  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0236  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0237  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0238  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0239  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0240  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0241  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0242  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0243  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0244  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0245  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0246  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0247 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0248 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0249 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0250 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0251  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0252  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0253  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0254  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0255  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0256  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0257  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0258  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0259  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0260  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0261  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0262  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0263  70       TH Unused Date
     C                     MOVEL*BLANK    WN0264  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0265  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0266  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0267  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0268  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0269  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0270  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0271  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0272  6        DF Defect Code
     C                     MOVEL*BLANK    WN0273  6        THP Process Cod
     C                     MOVEL*BLANK    WN0274  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0275  6        PL Location Cod
     C                     MOVEL*BLANK    WN0276  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0277  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0278  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSH    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWCAWDT    WDAWDT           TH Purchase Dat
     C                     MOVELWCBICD    WDBICD    P      TH Group Refere
     C                     MOVELWCCPST    WDCPST    P      TH Live Purchas
     C                     Z-ADDWCACPR    WDACPR           TH Live Purchas
     C                     Z-ADDWUB9PR    WDB9PR           TH Live Gross A
     C                     Z-ADDWUCAPR    WDCAPR           TH LIve Net Amt
     C                     MOVELWCC4ST    WDC4ST    P      TH Resale UOM
     C                     Z-ADDWCAIPR    WDAIPR           TH Recalc Live
     C                     Z-ADDWCA6DT    WDA6DT           TH Pricing Date
     C                     MOVELWCC2ST    WDC2ST    P      TH Resale Sprea
     C                     Z-ADDWUCWNB    WDCWNB           TH Head Receive
     C                     Z-ADDWUCYNB    WDCYNB           TH Live Wgt
     C                     Z-ADDWCLRNB    WDLRNB           TH Adj Live Wgt
     C                     Z-ADDWUASPR    WDASPR           TH Deduction Am
     C                     Z-ADDWUA5VA    WDA5VA           TH Additions Am
     C                     Z-ADDWUCBPR    WDCBPR           TH Payment Gros
     C                     Z-ADDWUCCPR    WDCCPR           Th Payment Net
     C                     Z-ADDWCLPNB    WDLPNB           TH AP Voucher/D
     C                     Z-ADDWUCDPR    WDCDPR           TH Freight Amou
     C                     Z-ADDWUA7VA    WDA7VA           TH Accrual Amou
     C                     Z-ADDWCBYDT    WDBYDT           TH Voucher Paym
     C                     Z-ADDWUHGNB    WDHGNB           TH Shipped Weig
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tttoo D/A  ADD RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modification History
     C                     EXSR UISUBR                     Modification Hi
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WEBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN WEBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN WECVNB    WQSI04           TH Tattoo Numbe
     C           *LIKE     DEFN WEB0DT    WQSI05           TH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           TH Tattoo Numbe
     C                     KFLD           WQSI05           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSI01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSI03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSI04           TH Tattoo Numbe
     C                     Z-ADDWUCWDT    WQSI05           TH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@CDCPIU                    *
     C           KRSSI     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Read D/As except those with a Dead Head UOM
      * CASE: DB1.THD UOM is Dead Head UOM
     C           WEEIST    IFEQ 'CH'                       *IF
     C           WEEIST    OREQ 'DH'
     C           WEEIST    OREQ 'DY'
     C           WEEIST    OREQ 'YH'
     C           WEEIST    OREQ 'KH'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUA0VA    WUA0VA           THD Ded/Add Amo
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SJCHRC
      * Chg Add to Exists Ded - Tattoo Ded/Add  * 
     C                     EXSR SKCHRC
     C                     END                             *FI
     C           KRSSI     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWEHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWEBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWEBONB    WFBONB           BOL Load Number
     C                     Z-ADDWECVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWEB0DT    WFB0DT           TH Kill Date
     C                     MOVELWEBQCD    WFBQCD    P      DED D/A Code
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBQCD           DED D/A Code
     C           KLCHSJ    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YERDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWEAZVA    WFAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WFA0VA           THD Ded/Add Amo
     C                     MOVELWEJBST    WFJBST    P      THD Unit Amt Si
     C                     MOVELWEEIST    WFEIST    P      THD UOM
     C                     MOVELWEJDST    WFJDST    P      THD Transaction
     C                     MOVELWEDPCD    WFDPCD    P      THD GL Code
     C                     MOVELWEE3CD    WFE3CD    P      THD Contra Gl C
     C                     Z-ADDWEAQNB    WFAQNB           THD Re-imbursem
     C                     MOVELWEOCST    WFOCST    P      THD Payment Sts
     C                     MOVELWEPEST    WFPEST    P      THD Expense Pai
     C                     MOVELWEPFST    WFPFST    P      THD Expense Typ
     C                     MOVELWEPGST    WFPGST    P      THD Reserve Acc
     C                     MOVELWEPIST    WFPIST    P      THD Commission
     C                     MOVELWEPJST    WFPJST    P      THD Deferred Pa
     C                     MOVELWEPKST    WFPKST    P      THD Status 4
     C                     MOVELWEPLST    WFPLST    P      THD Status 5
     C                     MOVELWEAAVN    WFAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WFAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WFAHVN    P      RS Job
     C                     MOVELWEAGVN    WFAGVN    P      RS Program
     C                     MOVELWEABVN    WFABVN    P      RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Add to Exists Ded - Tattoo Ded/Add  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0279  72       THD Unit Amt
     C                     Z-ADD*ZERO     WN0280  72       THD Ded/Add Amo
     C                     MOVEL*BLANK    WN0281  1        THD Unit Amt Si
     C                     MOVEL*BLANK    WN0282  2        THD UOM
     C                     MOVEL*BLANK    WN0283  1        THD Transaction
     C                     MOVEL*BLANK    WN0284  8        THD GL Code
     C                     MOVEL*BLANK    WN0285  8        THD Contra Gl C
     C                     Z-ADD*ZERO     WN0286  50       THD Re-imbursem
     C                     MOVEL*BLANK    WN0287  2        THD Payment Sts
     C                     MOVEL*BLANK    WN0288  1        THD Expense Pai
     C                     MOVEL*BLANK    WN0289  1        THD Expense Typ
     C                     MOVEL*BLANK    WN0290  1        THD Reserve Acc
     C                     MOVEL*BLANK    WN0291  1        THD Commission
     C                     MOVEL*BLANK    WN0292  1        THD Deferred Pa
     C                     MOVEL*BLANK    WN0293  1        THD Status 4
     C                     MOVEL*BLANK    WN0294  1        THD Status 5
     C                     MOVEL*BLANK    WN0295 10        RS User Added
     C                     Z-ADD*ZERO     WN0296  70       RS Date Added
     C                     Z-ADD*ZERO     WN0297  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Modification History
     C                     EXSR UJSUBR                     Modification Hi
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWEHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWEBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWEBONB    WFBONB           BOL Load Number
     C                     Z-ADDWECVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WFB0DT           TH Kill Date
     C                     MOVELWEBQCD    WFBQCD    P      DED D/A Code
      *
     C           KLCHSK    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBQCD           DED D/A Code
     C           KLCHSK    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YFRDCS
      * USER: Processing after Data read
     C           WFA0VA    ADD  WUA0VA    WN0280           THD Ded/Add Amo
      * Move non-key fields to @CDCPIT
     C                     MOVELWEAAVN    WFAAVN    P      RS User Changed
     C                     Z-ADDWEAADT    WFAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST    P      RS Record Statu
     C                     MOVELWEAHVN    WFAHVN    P      RS Job
     C                     MOVELWEAGVN    WFAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv TTD Tot Yard/Hld  RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUFCNB           TD Yard Dead
     C                     Z-ADD*ZERO     WUH9NB           TD Held Over
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSL02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSL03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQSL04           TH Tattoo Numbe
     C           *LIKE     DEFN WGB0DT    WQSL05           TH Kill Date
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           BOH Buy Order N
     C                     KFLD           WQSL03           BOL Load Number
     C                     KFLD           WQSL04           TH Tattoo Numbe
     C                     KFLD           WQSL05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSL01           BOH Company Num
     C                     Z-ADDWABNNB    WQSL02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSL03           BOL Load Number
     C                     Z-ADDWACVNB    WQSL04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSL05           TH Kill Date
      * Establish starting position
     C           KRSSL     SETLL@A2CPDG                    *
     C           KRSSL     READE@A2CPDG                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WGD8NB    WUFCNB           TD Yard Dead
     C                     ADD  WGH7NB    WUH9NB           TD Held Over
     C           KRSSL     READE@A2CPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0298  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0299 10        TH Group Refere
     C                     MOVEL*BLANK    WN0300  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0301  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0302  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0303  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0304  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0305  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0306  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0307  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0308  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0309  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0310  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0311  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0312  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0313  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0314  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0315  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0316  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0317  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0318  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0319  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0320  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0321  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0322  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0323  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0324  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0325  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0326  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0327  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0328  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0329  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0330  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0331  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0332  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0333  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0334  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0335  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0336  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0337  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0338  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0339  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0340  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0341  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0342  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0343  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0344  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0345  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0346  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0347  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0348  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0349  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0350  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0351  1        TH Header Error
     C                     MOVEL*BLANK    WN0352  1        TH Detail Error
     C                     MOVEL*BLANK    WN0353  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0354  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0355  80       TH Commission A
     C                     Z-ADD*ZERO     WN0356  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0357  1        TH User Error O
     C                     MOVEL*BLANK    WN0358  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0359  1        TH Sex
     C                     Z-ADD*ZERO     WN0360  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0361  70       TH Commission P
     C                     Z-ADD*ZERO     WN0362  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0363  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0364  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0365  31       TH FFLI
     C                     Z-ADD*ZERO     WN0366  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0367  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0368  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0369  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0370  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0371  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0372  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0373  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0374  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0375  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0376  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0377  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0378  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0379  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0380  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0381  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0382  1        TH Source Type
     C                     MOVEL*BLANK    WN0383  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0384  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0385  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0386  3        TH Source Code
     C                     MOVEL*BLANK    WN0387  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0388  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0389  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0390  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0391  3        TH State
     C                     MOVEL*BLANK    WN0392  3        TH Unused Code
     C                     MOVEL*BLANK    WN0393  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0394  1        TH Commission S
     C                     MOVEL*BLANK    WN0395  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0396  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0397  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0398  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0399  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0400  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0401  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0402  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0403  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0404  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0405  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0406  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0407  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0408  3        TH PHA Average
     C                     MOVEL*BLANK    WN0409  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0410  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0411  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0412  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0413  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0414  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0415  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0416  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0417  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0418  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0419  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0420  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0421  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0422 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0423 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0424 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0425 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0426  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0427  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0428  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0429  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0430  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0431  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0432  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0433  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0434  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0435  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0436  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0437  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0438  70       TH Unused Date
     C                     MOVEL*BLANK    WN0439  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0440  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0441  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0442  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0443  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0444  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0445  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0446  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0447  6        DF Defect Code
     C                     MOVEL*BLANK    WN0448  6        THP Process Cod
     C                     MOVEL*BLANK    WN0449  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0450  6        PL Location Cod
     C                     MOVEL*BLANK    WN0451  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0452  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0453  3        HC Class Code
     C                     MOVEL*BLANK    WN0454 10        RS User Changed
     C                     Z-ADD*ZERO     WN0455  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0456  60       RS Time Changed
     C                     MOVEL*BLANK    WN0457  1        RS Record Statu
     C                     MOVEL*BLANK    WN0458 10        RS Job
     C                     MOVEL*BLANK    WN0459 10        RS Program
     C                     MOVEL*BLANK    WN0460 10        RS User Added
     C                     Z-ADD*ZERO     WN0461  70       RS Date Added
     C                     Z-ADD*ZERO     WN0462  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSM    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSM    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YGRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUFCNB    WDFCNB           TH Yard Deads
     C                     Z-ADDWUH9NB    WDH9NB           TH Held Over
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Chg TTO HDR Zero/Afkil RT - Tattoo Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0463 10        TH Group Refere
     C                     MOVEL*BLANK    WN0464  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0465  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0466  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0467  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0468  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0469  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0470  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0471  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0472  50       TH Held Over
     C                     Z-ADD*ZERO     WN0473  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0474  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0475  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0476  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0477  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0478  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0479  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0480  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0481  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0482  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0483  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0484  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0485  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0486  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0487  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0488  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0489  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0490  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0491  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0492  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0493  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0494  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0495  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0496  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0497  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0498  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0499  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0500  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0501  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0502  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0503  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0504  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0505  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0506  1        TH Header Error
     C                     MOVEL*BLANK    WN0507  1        TH Detail Error
     C                     MOVEL*BLANK    WN0508  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0509  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0510  80       TH Commission A
     C                     Z-ADD*ZERO     WN0511  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0512  1        TH User Error O
     C                     MOVEL*BLANK    WN0513  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0514  1        TH Sex
     C                     Z-ADD*ZERO     WN0515  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0516  70       TH Commission P
     C                     Z-ADD*ZERO     WN0517  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0518  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0519  31       TH FFLI
     C                     Z-ADD*ZERO     WN0520  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0521  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0522  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0523  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0524  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0525  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0526  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0527  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0528  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0529  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0530  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0531  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0532  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0533  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0534  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0535  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0536  1        TH Source Type
     C                     MOVEL*BLANK    WN0537  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0538  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0539  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0540  3        TH Source Code
     C                     MOVEL*BLANK    WN0541  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0542  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0543  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0544  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0545  6        DF Defect Code
     C                     MOVEL*BLANK    WN0546  6        THP Process Cod
     C                     MOVEL*BLANK    WN0547  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0548  6        PL Location Cod
     C                     MOVEL*BLANK    WN0549  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0550  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0551  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WCHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WCBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWUB2DT    WCB0DT           TH Kill Date
      * Establish starting position
     C           KRSSN     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg TTO HDR Zero/Afkil CH - Tattoo Header  * 
     C                     EXSR SOCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg TTO HDR Zero/Afkil CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0552  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0553  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0554  50       TH Held Over
     C                     Z-ADD*ZERO     WN0555  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0556  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0557  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0558  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0559  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0560  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0561  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0562  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0563  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0564  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0565  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0566  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0567  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0568  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0569  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0570  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0571  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0572  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0573  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0574  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0575  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0576  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0577  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0578  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0579  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0580  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0581  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0582  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0583  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0584  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0585  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0586  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0587  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0588  1        TH Header Error
     C                     MOVEL*BLANK    WN0589  1        TH Detail Error
     C                     MOVEL*BLANK    WN0590  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0591  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0592  80       TH Commission A
     C                     MOVEL*BLANK    WN0593  1        TH User Error O
     C                     MOVEL*BLANK    WN0594  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0595  1        TH Sex
     C                     Z-ADD*ZERO     WN0596  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0597  70       TH Commission P
     C                     Z-ADD*ZERO     WN0598  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0599  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0600  31       TH FFLI
     C                     Z-ADD*ZERO     WN0601  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0602  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0603  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0604  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0605  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0606  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0607  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0608  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0609  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0610  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0611  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0612  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0613  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0614  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0615  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0616  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0617  1        TH Source Type
     C                     MOVEL*BLANK    WN0618  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0619  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0620  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0621  3        TH Source Code
     C                     MOVEL*BLANK    WN0622  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0623  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0624  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0625  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0626  3        TH State
     C                     MOVEL*BLANK    WN0627  3        TH Unused Code
     C                     MOVEL*BLANK    WN0628  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0629  1        TH Commission S
     C                     MOVEL*BLANK    WN0630  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0631  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0632  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0633  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0634  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0635  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0636  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0637  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0638  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0639  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0640  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0641  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0642  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0643  3        TH PHA Average
     C                     MOVEL*BLANK    WN0644  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0645  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0646  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0647  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0648  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0649  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0650  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0651  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0652  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0653  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0654  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0655  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0656  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0657 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0658 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0659 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0660 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0661  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0662  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0663  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0664  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0665  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0666  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0667  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0668  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0669  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0670  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0671  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0672  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0673  70       TH Unused Date
     C                     MOVEL*BLANK    WN0674  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0675  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0676  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0677  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0678  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0679  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0680  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0681  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0682  6        DF Defect Code
     C                     MOVEL*BLANK    WN0683  6        THP Process Cod
     C                     MOVEL*BLANK    WN0684  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0685  6        PL Location Cod
     C                     MOVEL*BLANK    WN0686  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0687  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0688  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSO    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSO    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YHRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWCAWDT    WDAWDT           TH Purchase Dat
     C                     MOVELWCBICD    WDBICD    P      TH Group Refere
     C                     MOVELWCCPST    WDCPST    P      TH Live Purchas
     C                     Z-ADDWCACPR    WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     MOVELWCC4ST    WDC4ST    P      TH Resale UOM
     C                     Z-ADDWCAIPR    WDAIPR           TH Recalc Live
     C                     Z-ADDWCA6DT    WDA6DT           TH Pricing Date
     C                     MOVELWCC2ST    WDC2ST    P      TH Resale Sprea
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADDWCLRNB    WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADDWCLPNB    WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADDWCBYDT    WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv TTD Tot Yard/Hld  RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUFCNB           TD Yard Dead
     C                     Z-ADD*ZERO     WUH9NB           TD Held Over
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSP02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSP03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQSP04           TH Tattoo Numbe
     C           *LIKE     DEFN WGB0DT    WQSP05           TH Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           BOH Buy Order N
     C                     KFLD           WQSP03           BOL Load Number
     C                     KFLD           WQSP04           TH Tattoo Numbe
     C                     KFLD           WQSP05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSP01           BOH Company Num
     C                     Z-ADDWABNNB    WQSP02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSP03           BOL Load Number
     C                     Z-ADDWACVNB    WQSP04           TH Tattoo Numbe
     C                     Z-ADDWUB2DT    WQSP05           TH Kill Date
      * Establish starting position
     C           KRSSP     SETLL@A2CPDG                    *
     C           KRSSP     READE@A2CPDG                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WGD8NB    WUFCNB           TD Yard Dead
     C                     ADD  WGH7NB    WUH9NB           TD Held Over
     C           KRSSP     READE@A2CPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0689  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0690 10        TH Group Refere
     C                     MOVEL*BLANK    WN0691  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0692  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0693  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0694  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0695  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0696  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0697  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0698  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0699  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0700  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0701  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0702  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0703  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0704  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0705  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0706  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0707  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0708  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0709  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0710  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0711  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0712  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0713  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0714  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0715  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0716  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0717  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0718  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0719  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0720  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0721  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0722  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0723  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0724  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0725  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0726  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0727  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0728  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0729  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0730  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0731  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0732  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0733  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0734  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0735  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0736  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0737  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0738  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0739  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0740  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0741  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0742  1        TH Header Error
     C                     MOVEL*BLANK    WN0743  1        TH Detail Error
     C                     MOVEL*BLANK    WN0744  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0745  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0746  80       TH Commission A
     C                     Z-ADD*ZERO     WN0747  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0748  1        TH User Error O
     C                     MOVEL*BLANK    WN0749  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0750  1        TH Sex
     C                     Z-ADD*ZERO     WN0751  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0752  70       TH Commission P
     C                     Z-ADD*ZERO     WN0753  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0754  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0755  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0756  31       TH FFLI
     C                     Z-ADD*ZERO     WN0757  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0758  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0759  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0760  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0761  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0762  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0763  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0764  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0765  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0766  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0767  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0768  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0769  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0770  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0771  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0772  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0773  1        TH Source Type
     C                     MOVEL*BLANK    WN0774  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0775  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0776  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0777  3        TH Source Code
     C                     MOVEL*BLANK    WN0778  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0779  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0780  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0781  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0782  3        TH State
     C                     MOVEL*BLANK    WN0783  3        TH Unused Code
     C                     MOVEL*BLANK    WN0784  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0785  1        TH Commission S
     C                     MOVEL*BLANK    WN0786  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0787  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0788  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0789  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0790  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0791  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0792  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0793  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0794  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0795  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0796  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0797  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0798  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0799  3        TH PHA Average
     C                     MOVEL*BLANK    WN0800  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0801  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0802  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0803  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0804  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0805  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0806  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0807  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0808  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0809  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0810  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0811  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0812  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0813 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0814 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0815 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0816 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0817  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0818  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0819  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0820  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0821  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0822  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0823  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0824  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0825  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0826  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0827  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0828  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0829  70       TH Unused Date
     C                     MOVEL*BLANK    WN0830  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0831  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0832  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0833  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0834  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0835  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0836  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0837  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0838  6        DF Defect Code
     C                     MOVEL*BLANK    WN0839  6        THP Process Cod
     C                     MOVEL*BLANK    WN0840  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0841  6        PL Location Cod
     C                     MOVEL*BLANK    WN0842  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0843  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0844  3        HC Class Code
     C                     MOVEL*BLANK    WN0845 10        RS User Changed
     C                     Z-ADD*ZERO     WN0846  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0847  60       RS Time Changed
     C                     MOVEL*BLANK    WN0848  1        RS Record Statu
     C                     MOVEL*BLANK    WN0849 10        RS Job
     C                     MOVEL*BLANK    WN0850 10        RS Program
     C                     MOVEL*BLANK    WN0851 10        RS User Added
     C                     Z-ADD*ZERO     WN0852  70       RS Date Added
     C                     Z-ADD*ZERO     WN0853  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWUB2DT    WDB0DT           TH Kill Date
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSQ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YIRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUFCNB    WDFCNB           TH Yard Deads
     C                     Z-ADDWUH9NB    WDH9NB           TH Held Over
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv TTD Tot Yard/Hld  RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUFCNB           TD Yard Dead
     C                     Z-ADD*ZERO     WUH9NB           TD Held Over
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSR03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQSR04           TH Tattoo Numbe
     C           *LIKE     DEFN WGB0DT    WQSR05           TH Kill Date
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
     C                     KFLD           WQSR04           TH Tattoo Numbe
     C                     KFLD           WQSR05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSR01           BOH Company Num
     C                     Z-ADDWABNNB    WQSR02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSR03           BOL Load Number
     C                     Z-ADDWACVNB    WQSR04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSR05           TH Kill Date
      * Establish starting position
     C           KRSSR     SETLL@A2CPDG                    *
     C           KRSSR     READE@A2CPDG                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WGD8NB    WUFCNB           TD Yard Dead
     C                     ADD  WGH7NB    WUH9NB           TD Held Over
     C           KRSSR     READE@A2CPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0854  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0855 10        TH Group Refere
     C                     MOVEL*BLANK    WN0856  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0857  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0858  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0859  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0860  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0861  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0862  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0863  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0864  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0865  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0866  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0867  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0868  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0869  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0870  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0871  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0872  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0873  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0874  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0875  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0876  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0877  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0878  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0879  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0880  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0881  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0882  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0883  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0884  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0885  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0886  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0887  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0888  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0889  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0890  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0891  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0892  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0893  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0894  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0895  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0896  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0897  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0898  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0899  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0900  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0901  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0902  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0903  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0904  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0905  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0906  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0907  1        TH Header Error
     C                     MOVEL*BLANK    WN0908  1        TH Detail Error
     C                     MOVEL*BLANK    WN0909  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0910  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0911  80       TH Commission A
     C                     Z-ADD*ZERO     WN0912  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0913  1        TH User Error O
     C                     MOVEL*BLANK    WN0914  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0915  1        TH Sex
     C                     Z-ADD*ZERO     WN0916  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0917  70       TH Commission P
     C                     Z-ADD*ZERO     WN0918  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0919  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0920  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0921  31       TH FFLI
     C                     Z-ADD*ZERO     WN0922  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0923  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0924  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0925  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0926  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0927  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0928  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0929  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0930  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0931  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0932  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0933  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0934  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0935  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0936  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0937  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0938  1        TH Source Type
     C                     MOVEL*BLANK    WN0939  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0940  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0941  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0942  3        TH Source Code
     C                     MOVEL*BLANK    WN0943  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0944  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0945  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0946  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0947  3        TH State
     C                     MOVEL*BLANK    WN0948  3        TH Unused Code
     C                     MOVEL*BLANK    WN0949  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0950  1        TH Commission S
     C                     MOVEL*BLANK    WN0951  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0952  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0953  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0954  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0955  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0956  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0957  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0958  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0959  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0960  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0961  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0962  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0963  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0964  3        TH PHA Average
     C                     MOVEL*BLANK    WN0965  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0966  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0967  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0968  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0969  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0970  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0971  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0972  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0973  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0974  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0975  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0976  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0977  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0978 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0979 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0980 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0981 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0982  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0983  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0984  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0985  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0986  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0987  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0988  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0989  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0990  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0991  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0992  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0993  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0994  70       TH Unused Date
     C                     MOVEL*BLANK    WN0995  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0996  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0997  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0998  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0999  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN1000  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN1001  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN1002  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN1003  6        DF Defect Code
     C                     MOVEL*BLANK    WN1004  6        THP Process Cod
     C                     MOVEL*BLANK    WN1005  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1006  6        PL Location Cod
     C                     MOVEL*BLANK    WN1007  3        HB Buyer Code
     C                     MOVEL*BLANK    WN1008  5        GN Genetic Code
     C                     MOVEL*BLANK    WN1009  3        HC Class Code
     C                     MOVEL*BLANK    WN1010 10        RS User Changed
     C                     Z-ADD*ZERO     WN1011  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1012  60       RS Time Changed
     C                     MOVEL*BLANK    WN1013  1        RS Record Statu
     C                     MOVEL*BLANK    WN1014 10        RS Job
     C                     MOVEL*BLANK    WN1015 10        RS Program
     C                     MOVEL*BLANK    WN1016 10        RS User Added
     C                     Z-ADD*ZERO     WN1017  70       RS Date Added
     C                     Z-ADD*ZERO     WN1018  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSS    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSS    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YJRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUFCNB    WDFCNB           TH Yard Deads
     C                     Z-ADDWUH9NB    WDH9NB           TH Held Over
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv/Chg TttDtl Kill/Af RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C                     KFLD           WGC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDWAHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WGBONB           BOL Load Number
     C                     Z-ADDWACVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WGB0DT           TH Kill Date
     C                     Z-ADDWAAVNB    WGC2NB           TD Sequence Num
      * Establish starting position
     C           KRSST     CHAIN@A2CPDG              90    *
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.TDP Process Code is Driven to Kill/Resold
     C           WGB9CD    IFEQ 'K'                        *IF
      * Only the sent to kill records could have been changed
      *    after these hogs were sent to kill
     C                     Z-ADDWGC0NB    WUXYNB           Td Pen Head Org
     C                     Z-ADDWGCZNB    WUXZNB           td Pen Head Wgt
     C                     Z-ADD*ZERO     WUCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WUEDNB           Head Held Over
      * Held Over Processing
      * CASE: DB1.TD Held Over Status is Ready-Hld Over Processing
     C           WGGGST    IFEQ 'Y'                        *IF
      * Take care of the tattoo detail
      *   HEAD REC - YARD DEADS, HELD OVER = NET HEAD
     C                     EXSR ULSUBR                       HEAD REC - YA
     C                     MOVEL*BLANK    WUGGST           TD Held Over St
      * Pen Head/Held Over Head
      * CASE: DB1.TD Pen Head EQ DB1.TD Held Over
     C           WGC0NB    IFEQ WGH7NB                     *IF
      * Held over all of tattoo detail
     C                     Z-ADDWGH7NB    WUC0NB           TD Pen Head
     C                     Z-ADDWGCZNB    WUCZNB           TD Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
      * Held over only paritial  new record
     C                     Z-ADDWGH7NB    WUC0NB           TD Pen Head
     C           WGH7NB    MULT WGD7NB    WUCZNB           TD Live Wgt
     C                     END                             *FI
     C                     Z-ADDWGB0DT    WUB5DT           Date USR
     C                     Z-ADDWGD8NB    WUWHNB           Yard Dead
     C                     Z-ADDWUC0NB    WUEDNB           Head Held Over
     C                     Z-ADDWGHVNB    WUWGNB           Held Over Pen C
     C                     MOVELWGCYCD    WUFECD           Held Over Pen N
     C                     Z-ADDWUB2DT    WUB2DT           Next Kill Date
      * Create Tattoo dtl with same tattoo, held over pen & head, nxt kil
      *  and recalc live wgt
      * Crt/Chg TttDtl Kill/Af XF - Tattoo Detail  * 
     C                     CALL 'PLLOXFR'              90  Crt/Chg TttDtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGHMNB    WQ0010  30       BOH Company Num
     C                     PARM WGBNNB    WQ0011  70       BOH Buy Order N
     C                     PARM WGBONB    WQ0012  50       BOL Load Number
     C                     PARM WGCVNB    WQ0013  50       TH Tattoo Numbe
     C                     PARM WUB2DT    WQ0014  70       TH Kill Date
     C                     PARM WGC2NB    WQ0015  50       TD Sequence Num
     C                     PARM WUCZNB    WQ0016  71       TD Live Wgt
     C                     PARM WUC0NB    WQ0017  50       TD Pen Head
     C                     PARM WGD7NB    WQ0018  51       TD Avg Live Wgt
     C                     PARM WGD9ST    WQ0019  1        TD Gen Bal To K
     C                     PARM WGE3ST    WQ0020  1        TD Recs Created
     C                     PARM WGE4ST    WQ0021  1        TD User Status
     C                     PARM WGE5ST    WQ0022  1        TD User Status
     C                     PARM WGBVDT    WQ0023  70       TD User Date 1
     C                     PARM WGBWDT    WQ0024  70       TD User Date 2
     C                     PARM WUWGNB    WQ0025  30       Pen Company Num
     C                     PARM WUFECD    WQ0026  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLLOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Tattoo hdr:  Reduce hd rcvd by the held over head & recalc live w
      * Create Tattoo hdr with same tattoo, held over head, nxt kill dt
      *  and recalc live wgt
      * This routine will split the information into the tattoo hdr
      * for the held over record and change the org record
      * Or if you want to call this the split routine.
      * This routine will split out the tattoo headers, and
      *   the tattoo ded/add
      * Rtv/Chg Split Tto Rcd XF - Tattoo Header  * 
     C                     CALL 'PKFAXFR'              90  Rtv/Chg Split T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGHMNB    WQ0027  30       BOH Company Num
     C                     PARM WGBNNB    WQ0028  70       BOH Buy Order N
     C                     PARM WGBONB    WQ0029  50       BOL Load Number
     C                     PARM WGCVNB    WQ0030  50       TH Tattoo Numbe
     C                     PARM WUB5DT    WQ0031  70       TH Kill Date
     C                     PARM WUEDNB    WQ0032  50       TD Held Over
     C                     PARM WUB2DT    WQ0033  70       Next Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKFAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWGB0DT    WUB5DT           Date USR
     C                     Z-ADDWGD8NB    WUWHNB           Yard Dead
     C                     Z-ADDWGH8NB    WUWGNB           Held Over Pen C
     C                     MOVELWGCYCD    WUFECD           Held Over Pen N
     C                     Z-ADDWGC0NB    WUC0NB           TD Pen Head
     C                     MOVELWGGGST    WUGGST           TD Held Over St
     C                     END                             *FI
      * remainder
     C           WUXZNB    SUB  WUCZNB    WUCZNB           TD Live Wgt
     C           WUXYNB    SUB  WUEDNB    WUC0NB           TD Pen Head
      * H16749 SLM 8/21/2020 use system date instead of job date
      * Chg Tattoo Detail   SydCH - Tattoo Detail  * 
     C                     EXSR SUCHRC
      * CASE: WRK.Yard Dead             USR NE WRK.Zero USR
     C           WUWHNB    IFNE WUE9NB                     *IF
      * Yard deads message
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGHMNB    WQ0036  30       BOH Company Num
     C                     PARM WGBNNB    WQ0037  70       BOH Buy Order N
     C                     PARM WGBONB    WQ0038  50       BOL Load Number
     C                     PARM WGCVNB    WQ0039  50       TH Tattoo Numbe
     C                     PARM WUB5DT    WQ0040  70       TH Kill Date
     C                     PARM WUWHNB    WQ0041  50       TH Head Receive
     C                     PARM *ZERO     WQ0042  50       TH Held Over
     C                     PARM *ZERO     WQ0043  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0044  70       TH Voucher Paym
     C                     PARM 'YA'      WQ0045  2        Tattoo Action U
     C                     PARM *BLANK    WQ0046  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: WRK.Td Pen Head Org Usr NE WRK.TD Pen Head
     C           WUXYNB    IFNE WUC0NB                     *IF
      * Held over message
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGHMNB    WQ0047  30       BOH Company Num
     C                     PARM WGBNNB    WQ0048  70       BOH Buy Order N
     C                     PARM WGBONB    WQ0049  50       BOL Load Number
     C                     PARM WGCVNB    WQ0050  50       TH Tattoo Numbe
     C                     PARM WUB5DT    WQ0051  70       TH Kill Date
     C                     PARM *ZERO     WQ0052  50       TH Head Receive
     C                     PARM WUEDNB    WQ0053  50       TH Held Over
     C                     PARM *ZERO     WQ0054  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0055  70       TH Voucher Paym
     C                     PARM 'AK'      WQ0056  2        Tattoo Action U
     C                     PARM *BLANK    WQ0057  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail   SydCH - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWUB5DT    WBB0DT           TH Kill Date
     C                     Z-ADDWAAVNB    WBC2NB           TD Sequence Num
      *
     C           KLCHSU    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C                     KFLD           WBC2NB           TD Sequence Num
     C           KLCHSU    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA21    YKRDCS
      * Move non-key fields to @A2CPDF
     C                     Z-ADDWUCZNB    WBCZNB           TD Live Wgt
     C                     Z-ADDWUC0NB    WBC0NB           TD Pen Head
     C                     Z-ADDWUWHNB    WBD8NB           TD Yard Dead
     C                     Z-ADDWUEDNB    WBH7NB           TD Held Over
     C                     MOVELWUGGST    WBGGST    P      TD Held Over St
     C                     Z-ADDWGAJTM    WBAJTM           TD Drive Time
     C                     Z-ADDWGJEA1    WBJEA1           TD Drive Hour
     C                     Z-ADDWGB7CD    WBB7CD           TD Drive Card N
     C                     Z-ADDWGD7NB    WBD7NB           TD Avg Live Wgt
     C                     MOVELWGD9ST    WBD9ST    P      TD Gen Bal To K
     C                     MOVELWGE3ST    WBE3ST    P      TD Recs Created
     C                     MOVELWGE4ST    WBE4ST    P      TD User Status
     C                     MOVELWGE5ST    WBE5ST    P      TD User Status
     C                     Z-ADDWGBVDT    WBBVDT           TD User Date 1
     C                     Z-ADDWGBWDT    WBBWDT           TD User Date 2
     C                     Z-ADDWGBXDT    WBBXDT           TD Drive Date
     C                     Z-ADDWGHVNB    WBHVNB           Pen Company Num
     C                     MOVELWGCMCD    WBCMCD    P      Pen Number
     C                     MOVELWGB9CD    WBB9CD    P      TDP Process Cod
     C                     Z-ADDWGH8NB    WBH8NB           Held Over Pen C
     C                     MOVELWGCYCD    WBCYCD    P      Held Over Pen N
     C                     MOVELWGAAVN    WBAAVN    P      RS User Changed
     C                     Z-ADDWGAADT    WBAADT           RS Date Changed
     C                     Z-ADDWGAMTM    WBAMTM           RS Time Changed
     C                     MOVELWGAJST    WBAJST    P      RS Record Statu
     C                     MOVELWGAHVN    WBAHVN    P      RS Job
     C                     MOVELWGAGVN    WBAGVN    P      RS Program
     C                     MOVELWGABVN    WBABVN    P      RS User Added
     C                     Z-ADDWGABDT    WBABDT           RS Date Added
     C                     Z-ADDWGABTM    WBABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WBAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WBAADT    PARM *ZERO     WQ0034  70       *DATE
     C           WBAMTM    PARM *ZERO     WQ0035  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Recount Pen Head  RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 012397  SUSAN MASON
      * CHANGE THE COUNT OF PEN BECAUSE CLOSE PENS THE HEAD CNT WAS
      * BEING ZERO OUT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHVNB    WQSV01           Pen Company Num
     C           *LIKE     DEFN WHCMCD    WQSV02           Pen Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Pen Company Num
     C                     KFLD           WQSV02           Pen Number
      * Setup key
     C                     Z-ADDWAORCO    WQSV01           Pen Company Num
     C                     MOVELWAF4CD    WQSV02           Pen Number
      * Establish starting position
     C           KRSSV     SETLL@A3REKF                    *
     C           KRSSV     READE@A3REKF                  90*
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * This pen is open
     C                     Z-ADD*ZERO     WUC0NB           TD Pen Head
      * Read only tattoo detail that are open to accumulate pen head
      * Rtv Pen Totals        RT - Tattoo Detail  * 
     C                     EXSR SWRVGN
      * Chg Pen               CH - Pen  * 
     C                     EXSR SXCHRC
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR SYRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR TBCHRC
     C           KRSSV     READE@A3REKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Pen Totals        RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUC0NB           TD Pen Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN WICMCD    WQSW02           Pen Number
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           Pen Number
      * Setup key
     C                     Z-ADDWAORCO    WQSW01           BOH Company Num
     C                     MOVELWHCMCD    WQSW02           Pen Number
      * Establish starting position
     C           KRSSW     SETLL@A2CPI7                    *
     C           KRSSW     READE@A2CPI7                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WIC0NB    WUC0NB           TD Pen Head
     C           KRSSW     READE@A2CPI7                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWHHVNB    WJHVNB           Pen Company Num
     C                     MOVELWHCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHSX    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHSX    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YLRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWHBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWHCTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUC0NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWHB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWHDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWHEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWHFWST    WJFWST    P      Pen Type
     C                     Z-ADDWHHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWHAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWHAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWHAADT    WJAADT           RS Date Changed
     C                     Z-ADDWHAMTM    WJAMTM           RS Time Changed
     C                     MOVELWHAJST    WJAJST    P      RS Record Statu
     C                     MOVELWHAHVN    WJAHVN    P      RS Job
     C                     MOVELWHAGVN    WJAGVN    P      RS Program
     C                     MOVELWHABVN    WJABVN    P      RS User Added
     C                     Z-ADDWHABDT    WJABDT           RS Date Added
     C                     Z-ADDWHABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKHMNB    WQSY01           BOH Company Num
     C           *LIKE     DEFN WKCMCD    WQSY02           Pen Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           BOH Company Num
     C                     KFLD           WQSY02           Pen Number
      * Setup key
     C                     Z-ADDWAORCO    WQSY01           BOH Company Num
     C                     MOVELWAF4CD    WQSY02           Pen Number
      * Establish starting position
     C           KRSSY     SETLL@A2CPKE                    *
     C           KRSSY     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WKB9CD    IFEQ 'D'                        *IF
     C           WKB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR SZRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSY     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSZ01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSZ02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSZ03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSZ04           TH Tattoo Numbe
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           BOH Company Num
     C                     KFLD           WQSZ02           BOH Buy Order N
     C                     KFLD           WQSZ03           BOL Load Number
     C                     KFLD           WQSZ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWKHMNB    WQSZ01           BOH Company Num
     C                     Z-ADDWKBNNB    WQSZ02           BOH Buy Order N
     C                     Z-ADDWKBONB    WQSZ03           BOL Load Number
     C                     Z-ADDWKCVNB    WQSZ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSZ     SETLL@A1CPC4                    *
     C           KRSSZ     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWCAGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR TARVGN
     C           KRSSZ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WLAGCD           GN Genetic Code
      * Setup key
     C                     MOVELWCAGCD    WLAGCD           GN Genetic Code
      * Establish starting position
     C           KRSTA     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1019  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN1020  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN1021  30       Pen Current Dri
     C                     MOVEL*BLANK    WN1022  1        Pen Sts
     C                     Z-ADD*ZERO     WN1023  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN1024  1        Pen Type
     C                     Z-ADD*ZERO     WN1025  50       Pen Adjustment
     C                     MOVEL*BLANK    WN1026 10        RS User Changed
     C                     Z-ADD*ZERO     WN1027  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1028  60       RS Time Changed
     C                     MOVEL*BLANK    WN1029  1        RS Record Statu
     C                     MOVEL*BLANK    WN1030 10        RS Job
     C                     MOVEL*BLANK    WN1031 10        RS Program
     C                     MOVEL*BLANK    WN1032 10        RS User Added
     C                     Z-ADD*ZERO     WN1033  70       RS Date Added
     C                     Z-ADD*ZERO     WN1034  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWAORCO    WJHVNB           Pen Company Num
     C                     MOVELWAF4CD    WJCMCD    P      Pen Number
      *
     C           KLCHTB    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHTB    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YMRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Recount Pen Head  RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 012397  SUSAN MASON
      * CHANGE THE COUNT OF PEN BECAUSE CLOSE PENS THE HEAD CNT WAS
      * BEING ZERO OUT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHVNB    WQTC01           Pen Company Num
     C           *LIKE     DEFN WHCMCD    WQTC02           Pen Number
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Pen Company Num
     C                     KFLD           WQTC02           Pen Number
      * Setup key
     C                     Z-ADDWAORCO    WQTC01           Pen Company Num
     C                     MOVELWAF5CD    WQTC02           Pen Number
      * Establish starting position
     C           KRSTC     SETLL@A3REKF                    *
     C           KRSTC     READE@A3REKF                  90*
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * This pen is open
     C                     Z-ADD*ZERO     WUC0NB           TD Pen Head
      * Read only tattoo detail that are open to accumulate pen head
      * Rtv Pen Totals        RT - Tattoo Detail  * 
     C                     EXSR TDRVGN
      * Chg Pen               CH - Pen  * 
     C                     EXSR TECHRC
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR TFRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR TICHRC
     C           KRSTC     READE@A3REKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Pen Totals        RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUC0NB           TD Pen Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQTD01           BOH Company Num
     C           *LIKE     DEFN WICMCD    WQTD02           Pen Number
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           BOH Company Num
     C                     KFLD           WQTD02           Pen Number
      * Setup key
     C                     Z-ADDWAORCO    WQTD01           BOH Company Num
     C                     MOVELWHCMCD    WQTD02           Pen Number
      * Establish starting position
     C           KRSTD     SETLL@A2CPI7                    *
     C           KRSTD     READE@A2CPI7                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WIC0NB    WUC0NB           TD Pen Head
     C           KRSTD     READE@A2CPI7                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWHHVNB    WJHVNB           Pen Company Num
     C                     MOVELWHCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHTE    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHTE    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YNRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWHBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWHCTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUC0NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWHB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWHDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWHEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWHFWST    WJFWST    P      Pen Type
     C                     Z-ADDWHHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWHAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWHAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWHAADT    WJAADT           RS Date Changed
     C                     Z-ADDWHAMTM    WJAMTM           RS Time Changed
     C                     MOVELWHAJST    WJAJST    P      RS Record Statu
     C                     MOVELWHAHVN    WJAHVN    P      RS Job
     C                     MOVELWHAGVN    WJAGVN    P      RS Program
     C                     MOVELWHABVN    WJABVN    P      RS User Added
     C                     Z-ADDWHABDT    WJABDT           RS Date Added
     C                     Z-ADDWHABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKHMNB    WQTF01           BOH Company Num
     C           *LIKE     DEFN WKCMCD    WQTF02           Pen Number
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           BOH Company Num
     C                     KFLD           WQTF02           Pen Number
      * Setup key
     C                     Z-ADDWAORCO    WQTF01           BOH Company Num
     C                     MOVELWAF5CD    WQTF02           Pen Number
      * Establish starting position
     C           KRSTF     SETLL@A2CPKE                    *
     C           KRSTF     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WKB9CD    IFEQ 'D'                        *IF
     C           WKB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR TGRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTF     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQTG01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQTG02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQTG03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQTG04           TH Tattoo Numbe
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           BOH Company Num
     C                     KFLD           WQTG02           BOH Buy Order N
     C                     KFLD           WQTG03           BOL Load Number
     C                     KFLD           WQTG04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWKHMNB    WQTG01           BOH Company Num
     C                     Z-ADDWKBNNB    WQTG02           BOH Buy Order N
     C                     Z-ADDWKBONB    WQTG03           BOL Load Number
     C                     Z-ADDWKCVNB    WQTG04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTG     SETLL@A1CPC4                    *
     C           KRSTG     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWCAGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR THRVGN
     C           KRSTG     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WLAGCD           GN Genetic Code
      * Setup key
     C                     MOVELWCAGCD    WLAGCD           GN Genetic Code
      * Establish starting position
     C           KRSTH     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1035  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN1036  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN1037  30       Pen Current Dri
     C                     MOVEL*BLANK    WN1038  1        Pen Sts
     C                     Z-ADD*ZERO     WN1039  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN1040  1        Pen Type
     C                     Z-ADD*ZERO     WN1041  50       Pen Adjustment
     C                     MOVEL*BLANK    WN1042 10        RS User Changed
     C                     Z-ADD*ZERO     WN1043  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1044  60       RS Time Changed
     C                     MOVEL*BLANK    WN1045  1        RS Record Statu
     C                     MOVEL*BLANK    WN1046 10        RS Job
     C                     MOVEL*BLANK    WN1047 10        RS Program
     C                     MOVEL*BLANK    WN1048 10        RS User Added
     C                     Z-ADD*ZERO     WN1049  70       RS Date Added
     C                     Z-ADD*ZERO     WN1050  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWAORCO    WJHVNB           Pen Company Num
     C                     MOVELWAF5CD    WJCMCD    P      Pen Number
      *
     C           KLCHTI    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHTI    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YORDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Recount Pen Head  RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 012397  SUSAN MASON
      * CHANGE THE COUNT OF PEN BECAUSE CLOSE PENS THE HEAD CNT WAS
      * BEING ZERO OUT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHVNB    WQTJ01           Pen Company Num
     C           *LIKE     DEFN WHCMCD    WQTJ02           Pen Number
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Pen Company Num
     C                     KFLD           WQTJ02           Pen Number
      * Setup key
     C                     Z-ADDWACONM    WQTJ01           Pen Company Num
     C                     MOVELWAF7CD    WQTJ02           Pen Number
      * Establish starting position
     C           KRSTJ     SETLL@A3REKF                    *
     C           KRSTJ     READE@A3REKF                  90*
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * This pen is open
     C                     Z-ADD*ZERO     WUC0NB           TD Pen Head
      * Read only tattoo detail that are open to accumulate pen head
      * Rtv Pen Totals        RT - Tattoo Detail  * 
     C                     EXSR TKRVGN
      * Chg Pen               CH - Pen  * 
     C                     EXSR TLCHRC
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR TMRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR TPCHRC
     C           KRSTJ     READE@A3REKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Pen Totals        RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUC0NB           TD Pen Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQTK01           BOH Company Num
     C           *LIKE     DEFN WICMCD    WQTK02           Pen Number
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           BOH Company Num
     C                     KFLD           WQTK02           Pen Number
      * Setup key
     C                     Z-ADDWACONM    WQTK01           BOH Company Num
     C                     MOVELWHCMCD    WQTK02           Pen Number
      * Establish starting position
     C           KRSTK     SETLL@A2CPI7                    *
     C           KRSTK     READE@A2CPI7                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WIC0NB    WUC0NB           TD Pen Head
     C           KRSTK     READE@A2CPI7                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWHHVNB    WJHVNB           Pen Company Num
     C                     MOVELWHCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHTL    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHTL    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YPRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWHBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWHCTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUC0NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWHB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWHDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWHEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWHFWST    WJFWST    P      Pen Type
     C                     Z-ADDWHHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWHAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWHAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWHAADT    WJAADT           RS Date Changed
     C                     Z-ADDWHAMTM    WJAMTM           RS Time Changed
     C                     MOVELWHAJST    WJAJST    P      RS Record Statu
     C                     MOVELWHAHVN    WJAHVN    P      RS Job
     C                     MOVELWHAGVN    WJAGVN    P      RS Program
     C                     MOVELWHABVN    WJABVN    P      RS User Added
     C                     Z-ADDWHABDT    WJABDT           RS Date Added
     C                     Z-ADDWHABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKHMNB    WQTM01           BOH Company Num
     C           *LIKE     DEFN WKCMCD    WQTM02           Pen Number
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           BOH Company Num
     C                     KFLD           WQTM02           Pen Number
      * Setup key
     C                     Z-ADDWACONM    WQTM01           BOH Company Num
     C                     MOVELWAF7CD    WQTM02           Pen Number
      * Establish starting position
     C           KRSTM     SETLL@A2CPKE                    *
     C           KRSTM     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WKB9CD    IFEQ 'D'                        *IF
     C           WKB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR TNRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTM     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQTN01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQTN02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQTN03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQTN04           TH Tattoo Numbe
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           BOH Company Num
     C                     KFLD           WQTN02           BOH Buy Order N
     C                     KFLD           WQTN03           BOL Load Number
     C                     KFLD           WQTN04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWKHMNB    WQTN01           BOH Company Num
     C                     Z-ADDWKBNNB    WQTN02           BOH Buy Order N
     C                     Z-ADDWKBONB    WQTN03           BOL Load Number
     C                     Z-ADDWKCVNB    WQTN04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTN     SETLL@A1CPC4                    *
     C           KRSTN     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWCAGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR TORVGN
     C           KRSTN     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WLAGCD           GN Genetic Code
      * Setup key
     C                     MOVELWCAGCD    WLAGCD           GN Genetic Code
      * Establish starting position
     C           KRSTO     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1051  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN1052  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN1053  30       Pen Current Dri
     C                     MOVEL*BLANK    WN1054  1        Pen Sts
     C                     Z-ADD*ZERO     WN1055  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN1056  1        Pen Type
     C                     Z-ADD*ZERO     WN1057  50       Pen Adjustment
     C                     MOVEL*BLANK    WN1058 10        RS User Changed
     C                     Z-ADD*ZERO     WN1059  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1060  60       RS Time Changed
     C                     MOVEL*BLANK    WN1061  1        RS Record Statu
     C                     MOVEL*BLANK    WN1062 10        RS Job
     C                     MOVEL*BLANK    WN1063 10        RS Program
     C                     MOVEL*BLANK    WN1064 10        RS User Added
     C                     Z-ADD*ZERO     WN1065  70       RS Date Added
     C                     Z-ADD*ZERO     WN1066  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWACONM    WJHVNB           Pen Company Num
     C                     MOVELWAF7CD    WJCMCD    P      Pen Number
      *
     C           KLCHTP    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHTP    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YQRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Chg THdr Bal to Err   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQTQ01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQTQ02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQTQ03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQTQ04           TH Tattoo Numbe
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           BOH Company Num
     C                     KFLD           WQTQ02           BOH Buy Order N
     C                     KFLD           WQTQ03           BOL Load Number
     C                     KFLD           WQTQ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQTQ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTQ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTQ03           BOL Load Number
     C                     Z-ADDP1CVNB    WQTQ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTQ     SETLL@A1CPC4                    *
     C           KRSTQ     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Kill Balancing Sts is Balance
      *   |- c2    : DB1.THP Process Code is NE Payment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCDWST    IFEQ 'B'                        *IF
     C           WCCSCD    IFNE @CN,001                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg THdr Bal to Err   CH - Tattoo Header  * 
     C                     EXSR TRCHRC
     C                     END                             *FI
     C           KRSTQ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * Chg THdr Bal to Err   CH - Tattoo Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1067 10        TH Group Refere
     C                     MOVEL*BLANK    WN1068  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN1069  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN1070  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN1071  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN1072  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN1073  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN1074  70       TH Pricing Date
     C                     MOVEL*BLANK    WN1075  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN1076  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN1077  50       TH Head Receive
     C                     Z-ADD*ZERO     WN1078  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN1079  50       TH Held Over
     C                     Z-ADD*ZERO     WN1080  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN1081  50       TH Head Killed
     C                     Z-ADD*ZERO     WN1082  50       TH Head Adds
     C                     Z-ADD*ZERO     WN1083  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN1084  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN1085  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN1086  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN1087  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN1088  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN1089  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN1090  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN1091  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1092  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN1093  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN1094  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1095  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1096  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN1097  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN1098  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN1099  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN1100  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN1101  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN1102  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN1103  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN1104  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN1105  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN1106  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN1107  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN1108  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN1109  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN1110  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN1111  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN1112  72       TH Additions Am
     C                     Z-ADD*ZERO     WN1113  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN1114  72       Th Payment Net
     C                     Z-ADD*ZERO     WN1115  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN1116  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN1117  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN1118  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN1119  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN1120  2        TH Payment Sts
     C                     MOVEL*BLANK    WN1121  1        TH Header Error
     C                     MOVEL*BLANK    WN1122  1        TH Detail Error
     C                     MOVEL*BLANK    WN1123  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN1124  80       TH Commission A
     C                     Z-ADD*ZERO     WN1125  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN1126  1        TH User Error O
     C                     MOVEL*BLANK    WN1127  1        TH Held Over Re
     C                     MOVEL*BLANK    WN1128  1        TH Sex
     C                     Z-ADD*ZERO     WN1129  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN1130  70       TH Commission P
     C                     Z-ADD*ZERO     WN1131  70       TH Actual Check
     C                     Z-ADD*ZERO     WN1132  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN1133  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1134  31       TH FFLI
     C                     Z-ADD*ZERO     WN1135  72       TH Kill Product
     C                     Z-ADD*ZERO     WN1136  72       TH Cut Product
     C                     Z-ADD*ZERO     WN1137  72       TH Render Produ
     C                     Z-ADD*ZERO     WN1138  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN1139  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN1140  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN1141  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN1142  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN1143  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN1144  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN1145  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN1146  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN1147  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1148  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1149  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN1150  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN1151  1        TH Source Type
     C                     MOVEL*BLANK    WN1152  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN1153  1        TH Payment Type
     C                     Z-ADD*ZERO     WN1154  70       TH HPS Movement
     C                     MOVEL*BLANK    WN1155  3        TH Source Code
     C                     MOVEL*BLANK    WN1156  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN1157  1        TH Posted to HP
     C                     MOVEL*BLANK    WN1158  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN1159  1        TH Shift Held O
     C                     MOVEL*BLANK    WN1160  3        TH State
     C                     MOVEL*BLANK    WN1161  3        TH Unused Code
     C                     MOVEL*BLANK    WN1162  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1163  1        TH Commission S
     C                     MOVEL*BLANK    WN1164  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN1165  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN1166  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN1167  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN1168  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN1169  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN1170  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN1171  50       TH Head Identif
     C                     Z-ADD*ZERO     WN1172  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN1173  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN1174  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN1175  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN1176  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN1177  3        TH PHA Average
     C                     MOVEL*BLANK    WN1178  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN1179  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN1180  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN1181  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN1182  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN1183  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN1184  50       TH Broken Back
     C                     Z-ADD*ZERO     WN1185  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN1186  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN1187  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN1188  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN1189  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN1190  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN1191 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN1192 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1193 112       TH Break Even P
     C                     Z-ADD*ZERO     WN1194 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN1195  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN1196  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN1197  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1198  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1199  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN1200  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN1201  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1202  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN1203  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1204  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1205  70       TH Head LFT
     C                     Z-ADD*ZERO     WN1206  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN1207  70       TH Unused Date
     C                     MOVEL*BLANK    WN1208  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN1209  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1210  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN1211  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN1212  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN1213  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN1214  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN1215  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN1216  6        DF Defect Code
     C                     MOVEL*BLANK    WN1217  6        THP Process Cod
     C                     MOVEL*BLANK    WN1218  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1219  6        PL Location Cod
     C                     MOVEL*BLANK    WN1220  3        HB Buyer Code
     C                     MOVEL*BLANK    WN1221  5        GN Genetic Code
     C                     MOVEL*BLANK    WN1222  3        HC Class Code
     C                     MOVEL*BLANK    WN1223 10        RS User Changed
     C                     Z-ADD*ZERO     WN1224  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1225  60       RS Time Changed
     C                     MOVEL*BLANK    WN1226  1        RS Record Statu
     C                     MOVEL*BLANK    WN1227 10        RS Job
     C                     MOVEL*BLANK    WN1228 10        RS Program
     C                     MOVEL*BLANK    WN1229 10        RS User Added
     C                     Z-ADD*ZERO     WN1230  70       RS Date Added
     C                     Z-ADD*ZERO     WN1231  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHTR    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHTR    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YRRDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWCAWDT    WDAWDT           TH Purchase Dat
     C                     MOVEL'E'       WDDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * HPE025
      * This project is to allow reporting of yards/held over after
      * sent to kill has been already been reported
      * Special Notes:
      * Also correction to Held Over in reporting of Shipped Weight
      * on the next days kill.
      * Fixes were to correct the dollars spreading of $'s and Weight
      * and freight in relationship to the correct record
      * Also correct the create of deduction and additions on the reporti
      * of the subject tattoo, to use new routine.
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * 2/26/2008 slm the process code on the tattoo detail was being
      * change to open.  change to not update this field
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *   length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * MODIFICATION HISTORY
      *================================================================
      * FUNCTION - READ THE TATTOO DETAIL WRK FILE
      * BECAUSE THERE WERE CHANGES, UPDATE THE TATTOO DETAIL
      * HPE025NEW
      * Modification/changes History
      * 12/01/96   New routine
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Change the Tattoo detail and the next tattoo detail
      *================================================================
      * Update Current Record
     C           WABTNB    MULT WAAVLV    WUCZNB           TD Live Wgt
      * CASE: DB1.TDWC Held Over is greater than 0
     C           WAB1NB    IFGT 0                          *IF
     C                     MOVEL'Y'       WUGGST           TD Held Over St
     C                     ELSE
      * CASE: DB1.TDW Held Over is greater than 0
     C           WAHDHO    IFGT 0                          *IF
     C                     MOVEL'Y'       WUGGST           TD Held Over St
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUGGST           TD Held Over St
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.TD Held Over Status is Ready-Hld Over Processing
     C           WUGGST    IFEQ 'Y'                        *IF
      * H16749 slm 08/20/2020 use the system date instead of the job date
      * Chg TDtl Aft SntKil2Sydch - Tattoo Detail  * 
     C                     EXSR SBCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * H16749 slm 08/20/2020 use the system date instead of the job date
      * Chg TDtl Aft SntKil2Sydch - Tattoo Detail  * 
     C                     EXSR SCCHRC
     C                     END                             *FI
      * CASE: DB1.TDWC Next Record Kill Dte NE WRK.Zero USR
     C           WAC5DT    IFNE WUE9NB                     *IF
      * H16749 slm 08/20/2020 use the system date instead of the job date
      * Chg TDtl A/SntKilNR SydCH - Tattoo Detail  * 
     C                     EXSR SDCHRC
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * MODIFICATION HISTORY
      *================================================================
      * NEW FUNCTION - HPEO25
      * Fuction - Read the tattoo detail wrk file
      * because there were changes, add the Tattoo Header together
      * zero out the next kill date
      * add the tattoo d/a together and zero out the next kill tattoo d/a
      * HPE025
      * This project is to allow reporting of yards/held over after
      * sent to kill has been already been reported
      * Special Notes:
      * Also correction to Held Over in reporting of Shipped Weight
      * on the next days kill.
      * Fixes were to correct the dollars spreading of $'s and Weight
      * and freight in relationship to the correct record
      * Also correct the create of deduction and additions on the reporti
      * of the subject tattoo, to use new routine.
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * MODIFICATION HISTORY
      *================================================================
      * Purpose: Accumulate the tattoo header dollars and wgt, and totals
      * that will be placed on the orginal tattoo header
      * HPE025
      * This project is to allow reporting of yards/held over after
      * sent to kill has been already been reported
      * Special Notes:
      * Also correction to Held Over in reporting of Shipped Weight
      * on the next days kill.
      * Fixes were to correct the dollars spreading of $'s and Weight
      * and freight in relationship to the correct record
      * Also correct the create of deduction and additions on the reporti
      * of the subject tattoo, to use new routine.
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Set Par add fields to zero
      *================================================================
     C                     Z-ADD*ZERO     WUC6DT           Kill Date 1 Usr
     C                     Z-ADD*ZERO     WUCWDT           Kill Date 2 USR
     C                     Z-ADD*ZERO     WUC7DT           Kill Date 3 Usr
      * PAR.TH Purchase Date = WRK.Zero USR
     C                     Z-ADDWUE9NB    WUAWDT           TH Purchase Dat
     C                     Z-ADDWUE9NB    WUB9PR           TH Live Gross A
     C                     Z-ADDWUE9NB    WUCAPR           TH LIve Net Amt
     C                     Z-ADDWUE9NB    WUCXNB           TH Dead On Arri
     C                     Z-ADDWUE9NB    WUCWNB           TH Head Receive
     C                     Z-ADDWUE9NB    WUFCNB           TH Yard Deads
     C                     Z-ADDWUE9NB    WUH9NB           TH Held Over
     C                     Z-ADDWUE9NB    WUFDNB           TH Head Condemn
     C                     Z-ADDWUE9NB    WUCYNB           TH Live Wgt
     C                     Z-ADDWUE9NB    WUF7NB           TH Avg Live Wgt
     C                     Z-ADDWUE9NB    WUASPR           TH Deduction Am
     C                     Z-ADDWUE9NB    WUCWNB           TH Head Receive
     C                     Z-ADDWUE9NB    WUFCNB           TH Yard Deads
     C                     Z-ADDWUE9NB    WUASPR           TH Deduction Am
     C                     Z-ADDWUE9NB    WUA4VA           TH Total Net WO
     C                     Z-ADDWUE9NB    WUATPR           TH Carcass Net
     C                     Z-ADDWUE9NB    WUA5VA           TH Additions Am
     C                     Z-ADDWUE9NB    WUCBPR           TH Payment Gros
     C                     Z-ADDWUE9NB    WUCCPR           Th Payment Net
     C                     Z-ADDWUE9NB    WUCDPR           TH Freight Amou
     C                     Z-ADDWUE9NB    WUA7VA           TH Accrual Amou
     C                     Z-ADDWUE9NB    WUHGNB           TH Shipped Weig
     C                     MOVEL*BLANK    WUABCD           PD Producer Cod
     C                     MOVEL*BLANK    WUAECD           PL Location Cod
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * accumulate detail or move detail
      *================================================================
     C                     Z-ADDWCAWDT    WUAWDT           TH Purchase Dat
     C                     ADD  WCB9PR    WUB9PR           TH Live Gross A
     C                     ADD  WCCAPR    WUCAPR           TH LIve Net Amt
     C                     ADD  WCCXNB    WUCXNB           TH Dead On Arri
     C                     ADD  WCCWNB    WUCWNB           TH Head Receive
     C                     ADD  WCFCNB    WUFCNB           TH Yard Deads
     C                     ADD  WCH9NB    WUH9NB           TH Held Over
     C                     ADD  WCFDNB    WUFDNB           TH Head Condemn
     C                     ADD  WCCYNB    WUCYNB           TH Live Wgt
     C                     Z-ADDWCF7NB    WUF7NB           TH Avg Live Wgt
     C                     ADD  WCASPR    WUASPR           TH Deduction Am
     C                     ADD  WCA4VA    WUA4VA           TH Total Net WO
     C                     ADD  WCATPR    WUATPR           TH Carcass Net
     C                     ADD  WCA5VA    WUA5VA           TH Additions Am
     C                     ADD  WCCBPR    WUCBPR           TH Payment Gros
     C                     ADD  WCCCPR    WUCCPR           Th Payment Net
     C                     ADD  WCCDPR    WUCDPR           TH Freight Amou
     C                     ADD  WCHGNB    WUHGNB           TH Shipped Weig
     C                     ADD  WCA7VA    WUA7VA           TH Accrual Amou
     C                     Z-ADDWCLPNB    WULPNB           TH AP Voucher/D
     C                     Z-ADDWCBYDT    WUBYDT           TH Voucher Paym
     C                     MOVELWCABCD    WUABCD           PD Producer Cod
     C                     MOVELWCAECD    WUAECD           PL Location Cod
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * Purpose
      * This routine will update the fields accumulate to add
      * back into the Org tattoo detail
      * HPE025
      * This project is to allow reporting of yards/held over after
      * sent to kill has been already been reported
      * Special Notes:
      * Also correction to Held Over in reporting of Shipped Weight
      * on the next days kill.
      * Fixes were to correct the dollars spreading of $'s and Weight
      * and freight in relationship to the correct record
      * Also correct the create of deduction and additions on the reporti
      * of the subject tattoo, to use new routine.
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * Read next kill date and add to last kill date then delete the
      * next kill date tattoo d/a that are not dead transactions
      * HPE025
      * This project is to allow reporting of yards/held over after
      * sent to kill has been already been reported
      * Special Notes:
      * Also correction to Held Over in reporting of Shipped Weight
      * on the next days kill.
      * Fixes were to correct the dollars spreading of $'s and Weight
      * and freight in relationship to the correct record
      * Also correct the create of deduction and additions on the reporti
      * of the subject tattoo, to use new routine.
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * Purpose:  Add the amount of the transaction to tattoo d/a
      * HPE025
      * This project is to allow reporting of yards/held over after
      * sent to kill has been already been reported
      * Special Notes:
      * Also correction to Held Over in reporting of Shipped Weight
      * on the next days kill.
      * Fixes were to correct the dollars spreading of $'s and Weight
      * and freight in relationship to the correct record
      * Also correct the create of deduction and additions on the reporti
      * of the subject tattoo, to use new routine.
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Sent to kill processing Yard Deads, and Held Overs
      *================================================================
      * Rtv/Chg TttDtl Kill/Af RT - Tattoo Detail  * 
     C                     EXSR STRVGN
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      *   HEAD REC - YARD DEADS, HELD OVER = NET HEAD
      *================================================================
     C           WGC0NB    SUB  WGD8NB    WUF6NB           Net Head Usr
     C                     SUB  WGH7NB    WUF6NB           Net Head Usr
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * RECOUNT PENS
      *================================================================
      * ORG record pen number recount
      * Rtv Recount Pen Head  RT - Pen  * 
     C                     EXSR SVRVGN
      * Org Held over pen number recount
      * Rtv Recount Pen Head  RT - Pen  * 
     C                     EXSR TCRVGN
      * CHG record pen number recount
      * Rtv Recount Pen Head  RT - Pen  * 
     C                     EXSR TJRVGN
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAVNB           TDW Sequence Nu
     C                     Z-ADD*ZERO     WAARTM           TDW Drive Time
     C                     Z-ADD*ZERO     WAC2DT           TDW User Date 1
     C                     Z-ADD*ZERO     WADZNB           TDW Live Weight
     C                     Z-ADD*ZERO     WAD0NB           TDW Pen Head
     C                     Z-ADD*ZERO     WAD9NB           TDW Yard Dead
     C                     Z-ADD*ZERO     WAHDHO           TDW Held Over
     C                     Z-ADD*ZERO     WAD8CD           TDW Drive Card
     C                     Z-ADD*ZERO     WAAVLV           TDW Avg Live Wg
     C                     Z-ADD*ZERO     WAC3DT           TDW User Date 2
     C                     Z-ADD*ZERO     WAC4DT           TDW Drive Date
     C                     Z-ADD*ZERO     WAJFA1           TDW Drive Hour
     C                     Z-ADD*ZERO     WAORCO           Org Pen Company
     C                     Z-ADD*ZERO     WACQNB           Org Hld Over Pe
     C                     Z-ADD*ZERO     WABQNB           TDWC Live Weigh
     C                     Z-ADD*ZERO     WABTNB           TDWC Pen Head
     C                     Z-ADD*ZERO     WAWYDD           TDWC Yard Dead
     C                     Z-ADD*ZERO     WAB1NB           TDWC Held Over
     C                     Z-ADD*ZERO     WAWAGL           TDWC Avg Live W
     C                     Z-ADD*ZERO     WACONM           Change Pen Co N
     C                     Z-ADD*ZERO     WACANB           TDWC Sent to Ki
     C                     Z-ADD*ZERO     WACENB           TDWC Total Yard
     C                     Z-ADD*ZERO     WACINB           New Held Over P
     C                     Z-ADD*ZERO     WACFNB           TDWC Total Held
     C                     Z-ADD*ZERO     WAC5DT           TDWC Next Recor
     C                     Z-ADD*ZERO     WAC1NB           TDWC Next Rec P
     C                     Z-ADD*ZERO     WAC3NB           TDWC Next Rec Y
     C                     Z-ADD*ZERO     WAC7NB           TDWC Next Rec H
     C                     Z-ADD*ZERO     WAC8NB           TDWC Next Rec P
     C                     Z-ADD*ZERO     WAC9NB           TDWC Unused Hea
     C                     Z-ADD*ZERO     WADANB           TDWC Unused Wei
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field TD Live Wgt
     C                     Z-ADD*ZERO     WUCZNB  71
      * Define work field TD Held Over Status
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field TD User Status 3
     C                     MOVEL*BLANK    WUE5ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WBCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WBC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WBD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WBH7NB           TD Held Over
     C                     Z-ADD*ZERO     WBAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WBJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WBB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WBD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WBBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WBBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WBBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WBHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WBH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field Next Kill Date
     C                     Z-ADD*ZERO     WUB2DT  70
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Held Over
     C                     Z-ADD*ZERO     WUH9NB  50
      * Define work field TH Purchase Date
     C                     Z-ADD*ZERO     WUAWDT  70
      * Define work field TH Live Purchase UOM
     C                     MOVEL*BLANK    WUCPST  2
      * Define work field TH Live Purchase Price
     C                     Z-ADD*ZERO     WUACPR  52
      * Define work field TH Live Gross Amt
     C                     Z-ADD*ZERO     WUB9PR  72
      * Define work field TH LIve Net Amt
     C                     Z-ADD*ZERO     WUCAPR  72
      * Define work field TH Dead On Arrival
     C                     Z-ADD*ZERO     WUCXNB  50
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     WUA4VA  72
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field TH Payment Gross
     C                     Z-ADD*ZERO     WUCBPR  72
      * Define work field Th Payment Net Amt
     C                     Z-ADD*ZERO     WUCCPR  72
      * Define work field TH AP Voucher/Document#
     C                     Z-ADD*ZERO     WULPNB  80
      * Define work field TH Freight Amount
     C                     Z-ADD*ZERO     WUCDPR  72
      * Define work field TH Accrual Amount
     C                     Z-ADD*ZERO     WUA7VA  72
      * Define work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     WUBYDT  70
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Define work field PD Producer Code
     C                     MOVEL*BLANK    WUABCD  6
      * Define work field PL Location Code
     C                     MOVEL*BLANK    WUAECD  6
      * Define work field Kill Date 1 Usr
     C                     Z-ADD*ZERO     WUC6DT  70
      * Define work field Kill Date 2 USR
     C                     Z-ADD*ZERO     WUCWDT  70
      * Define work field Kill Date 3 Usr
     C                     Z-ADD*ZERO     WUC7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WCACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WCB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WCCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WCAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WCA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WCCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WCCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WCFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WCH9NB           TH Held Over
     C                     Z-ADD*ZERO     WCFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WCFENB           TH Head Killed
     C                     Z-ADD*ZERO     WCHENB           TH Head Adds
     C                     Z-ADD*ZERO     WCHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WCCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WCLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WCE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WCA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WCFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WCA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WCF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WCHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WCF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WCF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WCAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WCAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WCCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WCA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WCA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WCB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WCAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WCAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WCAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WCAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WCAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WCASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WCA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WCATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WCA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WCCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WCCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WCLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WCCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WCA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WCA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WCBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     Z-ADD*ZERO     WCBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WCHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WCHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCHINB           TH FFLI
     C                     Z-ADD*ZERO     WCA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WCA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WCA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WCJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WCD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WCD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WCD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WCD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WCEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WCEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WCECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WCEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WCEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WCEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WCOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WCTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WCT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WCTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WCT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WCOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WCKOER           TH Head Identif
     C                     Z-ADD*ZERO     WCOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WCOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WCIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WCOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WCHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WCS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WCTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WCTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WCJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WCKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WCKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WCKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WCKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WCOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WCIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WCIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WCIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WCKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WCKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WCORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WCOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WCMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WCNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WCNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WCIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WCEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCECDT           TH Head LFT
     C                     Z-ADD*ZERO     WCEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WCEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WEA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WEAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field THD Ded/Add Amount
     C                     Z-ADD*ZERO     WUA0VA  72
      * Define work field Td Pen Head Org Usr
     C                     Z-ADD*ZERO     WUXYNB  50
      * Define work field td Pen Head Wgt Org Usr
     C                     Z-ADD*ZERO     WUXZNB  71
      * Define work field Head Held Over Usr
     C                     Z-ADD*ZERO     WUEDNB  50
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field TD Pen Head
     C                     Z-ADD*ZERO     WUC0NB  50
      * Define work field Date USR
     C                     Z-ADD*ZERO     WUB5DT  70
      * Define work field Yard Dead             USR
     C                     Z-ADD*ZERO     WUWHNB  50
      * Define work field Held Over Pen Co      USR
     C                     Z-ADD*ZERO     WUWGNB  30
      * Define work field Held Over Pen Nbr     USR
     C                     MOVEL*BLANK    WUFECD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WHCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WHD6NB           Pen Current Hea
     C                     Z-ADD*ZERO     WHB6CD           Pen Current Dri
     C                     Z-ADD*ZERO     WHEBNB           Pen Drive Seque
     C                     Z-ADD*ZERO     WHHBNB           Pen Adjustment
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Define work field Pen Description
     C                     MOVEL*BLANK    WUBBTX 25
      * Define work field GN Genetic Code
     C                     MOVEL*BLANK    WUAGCD  5
      * Define work field Genetic Code USR
     C                     MOVEL*BLANK    WUA1CD  5
      * Define work field Pen Desc              USR
     C                     MOVEL*BLANK    WUJTTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PAYMNT
