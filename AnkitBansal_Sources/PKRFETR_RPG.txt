     H/TITLE Edt Voucher-Producer  ET  Edit transaction
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF header and associated DBF detail records
     H* - DBF header record fields appear on SFL control record
     H* - DBF detail records appear on SFL detail record
     H* - Program functions in two modes : *ADD and *CHANGE
     H* - Existing records may be updated or deleted
     H*   But key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit transaction
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 02/09/22  Time  : 15:09:18
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKRFETR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Voucher-Producer  ET  Edit transaction
      *
     FPKBKCPL2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * SPN : Hog Voucher Header        SPN Voucher Header/Dtl
      *
     FPKBKCPL0IF  E           K        DISK
      * RTV : Hog Voucher Header        Retrieval index
      *
     FPKBFREL2IF  E           K        DISK
      * RSQ : Producer Std Split        Active Prdcr Splits
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKBKCPL5IF  E           K        DISK
      * RSQ : Hog Voucher Header        Lst Vch Hdr #
      *
     FPKBLCPL1IF  E           K        DISK
      * RTV : Hog Voucher Detail        Retrieval index
      *
     FPKA1CPLEIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Prd/Loc/Tto,Sel ML
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBBREL0IF  E           K        DISK
      * RTV : Deduction/Addition        Retrieval index
      *
     FPKCDCPL7IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Rtv Index - Prd's
      *
     FPKBAREL0IF  E           K        DISK
      * RTV : Trucker                   Retrieval index
      *
     FPKBMREL0IF  E           K        DISK
      * RTV : Void Reason               Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKCACPL1IF  E           K        DISK
      * RTV : Hog Voucher Split         Retrieval index
      *
     FPKBKCPL1UF  E           K        DISK                      A
      * UPD : Hog Voucher Header        Update index
      *
     FPKCACPL0UF  E           K        DISK                      A
      * UPD : Hog Voucher Split         Update index
      *
     FPKBLCPL0UF  E           K        DISK                      A
      * UPD : Hog Voucher Detail        Update index
      *
     FPKCDCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Ded/Add            Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BKCPEJ
      * Hog Voucher Header        Retrieval index
      * Renamed input format fields
     I              BKHNNB                          WAHNNB
     I              BKLWNB                          WALWNB
     I              BKG9NB                          WAG9NB
     I              BKLXNB                          WALXNB
     I              BKLYNB                          WALYNB
     I              BKCSST                          WACSST
     I              BKDKNB                          WADKNB
     I              BKA2DT                          WAA2DT
     I              BKCIPR                          WACIPR
     I              BKCJPR                          WACJPR
     I              BKCKPR                          WACKPR
     I              BKCLPR                          WACLPR
     I              BKCMPR                          WACMPR
     I              BKAUVA                          WAAUVA
     I              BKAVVA                          WAAVVA
     I              BKCHPR                          WACHPR
     I              BKAJVA                          WAAJVA
     I              BKBUPC                          WABUPC
     I              BKJHST                          WAJHST
     I              BKC0ST                          WAC0ST
     I              BKA4DT                          WAA4DT
     I              BKCUST                          WACUST
     I              BKABCD                          WAABCD
     I              BKBNCD                          WABNCD
     I              BKCFCD                          WACFCD
     I              BKAAVN                          WAAAVN
     I              BKAADT                          WAAADT
     I              BKAMTM                          WAAMTM
     I              BKAJST                          WAAJST
     I              BKAHVN                          WAAHVN
     I              BKAGVN                          WAAGVN
     I              BKABVN                          WAABVN
     I              BKABDT                          WAABDT
     I              BKABTM                          WAABTM
      *
     I@BKCPJR
      * Hog Voucher Header        Lst Vch Hdr #
      * Renamed input format fields
     I              BKHNNB                          WBHNNB
     I              BKLWNB                          WBLWNB
     I              BKG9NB                          WBG9NB
     I              BKLXNB                          WBLXNB
     I              BKLYNB                          WBLYNB
     I              BKCSST                          WBCSST
     I              BKDKNB                          WBDKNB
     I              BKA2DT                          WBA2DT
     I              BKCIPR                          WBCIPR
     I              BKCJPR                          WBCJPR
     I              BKCKPR                          WBCKPR
     I              BKCLPR                          WBCLPR
     I              BKCMPR                          WBCMPR
     I              BKAUVA                          WBAUVA
     I              BKAVVA                          WBAVVA
     I              BKCHPR                          WBCHPR
     I              BKAJVA                          WBAJVA
     I              BKBUPC                          WBBUPC
     I              BKJHST                          WBJHST
     I              BKC0ST                          WBC0ST
     I              BKA4DT                          WBA4DT
     I              BKCUST                          WBCUST
     I              BKABCD                          WBABCD
     I              BKBNCD                          WBBNCD
     I              BKCFCD                          WBCFCD
     I              BKAAVN                          WBAAVN
     I              BKAADT                          WBAADT
     I              BKAMTM                          WBAMTM
     I              BKAJST                          WBAJST
     I              BKAHVN                          WBAHVN
     I              BKAGVN                          WBAGVN
     I              BKABVN                          WBABVN
     I              BKABDT                          WBABDT
     I              BKABTM                          WBABTM
      *
     I@BLCPEP
      * Hog Voucher Detail        Retrieval index
      * Renamed input format fields
     I              BLHNNB                          WCHNNB
     I              BLLWNB                          WCLWNB
     I              BLG9NB                          WCG9NB
     I              BLDLNB                          WCDLNB
     I              BLCNPR                          WCCNPR
     I              BLCOPR                          WCCOPR
     I              BLCPPR                          WCCPPR
     I              BLCQPR                          WCCQPR
     I              BLCRPR                          WCCRPR
     I              BLAKVA                          WCAKVA
     I              BLALVA                          WCALVA
     I              BLCVPR                          WCCVPR
     I              BLAMVA                          WCAMVA
     I              BLAEPC                          WCAEPC
     I              BLI6ST                          WCI6ST
     I              BLJIST                          WCJIST
     I              BLJPST                          WCJPST
     I              BLC2SS                          WCC2SS
     I              BLOTCD                          WCOTCD
     I              BLF5TX                          WCF5TX
     I              BLL5A1                          WCL5A1
     I              BLL6A1                          WCL6A1
     I              BLJQST                          WCJQST
     I              BLC4SS                          WCC4SS
     I              BLC5SS                          WCC5SS
     I              BLC3SS                          WCC3SS
     I              BLOKA1                          WCOKA1
     I              BLOLA1                          WCOLA1
     I              BLOMA1                          WCOMA1
     I              BLQ0CD                          WCQ0CD
     I              BLWSA1                          WCWSA1
     I              BLWOA1                          WCWOA1
     I              BLHFDT                          WCHFDT
     I              BLB2TM                          WCB2TM
     I              BLHMNB                          WCHMNB
     I              BLBNNB                          WCBNNB
     I              BLBONB                          WCBONB
     I              BLCVNB                          WCCVNB
     I              BLB0DT                          WCB0DT
     I              BLABCD                          WCABCD
     I              BLAECD                          WCAECD
     I              BLAAVN                          WCAAVN
     I              BLAADT                          WCAADT
     I              BLAMTM                          WCAMTM
     I              BLAJST                          WCAJST
     I              BLAHVN                          WCAHVN
     I              BLAGVN                          WCAGVN
     I              BLABVN                          WCABVN
     I              BLABDT                          WCABDT
     I              BLABTM                          WCABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@CDCPWX
      * Tattoo Ded/Add            Rtv Index - Prd's
      * Renamed input format fields
     I              CDHMNB                          WFHMNB
     I              CDBNNB                          WFBNNB
     I              CDBONB                          WFBONB
     I              CDCVNB                          WFCVNB
     I              CDB0DT                          WFB0DT
     I              CDBQCD                          WFBQCD
     I              CDAZVA                          WFAZVA
     I              CDA0VA                          WFA0VA
     I              CDJBST                          WFJBST
     I              CDEIST                          WFEIST
     I              CDJDST                          WFJDST
     I              CDDPCD                          WFDPCD
     I              CDE3CD                          WFE3CD
     I              CDAQNB                          WFAQNB
     I              CDOCST                          WFOCST
     I              CDPEST                          WFPEST
     I              CDPFST                          WFPFST
     I              CDPGST                          WFPGST
     I              CDPIST                          WFPIST
     I              CDPJST                          WFPJST
     I              CDPKST                          WFPKST
     I              CDPLST                          WFPLST
     I              CDAAVN                          WFAAVN
     I              CDAADT                          WFAADT
     I              CDAMTM                          WFAMTM
     I              CDAJST                          WFAJST
     I              CDAHVN                          WFAHVN
     I              CDAGVN                          WFAGVN
     I              CDABVN                          WFABVN
     I              CDABDT                          WFABDT
     I              CDABTM                          WFABTM
      *
     I@CDCPIU
      * Tattoo Ded/Add            Retrieval index
      * Renamed input format fields
     I              CDHMNB                          WGHMNB
     I              CDBNNB                          WGBNNB
     I              CDBONB                          WGBONB
     I              CDCVNB                          WGCVNB
     I              CDB0DT                          WGB0DT
     I              CDBQCD                          WGBQCD
     I              CDAZVA                          WGAZVA
     I              CDA0VA                          WGA0VA
     I              CDJBST                          WGJBST
     I              CDEIST                          WGEIST
     I              CDJDST                          WGJDST
     I              CDDPCD                          WGDPCD
     I              CDE3CD                          WGE3CD
     I              CDAQNB                          WGAQNB
     I              CDOCST                          WGOCST
     I              CDPEST                          WGPEST
     I              CDPFST                          WGPFST
     I              CDPGST                          WGPGST
     I              CDPIST                          WGPIST
     I              CDPJST                          WGPJST
     I              CDPKST                          WGPKST
     I              CDPLST                          WGPLST
     I              CDAAVN                          WGAAVN
     I              CDAADT                          WGAADT
     I              CDAMTM                          WGAMTM
     I              CDAJST                          WGAJST
     I              CDAHVN                          WGAHVN
     I              CDAGVN                          WGAGVN
     I              CDABVN                          WGABVN
     I              CDABDT                          WGABDT
     I              CDABTM                          WGABTM
      *
     I@CACPII
      * Hog Voucher Split         Retrieval index
      * Renamed input format fields
     I              CAHNNB                          WHHNNB
     I              CALWNB                          WHLWNB
     I              CAG9NB                          WHG9NB
     I              CABTCD                          WHBTCD
     I              CAABCD                          WHABCD
     I              CAA6PC                          WHA6PC
     I              CAAAVN                          WHAAVN
     I              CAAADT                          WHAADT
     I              CAAMTM                          WHAMTM
     I              CAAJST                          WHAJST
     I              CAAHVN                          WHAHVN
     I              CAAGVN                          WHAGVN
     I              CAABVN                          WHABVN
     I              CAABDT                          WHABDT
     I              CAABTM                          WHABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPKBKCPL1
      * UPD : Hog Voucher Header        Update index
      * Current/previous header format fields
      * Current/previous master file format fields for change control
      *
      *
     I@2DBRC    E DSPKBLCPL0
      * UPD : Hog Voucher Detail        Update index
      * Current/previous detail format fields
      * Current/previous master file format fields for change control
      *
      *
     IYARDCS      DS                            157
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKCA1    E DSPKCACPL0
      * UPD : Hog Voucher Split         Update index
      *
     IQPKCD1    E DSPKCDCPL0
      * UPD : Tattoo Ded/Add            Update index
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     IYBRDCS      DS                            583
     IYCRDCS      DS                            225
     IYDRDCS      DS                            225
     IYERDCS      DS                            583
     IYFRDCS      DS                            118
      * Outward parameters
     IPARC        DS                             12
      * KEY : Producer Std Split        Active Prdcr Splits
      * I : RST PD Producer Code
     I                                        1   6 PAABCD
      *
     IYGRDCS      DS                            157
     IYHRDCS      DS                            225
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYIRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              8
      * KEY: Hog Voucher Header        Retrieval index
      * I : RST VCH Company number
     I                                    P   1   20P1HNNB
      * I : RST VCH Batch Number
     I                                    P   3   50P1LWNB
      * I : RST VCH Header Number
     I                                    P   6   80P1G9NB
     IP2PARM      DS
      * FLD: Producer Std Split
     IP3PARM      DS
      * FLD: *Arrays
      * N : MAP Oms Name
     I                                        1  30 P3EUTX
      * I : MAP Oms System Value Alpha
     I                                       31  70 P3EVTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Hog Vouche
     C           P3EVTX    PARM           WP0001 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct program process
     C                     DO   *HIVAL                     DO
      * Initialize screen
     C                     EXSR ABIZSF
      * Set screen bypass indicator
     C           W0PMD     IFNE 'ADD'
     C                     MOVEL'Y'       W0BYP   1
     C                     ELSE
     C                     MOVEL'N'       W0BYP
     C                     END
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'                        DO
      * Convert fields to external form
     C                     EXSR MOCV#1
      * Bypass first screen for new transaction
     C           W0BYP     IFNE 'Y'
      * Display screen
     C                     EXSR CAEXFM
     C                     ELSE
      * Ensure all command keys set off
     C                     MOVE *ALL'0'   WKIN30 30
     C                     MOVEAWKIN30    *IN,1
     C                     END
      * Cancel screen bypass indicator
     C                     MOVEL'N'       W0BYP
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG           CAS
      * HOME: Request subfile reload
     C   30                CAS            ADHMKY
     C                     END                             SAC
     C           W0TRN     IFEQ 'Y'
      * Convert header fields to internal form
     C                     EXSR MPCV#1
      * Validate screen input
     C                     EXSR DAPRSF
     C                     END                             FI
      *
     C                     END                             OD
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
     C                     END                             OD
      *****************************************************************
      /EJECT
     CSR         ABIZSF    BEGSR
      *================================================================
      * Initialize screen
      *================================================================
     C                     SETOF                     81    *
      * Initialise subfile control
     C                     EXSR MAIZ#1
      * Clear subfile
     C                     SETON                     80    *
     C                     WRITE#SFLCTL
     C                     SETOF                     80    *
      * Reset count of SFL records
     C                     Z-ADD*ZERO     ##RRMX  50
     C                     Z-ADD*ZERO     ##RR    50
     C                     MOVEL'KEY'     W0SCR   3
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
     C                     MOVEL'Y'       W0TRN   1
     C                     MOVEL'Y'       W0FST   1
      *================================================================
     CSR         ABEXIT    ENDSR
      /EJECT
     CSR         ADHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN   1
      *================================================================
     CSR         ADEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN89     IFNE CAIN89
     C           *IN88     ORNE CAIN88
     C           *IN81     ORNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN89     CAIN89  1
     C                     MOVE *IN88     CAIN88  1
     C                     MOVE *IN81     CAIN81  1
     C                     MOVELW0SCR     W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END                              UOD
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSF    BEGSR
      *================================================================
      * Process subfile records
      *================================================================
      * Confirm/update is not deferred
     C           YPMTFD    IFEQ *BLANKS
     C                     MOVEL'N'       W0DCF   1
     C                     END
      * Validate SFL control keys if input
     C           W0SCR     IFEQ 'KEY'
     C                     EXSR DCVLH1
      * QUIT if error:
     C   99                GOTO DAEXIT
     C                     END
      * If keys only, now get the rest of the data
     C           W0SCR     IFEQ 'KEY'
     C           YPMTFD    ANDEQ*BLANKS
     C                     EXSR DBLDSF
     C                     GOTO DAEXIT
     C                     END
      * Validate SFL control non keys
     C                     EXSR DEVLH2
      *................................................................
      * Process subfile records
     C           *IN81     IFEQ '1'
     C           1         DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
     C                     SETOF                     98    No errors
      * Copy header keys to detail record for validation
     C                     Z-ADD#1HNNB    #2HNNB           VCH Company num
     C                     Z-ADD#1LWNB    #2LWNB           VCH Batch Numbe
     C                     Z-ADD#1G9NB    #2G9NB           VCH Header Numb
      * Check for null record
     C                     EXSR DGNLRC
     C           W0NLR     IFEQ 'Y'
      * Null record - clear value mapped fields
     C                     EXSR MQIZ#2
      * Initialise derived fields
     C                     EXSR MIIZ#2
     C                     END
      * Validate non-null subfile record
     C           W0NLR     IFEQ 'N'
     C           ##RR      OREQ YPMRRN
     C                     EXSR DIVLSF
     C                     END
      * If SFLRCD invalid, note that errors present
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C                     END                             FI
      *................................................................
      * Quit if subfile invalid:
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from screen
     C                     EXSR EAUPFL
      * Quit if DBF updates failed:
     C           *IN99     CABEQ'1'       DAEXIT
      *
      * USER: Process command keys
      * F14=Request check to JDE A/P system
      * CASE: CTL.*CMD key is Request check
     C           *IN14     IFEQ '1'                        *IF
      * If manual check & the manual chk amt n= calc Vch_Net_Amt, set sts
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.VCH Check Type is Manual Check
      *   |- c2    : CTL.Net Amount           USR NE CTL.VCH Net Amt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1CUST    IFEQ 'M'                        *IF
     C           #CA8VA    IFNE #1AJVA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUJOST           Manual Check Di
     C           #CA8VA    SUB  #1AJVA    WUL6NB           Manual Chk Adj
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUJOST           Manual Check Di
     C                     END                             *FI
      * Update process code and  Create split producer vouchers
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HNNB    WQ0001  30       BOH Company Num
     C                     PARM 'M3LIVE'  WQ0002 10        Company Value C
     C           YL0001    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
     C                     EXSR SARVGN
      * ************
      * Create manual check adjstmnts. in Tattoo D/A file if there is a d
      * CASE: WRK.Manual Check Diff  USR is Yes
     C           WUJOST    IFEQ 'Y'                        *IF
      *  Accum Live wt
     C                     Z-ADD*ZERO     WUH3NB           Weight Tot USR
      * Rtv Accum TH Live Wt  RT - Tattoo Header  * 
     C                     EXSR SMRVGN
     C                     DIV  100       WUH3NB           Weight Tot USR
     C                     Z-ADD*ZERO     WUL7NB           Manual Chk Adj
      * Set the +/- sign field
      * CASE: WRK.Manual Chk Adj Diff   USR is Greater than 0
     C           WUL6NB    IFGT *ZERO                      *IF
     C                     MOVEL'+'       WUJBST           THD Unit Amt Si
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'-'       WUJBST           THD Unit Amt Si
     C                     MULT -1        WUL6NB           Manual Chk Adj
     C                     END                             *FI
      * Read Voucher dtls to read TttHdr to create manual Adj Tattoo D/A
      * Rtv Dtl f/Manual Chk  RT - Hog Voucher Detail  * 
     C                     EXSR SNRVGN
      * If calc'd manual adjusted amts don't equal the total difference..
      * CASE: WRK.Manual Chk Adj Diff   USR NE WRK.Manual Chk Adj Total
     C           WUL6NB    IFNE WUL7NB                     *IF
      * Reset the sign on the fields
      * CASE: WRK.THD Unit Amt Sign is Subtract
     C           WUJBST    IFEQ '-'                        *IF
     C                     MULT -1        WUL6NB           Manual Chk Adj
     C                     MULT -1        WUL7NB           Manual Chk Adj
     C                     END                             *FI
     C                     SUB  WUL7NB    WUL6NB           Manual Chk Adj
      * Set the +/- sign field
      * CASE: WRK.Manual Chk Adj Diff   USR is Greater than 0
     C           WUL6NB    IFGT *ZERO                      *IF
     C                     MOVEL'+'       WUJBST           THD Unit Amt Si
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'-'       WUJBST           THD Unit Amt Si
     C                     MULT -1        WUL6NB           Manual Chk Adj
     C                     END                             *FI
      * Read the 1st Vchr Dtl to read the 1st Ttt D/A to add in the diff
      *  and adjust the tattoo header, & voucher detail
     C                     MOVEL*BLANK    WUBQCD           DED D/A Code
     C                     MOVEL'MAN'     WUBQCD           DED D/A Code
      * Rtv 1st Dtl f/ManlAdj RT - Hog Voucher Detail  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     C                     END                             *FI
      * ************
     C                     MOVEL*BLANK    WUP4ST           Status 1
      * Natv Crt Vchrs Batch UP - STR VND Common Routines  * 
     C                     CALL 'HPEVCHCL'             90  Natv Crt Vchrs
     C                     PARM W0RTN     WQ0015  7        *Return code
     C                     PARM #1HNNB    WQ0016  30       VCH Company num
     C                     PARM #1LWNB    WQ0017  50       VCH Batch Numbe
     C                     PARM WUP4ST    WQ0018  1        Status 1
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HPEVCHCL'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0TRN            *Continue trans
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Exit after successful update
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBLDSF    BEGSR
      *================================================================
      * Load screen fields from DBF
      *================================================================
      * Load subfile control from DBF
     C                     EXSR MBFL#1
      * Validate SFL control non keys
     C                     EXSR DFVLH3
     C           YPMTFD    IFEQ *BLANKS
      * USER: Load existing header
      * Dsp Vndr Addr formttd UP - STR VND Common Routines  * 
     C                     CALL 'VENDRETF'             90  Dsp Vndr Addr f
     C           WUGUST    PARM *BLANK    WQ0019  7        *Return code
     C           #1LXNB    PARM #1LXNB    WQ0020  80       Address Number
     C           #CGJTX    PARM #CGJTX    WQ0021 40        Vendor Address
     C           #CGKTX    PARM #CGKTX    WQ0022 40        Vendor Address
     C           #CGLTX    PARM #CGLTX    WQ0023 40        Vendor Address
     C           #CGMTX    PARM #CGMTX    WQ0024 40        Vendor Address
     C           #CGNTX    PARM #CGNTX    WQ0025 40        Vendor Address
     C           #CE1CD    PARM #CE1CD    WQ0026  3        Vendor Country
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'VENDRETF'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Vendor Return Code Usr is Vendor Error
     C           WUGUST    IFEQ 'ERR'                      *IF
     C                     MOVEL*BLANK    #CGJTX           Vendor Address
     C                     MOVEL@CN,001   #CGJTX           Vendor Address
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     Z-ADDWUA8VA    #CA8VA           Net Amount
     C                     END
      * Read all DBF detail records for header
      * Read ahead
     C           KSPNH     READE@BLCPJL                  92*
     C           *IN92     DOWEQ'0'
      * For each DBF detail record read:
     C                     ADD  1         ##RR    50
      * Initialise and load subfile record from DBF
     C                     EXSR MDIZ#2
     C                     EXSR MEFL#2
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MIIZ#2
     C                     END
      * Validate details
     C                     EXSR DJVLSF
      * Output DBF to subfile
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
      * Read next Data record
     C           KSPNH     READE@BLCPJL                  92*
     C                     END                             WOD
     C                     Z-ADD##RR      ##RRMX     81    *
     C                     MOVEL'DTL'     W0SCR
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCVLH1    BEGSR
      *================================================================
      * Validate header keys
      *================================================================
      * Check existence of header
     C           YPMTFD    IFEQ *BLANKS
     C                     EXSR DDRDH1
      * If header not found, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    PC
      * Send message 'Hog Voucher Header     NF'
     C                     MOVEL'PRK0099' ZAMSID
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DDRDH1    BEGSR
      *================================================================
      * Read header record
      *================================================================
     C           KSPNH     KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADD#1HNNB    BKHNNB
     C                     Z-ADD#1LWNB    BKLWNB
     C                     Z-ADD#1G9NB    BKG9NB
     C           KSPNH     CHAIN@BKCPJK              90    *
      *================================================================
     CSR         DDEXIT    ENDSR
      /EJECT
     CSR         DEVLH2    BEGSR
      *================================================================
      * Validate header non-key fields
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate header non-key fields
      * Change check type to Manual if data is entered.
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : CTL.CKH Manual Check Number is Entered
      *   |- c2    : CTL.CKH Manual Check Date is Entered
      *   |- c3    : CTL.Net Amount           USR is Entered
      *   '-
     C           #1DKNB    IFGT *ZERO                      *IF
     C           #1A2DT    ORGT *ZERO                      *OR
     C           #CA8VA    ORGT *ZERO                      *OR
      * CASE: CTL.VCH Less Split Amount is Entered
     C           #1CHPR    IFGT *ZERO                      *IF
      * Manual check not allowed for producer with standard splits.
      * Send message 'Manual check not allowed'
     C                     MOVEL'PRK0509' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : CTL.CKH Manual Check Number is Not Entered
      *   |- c2    : CTL.CKH Manual Check Date is Not Entered
      *   |- c3    : CTL.Net Amount           USR is Not Entered
      *   '-
     C           #1DKNB    IFEQ *ZERO                      *IF
     C           #1A2DT    OREQ *ZERO                      *OR
     C           #CA8VA    OREQ *ZERO                      *OR
      * Send message 'Must enter a manual ChkAm'
     C                     MOVEL'PRK0396' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       #1CUST           VCH Check Type
     C                     Z-ADD#CA8VA    WUA8VA           Net Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       #1CUST           VCH Check Type
     C                     Z-ADD*ZERO     WUA8VA           Net Amount
     C                     END                             *FI
     C                     END
      * Validate relations
     C                     EXSR DFVLH3
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFVLH3    BEGSR
      *================================================================
      * Validate header non-key relations
      *================================================================
      * Check reference to Producer
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Trucker
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Void Reason
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DGNLRC    BEGSR
      *================================================================
      * Check for null record
      *================================================================
     C                     MOVEL'N'       W0NLR   1
      * Existing records are never null
     C           #2OLRC    CABNE*BLANK    DGEXIT
     C                     MOVEL'Y'       W0NLR
      *================================================================
     CSR         DGEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#1
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
      * Force PUTOVR
     C                     SETON                     86
      * Refresh screen
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     MOVELW0SCR     W0GRP   1
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         DIVLSF    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MIIZ#2
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * F15=Dsp Prdcr STD Split
      * CASE: CTL.*CMD key is CF15
     C           *IN15     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Dsp Prdcr Split       DF - Producer Std Split  * 
     C                     CLEARPARC
     C                     MOVEL#1ABCD    PAABCD    P      PD Producer Cod
      *
     C                     CALL 'PKRHDFR'              90  Dsp Prdcr Split
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Producer S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKRHDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'N'       W0TRN            *Continue trans
     C                     GOTO DIEXIT                     *QUIT
     C                     END                             *FI
     C                     END
      * Validate relations
     C                     EXSR DJVLSF
      *================================================================
     CSR         DIEXIT    ENDSR
      /EJECT
     CSR         DJVLSF    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Producer Location
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile record function fields
     C                     Z-ADD*ZERO     #RMANB           Ded/Add/Split A
      * Ded/Add/Split Amt     DRV
     C           #2ALVA    SUB  #2CVPR    #RMANB           Ded/Add/Split A
     C                     END
      *================================================================
     CSR         DJEXIT    ENDSR
      /EJECT
     CSR         EAUPFL    BEGSR
      *================================================================
      * Update DBFs from screen
      *================================================================
      * Process header record
      * Change header
     C                     CAS            ECCHHD
     C                     END
      * Quit if header update failed
     C   99                GOTO EAEXIT
      * Process subfile records
     C           1         DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
     C  N92                DO
      * Copy header keys to detail record for update
     C                     Z-ADD#1HNNB    #2HNNB           VCH Company num
     C                     Z-ADD#1LWNB    #2LWNB           VCH Batch Numbe
     C                     Z-ADD#1G9NB    #2G9NB           VCH Header Numb
      * Process change request
     C                     CAS            EFCHLN
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C  N92                END                             OD
      *
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         ECCHHD    BEGSR
      *================================================================
      * Change header record
      *================================================================
      * USER: Change header DBF record
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR TBCHRC
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    PC
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EFCHLN    BEGSR
      *================================================================
      * Change detail record
      *================================================================
      * USER: Change detail DBF record
      * Chg Voucher Detail    CH - Hog Voucher Detail  * 
     C                     EXSR TCCHRC
     C           W0RTN     IFNE *BLANK
     C                     SETON                         99*
     C                     END
      *================================================================
     CSR         EFEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
      * Protect detail key fields if existing record
     C           #2OLRC    COMP 'Y'                      82*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     SETOF                     89    *
     C           W0SCR     COMP 'KEY'                    88*
      * Protect header key fields in change mode, full screen
     C                     SETOF                     87    *
     C  N88N89             SETON                     87    *
     C                     MOVEL'0'       *IN79
     C           #1CSST    IFEQ 'T'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise header fields
      *================================================================
      * Existing record indicator
     C                     MOVEL*BLANK    #1OLRC
     C                     MOVELP3EUTX    #PEUTX           Oms Name
     C                     MOVELP3EVTX    #PEVTX           Oms System Valu
     C                     Z-ADDP1HNNB    #1HNNB           VCH Company num
     C                     Z-ADDP1LWNB    #1LWNB           VCH Batch Numbe
     C                     MOVEL*BLANK    #1BNCD           TRK Trucker Cod
     C                     Z-ADDP1G9NB    #1G9NB           VCH Header Numb
     C                     Z-ADD*ZERO     #1LXNB           VCH AP Address
     C                     Z-ADD*ZERO     #1LYNB           VCH AP Voucher
     C                     MOVEL*BLANK    #1CSST           VCH Payee Type
     C                     Z-ADD*ZERO     #1CIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     #1CJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     #1CKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     #1CLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     #1CMPR           VCH LN Add on/D
     C                     MOVEL*BLANK    #1C0ST           VCH Process Sta
     C                     Z-ADD*ZERO     #1A4DT           VCH G/L Date
     C                     MOVEL*BLANK    #1CUST           VCH Check Type
     C                     MOVEL*BLANK    #CBSTX           Name USR
     C                     Z-ADD*ZERO     #CABPC           PSS Split Perce
     C                     MOVEL*BLANK    #1JHST           VCH Split Check
     C                     MOVEL*BLANK    #1CFCD           VR Reason Code
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #CGJTX           Vendor Address
     C                     Z-ADD*ZERO     #1BUPC           VCH Split %
     C                     MOVEL*BLANK    #CGKTX           Vendor Address
     C                     MOVEL*BLANK    #CGLTX           Vendor Address
     C                     MOVEL*BLANK    #CGMTX           Vendor Address
     C                     MOVEL*BLANK    #CGNTX           Vendor Address
     C                     MOVEL*BLANK    #CE1CD           Vendor Country
     C                     Z-ADD*ZERO     #1DKNB           VCH Manual Chec
     C                     Z-ADD*ZERO     #1A2DT           VCH Manual Chec
      * Clear external version also
     C                     Z-ADD*ZERO     V1A2DT
     C                     Z-ADD*ZERO     #CA8VA           Net Amount
     C                     Z-ADD*ZERO     #1AUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     #1AVVA           VCH Deduction A
     C                     Z-ADD*ZERO     #1CHPR           VCH Less Split
     C                     Z-ADD*ZERO     #1AJVA           VCH Net Amt
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move header DBF record fields to header screen
      *================================================================
      * Existing record indicator
     C                     MOVEL'Y'       #1OLRC
     C                     Z-ADDBKHNNB    #1HNNB           VCH Company num
     C                     Z-ADDBKLWNB    #1LWNB           VCH Batch Numbe
     C                     MOVELBKBNCD    #1BNCD           TRK Trucker Cod
     C                     Z-ADDBKG9NB    #1G9NB           VCH Header Numb
     C                     Z-ADDBKLXNB    #1LXNB           VCH AP Address
     C                     Z-ADDBKLYNB    #1LYNB           VCH AP Voucher
     C                     MOVELBKCSST    #1CSST           VCH Payee Type
     C                     Z-ADDBKCIPR    #1CIPR           VCH Base Mkt Pr
     C                     Z-ADDBKCJPR    #1CJPR           VCH Sort Disc A
     C                     Z-ADDBKCKPR    #1CKPR           VCH Yield Gain/
     C                     Z-ADDBKCLPR    #1CLPR           VCH Base Carcas
     C                     Z-ADDBKCMPR    #1CMPR           VCH LN Add on/D
     C                     MOVELBKC0ST    #1C0ST           VCH Process Sta
     C                     Z-ADDBKA4DT    #1A4DT           VCH G/L Date
     C                     MOVELBKCUST    #1CUST           VCH Check Type
     C                     MOVELBKJHST    #1JHST           VCH Split Check
     C                     MOVELBKCFCD    #1CFCD           VR Reason Code
     C                     MOVELBKAAVN    #1AAVN           RS User Changed
     C                     Z-ADDBKAADT    #1AADT           RS Date Changed
     C                     Z-ADDBKAMTM    #1AMTM           RS Time Changed
     C                     MOVELBKAJST    #1AJST           RS Record Statu
     C                     MOVELBKAHVN    #1AHVN           RS Job
     C                     MOVELBKAGVN    #1AGVN           RS Program
     C                     MOVELBKABVN    #1ABVN           RS User Added
     C                     Z-ADDBKABDT    #1ABDT           RS Date Added
     C                     Z-ADDBKABTM    #1ABTM           RS Time Added
     C                     MOVELBKABCD    #1ABCD           PD Producer Cod
     C                     Z-ADDBKBUPC    #1BUPC           VCH Split %
     C                     Z-ADDBKDKNB    #1DKNB           VCH Manual Chec
     C                     Z-ADDBKA2DT    #1A2DT           VCH Manual Chec
     C                     Z-ADDBKAUVA    #1AUVA           VCH Gross Amt
     C                     Z-ADDBKAVVA    #1AVVA           VCH Deduction A
     C                     Z-ADDBKCHPR    #1CHPR           VCH Less Split
     C                     Z-ADDBKAJVA    #1AJVA           VCH Net Amt
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#2    BEGSR
      *================================================================
      * Initialise screen detail record
      *================================================================
      * Existing record indicator
     C                     MOVEL*BLANK    #2OLRC
     C                     Z-ADD#1HNNB    #2HNNB           VCH Company num
     C                     Z-ADD#1LWNB    #2LWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     #2DLNB           VCD Line
     C                     Z-ADD*ZERO     #2CNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     #2COPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     #2CPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     #2CQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     #2CRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     #2CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #2L5A1           VCD Received He
     C                     Z-ADD*ZERO     #2L6A1           VCD Head Killed
     C                     Z-ADD*ZERO     #2ALVA           VCD Deduction A
     C                     Z-ADD*ZERO     #2CVPR           VCD Less Split
     C                     MOVEL*BLANK    #2ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #2AECD           PL Location Cod
     C                     Z-ADD*ZERO     #2AEPC           VCD Split Perce
     C                     MOVEL*BLANK    #2I6ST           VCD Payment Typ
     C                     MOVEL*BLANK    #2JIST           VCD Hog Class T
     C                     MOVEL*BLANK    #2JPST           VCD BO Type
     C                     MOVEL*BLANK    #2C2SS           VCD Source Cont
     C                     MOVEL*BLANK    #2OTCD           VCD Source Code
     C                     Z-ADD#1G9NB    #2G9NB           VCH Header Numb
     C                     MOVEL*BLANK    #2JQST           VCD Push Paymen
     C                     MOVEL*BLANK    #2C4SS           VCD Repayment F
     C                     MOVEL*BLANK    #2C5SS           VCD Unused Stat
     C                     MOVEL*BLANK    #2C3SS           VCD Unused Stat
     C                     Z-ADD*ZERO     #2OKA1           VCD Unused Head
     C                     Z-ADD*ZERO     #2OLA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     #2OMA1           VCD UnUsed Head
     C                     MOVEL*BLANK    #2Q0CD           MGL Supplier In
     C                     Z-ADD*ZERO     #2WSA1           MGL Voucher Num
     C                     Z-ADD*ZERO     #2WOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     #2HFDT           MGL Process to
     C                     Z-ADD*ZERO     #2B2TM           MGL Process to
     C                     Z-ADD*ZERO     #2HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #2B0DT           TH Kill Date
     C                     MOVEL*BLANK    #2AAVN           RS User Changed
     C                     Z-ADD*ZERO     #2AADT           RS Date Changed
     C                     Z-ADD*ZERO     #2AMTM           RS Time Changed
     C                     MOVEL*BLANK    #2AJST           RS Record Statu
     C                     MOVEL*BLANK    #2AHVN           RS Job
     C                     MOVEL*BLANK    #2AGVN           RS Program
     C                     MOVEL*BLANK    #2ABVN           RS User Added
     C                     Z-ADD*ZERO     #2ABDT           RS Date Added
     C                     Z-ADD*ZERO     #2ABTM           RS Time Added
     C                     Z-ADD*ZERO     #2BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #2BONB           BOL Load Number
     C                     MOVEL*BLANK    #2F5TX           VCD Check Descr
     C                     Z-ADD*ZERO     #2AKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     #RMANB           Ded/Add/Split A
     C                     Z-ADD*ZERO     #2AMVA           VCD Net Amt
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MEFL#2    BEGSR
      *================================================================
      * Load screen detail record
      *================================================================
      * Existing record indicator
     C                     MOVEL'Y'       #2OLRC
     C                     Z-ADDBLHNNB    #2HNNB           VCH Company num
     C                     Z-ADDBLLWNB    #2LWNB           VCH Batch Numbe
     C                     Z-ADDBLDLNB    #2DLNB           VCD Line
     C                     Z-ADDBLCNPR    #2CNPR           VCD Base Mkt Pr
     C                     Z-ADDBLCOPR    #2COPR           VCD Sort Disc A
     C                     Z-ADDBLCPPR    #2CPPR           VCD Yield Gain/
     C                     Z-ADDBLCQPR    #2CQPR           VCD Base Carcas
     C                     Z-ADDBLCRPR    #2CRPR           VCD LN Add on/D
     C                     Z-ADDBLCVNB    #2CVNB           TH Tattoo Numbe
     C                     Z-ADDBLL5A1    #2L5A1           VCD Received He
     C                     Z-ADDBLL6A1    #2L6A1           VCD Head Killed
     C                     Z-ADDBLALVA    #2ALVA           VCD Deduction A
     C                     Z-ADDBLCVPR    #2CVPR           VCD Less Split
     C                     MOVELBLABCD    #2ABCD           PD Producer Cod
     C                     MOVELBLAECD    #2AECD           PL Location Cod
     C                     Z-ADDBLAEPC    #2AEPC           VCD Split Perce
     C                     MOVELBLI6ST    #2I6ST           VCD Payment Typ
     C                     MOVELBLJIST    #2JIST           VCD Hog Class T
     C                     MOVELBLJPST    #2JPST           VCD BO Type
     C                     MOVELBLC2SS    #2C2SS           VCD Source Cont
     C                     MOVELBLOTCD    #2OTCD           VCD Source Code
     C                     Z-ADDBLG9NB    #2G9NB           VCH Header Numb
     C                     MOVELBLJQST    #2JQST           VCD Push Paymen
     C                     MOVELBLC4SS    #2C4SS           VCD Repayment F
     C                     MOVELBLC5SS    #2C5SS           VCD Unused Stat
     C                     MOVELBLC3SS    #2C3SS           VCD Unused Stat
     C                     Z-ADDBLOKA1    #2OKA1           VCD Unused Head
     C                     Z-ADDBLOLA1    #2OLA1           VCD UnUsed Head
     C                     Z-ADDBLOMA1    #2OMA1           VCD UnUsed Head
     C                     MOVELBLQ0CD    #2Q0CD           MGL Supplier In
     C                     Z-ADDBLWSA1    #2WSA1           MGL Voucher Num
     C                     Z-ADDBLWOA1    #2WOA1           MGL Invoice Bat
     C                     Z-ADDBLHFDT    #2HFDT           MGL Process to
     C                     Z-ADDBLB2TM    #2B2TM           MGL Process to
     C                     Z-ADDBLHMNB    #2HMNB           BOH Company Num
     C                     Z-ADDBLB0DT    #2B0DT           TH Kill Date
     C                     MOVELBLAAVN    #2AAVN           RS User Changed
     C                     Z-ADDBLAADT    #2AADT           RS Date Changed
     C                     Z-ADDBLAMTM    #2AMTM           RS Time Changed
     C                     MOVELBLAJST    #2AJST           RS Record Statu
     C                     MOVELBLAHVN    #2AHVN           RS Job
     C                     MOVELBLAGVN    #2AGVN           RS Program
     C                     MOVELBLABVN    #2ABVN           RS User Added
     C                     Z-ADDBLABDT    #2ABDT           RS Date Added
     C                     Z-ADDBLABTM    #2ABTM           RS Time Added
     C                     Z-ADDBLBNNB    #2BNNB           BOH Buy Order N
     C                     Z-ADDBLBONB    #2BONB           BOL Load Number
     C                     MOVELBLF5TX    #2F5TX           VCD Check Descr
     C                     Z-ADDBLAKVA    #2AKVA           VCD Gross Amt
     C                     Z-ADDBLAMVA    #2AMVA           VCD Net Amt
      * Update saved record image
     C                     MOVEL@2DBRC    #2DBRC
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MIIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     Z-ADD*ZERO     #RMANB           Ded/Add/Split A
      *================================================================
     CSR         MIEXIT    ENDSR
      /EJECT
     CSR         MOCV#1    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert VCH Manual Check Date to display format
      * Convert date
     C           1000000   ADD  #1A2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A2DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         MPCV#1    BEGSR
      *================================================================
      * Convert control fields into internal form
      *================================================================
      * Quit if only keys available
     C           W0SCR     CABEQ'KEY'     MPEXIT
      * Validate VCH Manual Check Date
      * External date
     C                     Z-ADDV1A2DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #1A2DT
      *================================================================
     CSR         MPEXIT    ENDSR
      /EJECT
     CSR         MQIZ#2    BEGSR
      *================================================================
      * Clear value mapped fields
      *================================================================
      *================================================================
     CSR         MQEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHNNB           VCH Company num
     C                     KFLD           WALWNB           VCH Batch Numbe
     C                     KFLD           WAG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADD#1HNNB    WAHNNB           VCH Company num
     C                     Z-ADD#1LWNB    WALWNB           VCH Batch Numbe
     C                     Z-ADD#1G9NB    WAG9NB           VCH Header Numb
      * Establish starting position
     C           KRSSA     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Recalc Net and Deduction amts if a Manual Check was written for a
      * CASE: PAR.Manual Chk Adj Diff   USR is Not Zero
     C           WUL6NB    IFNE 0                          *IF
     C           WAAVVA    ADD  WUL6NB    WUAVVA           VCH Deduction A
     C                     Z-ADD#CA8VA    WUAJVA           VCH Net Amt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAAVVA    WUAVVA           VCH Deduction A
     C                     Z-ADDWAAJVA    WUAJVA           VCH Net Amt
     C                     END                             *FI
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR SBCHRC
      * Create Split Voucher Hdr/Dtl if Split Producer
      * CASE: DB1.VCH Less Split Amount is Not equal to Zero
     C           WACHPR    IFNE 0                          *IF
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWAHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWALWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWAG9NB    BKG9NB           VCH Header Numb
      *
     C           KLCHSB    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
     C           KLCHSB    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWALXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWALYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWACSST    BKCSST    P      VCH Payee Type
     C                     Z-ADDWADKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWAA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADDWACIPR    BKCIPR           VCH Base Mkt Pr
     C                     Z-ADDWACJPR    BKCJPR           VCH Sort Disc A
     C                     Z-ADDWACKPR    BKCKPR           VCH Yield Gain/
     C                     Z-ADDWACLPR    BKCLPR           VCH Base Carcas
     C                     Z-ADDWACMPR    BKCMPR           VCH LN Add on/D
     C                     Z-ADDWAAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    BKAVVA           VCH Deduction A
     C                     Z-ADDWACHPR    BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADDWABUPC    BKBUPC           VCH Split %
     C                     MOVELWAJHST    BKJHST    P      VCH Split Check
     C                     MOVEL'C'       BKC0ST    P      VCH Process Sta
     C                     Z-ADDWAA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWACUST    BKCUST    P      VCH Check Type
     C                     MOVELWAABCD    BKABCD    P      PD Producer Cod
     C                     MOVELWABNCD    BKBNCD    P      TRK Trucker Cod
     C                     MOVELWACFCD    BKCFCD    P      VR Reason Code
     C                     MOVELWAAAVN    BKAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    BKAADT           RS Date Changed
     C                     Z-ADDWAAMTM    BKAMTM           RS Time Changed
     C                     MOVELWAAJST    BKAJST    P      RS Record Statu
     C                     MOVELWAAHVN    BKAHVN    P      RS Job
     C                     MOVELWAAGVN    BKAGVN    P      RS Program
     C                     MOVELWAABVN    BKABVN    P      RS User Added
     C                     Z-ADDWAABDT    BKABDT           RS Date Added
     C                     Z-ADDWAABTM    BKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BKAAVN           RS User Changed
     C                     Z-ADD##JDT     BKAADT           RS Date Changed
     C                     Z-ADD##JTM     BKAMTM           RS Time Changed
     C                     MOVEL##JOB     BKAHVN           RS Job
     C                     MOVEL##PGM     BKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BFABCD    WQSC01           PD Producer Cod
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           PD Producer Cod
      * Setup key
     C                     MOVELWAABCD    WQSC01           PD Producer Cod
      * Establish starting position
     C           KRSSC     SETLL@BFREOG                    *
     C           KRSSC     READE@BFREOG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR SDCRRC
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR SECRRC
      * Create Split producer voucher header and detail rcds ...
      * CASE: DB1.BOS Split Producer Code NE PAR.PD Producer Code
     C           BFBTCD    IFNE WAABCD                     *IF
      *   ... If not the original producer's split record
      * Create Header record for split producer
      * (Split amount is negative in voucher header,detail files.)
     C           WAAJVA    SUB  WACHPR    WUA8VA           Net Amount
     C           BFABPC    DIV  100       WUL9NB           Percent Decimal
     C           WUA8VA    MULT WUL9NB    WUAJVA    H      VCH Net Amt
     C                     Z-ADDWUAJVA    WUAUVA           VCH Gross Amt
      * RMC SDN440 get m3 supplier too
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
     C                     EXSR SFRVGN
      * RMC SDN440 Added 2/9/22
      * CASE: PAR.Live with M3   USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUQHCD:ZQ WUSTTX    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     WULXNB           VCH AP Address
     C                     MOVE WUSTTX    WULXNB           VCH AP Address
     C                     END                             *FI
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SHRVGN
      * Payee type values
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUCSST           VCH Payee Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUCSST           VCH Payee Type
     C                     END                             *FI
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
     C                     EXSR SIRVGN
      * Crt Voucher Header    CR - Hog Voucher Header  * 
     C                     EXSR SJCRRC
      * Create Detail records for split producer
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C           KRSSC     READE@BFREOG                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWAHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWALWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWAG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWAABCD    CABTCD           BOS Split Produ
     C                     MOVELWAABCD    CAABCD           PD Producer Cod
     C                     Z-ADD100       CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRSD    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWAHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWALWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWAG9NB    CAG9NB           VCH Header Numb
     C                     MOVELBFBTCD    CABTCD           BOS Split Produ
     C                     MOVELBFABCD    CAABCD           PD Producer Cod
     C                     Z-ADDBFABPC    CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRSE    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv PrdVendor#,Src,M3 RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELBFBTCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSF     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WULXNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WULXNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR SGRVGN
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVELACABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSSG     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUQHCD           M3 Supplier ID
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    WUQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSSH     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHNNB    WQSI01           VCH Company num
     C           *LIKE     DEFN WBLWNB    WQSI02           VCH Batch Numbe
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           VCH Company num
     C                     KFLD           WQSI02           VCH Batch Numbe
      * Setup key
     C                     Z-ADDWAHNNB    WQSI01           VCH Company num
     C                     Z-ADDWALWNB    WQSI02           VCH Batch Numbe
      * Establish starting position
     C           KRSSI     SETLL@BKCPJR                    *
     C           KRSSI     READE@BKCPJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD00001     WUL4NB           VCH Header Numb
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBG9NB    ADD  1         WUL4NB           VCH Header Numb
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BKCPJR                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Voucher Header    CR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPEK
     C                     Z-ADDWAHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWALWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    BKG9NB           VCH Header Numb
     C                     Z-ADDWULXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWALYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWUCSST    BKCSST           VCH Payee Type
     C                     Z-ADDWADKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWAA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     BKCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     BKCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     BKCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     BKCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     BKCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     BKAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     BKBUPC           VCH Split %
     C                     MOVEL'Y'       BKJHST           VCH Split Check
     C                     MOVEL'C'       BKC0ST           VCH Process Sta
     C                     Z-ADDWAA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWACUST    BKCUST           VCH Check Type
     C                     MOVELBFBTCD    BKABCD           PD Producer Cod
     C                     MOVELWABNCD    BKBNCD           TRK Trucker Cod
     C                     MOVELWACFCD    BKCFCD           VR Reason Code
     C                     MOVEL*BLANK    BKAAVN           RS User Changed
     C                     Z-ADD*ZERO     BKAADT           RS Date Changed
     C                     Z-ADD*ZERO     BKAMTM           RS Time Changed
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL*BLANK    BKAHVN           RS Job
     C                     MOVEL*BLANK    BKAGVN           RS Program
     C                     MOVEL*BLANK    BKABVN           RS User Added
     C                     Z-ADD*ZERO     BKABDT           RS Date Added
     C                     Z-ADD*ZERO     BKABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL##USR     BKABVN           RS User Added
     C                     Z-ADD##JDT     BKABDT           RS Date Added
     C                     Z-ADD##JTM     BKABTM           RS Time Added
     C                     MOVEL##PGM     BKAGVN           RS Program
     C                     MOVEL##JOB     BKAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@BKCPEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHNNB    WQSK01           VCH Company num
     C           *LIKE     DEFN WCLWNB    WQSK02           VCH Batch Numbe
     C           *LIKE     DEFN WCG9NB    WQSK03           VCH Header Numb
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           VCH Company num
     C                     KFLD           WQSK02           VCH Batch Numbe
     C                     KFLD           WQSK03           VCH Header Numb
      * Setup key
     C                     Z-ADDWAHNNB    WQSK01           VCH Company num
     C                     Z-ADDWALWNB    WQSK02           VCH Batch Numbe
     C                     Z-ADDWAG9NB    WQSK03           VCH Header Numb
      * Establish starting position
     C           KRSSK     SETLL@BLCPEP                    *
     C           KRSSK     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Net to Split amt to get Net amt before the split was calc'd.
      * (Split amount is negative in the voucher detail,header files)
     C           WCAMVA    SUB  WCCVPR    WUAMVA           VCD Net Amt
      * Calc net and gross for the splitee producer
     C           BFABPC    DIV  100       WUL9NB           Percent Decimal
     C                     MULT WUL9NB    WUAMVA    H      VCD Net Amt
     C                     Z-ADDWUAMVA    WUAKVA           VCD Gross Amt
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
     C                     EXSR SLCRRC
     C           KRSSK     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPEI
     C                     Z-ADDWCHNNB    BLHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWCDLNB    BLDLNB           VCD Line
     C                     Z-ADD*ZERO     BLCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     BLCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     BLCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     BLCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     BLCRPR           VCD LN Add on/D
     C                     Z-ADDWUAKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     BLALVA           VCD Deduction A
     C                     Z-ADD*ZERO     BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     BLAEPC           VCD Split Perce
     C                     MOVELWCI6ST    BLI6ST           VCD Payment Typ
     C                     MOVELWCJIST    BLJIST           VCD Hog Class T
     C                     MOVELWCJPST    BLJPST           VCD BO Type
     C                     MOVELWCC2SS    BLC2SS           VCD Source Cont
     C                     MOVELWCOTCD    BLOTCD           VCD Source Code
     C                     MOVELWCF5TX    BLF5TX           VCD Check Descr
     C                     Z-ADDWCL5A1    BLL5A1           VCD Received He
     C                     Z-ADDWCL6A1    BLL6A1           VCD Head Killed
     C                     MOVEL*BLANK    BLJQST           VCD Push Paymen
     C                     MOVELWCC4SS    BLC4SS           VCD Repayment F
     C                     MOVELWCC5SS    BLC5SS           VCD Unused Stat
     C                     MOVELWCC3SS    BLC3SS           VCD Unused Stat
     C                     Z-ADDWCOKA1    BLOKA1           VCD Unused Head
     C                     Z-ADDWCOLA1    BLOLA1           VCD UnUsed Head
     C                     Z-ADDWCOMA1    BLOMA1           VCD UnUsed Head
     C                     MOVELWCQ0CD    BLQ0CD           MGL Supplier In
     C                     Z-ADDWCWSA1    BLWSA1           MGL Voucher Num
     C                     Z-ADDWCWOA1    BLWOA1           MGL Invoice Bat
     C                     Z-ADDWCHFDT    BLHFDT           MGL Process to
     C                     Z-ADDWCB2TM    BLB2TM           MGL Process to
     C                     Z-ADDWCHMNB    BLHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    BLBONB           BOL Load Number
     C                     Z-ADDWCCVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    BLB0DT           TH Kill Date
     C                     MOVELWCABCD    BLABCD           PD Producer Cod
     C                     MOVELWCAECD    BLAECD           PL Location Cod
     C                     MOVELWCAAVN    BLAAVN           RS User Changed
     C                     Z-ADDWCAADT    BLAADT           RS Date Changed
     C                     Z-ADDWCAMTM    BLAMTM           RS Time Changed
     C                     MOVELWCAJST    BLAJST           RS Record Statu
     C                     MOVELWCAHVN    BLAHVN           RS Job
     C                     MOVELWCAGVN    BLAGVN           RS Program
     C                     MOVELWCABVN    BLABVN           RS User Added
     C                     Z-ADDWCABDT    BLABDT           RS Date Added
     C                     Z-ADDWCABTM    BLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL##USR     BLABVN           RS User Added
     C                     Z-ADD##JDT     BLABDT           RS Date Added
     C                     Z-ADD##JTM     BLABTM           RS Time Added
     C                     MOVEL##PGM     BLAGVN           RS Program
     C                     MOVEL##JOB     BLAHVN           RS Job
     C           KLCRSL    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCRSL    SETLL@BLCPEI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPEI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0004  30       BOH Company Num
     C                     PARM BLBNNB    WQ0005  70       BOH Buy Order N
     C                     PARM BLBONB    WQ0006  50       BOL Load Number
     C                     PARM BLCVNB    WQ0007  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0008  70       TH Kill Date
     C                     PARM *ZERO     WQ0009  50       TH Head Receive
     C                     PARM *ZERO     WQ0010  50       TH Held Over
     C                     PARM *ZERO     WQ0011  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0012  70       TH Voucher Paym
     C                     PARM 'CV'      WQ0013  2        Tattoo Action U
     C                     PARM *BLANK    WQ0014  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Accum TH Live Wt  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN A1ABCD    WQSM02           PD Producer Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           PD Producer Cod
      * Setup key
     C                     Z-ADD#1HNNB    WQSM01           BOH Company Num
     C                     MOVEL#1ABCD    WQSM02           PD Producer Cod
      * Establish starting position
     C           KRSSM     SETLL@A1CPN1                    *
     C           KRSSM     READE@A1CPN1                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  A1CYNB    WUH3NB           Weight Tot USR
     C           KRSSM     READE@A1CPN1                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Dtl f/Manual Chk  RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHNNB    WQSN01           VCH Company num
     C           *LIKE     DEFN WCLWNB    WQSN02           VCH Batch Numbe
     C           *LIKE     DEFN WCG9NB    WQSN03           VCH Header Numb
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           VCH Company num
     C                     KFLD           WQSN02           VCH Batch Numbe
     C                     KFLD           WQSN03           VCH Header Numb
      * Setup key
     C                     Z-ADD#1HNNB    WQSN01           VCH Company num
     C                     Z-ADD#1LWNB    WQSN02           VCH Batch Numbe
     C                     Z-ADD#1G9NB    WQSN03           VCH Header Numb
      * Establish starting position
     C           KRSSN     SETLL@BLCPEP                    *
     C           KRSSN     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUMBNB           Manual Chk Adj
      * Rtv Ttt,Crt ManualTtDA RT - Tattoo Header  * 
     C                     EXSR SORVGN
      * CASE: WRK.Manual Chk Adj Diff 2 USR is Not Zero
     C           WUMBNB    IFNE 0                          *IF
      * Set the +/- sign field
      * CASE: PAR.THD Unit Amt Sign is Add
     C           WUJBST    IFEQ '+'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MULT -1        WUMBNB           Manual Chk Adj
     C                     END                             *FI
     C           WCALVA    ADD  WUMBNB    WUALVA           VCD Deduction A
     C           WCAMVA    ADD  WUMBNB    WUAMVA           VCD Net Amt
      * Chg Voucher Detail    CH - Hog Voucher Detail  * 
     C                     EXSR SSCHRC
     C                     END                             *FI
     C           KRSSN     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Ttt,Crt ManualTtDA RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSO02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSO03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQSO04           TH Tattoo Numbe
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
     C                     KFLD           WQSO03           BOL Load Number
     C                     KFLD           WQSO04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWCHNNB    WQSO01           BOH Company Num
     C                     Z-ADDWCBNNB    WQSO02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQSO03           BOL Load Number
     C                     Z-ADDWCCVNB    WQSO04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSO     SETLL@A1CPC4                    *
     C           KRSSO     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Live Wgt EQ WRK.Zero USR
     C           WDCYNB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WDCYNB    DIV  100       WUL5NB           Live Hundred Wt
     C                     DIV  WUH3NB    WUL5NB           Live Hundred Wt
     C           WUL5NB    MULT WUL6NB    WUMBNB           Manual Chk Adj
     C                     ADD  WUMBNB    WUL7NB           Manual Chk Adj
      * CASE: PAR.Manual Chk Adj Diff 2 USR is Not Zero
     C           WUMBNB    IFNE 0                          *IF
      * Convert a negative adj. to positive for output-the sign field has
      * CASE: PAR.Manual Chk Adj Diff 2 USR is Less than 0
     C           WUMBNB    IFLT 0                          *IF
     C                     MULT -1        WUMBNB           Manual Chk Adj
     C                     END                             *FI
      * Rtv Ded GL Code       RT - Deduction/Addition  * 
     C                     EXSR SPRVGN
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SQCRRC
      * Adjust Net & Deduction or Add amounts on Tattoo Header
      * CASE: PAR.THD Unit Amt Sign is Add
     C           WUJBST    IFEQ '+'                        *IF
     C           WDA5VA    ADD  WUMBNB    WUA5VA           TH Additions Am
     C           WDCCPR    ADD  WUMBNB    WUCCPR           Th Payment Net
     C           WDCAPR    ADD  WUMBNB    WUCAPR           TH LIve Net Amt
     C                     Z-ADDWDA4VA    WUA4VA           TH Total Net WO
     C                     Z-ADDWDASPR    WUASPR           TH Deduction Am
     C                     ELSE
      * CASE: *OTHERWISE
     C           WDASPR    ADD  WUMBNB    WUASPR           TH Deduction Am
     C           WDA4VA    SUB  WUMBNB    WUA4VA           TH Total Net WO
     C           WDCCPR    SUB  WUMBNB    WUCCPR           Th Payment Net
     C           WDCAPR    SUB  WUMBNB    WUCAPR           TH LIve Net Amt
     C                     Z-ADDWDA5VA    WUA5VA           TH Additions Am
     C                     END                             *FI
      * Chg Net,D,A Amts      CH - Tattoo Header  * 
     C                     EXSR SRCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Ded GL Code       RT - Deduction/Addition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BBBQCD           DED D/A Code
      * Setup key
     C                     MOVE *BLANK    BBBQCD           DED D/A Code
     C                     MOVEL'MAN'     BBBQCD           DED D/A Code
      * Establish starting position
     C           KRSSP     CHAIN@BBRED5              90    *
      * Data record not found
     C   90                MOVEL'PRK0081' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBF7TX    WUF7TX           DED Gl Code
     C                     MOVELBBE2CD    WUE2CD           DED Contra Gl C
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWDHMNB    CDHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    CDBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    CDBONB           BOL Load Number
     C                     Z-ADDWDCVNB    CDCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    CDB0DT           TH Kill Date
     C                     MOVE *BLANK    CDBQCD           DED D/A Code
     C                     MOVEL'MAN'     CDBQCD           DED D/A Code
     C                     Z-ADDWUMBNB    CDAZVA           THD Unit Amt
     C                     Z-ADDWUMBNB    CDA0VA           THD Ded/Add Amo
     C                     MOVELWUJBST    CDJBST           THD Unit Amt Si
     C                     MOVEL'FL'      CDEIST           THD UOM
     C                     MOVEL'S'       CDJDST           THD Transaction
     C                     MOVELWUF7TX    CDDPCD           THD GL Code
     C                     MOVELWUE2CD    CDE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    CDAQNB           THD Re-imbursem
     C                     MOVELWDCWST    CDOCST           THD Payment Sts
     C                     MOVEL'P'       CDPEST           THD Expense Pai
     C                     MOVEL'O'       CDPFST           THD Expense Typ
     C                     MOVEL*BLANK    CDPGST           THD Reserve Acc
     C                     MOVEL*BLANK    CDPIST           THD Commission
     C                     MOVEL*BLANK    CDPJST           THD Deferred Pa
     C                     MOVEL*BLANK    CDPKST           THD Status 4
     C                     MOVEL*BLANK    CDPLST           THD Status 5
     C                     MOVEL*BLANK    CDAAVN           RS User Changed
     C                     Z-ADD*ZERO     CDAADT           RS Date Changed
     C                     Z-ADD*ZERO     CDAMTM           RS Time Changed
     C                     MOVEL'A'       CDAJST           RS Record Statu
     C                     MOVEL*BLANK    CDAHVN           RS Job
     C                     MOVEL*BLANK    CDAGVN           RS Program
     C                     MOVEL*BLANK    CDABVN           RS User Added
     C                     Z-ADD*ZERO     CDABDT           RS Date Added
     C                     Z-ADD*ZERO     CDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CDAJST           RS Record Statu
     C                     MOVEL##USR     CDABVN           RS User Added
     C                     Z-ADD##JDT     CDABDT           RS Date Added
     C                     Z-ADD##JTM     CDABTM           RS Time Added
     C                     MOVEL##PGM     CDAGVN           RS Program
     C                     MOVEL##JOB     CDAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           CDHMNB           BOH Company Num
     C                     KFLD           CDBNNB           BOH Buy Order N
     C                     KFLD           CDBONB           BOL Load Number
     C                     KFLD           CDCVNB           TH Tattoo Numbe
     C                     KFLD           CDB0DT           TH Kill Date
     C                     KFLD           CDBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Net,D,A Amts      CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  72       TH Live Gross A
     C                     MOVEL*BLANK    WN0006  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0007  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0008  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0009  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0010  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0011  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0012  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0013  50       TH Held Over
     C                     Z-ADD*ZERO     WN0014  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0015  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0016  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0017  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0018  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0019  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0020  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0021  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0023  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0024  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0025  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0026  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0030  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0031  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0032  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0033  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0034  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0035  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0036  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0037  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0039  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0040  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0041  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0042  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0043  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0044  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0045  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0046  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0047  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0048  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0049  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0050  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0051  1        TH Header Error
     C                     MOVEL*BLANK    WN0052  1        TH Detail Error
     C                     MOVEL*BLANK    WN0053  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0054  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0055  80       TH Commission A
     C                     Z-ADD*ZERO     WN0056  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0057  1        TH User Error O
     C                     MOVEL*BLANK    WN0058  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0059  1        TH Sex
     C                     Z-ADD*ZERO     WN0060  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0061  70       TH Commission P
     C                     Z-ADD*ZERO     WN0062  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0063  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0064  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0065  31       TH FFLI
     C                     Z-ADD*ZERO     WN0066  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0067  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0068  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0069  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0070  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0071  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0072  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0073  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0074  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0075  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0076  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0077  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0078  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0079  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0080  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0081  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0082  1        TH Source Type
     C                     MOVEL*BLANK    WN0083  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0084  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0085  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0086  3        TH Source Code
     C                     MOVEL*BLANK    WN0087  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0088  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0089  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0090  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0091  3        TH State
     C                     MOVEL*BLANK    WN0092  3        TH Unused Code
     C                     MOVEL*BLANK    WN0093  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0094  1        TH Commission S
     C                     MOVEL*BLANK    WN0095  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0096  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0097  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0098  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0099  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0100  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0101  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0102  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0103  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0104  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0105  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0106  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0107  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0108  3        TH PHA Average
     C                     MOVEL*BLANK    WN0109  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0110  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0111  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0112  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0113  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0114  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0115  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0116  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0117  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0118  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0119  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0120  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0121  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0122 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0123 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0124 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0125 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0126  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0127  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0128  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0129  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0130  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0131  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0132  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0133  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0134  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0135  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0136  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0137  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0138  70       TH Unused Date
     C                     MOVEL*BLANK    WN0139  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0140  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0141  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0142  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0143  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0144  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0145  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0146  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0147  6        DF Defect Code
     C                     MOVEL*BLANK    WN0148  6        THP Process Cod
     C                     MOVEL*BLANK    WN0149  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0150  6        PL Location Cod
     C                     MOVEL*BLANK    WN0151  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0152  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0153  3        HC Class Code
     C                     MOVEL*BLANK    WN0154 10        RS User Changed
     C                     Z-ADD*ZERO     WN0155  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0156  60       RS Time Changed
     C                     MOVEL*BLANK    WN0157  1        RS Record Statu
     C                     MOVEL*BLANK    WN0158 10        RS Job
     C                     MOVEL*BLANK    WN0159 10        RS Program
     C                     MOVEL*BLANK    WN0160 10        RS User Added
     C                     Z-ADD*ZERO     WN0161  70       RS Date Added
     C                     Z-ADD*ZERO     WN0162  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSR    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSR    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUCAPR    WECAPR           TH LIve Net Amt
     C                     Z-ADDWUASPR    WEASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WEA4VA           TH Total Net WO
     C                     Z-ADDWUA5VA    WEA5VA           TH Additions Am
     C                     Z-ADDWUCCPR    WECCPR           Th Payment Net
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Voucher Detail    CH - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BLCPEI
     C                     Z-ADDWCHNNB    BLHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWCDLNB    BLDLNB           VCD Line
      *
     C           KLCHSS    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
     C           KLCHSS    CHAIN@BLCPEI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBLCPL0'MDACP
     C                     MOVEL'@BLCPEI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @2DBRC    YCRDCS
      * Move non-key fields to @BLCPEI
     C                     Z-ADDWCCNPR    BLCNPR           VCD Base Mkt Pr
     C                     Z-ADDWCCOPR    BLCOPR           VCD Sort Disc A
     C                     Z-ADDWCCPPR    BLCPPR           VCD Yield Gain/
     C                     Z-ADDWCCQPR    BLCQPR           VCD Base Carcas
     C                     Z-ADDWCCRPR    BLCRPR           VCD LN Add on/D
     C                     Z-ADDWCAKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADDWUALVA    BLALVA           VCD Deduction A
     C                     Z-ADDWCCVPR    BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADDWCAEPC    BLAEPC           VCD Split Perce
     C                     MOVELWCI6ST    BLI6ST    P      VCD Payment Typ
     C                     MOVELWCJIST    BLJIST    P      VCD Hog Class T
     C                     MOVELWCJPST    BLJPST    P      VCD BO Type
     C                     MOVELWCC2SS    BLC2SS    P      VCD Source Cont
     C                     MOVELWCOTCD    BLOTCD    P      VCD Source Code
     C                     MOVELWCF5TX    BLF5TX    P      VCD Check Descr
     C                     Z-ADDWCL5A1    BLL5A1           VCD Received He
     C                     Z-ADDWCL6A1    BLL6A1           VCD Head Killed
     C                     MOVELWCJQST    BLJQST    P      VCD Push Paymen
     C                     MOVELWCC4SS    BLC4SS    P      VCD Repayment F
     C                     MOVELWCC5SS    BLC5SS    P      VCD Unused Stat
     C                     MOVELWCC3SS    BLC3SS    P      VCD Unused Stat
     C                     Z-ADDWCOKA1    BLOKA1           VCD Unused Head
     C                     Z-ADDWCOLA1    BLOLA1           VCD UnUsed Head
     C                     Z-ADDWCOMA1    BLOMA1           VCD UnUsed Head
     C                     MOVELWCQ0CD    BLQ0CD    P      MGL Supplier In
     C                     Z-ADDWCWSA1    BLWSA1           MGL Voucher Num
     C                     Z-ADDWCWOA1    BLWOA1           MGL Invoice Bat
     C                     Z-ADDWCHFDT    BLHFDT           MGL Process to
     C                     Z-ADDWCB2TM    BLB2TM           MGL Process to
     C                     Z-ADDWCHMNB    BLHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    BLBONB           BOL Load Number
     C                     Z-ADDWCCVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    BLB0DT           TH Kill Date
     C                     MOVELWCABCD    BLABCD    P      PD Producer Cod
     C                     MOVELWCAECD    BLAECD    P      PL Location Cod
     C                     MOVELWCAAVN    BLAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    BLAADT           RS Date Changed
     C                     Z-ADDWCAMTM    BLAMTM           RS Time Changed
     C                     MOVELWCAJST    BLAJST    P      RS Record Statu
     C                     MOVELWCAHVN    BLAHVN    P      RS Job
     C                     MOVELWCAGVN    BLAGVN    P      RS Program
     C                     MOVELWCABVN    BLABVN    P      RS User Added
     C                     Z-ADDWCABDT    BLABDT           RS Date Added
     C                     Z-ADDWCABTM    BLABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BLAAVN           RS User Changed
     C                     Z-ADD##JDT     BLAADT           RS Date Changed
     C                     Z-ADD##JTM     BLAMTM           RS Time Changed
     C                     MOVEL##JOB     BLAHVN           RS Job
     C                     MOVEL##PGM     BLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BLCPEI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv 1st Dtl f/ManlAdj RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHNNB    WQST01           VCH Company num
     C           *LIKE     DEFN WCLWNB    WQST02           VCH Batch Numbe
     C           *LIKE     DEFN WCG9NB    WQST03           VCH Header Numb
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           VCH Company num
     C                     KFLD           WQST02           VCH Batch Numbe
     C                     KFLD           WQST03           VCH Header Numb
      * Setup key
     C                     Z-ADD#1HNNB    WQST01           VCH Company num
     C                     Z-ADD#1LWNB    WQST02           VCH Batch Numbe
     C                     Z-ADD#1G9NB    WQST03           VCH Header Numb
      * Establish starting position
     C           KRSST     SETLL@BLCPEP                    *
     C           KRSST     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.THD Unit Amt Sign is Add
     C           WUJBST    IFEQ '+'                        *IF
     C           WCALVA    ADD  WUL6NB    WUALVA           VCD Deduction A
     C           WCAMVA    ADD  WUL6NB    WUAMVA           VCD Net Amt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WCALVA    SUB  WUL6NB    WUALVA           VCD Deduction A
     C           WCAMVA    SUB  WUL6NB    WUAMVA           VCD Net Amt
     C                     END                             *FI
      * Chg Voucher Detail    CH - Hog Voucher Detail  * 
     C                     EXSR SUCHRC
      * Rtv/Chg Net,D,A Amts  RT - Tattoo Header  * 
     C                     EXSR SVRVGN
      * Rtv Ded GL Code       RT - Deduction/Addition  * 
     C                     EXSR SXRVGN
      * Rtv/Chg Tattoo D/A    RT - Tattoo Ded/Add  * 
     C                     EXSR SYRVGN
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Voucher Detail    CH - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BLCPEI
     C                     Z-ADDWCHNNB    BLHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWCDLNB    BLDLNB           VCD Line
      *
     C           KLCHSU    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
     C           KLCHSU    CHAIN@BLCPEI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBLCPL0'MDACP
     C                     MOVEL'@BLCPEI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @2DBRC    YDRDCS
      * Move non-key fields to @BLCPEI
     C                     Z-ADDWCCNPR    BLCNPR           VCD Base Mkt Pr
     C                     Z-ADDWCCOPR    BLCOPR           VCD Sort Disc A
     C                     Z-ADDWCCPPR    BLCPPR           VCD Yield Gain/
     C                     Z-ADDWCCQPR    BLCQPR           VCD Base Carcas
     C                     Z-ADDWCCRPR    BLCRPR           VCD LN Add on/D
     C                     Z-ADDWCAKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADDWUALVA    BLALVA           VCD Deduction A
     C                     Z-ADDWCCVPR    BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADDWCAEPC    BLAEPC           VCD Split Perce
     C                     MOVELWCI6ST    BLI6ST    P      VCD Payment Typ
     C                     MOVELWCJIST    BLJIST    P      VCD Hog Class T
     C                     MOVELWCJPST    BLJPST    P      VCD BO Type
     C                     MOVELWCC2SS    BLC2SS    P      VCD Source Cont
     C                     MOVELWCOTCD    BLOTCD    P      VCD Source Code
     C                     MOVELWCF5TX    BLF5TX    P      VCD Check Descr
     C                     Z-ADDWCL5A1    BLL5A1           VCD Received He
     C                     Z-ADDWCL6A1    BLL6A1           VCD Head Killed
     C                     MOVELWCJQST    BLJQST    P      VCD Push Paymen
     C                     MOVELWCC4SS    BLC4SS    P      VCD Repayment F
     C                     MOVELWCC5SS    BLC5SS    P      VCD Unused Stat
     C                     MOVELWCC3SS    BLC3SS    P      VCD Unused Stat
     C                     Z-ADDWCOKA1    BLOKA1           VCD Unused Head
     C                     Z-ADDWCOLA1    BLOLA1           VCD UnUsed Head
     C                     Z-ADDWCOMA1    BLOMA1           VCD UnUsed Head
     C                     MOVELWCQ0CD    BLQ0CD    P      MGL Supplier In
     C                     Z-ADDWCWSA1    BLWSA1           MGL Voucher Num
     C                     Z-ADDWCWOA1    BLWOA1           MGL Invoice Bat
     C                     Z-ADDWCHFDT    BLHFDT           MGL Process to
     C                     Z-ADDWCB2TM    BLB2TM           MGL Process to
     C                     Z-ADDWCHMNB    BLHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    BLBONB           BOL Load Number
     C                     Z-ADDWCCVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    BLB0DT           TH Kill Date
     C                     MOVELWCABCD    BLABCD    P      PD Producer Cod
     C                     MOVELWCAECD    BLAECD    P      PL Location Cod
     C                     MOVELWCAAVN    BLAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    BLAADT           RS Date Changed
     C                     Z-ADDWCAMTM    BLAMTM           RS Time Changed
     C                     MOVELWCAJST    BLAJST    P      RS Record Statu
     C                     MOVELWCAHVN    BLAHVN    P      RS Job
     C                     MOVELWCAGVN    BLAGVN    P      RS Program
     C                     MOVELWCABVN    BLABVN    P      RS User Added
     C                     Z-ADDWCABDT    BLABDT           RS Date Added
     C                     Z-ADDWCABTM    BLABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BLAAVN           RS User Changed
     C                     Z-ADD##JDT     BLAADT           RS Date Changed
     C                     Z-ADD##JTM     BLAMTM           RS Time Changed
     C                     MOVEL##JOB     BLAHVN           RS Job
     C                     MOVEL##PGM     BLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BLCPEI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv/Chg Net,D,A Amts  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      * Establish starting position
     C           KRSSV     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Adjust Net & Deduction or Add amounts on Tattoo Header
      * CASE: PAR.THD Unit Amt Sign is Add
     C           WUJBST    IFEQ '+'                        *IF
     C           WDA5VA    ADD  WUL6NB    WUA5VA           TH Additions Am
     C           WDCCPR    ADD  WUL6NB    WUCCPR           Th Payment Net
     C           WDCAPR    ADD  WUL6NB    WUCAPR           TH LIve Net Amt
     C                     Z-ADDWDA4VA    WUA4VA           TH Total Net WO
     C                     Z-ADDWDASPR    WUASPR           TH Deduction Am
     C                     ELSE
      * CASE: *OTHERWISE
     C           WDASPR    ADD  WUL6NB    WUASPR           TH Deduction Am
     C           WDA4VA    SUB  WUL6NB    WUA4VA           TH Total Net WO
     C           WDCCPR    SUB  WUL6NB    WUCCPR           Th Payment Net
     C           WDCAPR    SUB  WUL6NB    WUCAPR           TH LIve Net Amt
     C                     Z-ADDWDA5VA    WUA5VA           TH Additions Am
     C                     END                             *FI
      * ** OLD:  Chg Tattoo Header   CH * Tattoo Header  ** (PKP)
      * Chg Net,D,A Amts      CH - Tattoo Header  * 
     C                     EXSR SWCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * Chg Net,D,A Amts      CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0163  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0164 10        TH Group Refere
     C                     MOVEL*BLANK    WN0165  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0166  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0167  72       TH Live Gross A
     C                     MOVEL*BLANK    WN0168  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0169  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0170  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0171  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0172  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0173  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0174  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0175  50       TH Held Over
     C                     Z-ADD*ZERO     WN0176  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0177  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0178  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0179  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0180  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0181  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0182  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0183  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0184  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0185  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0186  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0187  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0188  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0189  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0190  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0191  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0192  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0193  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0194  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0195  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0196  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0197  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0198  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0199  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0200  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0201  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0202  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0203  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0204  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0205  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0206  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0207  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0208  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0209  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0210  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0211  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0212  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0213  1        TH Header Error
     C                     MOVEL*BLANK    WN0214  1        TH Detail Error
     C                     MOVEL*BLANK    WN0215  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0216  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0217  80       TH Commission A
     C                     Z-ADD*ZERO     WN0218  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0219  1        TH User Error O
     C                     MOVEL*BLANK    WN0220  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0221  1        TH Sex
     C                     Z-ADD*ZERO     WN0222  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0223  70       TH Commission P
     C                     Z-ADD*ZERO     WN0224  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0225  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0226  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0227  31       TH FFLI
     C                     Z-ADD*ZERO     WN0228  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0229  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0230  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0231  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0232  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0233  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0234  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0235  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0236  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0237  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0238  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0239  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0240  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0241  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0242  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0243  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0244  1        TH Source Type
     C                     MOVEL*BLANK    WN0245  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0246  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0247  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0248  3        TH Source Code
     C                     MOVEL*BLANK    WN0249  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0250  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0251  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0252  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0253  3        TH State
     C                     MOVEL*BLANK    WN0254  3        TH Unused Code
     C                     MOVEL*BLANK    WN0255  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0256  1        TH Commission S
     C                     MOVEL*BLANK    WN0257  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0258  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0259  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0260  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0261  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0262  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0263  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0264  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0265  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0266  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0267  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0268  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0269  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0270  3        TH PHA Average
     C                     MOVEL*BLANK    WN0271  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0272  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0273  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0274  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0275  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0276  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0277  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0278  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0279  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0280  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0281  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0282  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0283  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0284 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0285 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0286 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0287 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0288  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0289  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0290  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0291  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0292  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0293  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0294  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0295  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0296  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0297  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0298  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0299  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0300  70       TH Unused Date
     C                     MOVEL*BLANK    WN0301  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0302  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0303  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0304  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0305  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0306  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0307  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0308  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0309  6        DF Defect Code
     C                     MOVEL*BLANK    WN0310  6        THP Process Cod
     C                     MOVEL*BLANK    WN0311  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0312  6        PL Location Cod
     C                     MOVEL*BLANK    WN0313  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0314  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0315  3        HC Class Code
     C                     MOVEL*BLANK    WN0316 10        RS User Changed
     C                     Z-ADD*ZERO     WN0317  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0318  60       RS Time Changed
     C                     MOVEL*BLANK    WN0319  1        RS Record Statu
     C                     MOVEL*BLANK    WN0320 10        RS Job
     C                     MOVEL*BLANK    WN0321 10        RS Program
     C                     MOVEL*BLANK    WN0322 10        RS User Added
     C                     Z-ADD*ZERO     WN0323  70       RS Date Added
     C                     Z-ADD*ZERO     WN0324  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSW    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSW    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUCAPR    WECAPR           TH LIve Net Amt
     C                     Z-ADDWUASPR    WEASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WEA4VA           TH Total Net WO
     C                     Z-ADDWUA5VA    WEA5VA           TH Additions Am
     C                     Z-ADDWUCCPR    WECCPR           Th Payment Net
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Ded GL Code       RT - Deduction/Addition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           BBBQCD           DED D/A Code
      * Setup key
     C                     MOVELWUBQCD    BBBQCD           DED D/A Code
      * Establish starting position
     C           KRSSX     CHAIN@BBRED5              90    *
      * Data record not found
     C   90                MOVEL'PRK0081' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBF7TX    WUDPCD           DED Gl Code
     C                     MOVELBBE2CD    WUE3CD           DED Contra Gl C
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tattoo D/A    RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWCHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WFBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WFB0DT           TH Kill Date
     C                     MOVELWUBQCD    WFBQCD           DED D/A Code
      * Establish starting position
     C           KRSSY     CHAIN@CDCPWX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SZCRRC
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFA0VA    ADD  WUL6NB    WUA0VA           THD Ded/Add Amo
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TACHRC
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWCHMNB    CDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    CDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    CDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    CDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    CDB0DT           TH Kill Date
     C                     MOVELWUBQCD    CDBQCD           DED D/A Code
     C                     Z-ADDWUL6NB    CDAZVA           THD Unit Amt
     C                     Z-ADDWUL6NB    CDA0VA           THD Ded/Add Amo
     C                     MOVELWUJBST    CDJBST           THD Unit Amt Si
     C                     MOVEL'FL'      CDEIST           THD UOM
     C                     MOVEL'S'       CDJDST           THD Transaction
     C                     MOVELWUDPCD    CDDPCD           THD GL Code
     C                     MOVELWUE3CD    CDE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    CDAQNB           THD Re-imbursem
     C                     MOVELWUCRTX    CDOCST           THD Payment Sts
     C                     MOVEL'P'       CDPEST           THD Expense Pai
     C                     MOVEL'O'       CDPFST           THD Expense Typ
     C                     MOVEL*BLANK    CDPGST           THD Reserve Acc
     C                     MOVEL*BLANK    CDPIST           THD Commission
     C                     MOVEL*BLANK    CDPJST           THD Deferred Pa
     C                     MOVEL*BLANK    CDPKST           THD Status 4
     C                     MOVEL*BLANK    CDPLST           THD Status 5
     C                     MOVEL*BLANK    CDAAVN           RS User Changed
     C                     Z-ADD*ZERO     CDAADT           RS Date Changed
     C                     Z-ADD*ZERO     CDAMTM           RS Time Changed
     C                     MOVEL'A'       CDAJST           RS Record Statu
     C                     MOVEL*BLANK    CDAHVN           RS Job
     C                     MOVEL*BLANK    CDAGVN           RS Program
     C                     MOVEL*BLANK    CDABVN           RS User Added
     C                     Z-ADD*ZERO     CDABDT           RS Date Added
     C                     Z-ADD*ZERO     CDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CDAJST           RS Record Statu
     C                     MOVEL##USR     CDABVN           RS User Added
     C                     Z-ADD##JDT     CDABDT           RS Date Added
     C                     Z-ADD##JTM     CDABTM           RS Time Added
     C                     MOVEL##PGM     CDAGVN           RS Program
     C                     MOVEL##JOB     CDAHVN           RS Job
     C           KLCRSZ    KLIST
     C                     KFLD           CDHMNB           BOH Company Num
     C                     KFLD           CDBNNB           BOH Buy Order N
     C                     KFLD           CDBONB           BOL Load Number
     C                     KFLD           CDCVNB           TH Tattoo Numbe
     C                     KFLD           CDB0DT           TH Kill Date
     C                     KFLD           CDBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWFHMNB    CDHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    CDBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    CDBONB           BOL Load Number
     C                     Z-ADDWFCVNB    CDCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    CDB0DT           TH Kill Date
     C                     MOVELWFBQCD    CDBQCD    P      DED D/A Code
      *
     C           KLCHTA    KLIST
     C                     KFLD           CDHMNB           BOH Company Num
     C                     KFLD           CDBNNB           BOH Buy Order N
     C                     KFLD           CDBONB           BOL Load Number
     C                     KFLD           CDCVNB           TH Tattoo Numbe
     C                     KFLD           CDB0DT           TH Kill Date
     C                     KFLD           CDBQCD           DED D/A Code
     C           KLCHTA    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YFRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWUA0VA    CDAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    CDA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    CDJBST    P      THD Unit Amt Si
     C                     MOVELWFEIST    CDEIST    P      THD UOM
     C                     MOVELWFJDST    CDJDST    P      THD Transaction
     C                     MOVELWFDPCD    CDDPCD    P      THD GL Code
     C                     MOVELWFE3CD    CDE3CD    P      THD Contra Gl C
     C                     Z-ADDWFAQNB    CDAQNB           THD Re-imbursem
     C                     MOVELWFOCST    CDOCST    P      THD Payment Sts
     C                     MOVELWFPEST    CDPEST    P      THD Expense Pai
     C                     MOVELWFPFST    CDPFST    P      THD Expense Typ
     C                     MOVELWFPGST    CDPGST    P      THD Reserve Acc
     C                     MOVELWFPIST    CDPIST    P      THD Commission
     C                     MOVELWFPJST    CDPJST    P      THD Deferred Pa
     C                     MOVELWFPKST    CDPKST    P      THD Status 4
     C                     MOVELWFPLST    CDPLST    P      THD Status 5
     C                     MOVELWFAAVN    CDAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    CDAADT           RS Date Changed
     C                     Z-ADDWFAMTM    CDAMTM           RS Time Changed
     C                     MOVELWFAJST    CDAJST    P      RS Record Statu
     C                     MOVELWFAHVN    CDAHVN    P      RS Job
     C                     MOVELWFAGVN    CDAGVN    P      RS Program
     C                     MOVELWFABVN    CDABVN    P      RS User Added
     C                     Z-ADDWFABDT    CDABDT           RS Date Added
     C                     Z-ADDWFABTM    CDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     CDAAVN           RS User Changed
     C                     Z-ADD##JDT     CDAADT           RS Date Changed
     C                     Z-ADD##JTM     CDAMTM           RS Time Changed
     C                     MOVEL##JOB     CDAHVN           RS Job
     C                     MOVEL##PGM     CDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADD#1HNNB    BKHNNB           VCH Company num
     C                     Z-ADD#1LWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADD#1G9NB    BKG9NB           VCH Header Numb
      *
     C           KLCHTB    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
     C           KLCHTB    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     GOTO TBEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YGRDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADD#1LXNB    BKLXNB           VCH AP Address
     C                     Z-ADD#1LYNB    BKLYNB           VCH AP Voucher
     C                     MOVEL#1CSST    BKCSST    P      VCH Payee Type
     C                     Z-ADD#1DKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADD#1A2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADD#1CIPR    BKCIPR           VCH Base Mkt Pr
     C                     Z-ADD#1CJPR    BKCJPR           VCH Sort Disc A
     C                     Z-ADD#1CKPR    BKCKPR           VCH Yield Gain/
     C                     Z-ADD#1CLPR    BKCLPR           VCH Base Carcas
     C                     Z-ADD#1CMPR    BKCMPR           VCH LN Add on/D
     C                     Z-ADD#1AUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADD#1AVVA    BKAVVA           VCH Deduction A
     C                     Z-ADD#1CHPR    BKCHPR           VCH Less Split
     C                     Z-ADD#1AJVA    BKAJVA           VCH Net Amt
     C                     Z-ADD#1BUPC    BKBUPC           VCH Split %
     C                     MOVEL#1JHST    BKJHST    P      VCH Split Check
     C                     MOVEL#1C0ST    BKC0ST    P      VCH Process Sta
     C                     Z-ADD#1A4DT    BKA4DT           VCH G/L Date
     C                     MOVEL#1CUST    BKCUST    P      VCH Check Type
     C                     MOVEL#1ABCD    BKABCD    P      PD Producer Cod
     C                     MOVEL#1BNCD    BKBNCD    P      TRK Trucker Cod
     C                     MOVEL#1CFCD    BKCFCD    P      VR Reason Code
     C                     MOVEL#1AAVN    BKAAVN    P      RS User Changed
     C                     Z-ADD#1AADT    BKAADT           RS Date Changed
     C                     Z-ADD#1AMTM    BKAMTM           RS Time Changed
     C                     MOVEL#1AJST    BKAJST    P      RS Record Statu
     C                     MOVEL#1AHVN    BKAHVN    P      RS Job
     C                     MOVEL#1AGVN    BKAGVN    P      RS Program
     C                     MOVEL#1ABVN    BKABVN    P      RS User Added
     C                     Z-ADD#1ABDT    BKABDT           RS Date Added
     C                     Z-ADD#1ABTM    BKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BKAAVN           RS User Changed
     C                     Z-ADD##JDT     BKAADT           RS Date Changed
     C                     Z-ADD##JTM     BKAMTM           RS Time Changed
     C                     MOVEL##JOB     BKAHVN           RS Job
     C                     MOVEL##PGM     BKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Voucher Detail    CH - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @BLCPEI
     C                     Z-ADD#2HNNB    BLHNNB           VCH Company num
     C                     Z-ADD#2LWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADD#2G9NB    BLG9NB           VCH Header Numb
     C                     Z-ADD#2DLNB    BLDLNB           VCD Line
      *
     C           KLCHTC    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
     C           KLCHTC    CHAIN@BLCPEI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBLCPL0'MDACP
     C                     MOVEL'@BLCPEI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #2DBRC    IFNE @2DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPKBLCPL0               91  *
     C                     GOTO TCEXIT
     C                     ENDIF                           FI #2DBRC
      * Store record data for null update check
     C                     MOVE @2DBRC    YHRDCS
      * Move non-key fields to @BLCPEI
     C                     Z-ADD#2CNPR    BLCNPR           VCD Base Mkt Pr
     C                     Z-ADD#2COPR    BLCOPR           VCD Sort Disc A
     C                     Z-ADD#2CPPR    BLCPPR           VCD Yield Gain/
     C                     Z-ADD#2CQPR    BLCQPR           VCD Base Carcas
     C                     Z-ADD#2CRPR    BLCRPR           VCD LN Add on/D
     C                     Z-ADD#2AKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADD#2ALVA    BLALVA           VCD Deduction A
     C                     Z-ADD#2CVPR    BLCVPR           VCD Less Split
     C                     Z-ADD#2AMVA    BLAMVA           VCD Net Amt
     C                     Z-ADD#2AEPC    BLAEPC           VCD Split Perce
     C                     MOVEL#2I6ST    BLI6ST    P      VCD Payment Typ
     C                     MOVEL#2JIST    BLJIST    P      VCD Hog Class T
     C                     MOVEL#2JPST    BLJPST    P      VCD BO Type
     C                     MOVEL#2C2SS    BLC2SS    P      VCD Source Cont
     C                     MOVEL#2OTCD    BLOTCD    P      VCD Source Code
     C                     MOVEL#2F5TX    BLF5TX    P      VCD Check Descr
     C                     Z-ADD#2L5A1    BLL5A1           VCD Received He
     C                     Z-ADD#2L6A1    BLL6A1           VCD Head Killed
     C                     MOVEL#2JQST    BLJQST    P      VCD Push Paymen
     C                     MOVEL#2C4SS    BLC4SS    P      VCD Repayment F
     C                     MOVEL#2C5SS    BLC5SS    P      VCD Unused Stat
     C                     MOVEL#2C3SS    BLC3SS    P      VCD Unused Stat
     C                     Z-ADD#2OKA1    BLOKA1           VCD Unused Head
     C                     Z-ADD#2OLA1    BLOLA1           VCD UnUsed Head
     C                     Z-ADD#2OMA1    BLOMA1           VCD UnUsed Head
     C                     MOVEL#2Q0CD    BLQ0CD    P      MGL Supplier In
     C                     Z-ADD#2WSA1    BLWSA1           MGL Voucher Num
     C                     Z-ADD#2WOA1    BLWOA1           MGL Invoice Bat
     C                     Z-ADD#2HFDT    BLHFDT           MGL Process to
     C                     Z-ADD#2B2TM    BLB2TM           MGL Process to
     C                     Z-ADD#2HMNB    BLHMNB           BOH Company Num
     C                     Z-ADD#2BNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADD#2BONB    BLBONB           BOL Load Number
     C                     Z-ADD#2CVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADD#2B0DT    BLB0DT           TH Kill Date
     C                     MOVEL#2ABCD    BLABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    BLAECD    P      PL Location Cod
     C                     MOVEL#2AAVN    BLAAVN    P      RS User Changed
     C                     Z-ADD#2AADT    BLAADT           RS Date Changed
     C                     Z-ADD#2AMTM    BLAMTM           RS Time Changed
     C                     MOVEL#2AJST    BLAJST    P      RS Record Statu
     C                     MOVEL#2AHVN    BLAHVN    P      RS Job
     C                     MOVEL#2AGVN    BLAGVN    P      RS Program
     C                     MOVEL#2ABVN    BLABVN    P      RS User Added
     C                     Z-ADD#2ABDT    BLABDT           RS Date Added
     C                     Z-ADD#2ABTM    BLABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BLAAVN           RS User Changed
     C                     Z-ADD##JDT     BLAADT           RS Date Changed
     C                     Z-ADD##JTM     BLAMTM           RS Time Changed
     C                     MOVEL##JOB     BLAHVN           RS Job
     C                     MOVEL##PGM     BLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BLCPEI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@2DBRC    #2DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Vch Hdr       RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WAHNNB           VCH Company num
     C                     KFLD           WALWNB           VCH Batch Numbe
     C                     KFLD           WAG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADD#1HNNB    WAHNNB           VCH Company num
     C                     Z-ADD#1LWNB    WALWNB           VCH Batch Numbe
     C                     Z-ADD#1G9NB    WAG9NB           VCH Header Numb
      * Establish starting position
     C           KRSTD     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Delete Check Header - Hog Voucher Header  * 
     C                     EXSR TEDLRC
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TEDLRC    BEGSR
      *================================================================
      * Delete Check Header - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BKCPEK
     C                     Z-ADDWAHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWALWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWAG9NB    BKG9NB           VCH Header Numb
      *
     C           KLDLTE    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
     C           KLDLTE    CHAIN@BKCPEK              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BKCPEK                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Vch Detail    RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHNNB    WQTF01           VCH Company num
     C           *LIKE     DEFN WCLWNB    WQTF02           VCH Batch Numbe
     C           *LIKE     DEFN WCG9NB    WQTF03           VCH Header Numb
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           VCH Company num
     C                     KFLD           WQTF02           VCH Batch Numbe
     C                     KFLD           WQTF03           VCH Header Numb
      * Setup key
     C                     Z-ADD#1HNNB    WQTF01           VCH Company num
     C                     Z-ADD#1LWNB    WQTF02           VCH Batch Numbe
     C                     Z-ADD#1G9NB    WQTF03           VCH Header Numb
      * Establish starting position
     C           KRSTF     SETLL@BLCPEP                    *
     C           KRSTF     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Voucher Detail - Hog Voucher Detail  * 
     C                     EXSR TGDLRC
      * Rtv/Dlt Tattoo D/A    RT - Tattoo Ded/Add  * 
     C                     EXSR THRVGN
      * Rtv/Chg Ttt D,A,Net   RT - Tattoo Header  * 
     C                     EXSR TJRVGN
     C           KRSTF     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGDLRC    BEGSR
      *================================================================
      * Delete Voucher Detail - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BLCPEI
     C                     Z-ADDWCHNNB    BLHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWCDLNB    BLDLNB           VCD Line
      *
     C           KLDLTG    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
     C           KLDLTG    CHAIN@BLCPEI              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBLCPL0'MDACP
     C                     MOVEL'@BLCPEI' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BLCPEI                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0032  30       BOH Company Num
     C                     PARM BLBNNB    WQ0033  70       BOH Buy Order N
     C                     PARM BLBONB    WQ0034  50       BOL Load Number
     C                     PARM BLCVNB    WQ0035  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0036  70       TH Kill Date
     C                     PARM *ZERO     WQ0037  50       TH Head Receive
     C                     PARM *ZERO     WQ0038  50       TH Held Over
     C                     PARM *ZERO     WQ0039  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0040  70       TH Voucher Paym
     C                     PARM 'DV'      WQ0041  2        Tattoo Action U
     C                     PARM *BLANK    WQ0042  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Tattoo D/A    RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQTH01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQTH02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQTH03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQTH04           TH Tattoo Numbe
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           BOH Company Num
     C                     KFLD           WQTH02           BOH Buy Order N
     C                     KFLD           WQTH03           BOL Load Number
     C                     KFLD           WQTH04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWCHMNB    WQTH01           BOH Company Num
     C                     Z-ADDWCBNNB    WQTH02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTH03           BOL Load Number
     C                     Z-ADDWCCVNB    WQTH04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTH     SETLL@CDCPIU                    *
     C           KRSTH     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD Transaction Created is System Created
     C           WGJDST    IFEQ 'S'                        *IF
      * Delete Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TIDLRC
     C                     END                             *FI
     C           KRSTH     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIDLRC    BEGSR
      *================================================================
      * Delete Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CDCPIT
     C                     Z-ADDWGHMNB    CDHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    CDBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    CDBONB           BOL Load Number
     C                     Z-ADDWGCVNB    CDCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    CDB0DT           TH Kill Date
     C                     MOVELWGBQCD    CDBQCD           DED D/A Code
      *
     C           KLDLTI    KLIST
     C                     KFLD           CDHMNB           BOH Company Num
     C                     KFLD           CDBNNB           BOH Buy Order N
     C                     KFLD           CDBONB           BOL Load Number
     C                     KFLD           CDCVNB           TH Tattoo Numbe
     C                     KFLD           CDB0DT           TH Kill Date
     C                     KFLD           CDBQCD           DED D/A Code
     C           KLDLTI    CHAIN@CDCPIT              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CDCPIT                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv/Chg Ttt D,A,Net   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQTJ01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQTJ02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQTJ03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQTJ04           TH Tattoo Numbe
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           BOH Company Num
     C                     KFLD           WQTJ02           BOH Buy Order N
     C                     KFLD           WQTJ03           BOL Load Number
     C                     KFLD           WQTJ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWCHMNB    WQTJ01           BOH Company Num
     C                     Z-ADDWCBNNB    WQTJ02           BOH Buy Order N
     C                     Z-ADDWCBONB    WQTJ03           BOL Load Number
     C                     Z-ADDWCCVNB    WQTJ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTJ     SETLL@A1CPC4                    *
     C           KRSTJ     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * Set Live Gross/Payment Gross/Accruals to Zeros and all net's to z
     C                     EXSR UASUBR                     Set Live Gross/
      * HPE053P - Include Dead Head Uom
      * Rtv Tattoo Hdr Totls RT - Tattoo Ded/Add  * 
     C                     EXSR TKRVGN
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
     C                     EXSR TLCHRC
     C           KRSTJ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Hdr Totls RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQTK01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQTK02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQTK03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQTK04           TH Tattoo Numbe
     C           *LIKE     DEFN WGB0DT    WQTK05           TH Kill Date
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           BOH Company Num
     C                     KFLD           WQTK02           BOH Buy Order N
     C                     KFLD           WQTK03           BOL Load Number
     C                     KFLD           WQTK04           TH Tattoo Numbe
     C                     KFLD           WQTK05           TH Kill Date
      * Setup key
     C                     Z-ADDWDHMNB    WQTK01           BOH Company Num
     C                     Z-ADDWDBNNB    WQTK02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQTK03           BOL Load Number
     C                     Z-ADDWDCVNB    WQTK04           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WQTK05           TH Kill Date
      * Establish starting position
     C           KRSTK     SETLL@CDCPIU                    *
     C           KRSTK     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Status Include Dead Hd is No, dont include Dead
      *   |- c2    : DB1.THD UOM is Dead Head UOM
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WGEIST    IFEQ 'CH'                       *IF
     C           WGEIST    OREQ 'DH'
     C           WGEIST    OREQ 'DY'
     C           WGEIST    OREQ 'YH'
     C           WGEIST    OREQ 'KH'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.THD Expense Paid by is Producer
     C           WGPEST    IFEQ 'P'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WGJBST    IFEQ '+'                        *IF
     C                     ADD  WGA0VA    WUA5VA           TH Additions Am
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WGA0VA    WUASPR           TH Deduction Am
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WGPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WGPFST    IFEQ 'F'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WGJBST    IFEQ '+'                        *IF
     C                     ADD  WGA0VA    WUMCPR           Freight Tot Ded
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WGA0VA    WUMCPR           Freight Tot Ded
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Type is Other
     C           WGPFST    IFEQ 'O'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WGJBST    IFEQ '+'                        *IF
     C                     ADD  WGA0VA    WUA7VA           TH Accrual Amou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WGA0VA    WUA7VA           TH Accrual Amou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTK     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0325  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0326 10        TH Group Refere
     C                     MOVEL*BLANK    WN0327  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0328  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0329  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0330  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0331  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0332  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0333  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0334  50       TH Held Over
     C                     Z-ADD*ZERO     WN0335  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0336  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0337  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0338  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0339  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0340  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0341  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0342  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0343  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0344  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0345  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0346  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0347  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0348  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0349  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0350  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0351  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0352  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0353  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0354  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0355  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0356  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0357  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0358  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0359  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0360  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0361  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0362  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0363  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0364  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0365  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0366  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0367  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0368  1        TH Header Error
     C                     MOVEL*BLANK    WN0369  1        TH Detail Error
     C                     MOVEL*BLANK    WN0370  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0371  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0372  80       TH Commission A
     C                     Z-ADD*ZERO     WN0373  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0374  1        TH User Error O
     C                     MOVEL*BLANK    WN0375  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0376  1        TH Sex
     C                     Z-ADD*ZERO     WN0377  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0378  70       TH Commission P
     C                     Z-ADD*ZERO     WN0379  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0380  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0381  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0382  31       TH FFLI
     C                     Z-ADD*ZERO     WN0383  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0384  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0385  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0386  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0387  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0388  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0389  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0390  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0391  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0392  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0393  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0394  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0395  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0396  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0397  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0398  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0399  1        TH Source Type
     C                     MOVEL*BLANK    WN0400  1        TH Scale Ticket
     C                     Z-ADD*ZERO     WN0401  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0402  3        TH Source Code
     C                     MOVEL*BLANK    WN0403  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0404  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0405  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0406  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0407  3        TH State
     C                     MOVEL*BLANK    WN0408  3        TH Unused Code
     C                     MOVEL*BLANK    WN0409  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0410  1        TH Commission S
     C                     MOVEL*BLANK    WN0411  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0412  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0413  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0414  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0415  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0416  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0417  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0418  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0419  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0420  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0421  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0422  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0423  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0424  3        TH PHA Average
     C                     MOVEL*BLANK    WN0425  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0426  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0427  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0428  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0429  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0430  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0431  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0432  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0433  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0434  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0435  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0436  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0437  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0438 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0439 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0440 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0441 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0442  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0443  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0444  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0445  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0446  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0447  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0448  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0449  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0450  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0451  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0452  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0453  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0454  70       TH Unused Date
     C                     MOVEL*BLANK    WN0455  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0456  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0457  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0458  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0459  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0460  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0461  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0462  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0463  6        DF Defect Code
     C                     MOVEL*BLANK    WN0464  6        THP Process Cod
     C                     MOVEL*BLANK    WN0465  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0466  6        PL Location Cod
     C                     MOVEL*BLANK    WN0467  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0468  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0469  3        HC Class Code
     C                     MOVEL*BLANK    WN0470 10        RS User Added
     C                     Z-ADD*ZERO     WN0471  70       RS Date Added
     C                     Z-ADD*ZERO     WN0472  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHTL    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHTL    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YIRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELWDCPST    WECPST    P      TH Live Purchas
     C                     Z-ADDWDACPR    WEACPR           TH Live Purchas
     C                     Z-ADDWUB9PR    WEB9PR           TH Live Gross A
     C                     Z-ADDWUCAPR    WECAPR           TH LIve Net Amt
     C                     Z-ADDWUASPR    WEASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WEA4VA           TH Total Net WO
     C                     Z-ADDWUATPR    WEATPR           TH Carcass Net
     C                     Z-ADDWUA5VA    WEA5VA           TH Additions Am
     C                     Z-ADDWUCBPR    WECBPR           TH Payment Gros
     C                     Z-ADDWUCCPR    WECCPR           Th Payment Net
     C                     Z-ADDWUA7VA    WEA7VA           TH Accrual Amou
     C                     MOVEL'C'       WEJWST    P      TH Calc Net Sts
     C                     MOVELWDJ9ST    WEJ9ST    P      TH Payment Type
     C                     MOVELWDAAVN    WEAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WEAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WEAMTM           RS Time Changed
     C                     MOVELWDAJST    WEAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WEAHVN    P      RS Job
     C                     MOVELWDAGVN    WEAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Vchr Split    RT - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHNNB    WQTM01           VCH Company num
     C           *LIKE     DEFN WHLWNB    WQTM02           VCH Batch Numbe
     C           *LIKE     DEFN WHG9NB    WQTM03           VCH Header Numb
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           VCH Company num
     C                     KFLD           WQTM02           VCH Batch Numbe
     C                     KFLD           WQTM03           VCH Header Numb
      * Setup key
     C                     Z-ADD#1HNNB    WQTM01           VCH Company num
     C                     Z-ADD#1LWNB    WQTM02           VCH Batch Numbe
     C                     Z-ADD#1G9NB    WQTM03           VCH Header Numb
      * Establish starting position
     C           KRSTM     SETLL@CACPII                    *
     C           KRSTM     READE@CACPII                  90*
      * Data record not found
     C   90                MOVEL'PRK0168' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Hog Check Split - Hog Voucher Split  * 
     C                     EXSR TNDLRC
     C           KRSTM     READE@CACPII                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNDLRC    BEGSR
      *================================================================
      * Delete Hog Check Split - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CACPIH
     C                     Z-ADDWHHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWHLWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWHG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWHBTCD    CABTCD           BOS Split Produ
     C                     MOVELWHABCD    CAABCD           PD Producer Cod
      *
     C           KLDLTN    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
     C           KLDLTN    CHAIN@CACPIH              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCACPL0'MDACP
     C                     MOVEL'@CACPIH' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CACPIH                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Set Live Gross/Payment Gross/Accruals to Zeros and all net's to
      *================================================================
     C                     Z-ADD*ZERO     WUB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WUCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WUCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WUCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * SDN440 rmc 2/9/22 get m3 live for split routine
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      * length from 5 to 7.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Producer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #1ABCD' defaulted for 'PD Producer Code'.
     C                     CALL 'PKA1SRR'              90  Sel Producer
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0027  6        PD Producer Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKA1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAAC    KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    ACABCD
     C           KLVAAC    CHAIN@ACREAI              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Producer               NF'
     C                     MOVEL'PRK0009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0009' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Trucker
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        TRK Trucker Cod
     C           YPMTFD    OREQ '#1BNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #1BNCD' defaulted for 'TRK Trucker Code'.
     C                     CALL 'PKDLSRR'              90  Sel Trucker
     C                     PARM *BLANK    W0RTN   7
     C           #1BNCD    PARM #1BNCD    WQ0028  3        TRK Trucker Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDLSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BNCD    IFNE *BLANK                     TRK Trucker Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BNCD    IFEQ *BLANK                     TRK Trucker Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBBA    KLIST
     C                     KFLD           BABNCD           TRK Trucker Cod
      * Setup key
     C                     MOVEL#1BNCD    BABNCD
     C           KLVBBA    CHAIN@BAREDS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Trucker                NF'
     C                     MOVEL'PRK0079' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0079' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Void Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        VR Reason Code
     C           YPMTFD    OREQ '#1CFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #1CFCD' defaulted for 'VR Reason Code'.
     C                     CALL 'PKDPSRR'              90  Sel Void Reason
     C                     PARM *BLANK    W0RTN   7
     C           #1CFCD    PARM #1CFCD    WQ0029  3        VR Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CFCD    IFNE *BLANK                     VR Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CFCD    IFEQ *BLANK                     VR Reason Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBM    KLIST
     C                     KFLD           BMCFCD           VR Reason Code
      * Setup key
     C                     MOVEL#1CFCD    BMCFCD
     C           KLVCBM    CHAIN@BMREEM              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Void Reason            NF'
     C                     MOVEL'PRK0103' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0103' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2ABCD    WK1X01  1
     C                     MOVEL#2AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#2ABCD'
     C           ##RR      ANDEQYPMRRN
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#2AECD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #2ABCD' defaulted for 'PD Producer Code'.
      * Field '(RCD) #2AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #2ABCD    PARM #2ABCD    WQ0030  6        PD Producer Cod
     C           #2AECD    PARM #2AECD    WQ0031  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #2ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #2AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAF    KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#2ABCD    AFABCD
     C                     MOVEL#2AECD    AFAECD
     C           KLVDAF    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD16        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PKRFETRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * Rtv/Dlt Vch Hdr       RT - Hog Voucher Header  * 
     C                     EXSR TDRVGN
      * Delete Voucher Detail and Delete Tattoo D/A records
      * Rtv/Dlt Vch Detail    RT - Hog Voucher Detail  * 
     C                     EXSR TFRVGN
      * Rtv/Dlt Vchr Split    RT - Hog Voucher Split  * 
     C                     EXSR TMRVGN
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3EUTX           Oms Name
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Manual Check Diff  USR
     C                     MOVEL*BLANK    WUJOST  1
      * Define work field Manual Chk Adj Diff   USR
     C                     Z-ADD*ZERO     WUL6NB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHNNB           VCH Company num
     C                     Z-ADD*ZERO     WALWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WAG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WALXNB           VCH AP Address
     C                     Z-ADD*ZERO     WALYNB           VCH AP Voucher
     C                     Z-ADD*ZERO     WADKNB           VCH Manual Chec
     C                     Z-ADD*ZERO     WAA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     WACIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WACJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WACKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WACLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WACMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     WAAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WAAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WACHPR           VCH Less Split
     C                     Z-ADD*ZERO     WAAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WABUPC           VCH Split %
     C                     Z-ADD*ZERO     WAA4DT           VCH G/L Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field VCH Deduction Amt
     C                     Z-ADD*ZERO     WUAVVA  92
      * Define work field VCH Net Amt
     C                     Z-ADD*ZERO     WUAJVA  92
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Net Amount           USR
     C                     Z-ADD*ZERO     WUA8VA  92
      * Define work field Percent Decimal       USR
     C                     Z-ADD*ZERO     WUL9NB  74
      * Define work field VCH Gross Amt
     C                     Z-ADD*ZERO     WUAUVA  92
      * Define work field VCH AP Address Number
     C                     Z-ADD*ZERO     WULXNB  80
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Define work field M3 Supplier ID
     C                     MOVEL*BLANK    WUQHCD 10
      * Define work field Text 7 USR
     C                     MOVEL*BLANK    WUSTTX  7
      * Define work field SR Type
     C                     MOVEL*BLANK    WUIXST  1
      * Define work field VCH Payee Type
     C                     MOVEL*BLANK    WUCSST  1
      * Define work field Header Number   USR
     C                     Z-ADD*ZERO     WUL4NB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHNNB           VCH Company num
     C                     Z-ADD*ZERO     WCLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WCG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WCDLNB           VCD Line
     C                     Z-ADD*ZERO     WCCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WCCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WCCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WCCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WCCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WCAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WCALVA           VCD Deduction A
     C                     Z-ADD*ZERO     WCCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WCAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WCAEPC           VCD Split Perce
     C                     Z-ADD*ZERO     WCL5A1           VCD Received He
     C                     Z-ADD*ZERO     WCL6A1           VCD Head Killed
     C                     Z-ADD*ZERO     WCOKA1           VCD Unused Head
     C                     Z-ADD*ZERO     WCOLA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WCOMA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WCWSA1           MGL Voucher Num
     C                     Z-ADD*ZERO     WCWOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     WCHFDT           MGL Process to
     C                     Z-ADD*ZERO     WCB2TM           MGL Process to
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field VCD Net Amt
     C                     Z-ADD*ZERO     WUAMVA  92
      * Define work field VCD Gross Amt
     C                     Z-ADD*ZERO     WUAKVA  92
      * Define work field Weight Tot USR
     C                     Z-ADD*ZERO     WUH3NB  71
      * Define work field Manual Chk Adj Total  USR
     C                     Z-ADD*ZERO     WUL7NB  71
      * Define work field THD Unit Amt Sign
     C                     MOVEL*BLANK    WUJBST  1
      * Define work field Manual Chk Adj Diff 2 USR
     C                     Z-ADD*ZERO     WUMBNB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Live Hundred Wt       USR
     C                     Z-ADD*ZERO     WUL5NB  71
      * Define work field DED Gl Code
     C                     MOVEL*BLANK    WUF7TX  8
      * Define work field DED Contra Gl Code
     C                     MOVEL*BLANK    WUE2CD  8
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field Th Payment Net Amt
     C                     Z-ADD*ZERO     WUCCPR  72
      * Define work field TH LIve Net Amt
     C                     Z-ADD*ZERO     WUCAPR  72
      * Define work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     WUA4VA  72
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field VCD Deduction Amt
     C                     Z-ADD*ZERO     WUALVA  92
      * Define work field DED D/A Code
     C                     MOVEL*BLANK    WUBQCD  5
      * Define work field THD GL Code
     C                     MOVEL*BLANK    WUDPCD  8
      * Define work field THD Contra Gl Code
     C                     MOVEL*BLANK    WUE3CD  8
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WFB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WFAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WFA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WFAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field THD Ded/Add Amount
     C                     Z-ADD*ZERO     WUA0VA  72
      * Define work field Status 1
     C                     MOVEL*BLANK    WUP4ST  1
      * Define work field Vendor Return Code Usr
     C                     MOVEL*BLANK    WUGUST  7
      * Define work field TH Live Gross Amt
     C                     Z-ADD*ZERO     WUB9PR  72
      * Define work field TH Payment Gross
     C                     Z-ADD*ZERO     WUCBPR  72
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Accrual Amount
     C                     Z-ADD*ZERO     WUA7VA  72
      * Define work field Freight Tot Ded/Add Exp
     C                     Z-ADD*ZERO     WUMCPR  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHNNB           VCH Company num
     C                     Z-ADD*ZERO     WHLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WHG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WHA6PC           BOS Split Perce
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0TRN   1        *Continue trans
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Live with M3   USR
     C                     MOVEL*BLANK    YL0001  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Subfile page size
     C                     Z-ADD05        ##SFPG  30       SFLPAG
      * Initialise subfile positioner
     C                     Z-ADD1         ##SFRC
      *
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UBSUBR                     Modifications a
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP3EVTX    ##CMP
     C                     Z-ADD*ZERO     WUA8VA           Net Amount
      *****************************************************************
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 NOT FOUND
