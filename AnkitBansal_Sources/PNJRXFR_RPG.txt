     H/TITLE Upd Item Prod Sched   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 06/15/09  Time  : 11:42:24
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     I@CWCPQW
      * PS Prod Item Inventory    Retrieval index
      * Renamed input format fields
     I              CWAIC3                          WAAIC3
     I              CWHGCD                          WAHGCD
     I              CWAJCD                          WAAJCD
     I              CWELDT                          WAELDT
     I              CWACWG                          WAACWG
     I              CWARQT                          WAARQT
     I              CWK7DT                          WAK7DT
     I              CWUVST                          WAUVST
     I              CWUWST                          WAUWST
     I              CWUXST                          WAUXST
     I              CWVSST                          WAVSST
     I              CWAATM                          WAAATM
     I              CWAYNA                          WAAYNA
     I              CWA0NA                          WAA0NA
     I              CWAXDT                          WAAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WCAIC3
     I              I8V5ST                          WCV5ST
     I              I8ELDT                          WCELDT
     I              I8HGCD                          WCHGCD
     I              I8AJCD                          WCAJCD
     I              I8GPDT                          WCGPDT
     I              I8WTSP                          WCWTSP
     I              I8QTSP                          WCQTSP
     I              I8DJPC                          WCDJPC
     I              I8F8WG                          WCF8WG
     I              I8WTIN                          WCWTIN
     I              I8D5NB                          WCD5NB
     I              I8DXWG                          WCDXWG
     I              I8B2NB                          WCB2NB
     I              I8WTCN                          WCWTCN
     I              I8PSCV                          WCPSCV
     I              I8SAWT                          WCSAWT
     I              I8B9NB                          WCB9NB
     I              I8D1WG                          WCD1WG
     I              I8CBNB                          WCCBNB
     I              I8EZWG                          WCEZWG
     I              I8CCNB                          WCCCNB
     I              I8E0WG                          WCE0WG
     I              I8D6NB                          WCD6NB
     I              I8OAWT                          WCOAWT
     I              I8CDNB                          WCCDNB
     I              I8UNW2                          WCUNW2
     I              I8CENB                          WCCENB
     I              I8F9WG                          WCF9WG
     I              I8BPNB                          WCBPNB
     I              I8GAWG                          WCGAWG
     I              I8BQNB                          WCBQNB
     I              I8GBWG                          WCGBWG
     I              I8BRNB                          WCBRNB
     I              I8GCWG                          WCGCWG
     I              I8BSNB                          WCBSNB
     I              I8GDWG                          WCGDWG
     I              I8BWNB                          WCBWNB
     I              I8GEWG                          WCGEWG
     I              I8PS6U                          WCPS6U
     I              I8WCST                          WCWCST
     I              I8WPST                          WCWPST
     I              I8B5ST                          WCB5ST
     I              I8TFST                          WCTFST
     I              I8TEST                          WCTEST
     I              I8THST                          WCTHST
     I              I8UDST                          WCUDST
     I              I8UFST                          WCUFST
     I              I8UGST                          WCUGST
     I              I8UHST                          WCUHST
     I              I8B6ST                          WCB6ST
     I              I8B7ST                          WCB7ST
     I              I8DVWG                          WCDVWG
     I              I8D7NB                          WCD7NB
     I              I8FCAD                          WCFCAD
     I              I8D9NB                          WCD9NB
     I              I8DWWG                          WCDWWG
     I              I8EANB                          WCEANB
     I              I8SHWT                          WCSHWT
     I              I8EBNB                          WCEBNB
     I              I8AVWT                          WCAVWT
     I              I8ECNB                          WCECNB
     I              I8WTON                          WCWTON
     I              I8EDNB                          WCEDNB
     I              I8FNWT                          WCFNWT
     I              I8EENB                          WCEENB
     I              I8QTAS                          WCQTAS
     I              I8EFNB                          WCEFNB
     I              I8WAIO                          WCWAIO
     I              I8EGNB                          WCEGNB
     I              I8R3CD                          WCR3CD
     I              I8RGNB                          WCRGNB
     I              I8RHNB                          WCRHNB
     I              I8RINB                          WCRINB
     I              I8XRCD                          WCXRCD
     I              I8UVST                          WCUVST
     I              I8UWST                          WCUWST
     I              I8UXST                          WCUXST
     I              I8VSST                          WCVSST
     I              I8AATM                          WCAATM
     I              I8AYNA                          WCAYNA
     I              I8A0NA                          WCA0NA
     I              I8AXDT                          WCAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WGAIC3
     I              AFBCDT                          WGBCDT
     I              AFCQNB                          WGCQNB
     I              AFESNB                          WGESNB
     I              AFETNB                          WGETNB
     I              AFBZNB                          WGBZNB
     I              AFA9ST                          WGA9ST
     I              AFEINB                          WGEINB
     I              AFC5ST                          WGC5ST
     I              AFAQNB                          WGAQNB
     I              AFCMST                          WGCMST
     I              AFV9ST                          WGV9ST
     I              AFWAST                          WGWAST
     I              AFX2ST                          WGX2ST
     I              AFOJDT                          WGOJDT
     I              AFNQNX                          WGNQNX
     I              AFNRNX                          WGNRNX
     I              AFI9SX                          WGI9SX
     I              AFJASX                          WGJASX
     I              AFOKDT                          WGOKDT
     I              AFOLDT                          WGOLDT
     I              AFUVST                          WGUVST
     I              AFUWST                          WGUWST
     I              AFUXST                          WGUXST
     I              AFAATM                          WGAATM
     I              AFAYNA                          WGAYNA
     I              AFA0NA                          WGA0NA
     I              AFAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Prod Item Inventory
      * I :  Company Number
     I                                    P   1   20P1AIC3
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Item Prod Sched   XF
      * Upd Item Prod Sched   RT - PS Prod Item Inventory  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Item Prod Sched   RT - PS Prod Item Inventory  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Item Code USR
     C                     MOVEL*BLANK    WN0002  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0003  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0004  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0005 132       Quantity On Han
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Item Code USR
     C                     MOVEL*BLANK    WN0002           Warehouse Code
     C                     Z-ADD*ZERO     WN0003           PS Weight Inv O
     C                     Z-ADD*ZERO     WN0004           PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0005           Quantity On Han
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@CWCPQW                    *
     C           KRSSA     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     Z-ADDWAHGCD    WN0001           Item Code USR
     C                     MOVELWAAJCD    WN0002           Warehouse Code
     C                     END                             *FI
      * CHG: Item Code or Warehouse
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Code USR NE DB1.Item Code
      *   |- c2    : PAR.Warehouse Code NE DB1.Warehouse Code
      *   '-
     C           WN0001    IFNE WAHGCD                     *IF
     C           WN0002    ORNE WAAJCD                     *OR
      * RTV Pces/Bag,Bag/Unit  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWN0001    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0002    P      Description Lin
     C                     Z-ADDWL0004    YL0003           Unit Weight
     C                     MOVELWL0005    YL0004    P      Piece Count Ite
     C                     Z-ADDWL0006    YL0005           Pieces Per Bag
     C                     Z-ADDWL0007    YL0006           Bags Per Unit
      * Pieces On-Hand
      * CASE: LCL.Piece Count Item is yes
     C           YL0004    IFEQ 'Y'                        *IF
      * PS Pieces Inv On-Hand
      * PAR.PS Pieces Inv On-Hand =
      *    *COMPUTE ((x1 * x2 * x3))
      * x1    : PAR.Quantity On Hand   USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Bags Per Unit
     C           WN0005    MULT YL0005    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           PS Pieces Inv O
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0004           PS Pieces Inv O
     C                     END                             *FI
      * BPS Upd Inv On Hand   RT - PS Prod Item Schedule  * 
     C                     EXSR SCRVGN
     C                     Z-ADD*ZERO     WN0003           PS Weight Inv O
     C                     Z-ADD*ZERO     WN0005           Quantity On Han
     C                     Z-ADDWAHGCD    WN0001           Item Code USR
     C                     MOVELWAAJCD    WN0002           Warehouse Code
     C                     END                             *FI
     C                     ADD  WAACWG    WN0003           PS Weight Inv O
     C                     ADD  WAARQT    WN0005           Quantity On Han
     C           KRSSA     READE@CWCPQW                  90*
     C                     ENDDO
      * USER: Exit processing
      * RTV Pces/Bag,Bag/Unit  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDWN0001    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0002    P      Description Lin
     C                     Z-ADDWL0004    YL0003           Unit Weight
     C                     MOVELWL0005    YL0004    P      Piece Count Ite
     C                     Z-ADDWL0006    YL0005           Pieces Per Bag
     C                     Z-ADDWL0007    YL0006           Bags Per Unit
      * CASE: LCL.Piece Count Item is yes
     C           YL0004    IFEQ 'Y'                        *IF
      * PS Pieces Inv On-Hand
      * PAR.PS Pieces Inv On-Hand =
      *    *COMPUTE ((x1 * x2 * x3))
      * x1    : PAR.Quantity On Hand   USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Bags Per Unit
     C           WN0005    MULT YL0005    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           PS Pieces Inv O
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0004           PS Pieces Inv O
     C                     END                             *FI
      * BPS Chg Inv On Hand   CH - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0015           Company Number
     C                     MOVEL'S'       WL0016    P      Production Type
     C                     Z-ADD##JDT     WL0017           Production Date
     C                     Z-ADDWN0001    WL0018           Item Code
     C                     MOVELWN0002    WL0019    P      Warehouse Code
     C                     Z-ADDWN0003    WL0020           PS Weight Inv O
     C                     Z-ADDWN0004    WL0021           PS Pieces Inv O
     C                     EXSR SICHRC
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Pces/Bag,Bag/Unit  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    WL0003           Description Lin
     C                     Z-ADDWBAIWG    WL0004           Unit Weight
     C                     MOVELWBPCCT    WL0005           Piece Count Ite
     C                     Z-ADDWBBDNB    WL0006           Pieces Per Bag
     C                     Z-ADDWBBJNB    WL0007           Bags Per Unit
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * BPS Upd Inv On Hand   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0007  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0008  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0009  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0010  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0011  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0012  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0015  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0016  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0017  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0018  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0019  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0020  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0021  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0022  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0023  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0024  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0025  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0026  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0027 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0028  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0029 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0030  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0031 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0032  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0033 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0034  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0035 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0036  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0037 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0038  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0039  3        PS Item Id
     C                     MOVEL*BLANK    WN0040  2        Warehouse Type
     C                     MOVEL*BLANK    WN0041  1        PS Lock Status
     C                     MOVEL*BLANK    WN0042  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0043  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0044  1        PS Piece Count
     C                     MOVEL*BLANK    WN0045  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0046  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0047  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0048  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0049  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0050  3        PS Production W
     C                     Z-ADD*ZERO     WN0051  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0052  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0053  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0054  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0055  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0056  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0057  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0058  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0059  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0060  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0061  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0062  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0063  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0064  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0065  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0066  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0067  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0068  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0069  6        Department Code
     C                     Z-ADD*ZERO     WN0070  30       Item Structure
     C                     Z-ADD*ZERO     WN0071  30       Item Structure
     C                     Z-ADD*ZERO     WN0072  30       Item Structure
     C                     MOVEL*BLANK    WN0073  6        Primal Group Co
     C                     MOVEL*BLANK    WN0074  1        EDI Status 1
     C                     MOVEL*BLANK    WN0075  1        EDI Status 2
     C                     MOVEL*BLANK    WN0076  1        EDI Status 3
     C                     MOVEL*BLANK    WN0077  1        Record Status
     C                     Z-ADD*ZERO     WN0078  60       Job Time
     C                     MOVEL*BLANK    WN0079 10        User Id
     C                     MOVEL*BLANK    WN0080 10        Job Name
     C                     Z-ADD*ZERO     WN0081  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV5ST           Production Type
     C                     KFLD           WCELDT           Production Date
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     MOVEL'S'       WCV5ST           Production Type
     C                     Z-ADD##JDT     WCELDT           Production Date
     C                     Z-ADDWN0001    WCHGCD           Item Code
     C                     MOVELWN0002    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0008    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    WN0050    P      Production Ware
     C                     Z-ADDWL0010    YN0001           Accounting Comp
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
     C                     EXSR SECRRC
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * BPS Chg Inv On Hand   CH - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0015           Company Number
     C                     MOVELWCV5ST    WL0016    P      Production Type
     C                     Z-ADDWCELDT    WL0017           Production Date
     C                     Z-ADDWCHGCD    WL0018           Item Code
     C                     MOVELWCAJCD    WL0019    P      Warehouse Code
     C                     Z-ADDWN0003    WL0020           PS Weight Inv O
     C                     Z-ADDWN0004    WL0021           PS Pieces Inv O
     C                     EXSR SICHRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0008    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Production Ware
     C                     Z-ADD*ZERO     WL0010           Accounting Comp
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAOCD    WL0009           Production Ware
     C                     Z-ADDWDBTC3    WL0010           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     MOVEL'S'       WEV5ST           Production Type
     C                     Z-ADD##JDT     WEELDT           Production Date
     C                     Z-ADDWN0001    WEHGCD           Item Code
     C                     MOVELWN0002    WEAJCD           Warehouse Code
     C                     Z-ADDWN0006    WEGPDT           PS Available Sh
     C                     Z-ADDWN0007    WEWTSP           PS Weight Plann
     C                     Z-ADDWN0008    WEQTSP           PS Pieces Plann
     C                     Z-ADDWN0009    WEDJPC           PS % of Carcass
     C                     Z-ADDWN0010    WEF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0003    WEWTIN           PS Weight Inv O
     C                     Z-ADDWN0004    WED5NB           PS Pieces Inv O
     C                     Z-ADDWN0011    WEDXWG           PS Weight Stand
     C                     Z-ADDWN0012    WEB2NB           PS Pieces Stand
     C                     Z-ADDWN0013    WEWTCN           PS Weight Conve
     C                     Z-ADDWN0014    WEPSCV           PS Pieces Conve
     C                     Z-ADDWN0015    WESAWT           PS Weight Shipp
     C                     Z-ADDWN0016    WEB9NB           PS Pieces Shipp
     C                     Z-ADDWN0017    WED1WG           PS Weight Prod
     C                     Z-ADDWN0018    WECBNB           PS Pieces Prod
     C                     Z-ADDWN0019    WEEZWG           PS Weight Inv A
     C                     Z-ADDWN0020    WECCNB           PS Pieces Inv A
     C                     Z-ADDWN0021    WEE0WG           PS Weight Ship
     C                     Z-ADDWN0022    WED6NB           PS Pieces Ship
     C                     Z-ADDWN0023    WEOAWT           PS Weight Prod
     C                     Z-ADDWN0024    WECDNB           PS Pieces Prod
     C                     Z-ADDWN0025    WEUNW2           PS Weight Inv A
     C                     Z-ADDWN0026    WECENB           PS Pieces Inv A
     C                     Z-ADDWN0027    WEF9WG           PS Unit Weight
     C                     Z-ADDWN0028    WEBPNB           PS Pieces Whse
     C                     Z-ADDWN0029    WEGAWG           PS Weight Whse
     C                     Z-ADDWN0030    WEBQNB           PS Pieces Unuse
     C                     Z-ADDWN0031    WEGBWG           PS Weight Unuse
     C                     Z-ADDWN0032    WEBRNB           PS Pieces Unuse
     C                     Z-ADDWN0033    WEGCWG           PS Weight Unuse
     C                     Z-ADDWN0034    WEBSNB           PS Pieces Unuse
     C                     Z-ADDWN0035    WEGDWG           PS Weight Unuse
     C                     Z-ADDWN0036    WEBWNB           PS Pieces Unuse
     C                     Z-ADDWN0037    WEGEWG           PS Weight Unuse
     C                     Z-ADDWN0038    WEPS6U           PS Pieces Unuse
     C                     MOVELWN0039    WEWCST           PS Item Id
     C                     MOVELWN0040    WEWPST           Warehouse Type
     C                     MOVELWN0041    WEB5ST           PS Lock Status
     C                     MOVELWN0042    WETFST           PS Export/Domes
     C                     MOVELWN0043    WETEST           PS Print On Sch
     C                     MOVELWN0044    WETHST           PS Piece Count
     C                     MOVELWN0045    WEUDST           PS Unused Sts 1
     C                     MOVELWN0046    WEUFST           PS Unused Sts 2
     C                     MOVELWN0047    WEUGST           PS Unused Sts 3
     C                     MOVELWN0048    WEUHST           PS Unused Sts 4
     C                     MOVELWN0049    WEB6ST           PS Item Sched N
     C                     MOVELWN0050    WEB7ST           PS Production W
     C                     Z-ADDWN0051    WEDVWG           PS Weight Order
     C                     Z-ADDWN0052    WED7NB           PS Pieces Order
     C                     Z-ADDWN0053    WEFCAD           PS Weight FC Ad
     C                     Z-ADDWN0054    WED9NB           PS Pieces FC Ad
     C                     Z-ADDWN0055    WEDWWG           PS Weight FX Ad
     C                     Z-ADDWN0056    WEEANB           PS Pieces FX Ad
     C                     Z-ADDWN0057    WESHWT           PS Weight Sched
     C                     Z-ADDWN0058    WEEBNB           PS Pieces Sched
     C                     Z-ADDWN0059    WEAVWT           PS Weight Avail
     C                     Z-ADDWN0060    WEECNB           PS Pieces Avail
     C                     Z-ADDWN0061    WEWTON           PS Weight Produ
     C                     Z-ADDWN0062    WEEDNB           PS Pieces Produ
     C                     Z-ADDWN0063    WEFNWT           PS Weight Fab N
     C                     Z-ADDWN0064    WEEENB           PS Pieces Fab N
     C                     Z-ADDWN0065    WEQTAS           PS Weight Sched
     C                     Z-ADDWN0066    WEEFNB           PS Pieces Sched
     C                     Z-ADDWN0067    WEWAIO           PS Weight Sched
     C                     Z-ADDWN0068    WEEGNB           PS Pieces Sched
     C                     MOVELWN0069    WER3CD           Department Code
     C                     Z-ADDWN0070    WERGNB           Item Structure
     C                     Z-ADDWN0071    WERHNB           Item Structure
     C                     Z-ADDWN0072    WERINB           Item Structure
     C                     MOVELWN0073    WEXRCD           Primal Group Co
     C                     MOVELWN0074    WEUVST           EDI Status 1
     C                     MOVELWN0075    WEUWST           EDI Status 2
     C                     MOVELWN0076    WEUXST           EDI Status 3
     C                     MOVELWN0077    WEVSST           Record Status
     C                     Z-ADDWN0078    WEAATM           Job Time
     C                     MOVELWN0079    WEAYNA           User Id
     C                     MOVELWN0080    WEA0NA           Job Name
     C                     Z-ADDWN0081    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0082 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR SFRVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR SGRVGN
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WEWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WEWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEAJCD    WL0008    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    WEB7ST    P      Production Ware
     C                     Z-ADDWL0010    YL0009           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0011           Company Number
     C                     Z-ADD##JDT     WL0012           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0013           Fresh Chilling
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    WEGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0011           Company Number
     C                     Z-ADD##JDT     WL0012           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0013           Fresh Chilling
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    WEGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0008    IFGT *ZERO                      *IF
     C           WN0007    DIV  WN0008    WEF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL'N'       WEB5ST           PS Lock Status
     C           KLCRSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSE    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WBAIC3           Company Number
     C                     Z-ADDWEHGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUADCD           U/M - Primary
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     MOVEL*BLANK    WUQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    WER3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    WETHST           Piece Count Ite
     C                     Z-ADD*ZERO     WUBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WUBJNB           Bags Per Unit
     C                     MOVEL*BLANK    WETFST           Export/Domestic
     C                     MOVEL*BLANK    WETEST           Print On Schedu
     C                     MOVEL*BLANK    WUSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    WUSZST           Fresh Sched As
     C                     MOVEL*BLANK    WUS1ST           Frozen Sched As
     C                     MOVEL*BLANK    WEXRCD           Primal Group Co
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    WUAVNA           Description Lin
     C                     MOVELWBADCD    WUADCD           U/M - Primary
     C                     Z-ADDWBAIWG    WUAIWG           Unit Weight
     C                     Z-ADDWBRINB    WERINB           Item Structure
     C                     Z-ADDWBRHNB    WERHNB           Item Structure
     C                     Z-ADDWBRGNB    WERGNB           Item Structure
     C                     MOVELWBN0CD    WUN0CD           Item Type Code
     C                     MOVELWBQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDWBCHTM    WUCHTM           Fresh Chilling
     C                     MOVELWBQZCD    WUQZCD           Base/Conv/Loss
     C                     MOVELWBXWST    WUXWST           Variety/Rendere
     C                     MOVELWBVMST    WUVMST           Credit Item Sta
     C                     Z-ADDWBSWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDWBPPHE    WUPPHE           Pieces Per Head
     C                     MOVELWBR3CD    WER3CD           Department Code
     C                     MOVELWBSDCD    WUSDCD           Group for Packa
     C                     MOVELWBX5ST    WUX5ST           Seconds Item
     C                     MOVELWBPCCT    WETHST           Piece Count Ite
     C                     Z-ADDWBBDNB    WUBDNB           Pieces Per Bag
     C                     Z-ADDWBBJNB    WUBJNB           Bags Per Unit
     C                     MOVELWBSUST    WETFST           Export/Domestic
     C                     MOVELWBSVST    WETEST           Print On Schedu
     C                     MOVELWBSYST    WUSYST           Fresh Inv Alloc
     C                     MOVELWBSZST    WUSZST           Fresh Sched As
     C                     MOVELWBS1ST    WUS1ST           Frozen Sched As
     C                     MOVELWBXRCD    WEXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELWEAJCD    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WEWPST           Warehouse Type
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUT0ST           Warehouse Locat
     C                     MOVEL*BLANK    WUT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     WUDBNB           Warehouse Chill
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFWPST    WEWPST           Warehouse Type
     C                     MOVELWFXUST    WUXUST           Trans Contol AS
     C                     MOVELWFT0ST    WUT0ST           Warehouse Locat
     C                     MOVELWFT1ST    WUT1ST           Warehouse Std C
     C                     Z-ADDWFDBNB    WUDBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WGBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
      * Setup key
     C                     Z-ADDWL0011    WQSH01           Company Number
     C                     Z-ADDWL0012    WGBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSH     SETLL@AFREBE                    *
     C           KRSSH     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DOC:  Change Log
     C                     EXSR UASUBR                     DOC:  Change Lo
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0013                     *IF
     C                     Z-ADDWGBCDT    WL0014           PS Available Sh
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
      * 04/10/07 PKD No offset, so do not check for Saturday.
      * 06/15/09 PKD FP1054 Saturday offset back in place.
      * Code for Saturday Offset
      * CASE: DB1.Day of Week is Saturday
     C           WGA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * ------ Code for no Offset -----
      * -------------------------------
     C           KRSSH     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * BPS Chg Inv On Hand   CH - PS Prod Item Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0083  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0084  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0085  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0086  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0087  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0088  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0089  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0090  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0091  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0092  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0093  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0094  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0095  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0096  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0097  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0098  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0099  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0100  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0101  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0102  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0103  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0104 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0105  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0106 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0107  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0108 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0109  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0110 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0111  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0112 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0113  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0114 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0115  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0116  3        PS Item Id
     C                     MOVEL*BLANK    WN0117  2        Warehouse Type
     C                     MOVEL*BLANK    WN0118  1        PS Lock Status
     C                     MOVEL*BLANK    WN0119  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0120  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0121  1        PS Piece Count
     C                     MOVEL*BLANK    WN0122  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0123  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0124  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0125  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0126  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0127  3        PS Production W
     C                     Z-ADD*ZERO     WN0128  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0129  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0130  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0131  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0132  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0133  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0134  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0135  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0136  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0137  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0138  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0139  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0140  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0141  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0142  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0143  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0144  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0145  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0146  6        Department Code
     C                     Z-ADD*ZERO     WN0147  30       Item Structure
     C                     Z-ADD*ZERO     WN0148  30       Item Structure
     C                     Z-ADD*ZERO     WN0149  30       Item Structure
     C                     MOVEL*BLANK    WN0150  6        Primal Group Co
     C                     MOVEL*BLANK    WN0151  1        EDI Status 1
     C                     MOVEL*BLANK    WN0152  1        EDI Status 2
     C                     MOVEL*BLANK    WN0153  1        EDI Status 3
     C                     MOVEL*BLANK    WN0154  1        Record Status
     C                     Z-ADD*ZERO     WN0155  60       Job Time
     C                     MOVEL*BLANK    WN0156 10        User Id
     C                     MOVEL*BLANK    WN0157 10        Job Name
     C                     Z-ADD*ZERO     WN0158  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWL0015    WEAIC3           Company Number
     C                     MOVELWL0016    WEV5ST    P      Production Type
     C                     Z-ADDWL0017    WEELDT           Production Date
     C                     Z-ADDWL0018    WEHGCD           Item Code
     C                     MOVELWL0019    WEAJCD    P      Warehouse Code
      *
     C           KLCHSI    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHSI    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWL0020    WEWTIN           PS Weight Inv O
     C                     Z-ADDWL0021    WED5NB           PS Pieces Inv O
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC:  Change Log
      *================================================================
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * 06/15/09 PKD FP1054 Skip Sunday's as Available Ship Date.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAACWG           Quantity on Han
     C                     Z-ADD*ZERO     WAARQT           Quantity on Han
     C                     Z-ADD*ZERO     WAK7DT           Label Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Production Lead
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WCWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WCQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WCDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WCF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WCWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WCD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WCDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WCB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WCWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WCPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WCSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WCB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WCD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WCCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WCEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WCCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WCE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WCD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WCOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WCCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WCUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WCCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WCF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WCBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WCGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WCBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WCPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WCDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WCD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WCFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WCD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WCDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WCEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WCSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WCEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WCECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WCWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WCEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WCFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WCEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WCQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WCEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WCEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WDBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Sched As Ordered
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WGCQNB           Julian Date
     C                     Z-ADD*ZERO     WGESNB           Accounting Year
     C                     Z-ADD*ZERO     WGETNB           Accounting Peri
     C                     Z-ADD*ZERO     WGBZNB           OM Week
     C                     Z-ADD*ZERO     WGEINB           Week Number
     C                     Z-ADD*ZERO     WGAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WGOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WGNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WGNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WGOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WGOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     Z-ADD*ZERO     WL0004 112
     C                     MOVEL*BLANK    WL0005  1
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  70
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  3
     C                     Z-ADD*ZERO     WL0010  30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  52
     C                     Z-ADD*ZERO     WL0014  70
      * Define local variables for subroutine SICHRC.
     C                     Z-ADD*ZERO     WL0015  30
     C                     MOVEL*BLANK    WL0016  1
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  3
     C                     Z-ADD*ZERO     WL0020  92
     C                     Z-ADD*ZERO     WL0021  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field Chilling Time USR
     C                     Z-ADD*ZERO     YL0008  52
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0009  30
      *================================================================
     CSR         ZZEXIT    ENDSR
