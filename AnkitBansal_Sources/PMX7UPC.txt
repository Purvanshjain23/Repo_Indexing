/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  RECEIVE PARAMETERS AND PASS TO SEQUEL VIEW          */
/*              TO CREATE A SPREADSHEET TABLE OF JAPANESE ORDERS    */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM ID- PMX7UPC                                             */
/*  PROGRAM   - CREATE AND EMAIL JAPANESE REPORTS-NO BROKER         */
/*  DATE      - 09/08/2008                                          */
/*  PROGRAMMER- LARA BUSER                                          */
/*  PROCESS   - 1. CREATE PMD4CPP IN QTEMP                          */
/*              2. RUN PMD4CPPVn TO COPY DISTINCT RECORDS TO GET    */
/*                 THE ORDER NUMBERS FOR THE PRICE CODES            */
/*              3. RUN JCO_Vn AND SAVE RESULTS AS PMD4JCOn IN QTEMP */
/*              4. RUN PMD4JCOVn TO CREATE A TABLE OF THE RECORDS   */
/*                 WITH TOTALS BY ITEM AND TOTALS BY PO#            */
/*              5. EMAIL RESULTING SPREADSHEET TO THE EMAIL         */
/*                 ADDRESS PASSED IN.                               */
/*              6. For category, run PMD4CPPVn TO BUILD THE AS400   */
/*                 WORK FILE, THE JCO_Vn TO BUILD THE SEQUEL        */
/*                 TEMP FILE, RUN PMD4JCOTn TO BUILD THE PIVOT      */
/*                 TABLE FOR THE SUMMARY BY ITEM TABLE THEN         */
/*                 RUN PMD4JCOS4T TO RUN THE CATEGORY TABLE         */
/*              7. EMAIL RESULTING SPREADSHEET REPORTS TO THE       */
/*                 EMAIL ADDRESS PASSED IN.                         */
/*              CPYF NEEDED TO CREATE TEMP FILE FIRST TIME THROUGH  */
/*                 then comment it out - QTEMP/PMD4JCO3             */
/*                                                                  */
/*  NOTES: EXECUTE VIEW(*LIBL/JCO_V3) OUTFILE(QTEMP/PMD4JCO3)       */
/*         EXECUTE VIEW(*LIBL/JCO_V4) OUTFILE(QTEMP/PMD4JCO4)       */
/*         THESE TWO SEQUELS BUILD WORKFILES IN QTEMP THAT ARE      */
/*         NOT A PART OF THE AS400.                                 */
/*         CPYF is needed to create the temp file first time through*/
/*                 then comment it out - QTEMP/PMD4JCO3             */
/*                                                                  */
/*         CHANGES MADE TO THIS PROGRAM MUST ALSO BE MADE TO        */
/*         PBJDUPC-CREATE AND EMAIL JAPANESE REPORTS-BROKER         */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*  I    &COMPN      - COMPANY NUMBER  15.5                         */
/*  I    &CUSTN      - CUSTOMER NUMBER 15.5                         */
/*  I    &FROMDTN    - SCHEDULED SHIP DATE BEGIN RANGE 15.5         */
/*  I    &TODTN      - SCHEDULED SHIP DATE END RANGE 15.5           */
/*  I    &FROMPRCDN  - FROM PRICE CODE                              */
/*  I    &TOPRCDN    - TO PRICE CODE                                */
/*  I    &EMAILADDR  - EMAIL ADDRESS                                */
/*  I    &RTNCDE     - RETURN CODE                                  */
/*  I    &SELECT     - SELECT REPORT TYPE - 1 THRU 8                */
/*  I    &BROKER     - BROKER CODE                                  */
/*  I    &WHSETYPE   - WAREHOUSE TYPE - FRESH OR FROZEN             */
/*  I    &MANTYPE    - MANIFEST TYPE  (SS = SUMMARY)                */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/* JBB 11/28/2018 E14027   Recompiled Only.  No source to compare.  */
/*     This program was not the issue.  The issue was a SQL view.   */
/* 09/19/2017 DN  E011527  UNDO &SELECT CHANGE FROM 2 BACK TO 1 BYTE*/
/*                         & CHANGED OPT 7 & 8 TO CLONE PMD4CPPV17  */
/*                         & PMD4CPPV16 AND REMOVED THE PRICE CODE  */
/*                         RESTRICTION.                             */
/* 08/25/2017 LJB E011527  SELECT FIELD CHANGED TO 2 CHAR.          */
/* 06/25/2015 LJB E004119  TEST ADDED TO CALLING PGM FOR            */
/*   LIVE WITH TPM. WHEN "YES" THEN OPTION 1,3,4 WILL NOT           */
/*   BE AVAILABLE                                                   */
/* 07/24/2014 LJB E003182  ADD ORDER NUMBER AND FROM AND THRU       */
/*   PO NUMBER SELECTIONS.                                          */
/* 11/07/2013 LJB E002854  ADD "PRINT MANIFEST SUMMARY" TO          */
/*   CONTRACT ORDERS MENU OPTION AS OPTION 5                        */
/* 06/12/2013 LJB E002587  CHANGE SHIP TO CUSTOMER TO BILL TO       */
/*   CUSTOMER. ADD SELECT BY WAREHOUSE TYPE: FRESH OR FROZEN.       */
/*   THIS CL IS FOR BROKER CODE = BLANKS. SEE PBJDUPC FOR BROKER.   */
/*   ** NOTE: PRICE CODE IS NOT BEING PASSED IN ANY LONGER.         */
/*   ** ENTIRE ORIGINAL CODE IS COPIED TO AFTER "END" TAG FOR       */
/*   ** DOCUMENTATION PURPOSES. ONLY CODE FOR PRICE CODE = ZEROS    */
/*   ** HAS BEEN LEFT IN THE EXECUTABLE PART OF THIS CLP            */
/* 03/26/2013 LJB E002519  FOR REPORTS 1 THRU 3, CREATE AND         */
/*   ADDITIONAL FORMAT. SAME REPORTS BUT WITHOUT THE PRICE CODES.   */
/*   PRICE CODES ARE NOW OPTIONAL. EVERYTHING ELSE WILL BE THE SAME.*/
/* 03/21/2012 LJB E001893  CHANGE TO SELECT BY COMPANY NUMBER       */
/*   AS WELL AS PRICE CODE.                                         */
/*   REPORTS 1 THRU 3 SELECT EITHER BY 1 CUSTOMER AND 1 COMPANY     */
/*   OR 1 CUSTOMER AND ALL COMPANIES (COMPANY=000). ALL VIEWS AND   */
/*   TABLES CHANGED TO REFLECT THIS. (SUMMARY IS ALREADY BY COMPANY)*/
/*   DATES ARE REQUESTED SHIP DATES ONLY.                           */
/* 04/30/2010 LJB E000227  ADD AN ADDITION TO OPTION 4 -            */
/*   THIS IS A SPREADSHEET BUILT FROM A PIVOT TABLE THAT DISPLAYS   */
/*   ITEMS SUMMARIZED BY CATEGORY. ONLY SELECTED ITEMS ARE          */
/*   INCLUDED. EMAIL WITH OPTION 4 REPORT.                          */
/* 03/03/2010 LJB E000227 ADD COMPANY NUMBER PARM. ADD NEW OPTION   */
/*   4 = SUMMARY REPORT BY CUSTOMER, ITEM FOR SELECTED COMPANY.     */
/*   THIS IS AN EXCEL SPREADSHEET BUILT FROM A PIVOT TABLE THAT     */
/*   IS CREATED IN SEQUEL.                                          */
/* 10/30/2009 LJB E00520  ADD 2 NEW REPORTS: #2 WILL BE THE SAME    */
/*   AS #1 BUT SELECT BY REQUESTED SHIP DATE AND PRINT QUANTITIES   */
/*   AND WEIGHTS ORDERED. #3 WILL BE BOTH ORDERED AND SHIPPED       */
/*   AS #1 BUT SELECT BY REQUESTED SHIP DATE AND PRINT QUANTITIES   */
/*   AND WEIGHTS ON THE SAME REPORT.                                */
/********************************************************************/
 PMX7UPC:    PGM        PARM(&COMPN &CUSTN &FROMDTN &TODTN &ORDERN +
                          &WHSETYPE &RTNCDE &PO#FILLED &BROKER +
                          &SELECT &OUTQ &HOLD &SAVE &COPYN &MANTYPE +
                          &PONBR &EMAILADDR)

             DCL        VAR(&CUSTN)     TYPE(*DEC)
             DCL        VAR(&CUST)      TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&CUSTA)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&COMPN)     TYPE(*DEC)
             DCL        VAR(&COMP)      TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&COMPA)     TYPE(*CHAR) LEN(3)
             DCL        VAR(&FROMDTN)   TYPE(*DEC)
             DCL        VAR(&FROMDT)    TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&FROMDTA)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&FDATE)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&TODTN)     TYPE(*DEC)
             DCL        VAR(&TODT)      TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&TODTA)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&TDATE)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&FROMPRCDN) TYPE(*DEC)
             DCL        VAR(&FROMPRCDE) TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&FROMPRCDA) TYPE(*CHAR) LEN(6)
             DCL        VAR(&TOPRCDE)   TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&TOPRCDN)   TYPE(*DEC)
             DCL        VAR(&TOPRCDA)   TYPE(*CHAR) LEN(6)
             DCL        VAR(&RTNCDE)    TYPE(*CHAR) LEN(7)
             DCL        VAR(&EMAILADDR) TYPE(*CHAR) LEN(50)
             DCL        VAR(&SELECT)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&EMSG)      TYPE(*CHAR) LEN(100)
             DCL        VAR(&EMSG2)     TYPE(*CHAR) LEN(100)
             DCL        VAR(&EMSG3)     TYPE(*CHAR) LEN(100)
             DCL        VAR(&EMSG4)     TYPE(*CHAR) LEN(100)
             DCL        VAR(&WHSETYPE)  TYPE(*CHAR) LEN(2)
             DCL        VAR(&BROKER)    TYPE(*CHAR) LEN(6)
             DCL        VAR(&APPLIC)    TYPE(*CHAR) LEN(06)
             DCL        VAR(&MANTYPE)   TYPE(*CHAR) LEN(2)
             DCL        VAR(&DESC)      TYPE(*CHAR) LEN(25)
             DCL        VAR(&COPYN)     TYPE(*DEC)
             DCL        VAR(&OUTQ)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD)      TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE)      TYPE(*CHAR) LEN(4)
             DCL        VAR(&NQSTAT)    TYPE(*CHAR) LEN(01)
             DCL        VAR(&NIGHTQ)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&ORDERN)    TYPE(*DEC)
             DCL        VAR(&ORDER)     TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&ORDERA)    TYPE(*CHAR) LEN(7)
             DCL        VAR(&PONBR)     TYPE(*CHAR) LEN(15)
             DCL        VAR(&PO#FILLED) TYPE(*CHAR) LEN(15)

             MONMSG     MSGID(CPF0000 QRY0000)
             GOTO       CMDLBL(CHGVAR)

/*** FOR TESTING PURPOSES, SKIPPED FOR PROD +
             RMVLIBLE   LIB(PRKDEVQRY)      +
             ADDLIBLE   LIB(PRKDEVQRY)      ******/

/* SET ALPHA VALUES FOR THE SETVAR PARM IN THE EXECUTE COMMAND       */
 CHGVAR:     CHGVAR     VAR(&CUST) VALUE(&CUSTN)
             CHGVAR     VAR(&CUSTA) VALUE(&CUST)
             CHGVAR     VAR(&COMP) VALUE(&COMPN)
             CHGVAR     VAR(&COMPA) VALUE(&COMP)
             CHGVAR     VAR(&ORDER) VALUE(&ORDERN)
             CHGVAR     VAR(&ORDERA) VALUE(&ORDER)
             CHGVAR     VAR(&FROMPRCDE) VALUE(&FROMPRCDN)
             CHGVAR     VAR(&FROMPRCDA) VALUE(&FROMPRCDE)
             CHGVAR     VAR(&TOPRCDE) VALUE(&TOPRCDN)
             CHGVAR     VAR(&TOPRCDA) VALUE(&TOPRCDE)

             IF         COND(&FROMDTN *GT 0) THEN(DO)
             CHGVAR     VAR(&FROMDT) VALUE(&FROMDTN)
             CHGVAR     VAR(&FROMDTA) VALUE(&FROMDT)
             CVTDAT     DATE(&FROMDTA) TOVAR(&FDATE) FROMFMT(*CYMD) +
                          TOFMT(*MDYY) TOSEP('/')
             ENDDO

             IF         COND(&TODTN *GT 0) THEN(DO)
             CHGVAR     VAR(&TODT) VALUE(&TODTN)
             CHGVAR     VAR(&TODTA) VALUE(&TODT)
             CVTDAT     DATE(&TODTA) TOVAR(&TDATE) FROMFMT(*CYMD) +
                          TOFMT(*MDYY) TOSEP('/')
             ENDDO

             CHGVAR     VAR(&EMSG) VALUE('Customer:' *BCAT &CUSTA +
                          *BCAT 'for ship date range:' *BCAT &FDATE +
                          *BCAT 'through' *BCAT &TDATE)

             CHGVAR     VAR(&EMSG2) VALUE('Customer:' *BCAT &CUSTA +
                          *BCAT 'Company:' *BCAT &COMPA *BCAT 'for +
                          ship date range:' *BCAT &FDATE *BCAT +
                          'through' *BCAT &TDATE)

             CHGVAR     VAR(&EMSG3) VALUE('Customer:' *BCAT &CUSTA +
                          *BCAT 'Order#:' *BCAT &ORDERA)

             CHGVAR     VAR(&EMSG4) VALUE('Customer:' *BCAT &CUSTA +
                          *BCAT 'Purchase Order#:' *BCAT &PONBR)

/* CREATE PMD4CPP WF CUSTOMER PRICE HEADER IN QTEMP                  */

             DLTF       FILE(QTEMP/PMD4CPP)
             MONMSG     MSGID(CPF9999)
             CRTDUPOBJ  OBJ(PMD4CPP) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMD4CPP) CST(*NO) +
                          TRG(*NO)
             MONMSG     MSGID(CPF9999)
             CHGPF      FILE(PMD4CPP) LVLCHK(*NO)
             MONMSG     MSGID(CPF9999)
             CLRPFM     FILE(QTEMP/PMD4CPP)
             MONMSG     MSGID(CPF9999)
             CRTDUPOBJ  OBJ(PMD4CPL0) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMD4CPL0) CST(*NO) +
                          TRG(*NO)
             MONMSG     MSGID(CPF0000)

             CRTDUPOBJ  OBJ(PMD4CPL1) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMD4CPL1) CST(*NO) +
                          TRG(*NO)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(PMD4CPL2) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMD4CPL2) CST(*NO) +
                          TRG(*NO)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(PMD4CPL3) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMD4CPL3) CST(*NO) +
                          TRG(*NO)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(PMD4CPL4) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMD4CPL4) CST(*NO) +
                          TRG(*NO)
             MONMSG     MSGID(CPF0000)

/* #######                                                           */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* CREATE DATA IN PMD4CPP TO GET ORDER #'S ASSOCIATED                */
/* WITH THE BILL TO'S,   THIS WAY THE ITEMS ADDED AS "MAN" WILL      */
/* BE INCLUDED IN THE REPORT. DATES ARE REQUESTED SHIP DATE.         */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 1 = ITEMS SHIPPED FOR ALL COMPANIES-1 CUSTOMER        */
/*                 ACTUAL SHIPPED DATE                               */
/*                 WAREHOUSE TYPE ADDED   E002587                    */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&SELECT *EQ '1') THEN(DO)
             IF         COND(&COMP *EQ 000) THEN(DO)

/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(JCO_V3)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(JCO_V3)
             ENDDO

/*   IF NOT FOR 1 ORDER OR 1 PO THEN POPULATE WORK FILE FOR A        */
/*   DATE RANGE                                                      */
             EXECUTE    VIEW(*LIBL/PMD4CPPV5) OUTFILE(QTEMP/PMD4CPP) +
                          SETVAR((&CUST &CUSTA) (&FROMDT &FROMDTA) +
                          (&TODT &TODTA) (&WHSETYPE &WHSETYPE))
/*********   CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)        ****/

/* CREATE A TEMP FILE OF THE ORDER HEADER AND DETAIL RECORDS FOR     */
/* THE REQUESTED ORDERS. ADD COMPANY NUMBER TO JCO_V3  E001893       */
 JCO_V3:     EXECUTE    VIEW(*LIBL/JCO_V3) OUTFILE(QTEMP/PMD4JCO3)

/********    CPYF       FROMFILE(QTEMP/PMD4JCO3) +
                          TOFILE(OMSDEVGEN/PMD4JCO3SV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)     *********/

/* BUILD A TABLE OF ALL THE PURCHASE ORDER ITEMS FOR THE REQUESTED   */
/* PRICE CODES AND TOTAL THE P.O.'S AND THE ITEMS. CREATE AN         */
/* EXCEL SPREADSHEET OF THE RESULTS AND EMAIL                        */
/* ADD COMPANY NUMBER TO PMD4JCOVT                      E001893      */
             EXECUTE    VIEW(*LIBL/PMD4JCOVT) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG)
             MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                          VAR(&RTNCDE) VALUE(CPF9999))
             ENDDO      /* End REPORT = 1 AND COMPANY = 000 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 1 = ITEMS SHIPPED,1 CUSTOMER, 1 COMPANY               */
/*                 BY ACTUAL SHIPPED DATE                            */
/*                 WAREHOUSE TYPE ADDED   E002587                    */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&COMP *NE 000) THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(JCO_V3B)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(JCO_V3B)
             ENDDO

/*   IF NOT FOR 1 ORDER OR 1 PURCHASE ORDER NUMBER THEN              */
/*   POPULATE THE WORK FILE FOR A DATE RANGE                         */
             EXECUTE    VIEW(*LIBL/PMD4CPPV6) OUTFILE(QTEMP/PMD4CPP) +
                          SETVAR((&CUST &CUSTA) (&FROMDT &FROMDTA) +
                          (&TODT &TODTA) (&COMP &COMPA) (&WHSETYPE +
                          &WHSETYPE))
/******      CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES) ********/

/* CREATE A TEMP FILE OF THE ORDER HEADER AND DETAIL RECORDS FOR     */
/* THE REQUESTED PRICE CODES. ADD COMPANY NUMBER TO JCO_V3  E001893  */
 JCO_V3B:    EXECUTE    VIEW(*LIBL/JCO_V3) OUTFILE(QTEMP/PMD4JCO3)

/*****       CPYF       FROMFILE(QTEMP/PMD4JCO3) +
                          TOFILE(OMSDEVGEN/PMD4JCO3SV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)    *********/

/* BUILD A TABLE OF ALL THE PURCHASE ORDER ITEMS FOR THE REQUESTED   */
/* PRICE CODES AND TOTAL THE P.O.'S AND THE ITEMS. CREATE AN         */
/* EXCEL SPREADSHEET OF THE RESULTS AND EMAIL                        */
/* ADD COMPANY NUMBER TO PMD4JCOVT                      E001893      */
             EXECUTE    VIEW(*LIBL/PMD4JCOVT) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG)
             MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                          VAR(&RTNCDE) VALUE(CPF9999))
             ENDDO      /* End REPORT = 1 AND COMPANY <> 000 */

             ENDDO      /* End Select Report Type = 1 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 2 = ITEMS ORDERED,1 CUSTOMER, ALL COMPANIES           */
/*                 BY REQUESTED SHIP DATE                            */
/*                 WAREHOUSE TYPE ADDED   E002587                    */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&SELECT *EQ '2') THEN(DO)
             IF         COND(&COMP *EQ 000) THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(JCO_V3C)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(JCO_V3C)
             ENDDO

/*   IF NOT FOR 1 ORDER OR 1 PO THEN BUILD WORK FILE FOR A           */
/*   DATE RANGE                                                      */

             EXECUTE    VIEW(*LIBL/PMD4CPPV7) OUTFILE(QTEMP/PMD4CPP) +
                          SETVAR((&CUST &CUSTA) (&FROMDT &FROMDTA) +
                          (&TODT &TODTA) (&WHSETYPE &WHSETYPE))
/*******     CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  *********/

/* CREATE A TEMP FILE OF THE ORDER HEADER AND DETAIL RECORDS FOR     */
/* THE REQUESTED PRICE CODES                                         */
 JCO_V3C:    EXECUTE    VIEW(*LIBL/JCO_V3) OUTFILE(QTEMP/PMD4JCO3)

/* Save the temp file records for testing and validation purposes    */
/********       CPYF       FROMFILE(QTEMP/PMD4JCO3)     +
                             TOFILE(OMSDEVGEN/PMD4JCO3SV) +
                             MBROPT(*REPLACE) CRTFILE(*YES)  *******/

/* BUILD A TABLE OF ALL THE PURCHASE ORDER ITEMS FOR THE REQUESTED   */
/* PRICE CODES AND TOTAL THE P.O.'S AND THE ITEMS. CREATE AN         */
/* EXCEL SPREADSHEET OF THE RESULTS AND EMAIL                        */
/* ADD COMPANY NUMBER TO PMD4JCOT2                      E001893      */
                EXECUTE    VIEW(*LIBL/PMD4JCOT2) PCFMT(*XLS) +
                             RECIPIENT(&EMAILADDR) EMLMSG(&EMSG)
                MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                             VAR(&RTNCDE) VALUE(CPF9999))
                ENDDO      /* End REPORT TYPE = 2 AND CO# = 000 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 2 = ITEMS ORDERED,1 CUSTOMER, 1 COMPANY               */
/*                 BY REQUESTED SHIP DATE                            */
/*                 WAREHOUSE TYPE ADDED   E002587                    */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&COMP *NE 000) THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(JCO_V3D)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(JCO_V3D)
             ENDDO

/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR CUSTOMER,  */
/*   COMPANY, AND A DATE RANGE                                       */
             EXECUTE    VIEW(*LIBL/PMD4CPPV8) OUTFILE(QTEMP/PMD4CPP) +
                          SETVAR((&CUST &CUSTA) (&FROMDT &FROMDTA) +
                          (&TODT &TODTA) (&COMP &COMPA) (&WHSETYPE +
                          &WHSETYPE))
/******      CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)         ****/

/* CREATE A TEMP FILE OF THE ORDER HEADER AND DETAIL RECORDS FOR     */
/* THE REQUESTED PRICE CODES                                         */
 JCO_V3D:    EXECUTE    VIEW(*LIBL/JCO_V3) OUTFILE(QTEMP/PMD4JCO3)

/**********     CPYF       FROMFILE(QTEMP/PMD4JCO3)      +
                             TOFILE(OMSDEVGEN/PMD4JCO3SV)  +
                             MBROPT(*REPLACE) CRTFILE(*YES)      *****/

/* BUILD A TABLE OF ALL THE PURCHASE ORDER ITEMS FOR THE REQUESTED   */
/* ORDERS AND TOTAL THE P.O.'S AND THE ITEMS. CREATE AN EXCEL        */
/* SPREADSHEET OF THE RESULTS AND EMAIL.                             */
/* ADD COMPANY NUMBER TO PMD4JCOT2                      E001893      */
                EXECUTE    VIEW(*LIBL/PMD4JCOT2) PCFMT(*XLS) +
                             RECIPIENT(&EMAILADDR) EMLMSG(&EMSG)
                MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                             VAR(&RTNCDE) VALUE(CPF9999))
                ENDDO      /* End REPORT TYPE = 2 AND CO# <> 000 */

             ENDDO      /* End Select Report Type = 2 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 3 = BY ORDERED VS SHIPPED, 1 CUSTOMER, ALL COMPANIES  */
/*                 BY ACTUAL SHIP DATE.                              */
/*                 WAREHOUSE TYPE ADDED   E002587                    */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&SELECT *EQ '3') THEN(DO)
             IF         COND(&COMP *EQ 000) THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(JCO_V3E)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(JCO_V3E)
             ENDDO

/*   IF NOT 1 ORDER OR 1 PO THEN POPULATE THE WORK FILE FOR          */
/*   A DATE RANGE                                                    */
             EXECUTE    VIEW(*LIBL/PMD4CPPV5) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&FROMDT &FROMDTA) (&TODT &TODTA) +
                          (&WHSETYPE &WHSETYPE))
/******      CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)    *********/

/* CREATE A TEMP FILE OF THE ORDER HEADER AND DETAIL RECORDS FOR     */
/* THE REQUESTED PRICE CODES                                         */
 JCO_V3E:    EXECUTE    VIEW(*LIBL/JCO_V3) OUTFILE(QTEMP/PMD4JCO3)

/********    CPYF       FROMFILE(QTEMP/PMD4JCO3) +
                          TOFILE(OMSDEVGEN/PMD4JCO3SV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)     *********/

/* BUILD A TABLE OF ALL THE PURCHASE ORDER ITEMS FOR THE REQUESTED   */
/* PRICE CODES AND TOTAL THE P.O.'S AND THE ITEMS. THIS REPORT WILL  */
/* INCLUDE ORDERED AND SHIPPED ON THE SAME REPORT. TOTALS ITEMS      */
/* ORDERED, SHIPPED, AND THE DIFFERENCE (ORDERED MINUS SHIPPED).     */
/* CREATE AN EXCEL SPREADSHEET AND EMAIL THE RESULTS.                */
/* ADD COMPANY NUMBER TO PMD4JCOT3                      E001893      */
             EXECUTE    VIEW(*LIBL/PMD4JCOT3) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG)
             MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                          VAR(&RTNCDE) VALUE(CPF9999))
             ENDDO      /* End REPORT TYPE=3, COMPANY = 000 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 3 = ORDERED VS SHIPPED, 1 CUSTOMER, 1 COMPANY         */
/*                 BY ACTUAL SHIP DATE.                              */
/*                 WAREHOUSE TYPE ADDED   E002587                    */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&COMP *NE 000) THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(JCO_V3F)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(JCO_V3F)
             ENDDO

/*   IF NOT 1 ORDER OR 1 PO THEN BUILD THE WORK FILE FOR             */
/*   A DATE RANGE                                                    */
             EXECUTE    VIEW(*LIBL/PMD4CPPV6) OUTFILE(QTEMP/PMD4CPP) +
                          SETVAR((&CUST &CUSTA) (&FROMDT &FROMDTA) +
                          (&TODT &TODTA) (&COMP &COMPA) (&WHSETYPE +
                          &WHSETYPE))

/********    CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)    *********/

/* CREATE A TEMP FILE OF THE ORDER HEADER AND DETAIL RECORDS FOR     */
/* THE REQUESTED PRICE CODES                                         */
 JCO_V3F:    EXECUTE    VIEW(*LIBL/JCO_V3) OUTFILE(QTEMP/PMD4JCO3)

/*********   CPYF       FROMFILE(QTEMP/PMD4JCO3) +
                          TOFILE(OMSDEVGEN/PMD4JCO3SV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)      *******/

/* BUILD A TABLE OF ALL THE PURCHASE ORDER ITEMS FOR THE REQUESTED   */
/* PRICE CODES AND TOTAL THE P.O.'S AND THE ITEMS. THIS REPORT WILL  */
/* INCLUDE ORDERED AND SHIPPED ON THE SAME REPORT. TOTALS ITEMS      */
/* ORDERED, SHIPPED, AND THE DIFFERENCE (ORDERED MINUS SHIPPED).     */
/* CREATE AN EXCEL SPREADSHEET AND EMAIL THE RESULTS.                */
/* ADD COMPANY NUMBER TO PMD4JCOT3                      E001893      */
             EXECUTE    VIEW(*LIBL/PMD4JCOT3) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG)
             MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                          VAR(&RTNCDE) VALUE(CPF9999))
             ENDDO      /* End REPORT TYPE=3, COMPANY <> 000 */

             ENDDO      /* End Select Report Type = 3 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 4 = THIS OPTION PRODUCES 2 SPREADSHEET REPORTS.       */
/*                 ALL CUSTOMERS, 1 COMPANY, BY ACTUAL SHIP DATE.    */
/*                 1. SUMMARY OF ALL ITEMS SHIPPED FOR ALL CUSTOMERS */
/*                      BY CUSTOMER AND ITEM FOR A SINGLE COMPANY.   */
/*                      THE TABLE SUMMARIZES SHIPPED CASES AND       */
/*                      WEIGHT BY ITEM ACROSS AND BY CUSTOMER DOWN.  */
/*                 2. SUMMARY BY CATEGORY OF SELECTED TYPES OF ITEMS */
/*                 WAREHOUSE TYPE ADDED   E002587                    */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&SELECT *EQ '4') THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(JCO_V4)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(JCO_V4)
             ENDDO

/*   IF NOT 1 ORDER OR 1 PO THEN POPULATE THE WORK FILE FOR          */
/*   A DATE RANGE                                                    */
             EXECUTE    VIEW(*LIBL/PMD4CPPV4) OUTFILE(QTEMP/PMD4CPP) +
                          SETVAR((&COMP &COMPA) (&FROMDT &FROMDTA) +
                          (&TODT &TODTA) (&CUST &CUSTA) (&WHSETYPE +
                          &WHSETYPE))
/**********  CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES) ************/

/* CREATE A TEMP FILE OF THE ORDER HEADER AND DETAIL RECORDS FOR     */
/* THE REQUESTED PRICE CODES AND ITEMS                               */
 JCO_V4:     EXECUTE    VIEW(*LIBL/JCO_V4) OUTFILE(*LIBL/PMD4JCO4)

/*********   CPYF       FROMFILE(*LIBL/PMD4JCO4) +
                          TOFILE(OMSDEVGEN/PMD4JCO4SV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)        ******/

/* BUILD A TABLE OF ALL THE ITEMS REQUESTED                          */
/* TOTAL THE ITEMS ACROSS BY CUSTOMER NAME. TOTAL THE CUSTOMER       */
/* ITEMS DOWN. THIS SUMMARY IS FOR SHIPPED ITEMS ONLY.               */
/* CREATE AN EXCEL SPREADSHEET OF THE RESULTS AND EMAIL.             */
             EXECUTE    VIEW(*LIBL/PMD4JCOT4) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG2)
             MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                          VAR(&RTNCDE) VALUE(CPF9999))

/* BUILD A TABLE THAT SUMMARIZES SELECTED ITEM CODES INTO            */
/* CATEGORIES. EMAIL THIS WITH THE PREVIOUS REPORT.                  */
             EXECUTE    VIEW(*LIBL/PMD4JCOS4T) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG2)
             MONMSG     MSGID(CPF0000 QRY0000) EXEC(CHGVAR +
                          VAR(&RTNCDE) VALUE(CPF9999))

             ENDDO      /* End Select Report Type = 4 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 5 & 6 = MANIFEST SUMMARY & DETAIL                     */
/*                 EMAIL THE PDF TO THE REQUESTED EMAIL ADDRESS      */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND((&SELECT *EQ '5') *OR (&SELECT *EQ +
                          '6')) THEN(DO)

/* BUILD WORK FILE FOR 1 ORDER                                       */
             IF         COND(&ORDER *NE 0) THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV23) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG3)
             GOTO       CMDLBL(CALL)
             ENDDO

/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
             IF         COND(&PONBR *NE '        ') THEN(DO)
             EXECUTE    VIEW(*LIBL/PMD4CPPV22) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))
             CHGVAR     VAR(&EMSG) VALUE(&EMSG4)
             GOTO       CMDLBL(CALL)
             ENDDO

/*   IF NOT 1 ORDER OR 1 PO THEN POPULATE THE WORK FILE FOR          */
/*   A DATE RANGE                                                    */
             EXECUTE    VIEW(*LIBL/PMD4CPPV15) OUTFILE(QTEMP/PMD4CPP) +
                          SETVAR((&CUST &CUSTA) (&FROMDT &FROMDTA) +
                          (&TODT &TODTA) (&COMP &COMPA) (&WHSETYPE +
                          &WHSETYPE))
/********    CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)      *******/

/* PRINT SALES DETAIL MANIFEST SUMMARY - BROKER = BLANKS             */
 CALL:       CALL       PGM(PBKRXFR) PARM(' ' &COMP &CUST &WHSETYPE +
                          &MANTYPE &DESC &OUTQ &HOLD &SAVE &NQSTAT +
                          &NIGHTQ &COPYN &BROKER &FDATE &TDATE +
                          &EMAILADDR)

             ENDDO      /* End Select Report Type = 5 OR 6 */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 7 = BUILD WORK FILE AND EMAIL MANIFEST SUMMARY        */
/*             SPREADSHEET TO THE REQUESTED EMAIL ADDRESS            */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&SELECT *EQ '7') THEN(DO)

             IF         COND(&ORDER *NE 0) THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
  /*E011527  IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA)))                       ***********/
  /*E011527 - PMD4CPPV24 cloned from PMD4CPPV17 but dropped Price Code Check.*/
             IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV24) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA)))
             IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV23) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA)))
/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR 1 ORDER & EMAIL       */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR 1 ORDER    */
             EXECUTE    VIEW(*LIBL/OMFNCPL6_2) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG3) +
                          SETVAR((&ORDER &ORDERA))
/********    CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)        ******/
             ENDDO      /* End &ORDER NOT ZEROS        */

             IF         COND(&PONBR *NE '        ') THEN(DO)
/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE                          */
  /*E011527  IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED)))             ***********/
  /*E011527 - PMD4CPPV25 cloned from PMD4CPPV16 but dropped Price Code Check.*/
             IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV25) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED)))
             IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV22) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED)))
/**********  CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)     ********/

/*   CALL THE PGM THAT WILL EXECUTE THE SQL TO CREATE THE XLS        */
             CALL       PGM(PBOAXFR) PARM('' &PONBR &WHSETYPE &COMPN +
                          &CUSTN &MANTYPE &EMAILADDR &SELECT)
             ENDDO      /* End &PO NUMBER NOT ZEROS    */

             ENDDO      /* End Select Report Type = 7  */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 8 = BUILD WORK FILE AND EMAIL MANIFEST DETAIL         */
/*             SPREADSHEET TO THE REQUESTED EMAIL ADDRESS            */
/*             FOR 1 ORDER OR FOR 1 PO#                              */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
             IF         COND(&SELECT *EQ '8') THEN(DO)

             IF         COND(&ORDER *NE 0) THEN(DO)
/* BUILD WORK FILE FOR 1 ORDER                                       */
  /*E011527  IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV17) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA)))                       ***********/
  /*E011527 - PMD4CPPV24 cloned from PMD4CPPV17 but dropped Price Code Check.*/
             IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV24) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA)))
             IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV23) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA)))

/*TESTING*** CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  ************/

/* EMAIL MANIFEST DETAIL  SPREADSHEET FOR 1 ORDER                    */
             EXECUTE    VIEW(*LIBL/OMFNCPL6_3) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG3) +
                          SETVAR((&ORDER  &ORDERA))
/*TESTING*** CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  ************/
             ENDDO      /* End &ORDER NOT ZEROS        */

/* BUILD SPREADSHEET AND EMAIL MAN DETAIL ALL ORDS, 1 PO#            */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE ORDERS FOR 1 PO#       */
             IF         COND(&PONBR *NE '        ') THEN(DO)

  /*E011527  IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV16) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED)))             ***********/
  /*E011527 - PMD4CPPV25 cloned from PMD4CPPV16 but dropped Price Code Check.*/
             IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV25) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED)))
             IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV22) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED)))
/*TESTING*** CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  ************/

/*   CALL THE PGM THAT WILL EXECUTE THE SQL TO CREATE THE XLS        */
             CALL       PGM(PBOAXFR) PARM('' &PONBR &WHSETYPE &COMPN +
                          &CUSTN &MANTYPE &EMAILADDR &SELECT)
             ENDDO      /* End &PO NUMBER NOT ZEROS    */

             ENDDO      /* End Select Report Type = 8   */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 9 = BUILD WORK FILE AND EMAIL MANIFEST SUMMARY        */
/*             SPREADSHEET TO THE REQUESTED EMAIL ADDRESS            */
/*             WITH NO TEST FOR PRICE CODE                           */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
          /* IF         COND(&SELECT *EQ '9') THEN(DO) */

          /* IF         COND(&ORDER *NE 0) THEN(DO) */
/* BUILD WORK FILE FOR 1 ORDER                                       */
          /* IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV23) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))) */
          /* IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV23) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))) */
/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR 1 ORDER & EMAIL       */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR 1 ORDER    */
          /* EXECUTE    VIEW(*LIBL/OMFNCPL6_2) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG3) +
                          SETVAR((&ORDER &ORDERA)) */
/********    CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)        ******/
          /* ENDDO */   /* End &ORDER NOT ZEROS        */

          /* IF         COND(&PONBR *NE '        ') THEN(DO) */
/* BUILD SPREADSHEET AND EMAIL MAN SUMMARY FOR ORDERS FOR 1 PO GROUP */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE RECORDS FOR ALL        */
/*   ORDERS FOR EITHER 1 PO# OR 1 PO# RANGE, NO TEST FOR PRICE CODE  */
          /* IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV22) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))) */
          /* IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV22) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))) */
/**********  CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)     ********/

/*   CALL THE PGM THAT WILL EXECUTE THE SQL TO CREATE THE XLS        */
          /* CALL       PGM(PBOAXFR) PARM('' &PONBR &WHSETYPE &COMPN +
                          &CUSTN &MANTYPE &EMAILADDR &SELECT) */
          /* ENDDO */   /* End &PO NUMBER NOT ZEROS    */

          /* ENDDO */   /* End Select Report Type = 9  */

/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
/* REPORT TYPE 10= BUILD WORK FILE AND EMAIL MANIFEST DETAIL         */
/*             SPREADSHEET TO THE REQUESTED EMAIL ADDRESS            */
/*             FOR 1 ORDER OR FOR 1 PO# WITH NO TEST FOR PRICE CODE  */
/* - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - */
          /* IF         COND(&SELECT *EQ '10') THEN(DO) */

          /* IF         COND(&ORDER *NE 0) THEN(DO) */
/* BUILD WORK FILE FOR 1 ORDER                                       */
          /* IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV23) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))) */
          /* IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV23) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&ORDER +
                          &ORDERA))) */

/*TESTING*** CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  ************/

/* EMAIL MANIFEST DETAIL  SPREADSHEET FOR 1 ORDER                    */
          /* EXECUTE    VIEW(*LIBL/OMFNCPL6_3) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG(&EMSG3) +
                          SETVAR((&ORDER  &ORDERA)) */
/*TESTING*** CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  ************/
          /* ENDDO */   /* End &ORDER NOT ZEROS        */

/* BUILD SPREADSHEET AND EMAIL MAN DETAIL ALL ORDS, 1 PO#            */
/*   POPULATE THE WORK FILE IN QTEMP WITH THE ORDERS FOR 1 PO#       */
          /* IF         COND(&PONBR *NE '        ') THEN(DO) */

          /* IF         COND(&WHSETYPE *EQ 'FR') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV22) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))) */
          /* IF         COND(&WHSETYPE *EQ 'FZ') THEN(EXECUTE +
                          VIEW(*LIBL/PMD4CPPV22) +
                          OUTFILE(QTEMP/PMD4CPP) SETVAR((&CUST +
                          &CUSTA) (&COMP &COMPA) (&FROMPO &PONBR) +
                          (&TOPO &PO#FILLED))) */
/*TESTING*** CPYF       FROMFILE(QTEMP/PMD4CPP) +
                          TOFILE(OMSDEVGEN/PMD4CPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  ************/

/*   CALL THE PGM THAT WILL EXECUTE THE SQL TO CREATE THE XLS        */
          /* CALL       PGM(PBOAXFR) PARM('' &PONBR &WHSETYPE &COMPN +
                          &CUSTN &MANTYPE &EMAILADDR &SELECT) */
          /* ENDDO */   /* End &PO NUMBER NOT ZEROS    */

          /* ENDDO */   /* End Select Report Type = 10  */

 END:        ENDPGM
