// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDVOXFR
// ?Date: 14.08.2025 Time: 03:30:14
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Also update Ship To Name in regards to OMS249 - approved by Judy S.
//?RMC 11/30/05 update record if fields changed so rcd stamp wont be on all
//?** SAZ 07/17/08 Removed all calls except to Sales History , The commented
//?** out code was moved to PMWKXFR.
EXECUTE FUNCTION(RTV Itm Str Cds/4 Rpts RT) TYPE(RTVOBJ) FILE(OMHSTPP)          AC1343074;
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv Item Str/Mkt      RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1863923;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Shipped_Item_Code);
 PARAMETER(WRK.Item_Structure_Class_Code);
 PARAMETER(WRK.Item_Structure_Group_Code);
 PARAMETER(WRK.Item_Structure_Type_Code);
 PARAMETER(PAR.Item_Market_Code);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF PAR.Item Market Code is Not Entered
 IF PAR.Item_Market_Code = *BLANK;

 EXECUTE FUNCTION(Rtv Customer Market   RT) TYPE(RTVOBJ) FILE(PDNEREP)           AC1859495;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(PAR.Item_Market_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

 EXECUTE FUNCTION(RTV Customer Name      RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1108159;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(WRK.Ship_To_Name);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF WRK.Ship To Name is blanks
 IF WRK.Ship_To_Name = *BLANK;

 // WRK.Ship To Name = DB1.Ship To Name
 WRK.Ship_To_Name = DB1.Ship_To_Name;

 ENDIF;

 // Execute function CVT Str to Upper Alpha US.
 EXECUTE FUNCTION(CVT Str to Upper Alpha US) TYPE(EXCUSRSRC) ('PDWEUFR');
 PARAMETER(DB1.Ship_To_City);
 PARAMETER(PAR.Destination_City);
 {
  PDWEUFR:  PGM PARM(&STRIN &STROUT)

  CHGVAR VAR(&FLDOUT) VALUE('%XLATE(UPTEXT &STRIN)')
 }

 EXECUTE FUNCTION(RTV Zone for City-ST   RT) TYPE(RTVOBJ) FILE(PDLUREP)          AC1484676;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(PAR.Destination_City);
 PARAMETER(PAR.Shipping_Zone_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Sales Route        RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC1371227;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(LCL.Sales_Route_Code);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Salesman Code      RT) TYPE(RTVOBJ) FILE(PDJEREP)          AC1284971;
 PARAMETER(LCL.Sales_Route_Code);
 PARAMETER(LCL.Salesperson_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?RMC 11/30/05 Change rcd only if fields changed
 //?UPDATE
 CASE;

 // IF PAR.Shipping Zone Code NE DB1.Shipping Zone Code
 IF PAR.Shipping_Zone_Code <> DB1.Shipping_Zone_Code;

 // OR WRK.Item Structure Type Code NE DB1.Item Structure Type Code
 OR WRK.Item_Structure_Type_Code <> DB1.Item_Structure_Type_Code;

 // OR WRK.Item Structure Group Code NE DB1.Item Structure Group Code
 OR WRK.Item_Structure_Group_Code <> DB1.Item_Structure_Group_Code;

 // OR WRK.Item Structure Class Code NE DB1.Item Structure Class Code
 OR WRK.Item_Structure_Class_Code <> DB1.Item_Structure_Class_Code;

 // OR WRK.Ship To Name NE DB1.Ship To Name
 OR WRK.Ship_To_Name <> DB1.Ship_To_Name;

 // OR PAR.Item Market Code NE DB1.Item Market Code
 OR PAR.Item_Market_Code <> DB1.Item_Market_Code;

 EXECUTE FUNCTION(CHG Itm Str Cds/4 Rpts CH) TYPE(CHGOBJ) FILE(OMHSTPP)          AC1343075;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(WRK.Ship_To_Name);
 PARAMETER(DB1.Sales_Route_Code);
 PARAMETER(DB1.Original_Salesperson);
 PARAMETER(WRK.Item_Structure_Type_Code);
 PARAMETER(WRK.Item_Structure_Group_Code);
 PARAMETER(WRK.Item_Structure_Class_Code);
 PARAMETER(PAR.Item_Market_Code);
 PARAMETER(PAR.Shipping_Zone_Code);
 PARAMETER(JOB.*Job_time);
 PARAMETER(JOB.*USER);
 PARAMETER(JOB.*JOB);
 PARAMETER(JOB.*Job_date);
 {
  //?USER: Processing after Data read

  // DB1.Data Mart Process Sts = CND.no
  DB1.Data_Mart_Process_Sts = 'N';

 }

 ENDIF;

}


//?SBM - ESEND REPORTS
