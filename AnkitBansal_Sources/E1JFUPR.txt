     H OPTION(*SRCSTMT : *NODEBUGIO)
     H*DFTACTGRP(*NO)
     H BNDDIR('RDB2000')

      *****************************************************************
     H* ‚Company       : Seaboard Foods
     H* ‚Function      : JD Edwards Upgrade
     H* ‚                Insert F0911Z1 Record - copied from marine smlsynsrc/qrpglesrc/jeu056w9
     H* ‚Programmer    : Rose Centonze
     H* ‚Date          : 2020/05/11
      *****************************************************************
     H* ‚Date          Changed by    Ticket    Description
     H* ‚----------    ----------    -------   -----------------------------------------------------
     H* ‚2020-05-11    R Centonze    P16169    Original version
     H*                                       ‚Change JEU056W9 to E1JFUPR
     H*                 ‚TO COMPILE: ADDLIBLE RDB40 , CRTPGMMOD  WITH BNDDIR(RDB2000)
     H*                             ‚CRTPGM PGM(E1IDEVGEN/e1jfupr) MODULE(*PGM)
      *****************************************************************

      * ‚Entry parameters ....
     dE1JFUPR          PR                  extpgm('E1JFUPR')
     d @p_VNEDUS                     10a                                        User ID. . . . . .
     d @p_VNEDTY                      1a                                        Record Type. . . .
     d @p_VNEDSQ                      2p 0                                      Record Sequence. .
     d @p_VNEDTN                     22a                                        Transaction Number
     d @p_VNEDCT                      2a                                        Document Type. . .
wg   d @p_VNEDLN                      7p 0                                      Line Number. . . .
     d @p_VNEDTS                      6a                                        Transaction Set. .
     d @p_VNEDFT                     10a                                        Translation Format
     d @p_VNEDDT                      6p 0                                      EDI - Transmission
     d @p_VNEDER                      1a                                        Send/Receive Indic
     d @p_VNEDDL                      5p 0                                      Number of Detail L
     d @p_VNEDSP                      1a                                        Processed (Y/N). .
     d @p_VNEDTC                      1a                                        Transaction Action
     d @p_VNEDTR                      1a                                        Transaction Type .
     d @p_VNEDBT                     15a                                        Batch Number . . . .
     d @p_VNEDGL                      1a                                        Create G/L Record.
     d @p_VNEDAN                      8p 0                                      User Address Nbr
     d @p_VNKCO                       5a                                        Document Company
     d @p_VNDCT                       2a                                        Document Type
     d @p_VNDOC                       8p 0                                      Document Number
     d @p_VNDGJ                       6p 0                                      G/L Date
     d @p_VNJELN                      7p 1                                      Journal Entry Lin
     d @p_VNEXTL                      2a                                        Line Extension Co
     d @p_VNPOST                      1a                                        G/L Posted Code
     d @p_VNICU                       8p 0                                      Batch Number . .
     d @p_VNICUT                      2a                                        Batch Type . . .
     d @p_VNDICJ                      6p 0                                      Batch Date . . .
     d @p_VNDSYJ                      6p 0                                      Batch System Date
     d @p_VNTICU                      6p 0                                      Batch Time . . .
     d @p_VNCO                        5a                                        Company. . . . .
     d @p_VNANI                      29a                                        Account Number .
     d @p_VNAM                        1a                                        Account Mode . .
     d @p_VNAID                       8a                                        Account ID . . .
     d @p_VNMCU                      12a                                        Business Unit. .
     d @p_VNOBJ                       6a                                        Object Account .
     d @p_VNSUB                       8a                                        Subsidiary . . .
     d @p_VNSBL                       8a                                        Subledger. . . .
     d @p_VNSBLT                      1a                                        Subledger Type .
     d @p_VNLT                        2a                                        Ledger Type. . .
     d @p_VNPN                        2p 0                                      G/L Period Number
     d @p_VNCTRY                      2p 0                                      Century. . . .
     d @p_VNFY                        2p 0                                      Fiscal Year. .
     d @p_VNFQ                        4a                                        Fiscal Quarter
     d @p_VNCRCD                      3a                                        Currency Code.
     d @p_VNCRR                      15p 7                                      Exchange Rate.
     d @p_VNHCRR                     15p 7                                      Historical Exch
     d @p_VNHDGJ                      6p 0                                      Historical Date
     d @p_VNAA                       15p 0                                      amount . . . . . .
     d @p_VNU                        15p 0                                      Units. . . . . . .
     d @p_VNUM                        2a                                        Unit of Measure. .
     d @p_VNGLC                       4a                                        G/L Offset . . . .
     d @p_VNRE                        1a                                        Reverse or Void (R
     d @p_VNEXA                      30a                                        Explanation - Name
     d @p_VNEXR                      30a                                        Explanation - Rema
     d @p_VNR1                        8a                                        Reference 1 - JE,
     d @p_VNR2                        8a                                        Reference 2 - Addr
     d @p_VNR3                        8a                                        Reference 3 - Acc
     d @p_VNSFX                       3a                                        Pay Item . . . .
     d @p_VNODOC                      8p 0                                      Original Document
     d @p_VNODCT                      2a                                        Original Document
     d @p_VNOSFX                      3a                                        Original Pay Item
     d @p_VNPKCO                      5a                                        Purchase Order Do
     d @p_VNOKCO                      5a                                        Original Order Do
     d @p_VNPDCT                      2a                                        Purchase Order Do
     d @p_VNAN8                       8p 0                                      Address Number .
     d @p_VNCN                        8a                                        Payment Number .
     d @p_VNDKJ                       6p 0                                      Check Date . . .
     d @p_VNDKC                       6p 0                                      Check Cleared Da
     d @p_VNASID                     25a                                        Serial Number. .
     d @p_VNBRE                       1a                                        Batch Rear End P
     d @p_VNRCND                      1a                                        Reconciled . .
     d @p_VNSUMM                      1a                                        Summarized Code.
     d @p_VNPRGE                      1a                                        Purge Code . . .
     d @p_VNTNN                       1a                                        Flag for 1099. .
     d @p_VNALT1                      1a                                        Alternate G/L Pos
     d @p_VNALT2                      1a                                        Alternate G/L Pos
     d @p_VNALT3                      1a                                        Alternate G/L Pos
     d @p_VNALT4                      1a                                        Alternate G/L Pos
     d @p_VNALT5                      1a                                        Multi Currency Jo
     d @p_VNALT6                      1a                                        Cash Basis Accoun
     d @p_VNALT7                      1a                                        Commitment Reliee
     d @p_VNALT8                      1a                                        Billing Control.e
     d @p_VNALT9                      1a                                        Currency Update e
     d @p_VNALT0                      1a                                        Labor Costing Fle
     d @p_VNALTT                      1a                                        Future Use . . .e
     d @p_VNALTU                      1a                                        Future Use . . .e
     d @p_VNALTV                      1a                                        Future Use . . .e
     d @p_VNALTW                      1a                                        Future Use . . .e
     d @p_VNALTX                      1a                                        Consumption Tax
     d @p_VNALTZ                      1a                                        Future Use . . .
     d @p_VNDLNA                      1a                                        Delete Not Allow
     d @p_VNCFF1                      1a                                        Future Use . . .
     d @p_VNCFF2                      1a                                        Future Use . . .
     d @p_VNASM                       1a                                        Lease Cost Ledge
     d @p_VNBC                        1a                                        Bill Code. . . .
     d @p_VNVINV                     25a                                        Invoice Number .
     d @p_VNIVD                       6p 0                                      Invoice Date .
     d @p_VNWR01                      4a                                        Phase. . . . .
     d @p_VNPO                        8a                                        P.O. Number. .
     d @p_VNPSFX                      3a                                        Purchase Order
     d @p_VNDCTO                      2a                                        Order Type . .
     d @p_VNLNID                      6p 0                                      Line Number. .
     d @p_VNWY                        2p 0                                      Fiscal Year -
     d @p_VNWN                        2p 0                                      Fiscal Period
     d @p_VNFNLP                      1a                                        Closed Item. . .
     d @p_VNOPSQ                      5p 0                                      Operations Seque
     d @p_VNJBCD                      6a                                        Job Type . . . .
     d @p_VNJBST                      4a                                        Job Step . . . .
     d @p_VNHMCU                     12a                                        Home Business Un
     d @p_VNDOI                       2p 0                                      DOI Sub. . . . .
     d @p_VNALID                     25a                                        Outsider Lease/W
     d @p_VNALTY                      2a                                        ID Type. . . . .
     d @p_VNDSVJ                      6p 0                                      Service/Tax Date
     d @p_VNTORG                     10a                                        Transaction Orig
     d @p_VNREG#                      8p 0                                      Registration Num
     d @p_VNPYID                     15p 0                                      Payment ID (Inte
     d @p_VNUSER                     10a                                        User ID. . . . .
     d @p_VNPID                      10a                                        Program ID . . .
     d @p_VNJOBN                     10a                                        Work Station ID.
     d @p_VNUPMJ                      6p 0                                      Date Updated . .
     d @p_VNUPMT                      6p 0                                      Time Last Updated
     d @p_VNCRRM                      1a                                        Mode (F) . . . .
     d @p_VNACR                      15p 0                                      Currency Amount.
     d @p_VNDGM                       2p 0                                      G/L Date - MO. .
     d @p_VNDGD                       2p 0                                      G/L Date - DA. .
     d @p_VNDGY                       2p 0                                      G/L Date - YR. .
     d @p_VNDG#                       2p 0                                      G/L Date - CTRY.
     d @p_VNDICM                      2p 0                                      Batch Date - MO.
     d @p_VNDICD                      2p 0                                      Batch Date - DA.
     d @p_VNDICY                      2p 0                                      Batch Date - YR.
     d @p_VNDIC#                      2p 0                                      Batch Date - CTRY
     d @p_VNDSYM                      2p 0                                      Batch System Date
     d @p_VNDSYD                      2p 0                                      Batch System Date
     d @p_VNDSYY                      2p 0                                      Batch System Date
     d @p_VNDSY#                      2p 0                                      Batch System Date
     d @p_VNDKM                       2p 0                                      Check Date - MO.
     d @p_VNDKD                       2p 0                                      Check Date - DA.
     d @p_VNDKY                       2p 0                                      Check Date - YR.
     d @p_VNDK#                       2p 0                                      Check Date - CTRY
     d @p_VNDSVM                      2p 0                                      Serv/Tax Date - M
     d @p_VNDSVD                      2p 0                                      Serv/Tax Date - D
     d @p_VNDSVY                      2p 0                                      Serv/Tax Date - Y
     d @p_VNDSV#                      2p 0                                      Serv/Tax Date - C
     d @p_VNHDGM                      2p 0                                      Historical Date -
     d @p_VNHDGD                      2p 0                                      Historical Date
     d @p_VNHDGY                      2p 0                                      Historical Date
     d @p_VNHDG#                      2p 0                                      Historical Date
     d @p_VNDKCM                      2p 0                                      Check Cleared Da
     d @p_VNDKCD                      2p 0                                      Check Cleared Da
     d @p_VNDKCY                      2p 0                                      Check Cleared Da
     d @p_VNDKC#                      2p 0                                      Check Cleared Da
     d @p_VNIVDM                      2p 0                                      Invoice - MO . .
     d @p_VNIVDD                      2p 0                                      Invoice - DA . .
     d @p_VNIVDY                      2p 0                                      Invoice - DA - YR
     d @p_VNIVD#                      2p 0                                      Invoice - DA - CT
     d*              ADDED 6/22/2020
     d @p_VNABR1                     12a
     d @p_VNABR2                     12a
     d @p_VNABR3                     12a
     d @p_VNABR4                     12a
     d @p_VNABT1                      1a
     d @p_VNABT2                      1a
     d @p_VNABT3                      1a
     d @p_VNABT4                      1a
     d @p_VNITM                       8p 0
     d @p_VNPM01                      1a
     d @p_VNPM02                      1a
     d @p_VNPM03                      1a
     d @p_VNPM04                      1a
     d @p_VNPM05                      1a
     d @p_VNPM06                      1a
     d @p_VNPM07                      1a
     d @p_VNPM08                      1a
     d @p_VNPM09                      1a
     d @p_VNPM10                      1a
     d @p_VNBCRC                      3a
     d @p_VNEXR1                      2a
     d @p_VNTXA1                     10a
     d @p_VNTXITM                     8p 0
     d @p_VNACTB                     10a
     d @p_VNSTAM                     15p 0
     d @p_VNCTAM                     15p 0
     d @p_VNAG                       15p 0                                      Gross Amount ...
     d @p_VNAGF                      15p 0
     d @p_VNTKTX                      1a
     d @p_VNDLNID                     6p 0
     d @p_VNCKNU                     25a
     d @p_VNBUPC                      1a
     d @p_VNAHBU                     12a
     d @p_VNEPGC                      3a
     d @p_VNJPGC                      3a
     d @p_VNRC5                       5p 0
     d @p_VNSFXE                      2p 0
     d @p_VNOFM                       1a
     d @p_Error                       1a                                        Error
     d @p_VNO6TX                      7a                                        Error Id
     d @p_VNO7TX                     25a                                        Error Text

     dE1JFUPR          PI
     d @p_VNEDUS                     10a                                        User ID. . . . . .
     d @p_VNEDTY                      1a                                        Record Type. . . .
     d @p_VNEDSQ                      2p 0                                      Record Sequence. .
     d @p_VNEDTN                     22a                                        Transaction Number
     d @p_VNEDCT                      2a                                        Document Type. . .
wg   d @p_VNEDLN                      7p 0                                      Line Number. . . .
     d @p_VNEDTS                      6a                                        Transaction Set. .
     d @p_VNEDFT                     10a                                        Translation Format
     d @p_VNEDDT                      6p 0                                      EDI - Transmission
     d @p_VNEDER                      1a                                        Send/Receive Indic
     d @p_VNEDDL                      5p 0                                      Number of Detail L
     d @p_VNEDSP                      1a                                        Processed (Y/N). .
     d @p_VNEDTC                      1a                                        Transaction Action
     d @p_VNEDTR                      1a                                        Transaction Type .
     d @p_VNEDBT                     15a                                        Batch Number . . . .
     d @p_VNEDGL                      1a                                        Create G/L Record.
     d @p_VNEDAN                      8p 0                                      User Address Nbr
     d @p_VNKCO                       5a                                        Document Company
     d @p_VNDCT                       2a                                        Document Type
     d @p_VNDOC                       8p 0                                      Document Number
     d @p_VNDGJ                       6p 0                                      G/L Date
     d @p_VNJELN                      7p 1                                      Journal Entry Lin
     d @p_VNEXTL                      2a                                        Line Extension Co
     d @p_VNPOST                      1a                                        G/L Posted Code
     d @p_VNICU                       8p 0                                      Batch Number . .
     d @p_VNICUT                      2a                                        Batch Type . . .
     d @p_VNDICJ                      6p 0                                      Batch Date . . .
     d @p_VNDSYJ                      6p 0                                      Batch System Date
     d @p_VNTICU                      6p 0                                      Batch Time . . .
     d @p_VNCO                        5a                                        Company. . . . .
     d @p_VNANI                      29a                                        Account Number .
     d @p_VNAM                        1a                                        Account Mode . .
     d @p_VNAID                       8a                                        Account ID . . .
     d @p_VNMCU                      12a                                        Business Unit. .
     d @p_VNOBJ                       6a                                        Object Account .
     d @p_VNSUB                       8a                                        Subsidiary . . .
     d @p_VNSBL                       8a                                        Subledger. . . .
     d @p_VNSBLT                      1a                                        Subledger Type .
     d @p_VNLT                        2a                                        Ledger Type. . .
     d @p_VNPN                        2p 0                                      G/L Period Number
     d @p_VNCTRY                      2p 0                                      Century. . . .
     d @p_VNFY                        2p 0                                      Fiscal Year. .
     d @p_VNFQ                        4a                                        Fiscal Quarter
     d @p_VNCRCD                      3a                                        Currency Code.
     d @p_VNCRR                      15p 7                                      Exchange Rate.
     d @p_VNHCRR                     15p 7                                      Historical Exch
     d @p_VNHDGJ                      6p 0                                      Historical Date
     d @p_VNAA                       15p 0                                      amount . . . . . .
     d @p_VNU                        15p 0                                      Units. . . . . . .
     d @p_VNUM                        2a                                        Unit of Measure. .
     d @p_VNGLC                       4a                                        G/L Offset . . . .
     d @p_VNRE                        1a                                        Reverse or Void (R
     d @p_VNEXA                      30a                                        Explanation - Name
     d @p_VNEXR                      30a                                        Explanation - Rema
     d @p_VNR1                        8a                                        Reference 1 - JE,
     d @p_VNR2                        8a                                        Reference 2 - Addr
     d @p_VNR3                        8a                                        Reference 3 - Acc
     d @p_VNSFX                       3a                                        Pay Item . . . .
     d @p_VNODOC                      8p 0                                      Original Document
     d @p_VNODCT                      2a                                        Original Document
     d @p_VNOSFX                      3a                                        Original Pay Item
     d @p_VNPKCO                      5a                                        Purchase Order Do
     d @p_VNOKCO                      5a                                        Original Order Do
     d @p_VNPDCT                      2a                                        Purchase Order Do
     d @p_VNAN8                       8p 0                                      Address Number .
     d @p_VNCN                        8a                                        Payment Number .
     d @p_VNDKJ                       6p 0                                      Check Date . . .
     d @p_VNDKC                       6p 0                                      Check Cleared Da
     d @p_VNASID                     25a                                        Serial Number. .
     d @p_VNBRE                       1a                                        Batch Rear End P
     d @p_VNRCND                      1a                                        Reconciled . .
     d @p_VNSUMM                      1a                                        Summarized Code.
     d @p_VNPRGE                      1a                                        Purge Code . . .
     d @p_VNTNN                       1a                                        Flag for 1099. .
     d @p_VNALT1                      1a                                        Alternate G/L Pos
     d @p_VNALT2                      1a                                        Alternate G/L Pos
     d @p_VNALT3                      1a                                        Alternate G/L Pos
     d @p_VNALT4                      1a                                        Alternate G/L Pos
     d @p_VNALT5                      1a                                        Multi Currency Jo
     d @p_VNALT6                      1a                                        Cash Basis Accoun
     d @p_VNALT7                      1a                                        Commitment Reliee
     d @p_VNALT8                      1a                                        Billing Control.e
     d @p_VNALT9                      1a                                        Currency Update e
     d @p_VNALT0                      1a                                        Labor Costing Fle
     d @p_VNALTT                      1a                                        Future Use . . .e
     d @p_VNALTU                      1a                                        Future Use . . .e
     d @p_VNALTV                      1a                                        Future Use . . .e
     d @p_VNALTW                      1a                                        Future Use . . .e
     d @p_VNALTX                      1a                                        Consumption Tax
     d @p_VNALTZ                      1a                                        Future Use . . .
     d @p_VNDLNA                      1a                                        Delete Not Allow
     d @p_VNCFF1                      1a                                        Future Use . . .
     d @p_VNCFF2                      1a                                        Future Use . . .
     d @p_VNASM                       1a                                        Lease Cost Ledge
     d @p_VNBC                        1a                                        Bill Code. . . .
     d @p_VNVINV                     25a                                        Invoice Number .
     d @p_VNIVD                       6p 0                                      Invoice Date .
     d @p_VNWR01                      4a                                        Phase. . . . .
     d @p_VNPO                        8a                                        P.O. Number. .
     d @p_VNPSFX                      3a                                        Purchase Order
     d @p_VNDCTO                      2a                                        Order Type . .
     d @p_VNLNID                      6p 0                                      Line Number. .
     d @p_VNWY                        2p 0                                      Fiscal Year -
     d @p_VNWN                        2p 0                                      Fiscal Period
     d @p_VNFNLP                      1a                                        Closed Item. . .
     d @p_VNOPSQ                      5p 0                                      Operations Seque
     d @p_VNJBCD                      6a                                        Job Type . . . .
     d @p_VNJBST                      4a                                        Job Step . . . .
     d @p_VNHMCU                     12a                                        Home Business Un
     d @p_VNDOI                       2p 0                                      DOI Sub. . . . .
     d @p_VNALID                     25a                                        Outsider Lease/W
     d @p_VNALTY                      2a                                        ID Type. . . . .
     d @p_VNDSVJ                      6p 0                                      Service/Tax Date
     d @p_VNTORG                     10a                                        Transaction Orig
     d @p_VNREG#                      8p 0                                      Registration Num
     d @p_VNPYID                     15p 0                                      Payment ID (Inte
     d @p_VNUSER                     10a                                        User ID. . . . .
     d @p_VNPID                      10a                                        Program ID . . .
     d @p_VNJOBN                     10a                                        Work Station ID.
     d @p_VNUPMJ                      6p 0                                      Date Updated . .
     d @p_VNUPMT                      6p 0                                      Time Last Updated
     d @p_VNCRRM                      1a                                        Mode (F) . . . .
     d @p_VNACR                      15p 0                                      Currency Amount.
     d @p_VNDGM                       2p 0                                      G/L Date - MO. .
     d @p_VNDGD                       2p 0                                      G/L Date - DA. .
     d @p_VNDGY                       2p 0                                      G/L Date - YR. .
     d @p_VNDG#                       2p 0                                      G/L Date - CTRY.
     d @p_VNDICM                      2p 0                                      Batch Date - MO.
     d @p_VNDICD                      2p 0                                      Batch Date - DA.
     d @p_VNDICY                      2p 0                                      Batch Date - YR.
     d @p_VNDIC#                      2p 0                                      Batch Date - CTRY
     d @p_VNDSYM                      2p 0                                      Batch System Date
     d @p_VNDSYD                      2p 0                                      Batch System Date
     d @p_VNDSYY                      2p 0                                      Batch System Date
     d @p_VNDSY#                      2p 0                                      Batch System Date
     d @p_VNDKM                       2p 0                                      Check Date - MO.
     d @p_VNDKD                       2p 0                                      Check Date - DA.
     d @p_VNDKY                       2p 0                                      Check Date - YR.
     d @p_VNDK#                       2p 0                                      Check Date - CTRY
     d @p_VNDSVM                      2p 0                                      Serv/Tax Date - M
     d @p_VNDSVD                      2p 0                                      Serv/Tax Date - D
     d @p_VNDSVY                      2p 0                                      Serv/Tax Date - Y
     d @p_VNDSV#                      2p 0                                      Serv/Tax Date - C
     d @p_VNHDGM                      2p 0                                      Historical Date -
     d @p_VNHDGD                      2p 0                                      Historical Date
     d @p_VNHDGY                      2p 0                                      Historical Date
     d @p_VNHDG#                      2p 0                                      Historical Date
     d @p_VNDKCM                      2p 0                                      Check Cleared Da
     d @p_VNDKCD                      2p 0                                      Check Cleared Da
     d @p_VNDKCY                      2p 0                                      Check Cleared Da
     d @p_VNDKC#                      2p 0                                      Check Cleared Da
     d @p_VNIVDM                      2p 0                                      Invoice - MO . .
     d @p_VNIVDD                      2p 0                                      Invoice - DA . .
     d @p_VNIVDY                      2p 0                                      Invoice - DA - YR
     d @p_VNIVD#                      2p 0                                      Invoice - DA - CT
     d*              ADDED 6/22/2020
     d @p_VNABR1                     12a
     d @p_VNABR2                     12a
     d @p_VNABR3                     12a
     d @p_VNABR4                     12a
     d @p_VNABT1                      1a
     d @p_VNABT2                      1a
     d @p_VNABT3                      1a
     d @p_VNABT4                      1a
     d @p_VNITM                       8p 0
     d @p_VNPM01                      1a
     d @p_VNPM02                      1a
     d @p_VNPM03                      1a
     d @p_VNPM04                      1a
     d @p_VNPM05                      1a
     d @p_VNPM06                      1a
     d @p_VNPM07                      1a
     d @p_VNPM08                      1a
     d @p_VNPM09                      1a
     d @p_VNPM10                      1a
     d @p_VNBCRC                      3a
     d @p_VNEXR1                      2a
     d @p_VNTXA1                     10a
     d @p_VNTXITM                     8p 0
     d @p_VNACTB                     10a
     d @p_VNSTAM                     15p 0
     d @p_VNCTAM                     15p 0
     d @p_VNAG                       15p 0                                      Gross Amount ...
     d @p_VNAGF                      15p 0
     d @p_VNTKTX                      1a
     d @p_VNDLNID                     6p 0
     d @p_VNCKNU                     25a
     d @p_VNBUPC                      1a
     d @p_VNAHBU                     12a
     d @p_VNEPGC                      3a
     d @p_VNJPGC                      3a
     d @p_VNRC5                       5p 0
     d @p_VNSFXE                      2p 0
     d @p_VNOFM                       1a
     d @p_Error                       1a                                        Error
     d @p_VNO6TX                      7a                                        Error Id
     d @p_VNO7TX                     25a                                        Error Text

      * ‚RTV JDE RDB Connection
     d*rtvRDBCfg       PR                  ExtPgm('LHXMXFR')    (marine version)
     d rtvRDBCfg       PR                  ExtPgm('E1IEXFR')
     d  @rtnCode                      7a                                        Return Code
     d  @companyId                    3a
     d  @prmConnect                  10a
     d  @prmSchema                   20a
     d  @secConnect                  10a
     d  @secSchema                   20a
     d  @postJDEVer                   1a

      * ‚Copy Book ....
      /COPY *LIBL/RDBSRC,RDBPROTO

      * ‚Variables ....
     d Id              S             10I 0 inz
     d rc              S             10I 0 inz
     d @ErrId          S              7a   inz
     d @ErrText        S            100a   inz
     d @sFileSchema    S             30a   inz
     d @sql            S          10000A   inz

     d rtnCode         s              7a   inz                                  Return Code
     d companyId       s              3a   inz
     d jdeCompany      s              5a   inz

     d pCon            s             10a   inz
     d pSchm           s             20a   inz

     d sCon            s             10a   inz
     d sSchm           s             20a   inz

     d @Con            s             10a   inz
     d @Schm           s             20a   inz

     d pJDEVer         s              1a   inz


      /FREE

   ‚   // Process Primary Schema ....
       exSr $writeF0911Z1Sr;

       // EoJ ....
       *Inlr = *On;

     ‚* ----------------------------------------------------------- *
     ‚* Setup Primary Schema for processing                         *
     ‚* ----------------------------------------------------------- *

       begSr $writeF0911Z1Sr;

   ‚   // Remote connection - Getting Connection ID ....
       Id = RdbConnect(@Con);

   ‚   // Connection failed ....
       If Id < 0;
          exSr $errorSr;
       endIf;

   ‚   // Process Insert/Update  ....
       exSr $insertSr;

   ‚   // Closing Primary Connection ....
       RdbFreeStmt(Id);
       RdbClose(Id);

       endSr;

     ‚* ----------------------------------------------------------- *
     ‚* Insert Record into Schema                                   *
     ‚* ----------------------------------------------------------- *

       begSr $insertSr;

   ‚    // Set Schema ....
        @sFileSchema = '[' + %trimr(@Schm) + '].[F0911Z1]';

   ‚    // Setup SQL stmt - SQL Server ....
        @sql =  'Insert into ' + %trimr(@sFileSchema) + ' (' +
        'VNEDUS,VNEDTY,VNEDSQ,VNEDTN,VNEDCT,VNEDLN,VNEDTS,VNEDFT,' +
        'VNEDDT,' +
        'VNEDER,VNEDDL,VNEDSP,VNEDTC,VNEDTR,VNEDBT,VNEDGL,VNEDAN,' +
        'VNKCO,VNDCT,VNDOC,VNDGJ,VNJELN,VNEXTL,VNPOST,VNICU,VNICUT,' +
        'VNDICJ,' +
        'VNDSYJ,VNTICU,VNCO,VNANI,VNAM,VNAID,VNMCU,VNOBJ,VNSUB,' +
        'VNSBL,' +
        'VNSBLT,VNLT,VNPN,VNCTRY,VNFY,VNFQ,VNCRCD,VNCRR,VNHCRR,' +
        'VNHDGJ,VNAA,' +
        'VNU,VNUM,VNGLC,VNRE,VNEXA,VNEXR,VNR1,VNR2,VNR3,' +
        'VNSFX,' +
        'VNODOC,VNODCT,VNOSFX,VNPKCO,VNOKCO,VNPDCT,VNAN8,VNCN,' +
        'VNDKJ,' +
        'VNDKC,VNASID,VNBRE,VNRCND,VNSUMM,VNPRGE,VNTNN,VNALT1,' +
        'VNALT2,' +
        'VNALT3,VNALT4,VNALT5,VNALT6,VNALT7,VNALT8,VNALT9,VNALT0,' +
        'VNALTT,' +
        'VNALTU,VNALTV,VNALTW,VNALTX,VNALTZ,VNDLNA,VNCFF1,' +
        'VNCFF2,' +
        'VNASM,VNBC,VNVINV,VNIVD,VNWR01,VNPO,VNPSFX,VNDCTO,VNLNID,' +
        'VNWY,' +
        'VNWN,VNFNLP,VNOPSQ,VNJBCD,VNJBST,VNHMCU,VNDOI,VNALID,' +
        'VNALTY,' +
        'VNDSVJ,VNTORG,VNREG#,VNPYID,VNUSER,VNPID,VNJOBN,VNUPMJ,' +
        'VNUPMT,' +
        'VNCRRM,VNACR,VNDGM,VNDGD,VNDGY,VNDG#,VNDICM,VNDICD,' +
        'VNDICY,' +
        'VNDIC#,VNDSYM,VNDSYD,VNDSYY,VNDSY#,VNDKM,VNDKD,VNDKY,' +
        'VNDK#,' +
        'VNDSVM,VNDSVD,VNDSVY,VNDSV#,VNHDGM,VNHDGD,VNHDGY,VNHDG#,' +
        'VNDKCM,' +
        'VNDKCD,VNDKCY,VNDKC#,VNIVDM,VNIVDD,VNIVDY,VNIVD#,  ' +
        'VNABR1,VNABR2,VNABR3,VNABR4,VNABT1,VNABT2,VNABT3,VNABT4,VNITM,' +
        'VNPM01,VNPM02,VNPM03,VNPM04,VNPM05,VNPM06,VNPM07,VNPM08,VNPM09,' +
        'VNPM10,VNBCRC,VNEXR1,VNTXA1,VNTXITM,VNACTB,VNSTAM,VNCTAM,VNAG, '  +
        'VNAGF,VNTKTX,VNDLNID,VNCKNU,VNBUPC,VNAHBU,VNEPGC,VNJPGC,VNRC5,' +
        'VNSFXE,VNOFM)' +
        'Values(' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,' +
        '?,?,?,?,?,?,?,?,?,?,?,?,?)';

   ‚      // Prepared Stmt ....
          rc = RdbPrepStmt(Id: @sql);

   ‚      // Parameters for Prepared Stmt ...
          rc = RdbSetStr(ID: 1:   @p_VNEDUS);
          rc = RdbSetStr(ID: 2:   @p_VNEDTY);
          rc = RdbSetNum(ID: 3:   @p_VNEDSQ);
          rc = RdbSetStr(ID: 4:   @p_VNEDTN);
          rc = RdbSetStr(ID: 5:   @p_VNEDCT);
          rc = RdbSetNum(ID: 6:   @p_VNEDLN);
          rc = RdbSetStr(ID: 7:   @p_VNEDTS);
          rc = RdbSetStr(ID: 8:   @p_VNEDFT);
          rc = RdbSetNum(ID: 9:   @p_VNEDDT);
          rc = RdbSetStr(ID: 10:  @p_VNEDER);
          rc = RdbSetNum(ID: 11:  @p_VNEDDL);
          rc = RdbSetStr(ID: 12:  @p_VNEDSP);
          rc = RdbSetStr(ID: 13:  @p_VNEDTC);
          rc = RdbSetStr(ID: 14:  @p_VNEDTR);
          rc = RdbSetStr(ID: 15:  @p_VNEDBT);

          rc = RdbSetStr(ID: 16:  @p_VNEDGL);
          rc = RdbSetNum(ID: 17:  @p_VNEDAN);
          rc = RdbSetStr(ID: 18:  @p_VNKCO);
          rc = RdbSetStr(ID: 19:  @p_VNDCT);
          rc = RdbSetNum(ID: 20:  @p_VNDOC);
          rc = RdbSetNum(ID: 21:  @p_VNDGJ);
          rc = RdbSetNum(ID: 22:  @p_VNJELN);
          rc = RdbSetStr(ID: 23:  @p_VNEXTL);
          rc = RdbSetStr(ID: 24:  @p_VNPOST);
          rc = RdbSetNum(ID: 25:  @p_VNICU);
          rc = RdbSetStr(ID: 26:  @p_VNICUT);
          rc = RdbSetNum(ID: 27:  @p_VNDICJ);
          rc = RdbSetNum(ID: 28:  @p_VNDSYJ);
          rc = RdbSetNum(ID: 29:  @p_VNTICU);
          rc = RdbSetStr(ID: 30:  @p_VNCO);

          rc = RdbSetStr(ID: 31:  @p_VNANI);
          rc = RdbSetStr(ID: 32:  @p_VNAM);
          rc = RdbSetStr(ID: 33:  @p_VNAID);
          rc = RdbSetStr(ID: 34:  @p_VNMCU);
          rc = RdbSetStr(ID: 35:  @p_VNOBJ);
          rc = RdbSetStr(ID: 36:  @p_VNSUB);
          rc = RdbSetStr(ID: 37:  @p_VNSBL);
          rc = RdbSetStr(ID: 38:  @p_VNSBLT);
          rc = RdbSetStr(ID: 39:  @p_VNLT);
          rc = RdbSetNum(ID: 40:  @p_VNPN);
          rc = RdbSetNum(ID: 41:  @p_VNCTRY);
          rc = RdbSetNum(ID: 42:  @p_VNFY);
          rc = RdbSetStr(ID: 43:  @p_VNFQ);
          rc = RdbSetStr(ID: 44:  @p_VNCRCD);
          rc = RdbSetNum(ID: 45:  @p_VNCRR);

          rc = RdbSetNum(ID: 46:  @p_VNHCRR);
          rc = RdbSetNum(ID: 47:  @p_VNHDGJ);
          rc = RdbSetNum(ID: 48:  @p_VNAA);
          rc = RdbSetNum(ID: 49:  @p_VNU);
          rc = RdbSetStr(ID: 50:  @p_VNUM);
          rc = RdbSetStr(ID: 51:  @p_VNGLC);
          rc = RdbSetStr(ID: 52:  @p_VNRE);
          rc = RdbSetStr(ID: 53:  @p_VNEXA);
          rc = RdbSetStr(ID: 54:  @p_VNEXR);
          rc = RdbSetStr(ID: 55:  @p_VNR1);
          rc = RdbSetStr(ID: 56:  @p_VNR2);
          rc = RdbSetStr(ID: 57:  @p_VNR3);
          rc = RdbSetStr(ID: 58:  @p_VNSFX);
          rc = RdbSetNum(ID: 59:  @p_VNODOC);
          rc = RdbSetStr(ID: 60:  @p_VNODCT);

          rc = RdbSetStr(ID: 61:  @p_VNOSFX);
          rc = RdbSetStr(ID: 62:  @p_VNPKCO);
          rc = RdbSetStr(ID: 63:  @p_VNOKCO);
          rc = RdbSetStr(ID: 64:  @p_VNPDCT);
          rc = RdbSetNum(ID: 65:  @p_VNAN8);
          rc = RdbSetStr(ID: 66:  @p_VNCN);
          rc = RdbSetNum(ID: 67:  @p_VNDKJ);
          rc = RdbSetNum(ID: 68:  @p_VNDKC);
          rc = RdbSetStr(ID: 69:  @p_VNASID);
          rc = RdbSetStr(ID: 70:  @p_VNBRE);
          rc = RdbSetStr(ID: 71:  @p_VNRCND);
          rc = RdbSetStr(ID: 72:  @p_VNSUMM);
          rc = RdbSetStr(ID: 73:  @p_VNPRGE);
          rc = RdbSetStr(ID: 74:  @p_VNTNN);
          rc = RdbSetStr(ID: 75:  @p_VNALT1);

          rc = RdbSetStr(ID: 76:  @p_VNALT2);
          rc = RdbSetStr(ID: 77:  @p_VNALT3);
          rc = RdbSetStr(ID: 78:  @p_VNALT4);
          rc = RdbSetStr(ID: 79:  @p_VNALT5);
          rc = RdbSetStr(ID: 80:  @p_VNALT6);
          rc = RdbSetStr(ID: 81:  @p_VNALT7);
          rc = RdbSetStr(ID: 82:  @p_VNALT8);
          rc = RdbSetStr(ID: 83:  @p_VNALT9);
          rc = RdbSetStr(ID: 84:  @p_VNALT0);
          rc = RdbSetStr(ID: 85:  @p_VNALTT);
          rc = RdbSetStr(ID: 86:  @p_VNALTU);
          rc = RdbSetStr(ID: 87:  @p_VNALTV);
          rc = RdbSetStr(ID: 88:  @p_VNALTW);
          rc = RdbSetStr(ID: 89:  @p_VNALTX);
          rc = RdbSetStr(ID: 90:  @p_VNALTZ);

          rc = RdbSetStr(ID: 91:  @p_VNDLNA);
          rc = RdbSetStr(ID: 92:  @p_VNCFF1);
          rc = RdbSetStr(ID: 93:  @p_VNCFF2);
          rc = RdbSetStr(ID: 94:  @p_VNASM);
          rc = RdbSetStr(ID: 95:  @p_VNBC);
          rc = RdbSetStr(ID: 96:  @p_VNVINV);
          rc = RdbSetNum(ID: 97:  @p_VNIVD);
          rc = RdbSetStr(ID: 98:  @p_VNWR01);
          rc = RdbSetStr(ID: 99:  @p_VNPO);
          rc = RdbSetStr(ID: 100: @p_VNPSFX);
          rc = RdbSetStr(ID: 101: @p_VNDCTO);
          rc = RdbSetNum(ID: 102: @p_VNLNID);
          rc = RdbSetNum(ID: 103: @p_VNWY);
          rc = RdbSetNum(ID: 104: @p_VNWN);
          rc = RdbSetStr(ID: 105: @p_VNFNLP);

          rc = RdbSetNum(ID: 106: @p_VNOPSQ);
          rc = RdbSetStr(ID: 107: @p_VNJBCD);
          rc = RdbSetStr(ID: 108: @p_VNJBST);
          rc = RdbSetStr(ID: 109: @p_VNHMCU);
          rc = RdbSetNum(ID: 110: @p_VNDOI);
          rc = RdbSetStr(ID: 111: @p_VNALID);
          rc = RdbSetStr(ID: 112: @p_VNALTY);
          rc = RdbSetNum(ID: 113: @p_VNDSVJ);
          rc = RdbSetStr(ID: 114: @p_VNTORG);
          rc = RdbSetNum(ID: 115: @p_VNREG#);
          rc = RdbSetNum(ID: 116: @p_VNPYID);
          rc = RdbSetStr(ID: 117: @p_VNUSER);
          rc = RdbSetStr(ID: 118: @p_VNPID);
          rc = RdbSetStr(ID: 119: @p_VNJOBN);
          rc = RdbSetNum(ID: 120: @p_VNUPMJ);

          rc = RdbSetNum(ID: 121: @p_VNUPMT);
          rc = RdbSetStr(ID: 122: @p_VNCRRM);
          rc = RdbSetNum(ID: 123: @p_VNACR);
          rc = RdbSetNum(ID: 124: @p_VNDGM);
          rc = RdbSetNum(ID: 125: @p_VNDGD);
          rc = RdbSetNum(ID: 126: @p_VNDGY);
          rc = RdbSetNum(ID: 127: @p_VNDG#);
          rc = RdbSetNum(ID: 128: @p_VNDICM);
          rc = RdbSetNum(ID: 129: @p_VNDICD);
          rc = RdbSetNum(ID: 130: @p_VNDICY);
          rc = RdbSetNum(ID: 131: @p_VNDIC#);
          rc = RdbSetNum(ID: 132: @p_VNDSYM);
          rc = RdbSetNum(ID: 133: @p_VNDSYD);
          rc = RdbSetNum(ID: 134: @p_VNDSYY);
          rc = RdbSetNum(ID: 135: @p_VNDSY#);

          rc = RdbSetNum(ID: 136: @p_VNDKM);
          rc = RdbSetNum(ID: 137: @p_VNDKD);
          rc = RdbSetNum(ID: 138: @p_VNDKY);
          rc = RdbSetNum(ID: 139: @p_VNDK#);
          rc = RdbSetNum(ID: 140: @p_VNDSVM);
          rc = RdbSetNum(ID: 141: @p_VNDSVD);
          rc = RdbSetNum(ID: 142: @p_VNDSVY);
          rc = RdbSetNum(ID: 143: @p_VNDSV#);
          rc = RdbSetNum(ID: 144: @p_VNHDGM);
          rc = RdbSetNum(ID: 145: @p_VNHDGD);
          rc = RdbSetNum(ID: 146: @p_VNHDGY);
          rc = RdbSetNum(ID: 147: @p_VNHDG#);
          rc = RdbSetNum(ID: 148: @p_VNDKCM);
          rc = RdbSetNum(ID: 149: @p_VNDKCD);
          rc = RdbSetNum(ID: 150: @p_VNDKCY);

          rc = RdbSetNum(ID: 151: @p_VNDKC#);
          rc = RdbSetNum(ID: 152: @p_VNIVDM);
          rc = RdbSetNum(ID: 153: @p_VNIVDD);
          rc = RdbSetNum(ID: 154: @p_VNIVDY);
          rc = RdbSetNum(ID: 155: @p_VNIVD#);
          rc = RdbSetStr(ID: 156: @p_VNABR1);
          rc = RdbSetStr(ID: 157: @p_VNABR2);
          rc = RdbSetStr(ID: 158: @p_VNABR3);
          rc = RdbSetStr(ID: 159: @p_VNABR4);
          rc = RdbSetStr(ID: 160: @p_VNABT1);
          rc = RdbSetStr(ID: 161: @p_VNABT2);
          rc = RdbSetStr(ID: 162: @p_VNABT3);
          rc = RdbSetStr(ID: 163: @p_VNABT4);
          rc = RdbSetNum(ID: 164: @p_VNITM );
          rc = RdbSetStr(ID: 165: @p_VNPM01);
          rc = RdbSetStr(ID: 166: @p_VNPM02);
          rc = RdbSetStr(ID: 167: @p_VNPM03);
          rc = RdbSetStr(ID: 168: @p_VNPM04);
          rc = RdbSetStr(ID: 169: @p_VNPM05);
          rc = RdbSetStr(ID: 170: @p_VNPM06);
          rc = RdbSetStr(ID: 171: @p_VNPM07);
          rc = RdbSetStr(ID: 172: @p_VNPM08);
          rc = RdbSetStr(ID: 173: @p_VNPM09);
          rc = RdbSetStr(ID: 174: @p_VNPM10);
          rc = RdbSetStr(ID: 175: @p_VNBCRC);
          rc = RdbSetStr(ID: 176: @p_VNEXR1);
          rc = RdbSetStr(ID: 177: @p_VNTXA1);
          rc = RdbSetNum(ID: 178: @p_VNTXITM);
          rc = RdbSetStr(ID: 179: @p_VNACTB);
          rc = RdbSetNum(ID: 180: @p_VNSTAM);
          rc = RdbSetNum(ID: 181: @p_VNCTAM);
          rc = RdbSetNum(ID: 182: @p_VNAG);
          rc = RdbSetNum(ID: 183: @p_VNAGF);
          rc = RdbSetStr(ID: 184: @p_VNTKTX);
          rc = RdbSetNum(ID: 185: @p_VNDLNID);
          rc = RdbSetStr(ID: 186: @p_VNCKNU);
          rc = RdbSetStr(ID: 187: @p_VNBUPC);
          rc = RdbSetStr(ID: 188: @p_VNAHBU);
          rc = RdbSetStr(ID: 189: @p_VNEPGC);
          rc = RdbSetStr(ID: 190: @p_VNJPGC);
          rc = RdbSetNum(ID: 191: @p_VNRC5 );
          rc = RdbSetNum(ID: 192: @p_VNSFXE);
          rc = RdbSetStr(ID: 193: @p_VNOFM);

   ‚      // Executing Prepared Stmt ...
          rc = RdbPrepExec(Id);

   ‚      // Prepared Stmt was not successful ....
          if rc < 0;
             exSr $errorSr;
          endif;

       endSr;

     ‚* ----------------------------------------------------------- *
     ‚* Error Routine ....                                          *
     ‚* ----------------------------------------------------------- *
       begsr $errorSr;

   ‚   // Error - Job is ended ....
       @p_Error='Y';
       RdbError(@ErrId: @ErrText);

       if @Errid = *blank;
          @Errid='SCHEMNF';
          @ErrText=companyId;
       endif;

       @p_vno6tx=@Errid;
       @p_vno7tx=@ErrText;

       if Id >= 0;
          RdbClose(Id);
       endif;

       *inLr = *on;
       return;

       endSr;

     ‚* ----------------------------------------------------------- *
     ‚* Initial Routine ....                                        *
     ‚* ----------------------------------------------------------- *
       begSr *InzSr;

          if @p_vnco > '00000';
                 companyId=%subst(@p_vnco:3:3);
                 else;
                 companyId=%subst(@p_vnkco:3:3);
                 endif;

   ‚   // Retrieving RDB Connection ....
       rtvRDBCfg(rtnCode: companyId:  pCon:
                 pSchm:   scon:      sSchm:      pJDEVer);

   ‚   // Defaulting error flag ....
       @p_Error='N';

   ‚   // It works only for MS SQL ....
       select;
         when pJDEVer = 'C' or pJDEVer = 'S';   // Primary
              @con  = pCon;
              @schm = pSchm;
         when pJDEVer = 'B';                    // Secondary
              @con  = sCon;
              @schm = sSchm;
         Other;
              exSr $errorSr;                    // Iseries no valid
       endSl;


       endSr;
      /END-FREE
