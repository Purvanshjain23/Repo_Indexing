     H/TITLE UPD Confrm - Ship Post XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/30/23  Time  : 09:54:36
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FOMFNCPL3IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      *
     FOMFNCPLBIF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord#/Seq/Seq2/Prd/Lot
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMFNCPL0UF  E           K        DISK
      * UPD : Manifest Detail           Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@FNCPUW
      * Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      * Renamed input format fields
     I              FNAIC3                          WBAIC3
     I              FNC4NB                          WBC4NB
     I              FNDPNB                          WBDPNB
     I              FNUENB                          WBUENB
     I              FNRZNB                          WBRZNB
     I              FNFOQT                          WBFOQT
     I              FNR0NB                          WBR0NB
     I              FNPMST                          WBPMST
     I              FNK7DT                          WBK7DT
     I              FNPFNX                          WBPFNX
     I              FNHGCD                          WBHGCD
     I              FNAJCD                          WBAJCD
     I              FNELDT                          WBELDT
     I              FNN5WG                          WBN5WG
     I              FNRZNA                          WBRZNA
     I              FNH5NY                          WBH5NY
     I              FNH6NY                          WBH6NY
     I              FNH7NY                          WBH7NY
     I              FNGBTX                          WBGBTX
     I              FNN6WG                          WBN6WG
     I              FNN7WG                          WBN7WG
     I              FNGCTX                          WBGCTX
     I              FNGDTX                          WBGDTX
     I              FNRBDT                          WBRBDT
     I              FNITNY                          WBITNY
     I              FNIVNY                          WBIVNY
     I              FNIUNY                          WBIUNY
     I              FNIWNY                          WBIWNY
     I              FNIXNY                          WBIXNY
     I              FNIYNY                          WBIYNY
     I              FNUVST                          WBUVST
     I              FNUWST                          WBUWST
     I              FNUXST                          WBUXST
     I              FNVSST                          WBVSST
     I              FNAATM                          WBAATM
     I              FNAYNA                          WBAYNA
     I              FNA0NA                          WBA0NA
     I              FNAXDT                          WBAXDT
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WCAIC3
     I              FNC4NB                          WCC4NB
     I              FNDPNB                          WCDPNB
     I              FNUENB                          WCUENB
     I              FNRZNB                          WCRZNB
     I              FNFOQT                          WCFOQT
     I              FNR0NB                          WCR0NB
     I              FNPMST                          WCPMST
     I              FNK7DT                          WCK7DT
     I              FNPFNX                          WCPFNX
     I              FNHGCD                          WCHGCD
     I              FNAJCD                          WCAJCD
     I              FNELDT                          WCELDT
     I              FNN5WG                          WCN5WG
     I              FNRZNA                          WCRZNA
     I              FNH5NY                          WCH5NY
     I              FNH6NY                          WCH6NY
     I              FNH7NY                          WCH7NY
     I              FNGBTX                          WCGBTX
     I              FNN6WG                          WCN6WG
     I              FNN7WG                          WCN7WG
     I              FNGCTX                          WCGCTX
     I              FNGDTX                          WCGDTX
     I              FNRBDT                          WCRBDT
     I              FNITNY                          WCITNY
     I              FNIVNY                          WCIVNY
     I              FNIUNY                          WCIUNY
     I              FNIWNY                          WCIWNY
     I              FNIXNY                          WCIXNY
     I              FNIYNY                          WCIYNY
     I              FNUVST                          WCUVST
     I              FNUWST                          WCUWST
     I              FNUXST                          WCUXST
     I              FNVSST                          WCVSST
     I              FNAATM                          WCAATM
     I              FNAYNA                          WCAYNA
     I              FNA0NA                          WCA0NA
     I              FNAXDT                          WCAXDT
      *
     I@FNCPK7
      * Manifest Detail           Co/Ord#/Seq/Seq2/Prd/Lot
      * Renamed input format fields
     I              FNAIC3                          WDAIC3
     I              FNC4NB                          WDC4NB
     I              FNDPNB                          WDDPNB
     I              FNUENB                          WDUENB
     I              FNRZNB                          WDRZNB
     I              FNFOQT                          WDFOQT
     I              FNR0NB                          WDR0NB
     I              FNPMST                          WDPMST
     I              FNK7DT                          WDK7DT
     I              FNPFNX                          WDPFNX
     I              FNHGCD                          WDHGCD
     I              FNAJCD                          WDAJCD
     I              FNELDT                          WDELDT
     I              FNN5WG                          WDN5WG
     I              FNRZNA                          WDRZNA
     I              FNH5NY                          WDH5NY
     I              FNH6NY                          WDH6NY
     I              FNH7NY                          WDH7NY
     I              FNGBTX                          WDGBTX
     I              FNN6WG                          WDN6WG
     I              FNN7WG                          WDN7WG
     I              FNGCTX                          WDGCTX
     I              FNGDTX                          WDGDTX
     I              FNRBDT                          WDRBDT
     I              FNITNY                          WDITNY
     I              FNIVNY                          WDIVNY
     I              FNIUNY                          WDIUNY
     I              FNIWNY                          WDIWNY
     I              FNIXNY                          WDIXNY
     I              FNIYNY                          WDIYNY
     I              FNUVST                          WDUVST
     I              FNUWST                          WDUWST
     I              FNUXST                          WDUXST
     I              FNVSST                          WDVSST
     I              FNAATM                          WDAATM
     I              FNAYNA                          WDAYNA
     I              FNA0NA                          WDA0NA
     I              FNAXDT                          WDAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WEAIC3
     I              BZHGCD                          WEHGCD
     I              BZAVNA                          WEAVNA
     I              BZAWNA                          WEAWNA
     I              BZL7NA                          WEL7NA
     I              BZL8NA                          WEL8NA
     I              BZL6NA                          WEL6NA
     I              BZMFNA                          WEMFNA
     I              BZADCD                          WEADCD
     I              BZAWPC                          WEAWPC
     I              BZLXST                          WELXST
     I              BZAECD                          WEAECD
     I              BZAXPC                          WEAXPC
     I              BZLYST                          WELYST
     I              BZAFCD                          WEAFCD
     I              BZAICD                          WEAICD
     I              BZAIWG                          WEAIWG
     I              BZHICD                          WEHICD
     I              BZRBCD                          WERBCD
     I              BZFZST                          WEFZST
     I              BZAVST                          WEAVST
     I              BZCZWG                          WECZWG
     I              BZC0WG                          WEC0WG
     I              BZURTN                          WEURTN
     I              BZAJC8                          WEAJC8
     I              BZRINB                          WERINB
     I              BZRHNB                          WERHNB
     I              BZRGNB                          WERGNB
     I              BZLNCD                          WELNCD
     I              BZTFNB                          WETFNB
     I              BZN0CD                          WEN0CD
     I              BZX4ST                          WEX4ST
     I              BZTMVA                          WETMVA
     I              BZTNVA                          WETNVA
     I              BZBLPR                          WEBLPR
     I              BZBMPR                          WEBMPR
     I              BZLRCD                          WELRCD
     I              BZU9ST                          WEU9ST
     I              BZCMCO                          WECMCO
     I              BZQ1CD                          WEQ1CD
     I              BZQ8CD                          WEQ8CD
     I              BZCHTM                          WECHTM
     I              BZQZCD                          WEQZCD
     I              BZXWST                          WEXWST
     I              BZXXST                          WEXXST
     I              BZVMST                          WEVMST
     I              BZSWGH                          WESWGH
     I              BZPPHE                          WEPPHE
     I              BZR3CD                          WER3CD
     I              BZSDCD                          WESDCD
     I              BZICN1                          WEICN1
     I              BZSVCD                          WESVCD
     I              BZICN2                          WEICN2
     I              BZSWCD                          WESWCD
     I              BZV2NB                          WEV2NB
     I              BZSXCD                          WESXCD
     I              BZITCN                          WEITCN
     I              BZSYCD                          WESYCD
     I              BZITC5                          WEITC5
     I              BZSZCD                          WESZCD
     I              BZICN6                          WEICN6
     I              BZS0CD                          WES0CD
     I              BZICN7                          WEICN7
     I              BZS1CD                          WES1CD
     I              BZICN8                          WEICN8
     I              BZS2CD                          WES2CD
     I              BZICN9                          WEICN9
     I              BZS3CD                          WES3CD
     I              BZICN0                          WEICN0
     I              BZS4CD                          WES4CD
     I              BZSFNB                          WESFNB
     I              BZA3WG                          WEA3WG
     I              BZSJNB                          WESJNB
     I              BZLLCD                          WELLCD
     I              BZLMCD                          WELMCD
     I              BZP3ST                          WEP3ST
     I              BZSKNB                          WESKNB
     I              BZSLNB                          WESLNB
     I              BZSMNB                          WESMNB
     I              BZP4ST                          WEP4ST
     I              BZCFNB                          WECFNB
     I              BZCGNB                          WECGNB
     I              BZILNB                          WEILNB
     I              BZCHNB                          WECHNB
     I              BZCINB                          WECINB
     I              BZCJNB                          WECJNB
     I              BZCMNB                          WECMNB
     I              BZCNNB                          WECNNB
     I              BZCRNB                          WECRNB
     I              BZCSNB                          WECSNB
     I              BZCVNB                          WECVNB
     I              BZCWNB                          WECWNB
     I              BZCXNB                          WECXNB
     I              BZCZNB                          WECZNB
     I              BZC0NB                          WEC0NB
     I              BZN1CD                          WEN1CD
     I              BZB4NB                          WEB4NB
     I              BZB5NB                          WEB5NB
     I              BZX5ST                          WEX5ST
     I              BZX6ST                          WEX6ST
     I              BZX7ST                          WEX7ST
     I              BZPCCT                          WEPCCT
     I              BZBDNB                          WEBDNB
     I              BZBJNB                          WEBJNB
     I              BZSUST                          WESUST
     I              BZSVST                          WESVST
     I              BZSYST                          WESYST
     I              BZSZST                          WESZST
     I              BZS1ST                          WES1ST
     I              BZXRCD                          WEXRCD
     I              BZXTCD                          WEXTCD
     I              BZXUCD                          WEXUCD
     I              BZF5WG                          WEF5WG
     I              BZF6WG                          WEF6WG
     I              BZF7WG                          WEF7WG
     I              BZBLNB                          WEBLNB
     I              BZBNNB                          WEBNNB
     I              BZS2ST                          WES2ST
     I              BZS4ST                          WES4ST
     I              BZS5ST                          WES5ST
     I              BZS6ST                          WES6ST
     I              BZS8ST                          WES8ST
     I              BZS9ST                          WES9ST
     I              BZTCST                          WETCST
     I              BZTDST                          WETDST
     I              BZUVST                          WEUVST
     I              BZUWST                          WEUWST
     I              BZUXST                          WEUXST
     I              BZVSST                          WEVSST
     I              BZAATM                          WEAATM
     I              BZAYNA                          WEAYNA
     I              BZA0NA                          WEA0NA
     I              BZAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WCAIC3
     I              FNC4NB                          WCC4NB
     I              FNDPNB                          WCDPNB
     I              FNUENB                          WCUENB
     I              FNRZNB                          WCRZNB
     I              FNFOQT                          WCFOQT
     I              FNR0NB                          WCR0NB
     I              FNPMST                          WCPMST
     I              FNK7DT                          WCK7DT
     I              FNPFNX                          WCPFNX
     I              FNHGCD                          WCHGCD
     I              FNAJCD                          WCAJCD
     I              FNELDT                          WCELDT
     I              FNN5WG                          WCN5WG
     I              FNRZNA                          WCRZNA
     I              FNH5NY                          WCH5NY
     I              FNH6NY                          WCH6NY
     I              FNH7NY                          WCH7NY
     I              FNGBTX                          WCGBTX
     I              FNN6WG                          WCN6WG
     I              FNN7WG                          WCN7WG
     I              FNGCTX                          WCGCTX
     I              FNGDTX                          WCGDTX
     I              FNRBDT                          WCRBDT
     I              FNITNY                          WCITNY
     I              FNIVNY                          WCIVNY
     I              FNIUNY                          WCIUNY
     I              FNIWNY                          WCIWNY
     I              FNIXNY                          WCIXNY
     I              FNIYNY                          WCIYNY
     I              FNUVST                          WCUVST
     I              FNUWST                          WCUWST
     I              FNUXST                          WCUXST
     I              FNVSST                          WCVSST
     I              FNAATM                          WCAATM
     I              FNAYNA                          WCAYNA
     I              FNA0NA                          WCA0NA
     I              FNAXDT                          WCAXDT
      *
     IYARDCS      DS                            159
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * I :  Item Code
     I                                    P  11  140P1HGCD
      * I :  Warehouse Code
     I                                       15  17 P1AJCD
      * I :  U_M_Ordered
     I                                       18  19 P1AGCD
      * I :  Actual Shipped Date
     I                                    P  20  230P1GNDT
     IP2PARM      DS
      * FLD: Order Header TRG
      * I :  Billing Activity Type
     I                                        1   1 P2OBST
     IP3PARM      DS
      * I :  To Warehouse Code  USR
     I                                        1   3 P3WKCD
     IP4PARM      DS
      * I :  Inter-Plant Transfer USR
     I                                        1   1 P4A5TX
     IP5PARM      DS
      * FLD: *Arrays
      * I :  Called From Program
     I                                        1  10 P5COAB
      * O :  Send Email f/Failed API U
     I                                       11  11 P5OVSC
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1AJCD    PARM           WP0006  3        Warehouse Code
     C           P1AGCD    PARM           WP0007  2        U_M_Ordered
     C           P1GNDT    PARM           WP0008  70       Actual Shipped
     C           P2OBST    PARM           WP0009  1        Billing Activit
     C           P3WKCD    PARM           WP0010  3        To Warehouse Co
     C           P4A5TX    PARM           WP0011  1        Inter-Plant Tra
     C           P5COAB    PARM           WP0012 10        Called From Pro
     C           P5OVSC    PARM P5OVSC    WP0013  1        Send Email f/Fa
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Confrm - Ship Post XF
      * RTV Whse Dft Load Typ RT - Warehouse  * 
     C                     EXSR SARVGN
      * CASE: LCL.WHS Default Load Type is Bulk
     C           YL0001    IFEQ 'B'                        *IF
      * RTV Chg Prod/Lbl Dt   RT - Manifest Detail  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * WI517 DN 10/03/23-Added 'Called From Program' as Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * UPD Inv From Shipping  RT - Manifest Detail  * 
     C                     EXSR SDRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Whse Dft Load Typ RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1AJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSA     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           WHS Default Loa
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAT7ST    YL0001           WHS Default Loa
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Chg Prod/Lbl Dt   RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1C4NB    WQSB02           Order Number
      * Establish starting position
     C           KRSSB     SETLL@FNCPUW                    *
     C           KRSSB     READE@FNCPUW                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Label Date is not entered
     C           WBK7DT    IFEQ 0                          *IF
     C                     Z-ADDP1GNDT    YL0002           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBK7DT    YL0002           Label Date
     C                     END                             *FI
      * CASE: DB1.Production Date is not entered
     C           WBELDT    IFEQ 0                          *IF
     C                     Z-ADDP1GNDT    YL0003           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBELDT    YL0003           Production Date
     C                     END                             *FI
      * CHG OM Manifest Detail CH - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     Z-ADDWBRZNB    WL0005           Case Sequence N
     C                     Z-ADDWBFOQT    WL0006           Case Quantity
     C                     Z-ADDWBR0NB    WL0007           Case Weight
     C                     MOVELWBPMST    WL0008    P      Inventory Updat
     C                     Z-ADDYL0002    WL0009           Label Date
     C                     Z-ADDWBPFNX    WL0010           PT Serial Numbe
     C                     Z-ADDWBHGCD    WL0011           Item Code
     C                     MOVELWBAJCD    WL0012    P      Warehouse Code
     C                     Z-ADDYL0003    WL0013           Production Date
     C                     Z-ADDWBN5WG    WL0014           Manifest Gross
     C                     MOVELWBRZNA    WL0015    P      Manifest Lot ID
     C                     Z-ADDWBH5NY    WL0016           Manifest Total
     C                     Z-ADDWBH6NY    WL0017           Manifest Co-Par
     C                     Z-ADDWBH7NY    WL0018           Manifest Pallet
     C                     MOVELWBGBTX    WL0019    P      Manifest Shift
     C                     Z-ADDWBN6WG    WL0020           HPB Meter Net G
     C                     Z-ADDWBN7WG    WL0021           Manifest Net We
     C                     MOVELWBGCTX    WL0022    P      Manifest Unused
     C                     MOVELWBGDTX    WL0023    P      Manifest Unused
     C                     Z-ADDWBRBDT    WL0024           Manifest Unused
     C                     Z-ADDWBITNY    WL0025           HPB COA Batch N
     C                     Z-ADDWBIVNY    WL0026           HPB Meter Start
     C                     Z-ADDWBIUNY    WL0027           HPB Meter Endin
     C                     Z-ADDWBIWNY    WL0028           HPB Meter Total
     C                     Z-ADDWBIXNY    WL0029           HPB Meter Net W
     C                     Z-ADDWBIYNY    WL0030           HPB Density Ref
     C                     MOVELWBUVST    WL0031    P      EDI Status 1
     C                     MOVELWBUWST    WL0032    P      EDI Status 2
     C                     MOVELWBUXST    WL0033    P      EDI Status 3
     C                     MOVELWBVSST    WL0034    P      Record Status
     C                     Z-ADDWBAATM    WL0035           Job Time
     C                     MOVELWBAYNA    WL0036    P      User Id
     C                     MOVELWBA0NA    WL0037    P      Job Name
     C                     Z-ADDWBAXDT    WL0038           Job Date
     C                     MOVELWUR4ST    WL0039    P      USR Update Flag
     C                     EXSR SCCHRC
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    WUR4ST    P      USR Update Flag
     C                     MOVELWL0040    YL0004    P      COA RIN Modifie
     C           KRSSB     READE@FNCPUW                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * CHG OM Manifest Detail CH - Manifest Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FNCPCS
     C                     Z-ADDWL0001    WCAIC3           Company Number
     C                     Z-ADDWL0002    WCC4NB           Order Number
     C                     Z-ADDWL0003    WCDPNB           Order Sequence
     C                     Z-ADDWL0004    WCUENB           Order Secondary
     C                     Z-ADDWL0005    WCRZNB           Case Sequence N
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCRZNB           Case Sequence N
     C           KLCHSC    CHAIN@FNCPCS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFN1    YARDCS
      * Move non-key fields to @FNCPCS
     C                     Z-ADDWL0006    WCFOQT           Case Quantity
     C                     Z-ADDWL0007    WCR0NB           Case Weight
     C                     MOVELWL0008    WCPMST    P      Inventory Updat
     C                     Z-ADDWL0009    WCK7DT           Label Date
     C                     Z-ADDWL0010    WCPFNX           PT Serial Numbe
     C                     Z-ADDWL0011    WCHGCD           Item Code
     C                     MOVELWL0012    WCAJCD    P      Warehouse Code
     C                     Z-ADDWL0013    WCELDT           Production Date
     C                     Z-ADDWL0014    WCN5WG           Manifest Gross
     C                     MOVELWL0015    WCRZNA    P      Manifest Lot ID
     C                     Z-ADDWL0016    WCH5NY           Manifest Total
     C                     Z-ADDWL0017    WCH6NY           Manifest Co-Par
     C                     Z-ADDWL0018    WCH7NY           Manifest Pallet
     C                     MOVELWL0019    WCGBTX    P      Manifest Shift
     C                     Z-ADDWL0020    WCN6WG           HPB Meter Net G
     C                     Z-ADDWL0021    WCN7WG           Manifest Net We
     C                     MOVELWL0022    WCGCTX    P      Manifest Unused
     C                     MOVELWL0023    WCGDTX    P      Manifest Unused
     C                     Z-ADDWL0024    WCRBDT           Manifest Unused
     C                     Z-ADDWL0025    WCITNY           HPB COA Batch N
     C                     Z-ADDWL0026    WCIVNY           HPB Meter Start
     C                     Z-ADDWL0027    WCIUNY           HPB Meter Endin
     C                     Z-ADDWL0028    WCIWNY           HPB Meter Total
     C                     Z-ADDWL0029    WCIXNY           HPB Meter Net W
     C                     Z-ADDWL0030    WCIYNY           HPB Density Ref
     C                     MOVELWL0031    WCUVST    P      EDI Status 1
     C                     MOVELWL0032    WCUWST    P      EDI Status 2
     C                     MOVELWL0033    WCUXST    P      EDI Status 3
     C                     MOVELWL0034    WCVSST    P      Record Status
     C                     Z-ADDWL0035    WCAATM           Job Time
     C                     MOVELWL0036    WCAYNA    P      User Id
     C                     MOVELWL0037    WCA0NA    P      Job Name
     C                     Z-ADDWL0038    WCAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WCAATM' defaulted for 'Job Time'.
      * Field '(DB1) WCAYNA' defaulted for 'User Id'.
      * Field '(DB1) WCA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WCAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FNCPCS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
     C                     MOVEL'Y'       WL0039           USR Update Flag
     C                     MOVEL'Y'       WL0040           COA RIN Modifie
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * UPD Inv From Shipping  RT - Manifest Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Label Date
     C                     Z-ADD*ZERO     WN0002  70       Production Date
     C                     MOVEL*BLANK    WN0003 10        Manifest Lot ID
     C                     Z-ADD*ZERO     WN0004 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0005 112       Weight Shipped
     C                     MOVEL*BLANK    WN0006  1        First Time Flag
     C                     Z-ADD*ZERO     WN0007 112       Weight Billed
     C                     MOVEL*BLANK    WN0008 30        Description
     C                     MOVEL*BLANK    WN0009  2        UOM Cost
     C                     MOVEL*BLANK    WN0010  1        Shift Number
     C                     MOVEL*BLANK    WN0011 30        Description Lin
     C                     MOVEL*BLANK    WN0012 30        Description Lin
     C                     MOVEL*BLANK    WN0013  2        UOM Primary
     C                     Z-ADD*ZERO     WN0014  94       Conversion Fact
     C                     MOVEL*BLANK    WN0015  1        Operation Facto
     C                     MOVEL*BLANK    WN0016  2        UOM Second
     C                     Z-ADD*ZERO     WN0017  94       Conversion Fact
     C                     MOVEL*BLANK    WN0018  1        Operation Facto
     C                     MOVEL*BLANK    WN0019  2        UOM Third
     C                     MOVEL*BLANK    WN0020  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0021 112       Unit Weight
     C                     MOVEL*BLANK    WN0022  1        Production Date
     C                     MOVEL*BLANK    WN0023  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0024 114       Cost based on U
     C                     Z-ADD*ZERO     WN0025 114       Cost based on U
     C                     Z-ADD*ZERO     WN0026 114       Cost based on U
     C                     Z-ADD*ZERO     WN0027  80       HPB Meter Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0006           First Time Flag
     C                     Z-ADD*ZERO     WN0004           Quantity Shippe
     C                     Z-ADD*ZERO     WN0005           Weight Shipped
     C                     Z-ADD*ZERO     WN0007           Weight Billed
     C                     MOVEL'1'       WN0010           Shift Number
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0005    PARM *ZERO     WQ0001 155       Current System
     C           YL0006    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Initialize Flags.
     C                     MOVEL'N'       YL0007           API was Called?
     C                     MOVEL'N'       YL0008           Inventory Updat
     C                     MOVEL'Y'       YL0009           First Time Thro
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
     C           *LIKE     DEFN WDDPNB    WQSD03           Order Sequence
     C           *LIKE     DEFN WDUENB    WQSD04           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDP1C4NB    WQSD02           Order Number
     C                     Z-ADDP1DPNB    WQSD03           Order Sequence
     C                     Z-ADDP1UENB    WQSD04           Order Secondary
      * Establish starting position
     C           KRSSD     SETLL@FNCPK7                    *
     C           KRSSD     READE@FNCPK7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Label Date
     C                     Z-ADD*ZERO     WN0002           Production Date
     C                     MOVEL*BLANK    WN0003           Manifest Lot ID
     C                     Z-ADD*ZERO     WN0004           Quantity Shippe
     C                     Z-ADD*ZERO     WN0005           Weight Shipped
     C                     MOVEL*BLANK    WN0006           First Time Flag
     C                     Z-ADD*ZERO     WN0007           Weight Billed
     C                     MOVEL*BLANK    WN0008           Description
     C                     MOVEL*BLANK    WN0009           UOM Cost
     C                     MOVEL*BLANK    WN0010           Shift Number
     C                     MOVEL*BLANK    WN0011           Description Lin
     C                     MOVEL*BLANK    WN0012           Description Lin
     C                     MOVEL*BLANK    WN0013           UOM Primary
     C                     Z-ADD*ZERO     WN0014           Conversion Fact
     C                     MOVEL*BLANK    WN0015           Operation Facto
     C                     MOVEL*BLANK    WN0016           UOM Second
     C                     Z-ADD*ZERO     WN0017           Conversion Fact
     C                     MOVEL*BLANK    WN0018           Operation Facto
     C                     MOVEL*BLANK    WN0019           UOM Third
     C                     MOVEL*BLANK    WN0020           UOM Pricing
     C                     Z-ADD*ZERO     WN0021           Unit Weight
     C                     MOVEL*BLANK    WN0022           Production Date
     C                     MOVEL*BLANK    WN0023           Catch Weight St
     C                     Z-ADD*ZERO     WN0024           Cost based on U
     C                     Z-ADD*ZERO     WN0025           Cost based on U
     C                     Z-ADD*ZERO     WN0026           Cost based on U
     C                     Z-ADD*ZERO     WN0027           HPB Meter Total
     C                     MOVEL*BLANK    P5OVSC           Send Email f/Fa
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set production date for break usage & rtv item info
      * CASE: PAR.First Time Flag is Yes
     C           WN0006    IFEQ 'Y'                        *IF
     C                     Z-ADDWDELDT    WN0002           Production Date
     C                     MOVELWDRZNA    WN0003           Manifest Lot ID
     C                     Z-ADDWDK7DT    WN0001           Label Date
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SERVGN
      * Set unit of measure for cost
      * CASE: PAR.Catch Weight Status is yes
     C           WN0023    IFEQ 'Y'                        *IF
     C                     MOVEL'LB'      WN0009           UOM Cost
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWN0013    WN0009           UOM Cost
     C                     END                             *FI
     C                     MOVEL*BLANK    WUE7TX           Order Number Al
     C                     MOVELP1C4NB    WUE7TX           Order Number Al
     C                     MOVEL@CN,001   WUI6TX           Description 14A
     C                     Z-ADD1         ZQ      50
     C           WUI6TX    CAT  WUE7TX:ZQ WN0008    P      Description
     C                     MOVEL'N'       WN0006           First Time Flag
     C                     END                             *FI
      * When production date changes update inventory files
      * CASE:
      *  - c2 OR c3
      *   |- c2    : PAR.Production Date NE DB1.Production Date
      *   |- c3    : PAR.Manifest Lot ID NE DB1.Manifest Lot ID
      *   '-
     C           WN0002    IFNE WDELDT                     *IF
     C           WN0003    ORNE WDRZNA                     *OR
      * Perform updates
      * CASE: PAR.Billing Activity Type is Invoice
     C           P2OBST    IFEQ '1'                        *IF
      * WI517 DN 07/07/23-Added 'Upd Both Legacy & WIM USR=Y',
      *   Added 'Inventory Updated USR', 'API was Called? U' &
      *   'Called From Program' Parms.
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0003  30       Company Number
     C                     PARM P1HGCD    WQ0004  70       Item Code
     C                     PARM P1AJCD    WQ0005  3        Warehouse Code
     C                     PARM 'I'       WQ0006  1        Inventory Trans
     C                     PARM 'IO'      WQ0007  2        Inventory Trans
     C                     PARM YL0005    WQ0008  70       Transaction Dat
     C                     PARM WN0002    WQ0009  70       Production Date
     C                     PARM 'OP'      WQ0010  2        Item Transactio
     C                     PARM WN0008    WQ0011 30        Description
     C                     PARM *BLANK    WQ0012  3        Reason Code
     C                     PARM WN0003    WQ0013 10        Lot ID
     C                     PARM P1C4NB    WQ0014  70       Order Number
     C                     PARM WN0010    WQ0015  1        Shift Number
     C                     PARM WN0001    WQ0016  70       Label Date
     C                     PARM WN0005    WQ0017 112       USR Weight Accu
     C                     PARM WN0004    WQ0018 112       Transaction Qty
     C                     PARM 'N'       WQ0019  1        USR Unship Flag
     C                     PARM 'Y'       WQ0020  1        Upd Both Legacy
     C           YL0008    PARM *BLANK    WQ0021  1        Inventory Updat
     C           YL0007    PARM *BLANK    WQ0022  1        API was Called?
     C                     PARM P5COAB    WQ0023 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'Y'                        *IF
     C           YL0008    IFEQ 'N'                        *IF
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0009           First Time Thro
     C                     MOVEL'Y'       P5OVSC           Send Email f/Fa
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P2OBST    IFEQ '4'                        *IF
      * WI517 DN 10/05/23-Added 'Inventory Updated USR', 'API was Called?
      *   & 'Called From Program' Parms.
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0024  30       Company Number
     C                     PARM P1HGCD    WQ0025  70       Item Code
     C                     PARM P1AJCD    WQ0026  3        Warehouse Code
     C                     PARM 'T'       WQ0027  1        Inventory Trans
     C                     PARM 'TW'      WQ0028  2        Inventory Trans
     C                     PARM YL0005    WQ0029  70       Transaction Dat
     C                     PARM WN0002    WQ0030  70       Production Date
     C                     PARM 'OP'      WQ0031  2        Item Transactio
     C                     PARM WN0008    WQ0032 30        Description
     C                     PARM *BLANK    WQ0033  3        Reason Code
     C                     PARM P1C4NB    WQ0034  70       Order Number
     C                     PARM WN0010    WQ0035  1        Shift Number
     C                     PARM WN0001    WQ0036  70       Label Date
     C                     PARM P3WKCD    WQ0037  3        USR Warehouse C
     C                     PARM WN0005    WQ0038 112       USR Weight Accu
     C                     PARM WN0004    WQ0039 112       USR Quantity
     C                     PARM 'N'       WQ0040  1        USR Unship Flag
     C                     PARM P4A5TX    WQ0041  1        Inter-Plant Tra
     C           YL0008    PARM *BLANK    WQ0042  1        Inventory Updat
     C           YL0007    PARM *BLANK    WQ0043  1        API was Called?
     C                     PARM P5COAB    WQ0044 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/05/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'Y'                        *IF
     C           YL0008    IFEQ 'N'                        *IF
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0009           First Time Thro
     C                     MOVEL'Y'       P5OVSC           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWDELDT    WN0002           Production Date
     C                     MOVELWDRZNA    WN0003           Manifest Lot ID
     C                     Z-ADDWDK7DT    WN0001           Label Date
     C                     Z-ADD*ZERO     WN0004           Quantity Shippe
     C                     Z-ADD*ZERO     WN0005           Weight Shipped
     C                     END                             *FI
      * Add up quantity and weight for production date
     C                     ADD  WDFOQT    WN0004           Quantity Shippe
     C                     ADD  WDR0NB    WN0005           Weight Shipped
     C                     ADD  WDR0NB    WN0007           Weight Billed
      * RMC FP1110 HPB Processing: Create RIN, create Batch Hdr RIN,
      *  Update Batch Header last EEEEEEEE gallon field
      * CASE: DB1.HPB COA Batch Number is Entered
     C           WDITNY    IFGT 0                          *IF
      * Exc Upd from Shipping XF - COA Batch Header  * 
     C                     CALL 'PMQMXFR'              90  Exc Upd from Sh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0045  30       Company Number
     C                     PARM WDITNY    WQ0046  50       COA Batch Numbe
     C                     PARM WDC4NB    WQ0047  70       Order Number
     C                     PARM WDDPNB    WQ0048  30       Order Sequence
     C                     PARM WDUENB    WQ0049  30       Order Secondary
     C                     PARM WDRZNB    WQ0050  50       Case Sequence N
     C                     PARM YL0010    WQ0051  70       Ship To Custome
     C                     PARM WDIWNY    WQ0052  80       HPB Meter Total
     C                     PARM WDAJCD    WQ0053  3        Warehouse Code
     C                     PARM WDHGCD    WQ0054  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSD     READE@FNCPK7                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update inventory for last production date read
      * CASE: PAR.Billing Activity Type is Invoice
     C           P2OBST    IFEQ '1'                        *IF
     C                     Z-ADDWN0004    WUWQNB           USR Counter
     C                     MOVEL*BLANK    WUASQY           AS Box Quantity
     C                     MOVELWUWQNB    WUASQY           AS Box Quantity
      * WI517 DN 07/07/23-Added 'Upd Both Legacy & WIM USR=Y'.
      *   Added 'Inventory Updated USR', 'API was Called? U' &
      *   'Called From Program' Parms.
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0055  30       Company Number
     C                     PARM P1HGCD    WQ0056  70       Item Code
     C                     PARM P1AJCD    WQ0057  3        Warehouse Code
     C                     PARM 'I'       WQ0058  1        Inventory Trans
     C                     PARM 'IO'      WQ0059  2        Inventory Trans
     C                     PARM YL0005    WQ0060  70       Transaction Dat
     C                     PARM WN0002    WQ0061  70       Production Date
     C                     PARM 'OP'      WQ0062  2        Item Transactio
     C                     PARM WN0008    WQ0063 30        Description
     C                     PARM *BLANK    WQ0064  3        Reason Code
     C                     PARM WN0003    WQ0065 10        Lot ID
     C                     PARM P1C4NB    WQ0066  70       Order Number
     C                     PARM WN0010    WQ0067  1        Shift Number
     C                     PARM WN0001    WQ0068  70       Label Date
     C                     PARM WN0005    WQ0069 112       USR Weight Accu
     C                     PARM WN0004    WQ0070 112       Transaction Qty
     C                     PARM 'N'       WQ0071  1        USR Unship Flag
     C                     PARM 'Y'       WQ0072  1        Upd Both Legacy
     C           YL0008    PARM *BLANK    WQ0073  1        Inventory Updat
     C           YL0007    PARM *BLANK    WQ0074  1        API was Called?
     C                     PARM P5COAB    WQ0075 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'Y'                        *IF
     C           YL0008    IFEQ 'N'                        *IF
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0009           First Time Thro
     C                     MOVEL'Y'       P5OVSC           Send Email f/Fa
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P2OBST    IFEQ '4'                        *IF
      * WI517 DN 10/05/23-Added 'Inventory Updated USR', 'API was Called?
      *   & 'Called From Program' Parms.
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0076  30       Company Number
     C                     PARM P1HGCD    WQ0077  70       Item Code
     C                     PARM P1AJCD    WQ0078  3        Warehouse Code
     C                     PARM 'T'       WQ0079  1        Inventory Trans
     C                     PARM 'TW'      WQ0080  2        Inventory Trans
     C                     PARM YL0005    WQ0081  70       Transaction Dat
     C                     PARM WN0002    WQ0082  70       Production Date
     C                     PARM 'OP'      WQ0083  2        Item Transactio
     C                     PARM WN0008    WQ0084 30        Description
     C                     PARM *BLANK    WQ0085  3        Reason Code
     C                     PARM P1C4NB    WQ0086  70       Order Number
     C                     PARM WN0010    WQ0087  1        Shift Number
     C                     PARM WN0001    WQ0088  70       Label Date
     C                     PARM P3WKCD    WQ0089  3        USR Warehouse C
     C                     PARM WN0005    WQ0090 112       USR Weight Accu
     C                     PARM WN0004    WQ0091 112       USR Quantity
     C                     PARM 'N'       WQ0092  1        USR Unship Flag
     C                     PARM P4A5TX    WQ0093  1        Inter-Plant Tra
     C           YL0008    PARM *BLANK    WQ0094  1        Inventory Updat
     C           YL0007    PARM *BLANK    WQ0095  1        API was Called?
     C                     PARM P5COAB    WQ0096 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/05/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'Y'                        *IF
     C           YL0008    IFEQ 'N'                        *IF
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0009           First Time Thro
     C                     MOVEL'Y'       P5OVSC           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     Z-ADDP1HGCD    WEHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0011           Description Lin
     C                     MOVEL*BLANK    WN0012           Description Lin
     C                     MOVEL*BLANK    WN0013           UOM Primary
     C                     Z-ADD*ZERO     WN0014           Conversion Fact
     C                     MOVEL*BLANK    WN0015           Operation Facto
     C                     MOVEL*BLANK    WN0016           UOM Second
     C                     Z-ADD*ZERO     WN0017           Conversion Fact
     C                     MOVEL*BLANK    WN0018           Operation Facto
     C                     MOVEL*BLANK    WN0019           UOM Third
     C                     MOVEL*BLANK    WN0020           UOM Pricing
     C                     Z-ADD*ZERO     WN0021           Unit Weight
     C                     MOVEL*BLANK    WN0022           Production Date
     C                     MOVEL*BLANK    WN0023           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAVNA    WN0011           Description Lin
     C                     MOVELWEAWNA    WN0012           Description Lin
     C                     MOVELWEADCD    WN0013           UOM Primary
     C                     Z-ADDWEAWPC    WN0014           Conversion Fact
     C                     MOVELWELXST    WN0015           Operation Facto
     C                     MOVELWEAECD    WN0016           UOM Second
     C                     Z-ADDWEAXPC    WN0017           Conversion Fact
     C                     MOVELWELYST    WN0018           Operation Facto
     C                     MOVELWEAFCD    WN0019           UOM Third
     C                     MOVELWEAICD    WN0020           UOM Pricing
     C                     Z-ADDWEAIWG    WN0021           Unit Weight
     C                     MOVELWEFZST    WN0022           Production Date
     C                     MOVELWEAVST    WN0023           Catch Weight St
     C                     Z-ADDWECHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WBFOQT           Case Quantity
     C                     Z-ADD*ZERO     WBR0NB           Case Weight
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WBH5NY           Manifest Total
     C                     Z-ADD*ZERO     WBH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WBH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WBN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WBN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WBRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WBITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WBIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WBIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WBIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WBIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WBIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Order Number Alpha
     C                     MOVEL*BLANK    WUE7TX  7
      * Define work field Description 14A      USR
     C                     MOVEL*BLANK    WUI6TX 14
      * Define work field USR Counter
     C                     Z-ADD*ZERO     WUWQNB  50
      * Define work field AS Box Quantity
     C                     MOVEL*BLANK    WUASQY  5
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  50
     C                     Z-ADD*ZERO     WL0006  50
     C                     Z-ADD*ZERO     WL0007 112
     C                     MOVEL*BLANK    WL0008  1
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  80
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  3
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014 112
     C                     MOVEL*BLANK    WL0015 10
     C                     Z-ADD*ZERO     WL0016  82
     C                     Z-ADD*ZERO     WL0017  50
     C                     Z-ADD*ZERO     WL0018  90
     C                     MOVEL*BLANK    WL0019  1
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021 112
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  1
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  50
     C                     Z-ADD*ZERO     WL0026  80
     C                     Z-ADD*ZERO     WL0027  80
     C                     Z-ADD*ZERO     WL0028  80
     C                     Z-ADD*ZERO     WL0029  80
     C                     Z-ADD*ZERO     WL0030  74
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  60
     C                     MOVEL*BLANK    WL0036 10
     C                     MOVEL*BLANK    WL0037 10
     C                     Z-ADD*ZERO     WL0038  70
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
      * Define local work field WHS Default Load Type
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Label Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field COA RIN Modified Sts
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0005 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0006 155
      * Define local work field API was Called? U
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Inventory Updated USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field First Time Through USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0010  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Confirm Order
