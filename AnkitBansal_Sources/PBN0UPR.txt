     H/TITLE UPL DP ACTUALS FOR IHUB FILE FROM SPREADSHEET USING DPACTUAL.DTT
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version:  1000
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 07/21/14  Time  : 10:00:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
     M* 10/26/18  Danny Nguyen    (R13981-Spanish Desc on Export Docs)
     M* - Recompile only due to Item Default Extsn file change.
     M* 02/06/18  Danny Nguyen    (R12488-DP Sub Brand)
     M* - Recompile only due to DP Product (PBBNREP) file change.
      ***  RMC E3884  : DONT OUTPUT CUSTOMERS ORDERS IF THE CUST CLASS IS " " *
      ***              NOT SKIPPING THESE YET!
      *================================================================
     FDPACTUALIF  E                    DISK
      * UPLOAD DP ACTUAL PERIOD DEMAND FOR IHUB FILE
      *
     FPDNIREL3IF  E           K        DISK
      * CUST
     FOME5REL1IF  E           K        DISK
      * COUNTRIES
     FPBBNREL2IF  E           K        DISK
      * DP PRODUCT - DONT CREATE ACTUAL IF PRODUCT NOT FOUND HERE
     FPBBTREL1IF  E           K        DISK
      * ITEM DFT EXTENSION FOR FORECAST IN DP STS
      *
     FPBBRCPL0UF  E           K        DISK                      A
      * RTV : DP ACTUALS FOR IHUB
      *
     C           *ENTRY    PLIST
     C                     PARM           P1      6         PROFILE
     C                     PARM           P2      4         SCENARIO
     C           P1        CABEQ' '       END
     C           P2        CABEQ' '       END
      *
     C           KBBPR     KLIST
     C                     KFLD           BRTAAA
     C                     KFLD           BRTBAA
     C                     KFLD           BRFWC7
     C                     KFLD           BRTEAA
     C                     KFLD           BRABNB
     C                     KFLD           BRZ9NY
     C                     KFLD           BRAODX
      * SET SYSTEM OF RECORD AND DATE STAMP FOR THIS PROCESS
      *
     C                     MOVEL'AS400'   BRS9AA              SYS OF RECORD
     C                     MOVEL'Demand'  BRTAAA              PROFILE
     C                     MOVEL'Base'    BRTBAA              SCNENARIO
     C                     Z-ADD1         BRABNB              HISTORY TYPE
     C                     Z-ADD2         BRZ9NY              PERIOD TYPE
      * DATE STAMP YYYYMMDDHHMMSS
     C                     CALL 'PBN2UPC'
     C                     PARM           BRANDX
      *
     C*  READ FILE FTP TO AS400
      *
     C           *IN90     DOWEQ'0'
     C                     READ VIEWFMT                  90*
     C           *IN90     IFEQ '0'
      *
     C* SKIP ITEM IF NOT IN DP PRODUCT
      *
     C           OMHGCD    CHAIN@BNRETL              56
     C           *IN56     IFEQ '1'
     C                     GOTO SKIPIT
     C                     END
      *
     C* SKIP ITEM IF FORECAST IN DP = NO
      *
     C           OMHGCD    CHAIN@BTRETK              55
     C           *IN55     IFEQ '0'
     C           BTALSC    ANDEQ'N'
     C                     GOTO SKIPIT
     C                     END
      *
     C                     Z-ADDOMHGCD    BRFWC7              PRODUCT
     C                     Z-ADDREQSHP    BRAODX              REQ SHIP
     C*
     C*  DONT CREATE RCD FOR C CLASS CUSTS
     C*   GO AHEAD FOR NOW. THE SQL AT 4PM SHOULD GIVE THEM TIME TO BE FIXED
     C*                    MOVE ' '       NIH9ST
     C           BBBTC7    CHAIN@NIRETO              50
     C*          *IN50     IFEQ '1'                          SKIP 1/27/15
     C*          NIH9ST    OREQ ' '
     C*                    GOTO SKIPIT
     C*                    END
     C*
     C           *IN50     IFEQ '0'
     C           NIH9ST    IFEQ 'C'
     C           NIH9ST    OREQ ' '                           SKIP 1/27/15
     C                     Z-ADD99999     BBBTC7
     C                     END
     C                     END
     C* FORMAT CHANNEL
     C                     MOVE *BLANKS   LOCA   14
     C           BBBTC7    IFLT 100000
     C                     MOVE BBBTC7    CUST5   5           CUST
     C*                    MOVELCUST5     LOCA                CUST|TYP|REG
     C           CUST5     CAT  '-':0     LOCA                CHANNEL/LOCATION
     C                     ELSE
     C           BBBTC7    IFLT 1000000
     C                     MOVE BBBTC7    CUST6   6
     C*                    MOVELCUST6     LOCA                CUST|TYP|REG
     C           CUST6     CAT  '-':0     LOCA                CHANNEL/LOCATION
     C                     ELSE
     C           BBBTC7    IFLT 10000000
     C                     MOVE BBBTC7    CUST7   7
     C*                    MOVELCUST7     LOCA                CUST|TYP|REG
     C           CUST7     CAT  '-':0     LOCA                CHANNEL/LOCATION
     C                     END
     C                     END
     C                     END
     C*
     C* ADDITIONAL TRANSLATION FOR EXPORT ORDERS
     C*   ***  DO   LEAVE EX AND USA AS VALID COMBINATION 8/7/14-- 09/16/14
     C           TYPE      IFEQ 'EX'
     C           REGION    IFEQ 'USA'
     C*                    MOVEL'FP'      TYPE                FROM CUST
     C*                    MOVEL'NE'      REGION
     C                     ELSE
     C                     MOVELREGION    E5KXCD
     C           E5KXCD    CHAIN@E5REB8              50       VALID COUNTRY?
     C           *IN50     IFEQ '1'                           NOT A COUNTRY
     C                     MOVEL'USA'     REGION
     C                     END
     C                     END
     C                     END
     C*
     C           REGION    IFEQ 'CAN'
     C           TYPE      ANDNE'EX'
     C                     MOVEL'EX'      TYPE
     C                     END
     C*
     C           BBBTC7    IFEQ 99999
     C           TYPE      ANDEQ'EX'
     C                     MOVE 'EXP'     REGION
     C                     END
     C*
     C*
     C*                    MOVELTYPE      TYPRG5  5           TYPE|REGION
     C           TYPE      CAT  '-':0     TYPRG6  6           TYPE-REGION
     C                     MOVE REGION    TYPRG6              TYPE-REGION
     C           LOCA      CAT  TYPRG6:0  LOCA                CHANNEL/LOCATION
     C                     MOVELLOCA      BRTEAA              CHANNEL/LOCATION
     C*
     C*
      * USER: Process Data record
     C*
     C           KBBPR     CHAIN@BRCPS0              91
     C           *IN91     IFEQ '1'
     C                     Z-ADDSUMQTY    BRACNB              QTY
     C                     WRITE@BRCPS0
     C                     ELSE
     C                     ADD  SUMQTY    BRACNB
     C                     UPDAT@BRCPS0
     C                     END
      *
      * CREATE LOCATION AND PRODUCT LOCATION IF NEW
      *
     C                     CALL 'PBO9XFR'
     C                     PARM           RTNCDE  7
     C                     PARM           BRFWC7                  PRODUCT
     C                     PARM           BRTEAA                  LOCATION
     C                     PARM           BBBTC7                  CUST
     C                     PARM           TYPRG6                  TYPE-REG
     C           SKIPIT    TAG
     C                     END
     C                     END
     C           END       TAG
     C                     SETON                     LR
