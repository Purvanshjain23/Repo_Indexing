     H/TITLE zz Order Header Prompt    Prompt & validate record
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Prompt & validate record
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSPATI
     H* Date          : 04/04/25  Time  : 08:06:36
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0  IF   E           K DISK
      * Values list details file
      *
     FPVKLPVR#  CF   E             WORKSTN
     F                                     INFDS(INFDS#)
      * DSP: zz Order Header Prompt    Prompt & validate record
      *
     FCAABREL4  IF   E           K DISK
      * RTV : Company Name and Address  Active records
      *
     FOPEXREL2  IF   E           K DISK
      * RTV : Order Types               Active order Types
      *
     FCABBRELA  IF   E           K DISK
      * RTV : Customer Master           Active Only
      *
     FCAACREL2  IF   E           K DISK
      * RTV : State Master              Active only
      *
     FCAAFREL1  IF   E           K DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FCAAOREL2  IF   E           K DISK
      * RTV : Terms Master              Retrieve Active Records
      *
     FOMFFREL3  IF   E           K DISK
      * RTV : Carrier Info              Active records
      *
     FOPCXREL2  IF   E           K DISK
      * RTV : OP Reason Codes           Active Records Only
      *
     FCADRREL1  IF   E           K DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADSREL1  IF   E           K DISK
      * RTV : Enterprise Master         Retrieval index       NV
      *
     FOMFJCPL0  IF   E           K DISK
      * RTV : Load Header               Retrieval index
      *
     FPDJEREL2  IF   E           K DISK
      * RTV : Sales Route               Active Records
      *
     FCAALREL3  IF   E           K DISK
      * RTV : Manager Level             Active Only
      *
     FPDIFREL2  IF   E           K DISK
      * RTV : VP Level Master           Active Only
      *
     FOPBFCPL1  IF   E           K DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDJHREL1  IF   E           K DISK
      * RTV : Internal Reason           Retrieval index
      *
     FARBDCPL3  IF   E           K DISK
      * RTV : AR Header New             Retrieval index       NV
      *
     FOPEZREL1  IF   E           K DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FPDMKCPL1  IF   E           K DISK
      * RTV : AR Claim Header           Retrieval index
      *
      * Long constants
     D @CN#            S              6    DIM(02)CTDATA PERRCD(1)
     D @CN             S             25    DIM(02) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * ABO DEFINE LARGE STRING FOR CL CMD
     D YARTCM          DS           512
     D  DUMMY1                 1      1
     D INFDS#        E DS                  EXTNAME(Y2I#DSP)
      * Display file information data structure
      *
      * Outward parameters
     D PARC            DS             6
      * KEY : Order Header TRG          Ord-D/Co
      * I : RST Order Number
     D  PAC4NB                 1      4P 0
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0TRN          S              1
     D  W0HLP          S              1
     D  YPMT04         S              1
     D  HELP25         S              1
     D  ##OFF          S             30
     D  ZHCSRW         S              5  0
     D  ZHCSCL         S              5  0
     D  ZZCSRW         S              3  0
     D  ZZCSCL         S              3  0
     D  W0HPMB         S             10
     D  YYHPFL         S             10
     D  YYHPLB         S             10
     D  YYHLVN         S             10
     D  YYUSOP         S             10
     D  YYRW           S              5  0
     D  YYCL           S              5  0
     D  YYLGCT         S              5  0
     D  YYLGVN         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAFSMS         S              1
     D  W0DCF          S              1
     D  W0CLPG         S             10
     D  WUI3ST         S              1
     D  WUEOCD         S              7
     D  ZADFMF         S             10
     D  WK1X02         S              1
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              3  0
     D  WK1X01         S              1
     D  WQ0004         S              2
     D  WQ0005         S              7  0
     D  WQ0006         S              7  0
     D  WQ0007         S              2
     D  WQ0008         S              7  0
     D  WQ0009         S              2
     D  WQ0010         S              3  0
     D  WQ0011         S              2
     D  WQ0012         S              3
     D  XDTSDL         S             26
     D  WQ0013         S              3
     D  WQ0014         S             10
     D  WK1X03         S              1
     D  WQ0015         S              3  0
     D  WQ0016         S              4
     D  WQ0017         S             12
     D  WQ0018         S              7  0
     D  WQ0019         S              3  0
     D  WQ0020         S              3
     D  WQ0021         S              2
     D  WQ0022         S              3
     D  WQ0023         S              3  0
     D  WQ0024         S              7  0
     D  WQ0025         S              3  0
     D  WQ0026         S              7  0
     D  WQ0027         S              2
     D  WQ0028         S              2
     D  YL0001         S              3  0
     D  YL0002         S              7  0
     D  WQ0029         S              7  0
     D  WQ0030         S              3  0
     D  WQ0031         S              7  0
     D  WN30           S             30
     D  W0NSRQ         S              1
     D  Y2LSNO         S              7  0
     D  W0EXVL         S             25
     D  YPMTFD         S             10
     D  YAFSCH         S              4  0
     D  YPMRRN         S              4  0
     D  W0GRP          S              1
     D  YSETCS         S              1
     D  WCSRLC         S              3
     D  ZINPOS         S              5  0
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0CFL          S             10
     D  W0CRW          S              5  0
     D  W0CCL          S              5  0
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  @1FFL          S             10
     D  @1FLB          S             10
     D  @1FMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
     D J7              S              1    DIM(7)
     D K7              S              1    DIM(7)
     D #L7             S              1    DIM(7)
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                      WAAIC3
     I              ABADTX                      WAADTX
     I              ABACNA                      WAACNA
     I              ABADNA                      WAADNA
     I              ABAENA                      WAAENA
     I              ABAJNA                      WAAJNA
     I              ABBTTX                      WABTTX
     I              ABBVTX                      WABVTX
     I              ABBWTX                      WABWTX
     I              ABA2NA                      WAA2NA
     I              ABABTX                      WAABTX
     I              ABBGCD                      WABGCD
     I              ABKXCD                      WAKXCD
     I              ABUVST                      WAUVST
     I              ABUWST                      WAUWST
     I              ABUXST                      WAUXST
     I              ABVSST                      WAVSST
     I              ABAATM                      WAAATM
     I              ABAYNA                      WAAYNA
     I              ABA0NA                      WAA0NA
     I              ABAXDT                      WAAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                      WBJNCD
     I              EXJVNA                      WBJVNA
     I              EXOAST                      WBOAST
     I              EXOBST                      WBOBST
     I              EXOEST                      WBOEST
     I              EXOFST                      WBOFST
     I              EXVBST                      WBVBST
     I              EXPYST                      WBPYST
     I              EXX8ST                      WBX8ST
     I              EXISTX                      WBISTX
     I              EXUVST                      WBUVST
     I              EXUWST                      WBUWST
     I              EXUXST                      WBUXST
     I              EXVSST                      WBVSST
     I              EXAATM                      WBAATM
     I              EXAYNA                      WBAYNA
     I              EXA0NA                      WBA0NA
     I              EXAXDT                      WBAXDT
      *
     I@BBREWG
      * Customer Master           Active Only
      * Renamed input format fields
     I              BBBKC7                      WCBKC7
     I              BBAYTX                      WCAYTX
     I              BBACNA                      WCACNA
     I              BBADNA                      WCADNA
     I              BBAENA                      WCAENA
     I              BBAJNA                      WCAJNA
     I              BBBGCD                      WCBGCD
     I              BBG5CD                      WCG5CD
     I              BBBTTX                      WCBTTX
     I              BBBVTX                      WCBVTX
     I              BBBWTX                      WCBWTX
     I              BBABTX                      WCABTX
     I              BBA2NA                      WCA2NA
     I              BBCBST                      WCCBST
     I              BBB0NA                      WCB0NA
     I              BBP3NB                      WCP3NB
     I              BBAXNA                      WCAXNA
     I              BBI6DT                      WCI6DT
     I              BBAYDT                      WCAYDT
     I              BBANC7                      WCANC7
     I              BBBTC7                      WCBTC7
     I              BBK6ST                      WCK6ST
     I              BBUZST                      WCUZST
     I              BBKXCD                      WCKXCD
     I              BBLTCD                      WCLTCD
     I              BBQNST                      WCQNST
     I              BBS2NB                      WCS2NB
     I              BBVHVA                      WCVHVA
     I              BBI7DT                      WCI7DT
     I              BBRJST                      WCRJST
     I              BBRKST                      WCRKST
     I              BBQWST                      WCQWST
     I              BBQXST                      WCQXST
     I              BBQYST                      WCQYST
     I              BBUNCS                      WCUNCS
     I              BBUVST                      WCUVST
     I              BBUWST                      WCUWST
     I              BBUXST                      WCUXST
     I              BBVSST                      WCVSST
     I              BBAATM                      WCAATM
     I              BBAYNA                      WCAYNA
     I              BBA0NA                      WCA0NA
     I              BBAXDT                      WCAXDT
      *
     I@ACRET7
      * State Master              Active only
      * Renamed input format fields
     I              ACBGCD                      WDBGCD
     I              ACAUNA                      WDAUNA
     I              ACUVST                      WDUVST
     I              ACUWST                      WDUWST
     I              ACUXST                      WDUXST
     I              ACVSST                      WDVSST
     I              ACAATM                      WDAATM
     I              ACAYNA                      WDAYNA
     I              ACA0NA                      WDA0NA
     I              ACAXDT                      WDAXDT
      *
     I@AFREBE
      * Calendar Master           Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                      WEAIC3
     I              AFBCDT                      WEBCDT
     I              AFCQNB                      WECQNB
     I              AFESNB                      WEESNB
     I              AFETNB                      WEETNB
     I              AFBZNB                      WEBZNB
     I              AFA9ST                      WEA9ST
     I              AFEINB                      WEEINB
     I              AFC5ST                      WEC5ST
     I              AFAQNB                      WEAQNB
     I              AFCMST                      WECMST
     I              AFV9ST                      WEV9ST
     I              AFWAST                      WEWAST
     I              AFX2ST                      WEX2ST
     I              AFOJDT                      WEOJDT
     I              AFNQNX                      WENQNX
     I              AFNRNX                      WENRNX
     I              AFI9SX                      WEI9SX
     I              AFJASX                      WEJASX
     I              AFOKDT                      WEOKDT
     I              AFOLDT                      WEOLDT
     I              AFUVST                      WEUVST
     I              AFUWST                      WEUWST
     I              AFUXST                      WEUXST
     I              AFAATM                      WEAATM
     I              AFAYNA                      WEAYNA
     I              AFA0NA                      WEA0NA
     I              AFAXDT                      WEAXDT
      *
     I@AOREU1
      * Terms Master              Retrieve Active Records
      * Renamed input format fields
     I              AOAIC3                      WFAIC3
     I              AOAQCD                      WFAQCD
     I              AOAUNA                      WFAUNA
     I              AOD3ST                      WFD3ST
     I              AOANDY                      WFANDY
     I              AOAKDY                      WFAKDY
     I              AOA4PC                      WFA4PC
     I              AOAJDY                      WFAJDY
     I              AOCUNB                      WFCUNB
     I              AOALDY                      WFALDY
     I              AOAPDY                      WFAPDY
     I              AOCTNB                      WFCTNB
     I              AOAMDY                      WFAMDY
     I              AOAQDY                      WFAQDY
     I              AOASDT                      WFASDT
     I              AOATDT                      WFATDT
     I              AOUVST                      WFUVST
     I              AOUWST                      WFUWST
     I              AOUXST                      WFUXST
     I              AOVSST                      WFVSST
     I              AOAATM                      WFAATM
     I              AOAYNA                      WFAYNA
     I              AOA0NA                      WFA0NA
     I              AOAXDT                      WFAXDT
      *
     I@FFREUG
      * Carrier Info              Active records
      * Renamed input format fields
     I              FFBZNA                      WGBZNA
     I              FFADTX                      WGADTX
     I              FFACNA                      WGACNA
     I              FFADNA                      WGADNA
     I              FFAENA                      WGAENA
     I              FFAJNA                      WGAJNA
     I              FFBTTX                      WGBTTX
     I              FFEZNB                      WGEZNB
     I              FFBGCD                      WGBGCD
     I              FFEEDT                      WGEEDT
     I              FFDUTX                      WGDUTX
     I              FFNRVA                      WGNRVA
     I              FFNSVA                      WGNSVA
     I              FFNTVA                      WGNTVA
     I              FFNUVA                      WGNUVA
     I              FFP1ST                      WGP1ST
     I              FFDVTX                      WGDVTX
     I              FFDWTX                      WGDWTX
     I              FFLVCD                      WGLVCD
     I              FFS8NB                      WGS8NB
     I              FFS9NB                      WGS9NB
     I              FFNMVA                      WGNMVA
     I              FFNOVA                      WGNOVA
     I              FFNPVA                      WGNPVA
     I              FFNQVA                      WGNQVA
     I              FFMFCD                      WGMFCD
     I              FFQXNB                      WGQXNB
     I              FFQ1NB                      WGQ1NB
     I              FFMRNG                      WGMRNG
     I              FFMRNE                      WGMRNE
     I              FFRFNB                      WGRFNB
     I              FFMREG                      WGMREG
     I              FFBQPR                      WGBQPR
     I              FFBRPR                      WGBRPR
     I              FFBSPR                      WGBSPR
     I              FFBTPR                      WGBTPR
     I              FFBUPR                      WGBUPR
     I              FFBVPR                      WGBVPR
     I              FFDJWG                      WGDJWG
     I              FFDKWG                      WGDKWG
     I              FFDLWG                      WGDLWG
     I              FFDMWG                      WGDMWG
     I              FFDNWG                      WGDNWG
     I              FFDOWG                      WGDOWG
     I              FFB2PR                      WGB2PR
     I              FFB3PR                      WGB3PR
     I              FFB4PR                      WGB4PR
     I              FFB5PR                      WGB5PR
     I              FFB6PR                      WGB6PR
     I              FFB7PR                      WGB7PR
     I              FFAAC7                      WGAAC7
     I              FFCOFI                      WGCOFI
     I              FFK6TX                      WGK6TX
     I              FFOCNA                      WGOCNA
     I              FFODNA                      WGODNA
     I              FFW7CD                      WGW7CD
     I              FFK7TX                      WGK7TX
     I              FFTENO                      WGTENO
     I              FFK8TX                      WGK8TX
     I              FFAOFC                      WGAOFC
     I              FFAOLI                      WGAOLI
     I              FFKHDT                      WGKHDT
     I              FFUNUS                      WGUNUS
     I              FFUNU2                      WGUNU2
     I              FFUNU3                      WGUNU3
     I              FFUVST                      WGUVST
     I              FFUWST                      WGUWST
     I              FFUXST                      WGUXST
     I              FFVSST                      WGVSST
     I              FFAATM                      WGAATM
     I              FFAYNA                      WGAYNA
     I              FFA0NA                      WGA0NA
     I              FFAXDT                      WGAXDT
      *
     I@CXRET4
      * OP Reason Codes           Active Records Only
      * Renamed input format fields
     I              CXCQCD                      WHCQCD
     I              CXAUNA                      WHAUNA
     I              CXUVST                      WHUVST
     I              CXUWST                      WHUWST
     I              CXUXST                      WHUXST
     I              CXVSST                      WHVSST
     I              CXAATM                      WHAATM
     I              CXAYNA                      WHAYNA
     I              CXA0NA                      WHA0NA
     I              CXAXDT                      WHAXDT
     I              CXFAVN                      WHFAVN
     I              CXBVTS                      WHBVTS
     I              CXWAU1                      WHWAU1
     I              CXFBVN                      WHFBVN
     I              CXBWTS                      WHBWTS
     I              CXWBU1                      WHWBU1
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                      WIAJVN
     I              DRAUNA                      WIAUNA
     I              DRB8NA                      WIB8NA
     I              DRAHVN                      WIAHVN
     I              DRI6ST                      WII6ST
     I              DRI7ST                      WII7ST
     I              DRXMST                      WIXMST
     I              DRXNST                      WIXNST
     I              DRI8ST                      WII8ST
     I              DRNLNB                      WINLNB
     I              DRMPNA                      WIMPNA
     I              DRBCCD                      WIBCCD
     I              DRAIC3                      WIAIC3
     I              DRDQCD                      WIDQCD
     I              DRDRCD                      WIDRCD
     I              DRAJCD                      WIAJCD
     I              DRBUVN                      WIBUVN
     I              DRUVST                      WIUVST
     I              DRUWST                      WIUWST
     I              DRUXST                      WIUXST
     I              DRAATM                      WIAATM
     I              DRAYNA                      WIAYNA
     I              DRA0NA                      WIA0NA
     I              DRAXDT                      WIAXDT
      *
     I@DSRETN
      * Enterprise Master         Retrieval index       NV
      * Renamed input format fields
     I              DSAIC3                      WJAIC3
     I              DSDQCD                      WJDQCD
     I              DSDRCD                      WJDRCD
     I              DSBYTX                      WJBYTX
     I              DSUVST                      WJUVST
     I              DSUWST                      WJUWST
     I              DSUXST                      WJUXST
     I              DSVSST                      WJVSST
     I              DSAATM                      WJAATM
     I              DSAYNA                      WJAYNA
     I              DSA0NA                      WJA0NA
     I              DSAXDT                      WJAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                      WKRMNB
     I              FJAIC3                      WKAIC3
     I              FJAODT                      WKAODT
     I              FJPJST                      WKPJST
     I              FJPKST                      WKPKST
     I              FJRNNB                      WKRNNB
     I              FJDMTX                      WKDMTX
     I              FJDNTX                      WKDNTX
     I              FJDOTX                      WKDOTX
     I              FJWTTX                      WKWTTX
     I              FJWUTX                      WKWUTX
     I              FJRPNB                      WKRPNB
     I              FJFLAM                      WKFLAM
     I              FJXQST                      WKXQST
     I              FJRRNB                      WKRRNB
     I              FJDXTX                      WKDXTX
     I              FJDYTX                      WKDYTX
     I              FJSBNB                      WKSBNB
     I              FJBZNA                      WKBZNA
     I              FJRONB                      WKRONB
     I              FJSQNB                      WKSQNB
     I              FJR1NB                      WKR1NB
     I              FJVCST                      WKVCST
     I              FJVDST                      WKVDST
     I              FJSDNB                      WKSDNB
     I              FJPAOU                      WKPAOU
     I              FJDGWG                      WKDGWG
     I              FJSXNB                      WKSXNB
     I              FJHADT                      WKHADT
     I              FJAART                      WKAART
     I              FJDHWG                      WKDHWG
     I              FJDIWG                      WKDIWG
     I              FJAQDT                      WKAQDT
     I              FJS6NB                      WKS6NB
     I              FJT4NB                      WKT4NB
     I              FJPRTM                      WKPRTM
     I              FJNPSV                      WKNPSV
     I              FJJ8TX                      WKJ8TX
     I              FJTLMI                      WKTLMI
     I              FJJ9TX                      WKJ9TX
     I              FJQ2CD                      WKQ2CD
     I              FJVPCD                      WKVPCD
     I              FJDBCD                      WKDBCD
     I              FJGRWE                      WKGRWE
     I              FJXCCD                      WKXCCD
     I              FJU2ST                      WKU2ST
     I              FJF9DT                      WKF9DT
     I              FJONTM                      WKONTM
     I              FJJ4DT                      WKJ4DT
     I              FJTRTM                      WKTRTM
     I              FJJ5DT                      WKJ5DT
     I              FJSPTM                      WKSPTM
     I              FJJ6DT                      WKJ6DT
     I              FJLFTM                      WKLFTM
     I              FJJ7DT                      WKJ7DT
     I              FJBOTM                      WKBOTM
     I              FJJ8DT                      WKJ8DT
     I              FJBLTM                      WKBLTM
     I              FJKIDT                      WKKIDT
     I              FJASTM                      WKASTM
     I              FJKADT                      WKKADT
     I              FJAJCM                      WKAJCM
     I              FJXACD                      WKXACD
     I              FJOANA                      WKOANA
     I              FJK4TX                      WKK4TX
     I              FJVOAG                      WKVOAG
     I              FJKBDT                      WKKBDT
     I              FJNBBO                      WKNBBO
     I              FJW4CD                      WKW4CD
     I              FJEFDT                      WKEFDT
     I              FJCNTN                      WKCNTN
     I              FJKCDT                      WKKCDT
     I              FJTMIN                      WKTMIN
     I              FJKDDT                      WKKDDT
     I              FJVMNB                      WKVMNB
     I              FJOCFR                      WKOCFR
     I              FJKJDT                      WKKJDT
     I              FJATTM                      WKATTM
     I              FJOTRS                      WKOTRS
     I              FJRNST                      WKRNST
     I              FJBRBK                      WKBRBK
     I              FJEIDT                      WKEIDT
     I              FJRMST                      WKRMST
     I              FJAJCD                      WKAJCD
     I              FJKKDT                      WKKKDT
     I              FJAVTM                      WKAVTM
     I              FJKZDT                      WKKZDT
     I              FJAXTM                      WKAXTM
     I              FJLHOS                      WKLHOS
     I              FJLHOR                      WKLHOR
     I              FJWNTX                      WKWNTX
     I              FJOITX                      WKOITX
     I              FJOJTX                      WKOJTX
     I              FJLLDT                      WKLLDT
     I              FJLSHG                      WKLSHG
     I              FJYPST                      WKYPST
     I              FJK0DT                      WKK0DT
     I              FJAYTM                      WKAYTM
     I              FJKNNX                      WKKNNX
     I              FJICWG                      WKICWG
     I              FJIDWG                      WKIDWG
     I              FJH9SX                      WKH9SX
     I              FJWOTX                      WKWOTX
     I              FJK1DT                      WKK1DT
     I              FJAZTM                      WKAZTM
     I              FJK2DT                      WKK2DT
     I              FJA0TM                      WKA0TM
     I              FJROST                      WKROST
     I              FJRPST                      WKRPST
     I              FJRQST                      WKRQST
     I              FJRRST                      WKRRST
     I              FJZBVA                      WKZBVA
     I              FJWPTX                      WKWPTX
     I              FJWQTX                      WKWQTX
     I              FJWRTX                      WKWRTX
     I              FJWSTX                      WKWSTX
     I              FJRVSX                      WKRVSX
     I              FJRUSX                      WKRUSX
     I              FJRWSX                      WKRWSX
     I              FJRXSX                      WKRXSX
     I              FJRYSX                      WKRYSX
     I              FJRZSX                      WKRZSX
     I              FJR0SX                      WKR0SX
     I              FJR1SX                      WKR1SX
     I              FJR2SX                      WKR2SX
     I              FJR3SX                      WKR3SX
     I              FJR4SX                      WKR4SX
     I              FJPYDT                      WKPYDT
     I              FJCKTM                      WKCKTM
     I              FJPZDT                      WKPZDT
     I              FJCLTM                      WKCLTM
     I              FJP0DT                      WKP0DT
     I              FJCMTM                      WKCMTM
     I              FJP1DT                      WKP1DT
     I              FJCNTM                      WKCNTM
     I              FJP2DT                      WKP2DT
     I              FJCOTM                      WKCOTM
     I              FJP3DT                      WKP3DT
     I              FJCQTM                      WKCQTM
     I              FJUVST                      WKUVST
     I              FJUWST                      WKUWST
     I              FJUXST                      WKUXST
     I              FJAATM                      WKAATM
     I              FJAYNA                      WKAYNA
     I              FJA0NA                      WKA0NA
     I              FJAXDT                      WKAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                      WLR4CD
     I              JEMZNA                      WLMZNA
     I              JEBCCD                      WLBCCD
     I              JEBFCD                      WLBFCD
     I              JEQ4CD                      WLQ4CD
     I              JEWOST                      WLWOST
     I              JER8CD                      WLR8CD
     I              JEUVST                      WLUVST
     I              JEUWST                      WLUWST
     I              JEUXST                      WLUXST
     I              JEVSST                      WLVSST
     I              JEAATM                      WLAATM
     I              JEAYNA                      WLAYNA
     I              JEA0NA                      WLA0NA
     I              JEAXDT                      WLAXDT
      *
     I@ALREVE
      * Manager Level             Active Only
      * Renamed input format fields
     I              ALBFCD                      WMBFCD
     I              ALAUNA                      WMAUNA
     I              ALQ4CD                      WMQ4CD
     I              ALUVST                      WMUVST
     I              ALUWST                      WMUWST
     I              ALUXST                      WMUXST
     I              ALVSST                      WMVSST
     I              ALAATM                      WMAATM
     I              ALAYNA                      WMAYNA
     I              ALA0NA                      WMA0NA
     I              ALAXDT                      WMAXDT
      *
     I@IFREWB
      * VP Level Master           Active Only
      * Renamed input format fields
     I              IFQ4CD                      WOQ4CD
     I              IFMJNA                      WOMJNA
     I              IFUVST                      WOUVST
     I              IFUWST                      WOUWST
     I              IFUXST                      WOUXST
     I              IFVSST                      WOVSST
     I              IFAATM                      WOAATM
     I              IFAYNA                      WOAYNA
     I              IFA0NA                      WOA0NA
     I              IFAXDT                      WOAXDT
      *
     I@JHREXO
      * Internal Reason           Retrieval index
      * Renamed input format fields
     I              JHSGCD                      WRSGCD
     I              JHM1NA                      WRM1NA
     I              JHUVST                      WRUVST
     I              JHUWST                      WRUWST
     I              JHUXST                      WRUXST
     I              JHVSST                      WRVSST
     I              JHAATM                      WRAATM
     I              JHAYNA                      WRAYNA
     I              JHA0NA                      WRA0NA
     I              JHAXDT                      WRAXDT
      *
     I@BDCPF7
      * AR Header New             Retrieval index       NV
      * Renamed input format fields
     I              BDAIC3                      WSAIC3
     I              BDCONB                      WSCONB
     I              BDCEST                      WSCEST
     I              BDUHCD                      WSUHCD
     I              BDBSVA                      WSBSVA
     I              BDAIVA                      WSAIVA
     I              BDAOVA                      WSAOVA
     I              BDBGVA                      WSBGVA
     I              BDAJST                      WSAJST
     I              BDE3ST                      WSE3ST
     I              BDG4CD                      WSG4CD
     I              BDCKNB                      WSCKNB
     I              BDCAC7                      WSCAC7
     I              BDBKC7                      WSBKC7
     I              BDBCCD                      WSBCCD
     I              BDR4CD                      WSR4CD
     I              BDB4DT                      WSB4DT
     I              BDATDT                      WSATDT
     I              BDH0DT                      WSH0DT
     I              BDH3DT                      WSH3DT
     I              BDH4DT                      WSH4DT
     I              BDH5DT                      WSH5DT
     I              BDANC7                      WSANC7
     I              BDCPTX                      WSCPTX
     I              BDBSDY                      WSBSDY
     I              BDUVST                      WSUVST
     I              BDUWST                      WSUWST
     I              BDUXST                      WSUXST
     I              BDAATM                      WSAATM
     I              BDAYNA                      WSAYNA
     I              BDA0NA                      WSA0NA
     I              BDAXDT                      WSAXDT
      *
     I@EZREYT
      * Event Types               Retrieval index       NV
      * Renamed input format fields
     I              EZJPCD                      WTJPCD
     I              EZAUNA                      WTAUNA
     I              EZOIST                      WTOIST
     I              EZUVST                      WTUVST
     I              EZUWST                      WTUWST
     I              EZUXST                      WTUXST
     I              EZVSST                      WTVSST
     I              EZAATM                      WTAATM
     I              EZAYNA                      WTAYNA
     I              EZA0NA                      WTA0NA
     I              EZAXDT                      WTAXDT
      *
     I@MKCPWB
      * AR Claim Header           Retrieval index
      * Renamed input format fields
     I              MKC0C7                      WVC0C7
     I              MKZLCD                      WVZLCD
     I              MKBIC3                      WVBIC3
     I              MKALNX                      WVALNX
     I              MKRMNB                      WVRMNB
     I              MKC3C7                      WVC3C7
     I              MKRFTX                      WVRFTX
     I              MKCHSX                      WVCHSX
     I              MKCJSX                      WVCJSX
     I              MKAYVL                      WVAYVL
     I              MKAZVL                      WVAZVL
     I              MKA0VL                      WVA0VL
     I              MKPQTX                      WVPQTX
     I              MKCNSX                      WVCNSX
     I              MKPLTX                      WVPLTX
     I              MKCOSX                      WVCOSX
     I              MKPMTX                      WVPMTX
     I              MKCPSX                      WVCPSX
     I              MKA1VL                      WVA1VL
     I              MKPNTX                      WVPNTX
     I              MKPOTX                      WVPOTX
     I              MKMLDT                      WVMLDT
     I              MKEJDT                      WVEJDT
     I              MKCQSX                      WVCQSX
     I              MKPPTX                      WVPPTX
     I              MKMMDT                      WVMMDT
     I              MKMNDT                      WVMNDT
     I              MKBGTM                      WVBGTM
     I              MKCGVN                      WVCGVN
     I              MKC4C7                      WVC4C7
     I              MKO2NA                      WVO2NA
     I              MKNFDT                      WVNFDT
     I              MKBJTM                      WVBJTM
     I              MKCQVN                      WVCQVN
     I              MKMODT                      WVMODT
     I              MKBHTM                      WVBHTM
     I              MKCHVN                      WVCHVN
     I              MKCRSX                      WVCRSX
     I              MKMPDT                      WVMPDT
     I              MKBITM                      WVBITM
     I              MKCIVN                      WVCIVN
     I              MKTBTX                      WVTBTX
     I              MKEOVL                      WVEOVL
     I              MKEPVL                      WVEPVL
     I              MKP6DT                      WVP6DT
     I              MKCRTM                      WVCRTM
     I              MKYSNX                      WVYSNX
     I              MKT5SX                      WVT5SX
     I              MKF7PC                      WVF7PC
     I              MKF8PC                      WVF8PC
     I              MKF9PC                      WVF9PC
     I              MKEQVL                      WVEQVL
     I              MKERVL                      WVERVL
     I              MKESVL                      WVESVL
     I              MKETVL                      WVETVL
     I              MKT7SX                      WVT7SX
     I              MKT8SX                      WVT8SX
     I              MKT9SX                      WVT9SX
     I              MKUASX                      WVUASX
     I              MKUBSX                      WVUBSX
     I              MKGAPC                      WVGAPC
     I              MKGBPC                      WVGBPC
     I              MKVSST                      WVVSST
     I              MKMJDT                      WVMJDT
     I              MKBETM                      WVBETM
     I              MKCCVN                      WVCCVN
     I              MKCDVN                      WVCDVN
     I              MKMKDT                      WVMKDT
     I              MKBFTM                      WVBFTM
     I              MKCEVN                      WVCEVN
     I              MKCFVN                      WVCFVN
     I              MKTXAA                      WVTXAA
     I              MKC8AB                      WVC8AB
     I              MKEJAB                      WVEJAB
     I              MKDMAB                      WVDMAB
     I              MKWUU1                      WVWUU1
     I              MKXPU1                      WVXPU1
     I              MKFAVN                      WVFAVN
     I              MKBVTS                      WVBVTS
     I              MKWAU1                      WVWAU1
     I              MKFBVN                      WVFBVN
     I              MKBWTS                      WVBWTS
     I              MKWBU1                      WVWBU1
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Conduct screen conversation
     C                   DO        *HIVAL
      * Start new transaction
     C                   MOVEL     'Y'           W0TRN
      * Process current transaction
      * Convert fields to external form
     C                   DOW       W0TRN = 'Y'
     C                   EXSR      MNCV#1
      * Display screen
     C                   EXSR      CAEXFM
      * Process response
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * HOME: Reset screen fields
     C   30              CAS                     MALDSC
      * Process screen input
     C                   CAS                     DAPRSC
     C                   END
      *
     C                   END
      *
     C                   END
      *****************************************************************
      /EJECT
     CSR   CAEXFM        BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                   TIME                    ##TME
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y0SET
     C                   END
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   EXFMT     #RCDDTL1
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   DAPRSC        BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                   MOVEL     'N'           W0DCF
      * Validate screen input
     C                   EXSR      DBVLSC
      * If error, exit
     C     *IN99         CABEQ     '1'           DAEXIT
      * Defer confirm/update requested
     C     W0DCF         CABEQ     'Y'           DAEXIT
      * Prompt for confirmation
     C                   EXSR      DHPMCF
      * Quit if not confirmed
     C     *IN99         CABEQ     '1'           DAEXIT
      * USER: User defined action
      * CASE: DTL.Order Number is Greater then zero
      * zz Order Header Display - Order Header TRG  * 
     C                   IF        #1C4NB > 0
     C                   CLEAR                   PARC
     C                   Z-ADD     #1C4NB        PAC4NB                         Order Number
      *
     C                   CALL      'PVKMDFR'                            90      zz Order Header
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PARC                           KEY: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVKMDFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        9931      *
     C                   END
     C                   END                                                    *FI
      * Exit program
     C                   EXSR      ZXEXPG
      *================================================================
     CSR   DAEXIT        ENDSR
      /EJECT
     CSR   DBVLSC        BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                   MOVEL     V1C4NB        WUI3ST                         USR First Posit
     C                   EVAL      W0RTN = ' '                                  *Return code
      * CASE: WRK.USR First Position is Search request
     C                   IF        WUI3ST = '?'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     V1C4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
      * RIGHT JUSTIFY INPUT FIELD
     C                   MOVE      *BLANKS       JUSTC7            7
     C                   MOVEA     *BLANKS       K7
     C                   Z-ADD     7             C                 3 0
     C                   Z-ADD     7             D                 3 0
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                   MOVEA     WUEOCD        J7
     C                   MOVE      *BLANKS       W0RTN
     C                   DO        7
     C     J7(C)         IFNE      ' '
     C                   MOVEA     J7(C)         K7(D)
     C                   SUB       1             D
     C                   END
     C                   SUB       1             C
     C                   END
     C                   MOVEA     K7            JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                   MOVE      JUSTC7        TEST7             1
     C     TEST7         IFGT      '?'
     C     TEST7         ANDLT     '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   ELSE
     C                   MOVE      *IN60         HLDIN             1
     C                   TESTN                   JUSTC7               606060
     C     *IN60         IFEQ      '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   END
     C                   END
     C                   MOVE      JUSTC7        WUEOCD
     C                   MOVE      HLDIN         *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                   IF        W0RTN = @CN(001)
     C                   MOVEL     'USR0802'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   Z-ADD     *ZERO         #1C4NB                         CD7 Int Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVE      WUEOCD        #1C4NB                         CD7 Int Numeric
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                   MOVEL     V1BKC7        WUI3ST                         USR First Posit
     C                   EVAL      W0RTN = ' '                                  *Return code
      * CASE: WRK.USR First Position is Search request
     C                   IF        WUI3ST = '?'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     V1BKC7        WUEOCD                         CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                   MOVE      *BLANKS       JUSTC7            7
     C                   MOVEA     *BLANKS       K7
     C                   Z-ADD     7             C                 3 0
     C                   Z-ADD     7             D                 3 0
     C                   MOVEA     WUEOCD        J7
     C                   MOVE      *BLANKS       W0RTN
     C                   DO        7
     C     J7(C)         IFNE      ' '
     C                   MOVEA     J7(C)         K7(D)
     C                   SUB       1             D
     C                   END
     C                   SUB       1             C
     C                   END
     C                   MOVEA     K7            JUSTC7
     C                   MOVE      JUSTC7        TEST7             1
     C     TEST7         IFGT      '?'
     C     TEST7         ANDLT     '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   ELSE
     C                   MOVE      *IN60         HLDIN             1
     C                   TESTN                   JUSTC7               606060
     C     *IN60         IFEQ      '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   END
     C                   END
     C                   MOVE      JUSTC7        WUEOCD
     C                   MOVE      HLDIN         *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                   IF        W0RTN = @CN(001)
     C                   MOVEL     'USR0802'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   Z-ADD     *ZERO         #1BKC7                         CD7 Int Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVE      WUEOCD        #1BKC7                         CD7 Int Numeric
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Bypass ref file checks if error already detected
     C   99              GOTO      DBEXIT
      * Select existing record
     C                   EXSR      VACKRL
      * Check reference to Company Name and Address
     C                   EXSR      VBCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Order Types
     C                   EXSR      VCCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Customer Master
     C                   EXSR      VDCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Customer Master
     C                   EXSR      VECKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        9932      *
     C                   END
      * Check reference to State Master
     C                   EXSR      VFCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Customer Master
     C                   EXSR      VGCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to State Master
     C                   EXSR      VHCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Calendar Master
     C                   EXSR      VICKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Calendar Master
     C                   EXSR      VJCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Calendar Master
     C                   EXSR      VKCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Calendar Master
     C                   EXSR      VLCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Terms Master
     C                   EXSR      VMCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Carrier Info
     C                   EXSR      VNCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to OP Reason Codes
     C                   EXSR      VOCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Calendar Master
     C                   EXSR      VPCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to User Profile Control
     C                   EXSR      VQCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Calendar Master
     C                   EXSR      VRCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Enterprise Master
     C                   EXSR      VSCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Load Header
     C                   EXSR      VTCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Sales Route
     C                   EXSR      VUCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Manager Level
     C                   EXSR      VVCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to VP Level Master
     C                   EXSR      VWCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Order Header TRG
     C                   EXSR      VXCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Internal Reason
     C                   EXSR      VYCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to AR Header New
     C                   EXSR      VZCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Calendar Master
     C                   EXSR      WACKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Event Types
     C                   EXSR      WBCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to AR Claim Header
     C                   EXSR      WCCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Order Number required
     C                   IF        #1C4NB = *ZERO AND
     C                             YPMTFD = ' '
     C                   SETON                                        9931      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      * Ship To Customer required
     C                   IF        #1BKC7 = *ZERO AND
     C                             YPMTFD = ' '
     C                   SETON                                        9932      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      *================================================================
     CSR   DBEXIT        ENDSR
      /EJECT
     CSR   DHPMCF        BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                   EXSR      MNCV#1
      * Update screen time
     C                   TIME                    ##TME
      * Refresh screen
     C                   EVAL      ##CFCD = ' '
     C                   MOVEL     'N'           ##CFCD
      * Save CMD keys
     C                   MOVEA     *IN           WN30
     C                   SETOFF                                       29        *
      * Generate internal/external key list
     C     KINEX         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2INVL
      * Convert *CONFIRM to external value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2INVL = ' '
     C                   MOVEL     ##CFCD        Y2INVL                         *CONFIRM
     C     KINEX         CHAIN     @Y2INEX                            90        *
     C  N90              MOVEL     Y2EXVL        V#CFCD                         *CONFIRM
      *
     C                   DOU       W0HLP = 'N' AND
     C                             NOT *IN29
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   WRITE     #RCDDTL1
     C                   EXFMT     #CONFIRM
     C                   IF        *IN29
     C                   SETON                                        99
     C                   GOTO      DHEXIT
     C                   END
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
      * Validate *CONFIRM
     C                   EVAL      W0RTN = ' '
     C                   MOVEL     V#CFCD        W0NSRQ                         *CONFIRM
      * Name search required?
     C                   IF        W0NSRQ = '?' OR
     C                             'V#CFCD' = YPMTFD
     C                   CALL      'CAVLLSR'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1001713       Y2LSNO
     C     V#CFCD        PARM      V#CFCD        W0EXVL                         *CONFIRM
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   IF        W0NSRQ <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
     C                   END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C     KEXIN         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2EXVL
      * Convert *CONFIRM to internal value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2EXVL = ' '
     C                   MOVEL     V#CFCD        Y2EXVL                         *CONFIRM
     C     KEXIN         CHAIN     @Y2EXIN                            90        *
     C                   IF        *IN90
     C                   EVAL      ##CFCD = ' '
     C                   IF        YPMTFD = ' '
     C                   SETON                                        96        *
     C                   WRITE     #CONFIRM
     C                   SETOFF                                       96        *
     C                   END
     C                   ELSE
     C                   MOVEL     Y2INVL        ##CFCD                         *CONFIRM
     C                   END
      *
     C   90              SETON                                        29        *
     C  N90              SETOFF                                       29        *
     C                   END
      * Restore CMD keys
     C                   MOVEA     WN30          *IN
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   IF        ##CFCD = 'Y'
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   END
     C     ##CFCD        COMP      'Y'                                9999      *
      * Not confirmed
      *================================================================
     CSR   DHEXIT        ENDSR
      /EJECT
     CSR   MALDSC        BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                   Z-ADD     *ZERO         #1AIC3                         Company Number
     C                   EVAL      #1JNCD = ' '                                 Order Type_Sale
     C                   Z-ADD     *ZERO         #1ANC7                         AR Customer Num
     C                   EVAL      #1BRTX = ' '                                 Ship To Name
     C                   EVAL      #1HMNA = ' '                                 Ship To Address
     C                   EVAL      #1HONA = ' '                                 Ship To Address
     C                   EVAL      #1HPNA = ' '                                 Ship To Address
     C                   EVAL      #1HNNA = ' '                                 Ship To City
     C                   EVAL      #1DBCD = ' '                                 Ship To State C
     C                   EVAL      #1CKTX = ' '                                 Ship To Zip_Pos
     C                   Z-ADD     *ZERO         #1B0C7                         Bill to Custome
     C                   EVAL      #1AETX = ' '                                 Bill to Name
     C                   EVAL      #1B1NA = ' '                                 Bill to Address
     C                   EVAL      #1B3NA = ' '                                 Bill to Address
     C                   EVAL      #1B4NA = ' '                                 Bill to Address
     C                   EVAL      #1B2NA = ' '                                 Bill to City
     C                   EVAL      #1BHCD = ' '                                 Bill to State C
     C                   EVAL      #1C8TX = ' '                                 Bill to Zip_Pos
     C                   EVAL      #1BCNA = ' '                                 Customer Purcha
     C                   Z-ADD     *ZERO         #1A0DT                         Order Date
     C                   Z-ADD     *ZERO         #1A5DT                         Requested Ship
     C                   Z-ADD     *ZERO         #1GNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         #1ACDT                         Cancel Date
     C                   EVAL      #1AQCD = ' '                                 Terms Code
     C                   EVAL      #1B6NA = ' '                                 Special Instruc
     C                   EVAL      #1BYNA = ' '                                 Special Instruc
     C                   EVAL      #1BZNA = ' '                                 Carrier Code
     C                   EVAL      #1GTST = ' '                                 Comment Print A
     C                   EVAL      #1GVST = ' '                                 Comment Print I
     C                   EVAL      #1GUST = ' '                                 Comment Print P
     C                   EVAL      #1QFST = ' '                                 Comment Print S
     C                   EVAL      #1CQCD = ' '                                 Reason Code
     C                   EVAL      #1GJST = ' '                                 Order in Use
     C                   EVAL      #1GWST = ' '                                 Header Status
     C                   EVAL      #1GXST = ' '                                 Header Status L
     C                   EVAL      #1GYST = ' '                                 Order Type Prin
     C                   Z-ADD     *ZERO         #1AODT                         Scheduled Ship
     C                   EVAL      #1AIVN = ' '                                 User Original E
     C                   Z-ADD     *ZERO         #1CXDT                         Date of Origina
     C                   Z-ADD     *ZERO         #1JZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         #1A1WG                         Order Weight To
     C                   EVAL      #1XIST = ' '                                 Credit Hold
     C                   EVAL      #1XJST = ' '                                 Production Hold
     C                   EVAL      #1XKST = ' '                                 New Customer Ho
     C                   Z-ADD     *ZERO         #1EIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         #1AFTM                         Requested Deliv
     C                   EVAL      #1E8CD = ' '                                 Accounts Receiv
     C                   EVAL      #1E9CD = ' '                                 Accounts Receiv
     C                   Z-ADD     *ZERO         #1RMNB                         Load ID
     C                   Z-ADD     *ZERO         #1TBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         #1R1NB                         Rated Freight
     C                   EVAL      #1PJST = ' '                                 LTL Flag
     C                   EVAL      #1U0ST = ' '                                 Price Audit
     C                   EVAL      #1U1ST = ' '                                 Price Status
     C                   EVAL      #1Q2CD = ' '                                 Shipping Method
     C                   EVAL      #1U2ST = ' '                                 Export Status
     C                   EVAL      #1VEST = ' '                                 Palletize
     C                   EVAL      #1VFST = ' '                                 Shrink Wrap
     C                   EVAL      #1VGST = ' '                                 Slip Sheet
     C                   EVAL      #1RPCD = ' '                                 Age Code
     C                   Z-ADD     *ZERO         #1RNNB                         Reefer Temperat
     C                   EVAL      #1VDST = ' '                                 Load Type
     C                   Z-ADD     *ZERO         #1ATIN                         Attach to Invoi
     C                   EVAL      #1U4ST = ' '                                 Load Plan Order
     C                   EVAL      #1U5ST = ' '                                 Print Pick Slip
     C                   Z-ADD     *ZERO         #1RSRN                         Resell Referenc
     C                   EVAL      #1MHNA = ' '                                 Special Comment
     C                   EVAL      #1MINA = ' '                                 Special Comment
     C                   EVAL      #1WBST = ' '                                 Affect Auto Acc
     C                   EVAL      #1R4CD = ' '                                 Sales Route Cod
     C                   EVAL      #1BFCD = ' '                                 Manager Level C
     C                   EVAL      #1Q4CD = ' '                                 VP Level Code
     C                   Z-ADD     *ZERO         #1T3NB                         Attach to Order
     C                   EVAL      #1SICD = ' '                                 Reason for Pric
     C                   Z-ADD     *ZERO         #1CONB                         Invoice Number
     C                   EVAL      #1CEST = ' '                                 Invoice Suffix
     C                   Z-ADD     *ZERO         #1AWDT                         Invoice Date
     C                   EVAL      #1JPCD = ' '                                 Event Code
     C                   EVAL      #1XUST = ' '                                 Trans Contol AS
     C                   EVAL      #1Z1ST = ' '                                 Modified Flag
     C                   Z-ADD     *ZERO         #1VRVA                         A_R order Value
     C                   EVAL      #1OBST = ' '                                 Billing Activit
     C                   EVAL      #1BCST = ' '                                 Block Order Fla
     C                   EVAL      #1BDST = ' '                                 Order Certifica
     C                   Z-ADD     *ZERO         #1B7VL                         Invoice Order V
     C                   EVAL      #1GASX = ' '                                 Process Sts for
     C                   EVAL      #1GBSX = ' '                                 Order Conf Fax
     C                   EVAL      #1GCSX = ' '                                 Manifest Fax St
     C                   EVAL      #1GDSX = ' '                                 Invoice Fax Sts
     C                   EVAL      #1FNSX = ' '                                 Transfer in Sto
     C                   EVAL      #1FOSX = ' '                                 Email Cust On O
     C                   EVAL      #1FPSX = ' '                                 Order Emailed
     C                   EVAL      #1FQSX = ' '                                 Export Docs Go
     C                   EVAL      #1FRSX = ' '                                 Shipping Temp C
     C                   EVAL      #1FSSX = ' '                                 Broker Order St
     C                   EVAL      #1FTSX = ' '                                 Air Freight Ord
     C                   EVAL      #1FUSX = ' '                                 Order Requires
     C                   EVAL      #1FVSX = ' '                                 OH Load Plan Re
     C                   EVAL      #1FWSX = ' '                                 Export USDA App
     C                   EVAL      #1FXSX = ' '                                 HPB Ship to War
     C                   EVAL      #1FYSX = ' '                                 OH TF Exempt Co
     C                   Z-ADD     *ZERO         #1NODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         #1NPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         #1NQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         #1NRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         #1NSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         #1BPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         #1BQTM                         Time of Origina
     C                   Z-ADD     *ZERO         #1BRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         #1BSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         #1BTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         #1H0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         #1H1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         #1H2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         #1H3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         #1H4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         #1C0C7                         Claim Number
     C                   EVAL      #1UVST = ' '                                 EDI Status 1
     C                   EVAL      #1UWST = ' '                                 EDI Status 2
     C                   EVAL      #1UXST = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         #1AATM                         Job Time
     C                   EVAL      #1AYNA = ' '                                 User Id
     C                   EVAL      #1A0NA = ' '                                 Job Name
     C                   Z-ADD     *ZERO         #1AXDT                         Job Date
     C                   Z-ADD     *ZERO         #1C4NB                         Order Number
      * Clear external version also
     C                   EVAL      V1C4NB = ' '
     C                   Z-ADD     *ZERO         #1BKC7                         Ship To Custome
      * Clear external version also
     C                   EVAL      V1BKC7 = ' '
      *================================================================
     CSR   MAEXIT        ENDSR
      /EJECT
     CSR   MNCV#1        BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        #1C4NB <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     #1C4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        V1C4NB                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      V1C4NB = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        #1BKC7 <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     #1BKC7        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        V1BKC7                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      V1BKC7 = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      *================================================================
     CSR   MNEXIT        ENDSR
      /EJECT
     CSR   VACKRL        BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                   MOVEL     V1C4NB        WK1X02
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
     C                   IF        YPMTFD = '#1AIC3' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1C4NB'
     C                   CALL      'PDPCSRR'                            90      SEL Order
     C                   PARM      *BLANK        W0RTN
     C     #1AIC3        PARM      #1AIC3        WQ0001                         Company Number
     C     #1C4NB        PARM      #1C4NB        WQ0002                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDPCSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        9931      *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1C4NB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   END
      *================================================================
     CSR   VAEXIT        ENDSR
      /EJECT
     CSR   VBCKRL        BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                   IF        YPMTFD = '#1AIC3'
     C                   CALL      'CAAJSRR'                            90      SEL Company by
     C                   PARM      *BLANK        W0RTN
     C     #1AIC3        PARM      #1AIC3        WQ0003                         Company Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'CAAJSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VBEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AIC3 = *ZERO
     C                   GOTO      VBEXIT
     C                   END
      *
     C     KLVBWA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
      * Setup key
     C                   Z-ADD     #1AIC3        WAAIC3
     C     KLVBWA        CHAIN     @ABREUA                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VBEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VBEXIT
     C                   END
      * Send message 'Company Name and Addre NF'
     C                   MOVEL     'USR0003'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0003'     W0RTN
      *================================================================
     CSR   VBEXIT        ENDSR
      /EJECT
     CSR   VCCKRL        BEGSR
      *================================================================
      * Check reference to Order Types
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1JNCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JNCD' defaulted for 'Order Type_Sales'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1JNCD'
     C                   CALL      'PDZ2SRR'                            90      Zzz OP Order Ty
     C                   PARM      *BLANK        W0RTN
     C     #1JNCD        PARM      #1JNCD        WQ0004                         Order Type_Sale
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDZ2SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1JNCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VCEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1JNCD = ' '
     C                   GOTO      VCEXIT
     C                   END
      *
     C     KLVCWB        KLIST
     C                   KFLD                    WBJNCD                         Order Type_Sale
      * Setup key
     C                   MOVEL     #1JNCD        WBJNCD
     C     KLVCWB        CHAIN     @EXRETY                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VCEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VCEXIT
     C                   END
      * Send message 'Order Types            NF'
     C                   MOVEL     'USR1063'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR1063'     W0RTN
      *================================================================
     CSR   VCEXIT        ENDSR
      /EJECT
     CSR   VDCKRL        BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'AR Customer Number'.
     C                   IF        YPMTFD = '#1ANC7'
     C                   CALL      'PDCJSRR'                            90      SEL Customer by
     C                   PARM      *BLANK        W0RTN
     C     #1ANC7        PARM      #1ANC7        WQ0005                         Ship To Custome
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDCJSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1ANC7 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VDEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1ANC7 = *ZERO
     C                   GOTO      VDEXIT
     C                   END
      *
     C     KLVDWC        KLIST
     C                   KFLD                    WCBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     #1ANC7        WCBKC7
     C     KLVDWC        CHAIN     @BBREWG                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VDEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VDEXIT
     C                   END
      * Send message 'Customer Master        NF'
     C                   MOVEL     'USR0170'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0170'     W0RTN
      *================================================================
     CSR   VDEXIT        ENDSR
      /EJECT
     CSR   VECKRL        BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     V1BKC7        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BKC7' defaulted for 'Ship To Customer'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1BKC7'
     C                   CALL      'PDCJSRR'                            90      SEL Customer by
     C                   PARM      *BLANK        W0RTN
     C     #1BKC7        PARM      #1BKC7        WQ0006                         Ship To Custome
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDCJSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        9932      *
     C                   END
      *
     C                   IF        #1BKC7 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VEEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1BKC7 = *ZERO
     C                   GOTO      VEEXIT
     C                   END
      *
     C     KLVEWC        KLIST
     C                   KFLD                    WCBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     #1BKC7        WCBKC7
     C     KLVEWC        CHAIN     @BBREWG                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VEEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VEEXIT
     C                   END
      * Send message 'Customer Master        NF'
     C                   MOVEL     'USR0170'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0170'     W0RTN
      *================================================================
     CSR   VEEXIT        ENDSR
      /EJECT
     CSR   VFCKRL        BEGSR
      *================================================================
      * Check reference to State Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1DBCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1DBCD'
     C                   CALL      'CAAHSRR'                            90      SEL State
     C                   PARM      *BLANK        W0RTN
     C     #1DBCD        PARM      #1DBCD        WQ0007                         State Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'CAAHSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1DBCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VFEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1DBCD = ' '
     C                   GOTO      VFEXIT
     C                   END
      *
     C     KLVFWD        KLIST
     C                   KFLD                    WDBGCD                         State Code
      * Setup key
     C                   MOVEL     #1DBCD        WDBGCD
     C     KLVFWD        CHAIN     @ACRET7                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VFEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VFEXIT
     C                   END
      * Send message 'State Master           NF'
     C                   MOVEL     'USR0005'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0005'     W0RTN
      *================================================================
     CSR   VFEXIT        ENDSR
      /EJECT
     CSR   VGCKRL        BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1B0C7' defaulted for 'Bill to Customer'.
     C                   IF        YPMTFD = '#1B0C7'
     C                   CALL      'PDCJSRR'                            90      SEL Customer by
     C                   PARM      *BLANK        W0RTN
     C     #1B0C7        PARM      #1B0C7        WQ0008                         Ship To Custome
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDCJSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1B0C7 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VGEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1B0C7 = *ZERO
     C                   GOTO      VGEXIT
     C                   END
      *
     C     KLVGWC        KLIST
     C                   KFLD                    WCBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     #1B0C7        WCBKC7
     C     KLVGWC        CHAIN     @BBREWG                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VGEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VGEXIT
     C                   END
      * Send message 'Customer Master        NF'
     C                   MOVEL     'USR0170'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0170'     W0RTN
      *================================================================
     CSR   VGEXIT        ENDSR
      /EJECT
     CSR   VHCKRL        BEGSR
      *================================================================
      * Check reference to State Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1BHCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BHCD' defaulted for 'Bill to State Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1BHCD'
     C                   CALL      'CAAHSRR'                            90      SEL State
     C                   PARM      *BLANK        W0RTN
     C     #1BHCD        PARM      #1BHCD        WQ0009                         State Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'CAAHSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1BHCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VHEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1BHCD = ' '
     C                   GOTO      VHEXIT
     C                   END
      *
     C     KLVHWD        KLIST
     C                   KFLD                    WDBGCD                         State Code
      * Setup key
     C                   MOVEL     #1BHCD        WDBGCD
     C     KLVHWD        CHAIN     @ACRET7                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VHEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VHEXIT
     C                   END
      * Send message 'State Master           NF'
     C                   MOVEL     'USR0005'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0005'     W0RTN
      *================================================================
     CSR   VHEXIT        ENDSR
      /EJECT
     CSR   VICKRL        BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1A0DT = *ZERO
     C                   GOTO      VIEXIT
     C                   END
      *
     C     KLVIWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1A0DT        WEBCDT
     C     KLVIWE        CHAIN     @AFREBE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VIEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VIEXIT
     C                   END
      * Send message 'Calendar Master        NF'
     C                   MOVEL     'USR0018'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0018'     W0RTN
      *================================================================
     CSR   VIEXIT        ENDSR
      /EJECT
     CSR   VJCKRL        BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1A5DT = *ZERO
     C                   GOTO      VJEXIT
     C                   END
      *
     C     KLVJWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1A5DT        WEBCDT
     C     KLVJWE        CHAIN     @AFREBE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VJEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VJEXIT
     C                   END
      * Send message 'Calendar Master        NF'
     C                   MOVEL     'USR0018'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0018'     W0RTN
      *================================================================
     CSR   VJEXIT        ENDSR
      /EJECT
     CSR   VKCKRL        BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1GNDT = *ZERO
     C                   GOTO      VKEXIT
     C                   END
      *
     C     KLVKWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1GNDT        WEBCDT
     C     KLVKWE        CHAIN     @AFREBE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VKEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VKEXIT
     C                   END
      * Send message 'Calendar Master        NF'
     C                   MOVEL     'USR0018'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0018'     W0RTN
      *================================================================
     CSR   VKEXIT        ENDSR
      /EJECT
     CSR   VLCKRL        BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1ACDT = *ZERO
     C                   GOTO      VLEXIT
     C                   END
      *
     C     KLVLWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1ACDT        WEBCDT
     C     KLVLWE        CHAIN     @AFREBE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VLEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VLEXIT
     C                   END
      * Send message 'Calendar Master        NF'
     C                   MOVEL     'USR0018'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0018'     W0RTN
      *================================================================
     CSR   VLEXIT        ENDSR
      /EJECT
     CSR   VMCKRL        BEGSR
      *================================================================
      * Check reference to Terms Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1AQCD        WK1X02
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AQCD' defaulted for 'Terms Code'.
     C                   IF        YPMTFD = '#1AIC3' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1AQCD'
     C                   CALL      'PDDMSRR'                            90      SEL Active Term
     C                   PARM      *BLANK        W0RTN
     C     #1AIC3        PARM      #1AIC3        WQ0010                         Company Number
     C     #1AQCD        PARM      #1AQCD        WQ0011                         Terms Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDDMSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1AQCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VMEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AQCD = ' '
     C                   GOTO      VMEXIT
     C                   END
      *
     C     KLVMWF        KLIST
     C                   KFLD                    WFAIC3                         Company Number
     C                   KFLD                    WFAQCD                         Terms Code
      * Setup key
     C                   Z-ADD     #1AIC3        WFAIC3
     C                   MOVEL     #1AQCD        WFAQCD
     C     KLVMWF        CHAIN     @AOREU1                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VMEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VMEXIT
     C                   END
      * Send message 'Terms Master           NF'
     C                   MOVEL     'USR0037'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0037'     W0RTN
      *================================================================
     CSR   VMEXIT        ENDSR
      /EJECT
     CSR   VNCKRL        BEGSR
      *================================================================
      * Check reference to Carrier Info
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1BZNA        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1BZNA'
     C                   CALL      'OMY6SRR'                            90      SEL Active Carr
     C                   PARM      *BLANK        W0RTN
     C     #1BZNA        PARM      #1BZNA        WQ0012                         Carrier Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'OMY6SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1BZNA <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VNEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1BZNA = ' '
     C                   GOTO      VNEXIT
     C                   END
      *
     C     KLVNWG        KLIST
     C                   KFLD                    WGBZNA                         Carrier Code
      * Setup key
     C                   MOVEL     #1BZNA        WGBZNA
     C     KLVNWG        CHAIN     @FFREUG                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VNEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VNEXIT
     C                   END
      * Send message 'Carrier Info           NF'
     C                   MOVEL     'USR1180'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR1180'     W0RTN
      *================================================================
     CSR   VNEXIT        ENDSR
      /EJECT
     CSR   VOCKRL        BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1CQCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1CQCD'
     C                   CALL      'OPTNSRR'                            90      Zzz Order Reaso
     C                   PARM      *BLANK        W0RTN
     C     #1CQCD        PARM      #1CQCD        WQ0013                         Reason Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'OPTNSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1CQCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VOEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1CQCD = ' '
     C                   GOTO      VOEXIT
     C                   END
      *
     C     KLVOWH        KLIST
     C                   KFLD                    WHCQCD                         Reason Code
      * Setup key
     C                   MOVEL     #1CQCD        WHCQCD
     C     KLVOWH        CHAIN     @CXRET4                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VOEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VOEXIT
     C                   END
      * Send message 'OP Reason Codes        NF'
     C                   MOVEL     'USR0504'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0504'     W0RTN
      *================================================================
     CSR   VOEXIT        ENDSR
      /EJECT
     CSR   VPCKRL        BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1AODT = *ZERO
     C                   GOTO      VPEXIT
     C                   END
      *
     C     KLVPWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1AODT        WEBCDT
     C     KLVPWE        CHAIN     @AFREBE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VPEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VPEXIT
     C                   END
      * Send message 'Calendar Master        NF'
     C                   MOVEL     'USR0018'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0018'     W0RTN
      *================================================================
     CSR   VPEXIT        ENDSR
      /EJECT
     CSR   VQCKRL        BEGSR
      *================================================================
      * Check reference to User Profile Control
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1AIVN        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIVN' defaulted for 'User Original Entry'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1AIVN'
     C                   CALL      'CAXPSRR'                            90      SEL User Profil
     C                   PARM      *BLANK        W0RTN
     C     #1AIVN        PARM      #1AIVN        WQ0014                         User Profile Na
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'CAXPSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AIVN <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VQEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AIVN = ' '
     C                   GOTO      VQEXIT
     C                   END
      *
     C     KLVQWI        KLIST
     C                   KFLD                    WIAJVN                         User Profile Na
      * Setup key
     C                   MOVEL     #1AIVN        WIAJVN
     C     KLVQWI        CHAIN     @DRRETH                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VQEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VQEXIT
     C                   END
      * Send message 'User Profile Control   NF'
     C                   MOVEL     'USR0763'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0763'     W0RTN
      *================================================================
     CSR   VQEXIT        ENDSR
      /EJECT
     CSR   VRCKRL        BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1EIDT = *ZERO
     C                   GOTO      VREXIT
     C                   END
      *
     C     KLVRWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1EIDT        WEBCDT
     C     KLVRWE        CHAIN     @AFREBE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VREXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VREXIT
     C                   END
      * Send message 'Calendar Master        NF'
     C                   MOVEL     'USR0018'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0018'     W0RTN
      *================================================================
     CSR   VREXIT        ENDSR
      /EJECT
     CSR   VSCKRL        BEGSR
      *================================================================
      * Check reference to Enterprise Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1E8CD        WK1X02
     C                   MOVEL     #1E9CD        WK1X03
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1E8CD' defaulted for 'Accounts Receiv_Ent 1'.
      * Field '(DTL) #1E9CD' defaulted for 'Accounts Receiv_Ent 2'.
     C                   IF        YPMTFD = '#1AIC3' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1E8CD' OR
     C                             WK1X03 = '?' OR
     C                             YPMTFD = '#1E9CD'
     C                   CALL      'CAXTSRR'                            90      ZZZ Enterprise
     C                   PARM      *BLANK        W0RTN
     C     #1AIC3        PARM      #1AIC3        WQ0015                         Company Number
     C     #1E8CD        PARM      #1E8CD        WQ0016                         Enterprise Code
     C     #1E9CD        PARM      #1E9CD        WQ0017                         Enterprise Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'CAXTSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1E8CD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1E9CD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X03 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VSEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1E8CD = ' ' AND
     C                             #1E9CD = ' '
     C                   GOTO      VSEXIT
     C                   END
      *
     C     KLVSWJ        KLIST
     C                   KFLD                    WJAIC3                         Company Number
     C                   KFLD                    WJDQCD                         Enterprise Code
     C                   KFLD                    WJDRCD                         Enterprise Code
      * Setup key
     C                   Z-ADD     #1AIC3        WJAIC3
     C                   MOVEL     #1E8CD        WJDQCD
     C                   MOVEL     #1E9CD        WJDRCD
     C     KLVSWJ        CHAIN     @DSRETN                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VSEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VSEXIT
     C                   END
      * Send message 'Enterprise Master      NF'
     C                   MOVEL     'USR0765'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0765'     W0RTN
      *================================================================
     CSR   VSEXIT        ENDSR
      /EJECT
     CSR   VTCKRL        BEGSR
      *================================================================
      * Check reference to Load Header
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                   IF        YPMTFD = '#1RMNB'
     C                   CALL      'OMCPSRR'                            90      SEL Load ID
     C                   PARM      *BLANK        W0RTN
     C     #1RMNB        PARM      #1RMNB        WQ0018                         Load ID
     C     #1AIC3        PARM      #1AIC3        WQ0019                         Company Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'OMCPSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1RMNB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VTEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1RMNB = *ZERO
     C                   GOTO      VTEXIT
     C                   END
      *
     C     KLVTWK        KLIST
     C                   KFLD                    WKRMNB                         Load ID
      * Setup key
     C                   Z-ADD     #1RMNB        WKRMNB
     C     KLVTWK        CHAIN     @FJCPBN                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VTEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VTEXIT
     C                   END
      * Send message 'Load Header            NF'
     C                   MOVEL     'USR1188'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR1188'     W0RTN
      *================================================================
     CSR   VTEXIT        ENDSR
      /EJECT
     CSR   VUCKRL        BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1R4CD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1R4CD'
     C                   CALL      'PDFWSRR'                            90      SEL PD Sales Ro
     C                   PARM      *BLANK        W0RTN
     C     #1R4CD        PARM      #1R4CD        WQ0020                         Sales Route Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDFWSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1R4CD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VUEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1R4CD = ' '
     C                   GOTO      VUEXIT
     C                   END
      *
     C     KLVUWL        KLIST
     C                   KFLD                    WLR4CD                         Sales Route Cod
      * Setup key
     C                   MOVEL     #1R4CD        WLR4CD
     C     KLVUWL        CHAIN     @JEREWS                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VUEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VUEXIT
     C                   END
      * Send message 'Sales Route            NF'
     C                   MOVEL     'USR1800'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR1800'     W0RTN
      *================================================================
     CSR   VUEXIT        ENDSR
      /EJECT
     CSR   VVCKRL        BEGSR
      *================================================================
      * Check reference to Manager Level
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1BFCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BFCD' defaulted for 'Manager Level Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1BFCD'
     C                   CALL      'CABRSRR'                            90      SEL Manager Lev
     C                   PARM      *BLANK        W0RTN
     C     #1BFCD        PARM      #1BFCD        WQ0021                         Manager Level C
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'CABRSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1BFCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VVEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1BFCD = ' '
     C                   GOTO      VVEXIT
     C                   END
      *
     C     KLVVWM        KLIST
     C                   KFLD                    WMBFCD                         Manager Level C
      * Setup key
     C                   MOVEL     #1BFCD        WMBFCD
     C     KLVVWM        CHAIN     @ALREVE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VVEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VVEXIT
     C                   END
      * Send message 'Manager Level          NF'
     C                   MOVEL     'USR0030'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0030'     W0RTN
      *================================================================
     CSR   VVEXIT        ENDSR
      /EJECT
     CSR   VWCKRL        BEGSR
      *================================================================
      * Check reference to VP Level Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1Q4CD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1Q4CD' defaulted for 'VP Level Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1Q4CD'
     C                   CALL      'PDE0SRR'                            90      SEL VP Level Ac
     C                   PARM      *BLANK        W0RTN
     C     #1Q4CD        PARM      #1Q4CD        WQ0022                         VP Level Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDE0SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1Q4CD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VWEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1Q4CD = ' '
     C                   GOTO      VWEXIT
     C                   END
      *
     C     KLVWWO        KLIST
     C                   KFLD                    WOQ4CD                         VP Level Code
      * Setup key
     C                   MOVEL     #1Q4CD        WOQ4CD
     C     KLVWWO        CHAIN     @IFREWB                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VWEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VWEXIT
     C                   END
      * Send message 'VP Level Master        NF'
     C                   MOVEL     'USR1661'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR1661'     W0RTN
      *================================================================
     CSR   VWEXIT        ENDSR
      /EJECT
     CSR   VXCKRL        BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1T3NB' defaulted for 'Attach to Order Number'.
     C                   IF        YPMTFD = '#1AIC3' OR
     C                             YPMTFD = '#1T3NB'
     C                   CALL      'PDPCSRR'                            90      SEL Order
     C                   PARM      *BLANK        W0RTN
     C     #1AIC3        PARM      #1AIC3        WQ0023                         Company Number
     C     #1T3NB        PARM      #1T3NB        WQ0024                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDPCSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1T3NB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VXEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1T3NB = *ZERO
     C                   GOTO      VXEXIT
     C                   END
      *
     C     KLVXBE        KLIST
     C                   KFLD                    BEAIC3                         Company Number
     C                   KFLD                    BEC4NB                         Order Number
      * Setup key
     C                   Z-ADD     #1AIC3        BEAIC3
     C                   Z-ADD     #1T3NB        BEC4NB
     C     KLVXBE        CHAIN     @BECPFK                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VXEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VXEXIT
     C                   END
      * Send message 'Order Header TRG       NF'
     C                   MOVEL     'USR0176'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0176'     W0RTN
      *================================================================
     CSR   VXEXIT        ENDSR
      /EJECT
     CSR   VYCKRL        BEGSR
      *================================================================
      * Check reference to Internal Reason
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1SICD = ' '
     C                   GOTO      VYEXIT
     C                   END
      *
     C     KLVYWR        KLIST
     C                   KFLD                    WRSGCD                         Internal Reason
      * Setup key
     C                   MOVEL     #1SICD        WRSGCD
     C     KLVYWR        CHAIN     @JHREXO                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VYEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VYEXIT
     C                   END
      * Send message 'Internal Reason        NF'
     C                   MOVEL     'USR1835'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR1835'     W0RTN
      *================================================================
     CSR   VYEXIT        ENDSR
      /EJECT
     CSR   VZCKRL        BEGSR
      *================================================================
      * Check reference to AR Header New
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1CEST        WK1X03
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1CONB' defaulted for 'Invoice Number'.
      * Field '(DTL) #1CEST' defaulted for 'Invoice Suffix'.
     C                   IF        YPMTFD = '#1AIC3' OR
     C                             YPMTFD = '#1CONB' OR
     C                             WK1X03 = '?' OR
     C                             YPMTFD = '#1CEST'
     C                   CALL      'PDPGSRR'                            90      SEL A/R Header
     C                   PARM      *BLANK        W0RTN
     C                   PARM      #1AIC3        WQ0025                         Company Number
     C     #1CONB        PARM      #1CONB        WQ0026                         Invoice Number
     C     #1CEST        PARM      #1CEST        WQ0027                         Invoice Suffix
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDPGSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1CONB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1CEST <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X03 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VZEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1CONB = *ZERO AND
     C                             #1CEST = ' '
     C                   GOTO      VZEXIT
     C                   END
      *
     C     KLVZWS        KLIST
     C                   KFLD                    WSAIC3                         Company Number
     C                   KFLD                    WSCONB                         Invoice Number
     C                   KFLD                    WSCEST                         Invoice Suffix
      * Setup key
     C                   Z-ADD     #1AIC3        WSAIC3
     C                   Z-ADD     #1CONB        WSCONB
     C                   MOVEL     #1CEST        WSCEST
     C     KLVZWS        CHAIN     @BDCPF7                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VZEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VZEXIT
     C                   END
      * Send message 'AR Header New          NF'
     C                   MOVEL     'USR0174'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0174'     W0RTN
      *================================================================
     CSR   VZEXIT        ENDSR
      /EJECT
     CSR   WACKRL        BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1AWDT = *ZERO
     C                   GOTO      WAEXIT
     C                   END
      *
     C     KLWAWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1AWDT        WEBCDT
     C     KLWAWE        CHAIN     @AFREBE                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      WAEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      WAEXIT
     C                   END
      * Send message 'Calendar Master        NF'
     C                   MOVEL     'USR0018'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0018'     W0RTN
      *================================================================
     CSR   WAEXIT        ENDSR
      /EJECT
     CSR   WBCKRL        BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1JPCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JPCD' defaulted for 'Event Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1JPCD'
     C                   CALL      'PDEQSRR'                            90      SEL Event Types
     C                   PARM      *BLANK        W0RTN
     C     #1JPCD        PARM      #1JPCD        WQ0028                         Event Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDEQSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1JPCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      WBEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1JPCD = ' '
     C                   GOTO      WBEXIT
     C                   END
      *
     C     KLWBWT        KLIST
     C                   KFLD                    WTJPCD                         Event Code
      * Setup key
     C                   MOVEL     #1JPCD        WTJPCD
     C     KLWBWT        CHAIN     @EZREYT                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      WBEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      WBEXIT
     C                   END
      * Send message 'Event Types            NF'
     C                   MOVEL     'USR1076'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR1076'     W0RTN
      *================================================================
     CSR   WBEXIT        ENDSR
      /EJECT
     CSR   WCCKRL        BEGSR
      *================================================================
      * Check reference to AR Claim Header
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C0C7' defaulted for 'Claim Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0001' defaulted for 'Claim Company Number'.
      * Field '(LCL) YL0002' defaulted for 'Claim Ship to Customer'.
     C                   IF        YPMTFD = '#1C0C7'
     C                   CALL      'PMCSSRR'                            90      Sel A/R Claim
     C                   PARM      *BLANK        W0RTN
     C     #1C0C7        PARM      #1C0C7        WQ0029                         Claim Number
     C     YL0001        PARM      YL0001        WQ0030                         Claim Company N
     C     YL0002        PARM      YL0002        WQ0031                         Claim Ship to C
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PMCSSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1C0C7 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      WCEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1C0C7 = *ZERO
     C                   GOTO      WCEXIT
     C                   END
      *
     C     KLWCWV        KLIST
     C                   KFLD                    WVC0C7                         Claim Number
      * Setup key
     C                   Z-ADD     #1C0C7        WVC0C7
     C     KLWCWV        CHAIN     @MKCPWB                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      WCEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      WCEXIT
     C                   END
      * Send message 'AR Claim Header        NF'
     C                   MOVEL     'USR2729'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR2729'     W0RTN
      *================================================================
     CSR   WCEXIT        ENDSR
      /EJECT
     CSR   Y0SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y0EXIT        ENDSR
      /EJECT
     CSR   Y8TST         BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
      *================================================================
     CSR   Y8EXIT        ENDSR
      /EJECT
     CSR   Y9CLR         BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y9EXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZDVPMT        BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                   EVAL      YPMTFD = ' '
     C                   Z-ADD     *ZERO         YAFSCH
     C                   Z-ADD     *ZERO         YPMRRN
      *
      *
      * Extract cursor row and column
     C                   IF        *IN04
     C     @#RWCL        DIV       256           ZHCSRW
     C                   MVR                     ZHCSCL
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
     C                   IF        ZHCSRW = 008 AND
     C                             ZHCSCL >= 032 AND
     C                             ZHCSCL <= 038 AND
     C                             @#DFMT = '#RCDDTL1'
     C                   MOVEL     '#1C4NB'      YPMTFD                         Order Number
     C                   END
      *
     C                   IF        ZHCSRW = 012 AND
     C                             ZHCSCL >= 032 AND
     C                             ZHCSCL <= 038 AND
     C                             @#DFMT = '#RCDDTL1'
     C                   MOVEL     '#1BKC7'      YPMTFD                         Ship To Custome
     C                   END
      *
      * Error if user defined prompting is not specified.
     C                   IF        YPMTFD = ' '
     C                   IF        W0PMT = 'N'
     C                   MOVEL     '*NONE'       YPMTFD
     C                   MOVEL     'Y'           W0HLP
     C                   MOVEL     'Y'           ZAFSMS
      * Send error message.
     C                   MOVEL     'Y2U0101'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *
     C                   END
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZHHPKY        BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                   MOVEL     'Y'           W0HLP
      *
      * Extract cursor row and column
     C     @#RWCL        DIV       256           ZHCSRW                         Row
     C                   MVR                     ZHCSCL                         Column
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      *
     C                   CALL      'YDDSHPR'
     C                   PARM      ##PGM         W0HPMB                         Help text sourc
     C                   PARM      *BLANK        YYHPFL                         Help text file
     C                   PARM      *BLANK        YYHPLB                         Help text libra
     C                   PARM                    W0RTN
     C                   PARM      '*CSRLOC'     YYHLVN                         Help label
     C                   PARM      '*NORMAL'     YYUSOP                         Options
     C                   PARM      ZHCSRW        YYRW                           Row
     C                   PARM      ZHCSCL        YYCL                           Column
     C                   PARM      *ZERO         YYLGCT                         # of grps
     C                   PARM      *BLANK        YYLGVN                         Label grps
      *
      * Clear set cursor DDS indicator
     C  N94              MOVEL     'OFF'         WCSRLC
     C  N94              SETON                                        94        *
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Define work field USR First Position
     C                   EVAL      WUI3ST = ' '
      * Define work field CD7 Ext Numeric Key
     C                   EVAL      WUEOCD = ' '
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WCP3NB                         D_B Number
     C                   Z-ADD     *ZERO         WCI6DT                         Date of D_B Rat
     C                   Z-ADD     *ZERO         WCAYDT                         Credit Line Exp
     C                   Z-ADD     *ZERO         WCANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WCBTC7                         Parent Customer
     C                   Z-ADD     *ZERO         WCS2NB                         Parent Credit L
     C                   Z-ADD     *ZERO         WCVHVA                         AR Credit Limit
     C                   Z-ADD     *ZERO         WCI7DT                         Order Entry Hol
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEBCDT                         Post to G_L Dat
     C                   Z-ADD     *ZERO         WECQNB                         Julian Date
     C                   Z-ADD     *ZERO         WEESNB                         Accounting Year
     C                   Z-ADD     *ZERO         WEETNB                         Accounting Peri
     C                   Z-ADD     *ZERO         WEBZNB                         OM Week
     C                   Z-ADD     *ZERO         WEEINB                         Week Number
     C                   Z-ADD     *ZERO         WEAQNB                         Billing Cycle
     C                   Z-ADD     *ZERO         WEOJDT                         HPS PIC Date
     C                   Z-ADD     *ZERO         WENQNX                         HPS Calendar Ye
     C                   Z-ADD     *ZERO         WENRNX                         HPS Calendar We
     C                   Z-ADD     *ZERO         WEOKDT                         Calendar Unused
     C                   Z-ADD     *ZERO         WEOLDT                         Calendar Unused
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFAIC3                         Company Number
     C                   Z-ADD     *ZERO         WFANDY                         Net Due Days
     C                   Z-ADD     *ZERO         WFAKDY                         Discount Due Da
     C                   Z-ADD     *ZERO         WFA4PC                         Terms Discount
     C                   Z-ADD     *ZERO         WFAJDY                         Cutoff Day
     C                   Z-ADD     *ZERO         WFCUNB                         Months to add b
     C                   Z-ADD     *ZERO         WFALDY                         Disc Due Day be
     C                   Z-ADD     *ZERO         WFAPDY                         Net Due Day bef
     C                   Z-ADD     *ZERO         WFCTNB                         Months to add a
     C                   Z-ADD     *ZERO         WFAMDY                         Disc Due Day af
     C                   Z-ADD     *ZERO         WFAQDY                         Net Due Day aft
     C                   Z-ADD     *ZERO         WFASDT                         Discount Due Da
     C                   Z-ADD     *ZERO         WFATDT                         Due Date
     C                   Z-ADD     *ZERO         WFAATM                         Job Time
     C                   Z-ADD     *ZERO         WFAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGEZNB                         Telephone Numbe
     C                   Z-ADD     *ZERO         WGEEDT                         Carrier Last Us
     C                   Z-ADD     *ZERO         WGNRVA                         Pallet Balance
     C                   Z-ADD     *ZERO         WGNSVA                         Long hook balan
     C                   Z-ADD     *ZERO         WGNTVA                         Short hook bala
     C                   Z-ADD     *ZERO         WGNUVA                         Tub Balance
     C                   Z-ADD     *ZERO         WGS8NB                         Home Phone
     C                   Z-ADD     *ZERO         WGS9NB                         Other Phone
     C                   Z-ADD     *ZERO         WGNMVA                         Flat Rate
     C                   Z-ADD     *ZERO         WGNOVA                         Rate Per Pound
     C                   Z-ADD     *ZERO         WGNPVA                         Unused Rate Per
     C                   Z-ADD     *ZERO         WGNQVA                         Miscellaneous C
     C                   Z-ADD     *ZERO         WGQXNB                         Unused Mile Ran
     C                   Z-ADD     *ZERO         WGQ1NB                         Unused Mile Ran
     C                   Z-ADD     *ZERO         WGMRNG                         Unused Mile Ran
     C                   Z-ADD     *ZERO         WGMRNE                         Unused Mile Ran
     C                   Z-ADD     *ZERO         WGRFNB                         Unused Mile Ran
     C                   Z-ADD     *ZERO         WGMREG                         Unused Mile Ran
     C                   Z-ADD     *ZERO         WGBQPR                         Unused Mile Rat
     C                   Z-ADD     *ZERO         WGBRPR                         Unused Mile Rat
     C                   Z-ADD     *ZERO         WGBSPR                         Unused Mile Rat
     C                   Z-ADD     *ZERO         WGBTPR                         Unused Mile Rat
     C                   Z-ADD     *ZERO         WGBUPR                         Unused Mile Rat
     C                   Z-ADD     *ZERO         WGBVPR                         Unused Mile Rat
     C                   Z-ADD     *ZERO         WGDJWG                         Unused Weight R
     C                   Z-ADD     *ZERO         WGDKWG                         Unused Weight R
     C                   Z-ADD     *ZERO         WGDLWG                         Unused Weight R
     C                   Z-ADD     *ZERO         WGDMWG                         Unused Weight R
     C                   Z-ADD     *ZERO         WGDNWG                         Unused Weight R
     C                   Z-ADD     *ZERO         WGDOWG                         Unused Weight R
     C                   Z-ADD     *ZERO         WGB2PR                         Unused Weight R
     C                   Z-ADD     *ZERO         WGB3PR                         Unused Weight R
     C                   Z-ADD     *ZERO         WGB4PR                         Unused Weight R
     C                   Z-ADD     *ZERO         WGB5PR                         Unused Weight R
     C                   Z-ADD     *ZERO         WGB6PR                         Unused Weight R
     C                   Z-ADD     *ZERO         WGB7PR                         Unused Weight R
     C                   Z-ADD     *ZERO         WGAAC7                         Contact Number
     C                   Z-ADD     *ZERO         WGTENO                         Carrier Unused
     C                   Z-ADD     *ZERO         WGAOFC                         Amount of Cargo
     C                   Z-ADD     *ZERO         WGAOLI                         Amount of Liabi
     C                   Z-ADD     *ZERO         WGKHDT                         Date of Expirat
     C                   Z-ADD     *ZERO         WGAATM                         Job Time
     C                   Z-ADD     *ZERO         WGAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WHAATM                         Job Time
     C                   Z-ADD     *ZERO         WHAXDT                         Job Date
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(002)      XDTSDL
     C                   MOVEL     XDTSDL        WHBVTS                         Created Dt Tm
     C                   MOVEL     XDTSDL        WHBWTS                         Updated Dt Tm
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WINLNB                         Entity Number
     C                   Z-ADD     *ZERO         WIAIC3                         Company Number
     C                   Z-ADD     *ZERO         WIAATM                         Job Time
     C                   Z-ADD     *ZERO         WIAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WJAIC3                         Company Number
     C                   Z-ADD     *ZERO         WJAATM                         Job Time
     C                   Z-ADD     *ZERO         WJAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WKRMNB                         Load ID
     C                   Z-ADD     *ZERO         WKAIC3                         Company Number
     C                   Z-ADD     *ZERO         WKAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WKRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WKRPNB                         Total Load Orde
     C                   Z-ADD     *ZERO         WKFLAM                         Flat Amount
     C                   Z-ADD     *ZERO         WKRRNB                         Total Stops
     C                   Z-ADD     *ZERO         WKSBNB                         BOL Time
     C                   Z-ADD     *ZERO         WKSQNB                         Ld Hdr_Ld Dtl U
     C                   Z-ADD     *ZERO         WKR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WKSDNB                         Number Pallets
     C                   Z-ADD     *ZERO         WKPAOU                         Number Pallets
     C                   Z-ADD     *ZERO         WKDGWG                         Load Carrier Pa
     C                   Z-ADD     *ZERO         WKSXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         WKHADT                         Actual Arrival
     C                   Z-ADD     *ZERO         WKAART                         Actual Arrival
     C                   Z-ADD     *ZERO         WKDHWG                         Trailer IN Weig
     C                   Z-ADD     *ZERO         WKDIWG                         Trailer OUT Wei
     C                   Z-ADD     *ZERO         WKAQDT                         Actual Departur
     C                   Z-ADD     *ZERO         WKS6NB                         Departure Time
     C                   Z-ADD     *ZERO         WKT4NB                         Schedule Sequen
     C                   Z-ADD     *ZERO         WKPRTM                         Product Tempera
     C                   Z-ADD     *ZERO         WKNPSV                         Number Spacers
     C                   Z-ADD     *ZERO         WKTLMI                         Total Load Mile
     C                   Z-ADD     *ZERO         WKGRWE                         Gross Weight
     C                   Z-ADD     *ZERO         WKF9DT                         Actual Ship Dat
     C                   Z-ADD     *ZERO         WKJ4DT                         Truck Ready Dat
     C                   Z-ADD     *ZERO         WKTRTM                         Truck Ready Tim
     C                   Z-ADD     *ZERO         WKJ5DT                         Spotted Date
     C                   Z-ADD     *ZERO         WKSPTM                         Spotted Time
     C                   Z-ADD     *ZERO         WKJ6DT                         Load Finished D
     C                   Z-ADD     *ZERO         WKLFTM                         Load Finished T
     C                   Z-ADD     *ZERO         WKJ7DT                         BOL Complete Da
     C                   Z-ADD     *ZERO         WKBOTM                         BOL Complete Ti
     C                   Z-ADD     *ZERO         WKJ8DT                         BOL Received Da
     C                   Z-ADD     *ZERO         WKBLTM                         BOL Received Ti
     C                   Z-ADD     *ZERO         WKKIDT                         Truck Departure
     C                   Z-ADD     *ZERO         WKASTM                         Truck Departure
     C                   Z-ADD     *ZERO         WKKADT                         Adjusted Depart
     C                   Z-ADD     *ZERO         WKAJCM                         Adjusted Depart
     C                   Z-ADD     *ZERO         WKVOAG                         Voyage
     C                   Z-ADD     *ZERO         WKKBDT                         Sail Date
     C                   Z-ADD     *ZERO         WKEFDT                         Arrival Date
     C                   Z-ADD     *ZERO         WKKCDT                         Date In
     C                   Z-ADD     *ZERO         WKTMIN                         Time In
     C                   Z-ADD     *ZERO         WKKDDT                         Date Out
     C                   Z-ADD     *ZERO         WKVMNB                         Time Out
     C                   Z-ADD     *ZERO         WKOCFR                         Load Total Frei
     C                   Z-ADD     *ZERO         WKKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WKATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WKBRBK                         Bring Back Mile
     C                   Z-ADD     *ZERO         WKEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WKKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         WKAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         WKKZDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WKAXTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WKLLDT                         Express Mail Da
     C                   Z-ADD     *ZERO         WKK0DT                         Product Complet
     C                   Z-ADD     *ZERO         WKAYTM                         Product Complet
     C                   Z-ADD     *ZERO         WKKNNX                         Pallets Loaded
     C                   Z-ADD     *ZERO         WKICWG                         Avg Pallet Tare
     C                   Z-ADD     *ZERO         WKIDWG                         Tot Pallet Tare
     C                   Z-ADD     *ZERO         WKK1DT                         Load Confirmati
     C                   Z-ADD     *ZERO         WKAZTM                         Load Door 1
     C                   Z-ADD     *ZERO         WKK2DT                         Override Total
     C                   Z-ADD     *ZERO         WKA0TM                         Load Door 2
     C                   Z-ADD     *ZERO         WKZBVA                         Load Actual Fre
     C                   Z-ADD     *ZERO         WKPYDT                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WKCKTM                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WKPZDT                         LH Last Combo P
     C                   Z-ADD     *ZERO         WKCLTM                         LH Last Combo P
     C                   Z-ADD     *ZERO         WKP0DT                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WKCMTM                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WKP1DT                         TPM Planned Shi
     C                   Z-ADD     *ZERO         WKCNTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WKP2DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WKCOTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WKP3DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WKCQTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WKAATM                         Job Time
     C                   Z-ADD     *ZERO         WKAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WLAATM                         Job Time
     C                   Z-ADD     *ZERO         WLAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WMAATM                         Job Time
     C                   Z-ADD     *ZERO         WMAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WOAATM                         Job Time
     C                   Z-ADD     *ZERO         WOAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WRAATM                         Job Time
     C                   Z-ADD     *ZERO         WRAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WSAIC3                         Company Number
     C                   Z-ADD     *ZERO         WSCONB                         Invoice Number
     C                   Z-ADD     *ZERO         WSBSVA                         Transaction Amo
     C                   Z-ADD     *ZERO         WSAIVA                         Adjustment Amou
     C                   Z-ADD     *ZERO         WSAOVA                         Amount Paid
     C                   Z-ADD     *ZERO         WSBGVA                         Remaining Balan
     C                   Z-ADD     *ZERO         WSCKNB                         GL Document Num
     C                   Z-ADD     *ZERO         WSCAC7                         Order Number Re
     C                   Z-ADD     *ZERO         WSBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WSB4DT                         Transaction Dat
     C                   Z-ADD     *ZERO         WSATDT                         Due Date
     C                   Z-ADD     *ZERO         WSH0DT                         Last Payment Da
     C                   Z-ADD     *ZERO         WSH3DT                         Original Inv fo
     C                   Z-ADD     *ZERO         WSH4DT                         Paid in Full Da
     C                   Z-ADD     *ZERO         WSH5DT                         Last G_L Post D
     C                   Z-ADD     *ZERO         WSANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WSBSDY                         Days to Pay
     C                   Z-ADD     *ZERO         WSAATM                         Job Time
     C                   Z-ADD     *ZERO         WSAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WTAATM                         Job Time
     C                   Z-ADD     *ZERO         WTAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WVC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WVBIC3                         Claim Company N
     C                   Z-ADD     *ZERO         WVALNX                         Claim Order Num
     C                   Z-ADD     *ZERO         WVRMNB                         Load ID
     C                   Z-ADD     *ZERO         WVC3C7                         Claim Ship to C
     C                   Z-ADD     *ZERO         WVAYVL                         Claim Amount
     C                   Z-ADD     *ZERO         WVAZVL                         Claim Net Loss
     C                   Z-ADD     *ZERO         WVA0VL                         Claim Approved
     C                   Z-ADD     *ZERO         WVA1VL                         Lab Fee
     C                   Z-ADD     *ZERO         WVMLDT                         Resolve Claim b
     C                   Z-ADD     *ZERO         WVEJDT                         Actual Delivery
     C                   Z-ADD     *ZERO         WVMMDT                         Claim Called in
     C                   Z-ADD     *ZERO         WVMNDT                         Claim Entry Dat
     C                   Z-ADD     *ZERO         WVBGTM                         Claim Entry Tim
     C                   Z-ADD     *ZERO         WVC4C7                         Resale Ship to
     C                   Z-ADD     *ZERO         WVNFDT                         Sales Approved
     C                   Z-ADD     *ZERO         WVBJTM                         Sales Approved
     C                   Z-ADD     *ZERO         WVMODT                         Approved_Denied
     C                   Z-ADD     *ZERO         WVBHTM                         Approved_Denied
     C                   Z-ADD     *ZERO         WVMPDT                         Memo Created Da
     C                   Z-ADD     *ZERO         WVBITM                         Memo Created Ti
     C                   Z-ADD     *ZERO         WVEOVL                         Approved Net Lo
     C                   Z-ADD     *ZERO         WVEPVL                         Total Expense A
     C                   Z-ADD     *ZERO         WVP6DT                         Memo Post Date
     C                   Z-ADD     *ZERO         WVCRTM                         Memo Post Time
     C                   Z-ADD     *ZERO         WVYSNX                         TFS Batch Numbe
     C                   Z-ADD     *ZERO         WVF7PC                         Avg TF Responsi
     C                   Z-ADD     *ZERO         WVF8PC                         Avg SBF Respons
     C                   Z-ADD     *ZERO         WVF9PC                         STF Responsibil
     C                   Z-ADD     *ZERO         WVEQVL                         FPR ID
     C                   Z-ADD     *ZERO         WVERVL                         AC Unused Value
     C                   Z-ADD     *ZERO         WVESVL                         AC Unused Value
     C                   Z-ADD     *ZERO         WVETVL                         AC Unused Value
     C                   Z-ADD     *ZERO         WVGAPC                         AC Unused Pct 1
     C                   Z-ADD     *ZERO         WVGBPC                         AC Unused Pct 2
     C                   Z-ADD     *ZERO         WVMJDT                         Create Date
     C                   Z-ADD     *ZERO         WVBETM                         Create Time
     C                   Z-ADD     *ZERO         WVMKDT                         Change Date
     C                   Z-ADD     *ZERO         WVBFTM                         Change Time
     C                   MOVEL     XDTSDL        WVBVTS                         Created Dt Tm
     C                   MOVEL     XDTSDL        WVBWTS                         Updated Dt Tm
      * Flag no *SET CURSOR in the program
     C                   MOVE      'N'           YSETCS
     C                   EVALR     WCSRLC = ' '
      * Define *Synon program work fields
     C                   EVAL      W0CFL = ' '                                  *Cursor field
     C                   Z-ADD     *ZEROS        W0CRW                          *Cursor row
     C                   Z-ADD     *ZEROS        W0CCL                          *Cursor column
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   MOVE      ZZFFL         @1FFL
     C                   MOVE      ZZFLB         @1FLB
     C                   MOVE      ZZFMB         @1FMB
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local work field Claim Company Number
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field Claim Ship to Customer
     C                   Z-ADD     *ZERO         YL0002
      * *DTAARA = *COMPANY N
     C     *DTAARA       DEFINE    YYCOTXA       ##CMP
     C                   IN        *DTAARA
      *................................................................
     C                   EVAL      W0GRP = ' '
      * Load screen
     C                   EXSR      MALDSC
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 USR0752
00002 0001-01-01-00.00.00.00000
