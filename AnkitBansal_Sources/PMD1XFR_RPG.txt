     H/TITLE BPS Order Det Bld Sch XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/19/23  Time  : 16:56:37
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Consmd Retrieval index
      *
     FPOB5CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Inv    Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAAFREL9IF  E           K        DISK
      * RTV : Calendar                  Co/Date KillDaySts=Y
      *
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FPME6CPL4IF  E           K        DISK
      * RSQ : Order Detail Build Sched  Pick/SchSh/DdtTm/Ord
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKNCPLBIF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/Ord/Seq/Ssq/PDt-a Rlc
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPOB5CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FPOB6CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPME6CPLAIF  E           K        DISK
      * RSQ : Order Detail Build Sched  Pick/F,B/FZ,FR/Sh/DDM/Od
      *
     FPME6CPL7IF  E           K        DISK
      * RSQ : Order Detail Build Sched  FrmBlk/SSD/Ord/Sq/Sq2
      *
     FPME6CPL8IF  E           K        DISK
      * RSQ : Order Detail Build Sched  Load Id/Order number
      *
     FPDKMREL0UF  E           K        DISK
      * UPD : Company Values            Update index
      *
     FPDKNCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Schedule     Update index
      *
     FPOB6CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Consmd Update index
      *
     FPOB5CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Inv    Update index
      *
     FPOCWCPL0UF  E           K        DISK
      * UPD : PS Prod Item Inventory    Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPME6CPL0UF  E           K        DISK
      * UPD : Order Detail Build Sched  Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WAAIC3
     I              KMV8CD                          WAV8CD
     I              KMAUNA                          WAAUNA
     I              KMI5ST                          WAI5ST
     I              KMBXTX                          WABXTX
     I              KMM8NB                          WAM8NB
     I              KMUVST                          WAUVST
     I              KMUWST                          WAUWST
     I              KMUXST                          WAUXST
     I              KMVSST                          WAVSST
     I              KMAATM                          WAAATM
     I              KMAYNA                          WAAYNA
     I              KMA0NA                          WAA0NA
     I              KMAXDT                          WAAXDT
      *
     I@KMREHB
      * Company Values            Update index
      * Renamed input format fields
     I              KMAIC3                          WBAIC3
     I              KMV8CD                          WBV8CD
     I              KMAUNA                          WBAUNA
     I              KMI5ST                          WBI5ST
     I              KMBXTX                          WBBXTX
     I              KMM8NB                          WBM8NB
     I              KMUVST                          WBUVST
     I              KMUWST                          WBUWST
     I              KMUXST                          WBUXST
     I              KMVSST                          WBVSST
     I              KMAATM                          WBAATM
     I              KMAYNA                          WBAYNA
     I              KMA0NA                          WBA0NA
     I              KMAXDT                          WBAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WCAIC3
     I              KNC4NB                          WCC4NB
     I              KNDPNB                          WCDPNB
     I              KNUENB                          WCUENB
     I              KNJGDT                          WCJGDT
     I              KNAODT                          WCAODT
     I              KNAJCD                          WCAJCD
     I              KNAYAA                          WCAYAA
     I              KNHGCD                          WCHGCD
     I              KNIGQT                          WCIGQT
     I              KNFLWG                          WCFLWG
     I              KNIUQT                          WCIUQT
     I              KNF3WG                          WCF3WG
     I              KNIVQT                          WCIVQT
     I              KNF4WG                          WCF4WG
     I              KNP7ST                          WCP7ST
     I              KNP8ST                          WCP8ST
     I              KNQAST                          WCQAST
     I              KNUVST                          WCUVST
     I              KNUWST                          WCUWST
     I              KNUXST                          WCUXST
     I              KNVSST                          WCVSST
     I              KNAATM                          WCAATM
     I              KNAYNA                          WCAYNA
     I              KNA0NA                          WCA0NA
     I              KNAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WFAIC3
     I              B6C4NB                          WFC4NB
     I              B6DPNB                          WFDPNB
     I              B6UENB                          WFUENB
     I              B6JGDT                          WFJGDT
     I              B6OONY                          WFOONY
     I              B6AODT                          WFAODT
     I              B6AJCD                          WFAJCD
     I              B6NUDT                          WFNUDT
     I              B6HGCD                          WFHGCD
     I              B6IGQT                          WFIGQT
     I              B6FLWG                          WFFLWG
     I              B6NSQT                          WFNSQT
     I              B6JQWG                          WFJQWG
     I              B6NVDT                          WFNVDT
     I              B6BUTM                          WFBUTM
     I              B6UVST                          WFUVST
     I              B6UWST                          WFUWST
     I              B6UXST                          WFUXST
     I              B6VSST                          WFVSST
     I              B6AATM                          WFAATM
     I              B6AYNA                          WFAYNA
     I              B6A0NA                          WFA0NA
     I              B6AXDT                          WFAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     I@B5CPM2
      * Order Detail Sched-Inv    Retrieval index
      * Renamed input format fields
     I              B5AIC3                          WHAIC3
     I              B5C4NB                          WHC4NB
     I              B5DPNB                          WHDPNB
     I              B5UENB                          WHUENB
     I              B5JGDT                          WHJGDT
     I              B5AODT                          WHAODT
     I              B5AJCD                          WHAJCD
     I              B5HGCD                          WHHGCD
     I              B5IUQT                          WHIUQT
     I              B5F3WG                          WHF3WG
     I              B5UVST                          WHUVST
     I              B5UWST                          WHUWST
     I              B5UXST                          WHUXST
     I              B5VSST                          WHVSST
     I              B5AATM                          WHAATM
     I              B5AYNA                          WHAYNA
     I              B5A0NA                          WHA0NA
     I              B5AXDT                          WHAXDT
      *
     I@B5CPM1
      * Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WIAIC3
     I              B5C4NB                          WIC4NB
     I              B5DPNB                          WIDPNB
     I              B5UENB                          WIUENB
     I              B5JGDT                          WIJGDT
     I              B5AODT                          WIAODT
     I              B5AJCD                          WIAJCD
     I              B5HGCD                          WIHGCD
     I              B5IUQT                          WIIUQT
     I              B5F3WG                          WIF3WG
     I              B5UVST                          WIUVST
     I              B5UWST                          WIUWST
     I              B5UXST                          WIUXST
     I              B5VSST                          WIVSST
     I              B5AATM                          WIAATM
     I              B5AYNA                          WIAYNA
     I              B5A0NA                          WIA0NA
     I              B5AXDT                          WIAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WJDOCD
     I              DPAUNA                          WJAUNA
     I              DPI5ST                          WJI5ST
     I              DPBXTX                          WJBXTX
     I              DPM8NB                          WJM8NB
     I              DPUVST                          WJUVST
     I              DPUWST                          WJUWST
     I              DPUXST                          WJUXST
     I              DPVSST                          WJVSST
     I              DPAATM                          WJAATM
     I              DPAYNA                          WJAYNA
     I              DPA0NA                          WJA0NA
     I              DPAXDT                          WJAXDT
      *
     I@AFREC2
      * Calendar                  Co/Date KillDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WKAIC3
     I              AFBCDT                          WKBCDT
     I              AFCQNB                          WKCQNB
     I              AFESNB                          WKESNB
     I              AFETNB                          WKETNB
     I              AFBZNB                          WKBZNB
     I              AFA9ST                          WKA9ST
     I              AFEINB                          WKEINB
     I              AFC5ST                          WKC5ST
     I              AFAQNB                          WKAQNB
     I              AFCMST                          WKCMST
     I              AFV9ST                          WKV9ST
     I              AFWAST                          WKWAST
     I              AFX2ST                          WKX2ST
     I              AFOJDT                          WKOJDT
     I              AFNQNX                          WKNQNX
     I              AFNRNX                          WKNRNX
     I              AFI9SX                          WKI9SX
     I              AFJASX                          WKJASX
     I              AFOKDT                          WKOKDT
     I              AFOLDT                          WKOLDT
     I              AFUVST                          WKUVST
     I              AFUWST                          WKUWST
     I              AFUXST                          WKUXST
     I              AFAATM                          WKAATM
     I              AFAYNA                          WKAYNA
     I              AFA0NA                          WKA0NA
     I              AFAXDT                          WKAXDT
      *
     I@CWCPQW
      * PS Prod Item Inventory    Retrieval index
      * Renamed input format fields
     I              CWAIC3                          WLAIC3
     I              CWHGCD                          WLHGCD
     I              CWAJCD                          WLAJCD
     I              CWELDT                          WLELDT
     I              CWACWG                          WLACWG
     I              CWARQT                          WLARQT
     I              CWK7DT                          WLK7DT
     I              CWUVST                          WLUVST
     I              CWUWST                          WLUWST
     I              CWUXST                          WLUXST
     I              CWVSST                          WLVSST
     I              CWAATM                          WLAATM
     I              CWAYNA                          WLAYNA
     I              CWA0NA                          WLA0NA
     I              CWAXDT                          WLAXDT
      *
     I@CWCPQV
      * PS Prod Item Inventory    Update index
      * Renamed input format fields
     I              CWAIC3                          WMAIC3
     I              CWHGCD                          WMHGCD
     I              CWAJCD                          WMAJCD
     I              CWELDT                          WMELDT
     I              CWACWG                          WMACWG
     I              CWARQT                          WMARQT
     I              CWK7DT                          WMK7DT
     I              CWUVST                          WMUVST
     I              CWUWST                          WMUWST
     I              CWUXST                          WMUXST
     I              CWVSST                          WMVSST
     I              CWAATM                          WMAATM
     I              CWAYNA                          WMAYNA
     I              CWA0NA                          WMA0NA
     I              CWAXDT                          WMAXDT
      *
     I@E6CPAI
      * Order Detail Build Sched  Pick/SchSh/DdtTm/Ord
      * Renamed input format fields
     I              E6AIC3                          WOAIC3
     I              E6C4NB                          WOC4NB
     I              E6DPNB                          WODPNB
     I              E6UENB                          WOUENB
     I              E6AODT                          WOAODT
     I              E6DBST                          WODBST
     I              E6GMST                          WOGMST
     I              E6GWST                          WOGWST
     I              E6JNCD                          WOJNCD
     I              E6HGCD                          WOHGCD
     I              E6NUDT                          WONUDT
     I              E6AJCD                          WOAJCD
     I              E6RPCD                          WORPCD
     I              E6AVQT                          WOAVQT
     I              E6D0WG                          WOD0WG
     I              E6CCQT                          WOCCQT
     I              E6AUWG                          WOAUWG
     I              E6JPCD                          WOJPCD
     I              E6NVDT                          WONVDT
     I              E6BUTM                          WOBUTM
     I              E6WPST                          WOWPST
     I              E6RMNB                          WORMNB
     I              E6U2ST                          WOU2ST
     I              E6BKC7                          WOBKC7
     I              E6XJST                          WOXJST
     I              E6XIST                          WOXIST
     I              E6PKST                          WOPKST
     I              E6BZNA                          WOBZNA
     I              E6CXDT                          WOCXDT
     I              E6BQTM                          WOBQTM
     I              E6DCST                          WODCST
     I              E6DDST                          WODDST
     I              E6OFNY                          WOOFNY
     I              E6EIDT                          WOEIDT
     I              E6RINY                          WORINY
     I              E6TIDT                          WOTIDT
     I              E6TJDT                          WOTJDT
     I              E6TNDT                          WOTNDT
     I              E6TODT                          WOTODT
     I              E6IIST                          WOIIST
     I              E6IJST                          WOIJST
     I              E6R4CD                          WOR4CD
     I              E6BGCD                          WOBGCD
     I              E6X3CD                          WOX3CD
     I              E6A5DT                          WOA5DT
     I              E6VUDT                          WOVUDT
     I              E6VVDT                          WOVVDT
     I              E6VWDT                          WOVWDT
     I              E6BWSC                          WOBWSC
     I              E6BXSC                          WOBXSC
     I              E6BYSC                          WOBYSC
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WRAIC3
     I              BZHGCD                          WRHGCD
     I              BZAVNA                          WRAVNA
     I              BZAWNA                          WRAWNA
     I              BZL7NA                          WRL7NA
     I              BZL8NA                          WRL8NA
     I              BZL6NA                          WRL6NA
     I              BZMFNA                          WRMFNA
     I              BZADCD                          WRADCD
     I              BZAWPC                          WRAWPC
     I              BZLXST                          WRLXST
     I              BZAECD                          WRAECD
     I              BZAXPC                          WRAXPC
     I              BZLYST                          WRLYST
     I              BZAFCD                          WRAFCD
     I              BZAICD                          WRAICD
     I              BZAIWG                          WRAIWG
     I              BZHICD                          WRHICD
     I              BZRBCD                          WRRBCD
     I              BZFZST                          WRFZST
     I              BZAVST                          WRAVST
     I              BZCZWG                          WRCZWG
     I              BZC0WG                          WRC0WG
     I              BZURTN                          WRURTN
     I              BZAJC8                          WRAJC8
     I              BZRINB                          WRRINB
     I              BZRHNB                          WRRHNB
     I              BZRGNB                          WRRGNB
     I              BZLNCD                          WRLNCD
     I              BZTFNB                          WRTFNB
     I              BZN0CD                          WRN0CD
     I              BZX4ST                          WRX4ST
     I              BZTMVA                          WRTMVA
     I              BZTNVA                          WRTNVA
     I              BZBLPR                          WRBLPR
     I              BZBMPR                          WRBMPR
     I              BZLRCD                          WRLRCD
     I              BZU9ST                          WRU9ST
     I              BZCMCO                          WRCMCO
     I              BZQ1CD                          WRQ1CD
     I              BZQ8CD                          WRQ8CD
     I              BZCHTM                          WRCHTM
     I              BZQZCD                          WRQZCD
     I              BZXWST                          WRXWST
     I              BZXXST                          WRXXST
     I              BZVMST                          WRVMST
     I              BZSWGH                          WRSWGH
     I              BZPPHE                          WRPPHE
     I              BZR3CD                          WRR3CD
     I              BZSDCD                          WRSDCD
     I              BZICN1                          WRICN1
     I              BZSVCD                          WRSVCD
     I              BZICN2                          WRICN2
     I              BZSWCD                          WRSWCD
     I              BZV2NB                          WRV2NB
     I              BZSXCD                          WRSXCD
     I              BZITCN                          WRITCN
     I              BZSYCD                          WRSYCD
     I              BZITC5                          WRITC5
     I              BZSZCD                          WRSZCD
     I              BZICN6                          WRICN6
     I              BZS0CD                          WRS0CD
     I              BZICN7                          WRICN7
     I              BZS1CD                          WRS1CD
     I              BZICN8                          WRICN8
     I              BZS2CD                          WRS2CD
     I              BZICN9                          WRICN9
     I              BZS3CD                          WRS3CD
     I              BZICN0                          WRICN0
     I              BZS4CD                          WRS4CD
     I              BZSFNB                          WRSFNB
     I              BZA3WG                          WRA3WG
     I              BZSJNB                          WRSJNB
     I              BZLLCD                          WRLLCD
     I              BZLMCD                          WRLMCD
     I              BZP3ST                          WRP3ST
     I              BZSKNB                          WRSKNB
     I              BZSLNB                          WRSLNB
     I              BZSMNB                          WRSMNB
     I              BZP4ST                          WRP4ST
     I              BZCFNB                          WRCFNB
     I              BZCGNB                          WRCGNB
     I              BZILNB                          WRILNB
     I              BZCHNB                          WRCHNB
     I              BZCINB                          WRCINB
     I              BZCJNB                          WRCJNB
     I              BZCMNB                          WRCMNB
     I              BZCNNB                          WRCNNB
     I              BZCRNB                          WRCRNB
     I              BZCSNB                          WRCSNB
     I              BZCVNB                          WRCVNB
     I              BZCWNB                          WRCWNB
     I              BZCXNB                          WRCXNB
     I              BZCZNB                          WRCZNB
     I              BZC0NB                          WRC0NB
     I              BZN1CD                          WRN1CD
     I              BZB4NB                          WRB4NB
     I              BZB5NB                          WRB5NB
     I              BZX5ST                          WRX5ST
     I              BZX6ST                          WRX6ST
     I              BZX7ST                          WRX7ST
     I              BZPCCT                          WRPCCT
     I              BZBDNB                          WRBDNB
     I              BZBJNB                          WRBJNB
     I              BZSUST                          WRSUST
     I              BZSVST                          WRSVST
     I              BZSYST                          WRSYST
     I              BZSZST                          WRSZST
     I              BZS1ST                          WRS1ST
     I              BZXRCD                          WRXRCD
     I              BZXTCD                          WRXTCD
     I              BZXUCD                          WRXUCD
     I              BZF5WG                          WRF5WG
     I              BZF6WG                          WRF6WG
     I              BZF7WG                          WRF7WG
     I              BZBLNB                          WRBLNB
     I              BZBNNB                          WRBNNB
     I              BZS2ST                          WRS2ST
     I              BZS4ST                          WRS4ST
     I              BZS5ST                          WRS5ST
     I              BZS6ST                          WRS6ST
     I              BZS8ST                          WRS8ST
     I              BZS9ST                          WRS9ST
     I              BZTCST                          WRTCST
     I              BZTDST                          WRTDST
     I              BZUVST                          WRUVST
     I              BZUWST                          WRUWST
     I              BZUXST                          WRUXST
     I              BZVSST                          WRVSST
     I              BZAATM                          WRAATM
     I              BZAYNA                          WRAYNA
     I              BZA0NA                          WRA0NA
     I              BZAXDT                          WRAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WSAJCD
     I              ADF8NA                          WSF8NA
     I              ADACNA                          WSACNA
     I              ADADNA                          WSADNA
     I              ADAENA                          WSAENA
     I              ADAJNA                          WSAJNA
     I              ADBTTX                          WSBTTX
     I              ADAOCD                          WSAOCD
     I              ADBGCD                          WSBGCD
     I              ADVHST                          WSVHST
     I              ADMPNA                          WSMPNA
     I              ADWPST                          WSWPST
     I              ADXUST                          WSXUST
     I              ADT0ST                          WST0ST
     I              ADT1ST                          WST1ST
     I              ADDBNB                          WSDBNB
     I              ADT2ST                          WST2ST
     I              ADT3ST                          WST3ST
     I              ADT4ST                          WST4ST
     I              ADT6ST                          WST6ST
     I              ADBWC3                          WSBWC3
     I              ADBTC3                          WSBTC3
     I              ADBUC3                          WSBUC3
     I              ADBVC3                          WSBVC3
     I              ADFCAA                          WSFCAA
     I              ADRQSX                          WSRQSX
     I              ADRRSX                          WSRRSX
     I              ADRSSX                          WSRSSX
     I              ADRTSX                          WSRTSX
     I              ADT7ST                          WST7ST
     I              ADT8ST                          WST8ST
     I              ADRNSX                          WSRNSX
     I              ADROSX                          WSROSX
     I              ADRPSX                          WSRPSX
     I              ADUVST                          WSUVST
     I              ADUWST                          WSUWST
     I              ADUXST                          WSUXST
     I              ADVSST                          WSVSST
     I              ADAATM                          WSAATM
     I              ADAYNA                          WSAYNA
     I              ADA0NA                          WSA0NA
     I              ADAXDT                          WSAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WTAIC3
     I              OMC4NB                          WTC4NB
     I              OMDPNB                          WTDPNB
     I              OMUENB                          WTUENB
     I              OMHGCD                          WTHGCD
     I              OMAJCD                          WTAJCD
     I              OMBKC7                          WTBKC7
     I              OMCFC7                          WTCFC7
     I              OMGMST                          WTGMST
     I              OMGNST                          WTGNST
     I              OMMAVA                          WTMAVA
     I              OMKDVA                          WTKDVA
     I              OML8VA                          WTL8VA
     I              OML9VA                          WTL9VA
     I              OMGTST                          WTGTST
     I              OMGVST                          WTGVST
     I              OMGUST                          WTGUST
     I              OMQFST                          WTQFST
     I              OMAYVA                          WTAYVA
     I              OMEXDT                          WTEXDT
     I              OMLQCD                          WTLQCD
     I              OMRDCD                          WTRDCD
     I              OMQ7CD                          WTQ7CD
     I              OMBZPR                          WTBZPR
     I              OML6NB                          WTL6NB
     I              OMU1ST                          WTU1ST
     I              OMGIDT                          WTGIDT
     I              OMCRCD                          WTCRCD
     I              OMAGCD                          WTAGCD
     I              OMRZST                          WTRZST
     I              OMR0ST                          WTR0ST
     I              OMR1ST                          WTR1ST
     I              OMG7NA                          WTG7NA
     I              OMG8NA                          WTG8NA
     I              OMRPCD                          WTRPCD
     I              OMVEST                          WTVEST
     I              OMVGST                          WTVGST
     I              OMAVST                          WTAVST
     I              OMU0ST                          WTU0ST
     I              OMRFCD                          WTRFCD
     I              OMFZST                          WTFZST
     I              OMR1NB                          WTR1NB
     I              OMAVQT                          WTAVQT
     I              OMD0WG                          WTD0WG
     I              OMCCQT                          WTCCQT
     I              OMAUWG                          WTAUWG
     I              OMCBQT                          WTCBQT
     I              OMATWG                          WTATWG
     I              OMAQCS                          WTAQCS
     I              OMAGCS                          WTAGCS
     I              OMAKPR                          WTAKPR
     I              OMALPR                          WTALPR
     I              OMAUPR                          WTAUPR
     I              OMAVWG                          WTAVWG
     I              OMA4WG                          WTA4WG
     I              OMA5DT                          WTA5DT
     I              OMAODT                          WTAODT
     I              OMGNDT                          WTGNDT
     I              OMAMST                          WTAMST
     I              OMANST                          WTANST
     I              OMVAST                          WTVAST
     I              OMRGNB                          WTRGNB
     I              OMRHNB                          WTRHNB
     I              OMRINB                          WTRINB
     I              OMRBCD                          WTRBCD
     I              OMHICD                          WTHICD
     I              OMRNCD                          WTRNCD
     I              OMROCD                          WTROCD
     I              OMCXDT                          WTCXDT
     I              OMAJVN                          WTAJVN
     I              OMKXCD                          WTKXCD
     I              OMJPCD                          WTJPCD
     I              OMCQCD                          WTCQCD
     I              OMR4CD                          WTR4CD
     I              OMZ1ST                          WTZ1ST
     I              OMZ3ST                          WTZ3ST
     I              OMZ4ST                          WTZ4ST
     I              OMDUPR                          WTDUPR
     I              OMB6VL                          WTB6VL
     I              OMA1AA                          WTA1AA
     I              OMFZSX                          WTFZSX
     I              OMF0SX                          WTF0SX
     I              OMF1SX                          WTF1SX
     I              OMF2SX                          WTF2SX
     I              OMF3SX                          WTF3SX
     I              OMF4SX                          WTF4SX
     I              OMF5SX                          WTF5SX
     I              OMF6SX                          WTF6SX
     I              OMF7SX                          WTF7SX
     I              OMNTDT                          WTNTDT
     I              OMNUDT                          WTNUDT
     I              OMNVDT                          WTNVDT
     I              OMNWDT                          WTNWDT
     I              OMNXDT                          WTNXDT
     I              OMBUTM                          WTBUTM
     I              OMBVTM                          WTBVTM
     I              OMBWTM                          WTBWTM
     I              OMBXTM                          WTBXTM
     I              OMBYTM                          WTBYTM
     I              OMH5NX                          WTH5NX
     I              OMH6NX                          WTH6NX
     I              OMH7NX                          WTH7NX
     I              OMH8NX                          WTH8NX
     I              OMH9NX                          WTH9NX
     I              OMDVPR                          WTDVPR
     I              OMDWPR                          WTDWPR
     I              OMDXPR                          WTDXPR
     I              OMDYPR                          WTDYPR
     I              OMDZPR                          WTDZPR
     I              OMGSPR                          WTGSPR
     I              OMGTPR                          WTGTPR
     I              OMGUPR                          WTGUPR
     I              OMHOST                          WTHOST
     I              OMHPST                          WTHPST
     I              OMIOST                          WTIOST
     I              OMPEWG                          WTPEWG
     I              OMRINY                          WTRINY
     I              OMTIDT                          WTTIDT
     I              OMTJDT                          WTTJDT
     I              OMH2ST                          WTH2ST
     I              OMH0ST                          WTH0ST
     I              OMH1ST                          WTH1ST
     I              OMTKDT                          WTTKDT
     I              OMTLDT                          WTTLDT
     I              OMTMDT                          WTTMDT
     I              OMUVST                          WTUVST
     I              OMUWST                          WTUWST
     I              OMUXST                          WTUXST
     I              OMAATM                          WTAATM
     I              OMAYNA                          WTAYNA
     I              OMA0NA                          WTA0NA
     I              OMAXDT                          WTAXDT
      *
     I@KNCPOC
      * Order Detail Schedule     Co/Ord/Seq/Ssq/PDt-a Rlc
      * Renamed input format fields
     I              KNAIC3                          WVAIC3
     I              KNC4NB                          WVC4NB
     I              KNDPNB                          WVDPNB
     I              KNUENB                          WVUENB
     I              KNJGDT                          WVJGDT
     I              KNAODT                          WVAODT
     I              KNAJCD                          WVAJCD
     I              KNAYAA                          WVAYAA
     I              KNHGCD                          WVHGCD
     I              KNIGQT                          WVIGQT
     I              KNFLWG                          WVFLWG
     I              KNIUQT                          WVIUQT
     I              KNF3WG                          WVF3WG
     I              KNIVQT                          WVIVQT
     I              KNF4WG                          WVF4WG
     I              KNP7ST                          WVP7ST
     I              KNP8ST                          WVP8ST
     I              KNQAST                          WVQAST
     I              KNUVST                          WVUVST
     I              KNUWST                          WVUWST
     I              KNUXST                          WVUXST
     I              KNVSST                          WVVSST
     I              KNAATM                          WVAATM
     I              KNAYNA                          WVAYNA
     I              KNA0NA                          WVA0NA
     I              KNAXDT                          WVAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WWAIC3
     I              AFBCDT                          WWBCDT
     I              AFCQNB                          WWCQNB
     I              AFESNB                          WWESNB
     I              AFETNB                          WWETNB
     I              AFBZNB                          WWBZNB
     I              AFA9ST                          WWA9ST
     I              AFEINB                          WWEINB
     I              AFC5ST                          WWC5ST
     I              AFAQNB                          WWAQNB
     I              AFCMST                          WWCMST
     I              AFV9ST                          WWV9ST
     I              AFWAST                          WWWAST
     I              AFX2ST                          WWX2ST
     I              AFOJDT                          WWOJDT
     I              AFNQNX                          WWNQNX
     I              AFNRNX                          WWNRNX
     I              AFI9SX                          WWI9SX
     I              AFJASX                          WWJASX
     I              AFOKDT                          WWOKDT
     I              AFOLDT                          WWOLDT
     I              AFUVST                          WWUVST
     I              AFUWST                          WWUWST
     I              AFUXST                          WWUXST
     I              AFAATM                          WWAATM
     I              AFAYNA                          WWAYNA
     I              AFA0NA                          WWA0NA
     I              AFAXDT                          WWAXDT
      *
     I@B5CPM4
      * Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      * Renamed input format fields
     I              B5AIC3                          WXAIC3
     I              B5C4NB                          WXC4NB
     I              B5DPNB                          WXDPNB
     I              B5UENB                          WXUENB
     I              B5JGDT                          WXJGDT
     I              B5AODT                          WXAODT
     I              B5AJCD                          WXAJCD
     I              B5HGCD                          WXHGCD
     I              B5IUQT                          WXIUQT
     I              B5F3WG                          WXF3WG
     I              B5UVST                          WXUVST
     I              B5UWST                          WXUWST
     I              B5UXST                          WXUXST
     I              B5VSST                          WXVSST
     I              B5AATM                          WXAATM
     I              B5AYNA                          WXAYNA
     I              B5A0NA                          WXA0NA
     I              B5AXDT                          WXAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WYAIC3
     I              I8V5ST                          WYV5ST
     I              I8ELDT                          WYELDT
     I              I8HGCD                          WYHGCD
     I              I8AJCD                          WYAJCD
     I              I8GPDT                          WYGPDT
     I              I8WTSP                          WYWTSP
     I              I8QTSP                          WYQTSP
     I              I8DJPC                          WYDJPC
     I              I8F8WG                          WYF8WG
     I              I8WTIN                          WYWTIN
     I              I8D5NB                          WYD5NB
     I              I8DXWG                          WYDXWG
     I              I8B2NB                          WYB2NB
     I              I8WTCN                          WYWTCN
     I              I8PSCV                          WYPSCV
     I              I8SAWT                          WYSAWT
     I              I8B9NB                          WYB9NB
     I              I8D1WG                          WYD1WG
     I              I8CBNB                          WYCBNB
     I              I8EZWG                          WYEZWG
     I              I8CCNB                          WYCCNB
     I              I8E0WG                          WYE0WG
     I              I8D6NB                          WYD6NB
     I              I8OAWT                          WYOAWT
     I              I8CDNB                          WYCDNB
     I              I8UNW2                          WYUNW2
     I              I8CENB                          WYCENB
     I              I8F9WG                          WYF9WG
     I              I8BPNB                          WYBPNB
     I              I8GAWG                          WYGAWG
     I              I8BQNB                          WYBQNB
     I              I8GBWG                          WYGBWG
     I              I8BRNB                          WYBRNB
     I              I8GCWG                          WYGCWG
     I              I8BSNB                          WYBSNB
     I              I8GDWG                          WYGDWG
     I              I8BWNB                          WYBWNB
     I              I8GEWG                          WYGEWG
     I              I8PS6U                          WYPS6U
     I              I8WCST                          WYWCST
     I              I8WPST                          WYWPST
     I              I8B5ST                          WYB5ST
     I              I8TFST                          WYTFST
     I              I8TEST                          WYTEST
     I              I8THST                          WYTHST
     I              I8UDST                          WYUDST
     I              I8UFST                          WYUFST
     I              I8UGST                          WYUGST
     I              I8UHST                          WYUHST
     I              I8B6ST                          WYB6ST
     I              I8B7ST                          WYB7ST
     I              I8DVWG                          WYDVWG
     I              I8D7NB                          WYD7NB
     I              I8FCAD                          WYFCAD
     I              I8D9NB                          WYD9NB
     I              I8DWWG                          WYDWWG
     I              I8EANB                          WYEANB
     I              I8SHWT                          WYSHWT
     I              I8EBNB                          WYEBNB
     I              I8AVWT                          WYAVWT
     I              I8ECNB                          WYECNB
     I              I8WTON                          WYWTON
     I              I8EDNB                          WYEDNB
     I              I8FNWT                          WYFNWT
     I              I8EENB                          WYEENB
     I              I8QTAS                          WYQTAS
     I              I8EFNB                          WYEFNB
     I              I8WAIO                          WYWAIO
     I              I8EGNB                          WYEGNB
     I              I8R3CD                          WYR3CD
     I              I8RGNB                          WYRGNB
     I              I8RHNB                          WYRHNB
     I              I8RINB                          WYRINB
     I              I8XRCD                          WYXRCD
     I              I8UVST                          WYUVST
     I              I8UWST                          WYUWST
     I              I8UXST                          WYUXST
     I              I8VSST                          WYVSST
     I              I8AATM                          WYAATM
     I              I8AYNA                          WYAYNA
     I              I8A0NA                          WYA0NA
     I              I8AXDT                          WYAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          TAAIC3
     I              I8V5ST                          TAV5ST
     I              I8ELDT                          TAELDT
     I              I8HGCD                          TAHGCD
     I              I8AJCD                          TAAJCD
     I              I8GPDT                          TAGPDT
     I              I8WTSP                          TAWTSP
     I              I8QTSP                          TAQTSP
     I              I8DJPC                          TADJPC
     I              I8F8WG                          TAF8WG
     I              I8WTIN                          TAWTIN
     I              I8D5NB                          TAD5NB
     I              I8DXWG                          TADXWG
     I              I8B2NB                          TAB2NB
     I              I8WTCN                          TAWTCN
     I              I8PSCV                          TAPSCV
     I              I8SAWT                          TASAWT
     I              I8B9NB                          TAB9NB
     I              I8D1WG                          TAD1WG
     I              I8CBNB                          TACBNB
     I              I8EZWG                          TAEZWG
     I              I8CCNB                          TACCNB
     I              I8E0WG                          TAE0WG
     I              I8D6NB                          TAD6NB
     I              I8OAWT                          TAOAWT
     I              I8CDNB                          TACDNB
     I              I8UNW2                          TAUNW2
     I              I8CENB                          TACENB
     I              I8F9WG                          TAF9WG
     I              I8BPNB                          TABPNB
     I              I8GAWG                          TAGAWG
     I              I8BQNB                          TABQNB
     I              I8GBWG                          TAGBWG
     I              I8BRNB                          TABRNB
     I              I8GCWG                          TAGCWG
     I              I8BSNB                          TABSNB
     I              I8GDWG                          TAGDWG
     I              I8BWNB                          TABWNB
     I              I8GEWG                          TAGEWG
     I              I8PS6U                          TAPS6U
     I              I8WCST                          TAWCST
     I              I8WPST                          TAWPST
     I              I8B5ST                          TAB5ST
     I              I8TFST                          TATFST
     I              I8TEST                          TATEST
     I              I8THST                          TATHST
     I              I8UDST                          TAUDST
     I              I8UFST                          TAUFST
     I              I8UGST                          TAUGST
     I              I8UHST                          TAUHST
     I              I8B6ST                          TAB6ST
     I              I8B7ST                          TAB7ST
     I              I8DVWG                          TADVWG
     I              I8D7NB                          TAD7NB
     I              I8FCAD                          TAFCAD
     I              I8D9NB                          TAD9NB
     I              I8DWWG                          TADWWG
     I              I8EANB                          TAEANB
     I              I8SHWT                          TASHWT
     I              I8EBNB                          TAEBNB
     I              I8AVWT                          TAAVWT
     I              I8ECNB                          TAECNB
     I              I8WTON                          TAWTON
     I              I8EDNB                          TAEDNB
     I              I8FNWT                          TAFNWT
     I              I8EENB                          TAEENB
     I              I8QTAS                          TAQTAS
     I              I8EFNB                          TAEFNB
     I              I8WAIO                          TAWAIO
     I              I8EGNB                          TAEGNB
     I              I8R3CD                          TAR3CD
     I              I8RGNB                          TARGNB
     I              I8RHNB                          TARHNB
     I              I8RINB                          TARINB
     I              I8XRCD                          TAXRCD
     I              I8UVST                          TAUVST
     I              I8UWST                          TAUWST
     I              I8UXST                          TAUXST
     I              I8VSST                          TAVSST
     I              I8AATM                          TAAATM
     I              I8AYNA                          TAAYNA
     I              I8A0NA                          TAA0NA
     I              I8AXDT                          TAAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          TBAJCD
     I              ADF8NA                          TBF8NA
     I              ADACNA                          TBACNA
     I              ADADNA                          TBADNA
     I              ADAENA                          TBAENA
     I              ADAJNA                          TBAJNA
     I              ADBTTX                          TBBTTX
     I              ADAOCD                          TBAOCD
     I              ADBGCD                          TBBGCD
     I              ADVHST                          TBVHST
     I              ADMPNA                          TBMPNA
     I              ADWPST                          TBWPST
     I              ADXUST                          TBXUST
     I              ADT0ST                          TBT0ST
     I              ADT1ST                          TBT1ST
     I              ADDBNB                          TBDBNB
     I              ADT2ST                          TBT2ST
     I              ADT3ST                          TBT3ST
     I              ADT4ST                          TBT4ST
     I              ADT6ST                          TBT6ST
     I              ADBWC3                          TBBWC3
     I              ADBTC3                          TBBTC3
     I              ADBUC3                          TBBUC3
     I              ADBVC3                          TBBVC3
     I              ADFCAA                          TBFCAA
     I              ADRQSX                          TBRQSX
     I              ADRRSX                          TBRRSX
     I              ADRSSX                          TBRSSX
     I              ADRTSX                          TBRTSX
     I              ADT7ST                          TBT7ST
     I              ADT8ST                          TBT8ST
     I              ADRNSX                          TBRNSX
     I              ADROSX                          TBROSX
     I              ADRPSX                          TBRPSX
     I              ADUVST                          TBUVST
     I              ADUWST                          TBUWST
     I              ADUXST                          TBUXST
     I              ADVSST                          TBVSST
     I              ADAATM                          TBAATM
     I              ADAYNA                          TBAYNA
     I              ADA0NA                          TBA0NA
     I              ADAXDT                          TBAXDT
      *
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          TCAIC3
     I              FDHGCD                          TCHGCD
     I              FDD0ST                          TCD0ST
     I              FDD2ST                          TCD2ST
     I              FDD6ST                          TCD6ST
     I              FDWESP                          TCWESP
     I              FDEDST                          TCEDST
     I              FDEFST                          TCEFST
     I              FDEHST                          TCEHST
     I              FDEMST                          TCEMST
     I              FDENST                          TCENST
     I              FDEOST                          TCEOST
     I              FDEPST                          TCEPST
     I              FDEQST                          TCEQST
     I              FDOQNY                          TCOQNY
     I              FDORNY                          TCORNY
     I              FDS2DT                          TCS2DT
     I              FDUFT1                          TCUFT1
     I              FDKUAA                          TCKUAA
     I              FDVSST                          TCVSST
     I              FDMJDT                          TCMJDT
     I              FDBETM                          TCBETM
     I              FDCCVN                          TCCCVN
     I              FDCDVN                          TCCDVN
     I              FDMKDT                          TCMKDT
     I              FDBFTM                          TCBFTM
     I              FDCEVN                          TCCEVN
     I              FDCFVN                          TCCFVN
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          TDAIC3
     I              BEC4NB                          TDC4NB
     I              BEJNCD                          TDJNCD
     I              BEANC7                          TDANC7
     I              BEBKC7                          TDBKC7
     I              BEBRTX                          TDBRTX
     I              BEHMNA                          TDHMNA
     I              BEHONA                          TDHONA
     I              BEHPNA                          TDHPNA
     I              BEHNNA                          TDHNNA
     I              BEDBCD                          TDDBCD
     I              BECKTX                          TDCKTX
     I              BEB0C7                          TDB0C7
     I              BEAETX                          TDAETX
     I              BEB1NA                          TDB1NA
     I              BEB3NA                          TDB3NA
     I              BEB4NA                          TDB4NA
     I              BEB2NA                          TDB2NA
     I              BEBHCD                          TDBHCD
     I              BEC8TX                          TDC8TX
     I              BEBCNA                          TDBCNA
     I              BEA0DT                          TDA0DT
     I              BEA5DT                          TDA5DT
     I              BEGNDT                          TDGNDT
     I              BEACDT                          TDACDT
     I              BEAQCD                          TDAQCD
     I              BEB6NA                          TDB6NA
     I              BEBYNA                          TDBYNA
     I              BEBZNA                          TDBZNA
     I              BEGTST                          TDGTST
     I              BEGVST                          TDGVST
     I              BEGUST                          TDGUST
     I              BEQFST                          TDQFST
     I              BECQCD                          TDCQCD
     I              BEGJST                          TDGJST
     I              BEGWST                          TDGWST
     I              BEGXST                          TDGXST
     I              BEGYST                          TDGYST
     I              BEAODT                          TDAODT
     I              BEAIVN                          TDAIVN
     I              BECXDT                          TDCXDT
     I              BEJZVA                          TDJZVA
     I              BEA1WG                          TDA1WG
     I              BEXIST                          TDXIST
     I              BEXJST                          TDXJST
     I              BEXKST                          TDXKST
     I              BEEIDT                          TDEIDT
     I              BEAFTM                          TDAFTM
     I              BEE8CD                          TDE8CD
     I              BEE9CD                          TDE9CD
     I              BERMNB                          TDRMNB
     I              BETBNB                          TDTBNB
     I              BER1NB                          TDR1NB
     I              BEPJST                          TDPJST
     I              BEU0ST                          TDU0ST
     I              BEU1ST                          TDU1ST
     I              BEQ2CD                          TDQ2CD
     I              BEU2ST                          TDU2ST
     I              BEVEST                          TDVEST
     I              BEVFST                          TDVFST
     I              BEVGST                          TDVGST
     I              BERPCD                          TDRPCD
     I              BERNNB                          TDRNNB
     I              BEVDST                          TDVDST
     I              BEATIN                          TDATIN
     I              BEU4ST                          TDU4ST
     I              BEU5ST                          TDU5ST
     I              BERSRN                          TDRSRN
     I              BEMHNA                          TDMHNA
     I              BEMINA                          TDMINA
     I              BEWBST                          TDWBST
     I              BER4CD                          TDR4CD
     I              BEBFCD                          TDBFCD
     I              BEQ4CD                          TDQ4CD
     I              BET3NB                          TDT3NB
     I              BESICD                          TDSICD
     I              BECONB                          TDCONB
     I              BECEST                          TDCEST
     I              BEAWDT                          TDAWDT
     I              BEJPCD                          TDJPCD
     I              BEXUST                          TDXUST
     I              BEZ1ST                          TDZ1ST
     I              BEVRVA                          TDVRVA
     I              BEOBST                          TDOBST
     I              BEBCST                          TDBCST
     I              BEBDST                          TDBDST
     I              BEB7VL                          TDB7VL
     I              BEGASX                          TDGASX
     I              BEGBSX                          TDGBSX
     I              BEGCSX                          TDGCSX
     I              BEGDSX                          TDGDSX
     I              BEFNSX                          TDFNSX
     I              BEFOSX                          TDFOSX
     I              BEFPSX                          TDFPSX
     I              BEFQSX                          TDFQSX
     I              BEFRSX                          TDFRSX
     I              BEFSSX                          TDFSSX
     I              BEFTSX                          TDFTSX
     I              BEFUSX                          TDFUSX
     I              BEFVSX                          TDFVSX
     I              BEFWSX                          TDFWSX
     I              BEFXSX                          TDFXSX
     I              BEFYSX                          TDFYSX
     I              BENODT                          TDNODT
     I              BENPDT                          TDNPDT
     I              BENQDT                          TDNQDT
     I              BENRDT                          TDNRDT
     I              BENSDT                          TDNSDT
     I              BEBPTM                          TDBPTM
     I              BEBQTM                          TDBQTM
     I              BEBRTM                          TDBRTM
     I              BEBSTM                          TDBSTM
     I              BEBTTM                          TDBTTM
     I              BEH0NX                          TDH0NX
     I              BEH1NX                          TDH1NX
     I              BEH2NX                          TDH2NX
     I              BEH3NX                          TDH3NX
     I              BEH4NX                          TDH4NX
     I              BEC0C7                          TDC0C7
     I              BEUVST                          TDUVST
     I              BEUWST                          TDUWST
     I              BEUXST                          TDUXST
     I              BEAATM                          TDAATM
     I              BEAYNA                          TDAYNA
     I              BEA0NA                          TDA0NA
     I              BEAXDT                          TDAXDT
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          TEAIC3
     I              AFBCDT                          TEBCDT
     I              AFCQNB                          TECQNB
     I              AFESNB                          TEESNB
     I              AFETNB                          TEETNB
     I              AFBZNB                          TEBZNB
     I              AFA9ST                          TEA9ST
     I              AFEINB                          TEEINB
     I              AFC5ST                          TEC5ST
     I              AFAQNB                          TEAQNB
     I              AFCMST                          TECMST
     I              AFV9ST                          TEV9ST
     I              AFWAST                          TEWAST
     I              AFX2ST                          TEX2ST
     I              AFOJDT                          TEOJDT
     I              AFNQNX                          TENQNX
     I              AFNRNX                          TENRNX
     I              AFI9SX                          TEI9SX
     I              AFJASX                          TEJASX
     I              AFOKDT                          TEOKDT
     I              AFOLDT                          TEOLDT
     I              AFUVST                          TEUVST
     I              AFUWST                          TEUWST
     I              AFUXST                          TEUXST
     I              AFAATM                          TEAATM
     I              AFAYNA                          TEAYNA
     I              AFA0NA                          TEA0NA
     I              AFAXDT                          TEAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          TFAIC3
     I              AFBCDT                          TFBCDT
     I              AFCQNB                          TFCQNB
     I              AFESNB                          TFESNB
     I              AFETNB                          TFETNB
     I              AFBZNB                          TFBZNB
     I              AFA9ST                          TFA9ST
     I              AFEINB                          TFEINB
     I              AFC5ST                          TFC5ST
     I              AFAQNB                          TFAQNB
     I              AFCMST                          TFCMST
     I              AFV9ST                          TFV9ST
     I              AFWAST                          TFWAST
     I              AFX2ST                          TFX2ST
     I              AFOJDT                          TFOJDT
     I              AFNQNX                          TFNQNX
     I              AFNRNX                          TFNRNX
     I              AFI9SX                          TFI9SX
     I              AFJASX                          TFJASX
     I              AFOKDT                          TFOKDT
     I              AFOLDT                          TFOLDT
     I              AFUVST                          TFUVST
     I              AFUWST                          TFUWST
     I              AFUXST                          TFUXST
     I              AFAATM                          TFAATM
     I              AFAYNA                          TFAYNA
     I              AFA0NA                          TFA0NA
     I              AFAXDT                          TFAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          TGAIC3
     I              JCV5ST                          TGV5ST
     I              JCELDT                          TGELDT
     I              JCHVHD                          TGHVHD
     I              JCZ6NB                          TGZ6NB
     I              JCZ7NB                          TGZ7NB
     I              JCDGPC                          TGDGPC
     I              JCAVCW                          TGAVCW
     I              JCDIPC                          TGDIPC
     I              JCZ0NB                          TGZ0NB
     I              JCAVLE                          TGAVLE
     I              JCECWG                          TGECWG
     I              JCUVST                          TGUVST
     I              JCUWST                          TGUWST
     I              JCUXST                          TGUXST
     I              JCVSST                          TGVSST
     I              JCAATM                          TGAATM
     I              JCAYNA                          TGAYNA
     I              JCA0NA                          TGA0NA
     I              JCAXDT                          TGAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          THAIC3
     I              I8V5ST                          THV5ST
     I              I8ELDT                          THELDT
     I              I8HGCD                          THHGCD
     I              I8AJCD                          THAJCD
     I              I8GPDT                          THGPDT
     I              I8WTSP                          THWTSP
     I              I8QTSP                          THQTSP
     I              I8DJPC                          THDJPC
     I              I8F8WG                          THF8WG
     I              I8WTIN                          THWTIN
     I              I8D5NB                          THD5NB
     I              I8DXWG                          THDXWG
     I              I8B2NB                          THB2NB
     I              I8WTCN                          THWTCN
     I              I8PSCV                          THPSCV
     I              I8SAWT                          THSAWT
     I              I8B9NB                          THB9NB
     I              I8D1WG                          THD1WG
     I              I8CBNB                          THCBNB
     I              I8EZWG                          THEZWG
     I              I8CCNB                          THCCNB
     I              I8E0WG                          THE0WG
     I              I8D6NB                          THD6NB
     I              I8OAWT                          THOAWT
     I              I8CDNB                          THCDNB
     I              I8UNW2                          THUNW2
     I              I8CENB                          THCENB
     I              I8F9WG                          THF9WG
     I              I8BPNB                          THBPNB
     I              I8GAWG                          THGAWG
     I              I8BQNB                          THBQNB
     I              I8GBWG                          THGBWG
     I              I8BRNB                          THBRNB
     I              I8GCWG                          THGCWG
     I              I8BSNB                          THBSNB
     I              I8GDWG                          THGDWG
     I              I8BWNB                          THBWNB
     I              I8GEWG                          THGEWG
     I              I8PS6U                          THPS6U
     I              I8WCST                          THWCST
     I              I8WPST                          THWPST
     I              I8B5ST                          THB5ST
     I              I8TFST                          THTFST
     I              I8TEST                          THTEST
     I              I8THST                          THTHST
     I              I8UDST                          THUDST
     I              I8UFST                          THUFST
     I              I8UGST                          THUGST
     I              I8UHST                          THUHST
     I              I8B6ST                          THB6ST
     I              I8B7ST                          THB7ST
     I              I8DVWG                          THDVWG
     I              I8D7NB                          THD7NB
     I              I8FCAD                          THFCAD
     I              I8D9NB                          THD9NB
     I              I8DWWG                          THDWWG
     I              I8EANB                          THEANB
     I              I8SHWT                          THSHWT
     I              I8EBNB                          THEBNB
     I              I8AVWT                          THAVWT
     I              I8ECNB                          THECNB
     I              I8WTON                          THWTON
     I              I8EDNB                          THEDNB
     I              I8FNWT                          THFNWT
     I              I8EENB                          THEENB
     I              I8QTAS                          THQTAS
     I              I8EFNB                          THEFNB
     I              I8WAIO                          THWAIO
     I              I8EGNB                          THEGNB
     I              I8R3CD                          THR3CD
     I              I8RGNB                          THRGNB
     I              I8RHNB                          THRHNB
     I              I8RINB                          THRINB
     I              I8XRCD                          THXRCD
     I              I8UVST                          THUVST
     I              I8UWST                          THUWST
     I              I8UXST                          THUXST
     I              I8VSST                          THVSST
     I              I8AATM                          THAATM
     I              I8AYNA                          THAYNA
     I              I8A0NA                          THA0NA
     I              I8AXDT                          THAXDT
      *
     I@B6CPAG
      * Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      * Renamed input format fields
     I              B6AIC3                          TIAIC3
     I              B6C4NB                          TIC4NB
     I              B6DPNB                          TIDPNB
     I              B6UENB                          TIUENB
     I              B6JGDT                          TIJGDT
     I              B6OONY                          TIOONY
     I              B6AODT                          TIAODT
     I              B6AJCD                          TIAJCD
     I              B6NUDT                          TINUDT
     I              B6HGCD                          TIHGCD
     I              B6IGQT                          TIIGQT
     I              B6FLWG                          TIFLWG
     I              B6NSQT                          TINSQT
     I              B6JQWG                          TIJQWG
     I              B6NVDT                          TINVDT
     I              B6BUTM                          TIBUTM
     I              B6UVST                          TIUVST
     I              B6UWST                          TIUWST
     I              B6UXST                          TIUXST
     I              B6VSST                          TIVSST
     I              B6AATM                          TIAATM
     I              B6AYNA                          TIAYNA
     I              B6A0NA                          TIA0NA
     I              B6AXDT                          TIAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          TJAIC3
     I              AFBCDT                          TJBCDT
     I              AFCQNB                          TJCQNB
     I              AFESNB                          TJESNB
     I              AFETNB                          TJETNB
     I              AFBZNB                          TJBZNB
     I              AFA9ST                          TJA9ST
     I              AFEINB                          TJEINB
     I              AFC5ST                          TJC5ST
     I              AFAQNB                          TJAQNB
     I              AFCMST                          TJCMST
     I              AFV9ST                          TJV9ST
     I              AFWAST                          TJWAST
     I              AFX2ST                          TJX2ST
     I              AFOJDT                          TJOJDT
     I              AFNQNX                          TJNQNX
     I              AFNRNX                          TJNRNX
     I              AFI9SX                          TJI9SX
     I              AFJASX                          TJJASX
     I              AFOKDT                          TJOKDT
     I              AFOLDT                          TJOLDT
     I              AFUVST                          TJUVST
     I              AFUWST                          TJUWST
     I              AFUXST                          TJUXST
     I              AFAATM                          TJAATM
     I              AFAYNA                          TJAYNA
     I              AFA0NA                          TJA0NA
     I              AFAXDT                          TJAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TKAIC3
     I              OMC4NB                          TKC4NB
     I              OMDPNB                          TKDPNB
     I              OMUENB                          TKUENB
     I              OMHGCD                          TKHGCD
     I              OMAJCD                          TKAJCD
     I              OMBKC7                          TKBKC7
     I              OMCFC7                          TKCFC7
     I              OMGMST                          TKGMST
     I              OMGNST                          TKGNST
     I              OMMAVA                          TKMAVA
     I              OMKDVA                          TKKDVA
     I              OML8VA                          TKL8VA
     I              OML9VA                          TKL9VA
     I              OMGTST                          TKGTST
     I              OMGVST                          TKGVST
     I              OMGUST                          TKGUST
     I              OMQFST                          TKQFST
     I              OMAYVA                          TKAYVA
     I              OMEXDT                          TKEXDT
     I              OMLQCD                          TKLQCD
     I              OMRDCD                          TKRDCD
     I              OMQ7CD                          TKQ7CD
     I              OMBZPR                          TKBZPR
     I              OML6NB                          TKL6NB
     I              OMU1ST                          TKU1ST
     I              OMGIDT                          TKGIDT
     I              OMCRCD                          TKCRCD
     I              OMAGCD                          TKAGCD
     I              OMRZST                          TKRZST
     I              OMR0ST                          TKR0ST
     I              OMR1ST                          TKR1ST
     I              OMG7NA                          TKG7NA
     I              OMG8NA                          TKG8NA
     I              OMRPCD                          TKRPCD
     I              OMVEST                          TKVEST
     I              OMVGST                          TKVGST
     I              OMAVST                          TKAVST
     I              OMU0ST                          TKU0ST
     I              OMRFCD                          TKRFCD
     I              OMFZST                          TKFZST
     I              OMR1NB                          TKR1NB
     I              OMAVQT                          TKAVQT
     I              OMD0WG                          TKD0WG
     I              OMCCQT                          TKCCQT
     I              OMAUWG                          TKAUWG
     I              OMCBQT                          TKCBQT
     I              OMATWG                          TKATWG
     I              OMAQCS                          TKAQCS
     I              OMAGCS                          TKAGCS
     I              OMAKPR                          TKAKPR
     I              OMALPR                          TKALPR
     I              OMAUPR                          TKAUPR
     I              OMAVWG                          TKAVWG
     I              OMA4WG                          TKA4WG
     I              OMA5DT                          TKA5DT
     I              OMAODT                          TKAODT
     I              OMGNDT                          TKGNDT
     I              OMAMST                          TKAMST
     I              OMANST                          TKANST
     I              OMVAST                          TKVAST
     I              OMRGNB                          TKRGNB
     I              OMRHNB                          TKRHNB
     I              OMRINB                          TKRINB
     I              OMRBCD                          TKRBCD
     I              OMHICD                          TKHICD
     I              OMRNCD                          TKRNCD
     I              OMROCD                          TKROCD
     I              OMCXDT                          TKCXDT
     I              OMAJVN                          TKAJVN
     I              OMKXCD                          TKKXCD
     I              OMJPCD                          TKJPCD
     I              OMCQCD                          TKCQCD
     I              OMR4CD                          TKR4CD
     I              OMZ1ST                          TKZ1ST
     I              OMZ3ST                          TKZ3ST
     I              OMZ4ST                          TKZ4ST
     I              OMDUPR                          TKDUPR
     I              OMB6VL                          TKB6VL
     I              OMA1AA                          TKA1AA
     I              OMFZSX                          TKFZSX
     I              OMF0SX                          TKF0SX
     I              OMF1SX                          TKF1SX
     I              OMF2SX                          TKF2SX
     I              OMF3SX                          TKF3SX
     I              OMF4SX                          TKF4SX
     I              OMF5SX                          TKF5SX
     I              OMF6SX                          TKF6SX
     I              OMF7SX                          TKF7SX
     I              OMNTDT                          TKNTDT
     I              OMNUDT                          TKNUDT
     I              OMNVDT                          TKNVDT
     I              OMNWDT                          TKNWDT
     I              OMNXDT                          TKNXDT
     I              OMBUTM                          TKBUTM
     I              OMBVTM                          TKBVTM
     I              OMBWTM                          TKBWTM
     I              OMBXTM                          TKBXTM
     I              OMBYTM                          TKBYTM
     I              OMH5NX                          TKH5NX
     I              OMH6NX                          TKH6NX
     I              OMH7NX                          TKH7NX
     I              OMH8NX                          TKH8NX
     I              OMH9NX                          TKH9NX
     I              OMDVPR                          TKDVPR
     I              OMDWPR                          TKDWPR
     I              OMDXPR                          TKDXPR
     I              OMDYPR                          TKDYPR
     I              OMDZPR                          TKDZPR
     I              OMGSPR                          TKGSPR
     I              OMGTPR                          TKGTPR
     I              OMGUPR                          TKGUPR
     I              OMHOST                          TKHOST
     I              OMHPST                          TKHPST
     I              OMIOST                          TKIOST
     I              OMPEWG                          TKPEWG
     I              OMRINY                          TKRINY
     I              OMTIDT                          TKTIDT
     I              OMTJDT                          TKTJDT
     I              OMH2ST                          TKH2ST
     I              OMH0ST                          TKH0ST
     I              OMH1ST                          TKH1ST
     I              OMTKDT                          TKTKDT
     I              OMTLDT                          TKTLDT
     I              OMTMDT                          TKTMDT
     I              OMUVST                          TKUVST
     I              OMUWST                          TKUWST
     I              OMUXST                          TKUXST
     I              OMAATM                          TKAATM
     I              OMAYNA                          TKAYNA
     I              OMA0NA                          TKA0NA
     I              OMAXDT                          TKAXDT
      *
     I@E6CPZT
      * Order Detail Build Sched  Update index
      * Renamed input format fields
     I              E6AIC3                          TLAIC3
     I              E6C4NB                          TLC4NB
     I              E6DPNB                          TLDPNB
     I              E6UENB                          TLUENB
     I              E6AODT                          TLAODT
     I              E6DBST                          TLDBST
     I              E6GMST                          TLGMST
     I              E6GWST                          TLGWST
     I              E6JNCD                          TLJNCD
     I              E6HGCD                          TLHGCD
     I              E6NUDT                          TLNUDT
     I              E6AJCD                          TLAJCD
     I              E6RPCD                          TLRPCD
     I              E6AVQT                          TLAVQT
     I              E6D0WG                          TLD0WG
     I              E6CCQT                          TLCCQT
     I              E6AUWG                          TLAUWG
     I              E6JPCD                          TLJPCD
     I              E6NVDT                          TLNVDT
     I              E6BUTM                          TLBUTM
     I              E6WPST                          TLWPST
     I              E6RMNB                          TLRMNB
     I              E6U2ST                          TLU2ST
     I              E6BKC7                          TLBKC7
     I              E6XJST                          TLXJST
     I              E6XIST                          TLXIST
     I              E6PKST                          TLPKST
     I              E6BZNA                          TLBZNA
     I              E6CXDT                          TLCXDT
     I              E6BQTM                          TLBQTM
     I              E6DCST                          TLDCST
     I              E6DDST                          TLDDST
     I              E6OFNY                          TLOFNY
     I              E6EIDT                          TLEIDT
     I              E6RINY                          TLRINY
     I              E6TIDT                          TLTIDT
     I              E6TJDT                          TLTJDT
     I              E6TNDT                          TLTNDT
     I              E6TODT                          TLTODT
     I              E6IIST                          TLIIST
     I              E6IJST                          TLIJST
     I              E6R4CD                          TLR4CD
     I              E6BGCD                          TLBGCD
     I              E6X3CD                          TLX3CD
     I              E6A5DT                          TLA5DT
     I              E6VUDT                          TLVUDT
     I              E6VVDT                          TLVVDT
     I              E6VWDT                          TLVWDT
     I              E6BWSC                          TLBWSC
     I              E6BXSC                          TLBXSC
     I              E6BYSC                          TLBYSC
      *
     I@E6CPME
      * Order Detail Build Sched  Pick/F,B/FZ,FR/Sh/DDM/Od
      * Renamed input format fields
     I              E6AIC3                          TMAIC3
     I              E6C4NB                          TMC4NB
     I              E6DPNB                          TMDPNB
     I              E6UENB                          TMUENB
     I              E6AODT                          TMAODT
     I              E6DBST                          TMDBST
     I              E6GMST                          TMGMST
     I              E6GWST                          TMGWST
     I              E6JNCD                          TMJNCD
     I              E6HGCD                          TMHGCD
     I              E6NUDT                          TMNUDT
     I              E6AJCD                          TMAJCD
     I              E6RPCD                          TMRPCD
     I              E6AVQT                          TMAVQT
     I              E6D0WG                          TMD0WG
     I              E6CCQT                          TMCCQT
     I              E6AUWG                          TMAUWG
     I              E6JPCD                          TMJPCD
     I              E6NVDT                          TMNVDT
     I              E6BUTM                          TMBUTM
     I              E6WPST                          TMWPST
     I              E6RMNB                          TMRMNB
     I              E6U2ST                          TMU2ST
     I              E6BKC7                          TMBKC7
     I              E6XJST                          TMXJST
     I              E6XIST                          TMXIST
     I              E6PKST                          TMPKST
     I              E6BZNA                          TMBZNA
     I              E6CXDT                          TMCXDT
     I              E6BQTM                          TMBQTM
     I              E6DCST                          TMDCST
     I              E6DDST                          TMDDST
     I              E6OFNY                          TMOFNY
     I              E6EIDT                          TMEIDT
     I              E6RINY                          TMRINY
     I              E6TIDT                          TMTIDT
     I              E6TJDT                          TMTJDT
     I              E6TNDT                          TMTNDT
     I              E6TODT                          TMTODT
     I              E6IIST                          TMIIST
     I              E6IJST                          TMIJST
     I              E6R4CD                          TMR4CD
     I              E6BGCD                          TMBGCD
     I              E6X3CD                          TMX3CD
     I              E6A5DT                          TMA5DT
     I              E6VUDT                          TMVUDT
     I              E6VVDT                          TMVVDT
     I              E6VWDT                          TMVWDT
     I              E6BWSC                          TMBWSC
     I              E6BXSC                          TMBXSC
     I              E6BYSC                          TMBYSC
      *
     I@E6CPCH
      * Order Detail Build Sched  FrmBlk/SSD/Ord/Sq/Sq2
      * Renamed input format fields
     I              E6AIC3                          TOAIC3
     I              E6C4NB                          TOC4NB
     I              E6DPNB                          TODPNB
     I              E6UENB                          TOUENB
     I              E6AODT                          TOAODT
     I              E6DBST                          TODBST
     I              E6GMST                          TOGMST
     I              E6GWST                          TOGWST
     I              E6JNCD                          TOJNCD
     I              E6HGCD                          TOHGCD
     I              E6NUDT                          TONUDT
     I              E6AJCD                          TOAJCD
     I              E6RPCD                          TORPCD
     I              E6AVQT                          TOAVQT
     I              E6D0WG                          TOD0WG
     I              E6CCQT                          TOCCQT
     I              E6AUWG                          TOAUWG
     I              E6JPCD                          TOJPCD
     I              E6NVDT                          TONVDT
     I              E6BUTM                          TOBUTM
     I              E6WPST                          TOWPST
     I              E6RMNB                          TORMNB
     I              E6U2ST                          TOU2ST
     I              E6BKC7                          TOBKC7
     I              E6XJST                          TOXJST
     I              E6XIST                          TOXIST
     I              E6PKST                          TOPKST
     I              E6BZNA                          TOBZNA
     I              E6CXDT                          TOCXDT
     I              E6BQTM                          TOBQTM
     I              E6DCST                          TODCST
     I              E6DDST                          TODDST
     I              E6OFNY                          TOOFNY
     I              E6EIDT                          TOEIDT
     I              E6RINY                          TORINY
     I              E6TIDT                          TOTIDT
     I              E6TJDT                          TOTJDT
     I              E6TNDT                          TOTNDT
     I              E6TODT                          TOTODT
     I              E6IIST                          TOIIST
     I              E6IJST                          TOIJST
     I              E6R4CD                          TOR4CD
     I              E6BGCD                          TOBGCD
     I              E6X3CD                          TOX3CD
     I              E6A5DT                          TOA5DT
     I              E6VUDT                          TOVUDT
     I              E6VVDT                          TOVVDT
     I              E6VWDT                          TOVWDT
     I              E6BWSC                          TOBWSC
     I              E6BXSC                          TOBXSC
     I              E6BYSC                          TOBYSC
      *
     I@E6CPCI
      * Order Detail Build Sched  Load Id/Order number
      * Renamed input format fields
     I              E6AIC3                          TRAIC3
     I              E6C4NB                          TRC4NB
     I              E6DPNB                          TRDPNB
     I              E6UENB                          TRUENB
     I              E6AODT                          TRAODT
     I              E6DBST                          TRDBST
     I              E6GMST                          TRGMST
     I              E6GWST                          TRGWST
     I              E6JNCD                          TRJNCD
     I              E6HGCD                          TRHGCD
     I              E6NUDT                          TRNUDT
     I              E6AJCD                          TRAJCD
     I              E6RPCD                          TRRPCD
     I              E6AVQT                          TRAVQT
     I              E6D0WG                          TRD0WG
     I              E6CCQT                          TRCCQT
     I              E6AUWG                          TRAUWG
     I              E6JPCD                          TRJPCD
     I              E6NVDT                          TRNVDT
     I              E6BUTM                          TRBUTM
     I              E6WPST                          TRWPST
     I              E6RMNB                          TRRMNB
     I              E6U2ST                          TRU2ST
     I              E6BKC7                          TRBKC7
     I              E6XJST                          TRXJST
     I              E6XIST                          TRXIST
     I              E6PKST                          TRPKST
     I              E6BZNA                          TRBZNA
     I              E6CXDT                          TRCXDT
     I              E6BQTM                          TRBQTM
     I              E6DCST                          TRDCST
     I              E6DDST                          TRDDST
     I              E6OFNY                          TROFNY
     I              E6EIDT                          TREIDT
     I              E6RINY                          TRRINY
     I              E6TIDT                          TRTIDT
     I              E6TJDT                          TRTJDT
     I              E6TNDT                          TRTNDT
     I              E6TODT                          TRTODT
     I              E6IIST                          TRIIST
     I              E6IJST                          TRIJST
     I              E6R4CD                          TRR4CD
     I              E6BGCD                          TRBGCD
     I              E6X3CD                          TRX3CD
     I              E6A5DT                          TRA5DT
     I              E6VUDT                          TRVUDT
     I              E6VVDT                          TRVVDT
     I              E6VWDT                          TRVWDT
     I              E6BWSC                          TRBWSC
     I              E6BXSC                          TRBXSC
     I              E6BYSC                          TRBYSC
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          TSAIC3
     I              BEC4NB                          TSC4NB
     I              BEJNCD                          TSJNCD
     I              BEANC7                          TSANC7
     I              BEBKC7                          TSBKC7
     I              BEBRTX                          TSBRTX
     I              BEHMNA                          TSHMNA
     I              BEHONA                          TSHONA
     I              BEHPNA                          TSHPNA
     I              BEHNNA                          TSHNNA
     I              BEDBCD                          TSDBCD
     I              BECKTX                          TSCKTX
     I              BEB0C7                          TSB0C7
     I              BEAETX                          TSAETX
     I              BEB1NA                          TSB1NA
     I              BEB3NA                          TSB3NA
     I              BEB4NA                          TSB4NA
     I              BEB2NA                          TSB2NA
     I              BEBHCD                          TSBHCD
     I              BEC8TX                          TSC8TX
     I              BEBCNA                          TSBCNA
     I              BEA0DT                          TSA0DT
     I              BEA5DT                          TSA5DT
     I              BEGNDT                          TSGNDT
     I              BEACDT                          TSACDT
     I              BEAQCD                          TSAQCD
     I              BEB6NA                          TSB6NA
     I              BEBYNA                          TSBYNA
     I              BEBZNA                          TSBZNA
     I              BEGTST                          TSGTST
     I              BEGVST                          TSGVST
     I              BEGUST                          TSGUST
     I              BEQFST                          TSQFST
     I              BECQCD                          TSCQCD
     I              BEGJST                          TSGJST
     I              BEGWST                          TSGWST
     I              BEGXST                          TSGXST
     I              BEGYST                          TSGYST
     I              BEAODT                          TSAODT
     I              BEAIVN                          TSAIVN
     I              BECXDT                          TSCXDT
     I              BEJZVA                          TSJZVA
     I              BEA1WG                          TSA1WG
     I              BEXIST                          TSXIST
     I              BEXJST                          TSXJST
     I              BEXKST                          TSXKST
     I              BEEIDT                          TSEIDT
     I              BEAFTM                          TSAFTM
     I              BEE8CD                          TSE8CD
     I              BEE9CD                          TSE9CD
     I              BERMNB                          TSRMNB
     I              BETBNB                          TSTBNB
     I              BER1NB                          TSR1NB
     I              BEPJST                          TSPJST
     I              BEU0ST                          TSU0ST
     I              BEU1ST                          TSU1ST
     I              BEQ2CD                          TSQ2CD
     I              BEU2ST                          TSU2ST
     I              BEVEST                          TSVEST
     I              BEVFST                          TSVFST
     I              BEVGST                          TSVGST
     I              BERPCD                          TSRPCD
     I              BERNNB                          TSRNNB
     I              BEVDST                          TSVDST
     I              BEATIN                          TSATIN
     I              BEU4ST                          TSU4ST
     I              BEU5ST                          TSU5ST
     I              BERSRN                          TSRSRN
     I              BEMHNA                          TSMHNA
     I              BEMINA                          TSMINA
     I              BEWBST                          TSWBST
     I              BER4CD                          TSR4CD
     I              BEBFCD                          TSBFCD
     I              BEQ4CD                          TSQ4CD
     I              BET3NB                          TST3NB
     I              BESICD                          TSSICD
     I              BECONB                          TSCONB
     I              BECEST                          TSCEST
     I              BEAWDT                          TSAWDT
     I              BEJPCD                          TSJPCD
     I              BEXUST                          TSXUST
     I              BEZ1ST                          TSZ1ST
     I              BEVRVA                          TSVRVA
     I              BEOBST                          TSOBST
     I              BEBCST                          TSBCST
     I              BEBDST                          TSBDST
     I              BEB7VL                          TSB7VL
     I              BEGASX                          TSGASX
     I              BEGBSX                          TSGBSX
     I              BEGCSX                          TSGCSX
     I              BEGDSX                          TSGDSX
     I              BEFNSX                          TSFNSX
     I              BEFOSX                          TSFOSX
     I              BEFPSX                          TSFPSX
     I              BEFQSX                          TSFQSX
     I              BEFRSX                          TSFRSX
     I              BEFSSX                          TSFSSX
     I              BEFTSX                          TSFTSX
     I              BEFUSX                          TSFUSX
     I              BEFVSX                          TSFVSX
     I              BEFWSX                          TSFWSX
     I              BEFXSX                          TSFXSX
     I              BEFYSX                          TSFYSX
     I              BENODT                          TSNODT
     I              BENPDT                          TSNPDT
     I              BENQDT                          TSNQDT
     I              BENRDT                          TSNRDT
     I              BENSDT                          TSNSDT
     I              BEBPTM                          TSBPTM
     I              BEBQTM                          TSBQTM
     I              BEBRTM                          TSBRTM
     I              BEBSTM                          TSBSTM
     I              BEBTTM                          TSBTTM
     I              BEH0NX                          TSH0NX
     I              BEH1NX                          TSH1NX
     I              BEH2NX                          TSH2NX
     I              BEH3NX                          TSH3NX
     I              BEH4NX                          TSH4NX
     I              BEC0C7                          TSC0C7
     I              BEUVST                          TSUVST
     I              BEUWST                          TSUWST
     I              BEUXST                          TSUXST
     I              BEAATM                          TSAATM
     I              BEAYNA                          TSAYNA
     I              BEA0NA                          TSA0NA
     I              BEAXDT                          TSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDKM1    E DSPDKMREL0
      * UPD : Company Values            Update index
      * Renamed input format fields
     I              KMAIC3                          WBAIC3
     I              KMV8CD                          WBV8CD
     I              KMAUNA                          WBAUNA
     I              KMI5ST                          WBI5ST
     I              KMBXTX                          WBBXTX
     I              KMM8NB                          WBM8NB
     I              KMUVST                          WBUVST
     I              KMUWST                          WBUWST
     I              KMUXST                          WBUXST
     I              KMVSST                          WBVSST
     I              KMAATM                          WBAATM
     I              KMAYNA                          WBAYNA
     I              KMA0NA                          WBA0NA
     I              KMAXDT                          WBAXDT
      *
     IYARDCS      DS                            123
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     IYBRDCS      DS                            100
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WIAIC3
     I              B5C4NB                          WIC4NB
     I              B5DPNB                          WIDPNB
     I              B5UENB                          WIUENB
     I              B5JGDT                          WIJGDT
     I              B5AODT                          WIAODT
     I              B5AJCD                          WIAJCD
     I              B5HGCD                          WIHGCD
     I              B5IUQT                          WIIUQT
     I              B5F3WG                          WIF3WG
     I              B5UVST                          WIUVST
     I              B5UWST                          WIUWST
     I              B5UXST                          WIUXST
     I              B5VSST                          WIVSST
     I              B5AATM                          WIAATM
     I              B5AYNA                          WIAYNA
     I              B5A0NA                          WIA0NA
     I              B5AXDT                          WIAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPOCW1    E DSPOCWCPL0
      * UPD : PS Prod Item Inventory    Update index
      * Renamed input format fields
     I              CWAIC3                          WMAIC3
     I              CWHGCD                          WMHGCD
     I              CWAJCD                          WMAJCD
     I              CWELDT                          WMELDT
     I              CWACWG                          WMACWG
     I              CWARQT                          WMARQT
     I              CWK7DT                          WMK7DT
     I              CWUVST                          WMUVST
     I              CWUWST                          WMUWST
     I              CWUXST                          WMUXST
     I              CWVSST                          WMVSST
     I              CWAATM                          WMAATM
     I              CWAYNA                          WMAYNA
     I              CWA0NA                          WMA0NA
     I              CWAXDT                          WMAXDT
      *
     IYCRDCS      DS                             69
     IYDRDCS      DS                            100
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          TAAIC3
     I              I8V5ST                          TAV5ST
     I              I8ELDT                          TAELDT
     I              I8HGCD                          TAHGCD
     I              I8AJCD                          TAAJCD
     I              I8GPDT                          TAGPDT
     I              I8WTSP                          TAWTSP
     I              I8QTSP                          TAQTSP
     I              I8DJPC                          TADJPC
     I              I8F8WG                          TAF8WG
     I              I8WTIN                          TAWTIN
     I              I8D5NB                          TAD5NB
     I              I8DXWG                          TADXWG
     I              I8B2NB                          TAB2NB
     I              I8WTCN                          TAWTCN
     I              I8PSCV                          TAPSCV
     I              I8SAWT                          TASAWT
     I              I8B9NB                          TAB9NB
     I              I8D1WG                          TAD1WG
     I              I8CBNB                          TACBNB
     I              I8EZWG                          TAEZWG
     I              I8CCNB                          TACCNB
     I              I8E0WG                          TAE0WG
     I              I8D6NB                          TAD6NB
     I              I8OAWT                          TAOAWT
     I              I8CDNB                          TACDNB
     I              I8UNW2                          TAUNW2
     I              I8CENB                          TACENB
     I              I8F9WG                          TAF9WG
     I              I8BPNB                          TABPNB
     I              I8GAWG                          TAGAWG
     I              I8BQNB                          TABQNB
     I              I8GBWG                          TAGBWG
     I              I8BRNB                          TABRNB
     I              I8GCWG                          TAGCWG
     I              I8BSNB                          TABSNB
     I              I8GDWG                          TAGDWG
     I              I8BWNB                          TABWNB
     I              I8GEWG                          TAGEWG
     I              I8PS6U                          TAPS6U
     I              I8WCST                          TAWCST
     I              I8WPST                          TAWPST
     I              I8B5ST                          TAB5ST
     I              I8TFST                          TATFST
     I              I8TEST                          TATEST
     I              I8THST                          TATHST
     I              I8UDST                          TAUDST
     I              I8UFST                          TAUFST
     I              I8UGST                          TAUGST
     I              I8UHST                          TAUHST
     I              I8B6ST                          TAB6ST
     I              I8B7ST                          TAB7ST
     I              I8DVWG                          TADVWG
     I              I8D7NB                          TAD7NB
     I              I8FCAD                          TAFCAD
     I              I8D9NB                          TAD9NB
     I              I8DWWG                          TADWWG
     I              I8EANB                          TAEANB
     I              I8SHWT                          TASHWT
     I              I8EBNB                          TAEBNB
     I              I8AVWT                          TAAVWT
     I              I8ECNB                          TAECNB
     I              I8WTON                          TAWTON
     I              I8EDNB                          TAEDNB
     I              I8FNWT                          TAFNWT
     I              I8EENB                          TAEENB
     I              I8QTAS                          TAQTAS
     I              I8EFNB                          TAEFNB
     I              I8WAIO                          TAWAIO
     I              I8EGNB                          TAEGNB
     I              I8R3CD                          TAR3CD
     I              I8RGNB                          TARGNB
     I              I8RHNB                          TARHNB
     I              I8RINB                          TARINB
     I              I8XRCD                          TAXRCD
     I              I8UVST                          TAUVST
     I              I8UWST                          TAUWST
     I              I8UXST                          TAUXST
     I              I8VSST                          TAVSST
     I              I8AATM                          TAAATM
     I              I8AYNA                          TAAYNA
     I              I8A0NA                          TAA0NA
     I              I8AXDT                          TAAXDT
      *
     IYERDCS      DS                            326
     IYFRDCS      DS                            100
     IYGRDCS      DS                            100
     IYHRDCS      DS                            326
     IYIRDCS      DS                            326
     IYJRDCS      DS                             91
     IYKRDCS      DS                            326
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TKAIC3
     I              OMC4NB                          TKC4NB
     I              OMDPNB                          TKDPNB
     I              OMUENB                          TKUENB
     I              OMHGCD                          TKHGCD
     I              OMAJCD                          TKAJCD
     I              OMBKC7                          TKBKC7
     I              OMCFC7                          TKCFC7
     I              OMGMST                          TKGMST
     I              OMGNST                          TKGNST
     I              OMMAVA                          TKMAVA
     I              OMKDVA                          TKKDVA
     I              OML8VA                          TKL8VA
     I              OML9VA                          TKL9VA
     I              OMGTST                          TKGTST
     I              OMGVST                          TKGVST
     I              OMGUST                          TKGUST
     I              OMQFST                          TKQFST
     I              OMAYVA                          TKAYVA
     I              OMEXDT                          TKEXDT
     I              OMLQCD                          TKLQCD
     I              OMRDCD                          TKRDCD
     I              OMQ7CD                          TKQ7CD
     I              OMBZPR                          TKBZPR
     I              OML6NB                          TKL6NB
     I              OMU1ST                          TKU1ST
     I              OMGIDT                          TKGIDT
     I              OMCRCD                          TKCRCD
     I              OMAGCD                          TKAGCD
     I              OMRZST                          TKRZST
     I              OMR0ST                          TKR0ST
     I              OMR1ST                          TKR1ST
     I              OMG7NA                          TKG7NA
     I              OMG8NA                          TKG8NA
     I              OMRPCD                          TKRPCD
     I              OMVEST                          TKVEST
     I              OMVGST                          TKVGST
     I              OMAVST                          TKAVST
     I              OMU0ST                          TKU0ST
     I              OMRFCD                          TKRFCD
     I              OMFZST                          TKFZST
     I              OMR1NB                          TKR1NB
     I              OMAVQT                          TKAVQT
     I              OMD0WG                          TKD0WG
     I              OMCCQT                          TKCCQT
     I              OMAUWG                          TKAUWG
     I              OMCBQT                          TKCBQT
     I              OMATWG                          TKATWG
     I              OMAQCS                          TKAQCS
     I              OMAGCS                          TKAGCS
     I              OMAKPR                          TKAKPR
     I              OMALPR                          TKALPR
     I              OMAUPR                          TKAUPR
     I              OMAVWG                          TKAVWG
     I              OMA4WG                          TKA4WG
     I              OMA5DT                          TKA5DT
     I              OMAODT                          TKAODT
     I              OMGNDT                          TKGNDT
     I              OMAMST                          TKAMST
     I              OMANST                          TKANST
     I              OMVAST                          TKVAST
     I              OMRGNB                          TKRGNB
     I              OMRHNB                          TKRHNB
     I              OMRINB                          TKRINB
     I              OMRBCD                          TKRBCD
     I              OMHICD                          TKHICD
     I              OMRNCD                          TKRNCD
     I              OMROCD                          TKROCD
     I              OMCXDT                          TKCXDT
     I              OMAJVN                          TKAJVN
     I              OMKXCD                          TKKXCD
     I              OMJPCD                          TKJPCD
     I              OMCQCD                          TKCQCD
     I              OMR4CD                          TKR4CD
     I              OMZ1ST                          TKZ1ST
     I              OMZ3ST                          TKZ3ST
     I              OMZ4ST                          TKZ4ST
     I              OMDUPR                          TKDUPR
     I              OMB6VL                          TKB6VL
     I              OMA1AA                          TKA1AA
     I              OMFZSX                          TKFZSX
     I              OMF0SX                          TKF0SX
     I              OMF1SX                          TKF1SX
     I              OMF2SX                          TKF2SX
     I              OMF3SX                          TKF3SX
     I              OMF4SX                          TKF4SX
     I              OMF5SX                          TKF5SX
     I              OMF6SX                          TKF6SX
     I              OMF7SX                          TKF7SX
     I              OMNTDT                          TKNTDT
     I              OMNUDT                          TKNUDT
     I              OMNVDT                          TKNVDT
     I              OMNWDT                          TKNWDT
     I              OMNXDT                          TKNXDT
     I              OMBUTM                          TKBUTM
     I              OMBVTM                          TKBVTM
     I              OMBWTM                          TKBWTM
     I              OMBXTM                          TKBXTM
     I              OMBYTM                          TKBYTM
     I              OMH5NX                          TKH5NX
     I              OMH6NX                          TKH6NX
     I              OMH7NX                          TKH7NX
     I              OMH8NX                          TKH8NX
     I              OMH9NX                          TKH9NX
     I              OMDVPR                          TKDVPR
     I              OMDWPR                          TKDWPR
     I              OMDXPR                          TKDXPR
     I              OMDYPR                          TKDYPR
     I              OMDZPR                          TKDZPR
     I              OMGSPR                          TKGSPR
     I              OMGTPR                          TKGTPR
     I              OMGUPR                          TKGUPR
     I              OMHOST                          TKHOST
     I              OMHPST                          TKHPST
     I              OMIOST                          TKIOST
     I              OMPEWG                          TKPEWG
     I              OMRINY                          TKRINY
     I              OMTIDT                          TKTIDT
     I              OMTJDT                          TKTJDT
     I              OMH2ST                          TKH2ST
     I              OMH0ST                          TKH0ST
     I              OMH1ST                          TKH1ST
     I              OMTKDT                          TKTKDT
     I              OMTLDT                          TKTLDT
     I              OMTMDT                          TKTMDT
     I              OMUVST                          TKUVST
     I              OMUWST                          TKUWST
     I              OMUXST                          TKUXST
     I              OMAATM                          TKAATM
     I              OMAYNA                          TKAYNA
     I              OMA0NA                          TKA0NA
     I              OMAXDT                          TKAXDT
      *
     IYLRDCS      DS                            525
     IYMRDCS      DS                            525
     IQPME61    E DSPME6CPL0
      * UPD : Order Detail Build Sched  Update index
      * Renamed input format fields
     I              E6AIC3                          TLAIC3
     I              E6C4NB                          TLC4NB
     I              E6DPNB                          TLDPNB
     I              E6UENB                          TLUENB
     I              E6AODT                          TLAODT
     I              E6DBST                          TLDBST
     I              E6GMST                          TLGMST
     I              E6GWST                          TLGWST
     I              E6JNCD                          TLJNCD
     I              E6HGCD                          TLHGCD
     I              E6NUDT                          TLNUDT
     I              E6AJCD                          TLAJCD
     I              E6RPCD                          TLRPCD
     I              E6AVQT                          TLAVQT
     I              E6D0WG                          TLD0WG
     I              E6CCQT                          TLCCQT
     I              E6AUWG                          TLAUWG
     I              E6JPCD                          TLJPCD
     I              E6NVDT                          TLNVDT
     I              E6BUTM                          TLBUTM
     I              E6WPST                          TLWPST
     I              E6RMNB                          TLRMNB
     I              E6U2ST                          TLU2ST
     I              E6BKC7                          TLBKC7
     I              E6XJST                          TLXJST
     I              E6XIST                          TLXIST
     I              E6PKST                          TLPKST
     I              E6BZNA                          TLBZNA
     I              E6CXDT                          TLCXDT
     I              E6BQTM                          TLBQTM
     I              E6DCST                          TLDCST
     I              E6DDST                          TLDDST
     I              E6OFNY                          TLOFNY
     I              E6EIDT                          TLEIDT
     I              E6RINY                          TLRINY
     I              E6TIDT                          TLTIDT
     I              E6TJDT                          TLTJDT
     I              E6TNDT                          TLTNDT
     I              E6TODT                          TLTODT
     I              E6IIST                          TLIIST
     I              E6IJST                          TLIJST
     I              E6R4CD                          TLR4CD
     I              E6BGCD                          TLBGCD
     I              E6X3CD                          TLX3CD
     I              E6A5DT                          TLA5DT
     I              E6VUDT                          TLVUDT
     I              E6VVDT                          TLVVDT
     I              E6VWDT                          TLVWDT
     I              E6BWSC                          TLBWSC
     I              E6BXSC                          TLBXSC
     I              E6BYSC                          TLBYSC
      *
     IYNRDCS      DS                            153
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          TSAIC3
     I              BEC4NB                          TSC4NB
     I              BEJNCD                          TSJNCD
     I              BEANC7                          TSANC7
     I              BEBKC7                          TSBKC7
     I              BEBRTX                          TSBRTX
     I              BEHMNA                          TSHMNA
     I              BEHONA                          TSHONA
     I              BEHPNA                          TSHPNA
     I              BEHNNA                          TSHNNA
     I              BEDBCD                          TSDBCD
     I              BECKTX                          TSCKTX
     I              BEB0C7                          TSB0C7
     I              BEAETX                          TSAETX
     I              BEB1NA                          TSB1NA
     I              BEB3NA                          TSB3NA
     I              BEB4NA                          TSB4NA
     I              BEB2NA                          TSB2NA
     I              BEBHCD                          TSBHCD
     I              BEC8TX                          TSC8TX
     I              BEBCNA                          TSBCNA
     I              BEA0DT                          TSA0DT
     I              BEA5DT                          TSA5DT
     I              BEGNDT                          TSGNDT
     I              BEACDT                          TSACDT
     I              BEAQCD                          TSAQCD
     I              BEB6NA                          TSB6NA
     I              BEBYNA                          TSBYNA
     I              BEBZNA                          TSBZNA
     I              BEGTST                          TSGTST
     I              BEGVST                          TSGVST
     I              BEGUST                          TSGUST
     I              BEQFST                          TSQFST
     I              BECQCD                          TSCQCD
     I              BEGJST                          TSGJST
     I              BEGWST                          TSGWST
     I              BEGXST                          TSGXST
     I              BEGYST                          TSGYST
     I              BEAODT                          TSAODT
     I              BEAIVN                          TSAIVN
     I              BECXDT                          TSCXDT
     I              BEJZVA                          TSJZVA
     I              BEA1WG                          TSA1WG
     I              BEXIST                          TSXIST
     I              BEXJST                          TSXJST
     I              BEXKST                          TSXKST
     I              BEEIDT                          TSEIDT
     I              BEAFTM                          TSAFTM
     I              BEE8CD                          TSE8CD
     I              BEE9CD                          TSE9CD
     I              BERMNB                          TSRMNB
     I              BETBNB                          TSTBNB
     I              BER1NB                          TSR1NB
     I              BEPJST                          TSPJST
     I              BEU0ST                          TSU0ST
     I              BEU1ST                          TSU1ST
     I              BEQ2CD                          TSQ2CD
     I              BEU2ST                          TSU2ST
     I              BEVEST                          TSVEST
     I              BEVFST                          TSVFST
     I              BEVGST                          TSVGST
     I              BERPCD                          TSRPCD
     I              BERNNB                          TSRNNB
     I              BEVDST                          TSVDST
     I              BEATIN                          TSATIN
     I              BEU4ST                          TSU4ST
     I              BEU5ST                          TSU5ST
     I              BERSRN                          TSRSRN
     I              BEMHNA                          TSMHNA
     I              BEMINA                          TSMINA
     I              BEWBST                          TSWBST
     I              BER4CD                          TSR4CD
     I              BEBFCD                          TSBFCD
     I              BEQ4CD                          TSQ4CD
     I              BET3NB                          TST3NB
     I              BESICD                          TSSICD
     I              BECONB                          TSCONB
     I              BECEST                          TSCEST
     I              BEAWDT                          TSAWDT
     I              BEJPCD                          TSJPCD
     I              BEXUST                          TSXUST
     I              BEZ1ST                          TSZ1ST
     I              BEVRVA                          TSVRVA
     I              BEOBST                          TSOBST
     I              BEBCST                          TSBCST
     I              BEBDST                          TSBDST
     I              BEB7VL                          TSB7VL
     I              BEGASX                          TSGASX
     I              BEGBSX                          TSGBSX
     I              BEGCSX                          TSGCSX
     I              BEGDSX                          TSGDSX
     I              BEFNSX                          TSFNSX
     I              BEFOSX                          TSFOSX
     I              BEFPSX                          TSFPSX
     I              BEFQSX                          TSFQSX
     I              BEFRSX                          TSFRSX
     I              BEFSSX                          TSFSSX
     I              BEFTSX                          TSFTSX
     I              BEFUSX                          TSFUSX
     I              BEFVSX                          TSFVSX
     I              BEFWSX                          TSFWSX
     I              BEFXSX                          TSFXSX
     I              BEFYSX                          TSFYSX
     I              BENODT                          TSNODT
     I              BENPDT                          TSNPDT
     I              BENQDT                          TSNQDT
     I              BENRDT                          TSNRDT
     I              BENSDT                          TSNSDT
     I              BEBPTM                          TSBPTM
     I              BEBQTM                          TSBQTM
     I              BEBRTM                          TSBRTM
     I              BEBSTM                          TSBSTM
     I              BEBTTM                          TSBTTM
     I              BEH0NX                          TSH0NX
     I              BEH1NX                          TSH1NX
     I              BEH2NX                          TSH2NX
     I              BEH3NX                          TSH3NX
     I              BEH4NX                          TSH4NX
     I              BEC0C7                          TSC0C7
     I              BEUVST                          TSUVST
     I              BEUWST                          TSUWST
     I              BEUXST                          TSUXST
     I              BEAATM                          TSAATM
     I              BEAYNA                          TSAYNA
     I              BEA0NA                          TSA0NA
     I              BEAXDT                          TSAXDT
      *
     IYORDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  PPS Process STS
     I                                        1   1 P2MWSX
     IP3PARM      DS
      * B :  Production Date RGT
     I                                    P   1   40P3GWDT
     IP4PARM      DS
      * N :  Scheduled Ship Date USR
     I                                    P   1   40P4HODT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2MWSX    PARM           WP0001  1        PPS Process STS
     C           P3GWDT    PARM P3GWDT    WP0002  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BPS Order Det Bld Sch XF
      * ********************
      * FP1054 New
      * Create Order Detail Build Sched file which will be read to alloca
      * production to open orders in the specified sequence.
      * ********************
      * E3188 RMC SET COMPANY VALUE TO YES WHEN PPS BUILD IS IN PROGRESS
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'Y'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * Rtv Chg Comp Val Alpha RT - Company Values  * Company 440
      * Move input parameters to subroutine local variables.
     C                     Z-ADD440       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'Y'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'Y'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * ********************
      * CASE: PAR.PPS Process STS is Realc by SDte Mid Day
     C           P2MWSX    IFEQ '2'                        *IF
      * UPS Realc Ord Init    XF - PS Prod Schedule  * 
     C                     CALL 'POQXXFR'              90  UPS Realc Ord I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0001  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Realc Ord Init    XF - PS Prod Schedule  * Company 440
     C                     CALL 'POQXXFR'              90  UPS Realc Ord I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 440       WQ0002  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Realc Ord Init    XF - PS Prod Schedule  * 
     C                     CALL 'POQXXFR'              90  UPS Realc Ord I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0003  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Del Order Detail Sched, Cnsmd, Inv for shipped orders
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0004           Company Number
     C                     EXSR SCRVGN
      * Upd Reallocate Sts    RT - Order Detail Schedule  * Company 440
      * Move input parameters to subroutine local variables.
     C                     Z-ADD440       WL0004           Company Number
     C                     EXSR SCRVGN
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0004           Company Number
     C                     EXSR SCRVGN
      * Delete Order Detail Schedule for orders older than 3 days ago
      *   They wont be reallocated in the following routines
      *   To Remove the detail record, set report typ = "D"
      * E3031 2/27/14 RMC Rail orders can be 30 days old
      * PAR.Scheduled Ship Date USR = JOB.*Job date + CON.-11 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-11       XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4HODT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4HODT
     C                     END
      * PrtRmv OrddtlSch-NAllcPF - Order Detail Schedule  * 
     C                     CALL 'PMFPPFR'              90  PrtRmv OrddtlSc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0004  30       Company Number
     C                     PARM P4HODT    WQ0005  70       Scheduled Ship
     C                     PARM 'D'       WQ0006  1        Report Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFPPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PrtRmv OrddtlSch-NAllcPF - Order Detail Schedule  * Company 440
     C                     CALL 'PMFPPFR'              90  PrtRmv OrddtlSc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 440       WQ0007  30       Company Number
     C                     PARM P4HODT    WQ0008  70       Scheduled Ship
     C                     PARM 'D'       WQ0009  1        Report Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFPPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PrtRmv OrddtlSch-NAllcPF - Order Detail Schedule  * 
     C                     CALL 'PMFPPFR'              90  PrtRmv OrddtlSc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0010  30       Company Number
     C                     PARM P4HODT    WQ0011  70       Scheduled Ship
     C                     PARM 'D'       WQ0012  1        Report Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFPPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Update Consumed Item Code in Order Detail due to possible BOM Chg
      * Upd Init Consumed Itm XF - Order Detail  * 
     C                     CALL 'POQPXFR'              90  Upd Init Consum
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * S11522 RMC Calc RGT date   ( code is in 1st level cut pmfzxfr als
     C                     Z-ADD##JDT     YL0003           Kill Date
     C                     Z-ADDYL0003    YL0004           Kill Date RGF
      * RTV Numeric Value      RT - System Values  * 
     C                     EXSR SKRVGN
      * CASE: LCL.*Duration (factor) is EQ Zero
     C           YL0005    IFEQ *ZERO                      *IF
     C                     Z-ADD40        YL0005           *Duration (fact
     C                     END                             *FI
      * RTV KillDay Dte-Durtn  RT - Calendar  * 
     C                     EXSR SLRVGN
      * Build Order Detail Build Sched workfile : Start with 3 days prior
      *      Stop with Production Date RGT (Last date in pdi8cpp)
      *   go back 11 days  6-17-14
      * PAR.Scheduled Ship Date USR = JOB.*Job date + CON.-11 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-11       XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4HODT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4HODT
     C                     END
      * BPS Crt ODBS by itself XF - Order Detail Build Sched  * 
     C                     CALL 'PMEDXFR'              90  BPS Crt ODBS by
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P4HODT    WQ0013  70       Scheduled Ship
     C                     PARM P3GWDT    WQ0014  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMEDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *----------------  CAPTURE INVENTORY --------------------*
      * Del Item Inventory    RT - PS Prod Item Inventory  * ---360---
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0031           Company Number
     C                     MOVEL*BLANK    WL0032           Warehouse Code
     C                     EXSR SMRVGN
      * BPS Capture Inv OnHnd PF - Item Balance  * ---360---
     C                     CALL 'PDBHPFR'              90  BPS Capture Inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0015  30       Company Number
     C                     PARM *BLANK    WQ0016  3        Warehouse Code
     C                     PARM ##JDT     WQ0017  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Del Item Inventory    RT - PS Prod Item Inventory  * ---440---
      * Move input parameters to subroutine local variables.
     C                     Z-ADD440       WL0031           Company Number
     C                     MOVEL*BLANK    WL0032           Warehouse Code
     C                     EXSR SMRVGN
      * BPS Capture Inv OnHnd PF - Item Balance  * ---440---
     C                     CALL 'PDBHPFR'              90  BPS Capture Inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 440       WQ0018  30       Company Number
     C                     PARM *BLANK    WQ0019  3        Warehouse Code
     C                     PARM ##JDT     WQ0020  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Del Item Inventory    RT - PS Prod Item Inventory  * ---960---
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0031           Company Number
     C                     MOVEL*BLANK    WL0032           Warehouse Code
     C                     EXSR SMRVGN
      * BPS Capture Inv OnHnd PF - Item Balance  * ---960---
     C                     CALL 'PDBHPFR'              90  BPS Capture Inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0021  30       Company Number
     C                     PARM *BLANK    WQ0022  3        Warehouse Code
     C                     PARM ##JDT     WQ0023  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *------------------------------------------------------------*
      * S16603 05/28/20 DN-Call the Informatica Restoration Javascript.
      * CASE: *OTHERWISE
      * Exc Copy /SBM Qsh Call CL - Order Detail Schedule  * 
     C                     CALL 'PUUZUPC'              90  Exc Copy /SBM Q
     C                     PARM 'R'       WQ0024  1        Call Job USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUUZUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 1. Process Workfile in sequence per logical for:
      *      a. Partially Picked, thru Current Schedule Ship Date
     C                     Z-ADD##JDT     P4HODT           Scheduled Ship
      * BPS Proc ODBS f/Curr  RT - Order Detail Build Sched  * 
     C                     EXSR SORVGN
      * 2a.Process Workfile in sequence per logical for:
      * NEW -a. Partial Picked, Firm/Block, FZ/FR, SchShp,DDt tm,Ord  2/1
      * NEW -a. Partial Picked, Firm/Block, FZ/FR, DdtTm, Schd Shp Dt,Ord
      * E2885 Do Orders with Override Sched = Y 1st here      1/13/14 RMC
      * E2885 Chg to get inv for FResh orders ONLY with curr/future prod
      * PAR.Scheduled Ship Date USR = JOB.*Job date + CON.1 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4HODT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4HODT
     C                     END
      * BPS Proc ODBS f/Futur RT - Order Detail Build Sched  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'Y'       WL0349    P      ODBS Sched Over
     C                     Z-ADDP4HODT    WL0350           Scheduled Ship
     C                     Z-ADDP3GWDT    WL0351           Production Date
     C                     EXSR NQRVGN
      * 2b Process Workfile in sequence per logical for:
      * ORIG-a. Partial Picked, Firm/Block, FZ/FR, Sched Ship Dt, Order
      * NEW -a. Partial Picked, Firm/Block, FZ/FR, DdtTm, Schd Shp Dt,Ord
      * NEW -a. Partial Picked, Firm/Block, FZ/FR, SchShp,DDt tm,Ord  2/1
      * E2303 For Orders with Override Sched = Y, see if theres inventory
      * E2885 Do Orders with Override Sched = ' '   here      1/13/14 RMC
      * PAR.Scheduled Ship Date USR = JOB.*Job date + CON.1 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4HODT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4HODT
     C                     END
      * BPS Proc ODBS f/Futur RT - Order Detail Build Sched  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUUAT1    WL0349    P      ODBS Sched Over
     C                     Z-ADDP4HODT    WL0350           Scheduled Ship
     C                     Z-ADDP3GWDT    WL0351           Production Date
     C                     EXSR NQRVGN
      * 2c Process Workfile in sequence per logical for BLOCKS ONLY
      *      a. Partial Picked, Firm/Block, FZ/FR, Sched Ship Dt, Order
      *      b. R5947 5/16/16 RMC Alloc block orders after all firm
      * PAR.Scheduled Ship Date USR = JOB.*Job date + CON.1 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4HODT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4HODT
     C                     END
      * BPS Proc ODBS f/Block RT - Order Detail Build Sched  * 
     C                     EXSR NRRVGN
      * 3.a Process Order Detail Build with New Production Hold = 1
      * ORIG-a. Frm/Blk, Sched Ship,Ord,Sq,Sq2
      * NEW -a. Frm/Blk, DDtTm,Sched Ship,Ord,Sq,Sq2   4/26/12
      * RMC 5/8/14 dont sched block atall
      * RMC 6/18/14 do sched block afterall
      * BPS Proc ODBS f/NPH1  RT - Order Detail Build Sched  * 
     C                     EXSR NSRVGN
      * 4. Process Order Detail Build and Post Orders
      *     a. Unlock Load if still Order Header Status = H
      *     B. Lock Load if Order Header Status n= H and it passes valida
      *     c. Also, only lock if shipping Today              E00495
      *     d. Dont hold if shipping today or sooner         C0679
      *     e. Don't lock load if Order Requires Review = Y, errors in OD
      *     d. Dont hold if shipping today or sooner FZ Only   10/10/13
      * BPS Proc ODBS f/POST  RT - Order Detail Build Sched  * 
     C                     EXSR NURVGN
      * 5. Build Ps Prod Item Schedule "X" record which is a copy of the
      *  record right after the am build. it will be displayed on the
      *  Dsp Schedule Variance screen when they want to see what has been
      *  made so far by comparing the "X" rcds to the current "S" rcds.
      * BPS Crt Sch X Rcd     XF - PS Prod Item Schedule  * 
     C                     CALL 'PNHZXFR'              90  BPS Crt Sch X R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0281  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNHZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ********************
      * 6. E3188 RMC Set Company Value to No when PPS BUILD completes
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'N'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * Rtv Chg Comp Val Alpha RT - Company Values  * Company 440
      * Move input parameters to subroutine local variables.
     C                     Z-ADD440       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'N'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'N'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * ********************
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0478  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0479  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0480  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0481  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0482  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0483  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0484  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0485  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0486  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0487  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0488  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0489  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0490  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0491  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0492  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0493  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0494  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0495  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0496  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0497  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0498 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0499  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0500 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0501  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0502 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0503  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0504 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0505  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0506 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0507  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0508 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0509  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0510  3        PS Item Id
     C                     MOVEL*BLANK    WN0511  2        Warehouse Type
     C                     MOVEL*BLANK    WN0512  1        PS Lock Status
     C                     MOVEL*BLANK    WN0513  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0514  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0515  1        PS Piece Count
     C                     MOVEL*BLANK    WN0516  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0517  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0518  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0519  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0520  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0521  3        PS Production W
     C                     Z-ADD*ZERO     WN0522  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0523  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0524  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0525  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0526  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0527  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0528  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0529  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0530  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0531  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0532  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0533  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0534  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0535  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0536  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0537  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0538  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0539  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0540  6        Department Code
     C                     Z-ADD*ZERO     WN0541  30       Item Structure
     C                     Z-ADD*ZERO     WN0542  30       Item Structure
     C                     Z-ADD*ZERO     WN0543  30       Item Structure
     C                     MOVEL*BLANK    WN0544  6        Primal Group Co
     C                     MOVEL*BLANK    WN0545  1        EDI Status 1
     C                     MOVEL*BLANK    WN0546  1        EDI Status 2
     C                     MOVEL*BLANK    WN0547  1        EDI Status 3
     C                     MOVEL*BLANK    WN0548  1        Record Status
     C                     Z-ADD*ZERO     WN0549  60       Job Time
     C                     MOVEL*BLANK    WN0550 10        User Id
     C                     MOVEL*BLANK    WN0551 10        Job Name
     C                     Z-ADD*ZERO     WN0552  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWYAIC3    TAAIC3           Company Number
     C                     MOVELWYV5ST    TAV5ST    P      Production Type
     C                     Z-ADDWYELDT    TAELDT           Production Date
     C                     Z-ADDWYHGCD    TAHGCD           Item Code
     C                     MOVELWYAJCD    TAAJCD    P      Warehouse Code
      *
     C           KLCHNA    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAV5ST           Production Type
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C           KLCHNA    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YIRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0404    TAF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0407    TADXWG           PS Weight Stand
     C                     Z-ADDWN0408    TAB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0553  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0554  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0555  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0556  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0557  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0558  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0559  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0560  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0561  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0562  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0563  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0564  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0565  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0566  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0567  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0568  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0569  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0570  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0571  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0572  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0573  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0574  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0575  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0576 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0577  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0578 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0579  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0580 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0581  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0582 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0583  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0584 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0585  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0586 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0587  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0588  3        PS Item Id
     C                     MOVEL*BLANK    WN0589  2        Warehouse Type
     C                     MOVEL*BLANK    WN0590  1        PS Lock Status
     C                     MOVEL*BLANK    WN0591  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0592  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0593  1        PS Piece Count
     C                     MOVEL*BLANK    WN0594  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0595  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0596  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0597  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0598  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0599  3        PS Production W
     C                     Z-ADD*ZERO     WN0600  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0601  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0602  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0603  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0604  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0605  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0606  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0607  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0608  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0609  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0610  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0611  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0612  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0613  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0614  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0615  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0616  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0617  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0618  6        Department Code
     C                     Z-ADD*ZERO     WN0619  30       Item Structure
     C                     Z-ADD*ZERO     WN0620  30       Item Structure
     C                     Z-ADD*ZERO     WN0621  30       Item Structure
     C                     MOVEL*BLANK    WN0622  6        Primal Group Co
     C                     MOVEL*BLANK    WN0623  1        EDI Status 1
     C                     MOVEL*BLANK    WN0624  1        EDI Status 2
     C                     MOVEL*BLANK    WN0625  1        EDI Status 3
     C                     MOVEL*BLANK    WN0626  1        Record Status
     C                     Z-ADD*ZERO     WN0627  60       Job Time
     C                     MOVEL*BLANK    WN0628 10        User Id
     C                     MOVEL*BLANK    WN0629 10        Job Name
     C                     Z-ADD*ZERO     WN0630  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYV5ST           Production Type
     C                     KFLD           WYELDT           Production Date
     C                     KFLD           WYHGCD           Item Code
     C                     KFLD           WYAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0273    WYAIC3           Company Number
     C                     MOVELWL0274    WYV5ST           Production Type
     C                     Z-ADDWL0275    WYELDT           Production Date
     C                     Z-ADDWL0276    WYHGCD           Item Code
     C                     MOVELWL0277    WYAJCD           Warehouse Code
      * Establish starting position
     C           KRSNB     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0278    WN0572           PS Weight Prod
     C                     Z-ADDWL0279    WN0573           PS Pieces Prod
      * CASE: PAR.PS Pieces Prod Allocated is GT Zero
     C           WN0573    IFGT 0                          *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Prod Allocated
     C           WN0572    DIV  WN0573    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0557           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0273    WL0179           Company Number
     C                     MOVELWL0274    WL0180    P      Production Type
     C                     Z-ADDWL0275    WL0181           Production Date
     C                     Z-ADDWL0276    WL0182           Item Code
     C                     MOVELWL0277    WL0183    P      Warehouse Code
     C                     Z-ADDWN0553    WL0184           PS Available Sh
     C                     Z-ADDWN0554    WL0185           PS Weight Plann
     C                     Z-ADDWN0555    WL0186           PS Pieces Plann
     C                     Z-ADDWN0556    WL0187           PS Pct of Carca
     C                     Z-ADDWN0557    WL0188           PS Avg Piece Wg
     C                     Z-ADDWN0558    WL0189           PS Weight Inv O
     C                     Z-ADDWN0559    WL0190           PS Pieces Inv O
     C                     Z-ADDWN0560    WL0191           PS Weight Stand
     C                     Z-ADDWN0561    WL0192           PS Pieces Stand
     C                     Z-ADDWN0562    WL0193           PS Weight Conve
     C                     Z-ADDWN0563    WL0194           PS Pieces Conve
     C                     Z-ADDWN0564    WL0195           PS Weight Shipp
     C                     Z-ADDWN0565    WL0196           PS Pieces Shipp
     C                     Z-ADDWN0566    WL0197           PS Weight Prod
     C                     Z-ADDWN0567    WL0198           PS Pieces Prod
     C                     Z-ADDWN0568    WL0199           PS Weight Inv A
     C                     Z-ADDWN0569    WL0200           PS Pieces Inv A
     C                     Z-ADDWN0570    WL0201           PS Weight Ship
     C                     Z-ADDWN0571    WL0202           PS Pieces Ship
     C                     Z-ADDWN0572    WL0203           PS Weight Prod
     C                     Z-ADDWN0573    WL0204           PS Pieces Prod
     C                     Z-ADDWN0574    WL0205           PS Weight Inv A
     C                     Z-ADDWN0575    WL0206           PS Pieces Inv A
     C                     Z-ADDWN0576    WL0207           PS Unit Weight
     C                     Z-ADDWN0577    WL0208           PS Pieces Whs T
     C                     Z-ADDWN0578    WL0209           PS Weight Whs T
     C                     Z-ADDWN0579    WL0210           PS Pieces Unuse
     C                     Z-ADDWN0580    WL0211           PS Weight Unuse
     C                     Z-ADDWN0581    WL0212           PS Pieces Unuse
     C                     Z-ADDWN0582    WL0213           PS Weight Unuse
     C                     Z-ADDWN0583    WL0214           PS Pieces Unuse
     C                     Z-ADDWN0584    WL0215           PS Weight Unuse
     C                     Z-ADDWN0585    WL0216           PS Pieces Unuse
     C                     Z-ADDWN0586    WL0217           PS Weight Unuse
     C                     Z-ADDWN0587    WL0218           PS Pieces Unuse
     C                     MOVELWN0588    WL0219    P      PS Item Id
     C                     MOVELWN0589    WL0220    P      Warehouse Type
     C                     MOVELWN0590    WL0221    P      PS Lock Status
     C                     MOVELWN0591    WL0222    P      PS Export/Domes
     C                     MOVELWN0592    WL0223    P      PS Print On Sch
     C                     MOVELWN0593    WL0224    P      PS Piece Count
     C                     MOVELWN0594    WL0225    P      PS Unused Sts 1
     C                     MOVELWN0595    WL0226    P      PS Unused Sts 2
     C                     MOVELWN0596    WL0227    P      PS Unused Sts 3
     C                     MOVELWN0597    WL0228    P      PS Unused Sts 4
     C                     MOVELWN0598    WL0229    P      PS Item Sched N
     C                     MOVELWN0599    WL0230    P      PS Production W
     C                     Z-ADDWN0600    WL0231           PS Weight Order
     C                     Z-ADDWN0601    WL0232           PS Pieces Order
     C                     Z-ADDWN0602    WL0233           PS Weight FC Ad
     C                     Z-ADDWN0603    WL0234           PS Pieces FC Ad
     C                     Z-ADDWN0604    WL0235           PS Weight FX Ad
     C                     Z-ADDWN0605    WL0236           PS Pieces FX Ad
     C                     Z-ADDWN0606    WL0237           PS Weight Sched
     C                     Z-ADDWN0607    WL0238           PS Pieces Sched
     C                     Z-ADDWN0608    WL0239           PS Weight Avail
     C                     Z-ADDWN0609    WL0240           PS Pieces Avail
     C                     Z-ADDWN0610    WL0241           PS Weight Produ
     C                     Z-ADDWN0611    WL0242           PS Pieces Produ
     C                     Z-ADDWN0612    WL0243           PS Weight Fab N
     C                     Z-ADDWN0613    WL0244           PS Pieces Fab N
     C                     Z-ADDWN0614    WL0245           PS Weight Sched
     C                     Z-ADDWN0615    WL0246           PS Pieces Sched
     C                     Z-ADDWN0616    WL0247           PS Weight Sched
     C                     Z-ADDWN0617    WL0248           PS Pieces Sched
     C                     MOVELWN0618    WL0249    P      Department Code
     C                     Z-ADDWN0619    WL0250           Item Structure
     C                     Z-ADDWN0620    WL0251           Item Structure
     C                     Z-ADDWN0621    WL0252           Item Structure
     C                     MOVELWN0622    WL0253    P      Primal Group Co
     C                     MOVELWN0623    WL0254    P      EDI Status 1
     C                     MOVELWN0624    WL0255    P      EDI Status 2
     C                     MOVELWN0625    WL0256    P      EDI Status 3
     C                     MOVELWN0626    WL0257    P      Record Status
     C                     Z-ADDWN0627    WL0258           Job Time
     C                     MOVELWN0628    WL0259    P      User Id
     C                     MOVELWN0629    WL0260    P      Job Name
     C                     Z-ADDWN0630    WL0261           Job Date
     C                     EXSR TWCRRC
      * FP1054 create consumed records
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0280    IFGT 0                          *IF
      * RMC 10-05 20 use ord co instead of par.company which is acctng
      * RTV Company for Ord   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0280    WL0285           Order Number
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0284    YL0071           Company Number
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0071    WL0286           Company Number
     C                     Z-ADDWL0280    WL0287           Order Number
     C                     Z-ADDWL0281    WL0288           Order Sequence
     C                     Z-ADDWL0282    WL0289           Order Secondary
     C                     Z-ADDWL0275    WL0290           OD Production D
     C                     Z-ADDYL0072    WL0291           ODS Sequence Nu
     C                     Z-ADDWL0276    WL0292           Consumed Item C
     C                     Z-ADDWL0276    WL0293           Item Code
     C                     EXSR NDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0291    YL0072           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0072    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0071    WL0294           Company Number
     C                     Z-ADDWL0280    WL0295           Order Number
     C                     Z-ADDWL0281    WL0296           Order Sequence
     C                     Z-ADDWL0282    WL0297           Order Secondary
     C                     Z-ADDWL0275    WL0298           OD Production D
     C                     Z-ADDYL0072    WL0299           ODS Sequence Nu
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0299    YL0072           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0071    WL0300           Company Number
     C                     Z-ADDWL0280    WL0301           Order Number
     C                     Z-ADDWL0281    WL0302           Order Sequence
     C                     Z-ADDWL0282    WL0303           Order Secondary
     C                     Z-ADDWL0275    WL0304           OD Production D
     C                     Z-ADDYL0072    WL0305           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0306           Scheduled Ship
     C                     MOVELWL0277    WL0307    P      Warehouse Code
     C                     Z-ADDWL0276    WL0308           Consumed Item C
     C                     Z-ADDWL0276    WL0309           Item Code
     C                     Z-ADDWL0279    WL0310           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0278    WL0311           OD Weight Sched
     C                     Z-ADD*ZERO     WL0312           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0313           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0314           Deadline Depart
     C                     Z-ADD*ZERO     WL0315           Deadline Depart
     C                     EXSR NFRVGN
     C                     END                             *FI
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WYOAWT    ADD  WL0278    WN0572           PS Weight Prod
     C           WYCDNB    ADD  WL0279    WN0573           PS Pieces Prod
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
     C                     EXSR NICHRC
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
      * CASE: PAR.Status Flag 19 Y/N is Yes
     C           WL0283    IFEQ 'Y'                        *IF
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0280    IFGT 0                          *IF
      * RMC 10-05-2020 was par.company number which is acctng
      * RTV Company for Ord   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0280    WL0285           Order Number
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0284    YL0071           Company Number
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0071    WL0286           Company Number
     C                     Z-ADDWL0280    WL0287           Order Number
     C                     Z-ADDWL0281    WL0288           Order Sequence
     C                     Z-ADDWL0282    WL0289           Order Secondary
     C                     Z-ADDWL0275    WL0290           OD Production D
     C                     Z-ADDYL0072    WL0291           ODS Sequence Nu
     C                     Z-ADDWL0276    WL0292           Consumed Item C
     C                     Z-ADDWL0276    WL0293           Item Code
     C                     EXSR NDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0291    YL0072           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0072    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0071    WL0294           Company Number
     C                     Z-ADDWL0280    WL0295           Order Number
     C                     Z-ADDWL0281    WL0296           Order Sequence
     C                     Z-ADDWL0282    WL0297           Order Secondary
     C                     Z-ADDWL0275    WL0298           OD Production D
     C                     Z-ADDYL0072    WL0299           ODS Sequence Nu
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0299    YL0072           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0071    WL0300           Company Number
     C                     Z-ADDWL0280    WL0301           Order Number
     C                     Z-ADDWL0281    WL0302           Order Sequence
     C                     Z-ADDWL0282    WL0303           Order Secondary
     C                     Z-ADDWL0275    WL0304           OD Production D
     C                     Z-ADDYL0072    WL0305           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0306           Scheduled Ship
     C                     MOVELWL0277    WL0307    P      Warehouse Code
     C                     Z-ADDWL0276    WL0308           Consumed Item C
     C                     Z-ADDWL0276    WL0309           Item Code
     C                     Z-ADDWL0279    WL0310           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0278    WL0311           OD Weight Sched
     C                     Z-ADD*ZERO     WL0312           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0313           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0314           Deadline Depart
     C                     Z-ADD*ZERO     WL0315           Deadline Depart
     C                     EXSR NFRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV Company for Ord   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDC4NB    WQNC01           Order Number
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Order Number
      * Setup key
     C                     Z-ADDWL0285    WQNC01           Order Number
      * Establish starting position
     C           KRSNC     SETLL@BFCPY2                    *
     C           KRSNC     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTDAIC3    WL0284           Company Number
     C           KRSNC     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0291           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN TIAIC3    WQND01           Company Number
     C           *LIKE     DEFN TIC4NB    WQND02           Order Number
     C           *LIKE     DEFN TIDPNB    WQND03           Order Sequence
     C           *LIKE     DEFN TIUENB    WQND04           Order Secondary
     C           *LIKE     DEFN TIJGDT    WQND05           OD Production D
     C           *LIKE     DEFN TINUDT    WQND06           Consumed Item C
     C           *LIKE     DEFN TIHGCD    WQND07           Item Code
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           Company Number
     C                     KFLD           WQND02           Order Number
     C                     KFLD           WQND03           Order Sequence
     C                     KFLD           WQND04           Order Secondary
     C                     KFLD           WQND05           OD Production D
     C                     KFLD           WQND06           Consumed Item C
     C                     KFLD           WQND07           Item Code
      * Setup key
     C                     Z-ADDWL0286    WQND01           Company Number
     C                     Z-ADDWL0287    WQND02           Order Number
     C                     Z-ADDWL0288    WQND03           Order Sequence
     C                     Z-ADDWL0289    WQND04           Order Secondary
     C                     Z-ADDWL0290    WQND05           OD Production D
     C                     Z-ADDWL0292    WQND06           Consumed Item C
     C                     Z-ADDWL0293    WQND07           Item Code
      * Establish starting position
     C           KRSND     SETLL@B6CPAG                    *
     C           KRSND     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDTIOONY    WL0291           ODS Sequence Nu
     C           KRSND     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0299           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQNE01           Company Number
     C           *LIKE     DEFN WFC4NB    WQNE02           Order Number
     C           *LIKE     DEFN WFDPNB    WQNE03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQNE04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQNE05           OD Production D
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE01           Company Number
     C                     KFLD           WQNE02           Order Number
     C                     KFLD           WQNE03           Order Sequence
     C                     KFLD           WQNE04           Order Secondary
     C                     KFLD           WQNE05           OD Production D
      * Setup key
     C                     Z-ADDWL0294    WQNE01           Company Number
     C                     Z-ADDWL0295    WQNE02           Order Number
     C                     Z-ADDWL0296    WQNE03           Order Sequence
     C                     Z-ADDWL0297    WQNE04           Order Secondary
     C                     Z-ADDWL0298    WQNE05           OD Production D
      * Establish starting position
     C           KRSNE     SETLL@B6CPNB                    *
     C           KRSNE     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWFOONY    WL0299           ODS Sequence Nu
     C           KRSNE     READE@B6CPNB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WL0299           ODS Sequence Nu
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0631  1        EDI Status 1
     C                     MOVEL*BLANK    WN0632  1        EDI Status 2
     C                     MOVEL*BLANK    WN0633  1        EDI Status 3
     C                     MOVEL*BLANK    WN0634  1        Record Status
     C                     Z-ADD*ZERO     WN0635  60       Job Time
     C                     MOVEL*BLANK    WN0636 10        User Id
     C                     MOVEL*BLANK    WN0637 10        Job Name
     C                     Z-ADD*ZERO     WN0638  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C                     KFLD           WFOONY           ODS Sequence Nu
      * Setup key
     C                     Z-ADDWL0300    WFAIC3           Company Number
     C                     Z-ADDWL0301    WFC4NB           Order Number
     C                     Z-ADDWL0302    WFDPNB           Order Sequence
     C                     Z-ADDWL0303    WFUENB           Order Secondary
     C                     Z-ADDWL0304    WFJGDT           OD Production D
     C                     Z-ADDWL0305    WFOONY           ODS Sequence Nu
      * Establish starting position
     C           KRSNF     CHAIN@B6CPNB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3152' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.OD Pieces Scheduled is Greater than zero
      *   |- c2    : PAR.OD Weight Scheduled is Greater than zero
      *   '-
     C           WL0310    IFGT 0                          *IF
     C           WL0311    ORGT 0                          *OR
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
     C                     EXSR NGCRRC
     C                     END                             *FI
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFFLWG    ADD  WL0311    YL0073           OD Weight Sched
     C           WFIGQT    ADD  WL0310    YL0074           OD Qty/Cnsmd Pi
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.OD Pieces Scheduled is Less than or equal zero
      *   |- c2    : LCL.OD Weight Scheduled is Less than or equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0074    IFLE 0                          *IF
     C           YL0073    IFLE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0016           Company Number
     C                     Z-ADDWFC4NB    WL0017           Order Number
     C                     Z-ADDWFDPNB    WL0018           Order Sequence
     C                     Z-ADDWFUENB    WL0019           Order Secondary
     C                     Z-ADDWFJGDT    WL0020           OD Production D
     C                     Z-ADDWFOONY    WL0021           ODS Sequence Nu
     C                     EXSR SHDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
     C                     EXSR NHCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCRRC    BEGSR
      *================================================================
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPNA
     C                     Z-ADDWL0300    WGAIC3           Company Number
     C                     Z-ADDWL0301    WGC4NB           Order Number
     C                     Z-ADDWL0302    WGDPNB           Order Sequence
     C                     Z-ADDWL0303    WGUENB           Order Secondary
     C                     Z-ADDWL0304    WGJGDT           OD Production D
     C                     Z-ADDWL0305    WGOONY           ODS Sequence Nu
     C                     Z-ADDWL0306    WGAODT           Scheduled Ship
     C                     MOVELWL0307    WGAJCD           Warehouse Code
     C                     Z-ADDWL0308    WGNUDT           Consumed Item C
     C                     Z-ADDWL0309    WGHGCD           Item Code
     C                     Z-ADDWL0310    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0311    WGFLWG           OD Weight Sched
     C                     Z-ADDWL0312    WGNSQT           ODS Quantity Sh
     C                     Z-ADDWL0313    WGJQWG           ODS Weight Shor
     C                     Z-ADDWL0314    WGNVDT           Deadline Depart
     C                     Z-ADDWL0315    WGBUTM           Deadline Depart
     C                     MOVELWN0631    WGUVST           EDI Status 1
     C                     MOVELWN0632    WGUWST           EDI Status 2
     C                     MOVELWN0633    WGUXST           EDI Status 3
     C                     MOVELWN0634    WGVSST           Record Status
     C                     Z-ADDWN0635    WGAATM           Job Time
     C                     MOVELWN0636    WGAYNA           User Id
     C                     MOVELWN0637    WGA0NA           Job Name
     C                     Z-ADDWN0638    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRNG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
      * Check for duplicate primary key
     C           KLCRNG    SETLL@B6CPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3153' W0RTN   7
      * Send message 'Order Detail Sched-Con EX'
     C                     MOVEL'USR3153' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHCHRC    BEGSR
      *================================================================
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0639  1        EDI Status 1
     C                     MOVEL*BLANK    WN0640  1        EDI Status 2
     C                     MOVEL*BLANK    WN0641  1        EDI Status 3
     C                     MOVEL*BLANK    WN0642  1        Record Status
     C                     Z-ADD*ZERO     WN0643  60       Job Time
     C                     MOVEL*BLANK    WN0644 10        User Id
     C                     MOVEL*BLANK    WN0645 10        Job Name
     C                     Z-ADD*ZERO     WN0646  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @B6CPNA
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     Z-ADDWFJGDT    WGJGDT           OD Production D
     C                     Z-ADDWFOONY    WGOONY           ODS Sequence Nu
      *
     C           KLCHNH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLCHNH    CHAIN@B6CPNA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB61    YJRDCS
      * Move non-key fields to @B6CPNA
     C                     Z-ADDWL0306    WGAODT           Scheduled Ship
     C                     MOVELWL0307    WGAJCD    P      Warehouse Code
     C                     Z-ADDWL0308    WGNUDT           Consumed Item C
     C                     Z-ADDWL0309    WGHGCD           Item Code
     C                     Z-ADDYL0074    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDYL0073    WGFLWG           OD Weight Sched
     C                     Z-ADDWFNSQT    WGNSQT           ODS Quantity Sh
     C                     Z-ADDWFJQWG    WGJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@B6CPNA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NICHRC    BEGSR
      *================================================================
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0647  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0648  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0649  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0650  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0651  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0652  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0653  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0654  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0655  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0656  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0657  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0658  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0659  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0660  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0661  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0662  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0663  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0664  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0665  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0666  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0667 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0668  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0669 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0670  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0671 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0672  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0673 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0674  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0675 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0676  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0677 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0678  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0679  3        PS Item Id
     C                     MOVEL*BLANK    WN0680  2        Warehouse Type
     C                     MOVEL*BLANK    WN0681  1        PS Lock Status
     C                     MOVEL*BLANK    WN0682  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0683  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0684  1        PS Piece Count
     C                     MOVEL*BLANK    WN0685  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0686  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0687  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0688  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0689  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0690  3        PS Production W
     C                     Z-ADD*ZERO     WN0691  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0692  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0693  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0694  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0695  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0696  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0697  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0698  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0699  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0700  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0701  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0702  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0703  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0704  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0705  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0706  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0707  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0708  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0709  6        Department Code
     C                     Z-ADD*ZERO     WN0710  30       Item Structure
     C                     Z-ADD*ZERO     WN0711  30       Item Structure
     C                     Z-ADD*ZERO     WN0712  30       Item Structure
     C                     MOVEL*BLANK    WN0713  6        Primal Group Co
     C                     MOVEL*BLANK    WN0714  1        EDI Status 1
     C                     MOVEL*BLANK    WN0715  1        EDI Status 2
     C                     MOVEL*BLANK    WN0716  1        EDI Status 3
     C                     MOVEL*BLANK    WN0717  1        Record Status
     C                     Z-ADD*ZERO     WN0718  60       Job Time
     C                     MOVEL*BLANK    WN0719 10        User Id
     C                     MOVEL*BLANK    WN0720 10        Job Name
     C                     Z-ADD*ZERO     WN0721  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWYAIC3    TAAIC3           Company Number
     C                     MOVELWYV5ST    TAV5ST    P      Production Type
     C                     Z-ADDWYELDT    TAELDT           Production Date
     C                     Z-ADDWYHGCD    TAHGCD           Item Code
     C                     MOVELWYAJCD    TAAJCD    P      Warehouse Code
      *
     C           KLCHNI    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAV5ST           Production Type
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C           KLCHNI    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YKRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWYF8WG    TAF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0572    TAOAWT           PS Weight Prod
     C                     Z-ADDWN0573    TACDNB           PS Pieces Prod
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TJAIC3    WQNJ01           Company Number
      * Define keylist
     C           KPSNJ     KLIST
     C                     KFLD           WQNJ01           Company Number
     C                     KFLD           TJBCDT           Post to G/L Dat
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           WQNJ01           Company Number
      * Setup key
     C                     Z-ADDWL0316    WQNJ01           Company Number
     C                     Z-ADDWL0317    TJBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSNJ     SETLL@AFREPU                    *
     C           KRSNJ     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0317    IFEQ TJBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0320                     *IF
     C                     Z-ADDTJBCDT    WL0318           *Date1 (ending)
     C                     GOTO NJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNJ     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQNK01           Company Number
      * Define keylist
     C           KPSNK     KLIST
     C                     KFLD           WQNK01           Company Number
     C                     KFLD           TFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WQNK01           Company Number
      * Setup key
     C                     Z-ADDWL0321    WQNK01           Company Number
     C                     Z-ADDWL0322    TFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSNK     SETLL@AFREYY                    *
     C           KRSNK     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0322    IFEQ TFBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0325                     *IF
     C                     Z-ADDTFBCDT    WL0323           *Date1 (ending)
     C                     GOTO NKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNK     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * Chg Qty/WgtSch & Shrt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0770  70       Item Code
     C                     MOVEL*BLANK    WN0771  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0772  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0773  70       Order Group Cod
     C                     MOVEL*BLANK    WN0774  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0775  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0776 112       Billing Detail
     C                     Z-ADD*ZERO     WN0777 112       Billing Detail
     C                     Z-ADD*ZERO     WN0778 112       Billing Detail
     C                     Z-ADD*ZERO     WN0779 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0780  1        Comment Print A
     C                     MOVEL*BLANK    WN0781  1        Comment Print I
     C                     MOVEL*BLANK    WN0782  1        Comment Print P
     C                     MOVEL*BLANK    WN0783  1        Comment Print S
     C                     Z-ADD*ZERO     WN0784 112       Extended Amount
     C                     Z-ADD*ZERO     WN0785  70       Market Pricing
     C                     MOVEL*BLANK    WN0786  3        Commodity Marke
     C                     MOVEL*BLANK    WN0787  3        Date Method Cod
     C                     MOVEL*BLANK    WN0788  3        Price Method Co
     C                     Z-ADD*ZERO     WN0789 114       Price Overage O
     C                     Z-ADD*ZERO     WN0790  70       Contract Number
     C                     MOVEL*BLANK    WN0791  1        Price Status
     C                     Z-ADD*ZERO     WN0792  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0793  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0794  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0795  1        Work Confirm St
     C                     MOVEL*BLANK    WN0796  1        Work Over/Short
     C                     MOVEL*BLANK    WN0797  1        OD Production P
     C                     MOVEL*BLANK    WN0798 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0799 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0800  1        Age Code
     C                     MOVEL*BLANK    WN0801  1        Palletize
     C                     MOVEL*BLANK    WN0802  1        Slip Sheet
     C                     MOVEL*BLANK    WN0803  1        Catch Weight St
     C                     MOVEL*BLANK    WN0804  1        Price Audit
     C                     MOVEL*BLANK    WN0805  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0806  1        Production Date
     C                     Z-ADD*ZERO     WN0807 112       Rated Freight
     C                     Z-ADD*ZERO     WN0808 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0809 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0810 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0811 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0812 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0813 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0814 114       Unit Price
     C                     Z-ADD*ZERO     WN0815 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0816 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0817 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0818 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0819  70       Requested Ship
     C                     Z-ADD*ZERO     WN0820  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0821  70       Actual Shipped
     C                     MOVEL*BLANK    WN0822  1        Affect Inventor
     C                     MOVEL*BLANK    WN0823  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0824  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0825  30       Item Structure
     C                     Z-ADD*ZERO     WN0826  30       Item Structure
     C                     Z-ADD*ZERO     WN0827  30       Item Structure
     C                     MOVEL*BLANK    WN0828  2        Item Level
     C                     MOVEL*BLANK    WN0829  2        Quality Level
     C                     MOVEL*BLANK    WN0830  2        Pricing Product
     C                     MOVEL*BLANK    WN0831  2        Season Product
     C                     Z-ADD*ZERO     WN0832  70       Date of Origina
     C                     MOVEL*BLANK    WN0833 10        User Profile Na
     C                     MOVEL*BLANK    WN0834  6        Country Code
     C                     MOVEL*BLANK    WN0835  2        Event Code
     C                     MOVEL*BLANK    WN0836  3        Reason Code
     C                     MOVEL*BLANK    WN0837  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0838  1        Modified Flag
     C                     MOVEL*BLANK    WN0839  1        Substituted Fla
     C                     MOVEL*BLANK    WN0840  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0841 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0842 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0843  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0844  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0845  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0846  1        Affect Commissi
     C                     MOVEL*BLANK    WN0847  1        Affect Pricing
     C                     MOVEL*BLANK    WN0848  1        Released by Use
     C                     MOVEL*BLANK    WN0849  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0850  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0851  3        Production Ware
     C                     MOVEL*BLANK    WN0852  3        OD Price Type
     C                     Z-ADD*ZERO     WN0853  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0854  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0855  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0856  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0857  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0858  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0859  60       Price Code
     C                     Z-ADD*ZERO     WN0860  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0861  60       Substitution Li
     C                     Z-ADD*ZERO     WN0862  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0863 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0864 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0865 112       OD Item Target
     C                     Z-ADD*ZERO     WN0866 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0867 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0868 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0869 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0870 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0871 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0872 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0873 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0874 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0875 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0876  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0877  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0878  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0879 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0880  40       Item Age Days
     C                     Z-ADD*ZERO     WN0881  70       Production Ovr
     C                     Z-ADD*ZERO     WN0882  70       Production Ovr
     C                     MOVEL*BLANK    WN0883  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0884  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0885  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0886  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0887  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0888  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0889  1        EDI Status 1
     C                     MOVEL*BLANK    WN0890  1        EDI Status 2
     C                     MOVEL*BLANK    WN0891  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0892  60       Job Time
     C                     MOVEL*BLANK    WN0893 10        User Id
     C                     MOVEL*BLANK    WN0894 10        Job Name
     C                     Z-ADD*ZERO     WN0895  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWTAIC3    TKAIC3           Company Number
     C                     Z-ADDWTC4NB    TKC4NB           Order Number
     C                     Z-ADDWTDPNB    TKDPNB           Order Sequence
     C                     Z-ADDWTUENB    TKUENB           Order Secondary
      *
     C           KLCHNL    KLIST
     C                     KFLD           TKAIC3           Company Number
     C                     KFLD           TKC4NB           Order Number
     C                     KFLD           TKDPNB           Order Sequence
     C                     KFLD           TKUENB           Order Secondary
     C           KLCHNL    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YLRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0036    TKCCQT           Quantity Schedu
     C                     Z-ADDYL0037    TKAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     TKAATM           Job Time
     C                     MOVEL##USR     TKAYNA           User Id
     C                     MOVEL##PGM     TKA0NA           Job Name
     C                     Z-ADD##JDT     TKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQNM01           Company Number
     C           *LIKE     DEFN WCC4NB    WQNM02           Order Number
     C           *LIKE     DEFN WCDPNB    WQNM03           Order Sequence
     C           *LIKE     DEFN WCUENB    WQNM04           Order Secondary
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WQNM01           Company Number
     C                     KFLD           WQNM02           Order Number
     C                     KFLD           WQNM03           Order Sequence
     C                     KFLD           WQNM04           Order Secondary
      * Setup key
     C                     Z-ADDWL0326    WQNM01           Company Number
     C                     Z-ADDWL0327    WQNM02           Order Number
     C                     Z-ADDWL0328    WQNM03           Order Sequence
     C                     Z-ADDWL0329    WQNM04           Order Secondary
      * Establish starting position
     C           KRSNM     SETLL@KNCPHO                    *
     C           KRSNM     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0011           Company Number
     C                     Z-ADDWCC4NB    WL0012           Order Number
     C                     Z-ADDWCDPNB    WL0013           Order Sequence
     C                     Z-ADDWCUENB    WL0014           Order Secondary
     C                     Z-ADDWCJGDT    WL0015           OD Production D
     C                     EXSR SFDLRC
     C           KRSNM     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * Rtv User Rls Override RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0330    WTAIC3           Company Number
     C                     Z-ADDWL0331    WTC4NB           Order Number
     C                     Z-ADDWL0332    WTDPNB           Order Sequence
     C                     Z-ADDWL0333    WTUENB           Order Secondary
      * Establish starting position
     C           KRSNN     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0334           Released by Use
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTF3SX    WL0334           Released by Use
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0896  70       Item Code
     C                     MOVEL*BLANK    WN0897  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0898  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0899  70       Order Group Cod
     C                     MOVEL*BLANK    WN0900  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0901  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0902 112       Billing Detail
     C                     Z-ADD*ZERO     WN0903 112       Billing Detail
     C                     Z-ADD*ZERO     WN0904 112       Billing Detail
     C                     Z-ADD*ZERO     WN0905 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0906  1        Comment Print A
     C                     MOVEL*BLANK    WN0907  1        Comment Print I
     C                     MOVEL*BLANK    WN0908  1        Comment Print P
     C                     MOVEL*BLANK    WN0909  1        Comment Print S
     C                     Z-ADD*ZERO     WN0910 112       Extended Amount
     C                     Z-ADD*ZERO     WN0911  70       Market Pricing
     C                     MOVEL*BLANK    WN0912  3        Commodity Marke
     C                     MOVEL*BLANK    WN0913  3        Date Method Cod
     C                     MOVEL*BLANK    WN0914  3        Price Method Co
     C                     Z-ADD*ZERO     WN0915 114       Price Overage O
     C                     Z-ADD*ZERO     WN0916  70       Contract Number
     C                     MOVEL*BLANK    WN0917  1        Price Status
     C                     Z-ADD*ZERO     WN0918  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0919  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0920  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0921  1        Work Confirm St
     C                     MOVEL*BLANK    WN0922  1        Work Over/Short
     C                     MOVEL*BLANK    WN0923  1        OD Production P
     C                     MOVEL*BLANK    WN0924 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0925 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0926  1        Age Code
     C                     MOVEL*BLANK    WN0927  1        Palletize
     C                     MOVEL*BLANK    WN0928  1        Slip Sheet
     C                     MOVEL*BLANK    WN0929  1        Catch Weight St
     C                     MOVEL*BLANK    WN0930  1        Price Audit
     C                     MOVEL*BLANK    WN0931  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0932  1        Production Date
     C                     Z-ADD*ZERO     WN0933 112       Rated Freight
     C                     Z-ADD*ZERO     WN0934 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0935 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0936 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0937 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0938 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0939 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0940 114       Unit Price
     C                     Z-ADD*ZERO     WN0941 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0942 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0943 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0944 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0945  70       Requested Ship
     C                     Z-ADD*ZERO     WN0946  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0947  70       Actual Shipped
     C                     MOVEL*BLANK    WN0948  1        Affect Inventor
     C                     MOVEL*BLANK    WN0949  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0950  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0951  30       Item Structure
     C                     Z-ADD*ZERO     WN0952  30       Item Structure
     C                     Z-ADD*ZERO     WN0953  30       Item Structure
     C                     MOVEL*BLANK    WN0954  2        Item Level
     C                     MOVEL*BLANK    WN0955  2        Quality Level
     C                     MOVEL*BLANK    WN0956  2        Pricing Product
     C                     MOVEL*BLANK    WN0957  2        Season Product
     C                     Z-ADD*ZERO     WN0958  70       Date of Origina
     C                     MOVEL*BLANK    WN0959 10        User Profile Na
     C                     MOVEL*BLANK    WN0960  6        Country Code
     C                     MOVEL*BLANK    WN0961  2        Event Code
     C                     MOVEL*BLANK    WN0962  3        Reason Code
     C                     MOVEL*BLANK    WN0963  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0964  1        Modified Flag
     C                     MOVEL*BLANK    WN0965  1        Substituted Fla
     C                     MOVEL*BLANK    WN0966  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0967 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0968 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0969  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0970  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0971  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0972  1        Affect Commissi
     C                     MOVEL*BLANK    WN0973  1        Affect Pricing
     C                     MOVEL*BLANK    WN0974  1        Released by Use
     C                     MOVEL*BLANK    WN0975  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0976  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0977  3        Production Ware
     C                     MOVEL*BLANK    WN0978  3        OD Price Type
     C                     Z-ADD*ZERO     WN0979  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0980  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0981  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0982  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0983  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0984  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0985  60       Price Code
     C                     Z-ADD*ZERO     WN0986  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0987  60       Substitution Li
     C                     Z-ADD*ZERO     WN0988  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0989 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0990 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0991 112       OD Item Target
     C                     Z-ADD*ZERO     WN0992 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0993 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0994 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0995 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0996 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0997 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0998 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0999 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1000 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1001 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1002  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1003  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1004  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1005 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1006  40       Item Age Days
     C                     Z-ADD*ZERO     WN1007  70       Production Ovr
     C                     Z-ADD*ZERO     WN1008  70       Production Ovr
     C                     MOVEL*BLANK    WN1009  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1010  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1011  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1012  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1013  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1014  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1015  1        EDI Status 1
     C                     MOVEL*BLANK    WN1016  1        EDI Status 2
     C                     MOVEL*BLANK    WN1017  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1018  60       Job Time
     C                     MOVEL*BLANK    WN1019 10        User Id
     C                     MOVEL*BLANK    WN1020 10        Job Name
     C                     Z-ADD*ZERO     WN1021  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0335    TKAIC3           Company Number
     C                     Z-ADDWL0336    TKC4NB           Order Number
     C                     Z-ADDWL0337    TKDPNB           Order Sequence
     C                     Z-ADDWL0338    TKUENB           Order Secondary
      *
     C           KLCHNO    KLIST
     C                     KFLD           TKAIC3           Company Number
     C                     KFLD           TKC4NB           Order Number
     C                     KFLD           TKDPNB           Order Sequence
     C                     KFLD           TKUENB           Order Secondary
     C           KLCHNO    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YMRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0339    TKCCQT           Quantity Schedu
     C                     Z-ADDWL0340    TKAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     TKAATM           Job Time
     C                     MOVEL##USR     TKAYNA           User Id
     C                     MOVEL##PGM     TKA0NA           Job Name
     C                     Z-ADD##JDT     TKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCHRC    BEGSR
      *================================================================
      * Chg New Prod Hold Sts CH - Order Detail Build Sched  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1022  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1023  1        ODBS Partial Pi
     C                     MOVEL*BLANK    WN1024  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1025  1        Header Status
     C                     MOVEL*BLANK    WN1026  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1027  70       Item Code
     C                     Z-ADD*ZERO     WN1028  70       Consumed Item C
     C                     MOVEL*BLANK    WN1029  3        Warehouse Code
     C                     MOVEL*BLANK    WN1030  1        Age Code
     C                     Z-ADD*ZERO     WN1031 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1032 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1033 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1034 112       Weight Schedule
     C                     MOVEL*BLANK    WN1035  2        Event Code
     C                     Z-ADD*ZERO     WN1036  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1037  60       Deadline Depart
     C                     MOVEL*BLANK    WN1038  2        Warehouse Type
     C                     Z-ADD*ZERO     WN1039  70       Load ID
     C                     MOVEL*BLANK    WN1040  1        Export Status
     C                     Z-ADD*ZERO     WN1041  70       Ship To Custome
     C                     MOVEL*BLANK    WN1042  1        Production Hold
     C                     MOVEL*BLANK    WN1043  1        Credit Hold
     C                     MOVEL*BLANK    WN1044  1        Load Status
     C                     MOVEL*BLANK    WN1045  3        Carrier Code
     C                     Z-ADD*ZERO     WN1046  70       Date of Origina
     C                     Z-ADD*ZERO     WN1047  60       Time of Origina
     C                     MOVEL*BLANK    WN1048  1        ODBS Sched Over
     C                     MOVEL*BLANK    WN1049  2        OD Adj Type
     C                     Z-ADD*ZERO     WN1050  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1051  40       Item Age Days
     C                     Z-ADD*ZERO     WN1052  70       Production Ovr
     C                     Z-ADD*ZERO     WN1053  70       Production Ovr
     C                     Z-ADD*ZERO     WN1054  70       Production AgeD
     C                     Z-ADD*ZERO     WN1055  70       Production AgeD
     C                     MOVEL*BLANK    WN1056  1        ODBS Block Orde
     C                     MOVEL*BLANK    WN1057  2        ODBS Status 2 -
     C                     Z-ADD*ZERO     WN1058  70       Requested Ship
     C                     Z-ADD*ZERO     WN1059  70       ODBS Unused Dat
     C                     Z-ADD*ZERO     WN1060  70       ODBS Unused Dat
     C                     Z-ADD*ZERO     WN1061  70       ODBS Unused Dat
     C                     MOVEL*BLANK    WN1062  1        ODBS Unused Sta
     C                     MOVEL*BLANK    WN1063  1        ODBS Unused Sta
     C                     MOVEL*BLANK    WN1064  2        ODBS Unused Sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @E6CPZT
     C                     Z-ADDWL0341    TLAIC3           Company Number
     C                     Z-ADDWL0342    TLC4NB           Order Number
     C                     Z-ADDWL0343    TLDPNB           Order Sequence
     C                     Z-ADDWL0344    TLUENB           Order Secondary
      *
     C           KLCHNP    KLIST
     C                     KFLD           TLAIC3           Company Number
     C                     KFLD           TLC4NB           Order Number
     C                     KFLD           TLDPNB           Order Sequence
     C                     KFLD           TLUENB           Order Secondary
     C           KLCHNP    CHAIN@E6CPZT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PME6CPL0'MDACP
     C                     MOVEL'@E6CPZT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPME61    YNRDCS
      * Move non-key fields to @E6CPZT
     C                     Z-ADDWL0345    TLOFNY           ODBS New Prod H
     C                     MOVELWL0346    TLR4CD    P      Sales Route Cod
     C                     MOVELWL0347    TLBGCD    P      State Code
     C                     MOVELWL0348    TLX3CD    P      Territory Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPME61    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@E6CPZT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPME6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * BPS Proc ODBS f/Futur RT - Order Detail Build Sched  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * E2885 RMC 01/13/14 Override Sched=Y, THEN DO THEM 1ST HERE BY THE
      * E2885 RMC 12/03/13 Override Sched - if next day ship, reset to bl
      * E2073 RMC 08/01/12 Override Sched - use whs inventory chill to ch
      * E2203 RMC 07/25/12 Override Sched - see if there's inventory
      * E1842 RMC 12/07/11 Read Firm orders before Block Orders
      *        Pick Sts, Whse FZ/FR , Firm/Block, Sched ship, Order#
      * FP1054 Read orders shipping tomorrow or later by:
      *        Pick Sts, Whs FZ/FR, Sched ship, Order#
     C                     Z-ADD*ZERO     YL0083           Company Number
     C                     Z-ADD*ZERO     YL0084           Order Number
     C                     MOVEL'Y'       YL0085           First Time Flag
      * Define keylist
     C           KPSNQ     KLIST
     C                     KFLD           TMDBST           ODBS Partial Pi
     C                     KFLD           TMIIST           ODBS Block Orde
     C                     KFLD           TMWPST           Warehouse Type
     C                     KFLD           TMAODT           Scheduled Ship
     C                     KFLD           TMNVDT           Deadline Depart
     C                     KFLD           TMBUTM           Deadline Depart
     C                     KFLD           TMC4NB           Order Number
     C                     KFLD           TMDPNB           Order Sequence
     C                     KFLD           TMUENB           Order Secondary
      * Initialize key list
     C                     MOVEL*LOVAL    TMDBST           ODBS Partial Pi
     C                     MOVEL*HIVAL    TMIIST           ODBS Block Orde
     C                     MOVEL*HIVAL    TMWPST           Warehouse Type
     C                     MOVEL*LOVAL    TMAODT           Scheduled Ship
     C                     MOVEL*LOVAL    TMNVDT           Deadline Depart
     C                     MOVEL*LOVAL    TMBUTM           Deadline Depart
     C                     MOVEL*LOVAL    TMC4NB           Order Number
     C                     MOVEL*LOVAL    TMDPNB           Order Sequence
     C                     MOVEL*LOVAL    TMUENB           Order Secondary
      * Setup key
      * Establish starting position
     C           KPSNQ     SETLL@E6CPME                    *
     C                     READ @E6CPME                  90*
      * Data record not found
     C   90                MOVEL'USR4107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag is Yes
     C           YL0085    IFEQ 'Y'                        *IF
     C                     MOVEL'SC'      YL0086           ATS Adj Type US
     C                     MOVEL'N'       YL0085           First Time Flag
     C                     END                             *FI
      * CASE: DB1.Scheduled Ship Date LT PAR.Scheduled Ship Date USR
     C           TMAODT    IFLT WL0350                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Select Sched override
      * CASE: PAR.ODBS Sched Override Sts EQ DB1.ODBS Sched Override Sts
     C           WL0349    IFEQ TMDCST                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Process Record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Order Type - Sales is Regular Order
      *   |- c2    : DB1.Order Type - Sales is Transfer Order
      *   '-
     C           TMJNCD    IFEQ 'OR'                       *IF
     C           TMJNCD    OREQ 'TR'                       *OR
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           TMGMST    IFEQ 'X'                        *IF
     C           TMGMST    OREQ 'C'
     C           TMGMST    OREQ 'R'
      * DO NOTHING
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.ODBS Block Order Flag is Block Order
      *   |- c2    : DB1.ODBS Sched Override Sts is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TMIIST    IFEQ 'B'                        *IF
     C           TMDCST    IFEQ *BLANK                     *IF
     C           TMDCST    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * R5947  5/16/16 dont do block yet, just de-allocate
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.ODBS Sched Override Sts EQ WRK.Blank for 3
      *   |- c2    : DB1.ODBS Sched Override Sts is EQ No
      *   '-
     C           TMDCST    IFEQ WUUAT1                     *IF
     C           TMDCST    OREQ 'N'                        *OR
      * Take away from Block orders so Firm orders can take it
      *   if not Override Sched Yes          7/27/12
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0326           Company Number
     C                     Z-ADDTMC4NB    WL0327           Order Number
     C                     Z-ADDTMDPNB    WL0328           Order Sequence
     C                     Z-ADDTMUENB    WL0329           Order Secondary
     C                     EXSR NMRVGN
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0067           Company Number
     C                     Z-ADDTMC4NB    WL0068           Order Number
     C                     Z-ADDTMDPNB    WL0069           Order Sequence
     C                     Z-ADDTMUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
     C                     Z-ADD*ZERO     YL0087           Quantity Schedu
     C                     Z-ADD*ZERO     YL0088           Weight Schedule
      * UPS Re-Alc Inv/Prd OV RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0075           Company Number
     C                     Z-ADDTMC4NB    WL0076           Order Number
     C                     Z-ADDTMDPNB    WL0077           Order Sequence
     C                     Z-ADDTMUENB    WL0078           Order Secondary
     C                     Z-ADDYL0087    WL0079           Quantity Schedu
     C                     Z-ADDYL0088    WL0080           Weight Schedule
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    YL0087           Quantity Schedu
     C                     Z-ADDWL0080    YL0088           Weight Schedule
      * Chg New Prod Hold Sts CH - Order Detail Build Sched  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0341           Company Number
     C                     Z-ADDTMC4NB    WL0342           Order Number
     C                     Z-ADDTMDPNB    WL0343           Order Sequence
     C                     Z-ADDTMUENB    WL0344           Order Secondary
     C                     Z-ADD1         WL0345           ODBS New Prod H
     C                     MOVELTMR4CD    WL0346    P      Sales Route Cod
     C                     MOVELTMBGCD    WL0347    P      State Code
     C                     MOVELTMX3CD    WL0348    P      Territory Code
     C                     EXSR NPCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN1065 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0033           Company Number
     C                     Z-ADDTMHGCD    WL0034           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    WUAVNA    P      Description Lin
     C                     MOVELWL0036    YL0089    P      UOM Primary
     C                     Z-ADDWL0037    YL0090           Unit Weight
     C                     Z-ADDWL0038    WURINB           Item Structure
     C                     Z-ADDWL0039    WURHNB           Item Structure
     C                     Z-ADDWL0040    WURGNB           Item Structure
     C                     MOVELWL0041    WUN0CD    P      Item Type Code
     C                     MOVELWL0042    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0043    YL0091           Fresh Chilling
     C                     MOVELWL0044    YL0092    P      Base_Conv_Loss
     C                     MOVELWL0045    WUXWST    P      Variety_Rendere
     C                     MOVELWL0046    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0047    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0048    YL0093           Pieces Per Head
     C                     MOVELWL0049    WUR3CD    P      Department Code
     C                     MOVELWL0050    WUSDCD    P      Group for Packa
     C                     MOVELWL0051    WUX5ST    P      Seconds Item
     C                     MOVELWL0052    YL0094    P      Piece Count Ite
     C                     Z-ADDWL0053    YL0095           Pieces Per Bag
     C                     Z-ADDWL0054    YL0096           Bags Per Unit
     C                     MOVELWL0055    WUSUST    P      Export_Domestic
     C                     MOVELWL0056    WUSVST    P      Print On Schedu
     C                     MOVELWL0057    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0058    WUSZST    P      Fresh Sched As
     C                     MOVELWL0059    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0060    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTMAJCD    WL0061    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    YL0097    P      Warehouse Type
     C                     MOVELWL0063    WUXUST    P      Trans Contol AS
     C                     MOVELWL0064    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0065    YL0098    P      Warehouse Std C
     C                     Z-ADDWL0066    YL0099           Warehouse Chill
     C                     MOVELTMDCST    YL0100           ODBS Sched Over
      * CASE: LCL.ODBS Sched Override Sts is eq Yes
     C           YL0100    IFEQ 'Y'                        *IF
      * If schedule was overriden in WW Ord Prod Sch POQJDFR, call this
      *  to make the changes stick.
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0067           Company Number
     C                     Z-ADDTMC4NB    WL0068           Order Number
     C                     Z-ADDTMDPNB    WL0069           Order Sequence
     C                     Z-ADDTMUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
      * Rtv & Chg ALC sts    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0071           Company Number
     C                     Z-ADDTMC4NB    WL0072           Order Number
     C                     Z-ADDTMDPNB    WL0073           Order Sequence
     C                     Z-ADDTMUENB    WL0074           Order Secondary
     C                     EXSR SSRVGN
     C                     Z-ADD*ZERO     YL0087           Quantity Schedu
     C                     Z-ADD*ZERO     YL0088           Weight Schedule
      * UPS Re-Alc Inv/Prd OV RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0075           Company Number
     C                     Z-ADDTMC4NB    WL0076           Order Number
     C                     Z-ADDTMDPNB    WL0077           Order Sequence
     C                     Z-ADDTMUENB    WL0078           Order Secondary
     C                     Z-ADDYL0087    WL0079           Quantity Schedu
     C                     Z-ADDYL0088    WL0080           Weight Schedule
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    YL0087           Quantity Schedu
     C                     Z-ADDWL0080    YL0088           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0326           Company Number
     C                     Z-ADDTMC4NB    WL0327           Order Number
     C                     Z-ADDTMDPNB    WL0328           Order Sequence
     C                     Z-ADDTMUENB    WL0329           Order Secondary
     C                     EXSR NMRVGN
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0067           Company Number
     C                     Z-ADDTMC4NB    WL0068           Order Number
     C                     Z-ADDTMDPNB    WL0069           Order Sequence
     C                     Z-ADDTMUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
     C                     Z-ADD*ZERO     YL0087           Quantity Schedu
     C                     Z-ADD*ZERO     YL0088           Weight Schedule
      * When an order is GE the prod date rgt,
      *    Send in the ordered quantity for allocation.
      * When orders are inside the production date rgt,
      *   Send in the sched quantity for allocation.
      * CASE: DB1.Scheduled Ship Date GE PAR.Production Date RGT
     C           TMAODT    IFGE WL0351                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TMAIC3    WQ0173  30       Company Number
     C                     PARM TMC4NB    WQ0174  70       Order Number
     C                     PARM TMDPNB    WQ0175  30       Order Sequence
     C                     PARM TMUENB    WQ0176  30       Order Secondary
     C                     PARM TMHGCD    WQ0177  70       Item Code
     C                     PARM TMAJCD    WQ0178  3        Warehouse Code
     C                     PARM TMA5DT    WQ0179  70       Ship Date USR
     C                     PARM TMAVQT    WQ0180 112       Quantity Ordere
     C                     PARM TMD0WG    WQ0181 112       Weight Ordered
     C           YL0087    PARM YL0087    WQ0182 112       Quantity Schedu
     C           YL0088    PARM YL0088    WQ0183 112       Weight Schedule
     C                     PARM TMDDST    WQ0184  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0185 10        PSAA Program Na
     C                     PARM TMRINY    WQ0186  40       Item Age Days
     C                     PARM TMTIDT    WQ0187  70       Production Ovr
     C                     PARM TMTJDT    WQ0188  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TMAIC3    WQ0189  30       Company Number
     C                     PARM TMC4NB    WQ0190  70       Order Number
     C                     PARM TMDPNB    WQ0191  30       Order Sequence
     C                     PARM TMUENB    WQ0192  30       Order Secondary
     C                     PARM TMHGCD    WQ0193  70       Item Code
     C                     PARM TMAJCD    WQ0194  3        Warehouse Code
     C                     PARM TMA5DT    WQ0195  70       Ship Date USR
     C                     PARM TMAVQT    WQ0196 112       Quantity Ordere
     C                     PARM TMD0WG    WQ0197 112       Weight Ordered
     C           YL0087    PARM YL0087    WQ0198 112       Quantity Schedu
     C           YL0088    PARM YL0088    WQ0199 112       Weight Schedule
     C                     PARM TMDDST    WQ0200  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0201 10        PSAA Program Na
     C                     PARM TMRINY    WQ0202  40       Item Age Days
     C                     PARM TMTIDT    WQ0203  70       Production Ovr
     C                     PARM TMTJDT    WQ0204  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0335           Company Number
     C                     Z-ADDTMC4NB    WL0336           Order Number
     C                     Z-ADDTMDPNB    WL0337           Order Sequence
     C                     Z-ADDTMUENB    WL0338           Order Secondary
     C                     Z-ADDYL0087    WL0339           Quantity Schedu
     C                     Z-ADDYL0088    WL0340           Weight Schedule
     C                     EXSR NOCHRC
     C                     END                             *FI
      * UPD: New Production Hold Sts
      * CASE: DB1.Quantity Ordered NE LCL.Quantity Scheduled
     C           TMAVQT    IFNE YL0087                     *IF
      * Rtv User Rls Override RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0330           Company Number
     C                     Z-ADDTMC4NB    WL0331           Order Number
     C                     Z-ADDTMDPNB    WL0332           Order Sequence
     C                     Z-ADDTMUENB    WL0333           Order Secondary
     C                     EXSR NNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0334    YL0101    P      Released by Use
      * CASE: LCL.Released by User Sts Y/N is yes
     C           YL0101    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg New Prod Hold Sts CH - Order Detail Build Sched  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0341           Company Number
     C                     Z-ADDTMC4NB    WL0342           Order Number
     C                     Z-ADDTMDPNB    WL0343           Order Sequence
     C                     Z-ADDTMUENB    WL0344           Order Secondary
     C                     Z-ADD1         WL0345           ODBS New Prod H
     C                     MOVELTMR4CD    WL0346    P      Sales Route Cod
     C                     MOVELTMBGCD    WL0347    P      State Code
     C                     MOVELTMX3CD    WL0348    P      Territory Code
     C                     EXSR NPCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @E6CPME                  90*
     C                     ENDDO
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * BPS Proc ODBS f/Block RT - Order Detail Build Sched  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * R5947 5/16/16 RMC NEW TO Alloc block orders after all firm
     C                     Z-ADD*ZERO     YL0102           Company Number
     C                     Z-ADD*ZERO     YL0103           Order Number
     C                     MOVEL'Y'       YL0104           First Time Flag
      * Define keylist
     C           KPSNR     KLIST
     C                     KFLD           TMDBST           ODBS Partial Pi
     C                     KFLD           TMIIST           ODBS Block Orde
     C                     KFLD           TMWPST           Warehouse Type
     C                     KFLD           TMAODT           Scheduled Ship
     C                     KFLD           TMNVDT           Deadline Depart
     C                     KFLD           TMBUTM           Deadline Depart
     C                     KFLD           TMC4NB           Order Number
     C                     KFLD           TMDPNB           Order Sequence
     C                     KFLD           TMUENB           Order Secondary
      * Initialize key list
     C                     MOVEL*LOVAL    TMDBST           ODBS Partial Pi
     C                     MOVEL*HIVAL    TMIIST           ODBS Block Orde
     C                     MOVEL*HIVAL    TMWPST           Warehouse Type
     C                     MOVEL*LOVAL    TMAODT           Scheduled Ship
     C                     MOVEL*LOVAL    TMNVDT           Deadline Depart
     C                     MOVEL*LOVAL    TMBUTM           Deadline Depart
     C                     MOVEL*LOVAL    TMC4NB           Order Number
     C                     MOVEL*LOVAL    TMDPNB           Order Sequence
     C                     MOVEL*LOVAL    TMUENB           Order Secondary
      * Setup key
      * Establish starting position
     C           KPSNR     SETLL@E6CPME                    *
     C                     READ @E6CPME                  90*
      * Data record not found
     C   90                MOVEL'USR4107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag is Yes
     C           YL0104    IFEQ 'Y'                        *IF
     C                     MOVEL'SC'      YL0105           ATS Adj Type US
     C                     MOVEL'N'       YL0104           First Time Flag
     C                     END                             *FI
      * CASE: DB1.Scheduled Ship Date LT PAR.Scheduled Ship Date USR
     C           TMAODT    IFLT P4HODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Select Block only
      * CASE: DB1.ODBS Block Order Flag is Block Order
     C           TMIIST    IFEQ 'B'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Process Record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Order Type - Sales is Regular Order
      *   |- c2    : DB1.Order Type - Sales is Transfer Order
      *   '-
     C           TMJNCD    IFEQ 'OR'                       *IF
     C           TMJNCD    OREQ 'TR'                       *OR
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           TMGMST    IFEQ 'X'                        *IF
     C           TMGMST    OREQ 'C'
     C           TMGMST    OREQ 'R'
      * DO NOTHING
     C                     ELSE
      * CASE: DB1.ODBS Block Order Flag is Firm Order
     C           TMIIST    IFEQ 'F'                        *IF
      * DO NOTHING in this iteration
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN1066 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0033           Company Number
     C                     Z-ADDTMHGCD    WL0034           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    WUAVNA    P      Description Lin
     C                     MOVELWL0036    YL0106    P      UOM Primary
     C                     Z-ADDWL0037    YL0107           Unit Weight
     C                     Z-ADDWL0038    WURINB           Item Structure
     C                     Z-ADDWL0039    WURHNB           Item Structure
     C                     Z-ADDWL0040    WURGNB           Item Structure
     C                     MOVELWL0041    WUN0CD    P      Item Type Code
     C                     MOVELWL0042    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0043    YL0108           Fresh Chilling
     C                     MOVELWL0044    YL0109    P      Base_Conv_Loss
     C                     MOVELWL0045    WUXWST    P      Variety_Rendere
     C                     MOVELWL0046    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0047    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0048    YL0110           Pieces Per Head
     C                     MOVELWL0049    WUR3CD    P      Department Code
     C                     MOVELWL0050    WUSDCD    P      Group for Packa
     C                     MOVELWL0051    WUX5ST    P      Seconds Item
     C                     MOVELWL0052    YL0111    P      Piece Count Ite
     C                     Z-ADDWL0053    YL0112           Pieces Per Bag
     C                     Z-ADDWL0054    YL0113           Bags Per Unit
     C                     MOVELWL0055    WUSUST    P      Export_Domestic
     C                     MOVELWL0056    WUSVST    P      Print On Schedu
     C                     MOVELWL0057    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0058    WUSZST    P      Fresh Sched As
     C                     MOVELWL0059    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0060    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTMAJCD    WL0061    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    YL0114    P      Warehouse Type
     C                     MOVELWL0063    WUXUST    P      Trans Contol AS
     C                     MOVELWL0064    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0065    YL0115    P      Warehouse Std C
     C                     Z-ADDWL0066    YL0116           Warehouse Chill
     C                     MOVELTMDCST    YL0117           ODBS Sched Over
      * CASE: LCL.ODBS Sched Override Sts is eq Yes
     C           YL0117    IFEQ 'Y'                        *IF
      * If schedule was overriden in WW Ord Prod Sch POQJDFR, call this
      *  to make the changes stick.
      * 10/30/18 THIS WAS DONE IN THE NORMAL ITERATION - DONT DO AGAIN HE
     C                     ELSE
      * CASE: *OTHERWISE
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0326           Company Number
     C                     Z-ADDTMC4NB    WL0327           Order Number
     C                     Z-ADDTMDPNB    WL0328           Order Sequence
     C                     Z-ADDTMUENB    WL0329           Order Secondary
     C                     EXSR NMRVGN
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0067           Company Number
     C                     Z-ADDTMC4NB    WL0068           Order Number
     C                     Z-ADDTMDPNB    WL0069           Order Sequence
     C                     Z-ADDTMUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
     C                     Z-ADD*ZERO     YL0118           Quantity Schedu
     C                     Z-ADD*ZERO     YL0119           Weight Schedule
      * When an order is GE the prod date rgt,
      *    Send in the ordered quantity for allocation.
      * When orders are inside the production date rgt,
      *   Send in the sched quantity for allocation.
      * CASE: DB1.Scheduled Ship Date GE PAR.Production Date RGT
     C           TMAODT    IFGE P3GWDT                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TMAIC3    WQ0205  30       Company Number
     C                     PARM TMC4NB    WQ0206  70       Order Number
     C                     PARM TMDPNB    WQ0207  30       Order Sequence
     C                     PARM TMUENB    WQ0208  30       Order Secondary
     C                     PARM TMHGCD    WQ0209  70       Item Code
     C                     PARM TMAJCD    WQ0210  3        Warehouse Code
     C                     PARM TMA5DT    WQ0211  70       Ship Date USR
     C                     PARM TMAVQT    WQ0212 112       Quantity Ordere
     C                     PARM TMD0WG    WQ0213 112       Weight Ordered
     C           YL0118    PARM YL0118    WQ0214 112       Quantity Schedu
     C           YL0119    PARM YL0119    WQ0215 112       Weight Schedule
     C                     PARM TMDDST    WQ0216  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0217 10        PSAA Program Na
     C                     PARM TMRINY    WQ0218  40       Item Age Days
     C                     PARM TMTIDT    WQ0219  70       Production Ovr
     C                     PARM TMTJDT    WQ0220  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TMAIC3    WQ0221  30       Company Number
     C                     PARM TMC4NB    WQ0222  70       Order Number
     C                     PARM TMDPNB    WQ0223  30       Order Sequence
     C                     PARM TMUENB    WQ0224  30       Order Secondary
     C                     PARM TMHGCD    WQ0225  70       Item Code
     C                     PARM TMAJCD    WQ0226  3        Warehouse Code
     C                     PARM TMA5DT    WQ0227  70       Ship Date USR
     C                     PARM TMAVQT    WQ0228 112       Quantity Ordere
     C                     PARM TMD0WG    WQ0229 112       Weight Ordered
     C           YL0118    PARM YL0118    WQ0230 112       Quantity Schedu
     C           YL0119    PARM YL0119    WQ0231 112       Weight Schedule
     C                     PARM TMDDST    WQ0232  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0233 10        PSAA Program Na
     C                     PARM TMRINY    WQ0234  40       Item Age Days
     C                     PARM TMTIDT    WQ0235  70       Production Ovr
     C                     PARM TMTJDT    WQ0236  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0335           Company Number
     C                     Z-ADDTMC4NB    WL0336           Order Number
     C                     Z-ADDTMDPNB    WL0337           Order Sequence
     C                     Z-ADDTMUENB    WL0338           Order Secondary
     C                     Z-ADDYL0118    WL0339           Quantity Schedu
     C                     Z-ADDYL0119    WL0340           Weight Schedule
     C                     EXSR NOCHRC
     C                     END                             *FI
      * UPD: New Production Hold Sts
      * CASE: DB1.Quantity Ordered NE LCL.Quantity Scheduled
     C           TMAVQT    IFNE YL0118                     *IF
      * Rtv User Rls Override RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0330           Company Number
     C                     Z-ADDTMC4NB    WL0331           Order Number
     C                     Z-ADDTMDPNB    WL0332           Order Sequence
     C                     Z-ADDTMUENB    WL0333           Order Secondary
     C                     EXSR NNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0334    YL0120    P      Released by Use
      * CASE: LCL.Released by User Sts Y/N is yes
     C           YL0120    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg New Prod Hold Sts CH - Order Detail Build Sched  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTMAIC3    WL0341           Company Number
     C                     Z-ADDTMC4NB    WL0342           Order Number
     C                     Z-ADDTMDPNB    WL0343           Order Sequence
     C                     Z-ADDTMUENB    WL0344           Order Secondary
     C                     Z-ADD1         WL0345           ODBS New Prod H
     C                     MOVELTMR4CD    WL0346    P      Sales Route Cod
     C                     MOVELTMBGCD    WL0347    P      State Code
     C                     MOVELTMX3CD    WL0348    P      Territory Code
     C                     EXSR NPCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @E6CPME                  90*
     C                     ENDDO
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * BPS Proc ODBS f/NPH1  RT - Order Detail Build Sched  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * Define keylist
     C           KPSNS     KLIST
     C                     KFLD           TOIIST           ODBS Block Orde
     C                     KFLD           TONVDT           Deadline Depart
     C                     KFLD           TOBUTM           Deadline Depart
     C                     KFLD           TOAODT           Scheduled Ship
     C                     KFLD           TOC4NB           Order Number
     C                     KFLD           TODPNB           Order Sequence
     C                     KFLD           TOUENB           Order Secondary
      * Initialize key list
     C                     MOVEL*HIVAL    TOIIST           ODBS Block Orde
     C                     MOVEL*LOVAL    TONVDT           Deadline Depart
     C                     MOVEL*LOVAL    TOBUTM           Deadline Depart
     C                     MOVEL*LOVAL    TOAODT           Scheduled Ship
     C                     MOVEL*LOVAL    TOC4NB           Order Number
     C                     MOVEL*LOVAL    TODPNB           Order Sequence
     C                     MOVEL*LOVAL    TOUENB           Order Secondary
      * Setup key
      * Establish starting position
     C           KPSNS     SETLL@E6CPCH                    *
     C                     READ @E6CPCH                  90*
      * Data record not found
     C   90                MOVEL'USR4107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      *
     C                     Z-ADD*ZERO     WN1067 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTOAIC3    WL0033           Company Number
     C                     Z-ADDTOHGCD    WL0034           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    WUAVNA    P      Description Lin
     C                     MOVELWL0036    YL0121    P      UOM Primary
     C                     Z-ADDWL0037    YL0122           Unit Weight
     C                     Z-ADDWL0038    WURINB           Item Structure
     C                     Z-ADDWL0039    WURHNB           Item Structure
     C                     Z-ADDWL0040    WURGNB           Item Structure
     C                     MOVELWL0041    WUN0CD    P      Item Type Code
     C                     MOVELWL0042    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0043    YL0123           Fresh Chilling
     C                     MOVELWL0044    YL0124    P      Base_Conv_Loss
     C                     MOVELWL0045    WUXWST    P      Variety_Rendere
     C                     MOVELWL0046    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0047    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0048    YL0125           Pieces Per Head
     C                     MOVELWL0049    WUR3CD    P      Department Code
     C                     MOVELWL0050    WUSDCD    P      Group for Packa
     C                     MOVELWL0051    WUX5ST    P      Seconds Item
     C                     MOVELWL0052    YL0126    P      Piece Count Ite
     C                     Z-ADDWL0053    YL0127           Pieces Per Bag
     C                     Z-ADDWL0054    YL0128           Bags Per Unit
     C                     MOVELWL0055    WUSUST    P      Export_Domestic
     C                     MOVELWL0056    WUSVST    P      Print On Schedu
     C                     MOVELWL0057    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0058    WUSZST    P      Fresh Sched As
     C                     MOVELWL0059    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0060    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTOAJCD    WL0061    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    YL0129    P      Warehouse Type
     C                     MOVELWL0063    WUXUST    P      Trans Contol AS
     C                     MOVELWL0064    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0065    YL0130    P      Warehouse Std C
     C                     Z-ADDWL0066    YL0131           Warehouse Chill
      * CASE:
      *  - (c1ANDc2)
      *   |- c1    : DB1.ODBS Sched Override Sts is eq Yes
      *   |- c2    : DB1.Scheduled Ship Date GT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TODCST    IFEQ 'Y'                        *IF
     C           TOAODT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * C01340 2.18.11 RMC  Let curr day ship try to re-alc
     C                     ELSE
      * CASE: *OTHERWISE
      * Deallocate all that was allocated 1st
      * RTV Qty/Wgt Ord/Sched RT - Order Detail  * 
     C                     EXSR NTRVGN
     C                     Z-ADD*ZERO     YL0133           Quantity Ordere
     C                     Z-ADD*ZERO     YL0134           Weight Ordered
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TOAIC3    WQ0237  30       Company Number
     C                     PARM TOC4NB    WQ0238  70       Order Number
     C                     PARM TODPNB    WQ0239  30       Order Sequence
     C                     PARM TOUENB    WQ0240  30       Order Secondary
     C                     PARM TOHGCD    WQ0241  70       Item Code
     C                     PARM TOAJCD    WQ0242  3        Warehouse Code
     C                     PARM TOA5DT    WQ0243  70       Ship Date USR
     C                     PARM YL0133    WQ0244 112       Quantity Ordere
     C                     PARM YL0134    WQ0245 112       Weight Ordered
     C           YL0135    PARM YL0135    WQ0246 112       Quantity Schedu
     C           YL0136    PARM YL0136    WQ0247 112       Weight Schedule
     C                     PARM 'OD'      WQ0248  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0249 10        PSAA Program Na
     C                     PARM TORINY    WQ0250  40       Item Age Days
     C                     PARM TOTIDT    WQ0251  70       Production Ovr
     C                     PARM TOTJDT    WQ0252  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTOAIC3    WL0335           Company Number
     C                     Z-ADDTOC4NB    WL0336           Order Number
     C                     Z-ADDTODPNB    WL0337           Order Sequence
     C                     Z-ADDTOUENB    WL0338           Order Secondary
     C                     Z-ADDYL0135    WL0339           Quantity Schedu
     C                     Z-ADDYL0136    WL0340           Weight Schedule
     C                     EXSR NOCHRC
      * try to allocate all
     C                     Z-ADD*ZERO     YL0135           Quantity Schedu
     C                     Z-ADD*ZERO     YL0136           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TOAIC3    WQ0253  30       Company Number
     C                     PARM TOC4NB    WQ0254  70       Order Number
     C                     PARM TODPNB    WQ0255  30       Order Sequence
     C                     PARM TOUENB    WQ0256  30       Order Secondary
     C                     PARM TOHGCD    WQ0257  70       Item Code
     C                     PARM TOAJCD    WQ0258  3        Warehouse Code
     C                     PARM TOA5DT    WQ0259  70       Ship Date USR
     C                     PARM TOAVQT    WQ0260 112       Quantity Ordere
     C                     PARM TOD0WG    WQ0261 112       Weight Ordered
     C           YL0135    PARM YL0135    WQ0262 112       Quantity Schedu
     C           YL0136    PARM YL0136    WQ0263 112       Weight Schedule
     C                     PARM TODDST    WQ0264  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0265 10        PSAA Program Na
     C                     PARM TORINY    WQ0266  40       Item Age Days
     C                     PARM TOTIDT    WQ0267  70       Production Ovr
     C                     PARM TOTJDT    WQ0268  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTOAIC3    WL0335           Company Number
     C                     Z-ADDTOC4NB    WL0336           Order Number
     C                     Z-ADDTODPNB    WL0337           Order Sequence
     C                     Z-ADDTOUENB    WL0338           Order Secondary
     C                     Z-ADDYL0135    WL0339           Quantity Schedu
     C                     Z-ADDYL0136    WL0340           Weight Schedule
     C                     EXSR NOCHRC
      * UPD: New Production Hold Sts to 2 (Still Short)
      * CASE: DB1.Quantity Ordered NE LCL.Quantity Scheduled
     C           TOAVQT    IFNE YL0135                     *IF
      * Rtv User Rls Override RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTOAIC3    WL0330           Company Number
     C                     Z-ADDTOC4NB    WL0331           Order Number
     C                     Z-ADDTODPNB    WL0332           Order Sequence
     C                     Z-ADDTOUENB    WL0333           Order Secondary
     C                     EXSR NNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0334    YL0142    P      Released by Use
      * CASE: LCL.Released by User Sts Y/N is yes
     C           YL0142    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg New Prod Hold Sts CH - Order Detail Build Sched  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTOAIC3    WL0341           Company Number
     C                     Z-ADDTOC4NB    WL0342           Order Number
     C                     Z-ADDTODPNB    WL0343           Order Sequence
     C                     Z-ADDTOUENB    WL0344           Order Secondary
     C                     Z-ADD2         WL0345           ODBS New Prod H
     C                     MOVELTOR4CD    WL0346    P      Sales Route Cod
     C                     MOVELTOBGCD    WL0347    P      State Code
     C                     MOVELTOX3CD    WL0348    P      Territory Code
     C                     EXSR NPCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @E6CPCH                  90*
     C                     ENDDO
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * RTV Qty/Wgt Ord/Sched RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
      * Setup key
     C                     Z-ADDTOAIC3    WTAIC3           Company Number
     C                     Z-ADDTOC4NB    WTC4NB           Order Number
     C                     Z-ADDTODPNB    WTDPNB           Order Sequence
     C                     Z-ADDTOUENB    WTUENB           Order Secondary
      * Establish starting position
     C           KRSNT     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0132           Detail Line Sta
     C                     Z-ADD*ZERO     YL0133           Quantity Ordere
     C                     Z-ADD*ZERO     YL0134           Weight Ordered
     C                     Z-ADD*ZERO     YL0135           Quantity Schedu
     C                     Z-ADD*ZERO     YL0136           Weight Schedule
     C                     Z-ADD*ZERO     YL0137           Consumed Item C
     C                     Z-ADD*ZERO     YL0138           Item Age Days
     C                     Z-ADD*ZERO     YL0139           Production Ovr
     C                     Z-ADD*ZERO     YL0140           Production Ovr
     C                     MOVEL*BLANK    YL0141           Record Found US
     C                     MOVEL'N'       YL0141           Record Found US
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTGMST    YL0132           Detail Line Sta
     C                     Z-ADDWTAVQT    YL0133           Quantity Ordere
     C                     Z-ADDWTD0WG    YL0134           Weight Ordered
     C                     Z-ADDWTCCQT    YL0135           Quantity Schedu
     C                     Z-ADDWTAUWG    YL0136           Weight Schedule
     C                     Z-ADDWTNUDT    YL0137           Consumed Item C
     C                     Z-ADDWTRINY    YL0138           Item Age Days
     C                     Z-ADDWTTIDT    YL0139           Production Ovr
     C                     Z-ADDWTTJDT    YL0140           Production Ovr
     C                     MOVEL'Y'       YL0141           Record Found US
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * BPS Proc ODBS f/POST  RT - Order Detail Build Sched  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1068  70       Scheduled Ship
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UPSUBR                     ***** Change Lo
     C                     Z-ADD*ZERO     YL0143           Load ID
     C                     Z-ADD*ZERO     YL0144           Company Number
     C                     Z-ADD*ZERO     YL0145           Order Number
      * Establish starting position
     C           *LOVAL    SETLL@E6CPCI                    *
     C                     READ @E6CPCI                  90*
      * Data record not found
     C   90                MOVEL'USR4107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG: Order Number  - Post Order
      * CASE: LCL.Order Number NE DB1.Order Number
     C           YL0145    IFNE TRC4NB                     *IF
      * Update if not 1st time: Post Order
      * CASE: LCL.Order Number is Greater then zero
     C           YL0145    IFGT 0                          *IF
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0144    WQ0269  30       Company Number
     C                     PARM YL0145    WQ0270  70       Order Number
     C                     PARM YL0146    WQ0271  70       Ship To Custome
     C           WUJZVA    PARM WUJZVA    WQ0272 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0273 112       Order Weight To
     C                     PARM 'PS'      WQ0274  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *  Dont hold if ...  4/08/2010 rmc
      * Rtv Hdr Sts/Hld/Lst/CrRT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0352           Company Number
     C                     Z-ADDYL0145    WL0353           Order Number
     C                     EXSR NVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0354    YL0147    P      Header Status
     C                     MOVELWL0355    YL0148    P      Header Status L
     C                     MOVELWL0356    YL0149    P      Credit Hold
     C                     MOVELWL0357    YL0150    P      Production Hold
      * CASE: LCL.Production Hold is Yes
     C           YL0150    IFEQ 'Y'                        *IF
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0081           Company Number
     C                     Z-ADD##JDT     WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0151    P      Production Day
      * Do not hold order if...
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is no
      *   |- c2    : LCL.Scheduled Ship Date LE JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0151    IFEQ 'N'                        *IF
     C           YL0152    IFLE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0358           Company Number
     C                     Z-ADDYL0145    WL0359           Order Number
     C                     MOVEL*BLANK    WL0360           Reason Code
     C                     MOVELYL0147    WL0361    P      Header Status
     C                     MOVELYL0148    WL0362    P      Header Status L
     C                     MOVEL'N'       WL0363    P      Production Hold
     C                     EXSR NWCHRC
     C                     END                             *FI
      * Do not hold order if...new 10/10/13 per pkd, cbecerra
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Warehouse Type is Frozen
      *   |- c2    : LCL.Scheduled Ship Date LE JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0153    IFEQ 'FZ'                       *IF
     C           YL0152    IFLE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0358           Company Number
     C                     Z-ADDYL0145    WL0359           Order Number
     C                     MOVEL*BLANK    WL0360           Reason Code
     C                     MOVELYL0147    WL0361    P      Header Status
     C                     MOVELYL0148    WL0362    P      Header Status L
     C                     MOVEL'N'       WL0363    P      Production Hold
     C                     EXSR NWCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CHG: Load Id : Lock or Unlock the load
      * CASE: LCL.Load ID NE DB1.Load ID
     C           YL0143    IFNE TRRMNB                     *IF
      * dont lock/unlock per Prod Hold changes.. Only Cr hold does that n
     C                     MOVELTRPKST    YL0154           Load Status
     C                     Z-ADDTRRMNB    YL0143           Load ID
     C                     END                             *FI
      * Update save fields
      * CASE: LCL.Order Number NE DB1.Order Number
     C           YL0145    IFNE TRC4NB                     *IF
     C                     Z-ADDTRAIC3    YL0144           Company Number
     C                     Z-ADDTRC4NB    YL0145           Order Number
     C                     MOVELTRJNCD    YL0155           Order Type - Sa
     C                     Z-ADDTRBKC7    YL0146           Ship To Custome
     C                     MOVELTRBZNA    YL0156           Carrier Code
     C                     Z-ADDTRAODT    YL0152           Scheduled Ship
     C                     MOVELTRWPST    YL0153           Warehouse Type
     C                     END                             *FI
     C                     READ @E6CPCI                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update Last Order read: Post Order
      * CASE: LCL.Order Number is Greater then zero
     C           YL0145    IFGT 0                          *IF
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0144    WQ0275  30       Company Number
     C                     PARM YL0145    WQ0276  70       Order Number
     C                     PARM YL0146    WQ0277  70       Ship To Custome
     C           WUJZVA    PARM WUJZVA    WQ0278 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0279 112       Order Weight To
     C                     PARM 'PS'      WQ0280  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *  Dont hold if ..                       4/08/2010 rmc
      * Rtv Hdr Sts/Hld/Lst/CrRT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0352           Company Number
     C                     Z-ADDYL0145    WL0353           Order Number
     C                     EXSR NVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0354    YL0147    P      Header Status
     C                     MOVELWL0355    YL0148    P      Header Status L
     C                     MOVELWL0356    YL0149    P      Credit Hold
     C                     MOVELWL0357    YL0150    P      Production Hold
      * CASE: LCL.Production Hold is Yes
     C           YL0150    IFEQ 'Y'                        *IF
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0081           Company Number
     C                     Z-ADD##JDT     WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0151    P      Production Day
      * Do not hold order if...
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is no
      *   |- c2    : LCL.Scheduled Ship Date LE JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0151    IFEQ 'N'                        *IF
     C           YL0152    IFLE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0358           Company Number
     C                     Z-ADDYL0145    WL0359           Order Number
     C                     MOVEL*BLANK    WL0360           Reason Code
     C                     MOVELYL0147    WL0361    P      Header Status
     C                     MOVELYL0148    WL0362    P      Header Status L
     C                     MOVEL'N'       WL0363    P      Production Hold
     C                     EXSR NWCHRC
     C                     END                             *FI
      * Do not hold order if...new 10/10/13 per pkd, cbecerra
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Warehouse Type is Frozen
      *   |- c2    : LCL.Scheduled Ship Date LE JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0153    IFEQ 'FZ'                       *IF
     C           YL0152    IFLE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0144    WL0358           Company Number
     C                     Z-ADDYL0145    WL0359           Order Number
     C                     MOVEL*BLANK    WL0360           Reason Code
     C                     MOVELYL0147    WL0361    P      Header Status
     C                     MOVELYL0148    WL0362    P      Header Status L
     C                     MOVEL'N'       WL0363    P      Production Hold
     C                     EXSR NWCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * Rtv Hdr Sts/Hld/Lst/CrRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0352    WDAIC3           Company Number
     C                     Z-ADDWL0353    WDC4NB           Order Number
      * Establish starting position
     C           KRSNV     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0354           Header Status
     C                     MOVEL*BLANK    WL0355           Header Status L
     C                     MOVEL*BLANK    WL0356           Credit Hold
     C                     MOVEL*BLANK    WL0357           Production Hold
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDGWST    WL0354           Header Status
     C                     MOVELWDGXST    WL0355           Header Status L
     C                     MOVELWDXIST    WL0356           Credit Hold
     C                     MOVELWDXJST    WL0357           Production Hold
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWCHRC    BEGSR
      *================================================================
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN1069  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1070  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1071  70       Ship To Custome
     C                     MOVEL*BLANK    WN1072 30        Ship To Name
     C                     MOVEL*BLANK    WN1073 30        Ship To Address
     C                     MOVEL*BLANK    WN1074 30        Ship To Address
     C                     MOVEL*BLANK    WN1075 30        Ship To Address
     C                     MOVEL*BLANK    WN1076 20        Ship To City
     C                     MOVEL*BLANK    WN1077  2        Ship To State C
     C                     MOVEL*BLANK    WN1078 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1079  70       Bill to Custome
     C                     MOVEL*BLANK    WN1080 30        Bill to Name
     C                     MOVEL*BLANK    WN1081 30        Bill to Address
     C                     MOVEL*BLANK    WN1082 30        Bill to Address
     C                     MOVEL*BLANK    WN1083 30        Bill to Address
     C                     MOVEL*BLANK    WN1084 20        Bill to City
     C                     MOVEL*BLANK    WN1085  2        Bill to State C
     C                     MOVEL*BLANK    WN1086 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1087 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1088  70       Order Date
     C                     Z-ADD*ZERO     WN1089  70       Requested Ship
     C                     Z-ADD*ZERO     WN1090  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1091  70       Cancel Date
     C                     MOVEL*BLANK    WN1092  2        Terms Code
     C                     MOVEL*BLANK    WN1093 40        Special Instruc
     C                     MOVEL*BLANK    WN1094 40        Special Instruc
     C                     MOVEL*BLANK    WN1095  3        Carrier Code
     C                     MOVEL*BLANK    WN1096  1        Comment Print A
     C                     MOVEL*BLANK    WN1097  1        Comment Print I
     C                     MOVEL*BLANK    WN1098  1        Comment Print P
     C                     MOVEL*BLANK    WN1099  1        Comment Print S
     C                     MOVEL*BLANK    WN1100  1        Order in Use
     C                     MOVEL*BLANK    WN1101  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1102  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1103 10        User Original E
     C                     Z-ADD*ZERO     WN1104  70       Date of Origina
     C                     Z-ADD*ZERO     WN1105 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1106 112       Order Weight To
     C                     MOVEL*BLANK    WN1107  1        Credit Hold
     C                     MOVEL*BLANK    WN1108  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1109  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1110  40       Requested Deliv
     C                     MOVEL*BLANK    WN1111  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1112 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1113  70       Load ID
     C                     Z-ADD*ZERO     WN1114  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1115 112       Rated Freight
     C                     MOVEL*BLANK    WN1116  1        LTL Flag
     C                     MOVEL*BLANK    WN1117  1        Price Audit
     C                     MOVEL*BLANK    WN1118  1        Price Status
     C                     MOVEL*BLANK    WN1119  2        Shipping Method
     C                     MOVEL*BLANK    WN1120  1        Export Status
     C                     MOVEL*BLANK    WN1121  1        Palletize
     C                     MOVEL*BLANK    WN1122  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1123  1        Slip Sheet
     C                     MOVEL*BLANK    WN1124  1        Age Code
     C                     Z-ADD*ZERO     WN1125  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1126  1        Load Type
     C                     Z-ADD*ZERO     WN1127  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1128  1        Load Plan Order
     C                     MOVEL*BLANK    WN1129  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1130  70       Resell Referenc
     C                     MOVEL*BLANK    WN1131 30        Special Comment
     C                     MOVEL*BLANK    WN1132 30        Special Comment
     C                     MOVEL*BLANK    WN1133  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1134  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1135  2        Manager Level C
     C                     MOVEL*BLANK    WN1136  3        VP Level Code
     C                     Z-ADD*ZERO     WN1137  70       Attach to Order
     C                     MOVEL*BLANK    WN1138  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1139  70       Invoice Number
     C                     MOVEL*BLANK    WN1140  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1141  70       Invoice Date
     C                     MOVEL*BLANK    WN1142  2        Event Code
     C                     MOVEL*BLANK    WN1143  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1144  1        Modified Flag
     C                     Z-ADD*ZERO     WN1145 112       A/R order Value
     C                     MOVEL*BLANK    WN1146  1        Billing Activit
     C                     MOVEL*BLANK    WN1147  1        Block Order Fla
     C                     MOVEL*BLANK    WN1148  1        Order Certifica
     C                     Z-ADD*ZERO     WN1149 112       Invoice Order V
     C                     MOVEL*BLANK    WN1150  1        Process Sts for
     C                     MOVEL*BLANK    WN1151  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1152  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1153  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1154  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1155  1        Email Cust On O
     C                     MOVEL*BLANK    WN1156  1        Order Emailed
     C                     MOVEL*BLANK    WN1157  1        Export Docs Go
     C                     MOVEL*BLANK    WN1158  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1159  1        Broker Order St
     C                     MOVEL*BLANK    WN1160  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1161  2        Order Requires
     C                     MOVEL*BLANK    WN1162  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1163  2        Export USDA App
     C                     MOVEL*BLANK    WN1164  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1165  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1166  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1167  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1168  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1169  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1170  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1171  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1172  60       Time of Origina
     C                     Z-ADD*ZERO     WN1173  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1174  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1175  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1176 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1177 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1178 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1179 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1180 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1181  70       Claim Number
     C                     MOVEL*BLANK    WN1182  1        EDI Status 1
     C                     MOVEL*BLANK    WN1183  1        EDI Status 2
     C                     MOVEL*BLANK    WN1184  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1185  60       Job Time
     C                     MOVEL*BLANK    WN1186 10        User Id
     C                     MOVEL*BLANK    WN1187 10        Job Name
     C                     Z-ADD*ZERO     WN1188  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0358    TSAIC3           Company Number
     C                     Z-ADDWL0359    TSC4NB           Order Number
      *
     C           KLCHNW    KLIST
     C                     KFLD           TSAIC3           Company Number
     C                     KFLD           TSC4NB           Order Number
     C           KLCHNW    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YORDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0360    TSCQCD    P      Reason Code
     C                     MOVELWL0361    TSGWST    P      Header Status
     C                     MOVELWL0362    TSGXST    P      Header Status L
     C                     MOVELWL0363    TSXJST    P      Production Hold
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     TSAATM           Job Time
     C                     MOVEL##USR     TSAYNA           User Id
     C                     MOVEL##PGM     TSA0NA           Job Name
     C                     Z-ADD##JDT     TSAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDTSAIC3    PAAIC3           Company Number
     C                     Z-ADDTSC4NB    PAC4NB           Order Number
     C                     MOVELTSJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDTSANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDTSBKC7    PABKC7           Ship To Custome
     C                     MOVELTSBRTX    PABRTX    P      Ship To Name
     C                     MOVELTSHMNA    PAHMNA    P      Ship To Address
     C                     MOVELTSHONA    PAHONA    P      Ship To Address
     C                     MOVELTSHPNA    PAHPNA    P      Ship To Address
     C                     MOVELTSHNNA    PAHNNA    P      Ship To City
     C                     MOVELTSDBCD    PADBCD    P      Ship To State C
     C                     MOVELTSCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDTSB0C7    PAB0C7           Bill to Custome
     C                     MOVELTSAETX    PAAETX    P      Bill to Name
     C                     MOVELTSB1NA    PAB1NA    P      Bill to Address
     C                     MOVELTSB3NA    PAB3NA    P      Bill to Address
     C                     MOVELTSB4NA    PAB4NA    P      Bill to Address
     C                     MOVELTSB2NA    PAB2NA    P      Bill to City
     C                     MOVELTSBHCD    PABHCD    P      Bill to State C
     C                     MOVELTSC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELTSBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDTSA0DT    PAA0DT           Order Date
     C                     Z-ADDTSA5DT    PAA5DT           Requested Ship
     C                     Z-ADDTSGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDTSACDT    PAACDT           Cancel Date
     C                     MOVELTSAQCD    PAAQCD    P      Terms Code
     C                     MOVELTSB6NA    PAB6NA    P      Special Instruc
     C                     MOVELTSBYNA    PABYNA    P      Special Instruc
     C                     MOVELTSBZNA    PABZNA    P      Carrier Code
     C                     MOVELTSGTST    PAGTST    P      Comment Print A
     C                     MOVELTSGVST    PAGVST    P      Comment Print I
     C                     MOVELTSGUST    PAGUST    P      Comment Print P
     C                     MOVELTSQFST    PAQFST    P      Comment Print S
     C                     MOVELTSCQCD    PACQCD    P      Reason Code
     C                     MOVELTSGJST    PAGJST    P      Order in Use
     C                     MOVELTSGWST    PAGWST    P      Header Status
     C                     MOVELTSGXST    PAGXST    P      Header Status L
     C                     MOVELTSGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDTSAODT    PAAODT           Scheduled Ship
     C                     MOVELTSAIVN    PAAIVN    P      User Original E
     C                     Z-ADDTSCXDT    PACXDT           Date of Origina
     C                     Z-ADDTSJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDTSA1WG    PAA1WG           Order Weight To
     C                     MOVELTSXIST    PAXIST    P      Credit Hold
     C                     MOVELTSXJST    PAXJST    P      Production Hold
     C                     MOVELTSXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDTSEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDTSAFTM    PAAFTM           Requested Deliv
     C                     MOVELTSE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELTSE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDTSRMNB    PARMNB           Load ID
     C                     Z-ADDTSTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDTSR1NB    PAR1NB           Rated Freight
     C                     MOVELTSPJST    PAPJST    P      LTL Flag
     C                     MOVELTSU0ST    PAU0ST    P      Price Audit
     C                     MOVELTSU1ST    PAU1ST    P      Price Status
     C                     MOVELTSQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELTSU2ST    PAU2ST    P      Export Status
     C                     MOVELTSVEST    PAVEST    P      Palletize
     C                     MOVELTSVFST    PAVFST    P      Shrink Wrap
     C                     MOVELTSVGST    PAVGST    P      Slip Sheet
     C                     MOVELTSRPCD    PARPCD    P      Age Code
     C                     Z-ADDTSRNNB    PARNNB           Reefer Temperat
     C                     MOVELTSVDST    PAVDST    P      Load Type
     C                     Z-ADDTSATIN    PAATIN           Attach to Invoi
     C                     MOVELTSU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELTSU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDTSRSRN    PARSRN           Resell Referenc
     C                     MOVELTSMHNA    PAMHNA    P      Special Comment
     C                     MOVELTSMINA    PAMINA    P      Special Comment
     C                     MOVELTSWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELTSR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELTSBFCD    PABFCD    P      Manager Level C
     C                     MOVELTSQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDTST3NB    PAT3NB           Attach to Order
     C                     MOVELTSSICD    PASICD    P      Reason for Pric
     C                     Z-ADDTSCONB    PACONB           Invoice Number
     C                     MOVELTSCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDTSAWDT    PAAWDT           Invoice Date
     C                     MOVELTSJPCD    PAJPCD    P      Event Code
     C                     MOVELTSXUST    PAXUST    P      Trans Contol AS
     C                     MOVELTSZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDTSVRVA    PAVRVA           A/R order Value
     C                     MOVELTSOBST    PAOBST    P      Billing Activit
     C                     MOVELTSBCST    PABCST    P      Block Order Fla
     C                     MOVELTSBDST    PABDST    P      Order Certifica
     C                     Z-ADDTSB7VL    PAB7VL           Invoice Order V
     C                     MOVELTSGASX    PAGASX    P      Process Sts for
     C                     MOVELTSGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELTSGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELTSGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELTSFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELTSFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELTSFPSX    PAFPSX    P      Order Emailed
     C                     MOVELTSFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELTSFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELTSFSSX    PAFSSX    P      Broker Order St
     C                     MOVELTSFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELTSFUSX    PAFUSX    P      Order Requires
     C                     MOVELTSFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELTSFWSX    PAFWSX    P      Export USDA App
     C                     MOVELTSFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELTSFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDTSNODT    PANODT           OH Appt Confirm
     C                     Z-ADDTSNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDTSNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDTSNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDTSNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDTSBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDTSBQTM    PABQTM           Time of Origina
     C                     Z-ADDTSBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDTSBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDTSBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDTSH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDTSH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDTSH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDTSH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDTSH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDTSC0C7    PAC0C7           Claim Number
     C                     MOVELTSUVST    PAUVST    P      EDI Status 1
     C                     MOVELTSUWST    PAUWST    P      EDI Status 2
     C                     MOVELTSUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDTSAATM    PAAATM           Job Time
     C                     MOVELTSAYNA    PAAYNA    P      User Id
     C                     MOVELTSA0NA    PAA0NA    P      Job Name
     C                     Z-ADDTSAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     MOVELWL0002    WAV8CD           Company Value C
      * Establish starting position
     C           KRSSA     CHAIN@KMREHC              90    *
      * Data record not found
     C   90                MOVEL'USR2221' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Company Values     CH - Company Values  * 
     C                     EXSR SBCHRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Company Values     CH - Company Values  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @KMREHB
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     MOVELWAV8CD    WBV8CD    P      Company Value C
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV8CD           Company Value C
     C           KLCHSB    CHAIN@KMREHB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKMREL0'MDACP
     C                     MOVEL'@KMREHB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKM1    YARDCS
      * Move non-key fields to @KMREHB
     C                     MOVELWAAUNA    WBAUNA    P      Description
     C                     MOVELWAI5ST    WBI5ST    P      System Value Ty
     C                     MOVELWL0003    WBBXTX    P      System Value Al
     C                     Z-ADDWAM8NB    WBM8NB           System Value Nu
     C                     MOVELWAUVST    WBUVST    P      EDI Status 1
     C                     MOVELWAUWST    WBUWST    P      EDI Status 2
     C                     MOVELWAUXST    WBUXST    P      EDI Status 3
     C                     MOVELWAVSST    WBVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@KMREHB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0001           Order Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDWL0004    WQSC01           Company Number
      * Establish starting position
     C           KRSSC     SETLL@KNCPHO                    *
     C           KRSSC     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Order Number NE DB1.Order Number
     C           YL0001    IFNE WCC4NB                     *IF
     C                     Z-ADDWCC4NB    YL0001           Order Number
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * CASE: LCL.Header Status is Avail/Alloc/Enter/Hold
     C           YL0002    IFEQ 'L'                        *IF
     C           YL0002    OREQ 'A'
     C           YL0002    OREQ 'E'
     C           YL0002    OREQ 'H'
      * Chg Reallocate Sts    CH - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0005           Company Number
     C                     Z-ADDWCC4NB    WL0006           Order Number
     C                     Z-ADDWCDPNB    WL0007           Order Sequence
     C                     Z-ADDWCUENB    WL0008           Order Secondary
     C                     Z-ADDWCJGDT    WL0009           OD Production D
     C                     MOVEL'Y'       WL0010    P      OD Reallocate S
     C                     EXSR SECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0011           Company Number
     C                     Z-ADDWCC4NB    WL0012           Order Number
     C                     Z-ADDWCDPNB    WL0013           Order Sequence
     C                     Z-ADDWCUENB    WL0014           Order Secondary
     C                     Z-ADDWCJGDT    WL0015           OD Production D
     C                     EXSR SFDLRC
      * Del OrdDtl Sch-ConsDT RT - Order Detail Sched-Consmd  * 
     C                     EXSR SGRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0022           Company Number
     C                     Z-ADDWCC4NB    WL0023           Order Number
     C                     Z-ADDWCDPNB    WL0024           Order Sequence
     C                     Z-ADDWCUENB    WL0025           Order Secondary
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSC     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDGWST    YL0002           Header Status
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Reallocate Sts    CH - Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0006  3        Warehouse Code
     C                     MOVEL*BLANK    WN0007  3        Order From Ware
     C                     Z-ADD*ZERO     WN0008  70       Item Code
     C                     Z-ADD*ZERO     WN0009 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0010 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0011 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0012 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0013 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0014 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0015  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0016  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0017  1        EDI Status 1
     C                     MOVEL*BLANK    WN0018  1        EDI Status 2
     C                     MOVEL*BLANK    WN0019  1        EDI Status 3
     C                     MOVEL*BLANK    WN0020  1        Record Status
     C                     Z-ADD*ZERO     WN0021  60       Job Time
     C                     MOVEL*BLANK    WN0022 10        User Id
     C                     MOVEL*BLANK    WN0023 10        Job Name
     C                     Z-ADD*ZERO     WN0024  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0005    WEAIC3           Company Number
     C                     Z-ADDWL0006    WEC4NB           Order Number
     C                     Z-ADDWL0007    WEDPNB           Order Sequence
     C                     Z-ADDWL0008    WEUENB           Order Secondary
     C                     Z-ADDWL0009    WEJGDT           OD Production D
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHSE    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YBRDCS
      * Move non-key fields to @KNCPHN
     C                     MOVELWL0010    WEP8ST    P      OD Reallocate S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0011    WEAIC3           Company Number
     C                     Z-ADDWL0012    WEC4NB           Order Number
     C                     Z-ADDWL0013    WEDPNB           Order Sequence
     C                     Z-ADDWL0014    WEUENB           Order Secondary
     C                     Z-ADDWL0015    WEJGDT           OD Production D
      *
     C           KLDLSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLDLSF    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del OrdDtl Sch-ConsDT RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSG03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSG04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQSG05           OD Production D
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Order Sequence
     C                     KFLD           WQSG04           Order Secondary
     C                     KFLD           WQSG05           OD Production D
      * Setup key
     C                     Z-ADDWCAIC3    WQSG01           Company Number
     C                     Z-ADDWCC4NB    WQSG02           Order Number
     C                     Z-ADDWCDPNB    WQSG03           Order Sequence
     C                     Z-ADDWCUENB    WQSG04           Order Secondary
     C                     Z-ADDWCJGDT    WQSG05           OD Production D
      * Establish starting position
     C           KRSSG     SETLL@B6CPNB                    *
     C           KRSSG     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0016           Company Number
     C                     Z-ADDWFC4NB    WL0017           Order Number
     C                     Z-ADDWFDPNB    WL0018           Order Sequence
     C                     Z-ADDWFUENB    WL0019           Order Secondary
     C                     Z-ADDWFJGDT    WL0020           OD Production D
     C                     Z-ADDWFOONY    WL0021           ODS Sequence Nu
     C                     EXSR SHDLRC
     C           KRSSG     READE@B6CPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWL0016    WGAIC3           Company Number
     C                     Z-ADDWL0017    WGC4NB           Order Number
     C                     Z-ADDWL0018    WGDPNB           Order Sequence
     C                     Z-ADDWL0019    WGUENB           Order Secondary
     C                     Z-ADDWL0020    WGJGDT           OD Production D
     C                     Z-ADDWL0021    WGOONY           ODS Sequence Nu
      *
     C           KLDLSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLDLSH    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSI03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSI04           Order Secondary
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Order Sequence
     C                     KFLD           WQSI04           Order Secondary
      * Setup key
     C                     Z-ADDWL0022    WQSI01           Company Number
     C                     Z-ADDWL0023    WQSI02           Order Number
     C                     Z-ADDWL0024    WQSI03           Order Sequence
     C                     Z-ADDWL0025    WQSI04           Order Secondary
      * Establish starting position
     C           KRSSI     SETLL@B5CPM2                    *
     C           KRSSI     READE@B5CPM2                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0026           Company Number
     C                     Z-ADDWHC4NB    WL0027           Order Number
     C                     Z-ADDWHDPNB    WL0028           Order Sequence
     C                     Z-ADDWHUENB    WL0029           Order Secondary
     C                     Z-ADDWHJGDT    WL0030           OD Production D
     C                     EXSR SJDLRC
     C           KRSSI     READE@B5CPM2                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWL0026    WIAIC3           Company Number
     C                     Z-ADDWL0027    WIC4NB           Order Number
     C                     Z-ADDWL0028    WIDPNB           Order Sequence
     C                     Z-ADDWL0029    WIUENB           Order Secondary
     C                     Z-ADDWL0030    WIJGDT           OD Production D
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
     C           KLDLSJ    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,002   WJDOCD           System Value Co
      * Establish starting position
     C           KRSSK     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWJM8NB    YL0005           System Value Nu
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV KillDay Dte-Durtn  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSL01           Company Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WKBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
      * Setup key
     C                     Z-ADD360       WQSL01           Company Number
     C                     Z-ADDYL0004    WKBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSL     SETLL@AFREC2                    *
     C           KRSSL     READE@AFREC2                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ YL0005                     *IF
     C                     Z-ADDWKBCDT    P3GWDT           *DATE
     C                     GOTO SLEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSL     READE@AFREC2                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Del Item Inventory    RT - PS Prod Item Inventory  * ---360---
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSM01           Company Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
      * Setup key
     C                     Z-ADDWL0031    WQSM01           Company Number
      * Establish starting position
     C           KRSSM     SETLL@CWCPQW                    *
     C           KRSSM     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Warehouse Code is Blanks
      *   |- c2    : DB1.Warehouse Code EQ PAR.Warehouse Code
      *   '-
     C           WL0032    IFEQ *BLANK                     *IF
     C           WLAJCD    OREQ WL0032                     *OR
      * Del Item Inventory    DL - PS Prod Item Inventory  * 
     C                     EXSR SNDLRC
     C                     END                             *FI
     C           KRSSM     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNDLRC    BEGSR
      *================================================================
      * Del Item Inventory    DL - PS Prod Item Inventory  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CWCPQV
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     Z-ADDWLHGCD    WMHGCD           Item Code
     C                     MOVELWLAJCD    WMAJCD           Warehouse Code
     C                     Z-ADDWLELDT    WMELDT           Production Date
      *
     C           KLDLSN    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
     C                     KFLD           WMELDT           Production Date
     C           KLDLSN    CHAIN@CWCPQV              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POCWCPL0'MDACP
     C                     MOVEL'@CWCPQV' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CWCPQV                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * BPS Proc ODBS f/Curr  RT - Order Detail Build Sched  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * FP1054 Read orders held over thru curr ship date only
      * C01360 RMC 2.18.2011 dont look at sched override sts here
     C                     Z-ADD*ZERO     YL0006           Company Number
     C                     Z-ADD*ZERO     YL0007           Order Number
     C                     MOVEL'Y'       YL0008           First Time Flag
      * Establish starting position
     C           *LOVAL    SETLL@E6CPAI                    *
     C                     READ @E6CPAI                  90*
      * Data record not found
     C   90                MOVEL'USR4107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag is Yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'SC'      YL0009           ATS Adj Type US
     C                     MOVEL'N'       YL0008           First Time Flag
     C                     END                             *FI
      * Process Orders Scheduled to Ship Today Only
      * CASE: DB1.Scheduled Ship Date GT PAR.Scheduled Ship Date USR
     C           WOAODT    IFGT P4HODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     Z-ADD0767555   WUCAC7           Order Number Re
      * CASE: DB1.Order Number EQ WRK.Order Number Ref
     C           WOC4NB    IFEQ WUCAC7                     *IF
     C                     MOVEL'TF'      WUX8SX           Produced By Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SF'      WUX8SX           Produced By Sts
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Process Record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Order Type - Sales is Regular Order
      *   |- c2    : DB1.Order Type - Sales is Transfer Order
      *   '-
     C           WOJNCD    IFEQ 'OR'                       *IF
     C           WOJNCD    OREQ 'TR'                       *OR
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           WOGMST    IFEQ 'X'                        *IF
     C           WOGMST    OREQ 'C'
     C           WOGMST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0025 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0033           Company Number
     C                     Z-ADDWOHGCD    WL0034           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    WUAVNA    P      Description Lin
     C                     MOVELWL0036    YL0010    P      UOM Primary
     C                     Z-ADDWL0037    YL0011           Unit Weight
     C                     Z-ADDWL0038    WURINB           Item Structure
     C                     Z-ADDWL0039    WURHNB           Item Structure
     C                     Z-ADDWL0040    WURGNB           Item Structure
     C                     MOVELWL0041    WUN0CD    P      Item Type Code
     C                     MOVELWL0042    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0043    YL0012           Fresh Chilling
     C                     MOVELWL0044    YL0013    P      Base_Conv_Loss
     C                     MOVELWL0045    WUXWST    P      Variety_Rendere
     C                     MOVELWL0046    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0047    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0048    YL0014           Pieces Per Head
     C                     MOVELWL0049    WUR3CD    P      Department Code
     C                     MOVELWL0050    WUSDCD    P      Group for Packa
     C                     MOVELWL0051    WUX5ST    P      Seconds Item
     C                     MOVELWL0052    YL0015    P      Piece Count Ite
     C                     Z-ADDWL0053    YL0016           Pieces Per Bag
     C                     Z-ADDWL0054    YL0017           Bags Per Unit
     C                     MOVELWL0055    WUSUST    P      Export_Domestic
     C                     MOVELWL0056    WUSVST    P      Print On Schedu
     C                     MOVELWL0057    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0058    WUSZST    P      Fresh Sched As
     C                     MOVELWL0059    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0060    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWOAJCD    WL0061    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    YL0018    P      Warehouse Type
     C                     MOVELWL0063    WUXUST    P      Trans Contol AS
     C                     MOVELWL0064    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0065    YL0019    P      Warehouse Std C
     C                     Z-ADDWL0066    YL0020           Warehouse Chill
      * Reallocate Item
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           WOGMST    IFEQ 'X'                        *IF
     C           WOGMST    OREQ 'C'
     C           WOGMST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      * Dont look at this for curr day orders -- we want it to take inv i
     C                     MOVELWUUAT1    YL0021           ODBS Sched Over
      * CASE: LCL.ODBS Sched Override Sts is eq Yes
     C           YL0021    IFEQ 'Y'                        *IF
      * If schedule was overriden in WW Ord Prod Sch POQJDFR, call this
      *  to make the changes stick.
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0067           Company Number
     C                     Z-ADDWOC4NB    WL0068           Order Number
     C                     Z-ADDWODPNB    WL0069           Order Sequence
     C                     Z-ADDWOUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
      * Rtv & Chg ALC sts    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0071           Company Number
     C                     Z-ADDWOC4NB    WL0072           Order Number
     C                     Z-ADDWODPNB    WL0073           Order Sequence
     C                     Z-ADDWOUENB    WL0074           Order Secondary
     C                     EXSR SSRVGN
     C                     Z-ADD*ZERO     YL0022           Quantity Schedu
     C                     Z-ADD*ZERO     YL0023           Weight Schedule
      * UPS Re-Alc Inv/Prd OV RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0075           Company Number
     C                     Z-ADDWOC4NB    WL0076           Order Number
     C                     Z-ADDWODPNB    WL0077           Order Sequence
     C                     Z-ADDWOUENB    WL0078           Order Secondary
     C                     Z-ADDYL0022    WL0079           Quantity Schedu
     C                     Z-ADDYL0023    WL0080           Weight Schedule
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    YL0022           Quantity Schedu
     C                     Z-ADDWL0080    YL0023           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0326           Company Number
     C                     Z-ADDWOC4NB    WL0327           Order Number
     C                     Z-ADDWODPNB    WL0328           Order Sequence
     C                     Z-ADDWOUENB    WL0329           Order Secondary
     C                     EXSR NMRVGN
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0067           Company Number
     C                     Z-ADDWOC4NB    WL0068           Order Number
     C                     Z-ADDWODPNB    WL0069           Order Sequence
     C                     Z-ADDWOUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
     C                     Z-ADD*ZERO     YL0022           Quantity Schedu
     C                     Z-ADD*ZERO     YL0023           Weight Schedule
      * Rtv User Rls Override RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0330           Company Number
     C                     Z-ADDWOC4NB    WL0331           Order Number
     C                     Z-ADDWODPNB    WL0332           Order Sequence
     C                     Z-ADDWOUENB    WL0333           Order Secondary
     C                     EXSR NNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0334    YL0080    P      Released by Use
      * LCL.Quantity/Weight Ordered
      * CASE: LCL.Released by User Sts Y/N is yes
     C           YL0080    IFEQ 'Y'                        *IF
     C                     Z-ADDWOCCQT    YL0081           Quantity Ordere
     C                     Z-ADDWOAUWG    YL0082           Weight Ordered
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWOAVQT    YL0081           Quantity Ordere
     C                     Z-ADDWOD0WG    YL0082           Weight Ordered
     C                     END                             *FI
      * FP1309 PASS NEW FIELDS
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOAIC3    WQ0141  30       Company Number
     C                     PARM WOC4NB    WQ0142  70       Order Number
     C                     PARM WODPNB    WQ0143  30       Order Sequence
     C                     PARM WOUENB    WQ0144  30       Order Secondary
     C                     PARM WOHGCD    WQ0145  70       Item Code
     C                     PARM WOAJCD    WQ0146  3        Warehouse Code
     C                     PARM WOA5DT    WQ0147  70       Ship Date USR
     C                     PARM YL0081    WQ0148 112       Quantity Ordere
     C                     PARM YL0082    WQ0149 112       Weight Ordered
     C           YL0022    PARM YL0022    WQ0150 112       Quantity Schedu
     C           YL0023    PARM YL0023    WQ0151 112       Weight Schedule
     C                     PARM WODDST    WQ0152  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0153 10        PSAA Program Na
     C                     PARM WORINY    WQ0154  40       Item Age Days
     C                     PARM WOTIDT    WQ0155  70       Production Ovr
     C                     PARM WOTJDT    WQ0156  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Short  -- make it ship off cut and retry   RMC-change 8.12.19
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : LCL.Quantity Scheduled LT DB1.Quantity Ordered
      *   |- c2    : LCL.Quantity Scheduled is Equal to zero
      *   |- c3    : DB1.Quantity Scheduled is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0022    IFLT WOAVQT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0022    IFEQ 0                          *IF
     C           WOCCQT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * WHD 48909 RMC Chg compare to lcl.sched < db1.ordered
      * Added the compare to both being 0. it wouldnt work if they did
      * CASE: DB1.Warehouse Type is Fresh
     C           WOWPST    IFEQ 'FR'                       *IF
      * Ship Off Cut  - Fresh only can be ship off cut
      * CASE: DB1.Scheduled Ship Date LE JOB.*Job date
     C           WOAODT    IFLE ##JDT                      *IF
      * RMC 5/13/19 pass qty ordered instead of db1.scheduled which is -0
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOAIC3    WQ0157  30       Company Number
     C                     PARM WOC4NB    WQ0158  70       Order Number
     C                     PARM WODPNB    WQ0159  30       Order Sequence
     C                     PARM WOUENB    WQ0160  30       Order Secondary
     C                     PARM WOHGCD    WQ0161  70       Item Code
     C                     PARM WOAJCD    WQ0162  3        Warehouse Code
     C                     PARM WOA5DT    WQ0163  70       Ship Date USR
     C                     PARM WOAVQT    WQ0164 112       Quantity Ordere
     C                     PARM WOD0WG    WQ0165 112       Weight Ordered
     C           YL0022    PARM YL0022    WQ0166 112       Quantity Schedu
     C           YL0023    PARM YL0023    WQ0167 112       Weight Schedule
     C                     PARM 'SC'      WQ0168  2        ATS Adj Type US
     C                     PARM @CN,005   WQ0169 10        PSAA Program Na
     C                     PARM WORINY    WQ0170  40       Item Age Days
     C                     PARM WOTIDT    WQ0171  70       Production Ovr
     C                     PARM WOTJDT    WQ0172  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0335           Company Number
     C                     Z-ADDWOC4NB    WL0336           Order Number
     C                     Z-ADDWODPNB    WL0337           Order Sequence
     C                     Z-ADDWOUENB    WL0338           Order Secondary
     C                     Z-ADDYL0022    WL0339           Quantity Schedu
     C                     Z-ADDYL0023    WL0340           Weight Schedule
     C                     EXSR NOCHRC
      * UPD: New Production Hold Sts
      * CASE: DB1.Quantity Ordered NE LCL.Quantity Scheduled
     C           WOAVQT    IFNE YL0022                     *IF
      * Rtv User Rls Override RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0330           Company Number
     C                     Z-ADDWOC4NB    WL0331           Order Number
     C                     Z-ADDWODPNB    WL0332           Order Sequence
     C                     Z-ADDWOUENB    WL0333           Order Secondary
     C                     EXSR NNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0334    YL0080    P      Released by Use
      * CASE: LCL.Released by User Sts Y/N is yes
     C           YL0080    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg New Prod Hold Sts CH - Order Detail Build Sched  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0341           Company Number
     C                     Z-ADDWOC4NB    WL0342           Order Number
     C                     Z-ADDWODPNB    WL0343           Order Sequence
     C                     Z-ADDWOUENB    WL0344           Order Secondary
     C                     Z-ADD1         WL0345           ODBS New Prod H
     C                     MOVELWOR4CD    WL0346    P      Sales Route Cod
     C                     MOVELWOBGCD    WL0347    P      State Code
     C                     MOVELWOX3CD    WL0348    P      Territory Code
     C                     EXSR NPCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @E6CPAI                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0033    WRAIC3           Company Number
     C                     Z-ADDWL0034    WRHGCD           Item Code
      * Establish starting position
     C           KRSSP     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0035           Description Lin
     C                     MOVEL*BLANK    WL0036           UOM Primary
     C                     Z-ADD*ZERO     WL0037           Unit Weight
     C                     Z-ADD*ZERO     WL0038           Item Structure
     C                     Z-ADD*ZERO     WL0039           Item Structure
     C                     Z-ADD*ZERO     WL0040           Item Structure
     C                     MOVEL*BLANK    WL0041           Item Type Code
     C                     MOVEL*BLANK    WL0042           Default Warehou
     C                     Z-ADD*ZERO     WL0043           Fresh Chilling
     C                     MOVEL*BLANK    WL0044           Base_Conv_Loss
     C                     MOVEL*BLANK    WL0045           Variety_Rendere
     C                     MOVEL*BLANK    WL0046           Credit Item Sta
     C                     Z-ADD*ZERO     WL0047           Std Weight_Head
     C                     Z-ADD*ZERO     WL0048           Pieces Per Head
     C                     MOVEL*BLANK    WL0049           Department Code
     C                     MOVEL*BLANK    WL0050           Group for Packa
     C                     MOVEL*BLANK    WL0051           Seconds Item
     C                     MOVEL*BLANK    WL0052           Piece Count Ite
     C                     Z-ADD*ZERO     WL0053           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0054           Bags Per Unit
     C                     MOVEL*BLANK    WL0055           Export_Domestic
     C                     MOVEL*BLANK    WL0056           Print On Schedu
     C                     MOVEL*BLANK    WL0057           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0058           Fresh Sched As
     C                     MOVEL*BLANK    WL0059           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0060           Primal Group Co
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRAVNA    WL0035           Description Lin
     C                     MOVELWRADCD    WL0036           UOM Primary
     C                     Z-ADDWRAIWG    WL0037           Unit Weight
     C                     Z-ADDWRRINB    WL0038           Item Structure
     C                     Z-ADDWRRHNB    WL0039           Item Structure
     C                     Z-ADDWRRGNB    WL0040           Item Structure
     C                     MOVELWRN0CD    WL0041           Item Type Code
     C                     MOVELWRQ1CD    WL0042           Default Warehou
     C                     Z-ADDWRCHTM    WL0043           Fresh Chilling
     C                     MOVELWRQZCD    WL0044           Base_Conv_Loss
     C                     MOVELWRXWST    WL0045           Variety_Rendere
     C                     MOVELWRVMST    WL0046           Credit Item Sta
     C                     Z-ADDWRSWGH    WL0047           Std Weight_Head
     C                     Z-ADDWRPPHE    WL0048           Pieces Per Head
     C                     MOVELWRR3CD    WL0049           Department Code
     C                     MOVELWRSDCD    WL0050           Group for Packa
     C                     MOVELWRX5ST    WL0051           Seconds Item
     C                     MOVELWRPCCT    WL0052           Piece Count Ite
     C                     Z-ADDWRBDNB    WL0053           Pieces Per Bag
     C                     Z-ADDWRBJNB    WL0054           Bags Per Unit
     C                     MOVELWRSUST    WL0055           Export_Domestic
     C                     MOVELWRSVST    WL0056           Print On Schedu
     C                     MOVELWRSYST    WL0057           Fresh Inv Alloc
     C                     MOVELWRSZST    WL0058           Fresh Sched As
     C                     MOVELWRS1ST    WL0059           Frozen Inv Allo
     C                     MOVELWRXRCD    WL0060           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0061    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0062           Warehouse Type
     C                     MOVEL*BLANK    WL0063           Trans Contol AS
     C                     MOVEL*BLANK    WL0064           Warehouse Locat
     C                     MOVEL*BLANK    WL0065           Warehouse Std C
     C                     Z-ADD*ZERO     WL0066           Warehouse Chill
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSWPST    WL0062           Warehouse Type
     C                     MOVELWSXUST    WL0063           Trans Contol AS
     C                     MOVELWST0ST    WL0064           Warehouse Locat
     C                     MOVELWST1ST    WL0065           Warehouse Std C
     C                     Z-ADDWSDBNB    WL0066           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSR02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSR03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSR04           Order Secondary
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           WQSR03           Order Sequence
     C                     KFLD           WQSR04           Order Secondary
      * Setup key
     C                     Z-ADDWL0067    WQSR01           Company Number
     C                     Z-ADDWL0068    WQSR02           Order Number
     C                     Z-ADDWL0069    WQSR03           Order Sequence
     C                     Z-ADDWL0070    WQSR04           Order Secondary
      * Establish starting position
     C           KRSSR     SETLL@B6CPNB                    *
     C           KRSSR     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0016           Company Number
     C                     Z-ADDWFC4NB    WL0017           Order Number
     C                     Z-ADDWFDPNB    WL0018           Order Sequence
     C                     Z-ADDWFUENB    WL0019           Order Secondary
     C                     Z-ADDWFJGDT    WL0020           OD Production D
     C                     Z-ADDWFOONY    WL0021           ODS Sequence Nu
     C                     EXSR SHDLRC
     C           KRSSR     READE@B6CPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv & Chg ALC sts    RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSS02           Order Number
     C           *LIKE     DEFN WCDPNB    WQSS03           Order Sequence
     C           *LIKE     DEFN WCUENB    WQSS04           Order Secondary
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
     C                     KFLD           WQSS03           Order Sequence
     C                     KFLD           WQSS04           Order Secondary
      * Setup key
     C                     Z-ADDWL0071    WQSS01           Company Number
     C                     Z-ADDWL0072    WQSS02           Order Number
     C                     Z-ADDWL0073    WQSS03           Order Sequence
     C                     Z-ADDWL0074    WQSS04           Order Secondary
      * Establish starting position
     C           KRSSS     SETLL@KNCPHO                    *
     C           KRSSS     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Reallocate Sts    CH - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0005           Company Number
     C                     Z-ADDWCC4NB    WL0006           Order Number
     C                     Z-ADDWCDPNB    WL0007           Order Sequence
     C                     Z-ADDWCUENB    WL0008           Order Secondary
     C                     Z-ADDWCJGDT    WL0009           OD Production D
     C                     MOVEL'Y'       WL0010    P      OD Reallocate S
     C                     EXSR SECHRC
     C           KRSSS     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prd OV RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * R5947 5/13/16 RMC Dont alloc inventory for Block orders- added bl
      * E2073 8/01/12 RMC For inventory calcs, use Whs Inventory Chill fi
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0075    WTAIC3           Company Number
     C                     Z-ADDWL0076    WTC4NB           Order Number
     C                     Z-ADDWL0077    WTDPNB           Order Sequence
     C                     Z-ADDWL0078    WTUENB           Order Secondary
      * Establish starting position
     C           KRSST     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           WTGMST    IFEQ 'X'                        *IF
     C           WTGMST    OREQ 'C'
     C           WTGMST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0026 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0033           Company Number
     C                     Z-ADDWTHGCD    WL0034           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    WUAVNA    P      Description Lin
     C                     MOVELWL0036    YL0024    P      UOM Primary
     C                     Z-ADDWL0037    YL0025           Unit Weight
     C                     Z-ADDWL0038    WURINB           Item Structure
     C                     Z-ADDWL0039    WURHNB           Item Structure
     C                     Z-ADDWL0040    WURGNB           Item Structure
     C                     MOVELWL0041    WUN0CD    P      Item Type Code
     C                     MOVELWL0042    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0043    YL0026           Fresh Chilling
     C                     MOVELWL0044    YL0027    P      Base_Conv_Loss
     C                     MOVELWL0045    WUXWST    P      Variety_Rendere
     C                     MOVELWL0046    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0047    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0048    YL0028           Pieces Per Head
     C                     MOVELWL0049    WUR3CD    P      Department Code
     C                     MOVELWL0050    WUSDCD    P      Group for Packa
     C                     MOVELWL0051    WUX5ST    P      Seconds Item
     C                     MOVELWL0052    YL0029    P      Piece Count Ite
     C                     Z-ADDWL0053    YL0030           Pieces Per Bag
     C                     Z-ADDWL0054    YL0031           Bags Per Unit
     C                     MOVELWL0055    WUSUST    P      Export_Domestic
     C                     MOVELWL0056    WUSVST    P      Print On Schedu
     C                     MOVELWL0057    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0058    WUSZST    P      Fresh Sched As
     C                     MOVELWL0059    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0060    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWTAJCD    WL0061    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    YL0032    P      Warehouse Type
     C                     MOVELWL0063    WUXUST    P      Trans Contol AS
     C                     MOVELWL0064    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0065    YL0033    P      Warehouse Std C
     C                     Z-ADDWL0066    YL0034           Warehouse Chill
      * RTV Warehous Inv ChillRT - Warehouse  * 
     C                     EXSR SURVGN
      * UPS Re-Alc Inv/Prd OV RT - Order Detail Schedule  * 
     C                     EXSR SVRVGN
      * We don't want to create a negative availability for the future.
      * Chg Qty/WgtSch & Shrt CH - Order Detail  * 
     C                     EXSR NLCHRC
     C                     END                             *FI
     C                     ENDIF
      * USER: Exit processing
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0077    WQ0135  30       Company Number
     C                     PARM YL0078    WQ0136  70       Order Number
     C                     PARM YL0079    WQ0137  70       Ship To Custome
     C           WUJZVA    PARM WUJZVA    WQ0138 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0139 112       Order Weight To
     C                     PARM 'PS'      WQ0140  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0036    WL0079           Quantity Schedu
     C                     Z-ADDYL0037    WL0080           Weight Schedule
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Warehous Inv ChillRT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWTAJCD    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0035           WHS Inventory C
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSBVC3    YL0035           WHS Inventory C
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prd OV RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0027 112       ATS Quantity Ne
     C                     Z-ADD*ZERO     WN0028 112       ATS Weight Need
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S7354 9/28/16 RMC chg dates on getting age dates in INV section
      * R5947 5/13/16 RMC Dont alloc inventory for Block orders-added blo
      * E2073 9/05/12 RMC instead of pdkncpl9 use, pdkncplb w/ date ascen
      *    and try to get inventory for sched overridden dates
      * E2073 8/01/12 RMC For inventory calcs, use Whs Inventory Chill fi
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0067           Company Number
     C                     Z-ADDWTC4NB    WL0068           Order Number
     C                     Z-ADDWTDPNB    WL0069           Order Sequence
     C                     Z-ADDWTUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0022           Company Number
     C                     Z-ADDWTC4NB    WL0023           Order Number
     C                     Z-ADDWTDPNB    WL0024           Order Sequence
     C                     Z-ADDWTUENB    WL0025           Order Secondary
     C                     EXSR SIRVGN
     C                     Z-ADD*ZERO     YL0036           Quantity Schedu
     C                     Z-ADD*ZERO     YL0037           Weight Schedule
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WVC4NB    WQSV02           Order Number
     C           *LIKE     DEFN WVDPNB    WQSV03           Order Sequence
     C           *LIKE     DEFN WVUENB    WQSV04           Order Secondary
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
     C                     KFLD           WQSV03           Order Sequence
     C                     KFLD           WQSV04           Order Secondary
      * Setup key
     C                     Z-ADDWTAIC3    WQSV01           Company Number
     C                     Z-ADDWTC4NB    WQSV02           Order Number
     C                     Z-ADDWTDPNB    WQSV03           Order Sequence
     C                     Z-ADDWTUENB    WQSV04           Order Secondary
      * Establish starting position
     C           KRSSV     SETLL@KNCPOC                    *
     C           KRSSV     READE@KNCPOC                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDWVJGDT    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0039    P      Production Day
      * S0538 RMC Always alloc orders 3/16/2010
     C                     MOVEL'Y'       YL0039           Production Day
      * FP1309  Pull the requested delivery date from the order header
      * RTV Requested Dlvry dt RT - Order Header TRG  * 
     C                     EXSR SXRVGN
      * Allocate Inventory/Production
      * CASE: LCL.Production Day Status is yes
     C           YL0039    IFEQ 'Y'                        *IF
      * Production Date < Job Date, Allocate Inventory.
      * CASE: DB1.OD Production Date LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
      * Quantity Ordered
      * LCL.Quantity Ordered =
      *    *COMPUTE (x1 + x2)
      * x1    : DB1.OD Qty/Cnsmd Pieces Sched
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.OD Quantity Inv Sched
     C           WVIGQT    ADD  WVIUQT    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0042           Quantity Ordere
      * Weight Ordered
      * LCL.Weight Ordered =
      *    *COMPUTE (x1 + x2)
      * x1    : DB1.OD Weight Scheduled
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.OD Weight Inv Sched
     C           WVFLWG    ADD  WVF3WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0043           Weight Ordered
      * Delete old record with Prod Date < Job Date
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0011           Company Number
     C                     Z-ADDWVC4NB    WL0012           Order Number
     C                     Z-ADDWVDPNB    WL0013           Order Sequence
     C                     Z-ADDWVUENB    WL0014           Order Secondary
     C                     Z-ADDWVJGDT    WL0015           OD Production D
     C                     EXSR SFDLRC
      * Age Limit    age days or from/to dates
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
      * CASE: PAR.WHS Inventory Chill Time is greater than zero
     C           YL0035    IFGT 0                          *IF
      * E2073 8/1/12
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAIC3    WQ0025  30       Company Number
     C                     PARM YL0035    WQ0026  52       Chilling Time U
     C                     PARM WTA5DT    WQ0027  70       Scheduled Ship
     C                     PARM YL0040    WQ0028  70       Requested Deliv
     C                     PARM WTRINY    WQ0029  40       Item Age Days
     C                     PARM WTTIDT    WQ0030  70       Production Ovr
     C                     PARM WTTJDT    WQ0031  70       Production Ovr
     C           YL0044    PARM YL0044    WQ0032  70       Production AgeD
     C           YL0045    PARM YL0045    WQ0033  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAIC3    WQ0034  30       Company Number
     C                     PARM YL0034    WQ0035  52       Chilling Time U
     C                     PARM WTA5DT    WQ0036  70       Scheduled Ship
     C                     PARM YL0040    WQ0037  70       Requested Deliv
     C                     PARM WTRINY    WQ0038  40       Item Age Days
     C                     PARM WTTIDT    WQ0039  70       Production Ovr
     C                     PARM WTTJDT    WQ0040  70       Production Ovr
     C           YL0044    PARM YL0044    WQ0041  70       Production AgeD
     C           YL0045    PARM YL0045    WQ0042  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAIC3    WQ0043  30       Company Number
     C                     PARM YL0026    WQ0044  52       Chilling Time U
     C                     PARM WTA5DT    WQ0045  70       Scheduled Ship
     C                     PARM YL0040    WQ0046  70       Requested Deliv
     C                     PARM WTRINY    WQ0047  40       Item Age Days
     C                     PARM WTTIDT    WQ0048  70       Production Ovr
     C                     PARM WTTJDT    WQ0049  70       Production Ovr
     C           YL0044    PARM YL0044    WQ0050  70       Production AgeD
     C           YL0045    PARM YL0045    WQ0051  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Quantity Ordered > 0
      * CASE: LCL.Quantity Ordered is Greater than zero
     C           YL0042    IFGT 0                          *IF
     C                     Z-ADD##JDT     YL0046           Production Date
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     Z-ADDYL0042    YL0049           ATS Quantity Ne
     C                     Z-ADDYL0043    YL0050           ATS Weight Need
      * ** This will create the new order detail schedule record **
      *    for the current date.
      *
     C                     Z-ADD*ZERO     WN0029 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0030 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0031 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0032  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * FP1054 4/14/09 Changed to pass par.to date usr to RTV
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0044    IFLT ##JDT                      *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0084           Company Number
     C                     Z-ADDWVHGCD    WL0085           Item Code
     C                     MOVELWVAJCD    WL0086    P      Warehouse Code
     C                     Z-ADDYL0044    WL0087           Production Date
     C                     Z-ADDYL0025    WL0088           Unit Weight
     C                     MOVELYL0029    WL0089    P      Piece Count Ite
     C                     Z-ADDYL0030    WL0090           Pieces Per Bag
     C                     Z-ADDYL0031    WL0091           Bags Per Unit
     C                     Z-ADDWVC4NB    WL0092           Order Number
     C                     Z-ADDWVDPNB    WL0093           Order Sequence
     C                     Z-ADDWVUENB    WL0094           Order Secondary
     C                     Z-ADDYL0042    WL0095           Quantity Ordere
     C                     Z-ADDYL0043    WL0096           Weight Ordered
     C                     Z-ADDYL0047    WL0097           Quantity Schedu
     C                     Z-ADDYL0048    WL0098           Weight Schedule
     C                     Z-ADDYL0049    WL0099           ATS Quantity Ne
     C                     Z-ADDYL0050    WL0100           ATS Weight Need
     C                     Z-ADDWTA5DT    WL0101           Ship Date USR
     C                     Z-ADD##JDT     WL0102           To Date
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0097    YL0047           Quantity Schedu
     C                     Z-ADDWL0098    YL0048           Weight Schedule
     C                     Z-ADDWL0099    YL0049           ATS Quantity Ne
     C                     Z-ADDWL0100    YL0050           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
      * this will happen when curr day rcd is processed
     C                     ADD  YL0047    YL0036           Quantity Schedu
     C                     ADD  YL0048    YL0037           Weight Schedule
     C                     END                             *FI
      * Production Date >= Job Date, Allocate Inv, Prod, or Std  NEW 2.5.
      * CASE: DB1.OD Production Date GE JOB.*Job date
     C           WVJGDT    IFGE ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Save records qty/wts
     C                     Z-ADDWVIUQT    YL0055           OD Quantity Inv
     C                     Z-ADDWVF3WG    YL0056           OD Weight Inv S
     C                     Z-ADDWVIGQT    YL0057           OD Qty/Cnsmd Pi
     C                     Z-ADDWVFLWG    YL0058           OD Weight Sched
      * Delete old record with Prod Date
      * Delete rcd with prod date if inv is 0 ,, else leave inventory
      * CASE: DB1.OD Quantity Inv Sched is Equal to zero
     C           WVIUQT    IFEQ 0                          *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0011           Company Number
     C                     Z-ADDWVC4NB    WL0012           Order Number
     C                     Z-ADDWVDPNB    WL0013           Order Sequence
     C                     Z-ADDWVUENB    WL0014           Order Secondary
     C                     Z-ADDWVJGDT    WL0015           OD Production D
     C                     EXSR SFDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Leave inventory
      * CHG Qty/Wgt Sched only CH - Order Detail Schedule  * 
     C                     EXSR TICHRC
     C                     END                             *FI
      * ------------------------------
      * E2885 RMC 1/30/14 For Override, If FZ then dont take inv for futu
      *     If FR then take inventory if its there  5/13/16 if not Block
      *  IF Fresh try to get inv
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0032    IFEQ 'FR'                       *IF
      * E2885 inv may exist if created from a past prod date in above rtn
     C                     Z-ADDYL0057    YL0055           OD Quantity Inv
     C                     Z-ADDYL0058    YL0056           OD Weight Inv S
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
      * ------------------------------
      * Allocate Inventory
      * CASE: LCL.OD Quantity Inv Sched is GT Zero
     C           YL0055    IFGT 0                          *IF
      * Age Limit  age days and from/to dates
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
      * CASE: PAR.WHS Inventory Chill Time is greater than zero
     C           YL0035    IFGT 0                          *IF
      * E2073 8/01/12
      * E2073 8/01/12
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAIC3    WQ0052  30       Company Number
     C                     PARM YL0035    WQ0053  52       Chilling Time U
     C                     PARM WTA5DT    WQ0054  70       Scheduled Ship
     C                     PARM YL0040    WQ0055  70       Requested Deliv
     C                     PARM WTRINY    WQ0056  40       Item Age Days
     C                     PARM WTTIDT    WQ0057  70       Production Ovr
     C                     PARM WTTJDT    WQ0058  70       Production Ovr
     C           YL0044    PARM YL0044    WQ0059  70       Production AgeD
     C           YL0045    PARM YL0045    WQ0060  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAIC3    WQ0061  30       Company Number
     C                     PARM YL0034    WQ0062  52       Chilling Time U
     C                     PARM WTA5DT    WQ0063  70       Scheduled Ship
     C                     PARM YL0040    WQ0064  70       Requested Deliv
     C                     PARM WTRINY    WQ0065  40       Item Age Days
     C                     PARM WTTIDT    WQ0066  70       Production Ovr
     C                     PARM WTTJDT    WQ0067  70       Production Ovr
     C           YL0044    PARM YL0044    WQ0068  70       Production AgeD
     C           YL0045    PARM YL0045    WQ0069  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAIC3    WQ0070  30       Company Number
     C                     PARM YL0026    WQ0071  52       Chilling Time U
     C                     PARM WTA5DT    WQ0072  70       Scheduled Ship
     C                     PARM YL0040    WQ0073  70       Requested Deliv
     C                     PARM WTRINY    WQ0074  40       Item Age Days
     C                     PARM WTTIDT    WQ0075  70       Production Ovr
     C                     PARM WTTJDT    WQ0076  70       Production Ovr
     C           YL0044    PARM YL0044    WQ0077  70       Production AgeD
     C           YL0045    PARM YL0045    WQ0078  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     Z-ADDYL0055    YL0042           Quantity Ordere
     C                     Z-ADDYL0056    YL0043           Weight Ordered
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     Z-ADDYL0042    YL0049           ATS Quantity Ne
     C                     Z-ADDYL0043    YL0050           ATS Weight Need
      * ** This will create the new order detail schedule record **
      *    for the current date.
      *
     C                     Z-ADD*ZERO     WN0187 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0188 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0189 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0190  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * FP1054 4/14/09 Changed to pass par.to date usr to RTV
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0044    IFLT ##JDT                      *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0084           Company Number
     C                     Z-ADDWVHGCD    WL0085           Item Code
     C                     MOVELWVAJCD    WL0086    P      Warehouse Code
     C                     Z-ADDYL0044    WL0087           Production Date
     C                     Z-ADDYL0025    WL0088           Unit Weight
     C                     MOVELYL0029    WL0089    P      Piece Count Ite
     C                     Z-ADDYL0030    WL0090           Pieces Per Bag
     C                     Z-ADDYL0031    WL0091           Bags Per Unit
     C                     Z-ADDWVC4NB    WL0092           Order Number
     C                     Z-ADDWVDPNB    WL0093           Order Sequence
     C                     Z-ADDWVUENB    WL0094           Order Secondary
     C                     Z-ADDYL0042    WL0095           Quantity Ordere
     C                     Z-ADDYL0043    WL0096           Weight Ordered
     C                     Z-ADDYL0047    WL0097           Quantity Schedu
     C                     Z-ADDYL0048    WL0098           Weight Schedule
     C                     Z-ADDYL0049    WL0099           ATS Quantity Ne
     C                     Z-ADDYL0050    WL0100           ATS Weight Need
     C                     Z-ADDWTA5DT    WL0101           Ship Date USR
     C                     Z-ADD##JDT     WL0102           To Date
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0097    YL0047           Quantity Schedu
     C                     Z-ADDWL0098    YL0048           Weight Schedule
     C                     Z-ADDWL0099    YL0049           ATS Quantity Ne
     C                     Z-ADDWL0100    YL0050           ATS Weight Need
     C                     END                             *FI
     C                     ADD  YL0047    YL0036           Quantity Schedu
     C                     ADD  YL0048    YL0037           Weight Schedule
     C                     END                             *FI
      * ------------------------------
      * E2073 RMC 8/27/12 For Override, If inventory taken, then reduce s
      * by access inv taken... this is the new need
      * CASE: LCL.Quantity Scheduled LT LCL.OD Qty/Cnsmd Pieces Sched
     C           YL0047    IFLT YL0057                     *IF
     C                     SUB  YL0047    YL0057           OD Qty/Cnsmd Pi
     C                     SUB  YL0048    YL0058           OD Weight Sched
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0057           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     YL0058           OD Weight Sched
     C                     END                             *FI
     C                     END                             *FI
      * ------------------------------
      * Allocate Production Or Standard
      * CASE: LCL.OD Qty/Cnsmd Pieces Sched is Greater than zero
     C           YL0057    IFGT 0                          *IF
     C                     Z-ADDYL0057    YL0042           Quantity Ordere
     C                     Z-ADDYL0058    YL0043           Weight Ordered
     C                     Z-ADDYL0057    YL0049           ATS Quantity Ne
     C                     Z-ADDYL0058    YL0050           ATS Weight Need
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0032    IFEQ 'FZ'                       *IF
      * If Base, allocated Production. If Converted, allocate Standard
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWVAJCD    WL0129    P      Warehouse Code
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0130    YL0059    P      Production Ware
     C                     Z-ADDWL0131    YL0060           Accounting Comp
      * IF ord's whse <> prodctn whse, 1st move prod from prod whse to or
      * CASE: DB1.Warehouse Code NE LCL.Production Warehouse Code
     C           WVAJCD    IFNE YL0059                     *IF
     C                     Z-ADDYL0057    WN0027           ATS Quantity Ne
     C                     Z-ADDYL0058    WN0028           ATS Weight Need
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
      *
     C                     MOVEL*BLANK    WN0191  1        Production Type
     C                     Z-ADD*ZERO     WN0192 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0193 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0194  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0195 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0196  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0197  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0198  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0199  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0200  52       Production Yiel
     C                     Z-ADD*ZERO     WN0201  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0202 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UASUBR                     documentation
      * CASE: PAR.PSAA Program Name is Sched as ordered-Override
     C           @CN,004   IFEQ @CN,004                    *IF
      * IF called from sched override routine, dont get block order flag
     C                     MOVEL*BLANK    YL0061           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0132           Company Number
     C                     Z-ADDWVC4NB    WL0133           Order Number
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    YL0061    P      Block Order Fla
     C                     END                             *FI
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0032    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0135           Company Number
     C                     Z-ADDWVHGCD    WL0136           Item Code
     C                     Z-ADDWVC4NB    WL0138           Order Number
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0137    YL0062    P      Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0198           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0198           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UBSUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0062    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0046           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFLE YL0065                     *IF
     C           WN0027    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0191           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0143           Company Number
     C                     MOVELWN0191    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0191           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0191           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0147           Company Number
     C                     MOVELWN0191    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELYL0059    WL0151    P      Warehouse Code
     C                     Z-ADDWN0193    WL0153           ATS Weight Avai
     C                     Z-ADDWN0194    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0198    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0199           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0193           ATS Weight Avai
     C                     Z-ADDWL0154    WN0194           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0194    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0192           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0193    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0192           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0192           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0192    IFLT WN0027                     *IF
     C                     Z-ADDWN0027    WN0192           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0192    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           WN0027    IFGT WN0192                     *IF
     C                     ADD  WN0192    YL0047           Quantity Schedu
     C           WN0192    MULT YL0025    WN0193           ATS Weight Avai
     C                     ADD  WN0193    YL0048           Weight Schedule
     C                     Z-ADDWN0193    WN0196           Weight Allocate
     C                     Z-ADDWN0192    WN0195           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           WN0027    IFLE WN0192                     *IF
     C                     ADD  WN0027    YL0047           Quantity Schedu
     C           WN0027    MULT YL0025    WN0028           ATS Weight Need
     C                     ADD  WN0028    YL0048           Weight Schedule
     C                     Z-ADDWN0028    WN0196           Weight Allocate
     C                     Z-ADDWN0027    WN0195           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0195    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0195    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0197           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0197    MULT WN0199    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0196           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           YL0059    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELYL0059    WL0162    P      Warehouse Code
     C                     MOVELYL0059    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0196    WL0165           Weight Allocate
     C                     Z-ADDWN0195    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           YL0059    IFNE WVAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0168           Company Number
     C                     MOVELWN0191    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELYL0059    WL0172    P      Warehouse Code
     C                     Z-ADDWN0196    WL0173           Weight Allocate
     C                     Z-ADDWN0197    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0191    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0197    WL0271           Pieces Schedule
     C                     Z-ADDWN0196    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0273           Company Number
     C                     MOVELWN0191    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELYL0059    WL0277    P      Warehouse Code
     C                     Z-ADDWN0196    WL0278           Weight Allocate
     C                     Z-ADDWN0197    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0195           Quantity Alloca
     C                     Z-ADD*ZERO     WN0196           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT 0                          *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD1         WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WVIGQT    SUB  YL0047    WN0027           ATS Quantity Ne
     C           WVFLWG    SUB  YL0048    WN0028           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0062    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           WN0027    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0191           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0143           Company Number
     C                     MOVELWN0191    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0191           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0191           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0147           Company Number
     C                     MOVELWN0191    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELYL0059    WL0151    P      Warehouse Code
     C                     Z-ADDWN0193    WL0153           ATS Weight Avai
     C                     Z-ADDWN0194    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0198    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0199           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0193           ATS Weight Avai
     C                     Z-ADDWL0154    WN0194           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0194    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0192           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0193    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0192           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0192           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0192    IFLT WN0027                     *IF
     C                     Z-ADDWN0027    WN0192           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0192    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           WN0027    IFGT WN0192                     *IF
     C                     ADD  WN0192    YL0047           Quantity Schedu
     C           WN0192    MULT YL0025    WN0193           ATS Weight Avai
     C                     ADD  WN0193    YL0048           Weight Schedule
     C                     Z-ADDWN0193    WN0196           Weight Allocate
     C                     Z-ADDWN0192    WN0195           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           WN0027    IFLE WN0192                     *IF
     C                     ADD  WN0027    YL0047           Quantity Schedu
     C           WN0027    MULT YL0025    WN0028           ATS Weight Need
     C                     ADD  WN0028    YL0048           Weight Schedule
     C                     Z-ADDWN0028    WN0196           Weight Allocate
     C                     Z-ADDWN0027    WN0195           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0195    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0195    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0197           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0197    MULT WN0199    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0196           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           YL0059    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELYL0059    WL0162    P      Warehouse Code
     C                     MOVELYL0059    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0196    WL0165           Weight Allocate
     C                     Z-ADDWN0195    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           YL0059    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0168           Company Number
     C                     MOVELWN0191    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELYL0059    WL0172    P      Warehouse Code
     C                     Z-ADDWN0196    WL0173           Weight Allocate
     C                     Z-ADDWN0197    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0191    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0197    WL0271           Pieces Schedule
     C                     Z-ADDWN0196    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0273           Company Number
     C                     MOVELWN0191    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELYL0059    WL0277    P      Warehouse Code
     C                     Z-ADDWN0196    WL0278           Weight Allocate
     C                     Z-ADDWN0197    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0195           Quantity Alloca
     C                     Z-ADD*ZERO     WN0196           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WVIGQT    SUB  YL0047    WN0027           ATS Quantity Ne
     C           WVFLWG    SUB  YL0048    WN0028           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           WVIGQT    SUB  YL0047    WN0027           ATS Quantity Ne
     C           WVFLWG    SUB  YL0048    WN0028           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0032    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0076           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0198           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0198           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UCSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0076    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           WN0027    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0191           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0143           Company Number
     C                     MOVELWN0191    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0191           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0191           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0147           Company Number
     C                     MOVELWN0191    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELYL0059    WL0151    P      Warehouse Code
     C                     Z-ADDWN0193    WL0153           ATS Weight Avai
     C                     Z-ADDWN0194    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0198    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0199           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0193           ATS Weight Avai
     C                     Z-ADDWL0154    WN0194           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0194    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0192           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0193    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0192           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0192           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0192    IFLT WN0027                     *IF
     C                     Z-ADDWN0027    WN0192           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0192    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           WN0027    IFGT WN0192                     *IF
     C                     ADD  WN0192    YL0047           Quantity Schedu
     C           WN0192    MULT YL0025    WN0193           ATS Weight Avai
     C                     ADD  WN0193    YL0048           Weight Schedule
     C                     Z-ADDWN0193    WN0196           Weight Allocate
     C                     Z-ADDWN0192    WN0195           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           WN0027    IFLE WN0192                     *IF
     C                     ADD  WN0027    YL0047           Quantity Schedu
     C           WN0027    MULT YL0025    WN0028           ATS Weight Need
     C                     ADD  WN0028    YL0048           Weight Schedule
     C                     Z-ADDWN0028    WN0196           Weight Allocate
     C                     Z-ADDWN0027    WN0195           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0195    IFGT 0                          *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0195    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0197           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0197    MULT WN0199    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0196           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           YL0059    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELYL0059    WL0162    P      Warehouse Code
     C                     MOVELYL0059    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0196    WL0165           Weight Allocate
     C                     Z-ADDWN0195    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           YL0059    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0168           Company Number
     C                     MOVELWN0191    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELYL0059    WL0172    P      Warehouse Code
     C                     Z-ADDWN0196    WL0173           Weight Allocate
     C                     Z-ADDWN0197    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0191    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0197    WL0271           Pieces Schedule
     C                     Z-ADDWN0196    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0273           Company Number
     C                     MOVELWN0191    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELYL0059    WL0277    P      Warehouse Code
     C                     Z-ADDWN0196    WL0278           Weight Allocate
     C                     Z-ADDWN0197    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0195           Quantity Alloca
     C                     Z-ADD*ZERO     WN0196           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0060    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WVIGQT    SUB  YL0047    WN0027           ATS Quantity Ne
     C           WVFLWG    SUB  YL0048    WN0028           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           WVIGQT    SUB  YL0047    WN0027           ATS Quantity Ne
     C           WVFLWG    SUB  YL0048    WN0028           ATS Weight Need
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0722  1        Production Type
     C                     Z-ADD*ZERO     WN0723 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0724 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0725  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0726 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0727  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0728  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0729  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0730  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0731  52       Production Yiel
     C                     Z-ADD*ZERO     WN0732  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0733 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UDSUBR                     documentation
      * CASE: PAR.PSAA Program Name is Sched as ordered-Override
     C           @CN,004   IFEQ @CN,004                    *IF
      * IF called from sched override routine, dont get block order flag
     C                     MOVEL*BLANK    YL0061           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0132           Company Number
     C                     Z-ADDWVC4NB    WL0133           Order Number
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    YL0061    P      Block Order Fla
     C                     END                             *FI
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0032    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0135           Company Number
     C                     Z-ADDWVHGCD    WL0136           Item Code
     C                     Z-ADDWVC4NB    WL0138           Order Number
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0137    YL0062    P      Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0729           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0729           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UESUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0062    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0046           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFLE YL0065                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0722           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0722    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0722           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0722           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0722    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0724    WL0153           ATS Weight Avai
     C                     Z-ADDWN0725    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0729    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0730           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0724           ATS Weight Avai
     C                     Z-ADDWL0154    WN0725           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0725    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0723           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0724    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0723           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0723           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0723    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0723           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0723    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0723                     *IF
     C                     ADD  WN0723    YL0047           Quantity Schedu
     C           WN0723    MULT YL0025    WN0724           ATS Weight Avai
     C                     ADD  WN0724    YL0048           Weight Schedule
     C                     Z-ADDWN0724    WN0727           Weight Allocate
     C                     Z-ADDWN0723    WN0726           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0723                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0727           Weight Allocate
     C                     Z-ADDYL0049    WN0726           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0726    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0726    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0728           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0728    MULT WN0730    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0727           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0727    WL0165           Weight Allocate
     C                     Z-ADDWN0726    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0722    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0727    WL0173           Weight Allocate
     C                     Z-ADDWN0728    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0722    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0728    WL0271           Pieces Schedule
     C                     Z-ADDWN0727    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0722    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0727    WL0278           Weight Allocate
     C                     Z-ADDWN0728    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0726           Quantity Alloca
     C                     Z-ADD*ZERO     WN0727           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT 0                          *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD1         WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0062    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0722           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0722    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0722           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0722           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0722    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0724    WL0153           ATS Weight Avai
     C                     Z-ADDWN0725    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0729    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0730           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0724           ATS Weight Avai
     C                     Z-ADDWL0154    WN0725           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0725    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0723           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0724    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0723           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0723           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0723    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0723           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0723    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0723                     *IF
     C                     ADD  WN0723    YL0047           Quantity Schedu
     C           WN0723    MULT YL0025    WN0724           ATS Weight Avai
     C                     ADD  WN0724    YL0048           Weight Schedule
     C                     Z-ADDWN0724    WN0727           Weight Allocate
     C                     Z-ADDWN0723    WN0726           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0723                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0727           Weight Allocate
     C                     Z-ADDYL0049    WN0726           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0726    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0726    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0728           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0728    MULT WN0730    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0727           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0727    WL0165           Weight Allocate
     C                     Z-ADDWN0726    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0722    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0727    WL0173           Weight Allocate
     C                     Z-ADDWN0728    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0722    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0728    WL0271           Pieces Schedule
     C                     Z-ADDWN0727    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0722    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0727    WL0278           Weight Allocate
     C                     Z-ADDWN0728    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0726           Quantity Alloca
     C                     Z-ADD*ZERO     WN0727           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0032    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0076           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0729           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0729           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UFSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0076    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0722           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0722    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0722           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0722           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0722    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0724    WL0153           ATS Weight Avai
     C                     Z-ADDWN0725    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0729    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0730           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0724           ATS Weight Avai
     C                     Z-ADDWL0154    WN0725           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0725    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0723           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0724    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0723           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0723           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0723    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0723           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0723    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0723                     *IF
     C                     ADD  WN0723    YL0047           Quantity Schedu
     C           WN0723    MULT YL0025    WN0724           ATS Weight Avai
     C                     ADD  WN0724    YL0048           Weight Schedule
     C                     Z-ADDWN0724    WN0727           Weight Allocate
     C                     Z-ADDWN0723    WN0726           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0723                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0727           Weight Allocate
     C                     Z-ADDYL0049    WN0726           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0726    IFGT 0                          *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0726    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0728           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0728    MULT WN0730    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0727           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0727    WL0165           Weight Allocate
     C                     Z-ADDWN0726    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0722    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0727    WL0173           Weight Allocate
     C                     Z-ADDWN0728    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0722    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0728    WL0271           Pieces Schedule
     C                     Z-ADDWN0727    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0722    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0727    WL0278           Weight Allocate
     C                     Z-ADDWN0728    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0726           Quantity Alloca
     C                     Z-ADD*ZERO     WN0727           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           YL0027    IFEQ 'C'                        *IF
     C           YL0027    OREQ 'F'
      * rmc added this 11/11/09
      *
     C                     MOVEL*BLANK    WN0734  1        Production Type
     C                     Z-ADD*ZERO     WN0735 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0736 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0737  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0738 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0739  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0740  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0741  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0742  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0743  52       Production Yiel
     C                     Z-ADD*ZERO     WN0744  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0745 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UGSUBR                     documentation
      * CASE: PAR.PSAA Program Name is Sched as ordered-Override
     C           @CN,004   IFEQ @CN,004                    *IF
      * IF called from sched override routine, dont get block order flag
     C                     MOVEL*BLANK    YL0061           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0132           Company Number
     C                     Z-ADDWVC4NB    WL0133           Order Number
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    YL0061    P      Block Order Fla
     C                     END                             *FI
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0032    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0135           Company Number
     C                     Z-ADDWVHGCD    WL0136           Item Code
     C                     Z-ADDWVC4NB    WL0138           Order Number
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0137    YL0062    P      Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0741           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0741           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UHSUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0062    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0046           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFLE YL0065                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0734           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0734    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0734           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0734           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0734    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0736    WL0153           ATS Weight Avai
     C                     Z-ADDWN0737    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0741    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0742           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0736           ATS Weight Avai
     C                     Z-ADDWL0154    WN0737           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0737    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0735           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0736    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0735           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0735           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'OA'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0735    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0735           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0735    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0735                     *IF
     C                     ADD  WN0735    YL0047           Quantity Schedu
     C           WN0735    MULT YL0025    WN0736           ATS Weight Avai
     C                     ADD  WN0736    YL0048           Weight Schedule
     C                     Z-ADDWN0736    WN0739           Weight Allocate
     C                     Z-ADDWN0735    WN0738           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0735                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0739           Weight Allocate
     C                     Z-ADDYL0049    WN0738           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0738    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0738    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0740           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0740    MULT WN0742    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0739           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0739    WL0165           Weight Allocate
     C                     Z-ADDWN0738    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0734    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0739    WL0173           Weight Allocate
     C                     Z-ADDWN0740    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0734    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0740    WL0271           Pieces Schedule
     C                     Z-ADDWN0739    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0734    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0739    WL0278           Weight Allocate
     C                     Z-ADDWN0740    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0738           Quantity Alloca
     C                     Z-ADD*ZERO     WN0739           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT 0                          *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD1         WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0062    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0734           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0734    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0734           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0734           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0734    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0736    WL0153           ATS Weight Avai
     C                     Z-ADDWN0737    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0741    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0742           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0736           ATS Weight Avai
     C                     Z-ADDWL0154    WN0737           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0737    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0735           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0736    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0735           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0735           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'OA'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0735    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0735           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0735    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0735                     *IF
     C                     ADD  WN0735    YL0047           Quantity Schedu
     C           WN0735    MULT YL0025    WN0736           ATS Weight Avai
     C                     ADD  WN0736    YL0048           Weight Schedule
     C                     Z-ADDWN0736    WN0739           Weight Allocate
     C                     Z-ADDWN0735    WN0738           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0735                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0739           Weight Allocate
     C                     Z-ADDYL0049    WN0738           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0738    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0738    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0740           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0740    MULT WN0742    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0739           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0739    WL0165           Weight Allocate
     C                     Z-ADDWN0738    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0734    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0739    WL0173           Weight Allocate
     C                     Z-ADDWN0740    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0734    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0740    WL0271           Pieces Schedule
     C                     Z-ADDWN0739    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0734    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0739    WL0278           Weight Allocate
     C                     Z-ADDWN0740    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0738           Quantity Alloca
     C                     Z-ADD*ZERO     WN0739           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0032    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0076           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0741           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0741           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UISUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0076    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0734           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0734    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0734           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0734           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0734    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0736    WL0153           ATS Weight Avai
     C                     Z-ADDWN0737    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0741    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0742           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0736           ATS Weight Avai
     C                     Z-ADDWL0154    WN0737           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0737    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0735           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0736    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0735           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0735           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'OA'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0735    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0735           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0735    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0735                     *IF
     C                     ADD  WN0735    YL0047           Quantity Schedu
     C           WN0735    MULT YL0025    WN0736           ATS Weight Avai
     C                     ADD  WN0736    YL0048           Weight Schedule
     C                     Z-ADDWN0736    WN0739           Weight Allocate
     C                     Z-ADDWN0735    WN0738           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0735                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0739           Weight Allocate
     C                     Z-ADDYL0049    WN0738           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0738    IFGT 0                          *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0738    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0740           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0740    MULT WN0742    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0739           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0739    WL0165           Weight Allocate
     C                     Z-ADDWN0738    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0734    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0739    WL0173           Weight Allocate
     C                     Z-ADDWN0740    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0734    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0740    WL0271           Pieces Schedule
     C                     Z-ADDWN0739    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0734    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0739    WL0278           Weight Allocate
     C                     Z-ADDWN0740    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0738           Quantity Alloca
     C                     Z-ADD*ZERO     WN0739           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
      * UPD Allocate Std      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDHMXFR'              90  UPD Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAJCD    WQ0079  3        Warehouse Code
     C                     PARM WVAIC3    WQ0080  30       Company Number
     C                     PARM WVHGCD    WQ0081  70       Item Code
     C           YL0046    PARM YL0046    WQ0082  70       Production Date
     C                     PARM YL0024    WQ0083  2        UOM Primary
     C                     PARM YL0025    WQ0084 112       Unit Weight
     C                     PARM YL0026    WQ0085  52       Fresh Chilling
     C                     PARM YL0029    WQ0086  1        Piece Count Ite
     C                     PARM YL0030    WQ0087  70       Pieces Per Bag
     C                     PARM YL0031    WQ0088  70       Bags Per Unit
     C                     PARM YL0032    WQ0089  2        Warehouse Type
     C                     PARM YL0033    WQ0090  1        Warehouse Std C
     C                     PARM YL0034    WQ0091  52       Warehouse Chill
     C                     PARM WVC4NB    WQ0092  70       Order Number
     C                     PARM WVDPNB    WQ0093  30       Order Sequence
     C                     PARM WVUENB    WQ0094  30       Order Secondary
     C                     PARM WVJGDT    WQ0095  70       Production Date
     C                     PARM WVJGDT    WQ0096  70       Production Date
     C                     PARM YL0042    WQ0097 112       Quantity Ordere
     C                     PARM YL0043    WQ0098 112       Weight Ordered
     C           YL0047    PARM YL0047    WQ0099 112       Quantity Schedu
     C           YL0048    PARM YL0048    WQ0100 112       Weight Schedule
     C           YL0049    PARM YL0049    WQ0101 112       ATS Quantity Ne
     C           YL0050    PARM YL0050    WQ0102 112       ATS Weight Need
     C                     PARM WTA5DT    WQ0103  70       Ship Date USR
     C                     PARM 'AO'      WQ0104  2        ATS Adj Type US
     C                     PARM @CN,004   WQ0105 10        PSAA Program Na
     C                     PARM WVAYAA    WQ0106  3        Order From Ware
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Base, allocated Production. If Converted, allocate Standard
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWVAJCD    WL0129    P      Warehouse Code
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0130    YL0059    P      Production Ware
     C                     Z-ADDWL0131    YL0060           Accounting Comp
      *
     C                     MOVEL*BLANK    WN0746  1        Production Type
     C                     Z-ADD*ZERO     WN0747 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0748 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0749  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0750 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0751  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0752  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0753  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0754  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0755  52       Production Yiel
     C                     Z-ADD*ZERO     WN0756  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0757 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UJSUBR                     documentation
      * CASE: PAR.PSAA Program Name is Sched as ordered-Override
     C           @CN,004   IFEQ @CN,004                    *IF
      * IF called from sched override routine, dont get block order flag
     C                     MOVEL*BLANK    YL0061           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0132           Company Number
     C                     Z-ADDWVC4NB    WL0133           Order Number
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    YL0061    P      Block Order Fla
     C                     END                             *FI
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0032    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0135           Company Number
     C                     Z-ADDWVHGCD    WL0136           Item Code
     C                     Z-ADDWVC4NB    WL0138           Order Number
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0137    YL0062    P      Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0753           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0753           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UKSUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0062    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0046           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFLE YL0065                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0746           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0746    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0746           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0746           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0746    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0748    WL0153           ATS Weight Avai
     C                     Z-ADDWN0749    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0753    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0754           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0748           ATS Weight Avai
     C                     Z-ADDWL0154    WN0749           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0749    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0747           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0748    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0747           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0747           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0747    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0747           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0747    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0747                     *IF
     C                     ADD  WN0747    YL0047           Quantity Schedu
     C           WN0747    MULT YL0025    WN0748           ATS Weight Avai
     C                     ADD  WN0748    YL0048           Weight Schedule
     C                     Z-ADDWN0748    WN0751           Weight Allocate
     C                     Z-ADDWN0747    WN0750           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0747                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0751           Weight Allocate
     C                     Z-ADDYL0049    WN0750           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0750    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0750    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0752           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0752    MULT WN0754    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0751           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0751    WL0165           Weight Allocate
     C                     Z-ADDWN0750    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0746    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0751    WL0173           Weight Allocate
     C                     Z-ADDWN0752    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0746    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0752    WL0271           Pieces Schedule
     C                     Z-ADDWN0751    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0746    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0751    WL0278           Weight Allocate
     C                     Z-ADDWN0752    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0750           Quantity Alloca
     C                     Z-ADD*ZERO     WN0751           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT 0                          *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD1         WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0062    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0746           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0746    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0746           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0746           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0746    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0748    WL0153           ATS Weight Avai
     C                     Z-ADDWN0749    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0753    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0754           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0748           ATS Weight Avai
     C                     Z-ADDWL0154    WN0749           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0749    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0747           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0748    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0747           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0747           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0747    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0747           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0747    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0747                     *IF
     C                     ADD  WN0747    YL0047           Quantity Schedu
     C           WN0747    MULT YL0025    WN0748           ATS Weight Avai
     C                     ADD  WN0748    YL0048           Weight Schedule
     C                     Z-ADDWN0748    WN0751           Weight Allocate
     C                     Z-ADDWN0747    WN0750           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0747                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0751           Weight Allocate
     C                     Z-ADDYL0049    WN0750           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0750    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0750    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0752           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0752    MULT WN0754    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0751           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0751    WL0165           Weight Allocate
     C                     Z-ADDWN0750    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0746    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0751    WL0173           Weight Allocate
     C                     Z-ADDWN0752    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0746    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0752    WL0271           Pieces Schedule
     C                     Z-ADDWN0751    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0746    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0751    WL0278           Weight Allocate
     C                     Z-ADDWN0752    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0750           Quantity Alloca
     C                     Z-ADD*ZERO     WN0751           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0032    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0076           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0753           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0753           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR ULSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0076    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0746           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0746    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0746           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0746           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0746    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0748    WL0153           ATS Weight Avai
     C                     Z-ADDWN0749    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0753    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0754           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0748           ATS Weight Avai
     C                     Z-ADDWL0154    WN0749           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0749    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0747           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0748    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0747           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0747           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0747    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0747           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0747    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0747                     *IF
     C                     ADD  WN0747    YL0047           Quantity Schedu
     C           WN0747    MULT YL0025    WN0748           ATS Weight Avai
     C                     ADD  WN0748    YL0048           Weight Schedule
     C                     Z-ADDWN0748    WN0751           Weight Allocate
     C                     Z-ADDWN0747    WN0750           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0747                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0751           Weight Allocate
     C                     Z-ADDYL0049    WN0750           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0750    IFGT 0                          *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0750    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0752           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0752    MULT WN0754    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0751           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0751    WL0165           Weight Allocate
     C                     Z-ADDWN0750    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0746    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0751    WL0173           Weight Allocate
     C                     Z-ADDWN0752    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0746    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0752    WL0271           Pieces Schedule
     C                     Z-ADDWN0751    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0746    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0751    WL0278           Weight Allocate
     C                     Z-ADDWN0752    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0750           Quantity Alloca
     C                     Z-ADD*ZERO     WN0751           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           YL0027    IFEQ 'C'                        *IF
     C           YL0027    OREQ 'F'
      * rmc added this 11/11/09
      *
     C                     MOVEL*BLANK    WN0758  1        Production Type
     C                     Z-ADD*ZERO     WN0759 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0760 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0761  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0762 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0763  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0764  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0765  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0766  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0767  52       Production Yiel
     C                     Z-ADD*ZERO     WN0768  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0769 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UMSUBR                     documentation
      * CASE: PAR.PSAA Program Name is Sched as ordered-Override
     C           @CN,004   IFEQ @CN,004                    *IF
      * IF called from sched override routine, dont get block order flag
     C                     MOVEL*BLANK    YL0061           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0132           Company Number
     C                     Z-ADDWVC4NB    WL0133           Order Number
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    YL0061    P      Block Order Fla
     C                     END                             *FI
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0032    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0135           Company Number
     C                     Z-ADDWVHGCD    WL0136           Item Code
     C                     Z-ADDWVC4NB    WL0138           Order Number
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0137    YL0062    P      Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0765           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0765           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UNSUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0062    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0046           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFLE YL0065                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0758           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0758    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0758           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0758           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0758    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0760    WL0153           ATS Weight Avai
     C                     Z-ADDWN0761    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0765    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0766           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0760           ATS Weight Avai
     C                     Z-ADDWL0154    WN0761           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0761    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0759           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0760    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0759           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0759           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'OA'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0759    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0759           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0759    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0759                     *IF
     C                     ADD  WN0759    YL0047           Quantity Schedu
     C           WN0759    MULT YL0025    WN0760           ATS Weight Avai
     C                     ADD  WN0760    YL0048           Weight Schedule
     C                     Z-ADDWN0760    WN0763           Weight Allocate
     C                     Z-ADDWN0759    WN0762           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0759                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0763           Weight Allocate
     C                     Z-ADDYL0049    WN0762           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0762    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0762    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0764           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0764    MULT WN0766    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0763           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0763    WL0165           Weight Allocate
     C                     Z-ADDWN0762    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0758    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0763    WL0173           Weight Allocate
     C                     Z-ADDWN0764    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0758    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0764    WL0271           Pieces Schedule
     C                     Z-ADDWN0763    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0758    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0763    WL0278           Weight Allocate
     C                     Z-ADDWN0764    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0762           Quantity Alloca
     C                     Z-ADD*ZERO     WN0763           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT 0                          *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD1         WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0062    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           YL0046    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0046
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0046
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0758           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0758    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0758           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0758           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0758    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0760    WL0153           ATS Weight Avai
     C                     Z-ADDWN0761    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0765    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0766           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0760           ATS Weight Avai
     C                     Z-ADDWL0154    WN0761           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0761    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0759           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0760    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0759           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0759           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'OA'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0759    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0759           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0759    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0759                     *IF
     C                     ADD  WN0759    YL0047           Quantity Schedu
     C           WN0759    MULT YL0025    WN0760           ATS Weight Avai
     C                     ADD  WN0760    YL0048           Weight Schedule
     C                     Z-ADDWN0760    WN0763           Weight Allocate
     C                     Z-ADDWN0759    WN0762           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0759                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0763           Weight Allocate
     C                     Z-ADDYL0049    WN0762           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0762    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0762    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0764           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0764    MULT WN0766    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0763           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0763    WL0165           Weight Allocate
     C                     Z-ADDWN0762    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0027    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0758    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0763    WL0173           Weight Allocate
     C                     Z-ADDWN0764    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0758    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0764    WL0271           Pieces Schedule
     C                     Z-ADDWN0763    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0758    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0763    WL0278           Weight Allocate
     C                     Z-ADDWN0764    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0762           Quantity Alloca
     C                     Z-ADD*ZERO     WN0763           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0032    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0076           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0034    WN0765           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0026    WN0765           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWVJGDT    YL0065           Production Date
      * DOC:  Allocation
     C                     EXSR UOSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0076    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWVJGDT    YL0075           Production Date
     C                     Z-ADDWVJGDT    YL0046           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0075           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WVJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWVJGDT    YL0065           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0061    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0075    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0075
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0075
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWVJGDT    YL0046           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGE YL0075                     *IF
     C           YL0049    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0081           Company Number
     C                     Z-ADDYL0046    WL0082           Post to G/L Dat
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0066    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0139           Company Number
     C                     Z-ADDWVHGCD    WL0140           Item Code
     C                     Z-ADDYL0046    WL0141           Production Date
     C                     MOVELYL0067    WL0142    P      Production Day
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0067    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0066    IFEQ 'Y'                        *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0046    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0758           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0143           Company Number
     C                     MOVELWN0758    WL0144    P      Production Type
     C                     Z-ADDYL0046    WL0145           Production Date
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0146    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0758           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0046    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0758           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0147           Company Number
     C                     MOVELWN0758    WL0148    P      Production Type
     C                     Z-ADDYL0046    WL0149           Production Date
     C                     Z-ADDWVHGCD    WL0150           Item Code
     C                     MOVELWVAJCD    WL0151    P      Warehouse Code
     C                     Z-ADDWN0760    WL0153           ATS Weight Avai
     C                     Z-ADDWN0761    WL0154           ATS Pieces Avai
     C                     Z-ADDWN0765    WL0155           Chilling Time U
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0766           PS Avg Piece Wg
     C                     Z-ADDWL0153    WN0760           ATS Weight Avai
     C                     Z-ADDWL0154    WN0761           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'Y'                        *IF
     C           YL0030    IFGT 0                          *IF
     C           YL0031    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0030    MULT YL0031    W0WJ01           *Synon (15,0) w
     C           WN0761    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0759           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ *BLANK                     *IF
     C           YL0029    OREQ 'N'
     C           YL0025    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0760    DIV  YL0025    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0759           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0759           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'OA'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0759    IFLT YL0049                     *IF
     C                     Z-ADDYL0049    WN0759           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0759    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0049    IFGT WN0759                     *IF
     C                     ADD  WN0759    YL0047           Quantity Schedu
     C           WN0759    MULT YL0025    WN0760           ATS Weight Avai
     C                     ADD  WN0760    YL0048           Weight Schedule
     C                     Z-ADDWN0760    WN0763           Weight Allocate
     C                     Z-ADDWN0759    WN0762           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0049    IFLE WN0759                     *IF
     C                     ADD  YL0049    YL0047           Quantity Schedu
     C           YL0049    MULT YL0025    YL0050           ATS Weight Need
     C                     ADD  YL0050    YL0048           Weight Schedule
     C                     Z-ADDYL0050    WN0763           Weight Allocate
     C                     Z-ADDYL0049    WN0762           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0762    IFGT 0                          *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0762    MULT YL0030    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0031    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0764           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0764    MULT WN0766    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0763           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFEQ WVAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0156           Company Number
     C                     Z-ADDWVC4NB    WL0157           Order Number
     C                     Z-ADDWVDPNB    WL0158           Order Sequence
     C                     Z-ADDWVUENB    WL0159           Order Secondary
     C                     Z-ADDYL0046    WL0160           OD Production D
     C                     Z-ADDWTA5DT    WL0161           Scheduled Ship
     C                     MOVELWVAJCD    WL0162    P      Warehouse Code
     C                     MOVELWVAJCD    WL0163    P      Order From Ware
     C                     Z-ADDWVHGCD    WL0164           Item Code
     C                     Z-ADDWN0763    WL0165           Weight Allocate
     C                     Z-ADDWN0762    WL0166           Quantity Alloca
     C                     MOVELYL0027    WL0167    P      Base_Conv_Loss
     C                     EXSR TTRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WVAJCD    IFNE WVAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0168           Company Number
     C                     MOVELWN0758    WL0169    P      Production Type
     C                     Z-ADDYL0046    WL0170           Production Date
     C                     Z-ADDWVHGCD    WL0171           Item Code
     C                     MOVELWVAJCD    WL0172    P      Warehouse Code
     C                     Z-ADDWN0763    WL0173           Weight Allocate
     C                     Z-ADDWN0764    WL0174           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0175           Order Number
     C                     Z-ADDWVDPNB    WL0176           Order Sequence
     C                     Z-ADDWVUENB    WL0177           Order Secondary
     C                     MOVEL'N'       WL0178    P      Status Flag 19
     C                     EXSR TVRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0266           Company Number
     C                     MOVELWN0758    WL0267    P      Production Type
     C                     Z-ADDYL0046    WL0268           Production Date
     C                     Z-ADDWVHGCD    WL0269           Item Code
     C                     MOVELWVAJCD    WL0270    P      Warehouse Code
     C                     Z-ADDWN0764    WL0271           Pieces Schedule
     C                     Z-ADDWN0763    WL0272           Weight Schedule
     C                     EXSR TZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0273           Company Number
     C                     MOVELWN0758    WL0274    P      Production Type
     C                     Z-ADDYL0046    WL0275           Production Date
     C                     Z-ADDWVHGCD    WL0276           Item Code
     C                     MOVELWVAJCD    WL0277    P      Warehouse Code
     C                     Z-ADDWN0763    WL0278           Weight Allocate
     C                     Z-ADDWN0764    WL0279           Pieces Allocate
     C                     Z-ADDWVC4NB    WL0280           Order Number
     C                     Z-ADDWVDPNB    WL0281           Order Sequence
     C                     Z-ADDWVUENB    WL0282           Order Secondary
     C                     MOVEL'N'       WL0283    P      Status Flag 19
     C                     EXSR NBRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0762           Quantity Alloca
     C                     Z-ADD*ZERO     WN0763           Weight Allocate
     C                     Z-ADD*ZERO     YL0047           Quantity Schedu
     C                     Z-ADD*ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0047           Quantity Schedu
     C                     ADD  *ZERO     YL0048           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0316           Company Number
     C                     Z-ADDYL0046    WL0317           Post to G/L Dat
     C                     Z-ADDYL0046    WL0319           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0320           *Duration (fact
     C                     EXSR NJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0318    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0321           Company Number
     C                     Z-ADDYL0046    WL0322           Post to G/L Dat
     C                     Z-ADDYL0046    WL0324           *Date2 (beginni
     C                     Z-ADD-1        WL0325           *Duration (fact
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0323    YL0046           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDYL0046    YL0046           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0042    SUB  YL0047    YL0049           ATS Quantity Ne
     C           YL0043    SUB  YL0048    YL0050           ATS Weight Need
     C                     END                             *FI
      * UPD Allocate Std      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDHMXFR'              90  UPD Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAJCD    WQ0107  3        Warehouse Code
     C                     PARM WVAIC3    WQ0108  30       Company Number
     C                     PARM WVHGCD    WQ0109  70       Item Code
     C           YL0046    PARM YL0046    WQ0110  70       Production Date
     C                     PARM YL0024    WQ0111  2        UOM Primary
     C                     PARM YL0025    WQ0112 112       Unit Weight
     C                     PARM YL0026    WQ0113  52       Fresh Chilling
     C                     PARM YL0029    WQ0114  1        Piece Count Ite
     C                     PARM YL0030    WQ0115  70       Pieces Per Bag
     C                     PARM YL0031    WQ0116  70       Bags Per Unit
     C                     PARM YL0032    WQ0117  2        Warehouse Type
     C                     PARM YL0033    WQ0118  1        Warehouse Std C
     C                     PARM YL0034    WQ0119  52       Warehouse Chill
     C                     PARM WVC4NB    WQ0120  70       Order Number
     C                     PARM WVDPNB    WQ0121  30       Order Sequence
     C                     PARM WVUENB    WQ0122  30       Order Secondary
     C                     PARM WVJGDT    WQ0123  70       Production Date
     C                     PARM WVJGDT    WQ0124  70       Production Date
     C                     PARM YL0042    WQ0125 112       Quantity Ordere
     C                     PARM YL0043    WQ0126 112       Weight Ordered
     C           YL0047    PARM YL0047    WQ0127 112       Quantity Schedu
     C           YL0048    PARM YL0048    WQ0128 112       Weight Schedule
     C           YL0049    PARM YL0049    WQ0129 112       ATS Quantity Ne
     C           YL0050    PARM YL0050    WQ0130 112       ATS Weight Need
     C                     PARM WTA5DT    WQ0131  70       Ship Date USR
     C                     PARM 'AO'      WQ0132  2        ATS Adj Type US
     C                     PARM @CN,004   WQ0133 10        PSAA Program Na
     C                     PARM WVAYAA    WQ0134  3        Order From Ware
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0047    YL0036           Quantity Schedu
     C                     ADD  YL0048    YL0037           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * The date the production was scheduled for is no longer a
      *   production day.
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0011           Company Number
     C                     Z-ADDWVC4NB    WL0012           Order Number
     C                     Z-ADDWVDPNB    WL0013           Order Sequence
     C                     Z-ADDWVUENB    WL0014           Order Secondary
     C                     Z-ADDWVJGDT    WL0015           OD Production D
     C                     EXSR SFDLRC
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0022           Company Number
     C                     Z-ADDWVC4NB    WL0023           Order Number
     C                     Z-ADDWVDPNB    WL0024           Order Sequence
     C                     Z-ADDWVUENB    WL0025           Order Secondary
     C                     EXSR SIRVGN
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0067           Company Number
     C                     Z-ADDWVC4NB    WL0068           Order Number
     C                     Z-ADDWVDPNB    WL0069           Order Sequence
     C                     Z-ADDWVUENB    WL0070           Order Secondary
     C                     EXSR SRRVGN
     C                     END                             *FI
     C           KRSSV     READE@KNCPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0081    WWAIC3           Company Number
     C                     Z-ADDWL0082    WWBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSW     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0083           Production Day
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWWAST    WL0083           Production Day
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Requested Dlvry dt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWVAIC3    WDAIC3           Company Number
     C                     Z-ADDWVC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSX     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDEIDT    YL0040           Requested Deliv
     C                     Z-ADDWDAFTM    YL0041           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0033 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0034 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0035  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0036 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0037  92       Weight Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0036           Quantity Alloca
     C                     Z-ADD*ZERO     WN0037           Weight Allocate
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WLHGCD    WQSY02           Item Code
     C           *LIKE     DEFN WLAJCD    WQSY03           Warehouse Code
      * Define keylist
     C           KPSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Item Code
     C                     KFLD           WQSY03           Warehouse Code
     C                     KFLD           WLELDT           Production Date
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Item Code
     C                     KFLD           WQSY03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0084    WQSY01           Company Number
     C                     Z-ADDWL0085    WQSY02           Item Code
     C                     MOVELWL0086    WQSY03           Warehouse Code
     C                     Z-ADDWL0087    WLELDT           Production Date
      * Establish starting position
     C           KPSSY     SETLL@CWCPQW                    *
     C           KRSSY     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * FP1054 this used to quit when the job date was reached.
      *   now it quits when par.to date is reached. for the freezer it wi
      *   be the freeze time number of days before the sched ship.
      *   For Fresh, it will be the job date
      * RMC 10.2.19 change GE to GT
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Production Date GT PAR.To Date               USR
      *   |- c2    : PAR.ATS Quantity Need USR is Less than or equal zero
      *   '-
     C           WLELDT    IFGT WL0102                     *IF
     C           WL0099    ORLE 0                          *OR
     C                     GOTO SYEXIT                     *QUIT
     C                     END                             *FI
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR SZRVGN
     C           WLARQT    SUB  YL0051    WN0033           ATS Quantity Av
     C           WLACWG    SUB  YL0052    WN0034           ATS Weight Avai
      * Allocate Available Inventory
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0033    IFGT 0                          *IF
      * Allocate
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           WL0099    IFGT WN0033                     *IF
     C                     ADD  WN0033    WL0097           Quantity Schedu
     C           WN0033    MULT WL0088    WN0034           ATS Weight Avai
     C                     ADD  WN0034    WL0098           Weight Schedule
     C                     Z-ADDWN0033    WN0036           Quantity Alloca
     C                     Z-ADDWN0034    WN0037           Weight Allocate
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           WL0099    IFLE WN0033                     *IF
     C                     ADD  WL0099    WL0097           Quantity Schedu
     C                     ADD  WL0100    WL0098           Weight Schedule
     C                     Z-ADDWL0099    WN0036           Quantity Alloca
     C           WN0036    MULT WL0088    WN0037           Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     WL0097           Quantity Schedu
     C                     ADD  *ZERO     WL0098           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR TARVGN
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
     C                     EXSR TDRVGN
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     C           WL0095    SUB  WL0097    WL0099           ATS Quantity Ne
     C           WL0096    SUB  WL0098    WL0100           ATS Weight Need
     C           KRSSY     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0051           OD Quantity Inv
     C                     Z-ADD*ZERO     YL0052           OD Weight Inv S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WXHGCD    WQSZ02           Item Code
     C           *LIKE     DEFN WXAJCD    WQSZ03           Warehouse Code
     C           *LIKE     DEFN WXJGDT    WQSZ04           OD Production D
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Item Code
     C                     KFLD           WQSZ03           Warehouse Code
     C                     KFLD           WQSZ04           OD Production D
      * Setup key
     C                     Z-ADDWLAIC3    WQSZ01           Company Number
     C                     Z-ADDWLHGCD    WQSZ02           Item Code
     C                     MOVELWLAJCD    WQSZ03           Warehouse Code
     C                     Z-ADDWLELDT    WQSZ04           OD Production D
      * Establish starting position
     C           KRSSZ     SETLL@B5CPM4                    *
     C           KRSSZ     READE@B5CPM4                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WXIUQT    YL0051           OD Quantity Inv
     C                     ADD  WXF3WG    YL0052           OD Weight Inv S
     C           KRSSZ     READE@B5CPM4                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0038  1        EDI Status 1
     C                     MOVEL*BLANK    WN0039  1        EDI Status 2
     C                     MOVEL*BLANK    WN0040  1        EDI Status 3
     C                     MOVEL*BLANK    WN0041  1        Record Status
     C                     Z-ADD*ZERO     WN0042  60       Job Time
     C                     MOVEL*BLANK    WN0043 10        User Id
     C                     MOVEL*BLANK    WN0044 10        Job Name
     C                     Z-ADD*ZERO     WN0045  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
      * Setup key
     C                     Z-ADDWLAIC3    WHAIC3           Company Number
     C                     Z-ADDWL0092    WHC4NB           Order Number
     C                     Z-ADDWL0093    WHDPNB           Order Sequence
     C                     Z-ADDWL0094    WHUENB           Order Secondary
     C                     Z-ADDWLELDT    WHJGDT           OD Production D
      * Establish starting position
     C           KRSTA     CHAIN@B5CPM2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3150' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
     C                     EXSR TBCRRC
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHIUQT    ADD  WN0036    YL0053           OD Quantity Inv
     C           WHF3WG    ADD  WN0037    YL0054           OD Weight Inv S
      * CASE: LCL.OD Quantity Inv Sched is LE Zero
     C           YL0053    IFLE 0                          *IF
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0026           Company Number
     C                     Z-ADDWHC4NB    WL0027           Order Number
     C                     Z-ADDWHDPNB    WL0028           Order Sequence
     C                     Z-ADDWHUENB    WL0029           Order Secondary
     C                     Z-ADDWHJGDT    WL0030           OD Production D
     C                     EXSR SJDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
     C                     EXSR TCCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B5CPM1
     C                     Z-ADDWLAIC3    WIAIC3           Company Number
     C                     Z-ADDWL0092    WIC4NB           Order Number
     C                     Z-ADDWL0093    WIDPNB           Order Sequence
     C                     Z-ADDWL0094    WIUENB           Order Secondary
     C                     Z-ADDWLELDT    WIJGDT           OD Production D
     C                     Z-ADDWL0101    WIAODT           Scheduled Ship
     C                     MOVELWLAJCD    WIAJCD           Warehouse Code
     C                     Z-ADDWLHGCD    WIHGCD           Item Code
     C                     Z-ADDWN0036    WIIUQT           OD Quantity Inv
     C                     Z-ADDWN0037    WIF3WG           OD Weight Inv S
     C                     MOVELWN0038    WIUVST           EDI Status 1
     C                     MOVELWN0039    WIUWST           EDI Status 2
     C                     MOVELWN0040    WIUXST           EDI Status 3
     C                     MOVELWN0041    WIVSST           Record Status
     C                     Z-ADDWN0042    WIAATM           Job Time
     C                     MOVELWN0043    WIAYNA           User Id
     C                     MOVELWN0044    WIA0NA           Job Name
     C                     Z-ADDWN0045    WIAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WIVSST           Record Status
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRTB    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRTB    SETLL@B5CPM1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3151' W0RTN   7
      * Send message 'Order Detail Sched-Inv EX'
     C                     MOVEL'USR3151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@B5CPM1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0046  1        EDI Status 1
     C                     MOVEL*BLANK    WN0047  1        EDI Status 2
     C                     MOVEL*BLANK    WN0048  1        EDI Status 3
     C                     MOVEL*BLANK    WN0049  1        Record Status
     C                     Z-ADD*ZERO     WN0050  60       Job Time
     C                     MOVEL*BLANK    WN0051 10        User Id
     C                     MOVEL*BLANK    WN0052 10        Job Name
     C                     Z-ADD*ZERO     WN0053  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B5CPM1
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
     C                     Z-ADDWHDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWHUENB    WIUENB           Order Secondary
     C                     Z-ADDWHJGDT    WIJGDT           OD Production D
      *
     C           KLCHTC    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
     C           KLCHTC    CHAIN@B5CPM1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB51    YCRDCS
      * Move non-key fields to @B5CPM1
     C                     Z-ADDWHAODT    WIAODT           Scheduled Ship
     C                     MOVELWLAJCD    WIAJCD    P      Warehouse Code
     C                     Z-ADDWLHGCD    WIHGCD           Item Code
     C                     Z-ADDYL0053    WIIUQT           OD Quantity Inv
     C                     Z-ADDYL0054    WIF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B5CPM1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0054 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0055 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0056 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0057 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0058 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0059 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0060  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0061  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0062  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0063  1        EDI Status 1
     C                     MOVEL*BLANK    WN0064  1        EDI Status 2
     C                     MOVEL*BLANK    WN0065  1        EDI Status 3
     C                     MOVEL*BLANK    WN0066  1        Record Status
     C                     Z-ADD*ZERO     WN0067  60       Job Time
     C                     MOVEL*BLANK    WN0068 10        User Id
     C                     MOVEL*BLANK    WN0069 10        Job Name
     C                     Z-ADD*ZERO     WN0070  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0084    WCAIC3           Company Number
     C                     Z-ADDWL0092    WCC4NB           Order Number
     C                     Z-ADDWL0093    WCDPNB           Order Sequence
     C                     Z-ADDWL0094    WCUENB           Order Secondary
     C                     Z-ADD##JDT     WCJGDT           OD Production D
      * Establish starting position
     C           KRSTD     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0084    WL0103           Company Number
     C                     Z-ADDWL0092    WL0104           Order Number
     C                     Z-ADDWL0093    WL0105           Order Sequence
     C                     Z-ADDWL0094    WL0106           Order Secondary
     C                     Z-ADD##JDT     WL0107           OD Production D
     C                     Z-ADDWL0101    WL0108           Scheduled Ship
     C                     MOVELWL0086    WL0109    P      Warehouse Code
     C                     MOVELWL0086    WL0110    P      Order From Ware
     C                     Z-ADDWL0085    WL0111           Item Code
     C                     Z-ADDWN0054    WL0112           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0055    WL0113           OD Weight Sched
     C                     Z-ADDWN0036    WL0114           OD Quantity Inv
     C                     Z-ADDWN0037    WL0115           OD Weight Inv S
     C                     Z-ADDWN0058    WL0116           OD Quantity Unu
     C                     Z-ADDWN0059    WL0117           OD Unused weigh
     C                     MOVELWN0060    WL0118    P      OD Added to Sch
     C                     MOVELWN0061    WL0119    P      OD Reallocate S
     C                     MOVELWN0062    WL0120    P      OD Status Unuse
     C                     MOVELWN0063    WL0121    P      EDI Status 1
     C                     MOVELWN0064    WL0122    P      EDI Status 2
     C                     MOVELWN0065    WL0123    P      EDI Status 3
     C                     MOVELWN0066    WL0124    P      Record Status
     C                     Z-ADDWN0067    WL0125           Job Time
     C                     MOVELWN0068    WL0126    P      User Id
     C                     MOVELWN0069    WL0127    P      Job Name
     C                     Z-ADDWN0070    WL0128           Job Date
     C                     EXSR TECRRC
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCIUQT    ADD  WN0036    WN0056           OD Quantity Inv
     C           WCF3WG    ADD  WN0037    WN0057           OD Weight Inv S
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0056    IFLE 0                          *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0011           Company Number
     C                     Z-ADDWCC4NB    WL0012           Order Number
     C                     Z-ADDWCDPNB    WL0013           Order Sequence
     C                     Z-ADDWCUENB    WL0014           Order Secondary
     C                     Z-ADDWCJGDT    WL0015           OD Production D
     C                     EXSR SFDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
     C                     EXSR TFCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KNCPHN
     C                     Z-ADDWL0103    WEAIC3           Company Number
     C                     Z-ADDWL0104    WEC4NB           Order Number
     C                     Z-ADDWL0105    WEDPNB           Order Sequence
     C                     Z-ADDWL0106    WEUENB           Order Secondary
     C                     Z-ADDWL0107    WEJGDT           OD Production D
     C                     Z-ADDWL0108    WEAODT           Scheduled Ship
     C                     MOVELWL0109    WEAJCD           Warehouse Code
     C                     MOVELWL0110    WEAYAA           Order From Ware
     C                     Z-ADDWL0111    WEHGCD           Item Code
     C                     Z-ADDWL0112    WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0113    WEFLWG           OD Weight Sched
     C                     Z-ADDWL0114    WEIUQT           OD Quantity Inv
     C                     Z-ADDWL0115    WEF3WG           OD Weight Inv S
     C                     Z-ADDWL0116    WEIVQT           OD Quantity Unu
     C                     Z-ADDWL0117    WEF4WG           OD Unused weigh
     C                     MOVELWL0118    WEP7ST           OD Added to Sch
     C                     MOVELWL0119    WEP8ST           OD Reallocate S
     C                     MOVELWL0120    WEQAST           OD Status Unuse
     C                     MOVELWL0121    WEUVST           EDI Status 1
     C                     MOVELWL0122    WEUWST           EDI Status 2
     C                     MOVELWL0123    WEUXST           EDI Status 3
     C                     MOVELWL0124    WEVSST           Record Status
     C                     Z-ADDWL0125    WEAATM           Job Time
     C                     MOVELWL0126    WEAYNA           User Id
     C                     MOVELWL0127    WEA0NA           Job Name
     C                     Z-ADDWL0128    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRTE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRTE    SETLL@KNCPHN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2239' W0RTN   7
      * Send message 'Order Detail Schedule  EX'
     C                     MOVEL'USR2239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@KNCPHN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0071  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0072  3        Warehouse Code
     C                     MOVEL*BLANK    WN0073  3        Order From Ware
     C                     Z-ADD*ZERO     WN0074  70       Item Code
     C                     Z-ADD*ZERO     WN0075 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0076 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0077 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0078 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0079  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0080  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0081  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0082  1        EDI Status 1
     C                     MOVEL*BLANK    WN0083  1        EDI Status 2
     C                     MOVEL*BLANK    WN0084  1        EDI Status 3
     C                     MOVEL*BLANK    WN0085  1        Record Status
     C                     Z-ADD*ZERO     WN0086  60       Job Time
     C                     MOVEL*BLANK    WN0087 10        User Id
     C                     MOVEL*BLANK    WN0088 10        Job Name
     C                     Z-ADD*ZERO     WN0089  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0084    WEAIC3           Company Number
     C                     Z-ADDWL0092    WEC4NB           Order Number
     C                     Z-ADDWL0093    WEDPNB           Order Sequence
     C                     Z-ADDWL0094    WEUENB           Order Secondary
     C                     Z-ADD##JDT     WEJGDT           OD Production D
      *
     C           KLCHTF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHTF    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YDRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0056    WEIUQT           OD Quantity Inv
     C                     Z-ADDWN0057    WEF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0090  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0091  70       PS Pieces Inv A
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYV5ST           Production Type
     C                     KFLD           WYELDT           Production Date
     C                     KFLD           WYHGCD           Item Code
     C                     KFLD           WYAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0084    WYAIC3           Company Number
     C                     MOVEL'S'       WYV5ST           Production Type
     C                     Z-ADD##JDT     WYELDT           Production Date
     C                     Z-ADDWL0085    WYHGCD           Item Code
     C                     MOVELWL0086    WYAJCD           Warehouse Code
      * Establish starting position
     C           KRSTG     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WYUNW2    ADD  WN0037    WN0090           PS Weight Inv A
      * PS Pieces Inv Allocated
      * CASE: PAR.Piece Count Item is yes
     C           WL0089    IFEQ 'Y'                        *IF
      * Pieces Inv Allocated
      * PAR.PS Pieces Inv Allocated =
      *    *COMPUTE (x1 + (x2 * (x3 * x4)))
      * x1    : DB1.PS Pieces Inv Allocated
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Bags Per Unit
     C           WL0090    MULT WL0091    W0WJ02           *Synon (15,0) w
     C           WN0036    MULT W0WJ02    W0WJ01    H      *Synon (15,0) w
     C           WYCENB    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0091           PS Pieces Inv A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0091           PS Pieces Inv A
     C                     END                             *FI
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
     C                     EXSR THCHRC
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0092  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0093  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0094  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0095  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0096  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0097  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0098  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0099  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0100  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0101  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0102  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0103  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0104  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0105  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0106  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0107  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0108  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0109  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0110  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0111  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0112  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0113 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0114  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0115 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0116  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0117 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0118  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0119 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0120  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0121 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0122  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0123 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0124  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0125  3        PS Item Id
     C                     MOVEL*BLANK    WN0126  2        Warehouse Type
     C                     MOVEL*BLANK    WN0127  1        PS Lock Status
     C                     MOVEL*BLANK    WN0128  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0129  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0130  1        PS Piece Count
     C                     MOVEL*BLANK    WN0131  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0132  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0133  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0134  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0135  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0136  3        PS Production W
     C                     Z-ADD*ZERO     WN0137  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0138  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0139  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0140  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0141  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0142  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0143  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0144  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0145  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0146  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0147  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0148  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0149  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0150  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0151  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0152  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0153  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0154  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0155  6        Department Code
     C                     Z-ADD*ZERO     WN0156  30       Item Structure
     C                     Z-ADD*ZERO     WN0157  30       Item Structure
     C                     Z-ADD*ZERO     WN0158  30       Item Structure
     C                     MOVEL*BLANK    WN0159  6        Primal Group Co
     C                     MOVEL*BLANK    WN0160  1        EDI Status 1
     C                     MOVEL*BLANK    WN0161  1        EDI Status 2
     C                     MOVEL*BLANK    WN0162  1        EDI Status 3
     C                     MOVEL*BLANK    WN0163  1        Record Status
     C                     Z-ADD*ZERO     WN0164  60       Job Time
     C                     MOVEL*BLANK    WN0165 10        User Id
     C                     MOVEL*BLANK    WN0166 10        Job Name
     C                     Z-ADD*ZERO     WN0167  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWYAIC3    TAAIC3           Company Number
     C                     MOVELWYV5ST    TAV5ST    P      Production Type
     C                     Z-ADDWYELDT    TAELDT           Production Date
     C                     Z-ADDWYHGCD    TAHGCD           Item Code
     C                     MOVELWYAJCD    TAAJCD    P      Warehouse Code
      *
     C           KLCHTH    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAV5ST           Production Type
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C           KLCHTH    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YERDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0090    TAUNW2           PS Weight Inv A
     C                     Z-ADDWN0091    TACENB           PS Pieces Inv A
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Sched only CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0168  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0169  3        Warehouse Code
     C                     MOVEL*BLANK    WN0170  3        Order From Ware
     C                     Z-ADD*ZERO     WN0171  70       Item Code
     C                     Z-ADD*ZERO     WN0172 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0173 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0174 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0175 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0176  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0177  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0178  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0179  1        EDI Status 1
     C                     MOVEL*BLANK    WN0180  1        EDI Status 2
     C                     MOVEL*BLANK    WN0181  1        EDI Status 3
     C                     MOVEL*BLANK    WN0182  1        Record Status
     C                     Z-ADD*ZERO     WN0183  60       Job Time
     C                     MOVEL*BLANK    WN0184 10        User Id
     C                     MOVEL*BLANK    WN0185 10        Job Name
     C                     Z-ADD*ZERO     WN0186  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWVAIC3    WEAIC3           Company Number
     C                     Z-ADDWVC4NB    WEC4NB           Order Number
     C                     Z-ADDWVDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWVUENB    WEUENB           Order Secondary
     C                     Z-ADDWVJGDT    WEJGDT           OD Production D
      *
     C           KLCHTI    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHTI    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YFRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADD*ZERO     WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WEFLWG           OD Weight Sched
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           TBAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0129    TBAJCD           Warehouse Code
      * Establish starting position
     C           KRSTJ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0130           Production Ware
     C                     Z-ADD*ZERO     WL0131           Accounting Comp
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBAOCD    WL0130           Production Ware
     C                     Z-ADDTBBTC3    WL0131           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Block Order Flag  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0132    WDAIC3           Company Number
     C                     Z-ADDWL0133    WDC4NB           Order Number
      * Establish starting position
     C           KRSTK     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0134           Block Order Fla
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBCST    WL0134           Block Order Fla
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2885 RMC 12/4/13 new alloc method="S"tandard -- if shipping with
      *   3 days, force Alloc Method to F-ASAP, else use B-JIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTL01           Company Number
     C           *LIKE     DEFN TCHGCD    WQTL02           Item Code
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Item Code
      * Setup key
     C                     Z-ADDWL0135    WQTL01           Company Number
     C                     Z-ADDWL0136    WQTL02           Item Code
      * Establish starting position
     C           KRSTL     SETLL@FDREAW                    *
     C           KRSTL     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0137           Allocation Meth
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv SchShpDte         RT - Order Header TRG  * 
     C                     EXSR TMRVGN
      * CASE: DB1.Allocation Method is Standard or Blank
     C           TCENST    IFEQ *BLANK                     *IF
     C           TCENST    OREQ 'S'
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR TNRVGN
      * CASE: LCL.Scheduled Ship Date LE LCL.Date                  USR
     C           YL0063    IFLE YL0064                     *IF
     C                     MOVEL'F'       WL0137           Allocation Meth
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'B'       WL0137           Allocation Meth
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELTCENST    WL0137           Allocation Meth
     C                     END                             *FI
     C           KRSTL     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv SchShpDte         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDC4NB    WQTM01           Order Number
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           Order Number
      * Setup key
     C                     Z-ADDWL0138    WQTM01           Order Number
      * Establish starting position
     C           KRSTM     SETLL@BFCPY2                    *
     C           KRSTM     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0063           Scheduled Ship
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTDAODT    YL0063           Scheduled Ship
     C           KRSTM     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEAIC3    WQTN01           Company Number
      * Define keylist
     C           KPSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           TEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
      * Setup key
     C                     Z-ADDTCAIC3    WQTN01           Company Number
     C                     Z-ADD##JDT     TEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTN     SETLL@AFREY1                    *
     C           KRSTN     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDTEBCDT    YL0064           *DATE
     C                     GOTO TNEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSTN     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTO01           Company Number
     C           *LIKE     DEFN TCHGCD    WQTO02           Item Code
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Item Code
      * Setup key
     C                     Z-ADDWL0139    WQTO01           Company Number
     C                     Z-ADDWL0140    WQTO02           Item Code
      * Establish starting position
     C           KRSTO     SETLL@FDREAW                    *
     C           KRSTO     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * default to "Y"es if rcd not found. user isnt overriding it to No
     C                     MOVEL*BLANK    WL0142           Production Day
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR TPRVGN
      * CASE: LCL.Day of Week is Sunday
     C           YL0068    IFEQ '1'                        *IF
     C                     MOVELTCD0ST    WL0142           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Monday
     C           YL0068    IFEQ '2'                        *IF
     C                     MOVELTCD2ST    WL0142           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Tuesday
     C           YL0068    IFEQ '3'                        *IF
     C                     MOVELTCD6ST    WL0142           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Wednesday
     C           YL0068    IFEQ '4'                        *IF
     C                     MOVELTCWESP    WL0142           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Thursday
     C           YL0068    IFEQ '5'                        *IF
     C                     MOVELTCEDST    WL0142           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Friday
     C           YL0068    IFEQ '6'                        *IF
     C                     MOVELTCEFST    WL0142           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Saturday
     C           YL0068    IFEQ '7'                        *IF
     C                     MOVELTCEHST    WL0142           Production Day
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTO     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQTP01           Company Number
     C           *LIKE     DEFN TFBCDT    WQTP02           Post to G/L Dat
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0139    WQTP01           Company Number
     C                     Z-ADDWL0141    WQTP02           Post to G/L Dat
      * Establish starting position
     C           KRSTP     SETLL@AFREYY                    *
     C           KRSTP     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELTFA9ST    YL0068           Day of Week
     C           KRSTP     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           TGAIC3           Company Number
     C                     KFLD           TGV5ST           Production Type
     C                     KFLD           TGELDT           Production Date
      * Setup key
     C                     Z-ADDWL0143    TGAIC3           Company Number
     C                     MOVELWL0144    TGV5ST           Production Type
     C                     Z-ADDWL0145    TGELDT           Production Date
      * Establish starting position
     C           KRSTQ     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0146           Record Found US
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0146           Record Found US
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0203  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0204  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0205  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0206  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0207  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0208  92       Weight Producti
     C                     Z-ADD*ZERO     WN0209  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0210 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0211 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0212  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0152           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0203           PS Weight Ship
     C                     Z-ADD*ZERO     WN0204           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0153           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0154           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0205           Piece Count Ite
     C                     Z-ADD*ZERO     WN0206           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0207           Bags Per Unit
     C                     Z-ADD*ZERO     WN0208           Weight Producti
     C                     Z-ADD*ZERO     WN0209           Pieces Producti
     C                     Z-ADD*ZERO     WN0210           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0211           OD Weight Sched
     C                     Z-ADD*ZERO     WN0212           Pieces Allocate
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYV5ST           Production Type
     C                     KFLD           WYELDT           Production Date
     C                     KFLD           WYHGCD           Item Code
     C                     KFLD           WYAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0147    WYAIC3           Company Number
     C                     MOVELWL0148    WYV5ST           Production Type
     C                     Z-ADDWL0149    WYELDT           Production Date
     C                     Z-ADDWL0150    WYHGCD           Item Code
     C                     MOVELWL0151    WYAJCD           Warehouse Code
      * Establish starting position
     C           KRSTR     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * so calc is: Production = Planned Prod + Standard + Prod Adj - Con
      *  instead of:
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WYB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0155    IFGT 0                          *IF
     C           WYELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR TSRVGN
     C                     END                             *FI
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whs Tfr Adj
     C           WYWTSP    ADD  WYDXWG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WYD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WYWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WYGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0208           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (15,0) work field
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whs Tfr Adj
     C           WYQTSP    ADD  WYB2NB    W0WJ03           *Synon (15,0) w
     C           W0WJ03    ADD  WYCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WYPSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WYBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0209           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0208    ADD  WN0203    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WYSAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WYOAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0153           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0209    ADD  WN0204    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WYB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WYCDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0154           ATS Pieces Avai
      * Weight Avail E1971 RMC   2/27/12 change to leave pieces if > 0
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WL0153    IFLT 0                          *IF
      * CASE: PAR.ATS Pieces Available USR is LE Zero
     C           WL0154    IFLE 0                          *IF
     C                     Z-ADD*ZERO     WL0153           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0154           ATS Pieces Avai
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWYF8WG    WL0152           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN THAIC3    WQTS01           Company Number
     C           *LIKE     DEFN THHGCD    WQTS02           Item Code
     C           *LIKE     DEFN THAJCD    WQTS03           Warehouse Code
     C           *LIKE     DEFN THELDT    WQTS04           Production Date
     C           *LIKE     DEFN THV5ST    WQTS05           Production Type
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Company Number
     C                     KFLD           WQTS02           Item Code
     C                     KFLD           WQTS03           Warehouse Code
     C                     KFLD           WQTS04           Production Date
     C                     KFLD           WQTS05           Production Type
      * Setup key
     C                     Z-ADDWYAIC3    WQTS01           Company Number
     C                     Z-ADDWYHGCD    WQTS02           Item Code
     C                     MOVELWYAJCD    WQTS03           Warehouse Code
     C                     Z-ADDWYGPDT    WQTS04           Production Date
     C                     MOVEL'P'       WQTS05           Production Type
      * Establish starting position
     C           KRSTS     SETLL@I8CPXP                    *
     C           KRSTS     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0203           PS Weight Ship
     C                     Z-ADD*ZERO     WN0204           PS Pieces Ship
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTHE0WG    WN0203           PS Weight Ship
     C                     Z-ADDTHD6NB    WN0204           PS Pieces Ship
     C           KRSTS     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0213 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0214 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0215 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0216 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0217 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0218 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0219  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0220  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0221  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0222  1        EDI Status 1
     C                     MOVEL*BLANK    WN0223  1        EDI Status 2
     C                     MOVEL*BLANK    WN0224  1        EDI Status 3
     C                     MOVEL*BLANK    WN0225  1        Record Status
     C                     Z-ADD*ZERO     WN0226  60       Job Time
     C                     MOVEL*BLANK    WN0227 10        User Id
     C                     MOVEL*BLANK    WN0228 10        Job Name
     C                     Z-ADD*ZERO     WN0229  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0156    WCAIC3           Company Number
     C                     Z-ADDWL0157    WCC4NB           Order Number
     C                     Z-ADDWL0158    WCDPNB           Order Sequence
     C                     Z-ADDWL0159    WCUENB           Order Secondary
     C                     Z-ADDWL0160    WCJGDT           OD Production D
      * Establish starting position
     C           KRSTT     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0156    WL0103           Company Number
     C                     Z-ADDWL0157    WL0104           Order Number
     C                     Z-ADDWL0158    WL0105           Order Sequence
     C                     Z-ADDWL0159    WL0106           Order Secondary
     C                     Z-ADDWL0160    WL0107           OD Production D
     C                     Z-ADDWL0161    WL0108           Scheduled Ship
     C                     MOVELWL0162    WL0109    P      Warehouse Code
     C                     MOVELWL0163    WL0110    P      Order From Ware
     C                     Z-ADDWL0164    WL0111           Item Code
     C                     Z-ADDWL0166    WL0112           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0165    WL0113           OD Weight Sched
     C                     Z-ADDWN0215    WL0114           OD Quantity Inv
     C                     Z-ADDWN0216    WL0115           OD Weight Inv S
     C                     Z-ADDWN0217    WL0116           OD Quantity Unu
     C                     Z-ADDWN0218    WL0117           OD Unused weigh
     C                     MOVELWN0219    WL0118    P      OD Added to Sch
     C                     MOVELWN0220    WL0119    P      OD Reallocate S
     C                     MOVELWN0221    WL0120    P      OD Status Unuse
     C                     MOVELWN0222    WL0121    P      EDI Status 1
     C                     MOVELWN0223    WL0122    P      EDI Status 2
     C                     MOVELWN0224    WL0123    P      EDI Status 3
     C                     MOVELWN0225    WL0124    P      Record Status
     C                     Z-ADDWN0226    WL0125           Job Time
     C                     MOVELWN0227    WL0126    P      User Id
     C                     MOVELWN0228    WL0127    P      Job Name
     C                     Z-ADDWN0229    WL0128           Job Date
     C                     EXSR TECRRC
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCIGQT    ADD  WL0166    WN0213           OD Qty/Cnsmd Pi
     C           WCFLWG    ADD  WL0165    WN0214           OD Weight Sched
     C                     MOVELWCP7ST    YL0069           OD Added to Sch
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           WL0167    IFEQ 'C'                        *IF
     C           WL0167    OREQ 'F'
      * CASE: PAR.OD Production Date EQ JOB.*Job date
     C           WL0160    IFEQ ##JDT                      *IF
     C                     MOVEL'Y'       YL0069           OD Added to Sch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.OD Quantity Scheduled is Greater than zero
     C           WN0213    IFGT 0                          *IF
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
     C                     EXSR TUCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0011           Company Number
     C                     Z-ADDWCC4NB    WL0012           Order Number
     C                     Z-ADDWCDPNB    WL0013           Order Sequence
     C                     Z-ADDWCUENB    WL0014           Order Secondary
     C                     Z-ADDWCJGDT    WL0015           OD Production D
     C                     EXSR SFDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0230  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0231  3        Warehouse Code
     C                     MOVEL*BLANK    WN0232  3        Order From Ware
     C                     Z-ADD*ZERO     WN0233  70       Item Code
     C                     Z-ADD*ZERO     WN0234 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0235 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0236  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0237  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0238  1        EDI Status 1
     C                     MOVEL*BLANK    WN0239  1        EDI Status 2
     C                     MOVEL*BLANK    WN0240  1        EDI Status 3
     C                     MOVEL*BLANK    WN0241  1        Record Status
     C                     Z-ADD*ZERO     WN0242  60       Job Time
     C                     MOVEL*BLANK    WN0243 10        User Id
     C                     MOVEL*BLANK    WN0244 10        Job Name
     C                     Z-ADD*ZERO     WN0245  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCC4NB    WEC4NB           Order Number
     C                     Z-ADDWCDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWCUENB    WEUENB           Order Secondary
     C                     Z-ADDWCJGDT    WEJGDT           OD Production D
      *
     C           KLCHTU    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHTU    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YGRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0213    WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0214    WEFLWG           OD Weight Sched
     C                     Z-ADDWCIUQT    WEIUQT           OD Quantity Inv
     C                     Z-ADDWCF3WG    WEF3WG           OD Weight Inv S
     C                     MOVELYL0069    WEP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0246  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0247  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0248  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0249  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0250  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0251  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0252  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0253  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0254  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0255  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0256  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0257  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0258  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0259  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0260  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0261  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0262  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0263  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0264  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0265  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0266  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0267  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0268  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0269 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0270  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0271 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0272  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0273 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0274  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0275 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0276  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0277 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0278  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0279 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0280  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0281  3        PS Item Id
     C                     MOVEL*BLANK    WN0282  2        Warehouse Type
     C                     MOVEL*BLANK    WN0283  1        PS Lock Status
     C                     MOVEL*BLANK    WN0284  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0285  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0286  1        PS Piece Count
     C                     MOVEL*BLANK    WN0287  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0288  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0289  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0290  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0291  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0292  3        PS Production W
     C                     Z-ADD*ZERO     WN0293  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0294  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0295  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0296  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0297  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0298  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0299  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0300  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0301  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0302  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0303  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0304  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0305  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0306  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0307  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0308  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0309  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0310  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0311  6        Department Code
     C                     Z-ADD*ZERO     WN0312  30       Item Structure
     C                     Z-ADD*ZERO     WN0313  30       Item Structure
     C                     Z-ADD*ZERO     WN0314  30       Item Structure
     C                     MOVEL*BLANK    WN0315  6        Primal Group Co
     C                     MOVEL*BLANK    WN0316  1        EDI Status 1
     C                     MOVEL*BLANK    WN0317  1        EDI Status 2
     C                     MOVEL*BLANK    WN0318  1        EDI Status 3
     C                     MOVEL*BLANK    WN0319  1        Record Status
     C                     Z-ADD*ZERO     WN0320  60       Job Time
     C                     MOVEL*BLANK    WN0321 10        User Id
     C                     MOVEL*BLANK    WN0322 10        Job Name
     C                     Z-ADD*ZERO     WN0323  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYV5ST           Production Type
     C                     KFLD           WYELDT           Production Date
     C                     KFLD           WYHGCD           Item Code
     C                     KFLD           WYAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0168    WYAIC3           Company Number
     C                     MOVELWL0169    WYV5ST           Production Type
     C                     Z-ADDWL0170    WYELDT           Production Date
     C                     Z-ADDWL0171    WYHGCD           Item Code
     C                     MOVELWL0172    WYAJCD           Warehouse Code
      * Establish starting position
     C           KRSTV     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0173    WN0271           PS Weight Whs T
     C                     Z-ADDWL0174    WN0270           PS Pieces Whs T
      * CASE: PAR.PS Pieces Whse Tfr Adj is GT Zero
     C           WN0270    IFGT 0                          *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Whs Tfr Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Whs Tfr Adj
     C           WN0271    DIV  WN0270    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0250           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0168    WL0179           Company Number
     C                     MOVELWL0169    WL0180    P      Production Type
     C                     Z-ADDWL0170    WL0181           Production Date
     C                     Z-ADDWL0171    WL0182           Item Code
     C                     MOVELWL0172    WL0183    P      Warehouse Code
     C                     Z-ADDWN0246    WL0184           PS Available Sh
     C                     Z-ADDWN0247    WL0185           PS Weight Plann
     C                     Z-ADDWN0248    WL0186           PS Pieces Plann
     C                     Z-ADDWN0249    WL0187           PS Pct of Carca
     C                     Z-ADDWN0250    WL0188           PS Avg Piece Wg
     C                     Z-ADDWN0251    WL0189           PS Weight Inv O
     C                     Z-ADDWN0252    WL0190           PS Pieces Inv O
     C                     Z-ADDWN0253    WL0191           PS Weight Stand
     C                     Z-ADDWN0254    WL0192           PS Pieces Stand
     C                     Z-ADDWN0255    WL0193           PS Weight Conve
     C                     Z-ADDWN0256    WL0194           PS Pieces Conve
     C                     Z-ADDWN0257    WL0195           PS Weight Shipp
     C                     Z-ADDWN0258    WL0196           PS Pieces Shipp
     C                     Z-ADDWN0259    WL0197           PS Weight Prod
     C                     Z-ADDWN0260    WL0198           PS Pieces Prod
     C                     Z-ADDWN0261    WL0199           PS Weight Inv A
     C                     Z-ADDWN0262    WL0200           PS Pieces Inv A
     C                     Z-ADDWN0263    WL0201           PS Weight Ship
     C                     Z-ADDWN0264    WL0202           PS Pieces Ship
     C                     Z-ADDWN0265    WL0203           PS Weight Prod
     C                     Z-ADDWN0266    WL0204           PS Pieces Prod
     C                     Z-ADDWN0267    WL0205           PS Weight Inv A
     C                     Z-ADDWN0268    WL0206           PS Pieces Inv A
     C                     Z-ADDWN0269    WL0207           PS Unit Weight
     C                     Z-ADDWN0270    WL0208           PS Pieces Whs T
     C                     Z-ADDWN0271    WL0209           PS Weight Whs T
     C                     Z-ADDWN0272    WL0210           PS Pieces Unuse
     C                     Z-ADDWN0273    WL0211           PS Weight Unuse
     C                     Z-ADDWN0274    WL0212           PS Pieces Unuse
     C                     Z-ADDWN0275    WL0213           PS Weight Unuse
     C                     Z-ADDWN0276    WL0214           PS Pieces Unuse
     C                     Z-ADDWN0277    WL0215           PS Weight Unuse
     C                     Z-ADDWN0278    WL0216           PS Pieces Unuse
     C                     Z-ADDWN0279    WL0217           PS Weight Unuse
     C                     Z-ADDWN0280    WL0218           PS Pieces Unuse
     C                     MOVELWN0281    WL0219    P      PS Item Id
     C                     MOVELWN0282    WL0220    P      Warehouse Type
     C                     MOVELWN0283    WL0221    P      PS Lock Status
     C                     MOVELWN0284    WL0222    P      PS Export/Domes
     C                     MOVELWN0285    WL0223    P      PS Print On Sch
     C                     MOVELWN0286    WL0224    P      PS Piece Count
     C                     MOVELWN0287    WL0225    P      PS Unused Sts 1
     C                     MOVELWN0288    WL0226    P      PS Unused Sts 2
     C                     MOVELWN0289    WL0227    P      PS Unused Sts 3
     C                     MOVELWN0290    WL0228    P      PS Unused Sts 4
     C                     MOVELWN0291    WL0229    P      PS Item Sched N
     C                     MOVELWN0292    WL0230    P      PS Production W
     C                     Z-ADDWN0293    WL0231           PS Weight Order
     C                     Z-ADDWN0294    WL0232           PS Pieces Order
     C                     Z-ADDWN0295    WL0233           PS Weight FC Ad
     C                     Z-ADDWN0296    WL0234           PS Pieces FC Ad
     C                     Z-ADDWN0297    WL0235           PS Weight FX Ad
     C                     Z-ADDWN0298    WL0236           PS Pieces FX Ad
     C                     Z-ADDWN0299    WL0237           PS Weight Sched
     C                     Z-ADDWN0300    WL0238           PS Pieces Sched
     C                     Z-ADDWN0301    WL0239           PS Weight Avail
     C                     Z-ADDWN0302    WL0240           PS Pieces Avail
     C                     Z-ADDWN0303    WL0241           PS Weight Produ
     C                     Z-ADDWN0304    WL0242           PS Pieces Produ
     C                     Z-ADDWN0305    WL0243           PS Weight Fab N
     C                     Z-ADDWN0306    WL0244           PS Pieces Fab N
     C                     Z-ADDWN0307    WL0245           PS Weight Sched
     C                     Z-ADDWN0308    WL0246           PS Pieces Sched
     C                     Z-ADDWN0309    WL0247           PS Weight Sched
     C                     Z-ADDWN0310    WL0248           PS Pieces Sched
     C                     MOVELWN0311    WL0249    P      Department Code
     C                     Z-ADDWN0312    WL0250           Item Structure
     C                     Z-ADDWN0313    WL0251           Item Structure
     C                     Z-ADDWN0314    WL0252           Item Structure
     C                     MOVELWN0315    WL0253    P      Primal Group Co
     C                     MOVELWN0316    WL0254    P      EDI Status 1
     C                     MOVELWN0317    WL0255    P      EDI Status 2
     C                     MOVELWN0318    WL0256    P      EDI Status 3
     C                     MOVELWN0319    WL0257    P      Record Status
     C                     Z-ADDWN0320    WL0258           Job Time
     C                     MOVELWN0321    WL0259    P      User Id
     C                     MOVELWN0322    WL0260    P      Job Name
     C                     Z-ADDWN0323    WL0261           Job Date
     C                     EXSR TWCRRC
      *  not necessary here ...
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WYGAWG    ADD  WL0173    WN0271           PS Weight Whs T
     C           WYBPNB    ADD  WL0174    WN0270           PS Pieces Whs T
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
     C                     EXSR TYCHRC
      *  not necessary here ...
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0179    TAAIC3           Company Number
     C                     MOVELWL0180    TAV5ST           Production Type
     C                     Z-ADDWL0181    TAELDT           Production Date
     C                     Z-ADDWL0182    TAHGCD           Item Code
     C                     MOVELWL0183    TAAJCD           Warehouse Code
     C                     Z-ADDWL0184    TAGPDT           PS Available Sh
     C                     Z-ADDWL0185    TAWTSP           PS Weight Plann
     C                     Z-ADDWL0186    TAQTSP           PS Pieces Plann
     C                     Z-ADDWL0187    TADJPC           PS Pct of Carca
     C                     Z-ADDWL0188    TAF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0189    TAWTIN           PS Weight Inv O
     C                     Z-ADDWL0190    TAD5NB           PS Pieces Inv O
     C                     Z-ADDWL0191    TADXWG           PS Weight Stand
     C                     Z-ADDWL0192    TAB2NB           PS Pieces Stand
     C                     Z-ADDWL0193    TAWTCN           PS Weight Conve
     C                     Z-ADDWL0194    TAPSCV           PS Pieces Conve
     C                     Z-ADDWL0195    TASAWT           PS Weight Shipp
     C                     Z-ADDWL0196    TAB9NB           PS Pieces Shipp
     C                     Z-ADDWL0197    TAD1WG           PS Weight Prod
     C                     Z-ADDWL0198    TACBNB           PS Pieces Prod
     C                     Z-ADDWL0199    TAEZWG           PS Weight Inv A
     C                     Z-ADDWL0200    TACCNB           PS Pieces Inv A
     C                     Z-ADDWL0201    TAE0WG           PS Weight Ship
     C                     Z-ADDWL0202    TAD6NB           PS Pieces Ship
     C                     Z-ADDWL0203    TAOAWT           PS Weight Prod
     C                     Z-ADDWL0204    TACDNB           PS Pieces Prod
     C                     Z-ADDWL0205    TAUNW2           PS Weight Inv A
     C                     Z-ADDWL0206    TACENB           PS Pieces Inv A
     C                     Z-ADDWL0207    TAF9WG           PS Unit Weight
     C                     Z-ADDWL0208    TABPNB           PS Pieces Whs T
     C                     Z-ADDWL0209    TAGAWG           PS Weight Whs T
     C                     Z-ADDWL0210    TABQNB           PS Pieces Unuse
     C                     Z-ADDWL0211    TAGBWG           PS Weight Unuse
     C                     Z-ADDWL0212    TABRNB           PS Pieces Unuse
     C                     Z-ADDWL0213    TAGCWG           PS Weight Unuse
     C                     Z-ADDWL0214    TABSNB           PS Pieces Unuse
     C                     Z-ADDWL0215    TAGDWG           PS Weight Unuse
     C                     Z-ADDWL0216    TABWNB           PS Pieces Unuse
     C                     Z-ADDWL0217    TAGEWG           PS Weight Unuse
     C                     Z-ADDWL0218    TAPS6U           PS Pieces Unuse
     C                     MOVELWL0219    TAWCST           PS Item Id
     C                     MOVELWL0220    TAWPST           Warehouse Type
     C                     MOVELWL0221    TAB5ST           PS Lock Status
     C                     MOVELWL0222    TATFST           PS Export/Domes
     C                     MOVELWL0223    TATEST           PS Print On Sch
     C                     MOVELWL0224    TATHST           PS Piece Count
     C                     MOVELWL0225    TAUDST           PS Unused Sts 1
     C                     MOVELWL0226    TAUFST           PS Unused Sts 2
     C                     MOVELWL0227    TAUGST           PS Unused Sts 3
     C                     MOVELWL0228    TAUHST           PS Unused Sts 4
     C                     MOVELWL0229    TAB6ST           PS Item Sched N
     C                     MOVELWL0230    TAB7ST           PS Production W
     C                     Z-ADDWL0231    TADVWG           PS Weight Order
     C                     Z-ADDWL0232    TAD7NB           PS Pieces Order
     C                     Z-ADDWL0233    TAFCAD           PS Weight FC Ad
     C                     Z-ADDWL0234    TAD9NB           PS Pieces FC Ad
     C                     Z-ADDWL0235    TADWWG           PS Weight FX Ad
     C                     Z-ADDWL0236    TAEANB           PS Pieces FX Ad
     C                     Z-ADDWL0237    TASHWT           PS Weight Sched
     C                     Z-ADDWL0238    TAEBNB           PS Pieces Sched
     C                     Z-ADDWL0239    TAAVWT           PS Weight Avail
     C                     Z-ADDWL0240    TAECNB           PS Pieces Avail
     C                     Z-ADDWL0241    TAWTON           PS Weight Produ
     C                     Z-ADDWL0242    TAEDNB           PS Pieces Produ
     C                     Z-ADDWL0243    TAFNWT           PS Weight Fab N
     C                     Z-ADDWL0244    TAEENB           PS Pieces Fab N
     C                     Z-ADDWL0245    TAQTAS           PS Weight Sched
     C                     Z-ADDWL0246    TAEFNB           PS Pieces Sched
     C                     Z-ADDWL0247    TAWAIO           PS Weight Sched
     C                     Z-ADDWL0248    TAEGNB           PS Pieces Sched
     C                     MOVELWL0249    TAR3CD           Department Code
     C                     Z-ADDWL0250    TARGNB           Item Structure
     C                     Z-ADDWL0251    TARHNB           Item Structure
     C                     Z-ADDWL0252    TARINB           Item Structure
     C                     MOVELWL0253    TAXRCD           Primal Group Co
     C                     MOVELWL0254    TAUVST           EDI Status 1
     C                     MOVELWL0255    TAUWST           EDI Status 2
     C                     MOVELWL0256    TAUXST           EDI Status 3
     C                     MOVELWL0257    TAVSST           Record Status
     C                     Z-ADDWL0258    TAAATM           Job Time
     C                     MOVELWL0259    TAAYNA           User Id
     C                     MOVELWL0260    TAA0NA           Job Name
     C                     Z-ADDWL0261    TAAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0324 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTAAIC3    WL0033           Company Number
     C                     Z-ADDTAHGCD    WL0034           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    WUAVNA    P      Description Lin
     C                     MOVELWL0036    WUADCD    P      UOM Primary
     C                     Z-ADDWL0037    WUAIWG           Unit Weight
     C                     Z-ADDWL0038    TARINB           Item Structure
     C                     Z-ADDWL0039    TARHNB           Item Structure
     C                     Z-ADDWL0040    TARGNB           Item Structure
     C                     MOVELWL0041    WUN0CD    P      Item Type Code
     C                     MOVELWL0042    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0043    WUCHTM           Fresh Chilling
     C                     MOVELWL0044    WUQZCD    P      Base_Conv_Loss
     C                     MOVELWL0045    WUXWST    P      Variety_Rendere
     C                     MOVELWL0046    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0047    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0048    WUPPHE           Pieces Per Head
     C                     MOVELWL0049    TAR3CD    P      Department Code
     C                     MOVELWL0050    WUSDCD    P      Group for Packa
     C                     MOVELWL0051    WUX5ST    P      Seconds Item
     C                     MOVELWL0052    TATHST    P      Piece Count Ite
     C                     Z-ADDWL0053    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0054    WUBJNB           Bags Per Unit
     C                     MOVELWL0055    TATFST    P      Export_Domestic
     C                     MOVELWL0056    TATEST    P      Print On Schedu
     C                     MOVELWL0057    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0058    WUSZST    P      Fresh Sched As
     C                     MOVELWL0059    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0060    TAXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTAAJCD    WL0061    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    TAWPST    P      Warehouse Type
     C                     MOVELWL0063    WUXUST    P      Trans Contol AS
     C                     MOVELWL0064    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0065    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0066    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     TAWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     TAWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     TAWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTAAJCD    WL0129    P      Warehouse Code
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0130    TAB7ST    P      Production Ware
     C                     Z-ADDWL0131    YL0070           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTAAIC3    WL0262           Company Number
     C                     Z-ADDWL0181    WL0263           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0264           Fresh Chilling
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0265    TAGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTAAIC3    WL0262           Company Number
     C                     Z-ADDWL0181    WL0263           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0264           Fresh Chilling
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0265    TAGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WL0186    IFGT 0                          *IF
     C           WL0185    DIV  WL0186    TAF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       TAVSST           Record Status
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
     C                     MOVEL'N'       TAB5ST           PS Lock Status
     C           KLCRTW    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAV5ST           Production Type
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTW    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTX01           Company Number
      * Define keylist
     C           KPSTX     KLIST
     C                     KFLD           WQTX01           Company Number
     C                     KFLD           WWBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           Company Number
      * Setup key
     C                     Z-ADDWL0262    WQTX01           Company Number
     C                     Z-ADDWL0263    WWBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTX     SETLL@AFREBE                    *
     C           KRSTX     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0264                     *IF
     C                     Z-ADDWWBCDT    WL0265           PS Available Sh
     C                     GOTO TXEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WWA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSTX     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0325  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0326  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0327  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0328  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0329  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0330  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0331  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0332  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0333  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0334  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0335  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0336  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0337  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0338  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0339  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0340  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0341  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0342  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0343  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0344  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0345  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0346  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0347 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0348  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0349 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0350  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0351 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0352  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0353 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0354  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0355 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0356  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0357  3        PS Item Id
     C                     MOVEL*BLANK    WN0358  2        Warehouse Type
     C                     MOVEL*BLANK    WN0359  1        PS Lock Status
     C                     MOVEL*BLANK    WN0360  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0361  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0362  1        PS Piece Count
     C                     MOVEL*BLANK    WN0363  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0364  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0365  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0366  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0367  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0368  3        PS Production W
     C                     Z-ADD*ZERO     WN0369  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0370  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0371  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0372  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0373  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0374  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0375  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0376  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0377  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0378  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0379  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0380  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0381  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0382  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0383  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0384  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0385  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0386  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0387  6        Department Code
     C                     Z-ADD*ZERO     WN0388  30       Item Structure
     C                     Z-ADD*ZERO     WN0389  30       Item Structure
     C                     Z-ADD*ZERO     WN0390  30       Item Structure
     C                     MOVEL*BLANK    WN0391  6        Primal Group Co
     C                     MOVEL*BLANK    WN0392  1        EDI Status 1
     C                     MOVEL*BLANK    WN0393  1        EDI Status 2
     C                     MOVEL*BLANK    WN0394  1        EDI Status 3
     C                     MOVEL*BLANK    WN0395  1        Record Status
     C                     Z-ADD*ZERO     WN0396  60       Job Time
     C                     MOVEL*BLANK    WN0397 10        User Id
     C                     MOVEL*BLANK    WN0398 10        Job Name
     C                     Z-ADD*ZERO     WN0399  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWYAIC3    TAAIC3           Company Number
     C                     MOVELWYV5ST    TAV5ST    P      Production Type
     C                     Z-ADDWYELDT    TAELDT           Production Date
     C                     Z-ADDWYHGCD    TAHGCD           Item Code
     C                     MOVELWYAJCD    TAAJCD    P      Warehouse Code
      *
     C           KLCHTY    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAV5ST           Production Type
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C           KLCHTY    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YHRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWYF8WG    TAF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0270    TABPNB           PS Pieces Whs T
     C                     Z-ADDWN0271    TAGAWG           PS Weight Whs T
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0400  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0401  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0402  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0403  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0404  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0405  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0406  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0407  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0408  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0409  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0410  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0411  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0412  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0413  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0414  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0415  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0416  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0417  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0418  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0419  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0420  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0421  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0422  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0423 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0424  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0425 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0426  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0427 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0428  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0429 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0430  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0431 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0432  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0433 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0434  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0435  3        PS Item Id
     C                     MOVEL*BLANK    WN0436  2        Warehouse Type
     C                     MOVEL*BLANK    WN0437  1        PS Lock Status
     C                     MOVEL*BLANK    WN0438  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0439  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0440  1        PS Piece Count
     C                     MOVEL*BLANK    WN0441  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0442  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0443  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0444  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0445  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0446  3        PS Production W
     C                     Z-ADD*ZERO     WN0447  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0448  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0449  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0450  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0451  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0452  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0453  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0454  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0455  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0456  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0457  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0458  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0459  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0460  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0461  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0462  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0463  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0464  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0465  6        Department Code
     C                     Z-ADD*ZERO     WN0466  30       Item Structure
     C                     Z-ADD*ZERO     WN0467  30       Item Structure
     C                     Z-ADD*ZERO     WN0468  30       Item Structure
     C                     MOVEL*BLANK    WN0469  6        Primal Group Co
     C                     MOVEL*BLANK    WN0470  1        EDI Status 1
     C                     MOVEL*BLANK    WN0471  1        EDI Status 2
     C                     MOVEL*BLANK    WN0472  1        EDI Status 3
     C                     MOVEL*BLANK    WN0473  1        Record Status
     C                     Z-ADD*ZERO     WN0474  60       Job Time
     C                     MOVEL*BLANK    WN0475 10        User Id
     C                     MOVEL*BLANK    WN0476 10        Job Name
     C                     Z-ADD*ZERO     WN0477  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYV5ST           Production Type
     C                     KFLD           WYELDT           Production Date
     C                     KFLD           WYHGCD           Item Code
     C                     KFLD           WYAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0266    WYAIC3           Company Number
     C                     MOVELWL0267    WYV5ST           Production Type
     C                     Z-ADDWL0268    WYELDT           Production Date
     C                     Z-ADDWL0269    WYHGCD           Item Code
     C                     MOVELWL0270    WYAJCD           Warehouse Code
      * Establish starting position
     C           KRSTZ     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0272    WN0407           PS Weight Stand
     C                     Z-ADDWL0271    WN0408           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0408    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0407    DIV  WN0408    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0404           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0404    IFLT 0                          *IF
     C                     MULT -1        WN0404           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0407    IFNE 0                          *IF
     C           WN0408    ORNE 0                          *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0266    WL0179           Company Number
     C                     MOVELWL0267    WL0180    P      Production Type
     C                     Z-ADDWL0268    WL0181           Production Date
     C                     Z-ADDWL0269    WL0182           Item Code
     C                     MOVELWL0270    WL0183    P      Warehouse Code
     C                     Z-ADDWN0400    WL0184           PS Available Sh
     C                     Z-ADDWN0401    WL0185           PS Weight Plann
     C                     Z-ADDWN0402    WL0186           PS Pieces Plann
     C                     Z-ADDWN0403    WL0187           PS Pct of Carca
     C                     Z-ADDWN0404    WL0188           PS Avg Piece Wg
     C                     Z-ADDWN0405    WL0189           PS Weight Inv O
     C                     Z-ADDWN0406    WL0190           PS Pieces Inv O
     C                     Z-ADDWN0407    WL0191           PS Weight Stand
     C                     Z-ADDWN0408    WL0192           PS Pieces Stand
     C                     Z-ADDWN0409    WL0193           PS Weight Conve
     C                     Z-ADDWN0410    WL0194           PS Pieces Conve
     C                     Z-ADDWN0411    WL0195           PS Weight Shipp
     C                     Z-ADDWN0412    WL0196           PS Pieces Shipp
     C                     Z-ADDWN0413    WL0197           PS Weight Prod
     C                     Z-ADDWN0414    WL0198           PS Pieces Prod
     C                     Z-ADDWN0415    WL0199           PS Weight Inv A
     C                     Z-ADDWN0416    WL0200           PS Pieces Inv A
     C                     Z-ADDWN0417    WL0201           PS Weight Ship
     C                     Z-ADDWN0418    WL0202           PS Pieces Ship
     C                     Z-ADDWN0419    WL0203           PS Weight Prod
     C                     Z-ADDWN0420    WL0204           PS Pieces Prod
     C                     Z-ADDWN0421    WL0205           PS Weight Inv A
     C                     Z-ADDWN0422    WL0206           PS Pieces Inv A
     C                     Z-ADDWN0423    WL0207           PS Unit Weight
     C                     Z-ADDWN0424    WL0208           PS Pieces Whs T
     C                     Z-ADDWN0425    WL0209           PS Weight Whs T
     C                     Z-ADDWN0426    WL0210           PS Pieces Unuse
     C                     Z-ADDWN0427    WL0211           PS Weight Unuse
     C                     Z-ADDWN0428    WL0212           PS Pieces Unuse
     C                     Z-ADDWN0429    WL0213           PS Weight Unuse
     C                     Z-ADDWN0430    WL0214           PS Pieces Unuse
     C                     Z-ADDWN0431    WL0215           PS Weight Unuse
     C                     Z-ADDWN0432    WL0216           PS Pieces Unuse
     C                     Z-ADDWN0433    WL0217           PS Weight Unuse
     C                     Z-ADDWN0434    WL0218           PS Pieces Unuse
     C                     MOVELWN0435    WL0219    P      PS Item Id
     C                     MOVELWN0436    WL0220    P      Warehouse Type
     C                     MOVELWN0437    WL0221    P      PS Lock Status
     C                     MOVELWN0438    WL0222    P      PS Export/Domes
     C                     MOVELWN0439    WL0223    P      PS Print On Sch
     C                     MOVELWN0440    WL0224    P      PS Piece Count
     C                     MOVELWN0441    WL0225    P      PS Unused Sts 1
     C                     MOVELWN0442    WL0226    P      PS Unused Sts 2
     C                     MOVELWN0443    WL0227    P      PS Unused Sts 3
     C                     MOVELWN0444    WL0228    P      PS Unused Sts 4
     C                     MOVELWN0445    WL0229    P      PS Item Sched N
     C                     MOVELWN0446    WL0230    P      PS Production W
     C                     Z-ADDWN0447    WL0231           PS Weight Order
     C                     Z-ADDWN0448    WL0232           PS Pieces Order
     C                     Z-ADDWN0449    WL0233           PS Weight FC Ad
     C                     Z-ADDWN0450    WL0234           PS Pieces FC Ad
     C                     Z-ADDWN0451    WL0235           PS Weight FX Ad
     C                     Z-ADDWN0452    WL0236           PS Pieces FX Ad
     C                     Z-ADDWN0453    WL0237           PS Weight Sched
     C                     Z-ADDWN0454    WL0238           PS Pieces Sched
     C                     Z-ADDWN0455    WL0239           PS Weight Avail
     C                     Z-ADDWN0456    WL0240           PS Pieces Avail
     C                     Z-ADDWN0457    WL0241           PS Weight Produ
     C                     Z-ADDWN0458    WL0242           PS Pieces Produ
     C                     Z-ADDWN0459    WL0243           PS Weight Fab N
     C                     Z-ADDWN0460    WL0244           PS Pieces Fab N
     C                     Z-ADDWN0461    WL0245           PS Weight Sched
     C                     Z-ADDWN0462    WL0246           PS Pieces Sched
     C                     Z-ADDWN0463    WL0247           PS Weight Sched
     C                     Z-ADDWN0464    WL0248           PS Pieces Sched
     C                     MOVELWN0465    WL0249    P      Department Code
     C                     Z-ADDWN0466    WL0250           Item Structure
     C                     Z-ADDWN0467    WL0251           Item Structure
     C                     Z-ADDWN0468    WL0252           Item Structure
     C                     MOVELWN0469    WL0253    P      Primal Group Co
     C                     MOVELWN0470    WL0254    P      EDI Status 1
     C                     MOVELWN0471    WL0255    P      EDI Status 2
     C                     MOVELWN0472    WL0256    P      EDI Status 3
     C                     MOVELWN0473    WL0257    P      Record Status
     C                     Z-ADDWN0474    WL0258           Job Time
     C                     MOVELWN0475    WL0259    P      User Id
     C                     MOVELWN0476    WL0260    P      Job Name
     C                     Z-ADDWN0477    WL0261           Job Date
     C                     EXSR TWCRRC
     C                     END                             *FI
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WYDXWG    ADD  WL0272    WN0407           PS Weight Stand
     C           WYB2NB    ADD  WL0271    WN0408           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0408    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0407    DIV  WN0408    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0404           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0404    IFLT 0                          *IF
     C                     MULT -1        WN0404           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
     C                     EXSR NACHRC
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      * R13899 RMC 10/11/18-If OH Is a BLOCK order, then add 1 day to job
      *  - dont allocate current day prod to a block order UNLESS SCHED O
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      * R13899 RMC 10/11/18-If OH Is a BLOCK order, then add 1 day to job
      *  - dont allocate current day prod to a block order UNLESS SCHED O
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      * R13899 RMC 10/11/18-If OH Is a BLOCK order, then add 1 day to job
      *  - dont allocate current day prod to a block order UNLESS SCHED O
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      * R13899 RMC 10/11/18-If OH Is a BLOCK order, then add 1 day to job
      *  - dont allocate current day prod to a block order UNLESS SCHED O
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      * R13899 RMC 10/11/18-If OH Is a BLOCK order, then add 1 day to job
      *  - dont allocate current day prod to a block order UNLESS SCHED O
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 10/10/2013 RMC E2824 if FZ Order, and shipping today or sooner
      *      Dont Prod Hold the order.
      *      ** Dont Unlock/Lock the load for any Prod Hold chg
      * *****
      * ** 09/20/2011 LJB P001251 Export Order Automation Upload
      * ** Don't lock if errors still pending in Order Detail from the up
      * *****
      * ** 04/08/2010 RMC C0679
      * If job date isnt a prod day for the plant, and order shipping cur
      *  or earlier, dont leave the order on hold, so it will ship short.
      *  the case of orders shipping on sundays.  4/08/2010 rmc
      * ** 09/30/2009 LJB E00495
      * ** Recompile - Only auto-lock load if shipping today (IF changed)
      * *****
      * FP1054 Read the Build file in  Load / Order Number sequence
      *        On Load  break:  Unlock / Lock the load
      *        On Order break:  Post orders in the build file
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     Z-ADD*ZERO     P4HODT           Scheduled Ship
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAM8NB           System Value Nu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCJGDT           OD Production D
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WCFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WCIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WCF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WCIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WCF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFJGDT           OD Production D
     C                     Z-ADD*ZERO     WFOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WFFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WFNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WFJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHJGDT           OD Production D
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WHF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJM8NB           System Value Nu
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WKCQNB           Julian Date
     C                     Z-ADD*ZERO     WKESNB           Accounting Year
     C                     Z-ADD*ZERO     WKETNB           Accounting Peri
     C                     Z-ADD*ZERO     WKBZNB           OM Week
     C                     Z-ADD*ZERO     WKEINB           Week Number
     C                     Z-ADD*ZERO     WKAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WKOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WKNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WKNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WKOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WKOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLELDT           Production Date
     C                     Z-ADD*ZERO     WLACWG           Quantity on Han
     C                     Z-ADD*ZERO     WLARQT           Quantity on Han
     C                     Z-ADD*ZERO     WLK7DT           Label Date
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WODPNB           Order Sequence
     C                     Z-ADD*ZERO     WOUENB           Order Secondary
     C                     Z-ADD*ZERO     WOAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WONUDT           Consumed Item C
     C                     Z-ADD*ZERO     WOAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WOD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WOCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WOAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WONVDT           Deadline Depart
     C                     Z-ADD*ZERO     WOBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WORMNB           Load ID
     C                     Z-ADD*ZERO     WOBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WOCXDT           Date of Origina
     C                     Z-ADD*ZERO     WOBQTM           Time of Origina
     C                     Z-ADD*ZERO     WOOFNY           ODBS New Prod H
     C                     Z-ADD*ZERO     WOEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WORINY           Item Age Days
     C                     Z-ADD*ZERO     WOTIDT           Production Ovr
     C                     Z-ADD*ZERO     WOTJDT           Production Ovr
     C                     Z-ADD*ZERO     WOTNDT           Production AgeD
     C                     Z-ADD*ZERO     WOTODT           Production AgeD
     C                     Z-ADD*ZERO     WOA5DT           Requested Ship
     C                     Z-ADD*ZERO     WOVUDT           ODBS Unused Dat
     C                     Z-ADD*ZERO     WOVVDT           ODBS Unused Dat
     C                     Z-ADD*ZERO     WOVWDT           ODBS Unused Dat
      * Define work field Order Number Ref
     C                     Z-ADD*ZERO     WUCAC7  70
      * Define work field Produced By Sts USR
     C                     MOVEL*BLANK    WUX8SX  2
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Variety_Rendered_Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export_Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WRAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WRAIWG           Unit Weight
     C                     Z-ADD*ZERO     WRCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WRC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WRURTN           Number Cases On
     C                     Z-ADD*ZERO     WRAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WRRINB           Item Structure
     C                     Z-ADD*ZERO     WRRHNB           Item Structure
     C                     Z-ADD*ZERO     WRRGNB           Item Structure
     C                     Z-ADD*ZERO     WRTFNB           Transportation
     C                     Z-ADD*ZERO     WRTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WRTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WRBLPR           Market Overage
     C                     Z-ADD*ZERO     WRBMPR           Standard Overag
     C                     Z-ADD*ZERO     WRCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WRCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WRSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WRPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WRICN1           Item Category N
     C                     Z-ADD*ZERO     WRICN2           Item Category N
     C                     Z-ADD*ZERO     WRV2NB           Item Category N
     C                     Z-ADD*ZERO     WRITCN           Item Category N
     C                     Z-ADD*ZERO     WRITC5           Item Category N
     C                     Z-ADD*ZERO     WRICN6           Item Category N
     C                     Z-ADD*ZERO     WRICN7           Item Category N
     C                     Z-ADD*ZERO     WRICN8           Item Category N
     C                     Z-ADD*ZERO     WRICN9           Item Category N
     C                     Z-ADD*ZERO     WRICN0           Item Category N
     C                     Z-ADD*ZERO     WRSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WRA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WRSJNB           Production Lead
     C                     Z-ADD*ZERO     WRSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WRSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WRSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WRCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WRCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WRILNB           Packages per ca
     C                     Z-ADD*ZERO     WRCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WRCINB           PM Batch Size
     C                     Z-ADD*ZERO     WRCJNB           Package Level s
     C                     Z-ADD*ZERO     WRCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WRCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WRCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WRCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WRCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WRCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WRCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WRCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WRC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WRB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WRB5NB           PM Line Number
     C                     Z-ADD*ZERO     WRBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WRBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WRF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WRF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WRF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WRBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WRBNNB           Production Qty
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WSBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WSBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WSBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WSBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTC4NB           Order Number
     C                     Z-ADD*ZERO     WTDPNB           Order Sequence
     C                     Z-ADD*ZERO     WTUENB           Order Secondary
     C                     Z-ADD*ZERO     WTHGCD           Item Code
     C                     Z-ADD*ZERO     WTBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WTCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WTMAVA           Billing Detail
     C                     Z-ADD*ZERO     WTKDVA           Billing Detail
     C                     Z-ADD*ZERO     WTL8VA           Billing Detail
     C                     Z-ADD*ZERO     WTL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WTAYVA           Extended Amount
     C                     Z-ADD*ZERO     WTEXDT           Market Pricing
     C                     Z-ADD*ZERO     WTBZPR           Price Overage O
     C                     Z-ADD*ZERO     WTL6NB           Contract Number
     C                     Z-ADD*ZERO     WTGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WTR1NB           Rated Freight
     C                     Z-ADD*ZERO     WTAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WTD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WTCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WTAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WTCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WTATWG           Weight Shipped
     C                     Z-ADD*ZERO     WTAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WTAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WTAKPR           Unit Price
     C                     Z-ADD*ZERO     WTALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WTAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WTAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WTA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WTA5DT           Requested Ship
     C                     Z-ADD*ZERO     WTAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WTGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WTRGNB           Item Structure
     C                     Z-ADD*ZERO     WTRHNB           Item Structure
     C                     Z-ADD*ZERO     WTRINB           Item Structure
     C                     Z-ADD*ZERO     WTCXDT           Date of Origina
     C                     Z-ADD*ZERO     WTDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WTB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WTA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WTNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WTNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WTNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WTNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WTNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WTBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WTBVTM           Price Code
     C                     Z-ADD*ZERO     WTBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WTBXTM           Substitution Li
     C                     Z-ADD*ZERO     WTBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WTH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WTH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WTH7NX           OD Item Target
     C                     Z-ADD*ZERO     WTH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WTH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WTDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WTDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WTDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WTDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WTDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WTGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WTGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WTGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WTPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WTRINY           Item Age Days
     C                     Z-ADD*ZERO     WTTIDT           Production Ovr
     C                     Z-ADD*ZERO     WTTJDT           Production Ovr
     C                     Z-ADD*ZERO     WTTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WTTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WTTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYELDT           Production Date
     C                     Z-ADD*ZERO     WYHGCD           Item Code
     C                     Z-ADD*ZERO     WYGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WYWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WYQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WYDJPC           PS Pct of Carca
     C                     Z-ADD*ZERO     WYF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WYWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WYD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WYDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WYB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WYWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WYPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WYSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WYB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WYD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WYCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WYEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WYCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WYE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WYD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WYOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WYCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WYUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WYCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WYF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WYBPNB           PS Pieces Whs T
     C                     Z-ADD*ZERO     WYGAWG           PS Weight Whs T
     C                     Z-ADD*ZERO     WYBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WYGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WYBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WYGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WYBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WYGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WYBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WYGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WYPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WYDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WYD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WYFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WYD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WYDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WYEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WYSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WYEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WYAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WYECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WYWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WYEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WYFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WYEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WYQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WYEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WYWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WYEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WYRGNB           Item Structure
     C                     Z-ADD*ZERO     WYRHNB           Item Structure
     C                     Z-ADD*ZERO     WYRINB           Item Structure
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCAIC3           Company Number
     C                     Z-ADD*ZERO     TCHGCD           Item Code
     C                     Z-ADD*ZERO     TCOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     TCORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     TCS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     TCMJDT           Create Date
     C                     Z-ADD*ZERO     TCBETM           Create Time
     C                     Z-ADD*ZERO     TCMKDT           Change Date
     C                     Z-ADD*ZERO     TCBFTM           Change Time
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TGAIC3           Company Number
     C                     Z-ADD*ZERO     TGELDT           Production Date
     C                     Z-ADD*ZERO     TGHVHD           Hog Volume
     C                     Z-ADD*ZERO     TGZ6NB           Average Live We
     C                     Z-ADD*ZERO     TGZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     TGDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     TGAVCW           Average Cold We
     C                     Z-ADD*ZERO     TGDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     TGZ0NB           Average Backfat
     C                     Z-ADD*ZERO     TGAVLE           Average Loin Ey
     C                     Z-ADD*ZERO     TGECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     TGAATM           Job Time
     C                     Z-ADD*ZERO     TGAXDT           Job Date
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 10
     C                     MOVEL*BLANK    WL0003 40
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0004  30
      * Define local variables for subroutine SECHRC.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SFDLRC.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
      * Define local variables for subroutine SHDLRC.
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  30
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  30
      * Define local variables for subroutine SJDLRC.
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030  70
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0031  30
     C                     MOVEL*BLANK    WL0032  3
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035 30
     C                     MOVEL*BLANK    WL0036  2
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038  30
     C                     Z-ADD*ZERO     WL0039  30
     C                     Z-ADD*ZERO     WL0040  30
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  3
     C                     Z-ADD*ZERO     WL0043  52
     C                     MOVEL*BLANK    WL0044  2
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     Z-ADD*ZERO     WL0047 112
     C                     Z-ADD*ZERO     WL0048  70
     C                     MOVEL*BLANK    WL0049  6
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  6
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0061  3
     C                     MOVEL*BLANK    WL0062  2
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065  1
     C                     Z-ADD*ZERO     WL0066  52
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0067  30
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  30
     C                     Z-ADD*ZERO     WL0070  30
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0071  30
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  30
     C                     Z-ADD*ZERO     WL0074  30
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0075  30
     C                     Z-ADD*ZERO     WL0076  70
     C                     Z-ADD*ZERO     WL0077  30
     C                     Z-ADD*ZERO     WL0078  30
     C                     Z-ADD*ZERO     WL0079 112
     C                     Z-ADD*ZERO     WL0080 112
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0081  30
     C                     Z-ADD*ZERO     WL0082  70
     C                     MOVEL*BLANK    WL0083  1
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  70
     C                     MOVEL*BLANK    WL0086  3
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088 112
     C                     MOVEL*BLANK    WL0089  1
     C                     Z-ADD*ZERO     WL0090  70
     C                     Z-ADD*ZERO     WL0091  70
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093  30
     C                     Z-ADD*ZERO     WL0094  30
     C                     Z-ADD*ZERO     WL0095 112
     C                     Z-ADD*ZERO     WL0096 112
     C                     Z-ADD*ZERO     WL0097 112
     C                     Z-ADD*ZERO     WL0098 112
     C                     Z-ADD*ZERO     WL0099 112
     C                     Z-ADD*ZERO     WL0100 112
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  70
      * Define local variables for subroutine TECRRC.
     C                     Z-ADD*ZERO     WL0103  30
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  30
     C                     Z-ADD*ZERO     WL0106  30
     C                     Z-ADD*ZERO     WL0107  70
     C                     Z-ADD*ZERO     WL0108  70
     C                     MOVEL*BLANK    WL0109  3
     C                     MOVEL*BLANK    WL0110  3
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112 112
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114 112
     C                     Z-ADD*ZERO     WL0115 112
     C                     Z-ADD*ZERO     WL0116 112
     C                     Z-ADD*ZERO     WL0117 112
     C                     MOVEL*BLANK    WL0118  1
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  2
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  1
     C                     MOVEL*BLANK    WL0123  1
     C                     MOVEL*BLANK    WL0124  1
     C                     Z-ADD*ZERO     WL0125  60
     C                     MOVEL*BLANK    WL0126 10
     C                     MOVEL*BLANK    WL0127 10
     C                     Z-ADD*ZERO     WL0128  70
      * Define local variables for subroutine TJRVGN.
     C                     MOVEL*BLANK    WL0129  3
     C                     MOVEL*BLANK    WL0130  3
     C                     Z-ADD*ZERO     WL0131  30
      * Define local variables for subroutine TKRVGN.
     C                     Z-ADD*ZERO     WL0132  30
     C                     Z-ADD*ZERO     WL0133  70
     C                     MOVEL*BLANK    WL0134  1
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0135  30
     C                     Z-ADD*ZERO     WL0136  70
     C                     MOVEL*BLANK    WL0137  1
     C                     Z-ADD*ZERO     WL0138  70
      * Define local variables for subroutine TORVGN.
     C                     Z-ADD*ZERO     WL0139  30
     C                     Z-ADD*ZERO     WL0140  70
     C                     Z-ADD*ZERO     WL0141  70
     C                     MOVEL*BLANK    WL0142  1
      * Define local variables for subroutine TQRVGN.
     C                     Z-ADD*ZERO     WL0143  30
     C                     MOVEL*BLANK    WL0144  1
     C                     Z-ADD*ZERO     WL0145  70
     C                     MOVEL*BLANK    WL0146  1
      * Define local variables for subroutine TRRVGN.
     C                     Z-ADD*ZERO     WL0147  30
     C                     MOVEL*BLANK    WL0148  1
     C                     Z-ADD*ZERO     WL0149  70
     C                     Z-ADD*ZERO     WL0150  70
     C                     MOVEL*BLANK    WL0151  3
     C                     Z-ADD*ZERO     WL0152  92
     C                     Z-ADD*ZERO     WL0153 112
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  52
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0156  30
     C                     Z-ADD*ZERO     WL0157  70
     C                     Z-ADD*ZERO     WL0158  30
     C                     Z-ADD*ZERO     WL0159  30
     C                     Z-ADD*ZERO     WL0160  70
     C                     Z-ADD*ZERO     WL0161  70
     C                     MOVEL*BLANK    WL0162  3
     C                     MOVEL*BLANK    WL0163  3
     C                     Z-ADD*ZERO     WL0164  70
     C                     Z-ADD*ZERO     WL0165  92
     C                     Z-ADD*ZERO     WL0166 112
     C                     MOVEL*BLANK    WL0167  2
      * Define local variables for subroutine TVRVGN.
     C                     Z-ADD*ZERO     WL0168  30
     C                     MOVEL*BLANK    WL0169  1
     C                     Z-ADD*ZERO     WL0170  70
     C                     Z-ADD*ZERO     WL0171  70
     C                     MOVEL*BLANK    WL0172  3
     C                     Z-ADD*ZERO     WL0173  92
     C                     Z-ADD*ZERO     WL0174  70
     C                     Z-ADD*ZERO     WL0175  70
     C                     Z-ADD*ZERO     WL0176  30
     C                     Z-ADD*ZERO     WL0177  30
     C                     MOVEL*BLANK    WL0178  1
      * Define local variables for subroutine TWCRRC.
     C                     Z-ADD*ZERO     WL0179  30
     C                     MOVEL*BLANK    WL0180  1
     C                     Z-ADD*ZERO     WL0181  70
     C                     Z-ADD*ZERO     WL0182  70
     C                     MOVEL*BLANK    WL0183  3
     C                     Z-ADD*ZERO     WL0184  70
     C                     Z-ADD*ZERO     WL0185  92
     C                     Z-ADD*ZERO     WL0186  70
     C                     Z-ADD*ZERO     WL0187  72
     C                     Z-ADD*ZERO     WL0188  92
     C                     Z-ADD*ZERO     WL0189  92
     C                     Z-ADD*ZERO     WL0190  70
     C                     Z-ADD*ZERO     WL0191  92
     C                     Z-ADD*ZERO     WL0192  70
     C                     Z-ADD*ZERO     WL0193  92
     C                     Z-ADD*ZERO     WL0194  70
     C                     Z-ADD*ZERO     WL0195  92
     C                     Z-ADD*ZERO     WL0196  70
     C                     Z-ADD*ZERO     WL0197  92
     C                     Z-ADD*ZERO     WL0198  70
     C                     Z-ADD*ZERO     WL0199  92
     C                     Z-ADD*ZERO     WL0200  70
     C                     Z-ADD*ZERO     WL0201  92
     C                     Z-ADD*ZERO     WL0202  70
     C                     Z-ADD*ZERO     WL0203  92
     C                     Z-ADD*ZERO     WL0204  70
     C                     Z-ADD*ZERO     WL0205  92
     C                     Z-ADD*ZERO     WL0206  70
     C                     Z-ADD*ZERO     WL0207 112
     C                     Z-ADD*ZERO     WL0208  70
     C                     Z-ADD*ZERO     WL0209 112
     C                     Z-ADD*ZERO     WL0210  70
     C                     Z-ADD*ZERO     WL0211 112
     C                     Z-ADD*ZERO     WL0212  70
     C                     Z-ADD*ZERO     WL0213 112
     C                     Z-ADD*ZERO     WL0214  70
     C                     Z-ADD*ZERO     WL0215 112
     C                     Z-ADD*ZERO     WL0216  70
     C                     Z-ADD*ZERO     WL0217 112
     C                     Z-ADD*ZERO     WL0218  70
     C                     MOVEL*BLANK    WL0219  3
     C                     MOVEL*BLANK    WL0220  2
     C                     MOVEL*BLANK    WL0221  1
     C                     MOVEL*BLANK    WL0222  1
     C                     MOVEL*BLANK    WL0223  1
     C                     MOVEL*BLANK    WL0224  1
     C                     MOVEL*BLANK    WL0225  1
     C                     MOVEL*BLANK    WL0226  1
     C                     MOVEL*BLANK    WL0227  1
     C                     MOVEL*BLANK    WL0228  1
     C                     MOVEL*BLANK    WL0229  2
     C                     MOVEL*BLANK    WL0230  3
     C                     Z-ADD*ZERO     WL0231  92
     C                     Z-ADD*ZERO     WL0232  70
     C                     Z-ADD*ZERO     WL0233  92
     C                     Z-ADD*ZERO     WL0234  70
     C                     Z-ADD*ZERO     WL0235  92
     C                     Z-ADD*ZERO     WL0236  70
     C                     Z-ADD*ZERO     WL0237  92
     C                     Z-ADD*ZERO     WL0238  70
     C                     Z-ADD*ZERO     WL0239  92
     C                     Z-ADD*ZERO     WL0240  70
     C                     Z-ADD*ZERO     WL0241  92
     C                     Z-ADD*ZERO     WL0242  70
     C                     Z-ADD*ZERO     WL0243  92
     C                     Z-ADD*ZERO     WL0244  70
     C                     Z-ADD*ZERO     WL0245  92
     C                     Z-ADD*ZERO     WL0246  70
     C                     Z-ADD*ZERO     WL0247  92
     C                     Z-ADD*ZERO     WL0248  70
     C                     MOVEL*BLANK    WL0249  6
     C                     Z-ADD*ZERO     WL0250  30
     C                     Z-ADD*ZERO     WL0251  30
     C                     Z-ADD*ZERO     WL0252  30
     C                     MOVEL*BLANK    WL0253  6
     C                     MOVEL*BLANK    WL0254  1
     C                     MOVEL*BLANK    WL0255  1
     C                     MOVEL*BLANK    WL0256  1
     C                     MOVEL*BLANK    WL0257  1
     C                     Z-ADD*ZERO     WL0258  60
     C                     MOVEL*BLANK    WL0259 10
     C                     MOVEL*BLANK    WL0260 10
     C                     Z-ADD*ZERO     WL0261  70
      * Define local variables for subroutine TXRVGN.
     C                     Z-ADD*ZERO     WL0262  30
     C                     Z-ADD*ZERO     WL0263  70
     C                     Z-ADD*ZERO     WL0264  52
     C                     Z-ADD*ZERO     WL0265  70
      * Define local variables for subroutine TZRVGN.
     C                     Z-ADD*ZERO     WL0266  30
     C                     MOVEL*BLANK    WL0267  1
     C                     Z-ADD*ZERO     WL0268  70
     C                     Z-ADD*ZERO     WL0269  70
     C                     MOVEL*BLANK    WL0270  3
     C                     Z-ADD*ZERO     WL0271  70
     C                     Z-ADD*ZERO     WL0272 112
      * Define local variables for subroutine NBRVGN.
     C                     Z-ADD*ZERO     WL0273  30
     C                     MOVEL*BLANK    WL0274  1
     C                     Z-ADD*ZERO     WL0275  70
     C                     Z-ADD*ZERO     WL0276  70
     C                     MOVEL*BLANK    WL0277  3
     C                     Z-ADD*ZERO     WL0278  92
     C                     Z-ADD*ZERO     WL0279  70
     C                     Z-ADD*ZERO     WL0280  70
     C                     Z-ADD*ZERO     WL0281  30
     C                     Z-ADD*ZERO     WL0282  30
     C                     MOVEL*BLANK    WL0283  1
      * Define local variables for subroutine NCRVGN.
     C                     Z-ADD*ZERO     WL0284  30
     C                     Z-ADD*ZERO     WL0285  70
      * Define local variables for subroutine NDRVGN.
     C                     Z-ADD*ZERO     WL0286  30
     C                     Z-ADD*ZERO     WL0287  70
     C                     Z-ADD*ZERO     WL0288  30
     C                     Z-ADD*ZERO     WL0289  30
     C                     Z-ADD*ZERO     WL0290  70
     C                     Z-ADD*ZERO     WL0291  30
     C                     Z-ADD*ZERO     WL0292  70
     C                     Z-ADD*ZERO     WL0293  70
      * Define local variables for subroutine NERVGN.
     C                     Z-ADD*ZERO     WL0294  30
     C                     Z-ADD*ZERO     WL0295  70
     C                     Z-ADD*ZERO     WL0296  30
     C                     Z-ADD*ZERO     WL0297  30
     C                     Z-ADD*ZERO     WL0298  70
     C                     Z-ADD*ZERO     WL0299  30
      * Define local variables for subroutine NFRVGN.
     C                     Z-ADD*ZERO     WL0300  30
     C                     Z-ADD*ZERO     WL0301  70
     C                     Z-ADD*ZERO     WL0302  30
     C                     Z-ADD*ZERO     WL0303  30
     C                     Z-ADD*ZERO     WL0304  70
     C                     Z-ADD*ZERO     WL0305  30
     C                     Z-ADD*ZERO     WL0306  70
     C                     MOVEL*BLANK    WL0307  3
     C                     Z-ADD*ZERO     WL0308  70
     C                     Z-ADD*ZERO     WL0309  70
     C                     Z-ADD*ZERO     WL0310 112
     C                     Z-ADD*ZERO     WL0311 112
     C                     Z-ADD*ZERO     WL0312  50
     C                     Z-ADD*ZERO     WL0313  92
     C                     Z-ADD*ZERO     WL0314  70
     C                     Z-ADD*ZERO     WL0315  60
      * Define local variables for subroutine NJRVGN.
     C                     Z-ADD*ZERO     WL0316  30
     C                     Z-ADD*ZERO     WL0317  70
     C                     Z-ADD*ZERO     WL0318  70
     C                     Z-ADD*ZERO     WL0319  70
     C                     Z-ADD*ZERO     WL0320  80
      * Define local variables for subroutine NKRVGN.
     C                     Z-ADD*ZERO     WL0321  30
     C                     Z-ADD*ZERO     WL0322  70
     C                     Z-ADD*ZERO     WL0323  70
     C                     Z-ADD*ZERO     WL0324  70
     C                     Z-ADD*ZERO     WL0325  80
      * Define local variables for subroutine NMRVGN.
     C                     Z-ADD*ZERO     WL0326  30
     C                     Z-ADD*ZERO     WL0327  70
     C                     Z-ADD*ZERO     WL0328  30
     C                     Z-ADD*ZERO     WL0329  30
      * Define local variables for subroutine NNRVGN.
     C                     Z-ADD*ZERO     WL0330  30
     C                     Z-ADD*ZERO     WL0331  70
     C                     Z-ADD*ZERO     WL0332  30
     C                     Z-ADD*ZERO     WL0333  30
     C                     MOVEL*BLANK    WL0334  1
      * Define local variables for subroutine NOCHRC.
     C                     Z-ADD*ZERO     WL0335  30
     C                     Z-ADD*ZERO     WL0336  70
     C                     Z-ADD*ZERO     WL0337  30
     C                     Z-ADD*ZERO     WL0338  30
     C                     Z-ADD*ZERO     WL0339 112
     C                     Z-ADD*ZERO     WL0340 112
      * Define local variables for subroutine NPCHRC.
     C                     Z-ADD*ZERO     WL0341  30
     C                     Z-ADD*ZERO     WL0342  70
     C                     Z-ADD*ZERO     WL0343  30
     C                     Z-ADD*ZERO     WL0344  30
     C                     Z-ADD*ZERO     WL0345  50
     C                     MOVEL*BLANK    WL0346  3
     C                     MOVEL*BLANK    WL0347  2
     C                     MOVEL*BLANK    WL0348  6
      * Define local variables for subroutine NQRVGN.
     C                     MOVEL*BLANK    WL0349  1
     C                     Z-ADD*ZERO     WL0350  70
     C                     Z-ADD*ZERO     WL0351  70
      * Define local variables for subroutine NVRVGN.
     C                     Z-ADD*ZERO     WL0352  30
     C                     Z-ADD*ZERO     WL0353  70
     C                     MOVEL*BLANK    WL0354  1
     C                     MOVEL*BLANK    WL0355  1
     C                     MOVEL*BLANK    WL0356  1
     C                     MOVEL*BLANK    WL0357  1
      * Define local variables for subroutine NWCHRC.
     C                     Z-ADD*ZERO     WL0358  30
     C                     Z-ADD*ZERO     WL0359  70
     C                     MOVEL*BLANK    WL0360  3
     C                     MOVEL*BLANK    WL0361  1
     C                     MOVEL*BLANK    WL0362  1
     C                     MOVEL*BLANK    WL0363  1
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Kill Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Kill Date RGF
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field *Duration (factor)
     C                     Z-ADD*ZERO     YL0005  80
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field ATS Adj Type USR 2
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field UOM Primary
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0020  52
      * Define local work field ODBS Sched Override Sts
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0022 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field UOM Primary
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0025 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0026  52
      * Define local work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0032  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0034  52
      * Define local work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YL0035  30
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0036 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0037 112
      * Define local work field OD Adj Type Override
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0041  40
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0042 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0043 112
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0044  70
      * Define local work field Production Date RGT
     C                     Z-ADD*ZERO     YL0045  70
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0047 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0048 112
      * Define local work field ATS Quantity Need USR
     C                     Z-ADD*ZERO     YL0049 112
      * Define local work field ATS Weight Need USR
     C                     Z-ADD*ZERO     YL0050 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0051 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0052 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0053 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0054 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0055 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0056 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0057 112
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0058 112
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0059  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0060  30
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0062  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0063  70
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0064  70
      * Define local work field Production Date To
     C                     Z-ADD*ZERO     YL0065  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field Production Day Status USR
     C                     MOVEL*BLANK    YL0067  1
      * Define null work field Accounting Period Code
     C                     Z-ADD*ZERO     YN0001  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0068  1
      * Define null work field Week Number
     C                     Z-ADD*ZERO     YN0002  20
      * Define local work field OD Added to Sched Today
     C                     MOVEL*BLANK    YL0069  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0070  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0071  30
      * Define local work field ODS Sequence Number
     C                     Z-ADD*ZERO     YL0072  30
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0073 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0074 112
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0075  70
      * Define local work field Allocation Method USR
     C                     MOVEL*BLANK    YL0076  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0077  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0078  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0079  70
      * Define local work field Released by User Sts Y/N
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0081 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0082 112
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0083  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0084  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0085  1
      * Define local work field ATS Adj Type USR 2
     C                     MOVEL*BLANK    YL0086  2
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0087 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0088 112
      * Define local work field UOM Primary
     C                     MOVEL*BLANK    YL0089  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0090 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0091  52
      * Define local work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    YL0092  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0093  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0094  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0095  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0096  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0097  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0098  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0099  52
      * Define local work field ODBS Sched Override Sts
     C                     MOVEL*BLANK    YL0100  1
      * Define local work field Released by User Sts Y/N
     C                     MOVEL*BLANK    YL0101  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0102  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0103  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0104  1
      * Define local work field ATS Adj Type USR 2
     C                     MOVEL*BLANK    YL0105  2
      * Define local work field UOM Primary
     C                     MOVEL*BLANK    YL0106  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0107 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0108  52
      * Define local work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    YL0109  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0110  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0111  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0112  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0113  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0114  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0115  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0116  52
      * Define local work field ODBS Sched Override Sts
     C                     MOVEL*BLANK    YL0117  1
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0118 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0119 112
      * Define local work field Released by User Sts Y/N
     C                     MOVEL*BLANK    YL0120  1
      * Define local work field UOM Primary
     C                     MOVEL*BLANK    YL0121  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0122 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0123  52
      * Define local work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    YL0124  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0125  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0126  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0127  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0128  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0129  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0130  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0131  52
      * Define local work field Detail Line Status
     C                     MOVEL*BLANK    YL0132  1
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0133 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0134 112
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0135 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0136 112
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define local work field Consumed Item Code
     C                     Z-ADD*ZERO     YL0137  70
      * Define local work field Item Age Days
     C                     Z-ADD*ZERO     YL0138  40
      * Define local work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     YL0139  70
      * Define local work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     YL0140  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0141  1
      * Define local work field Released by User Sts Y/N
     C                     MOVEL*BLANK    YL0142  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0143  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0144  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0145  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0146  70
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0147  1
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0148  1
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0149  1
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0150  1
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0151  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0152  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0153  2
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0154  1
      * Define local work field Order Type - Sales
     C                     MOVEL*BLANK    YL0155  2
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0156  3
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PPSBUILD
00002 ALLOCDAYS
00003 ORDREALC
00004 SCHASORD
00005 SHIPOFFCUT
