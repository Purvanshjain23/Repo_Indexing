// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKJ2XFR
// ?Date: 14.08.2025 Time: 02:49:43
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?1/23/2008 slm TF changes per phone on 1/23/2008
//?Change to use PSC Mkt Percent 5/2 instead of
//? PSC Market Percent   NU  which was at 3/0
CASE;

// IF PAR.PSC Mkt Percent GT WRK.Zero USR
IF PAR.PSC_Mkt_Percent > WRK.Zero_USR;

EXECUTE FUNCTION(Percent Decimal DRV) TYPE(DRVFLD)                              AB1116647;
PARAMETER(WRK.Percent_Decimal_DRV);
PARAMETER(PAR.PSC_Mkt_Percent);
{
 //?Calculate derived field

 // PAR.Percent Decimal DRV = PAR.Percent USR / CON.100 *
 PAR.Percent_Decimal_DRV = PAR.Percent_USR / 100;

}


// PAR.Adj Market Price USR = WRK.Percent Decimal DRV * PAR.Market Price USR *
PAR.Adj_Market_Price_USR = WRK.Percent_Decimal_DRV * PAR.Market_Price_USR;

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Adj Market Price USR = PAR.Market Price USR
PAR.Adj_Market_Price_USR = PAR.Market_Price_USR;

ENDIF;

//?Add in + or - into adjustment per Carl--- Susan Mason
// PAR.Adj Market Price USR = PAR.Adj Market Price USR + PAR.BOH Market Add/Deduct
PAR.Adj_Market_Price_USR = PAR.Adj_Market_Price_USR + PAR.BOH_Market_Add_Deduct;

CASE;

// IF PAR.PSC Floor Price GE PAR.Adj Market Price USR
IF PAR.PSC_Floor_Price >= PAR.Adj_Market_Price_USR;

// PAR.TH CM Base Mkt Price = PAR.PSC Floor Price
PAR.TH_CM_Base_Mkt_Price = PAR.PSC_Floor_Price;

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.TH CM Base Mkt Price = PAR.Adj Market Price USR
PAR.TH_CM_Base_Mkt_Price = PAR.Adj_Market_Price_USR;

ENDIF;

