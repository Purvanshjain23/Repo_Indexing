     H/TITLE UPS Bld 1st Lvl cut   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 09/08/17  Time  : 09:17:04
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL2IF  E           K        DISK
      * RSQ : Calendar                  Co/Date Omt(Kill/Prd)
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDI0REL1IF  E           K        DISK
      * RTV : PS Cutout Matrix          Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDIZREL1IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Retrieval index
      *
     FPDIZREL5IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Pop Head > Zero
      *
     FPDI8CPL2IF  E           K        DISK
      * RTV : PS Prod Item Schedule     RTV: RM Base
      *
     FPDI8CPL5IF  E           K        DISK
      * RTV : PS Prod Item Schedule      RTV: FG *Sel All
      *
     FPDLMCPL1IF  E           K        DISK
      * RTV : PS Prod Dept Schedule     Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAAQREL1IF  E           K        DISK
      * RTV : Company Defaults          Retrieval index       NV
      *
     FCAAFREL9IF  E           K        DISK
      * RTV : Calendar                  Co/Date KillDaySts=Y
      *
     FPDI5REL3IF  E           K        DISK
      * RTV : PS Production Department  Kill/Rend Depts Only
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPDI6CPL3IF  E           K        DISK
      * RSQ : PS Std Prod Mix Dist      Co/Dept/DayOfWk/Itm
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDI5REL2IF  E           K        DISK
      * RTV : PS Production Department  Converting Depts Only
      *
     FPDI6CPL1IF  E           K        DISK
      * RTV : PS Std Prod Mix Dist      Retrieval index
      *
     FPDI5REL4IF  E           K        DISK
      * RTV : PS Production Department  Fabricating Depts Only
      *
     FPDI5REL5IF  E           K        DISK
      * RTV : PS Production Department  Credit Depts Only
      *
     FPDJCCPL0UF  E           K        DISK                      A
      * UPD : PS Prod Schedule          Update index
      *
     FPDIZREL0UF  E           K        DISK
      * UPD : PS Cutout Dist Lean %     Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDLMCPL0UF  E           K        DISK                      A
      * UPD : PS Prod Dept Schedule     Update index
      *
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@AFRELF
      * Calendar                  Co/Date Omt(Kill/Prd)
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WBAIC3
     I              JCV5ST                          WBV5ST
     I              JCELDT                          WBELDT
     I              JCHVHD                          WBHVHD
     I              JCZ6NB                          WBZ6NB
     I              JCZ7NB                          WBZ7NB
     I              JCDGPC                          WBDGPC
     I              JCAVCW                          WBAVCW
     I              JCDIPC                          WBDIPC
     I              JCZ0NB                          WBZ0NB
     I              JCAVLE                          WBAVLE
     I              JCECWG                          WBECWG
     I              JCUVST                          WBUVST
     I              JCUWST                          WBUWST
     I              JCUXST                          WBUXST
     I              JCVSST                          WBVSST
     I              JCAATM                          WBAATM
     I              JCAYNA                          WBAYNA
     I              JCA0NA                          WBA0NA
     I              JCAXDT                          WBAXDT
      *
     I@JCCPVB
      * PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WCAIC3
     I              JCV5ST                          WCV5ST
     I              JCELDT                          WCELDT
     I              JCHVHD                          WCHVHD
     I              JCZ6NB                          WCZ6NB
     I              JCZ7NB                          WCZ7NB
     I              JCDGPC                          WCDGPC
     I              JCAVCW                          WCAVCW
     I              JCDIPC                          WCDIPC
     I              JCZ0NB                          WCZ0NB
     I              JCAVLE                          WCAVLE
     I              JCECWG                          WCECWG
     I              JCUVST                          WCUVST
     I              JCUWST                          WCUWST
     I              JCUXST                          WCUXST
     I              JCVSST                          WCVSST
     I              JCAATM                          WCAATM
     I              JCAYNA                          WCAYNA
     I              JCA0NA                          WCA0NA
     I              JCAXDT                          WCAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WDAIC3
     I              KMV8CD                          WDV8CD
     I              KMAUNA                          WDAUNA
     I              KMI5ST                          WDI5ST
     I              KMBXTX                          WDBXTX
     I              KMM8NB                          WDM8NB
     I              KMUVST                          WDUVST
     I              KMUWST                          WDUWST
     I              KMUXST                          WDUXST
     I              KMVSST                          WDVSST
     I              KMAATM                          WDAATM
     I              KMAYNA                          WDAYNA
     I              KMA0NA                          WDA0NA
     I              KMAXDT                          WDAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WEAIC3
     I              AFBCDT                          WEBCDT
     I              AFCQNB                          WECQNB
     I              AFESNB                          WEESNB
     I              AFETNB                          WEETNB
     I              AFBZNB                          WEBZNB
     I              AFA9ST                          WEA9ST
     I              AFEINB                          WEEINB
     I              AFC5ST                          WEC5ST
     I              AFAQNB                          WEAQNB
     I              AFCMST                          WECMST
     I              AFV9ST                          WEV9ST
     I              AFWAST                          WEWAST
     I              AFX2ST                          WEX2ST
     I              AFOJDT                          WEOJDT
     I              AFNQNX                          WENQNX
     I              AFNRNX                          WENRNX
     I              AFI9SX                          WEI9SX
     I              AFJASX                          WEJASX
     I              AFOKDT                          WEOKDT
     I              AFOLDT                          WEOLDT
     I              AFUVST                          WEUVST
     I              AFUWST                          WEUWST
     I              AFUXST                          WEUXST
     I              AFAATM                          WEAATM
     I              AFAYNA                          WEAYNA
     I              AFA0NA                          WEA0NA
     I              AFAXDT                          WEAXDT
      *
     I@I0RES3
      * PS Cutout Matrix          Retrieval index
      * Renamed input format fields
     I              I0AIC3                          WFAIC3
     I              I0RXCD                          WFRXCD
     I              I0GHDT                          WFGHDT
     I              I0MXNA                          WFMXNA
     I              I0VTST                          WFVTST
     I              I0VUST                          WFVUST
     I              I0UVST                          WFUVST
     I              I0UWST                          WFUWST
     I              I0UXST                          WFUXST
     I              I0VSST                          WFVSST
     I              I0AATM                          WFAATM
     I              I0AYNA                          WFAYNA
     I              I0A0NA                          WFA0NA
     I              I0AXDT                          WFAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WGAIC3
     I              AFBCDT                          WGBCDT
     I              AFCQNB                          WGCQNB
     I              AFESNB                          WGESNB
     I              AFETNB                          WGETNB
     I              AFBZNB                          WGBZNB
     I              AFA9ST                          WGA9ST
     I              AFEINB                          WGEINB
     I              AFC5ST                          WGC5ST
     I              AFAQNB                          WGAQNB
     I              AFCMST                          WGCMST
     I              AFV9ST                          WGV9ST
     I              AFWAST                          WGWAST
     I              AFX2ST                          WGX2ST
     I              AFOJDT                          WGOJDT
     I              AFNQNX                          WGNQNX
     I              AFNRNX                          WGNRNX
     I              AFI9SX                          WGI9SX
     I              AFJASX                          WGJASX
     I              AFOKDT                          WGOKDT
     I              AFOLDT                          WGOLDT
     I              AFUVST                          WGUVST
     I              AFUWST                          WGUWST
     I              AFUXST                          WGUXST
     I              AFAATM                          WGAATM
     I              AFAYNA                          WGAYNA
     I              AFA0NA                          WGA0NA
     I              AFAXDT                          WGAXDT
      *
     I@IZRETC
      * PS Cutout Dist Lean %     Retrieval index
      * Renamed input format fields
     I              IZAIC3                          WHAIC3
     I              IZRXCD                          WHRXCD
     I              IZGHDT                          WHGHDT
     I              IZUPNB                          WHUPNB
     I              IZUQNB                          WHUQNB
     I              IZULNB                          WHULNB
     I              IZUNNB                          WHUNNB
     I              IZUONB                          WHUONB
     I              IZDIPC                          WHDIPC
     I              IZZ0NB                          WHZ0NB
     I              IZAVLE                          WHAVLE
     I              IZQPNX                          WHQPNX
     I              IZUVST                          WHUVST
     I              IZUWST                          WHUWST
     I              IZUXST                          WHUXST
     I              IZVSST                          WHVSST
     I              IZAATM                          WHAATM
     I              IZAYNA                          WHAYNA
     I              IZA0NA                          WHA0NA
     I              IZAXDT                          WHAXDT
      *
     I@IZRETB
      * PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WIAIC3
     I              IZRXCD                          WIRXCD
     I              IZGHDT                          WIGHDT
     I              IZUPNB                          WIUPNB
     I              IZUQNB                          WIUQNB
     I              IZULNB                          WIULNB
     I              IZUNNB                          WIUNNB
     I              IZUONB                          WIUONB
     I              IZDIPC                          WIDIPC
     I              IZZ0NB                          WIZ0NB
     I              IZAVLE                          WIAVLE
     I              IZQPNX                          WIQPNX
     I              IZUVST                          WIUVST
     I              IZUWST                          WIUWST
     I              IZUXST                          WIUXST
     I              IZVSST                          WIVSST
     I              IZAATM                          WIAATM
     I              IZAYNA                          WIAYNA
     I              IZA0NA                          WIA0NA
     I              IZAXDT                          WIAXDT
      *
     I@IZRENU
      * PS Cutout Dist Lean %     Pop Head > Zero
      * Renamed input format fields
     I              IZAIC3                          WJAIC3
     I              IZRXCD                          WJRXCD
     I              IZGHDT                          WJGHDT
     I              IZUPNB                          WJUPNB
     I              IZUQNB                          WJUQNB
     I              IZULNB                          WJULNB
     I              IZUNNB                          WJUNNB
     I              IZUONB                          WJUONB
     I              IZDIPC                          WJDIPC
     I              IZZ0NB                          WJZ0NB
     I              IZAVLE                          WJAVLE
     I              IZQPNX                          WJQPNX
     I              IZUVST                          WJUVST
     I              IZUWST                          WJUWST
     I              IZUXST                          WJUXST
     I              IZVSST                          WJVSST
     I              IZAATM                          WJAATM
     I              IZAYNA                          WJAYNA
     I              IZA0NA                          WJA0NA
     I              IZAXDT                          WJAXDT
      *
     I@I8CPWR
      * PS Prod Item Schedule     RTV: RM Base
      * Renamed input format fields
     I              I8AIC3                          WKAIC3
     I              I8V5ST                          WKV5ST
     I              I8ELDT                          WKELDT
     I              I8HGCD                          WKHGCD
     I              I8AJCD                          WKAJCD
     I              I8GPDT                          WKGPDT
     I              I8WTSP                          WKWTSP
     I              I8QTSP                          WKQTSP
     I              I8DJPC                          WKDJPC
     I              I8F8WG                          WKF8WG
     I              I8WTIN                          WKWTIN
     I              I8D5NB                          WKD5NB
     I              I8DXWG                          WKDXWG
     I              I8B2NB                          WKB2NB
     I              I8WTCN                          WKWTCN
     I              I8PSCV                          WKPSCV
     I              I8SAWT                          WKSAWT
     I              I8B9NB                          WKB9NB
     I              I8D1WG                          WKD1WG
     I              I8CBNB                          WKCBNB
     I              I8EZWG                          WKEZWG
     I              I8CCNB                          WKCCNB
     I              I8E0WG                          WKE0WG
     I              I8D6NB                          WKD6NB
     I              I8OAWT                          WKOAWT
     I              I8CDNB                          WKCDNB
     I              I8UNW2                          WKUNW2
     I              I8CENB                          WKCENB
     I              I8F9WG                          WKF9WG
     I              I8BPNB                          WKBPNB
     I              I8GAWG                          WKGAWG
     I              I8BQNB                          WKBQNB
     I              I8GBWG                          WKGBWG
     I              I8BRNB                          WKBRNB
     I              I8GCWG                          WKGCWG
     I              I8BSNB                          WKBSNB
     I              I8GDWG                          WKGDWG
     I              I8BWNB                          WKBWNB
     I              I8GEWG                          WKGEWG
     I              I8PS6U                          WKPS6U
     I              I8WCST                          WKWCST
     I              I8WPST                          WKWPST
     I              I8B5ST                          WKB5ST
     I              I8TFST                          WKTFST
     I              I8TEST                          WKTEST
     I              I8THST                          WKTHST
     I              I8UDST                          WKUDST
     I              I8UFST                          WKUFST
     I              I8UGST                          WKUGST
     I              I8UHST                          WKUHST
     I              I8B6ST                          WKB6ST
     I              I8B7ST                          WKB7ST
     I              I8DVWG                          WKDVWG
     I              I8D7NB                          WKD7NB
     I              I8FCAD                          WKFCAD
     I              I8D9NB                          WKD9NB
     I              I8DWWG                          WKDWWG
     I              I8EANB                          WKEANB
     I              I8SHWT                          WKSHWT
     I              I8EBNB                          WKEBNB
     I              I8AVWT                          WKAVWT
     I              I8ECNB                          WKECNB
     I              I8WTON                          WKWTON
     I              I8EDNB                          WKEDNB
     I              I8FNWT                          WKFNWT
     I              I8EENB                          WKEENB
     I              I8QTAS                          WKQTAS
     I              I8EFNB                          WKEFNB
     I              I8WAIO                          WKWAIO
     I              I8EGNB                          WKEGNB
     I              I8R3CD                          WKR3CD
     I              I8RGNB                          WKRGNB
     I              I8RHNB                          WKRHNB
     I              I8RINB                          WKRINB
     I              I8XRCD                          WKXRCD
     I              I8UVST                          WKUVST
     I              I8UWST                          WKUWST
     I              I8UXST                          WKUXST
     I              I8VSST                          WKVSST
     I              I8AATM                          WKAATM
     I              I8AYNA                          WKAYNA
     I              I8A0NA                          WKA0NA
     I              I8AXDT                          WKAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WLAIC3
     I              I8V5ST                          WLV5ST
     I              I8ELDT                          WLELDT
     I              I8HGCD                          WLHGCD
     I              I8AJCD                          WLAJCD
     I              I8GPDT                          WLGPDT
     I              I8WTSP                          WLWTSP
     I              I8QTSP                          WLQTSP
     I              I8DJPC                          WLDJPC
     I              I8F8WG                          WLF8WG
     I              I8WTIN                          WLWTIN
     I              I8D5NB                          WLD5NB
     I              I8DXWG                          WLDXWG
     I              I8B2NB                          WLB2NB
     I              I8WTCN                          WLWTCN
     I              I8PSCV                          WLPSCV
     I              I8SAWT                          WLSAWT
     I              I8B9NB                          WLB9NB
     I              I8D1WG                          WLD1WG
     I              I8CBNB                          WLCBNB
     I              I8EZWG                          WLEZWG
     I              I8CCNB                          WLCCNB
     I              I8E0WG                          WLE0WG
     I              I8D6NB                          WLD6NB
     I              I8OAWT                          WLOAWT
     I              I8CDNB                          WLCDNB
     I              I8UNW2                          WLUNW2
     I              I8CENB                          WLCENB
     I              I8F9WG                          WLF9WG
     I              I8BPNB                          WLBPNB
     I              I8GAWG                          WLGAWG
     I              I8BQNB                          WLBQNB
     I              I8GBWG                          WLGBWG
     I              I8BRNB                          WLBRNB
     I              I8GCWG                          WLGCWG
     I              I8BSNB                          WLBSNB
     I              I8GDWG                          WLGDWG
     I              I8BWNB                          WLBWNB
     I              I8GEWG                          WLGEWG
     I              I8PS6U                          WLPS6U
     I              I8WCST                          WLWCST
     I              I8WPST                          WLWPST
     I              I8B5ST                          WLB5ST
     I              I8TFST                          WLTFST
     I              I8TEST                          WLTEST
     I              I8THST                          WLTHST
     I              I8UDST                          WLUDST
     I              I8UFST                          WLUFST
     I              I8UGST                          WLUGST
     I              I8UHST                          WLUHST
     I              I8B6ST                          WLB6ST
     I              I8B7ST                          WLB7ST
     I              I8DVWG                          WLDVWG
     I              I8D7NB                          WLD7NB
     I              I8FCAD                          WLFCAD
     I              I8D9NB                          WLD9NB
     I              I8DWWG                          WLDWWG
     I              I8EANB                          WLEANB
     I              I8SHWT                          WLSHWT
     I              I8EBNB                          WLEBNB
     I              I8AVWT                          WLAVWT
     I              I8ECNB                          WLECNB
     I              I8WTON                          WLWTON
     I              I8EDNB                          WLEDNB
     I              I8FNWT                          WLFNWT
     I              I8EENB                          WLEENB
     I              I8QTAS                          WLQTAS
     I              I8EFNB                          WLEFNB
     I              I8WAIO                          WLWAIO
     I              I8EGNB                          WLEGNB
     I              I8R3CD                          WLR3CD
     I              I8RGNB                          WLRGNB
     I              I8RHNB                          WLRHNB
     I              I8RINB                          WLRINB
     I              I8XRCD                          WLXRCD
     I              I8UVST                          WLUVST
     I              I8UWST                          WLUWST
     I              I8UXST                          WLUXST
     I              I8VSST                          WLVSST
     I              I8AATM                          WLAATM
     I              I8AYNA                          WLAYNA
     I              I8A0NA                          WLA0NA
     I              I8AXDT                          WLAXDT
      *
     I@I8CPZZ
      * PS Prod Item Schedule      RTV: FG *Sel All
      * Renamed input format fields
     I              I8AIC3                          WMAIC3
     I              I8V5ST                          WMV5ST
     I              I8ELDT                          WMELDT
     I              I8HGCD                          WMHGCD
     I              I8AJCD                          WMAJCD
     I              I8GPDT                          WMGPDT
     I              I8WTSP                          WMWTSP
     I              I8QTSP                          WMQTSP
     I              I8DJPC                          WMDJPC
     I              I8F8WG                          WMF8WG
     I              I8WTIN                          WMWTIN
     I              I8D5NB                          WMD5NB
     I              I8DXWG                          WMDXWG
     I              I8B2NB                          WMB2NB
     I              I8WTCN                          WMWTCN
     I              I8PSCV                          WMPSCV
     I              I8SAWT                          WMSAWT
     I              I8B9NB                          WMB9NB
     I              I8D1WG                          WMD1WG
     I              I8CBNB                          WMCBNB
     I              I8EZWG                          WMEZWG
     I              I8CCNB                          WMCCNB
     I              I8E0WG                          WME0WG
     I              I8D6NB                          WMD6NB
     I              I8OAWT                          WMOAWT
     I              I8CDNB                          WMCDNB
     I              I8UNW2                          WMUNW2
     I              I8CENB                          WMCENB
     I              I8F9WG                          WMF9WG
     I              I8BPNB                          WMBPNB
     I              I8GAWG                          WMGAWG
     I              I8BQNB                          WMBQNB
     I              I8GBWG                          WMGBWG
     I              I8BRNB                          WMBRNB
     I              I8GCWG                          WMGCWG
     I              I8BSNB                          WMBSNB
     I              I8GDWG                          WMGDWG
     I              I8BWNB                          WMBWNB
     I              I8GEWG                          WMGEWG
     I              I8PS6U                          WMPS6U
     I              I8WCST                          WMWCST
     I              I8WPST                          WMWPST
     I              I8B5ST                          WMB5ST
     I              I8TFST                          WMTFST
     I              I8TEST                          WMTEST
     I              I8THST                          WMTHST
     I              I8UDST                          WMUDST
     I              I8UFST                          WMUFST
     I              I8UGST                          WMUGST
     I              I8UHST                          WMUHST
     I              I8B6ST                          WMB6ST
     I              I8B7ST                          WMB7ST
     I              I8DVWG                          WMDVWG
     I              I8D7NB                          WMD7NB
     I              I8FCAD                          WMFCAD
     I              I8D9NB                          WMD9NB
     I              I8DWWG                          WMDWWG
     I              I8EANB                          WMEANB
     I              I8SHWT                          WMSHWT
     I              I8EBNB                          WMEBNB
     I              I8AVWT                          WMAVWT
     I              I8ECNB                          WMECNB
     I              I8WTON                          WMWTON
     I              I8EDNB                          WMEDNB
     I              I8FNWT                          WMFNWT
     I              I8EENB                          WMEENB
     I              I8QTAS                          WMQTAS
     I              I8EFNB                          WMEFNB
     I              I8WAIO                          WMWAIO
     I              I8EGNB                          WMEGNB
     I              I8R3CD                          WMR3CD
     I              I8RGNB                          WMRGNB
     I              I8RHNB                          WMRHNB
     I              I8RINB                          WMRINB
     I              I8XRCD                          WMXRCD
     I              I8UVST                          WMUVST
     I              I8UWST                          WMUWST
     I              I8UXST                          WMUXST
     I              I8VSST                          WMVSST
     I              I8AATM                          WMAATM
     I              I8AYNA                          WMAYNA
     I              I8A0NA                          WMA0NA
     I              I8AXDT                          WMAXDT
      *
     I@LMCPO1
      * PS Prod Dept Schedule     Retrieval index
      * Renamed input format fields
     I              LMAIC3                          WOAIC3
     I              LMV5ST                          WOV5ST
     I              LMELDT                          WOELDT
     I              LMR3CD                          WOR3CD
     I              LMRMPA                          WORMPA
     I              LMGFWG                          WOGFWG
     I              LMGGWG                          WOGGWG
     I              LMCLNB                          WOCLNB
     I              LMGHWG                          WOGHWG
     I              LMDVNB                          WODVNB
     I              LMGNWG                          WOGNWG
     I              LMDZNB                          WODZNB
     I              LMGOWG                          WOGOWG
     I              LMD0NB                          WOD0NB
     I              LMGPWG                          WOGPWG
     I              LMD1NB                          WOD1NB
     I              LMGQWG                          WOGQWG
     I              LMD4NB                          WOD4NB
     I              LMGRWG                          WOGRWG
     I              LMTKST                          WOTKST
     I              LMTLST                          WOTLST
     I              LMTNST                          WOTNST
     I              LMCD3S                          WOCD3S
     I              LMTVST                          WOTVST
     I              LMTWST                          WOTWST
     I              LMUVST                          WOUVST
     I              LMUWST                          WOUWST
     I              LMUXST                          WOUXST
     I              LMVSST                          WOVSST
     I              LMAATM                          WOAATM
     I              LMAYNA                          WOAYNA
     I              LMA0NA                          WOA0NA
     I              LMAXDT                          WOAXDT
      *
     I@LMCPO0
      * PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WRAIC3
     I              LMV5ST                          WRV5ST
     I              LMELDT                          WRELDT
     I              LMR3CD                          WRR3CD
     I              LMRMPA                          WRRMPA
     I              LMGFWG                          WRGFWG
     I              LMGGWG                          WRGGWG
     I              LMCLNB                          WRCLNB
     I              LMGHWG                          WRGHWG
     I              LMDVNB                          WRDVNB
     I              LMGNWG                          WRGNWG
     I              LMDZNB                          WRDZNB
     I              LMGOWG                          WRGOWG
     I              LMD0NB                          WRD0NB
     I              LMGPWG                          WRGPWG
     I              LMD1NB                          WRD1NB
     I              LMGQWG                          WRGQWG
     I              LMD4NB                          WRD4NB
     I              LMGRWG                          WRGRWG
     I              LMTKST                          WRTKST
     I              LMTLST                          WRTLST
     I              LMTNST                          WRTNST
     I              LMCD3S                          WRCD3S
     I              LMTVST                          WRTVST
     I              LMTWST                          WRTWST
     I              LMUVST                          WRUVST
     I              LMUWST                          WRUWST
     I              LMUXST                          WRUXST
     I              LMVSST                          WRVSST
     I              LMAATM                          WRAATM
     I              LMAYNA                          WRAYNA
     I              LMA0NA                          WRA0NA
     I              LMAXDT                          WRAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WSAIC3
     I              I8V5ST                          WSV5ST
     I              I8ELDT                          WSELDT
     I              I8HGCD                          WSHGCD
     I              I8AJCD                          WSAJCD
     I              I8GPDT                          WSGPDT
     I              I8WTSP                          WSWTSP
     I              I8QTSP                          WSQTSP
     I              I8DJPC                          WSDJPC
     I              I8F8WG                          WSF8WG
     I              I8WTIN                          WSWTIN
     I              I8D5NB                          WSD5NB
     I              I8DXWG                          WSDXWG
     I              I8B2NB                          WSB2NB
     I              I8WTCN                          WSWTCN
     I              I8PSCV                          WSPSCV
     I              I8SAWT                          WSSAWT
     I              I8B9NB                          WSB9NB
     I              I8D1WG                          WSD1WG
     I              I8CBNB                          WSCBNB
     I              I8EZWG                          WSEZWG
     I              I8CCNB                          WSCCNB
     I              I8E0WG                          WSE0WG
     I              I8D6NB                          WSD6NB
     I              I8OAWT                          WSOAWT
     I              I8CDNB                          WSCDNB
     I              I8UNW2                          WSUNW2
     I              I8CENB                          WSCENB
     I              I8F9WG                          WSF9WG
     I              I8BPNB                          WSBPNB
     I              I8GAWG                          WSGAWG
     I              I8BQNB                          WSBQNB
     I              I8GBWG                          WSGBWG
     I              I8BRNB                          WSBRNB
     I              I8GCWG                          WSGCWG
     I              I8BSNB                          WSBSNB
     I              I8GDWG                          WSGDWG
     I              I8BWNB                          WSBWNB
     I              I8GEWG                          WSGEWG
     I              I8PS6U                          WSPS6U
     I              I8WCST                          WSWCST
     I              I8WPST                          WSWPST
     I              I8B5ST                          WSB5ST
     I              I8TFST                          WSTFST
     I              I8TEST                          WSTEST
     I              I8THST                          WSTHST
     I              I8UDST                          WSUDST
     I              I8UFST                          WSUFST
     I              I8UGST                          WSUGST
     I              I8UHST                          WSUHST
     I              I8B6ST                          WSB6ST
     I              I8B7ST                          WSB7ST
     I              I8DVWG                          WSDVWG
     I              I8D7NB                          WSD7NB
     I              I8FCAD                          WSFCAD
     I              I8D9NB                          WSD9NB
     I              I8DWWG                          WSDWWG
     I              I8EANB                          WSEANB
     I              I8SHWT                          WSSHWT
     I              I8EBNB                          WSEBNB
     I              I8AVWT                          WSAVWT
     I              I8ECNB                          WSECNB
     I              I8WTON                          WSWTON
     I              I8EDNB                          WSEDNB
     I              I8FNWT                          WSFNWT
     I              I8EENB                          WSEENB
     I              I8QTAS                          WSQTAS
     I              I8EFNB                          WSEFNB
     I              I8WAIO                          WSWAIO
     I              I8EGNB                          WSEGNB
     I              I8R3CD                          WSR3CD
     I              I8RGNB                          WSRGNB
     I              I8RHNB                          WSRHNB
     I              I8RINB                          WSRINB
     I              I8XRCD                          WSXRCD
     I              I8UVST                          WSUVST
     I              I8UWST                          WSUWST
     I              I8UXST                          WSUXST
     I              I8VSST                          WSVSST
     I              I8AATM                          WSAATM
     I              I8AYNA                          WSAYNA
     I              I8A0NA                          WSA0NA
     I              I8AXDT                          WSAXDT
      *
     I@AQREB9
      * Company Defaults          Retrieval index       NV
      * Renamed input format fields
     I              AQAIC3                          WTAIC3
     I              AQASVA                          WTASVA
     I              AQAIST                          WTAIST
     I              AQA3ST                          WTA3ST
     I              AQAVST                          WTAVST
     I              AQBYNA                          WTBYNA
     I              AQB6NA                          WTB6NA
     I              AQBZNA                          WTBZNA
     I              AQJ8ST                          WTJ8ST
     I              AQJ7NA                          WTJ7NA
     I              AQJ8NA                          WTJ8NA
     I              AQJ9NA                          WTJ9NA
     I              AQKANA                          WTKANA
     I              AQLWCD                          WTLWCD
     I              AQEJTX                          WTEJTX
     I              AQDGPC                          WTDGPC
     I              AQBFCD                          WTBFCD
     I              AQIDCD                          WTIDCD
     I              AQBSCD                          WTBSCD
     I              AQTOCD                          WTTOCD
     I              AQTPCD                          WTTPCD
     I              AQR4CD                          WTR4CD
     I              AQUVST                          WTUVST
     I              AQUWST                          WTUWST
     I              AQUXST                          WTUXST
     I              AQVSST                          WTVSST
     I              AQAATM                          WTAATM
     I              AQAYNA                          WTAYNA
     I              AQA0NA                          WTA0NA
     I              AQAXDT                          WTAXDT
      *
     I@AFREC2
      * Calendar                  Co/Date KillDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WVAIC3
     I              AFBCDT                          WVBCDT
     I              AFCQNB                          WVCQNB
     I              AFESNB                          WVESNB
     I              AFETNB                          WVETNB
     I              AFBZNB                          WVBZNB
     I              AFA9ST                          WVA9ST
     I              AFEINB                          WVEINB
     I              AFC5ST                          WVC5ST
     I              AFAQNB                          WVAQNB
     I              AFCMST                          WVCMST
     I              AFV9ST                          WVV9ST
     I              AFWAST                          WVWAST
     I              AFX2ST                          WVX2ST
     I              AFOJDT                          WVOJDT
     I              AFNQNX                          WVNQNX
     I              AFNRNX                          WVNRNX
     I              AFI9SX                          WVI9SX
     I              AFJASX                          WVJASX
     I              AFOKDT                          WVOKDT
     I              AFOLDT                          WVOLDT
     I              AFUVST                          WVUVST
     I              AFUWST                          WVUWST
     I              AFUXST                          WVUXST
     I              AFAATM                          WVAATM
     I              AFAYNA                          WVAYNA
     I              AFA0NA                          WVA0NA
     I              AFAXDT                          WVAXDT
      *
     I@I5REC4
      * PS Production Department  Kill/Rend Depts Only
      * Renamed input format fields
     I              I5AIC3                          WWAIC3
     I              I5R3CD                          WWR3CD
     I              I5MYNA                          WWMYNA
     I              I5DPT1                          WWDPT1
     I              I5UVST                          WWUVST
     I              I5UWST                          WWUWST
     I              I5UXST                          WWUXST
     I              I5VSST                          WWVSST
     I              I5AATM                          WWAATM
     I              I5AYNA                          WWAYNA
     I              I5A0NA                          WWA0NA
     I              I5AXDT                          WWAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WXAIC3
     I              AFBCDT                          WXBCDT
     I              AFCQNB                          WXCQNB
     I              AFESNB                          WXESNB
     I              AFETNB                          WXETNB
     I              AFBZNB                          WXBZNB
     I              AFA9ST                          WXA9ST
     I              AFEINB                          WXEINB
     I              AFC5ST                          WXC5ST
     I              AFAQNB                          WXAQNB
     I              AFCMST                          WXCMST
     I              AFV9ST                          WXV9ST
     I              AFWAST                          WXWAST
     I              AFX2ST                          WXX2ST
     I              AFOJDT                          WXOJDT
     I              AFNQNX                          WXNQNX
     I              AFNRNX                          WXNRNX
     I              AFI9SX                          WXI9SX
     I              AFJASX                          WXJASX
     I              AFOKDT                          WXOKDT
     I              AFOLDT                          WXOLDT
     I              AFUVST                          WXUVST
     I              AFUWST                          WXUWST
     I              AFUXST                          WXUXST
     I              AFAATM                          WXAATM
     I              AFAYNA                          WXAYNA
     I              AFA0NA                          WXA0NA
     I              AFAXDT                          WXAXDT
      *
     I@I6CPBJ
      * PS Std Prod Mix Dist      Co/Dept/DayOfWk/Itm
      * Renamed input format fields
     I              I6AIC3                          WYAIC3
     I              I6R3CD                          WYR3CD
     I              I6T9ST                          WYT9ST
     I              I6HGCD                          WYHGCD
     I              I6GJDT                          WYGJDT
     I              I6MXPR                          WYMXPR
     I              I6DHPC                          WYDHPC
     I              I6BMWE                          WYBMWE
     I              I6BMXW                          WYBMXW
     I              I6UAST                          WYUAST
     I              I6UBST                          WYUBST
     I              I6DENB                          WYDENB
     I              I6DFNB                          WYDFNB
     I              I6DHNB                          WYDHNB
     I              I6XRCD                          WYXRCD
     I              I6UVST                          WYUVST
     I              I6UWST                          WYUWST
     I              I6UXST                          WYUXST
     I              I6VSST                          WYVSST
     I              I6AATM                          WYAATM
     I              I6AYNA                          WYAYNA
     I              I6A0NA                          WYA0NA
     I              I6AXDT                          WYAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          TAAIC3
     I              BZHGCD                          TAHGCD
     I              BZAVNA                          TAAVNA
     I              BZAWNA                          TAAWNA
     I              BZL7NA                          TAL7NA
     I              BZL8NA                          TAL8NA
     I              BZL6NA                          TAL6NA
     I              BZMFNA                          TAMFNA
     I              BZADCD                          TAADCD
     I              BZAWPC                          TAAWPC
     I              BZLXST                          TALXST
     I              BZAECD                          TAAECD
     I              BZAXPC                          TAAXPC
     I              BZLYST                          TALYST
     I              BZAFCD                          TAAFCD
     I              BZAICD                          TAAICD
     I              BZAIWG                          TAAIWG
     I              BZHICD                          TAHICD
     I              BZRBCD                          TARBCD
     I              BZFZST                          TAFZST
     I              BZAVST                          TAAVST
     I              BZCZWG                          TACZWG
     I              BZC0WG                          TAC0WG
     I              BZURTN                          TAURTN
     I              BZAJC8                          TAAJC8
     I              BZRINB                          TARINB
     I              BZRHNB                          TARHNB
     I              BZRGNB                          TARGNB
     I              BZLNCD                          TALNCD
     I              BZTFNB                          TATFNB
     I              BZN0CD                          TAN0CD
     I              BZX4ST                          TAX4ST
     I              BZTMVA                          TATMVA
     I              BZTNVA                          TATNVA
     I              BZBLPR                          TABLPR
     I              BZBMPR                          TABMPR
     I              BZLRCD                          TALRCD
     I              BZU9ST                          TAU9ST
     I              BZCMCO                          TACMCO
     I              BZQ1CD                          TAQ1CD
     I              BZQ8CD                          TAQ8CD
     I              BZCHTM                          TACHTM
     I              BZQZCD                          TAQZCD
     I              BZXWST                          TAXWST
     I              BZXXST                          TAXXST
     I              BZVMST                          TAVMST
     I              BZSWGH                          TASWGH
     I              BZPPHE                          TAPPHE
     I              BZR3CD                          TAR3CD
     I              BZSDCD                          TASDCD
     I              BZICN1                          TAICN1
     I              BZSVCD                          TASVCD
     I              BZICN2                          TAICN2
     I              BZSWCD                          TASWCD
     I              BZV2NB                          TAV2NB
     I              BZSXCD                          TASXCD
     I              BZITCN                          TAITCN
     I              BZSYCD                          TASYCD
     I              BZITC5                          TAITC5
     I              BZSZCD                          TASZCD
     I              BZICN6                          TAICN6
     I              BZS0CD                          TAS0CD
     I              BZICN7                          TAICN7
     I              BZS1CD                          TAS1CD
     I              BZICN8                          TAICN8
     I              BZS2CD                          TAS2CD
     I              BZICN9                          TAICN9
     I              BZS3CD                          TAS3CD
     I              BZICN0                          TAICN0
     I              BZS4CD                          TAS4CD
     I              BZSFNB                          TASFNB
     I              BZA3WG                          TAA3WG
     I              BZSJNB                          TASJNB
     I              BZLLCD                          TALLCD
     I              BZLMCD                          TALMCD
     I              BZP3ST                          TAP3ST
     I              BZSKNB                          TASKNB
     I              BZSLNB                          TASLNB
     I              BZSMNB                          TASMNB
     I              BZP4ST                          TAP4ST
     I              BZCFNB                          TACFNB
     I              BZCGNB                          TACGNB
     I              BZILNB                          TAILNB
     I              BZCHNB                          TACHNB
     I              BZCINB                          TACINB
     I              BZCJNB                          TACJNB
     I              BZCMNB                          TACMNB
     I              BZCNNB                          TACNNB
     I              BZCRNB                          TACRNB
     I              BZCSNB                          TACSNB
     I              BZCVNB                          TACVNB
     I              BZCWNB                          TACWNB
     I              BZCXNB                          TACXNB
     I              BZCZNB                          TACZNB
     I              BZC0NB                          TAC0NB
     I              BZN1CD                          TAN1CD
     I              BZB4NB                          TAB4NB
     I              BZB5NB                          TAB5NB
     I              BZX5ST                          TAX5ST
     I              BZX6ST                          TAX6ST
     I              BZX7ST                          TAX7ST
     I              BZPCCT                          TAPCCT
     I              BZBDNB                          TABDNB
     I              BZBJNB                          TABJNB
     I              BZSUST                          TASUST
     I              BZSVST                          TASVST
     I              BZSYST                          TASYST
     I              BZSZST                          TASZST
     I              BZS1ST                          TAS1ST
     I              BZXRCD                          TAXRCD
     I              BZXTCD                          TAXTCD
     I              BZXUCD                          TAXUCD
     I              BZF5WG                          TAF5WG
     I              BZF6WG                          TAF6WG
     I              BZF7WG                          TAF7WG
     I              BZBLNB                          TABLNB
     I              BZBNNB                          TABNNB
     I              BZS2ST                          TAS2ST
     I              BZS4ST                          TAS4ST
     I              BZS5ST                          TAS5ST
     I              BZS6ST                          TAS6ST
     I              BZS8ST                          TAS8ST
     I              BZS9ST                          TAS9ST
     I              BZTCST                          TATCST
     I              BZTDST                          TATDST
     I              BZUVST                          TAUVST
     I              BZUWST                          TAUWST
     I              BZUXST                          TAUXST
     I              BZVSST                          TAVSST
     I              BZAATM                          TAAATM
     I              BZAYNA                          TAAYNA
     I              BZA0NA                          TAA0NA
     I              BZAXDT                          TAAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          TBAJCD
     I              ADF8NA                          TBF8NA
     I              ADACNA                          TBACNA
     I              ADADNA                          TBADNA
     I              ADAENA                          TBAENA
     I              ADAJNA                          TBAJNA
     I              ADBTTX                          TBBTTX
     I              ADAOCD                          TBAOCD
     I              ADBGCD                          TBBGCD
     I              ADVHST                          TBVHST
     I              ADMPNA                          TBMPNA
     I              ADWPST                          TBWPST
     I              ADXUST                          TBXUST
     I              ADT0ST                          TBT0ST
     I              ADT1ST                          TBT1ST
     I              ADDBNB                          TBDBNB
     I              ADT2ST                          TBT2ST
     I              ADT3ST                          TBT3ST
     I              ADT4ST                          TBT4ST
     I              ADT6ST                          TBT6ST
     I              ADBWC3                          TBBWC3
     I              ADBTC3                          TBBTC3
     I              ADBUC3                          TBBUC3
     I              ADBVC3                          TBBVC3
     I              ADFCAA                          TBFCAA
     I              ADRQSX                          TBRQSX
     I              ADRRSX                          TBRRSX
     I              ADRSSX                          TBRSSX
     I              ADRTSX                          TBRTSX
     I              ADT7ST                          TBT7ST
     I              ADT8ST                          TBT8ST
     I              ADRNSX                          TBRNSX
     I              ADROSX                          TBROSX
     I              ADRPSX                          TBRPSX
     I              ADUVST                          TBUVST
     I              ADUWST                          TBUWST
     I              ADUXST                          TBUXST
     I              ADVSST                          TBVSST
     I              ADAATM                          TBAATM
     I              ADAYNA                          TBAYNA
     I              ADA0NA                          TBA0NA
     I              ADAXDT                          TBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          TCAJCD
     I              ADF8NA                          TCF8NA
     I              ADACNA                          TCACNA
     I              ADADNA                          TCADNA
     I              ADAENA                          TCAENA
     I              ADAJNA                          TCAJNA
     I              ADBTTX                          TCBTTX
     I              ADAOCD                          TCAOCD
     I              ADBGCD                          TCBGCD
     I              ADVHST                          TCVHST
     I              ADMPNA                          TCMPNA
     I              ADWPST                          TCWPST
     I              ADXUST                          TCXUST
     I              ADT0ST                          TCT0ST
     I              ADT1ST                          TCT1ST
     I              ADDBNB                          TCDBNB
     I              ADT2ST                          TCT2ST
     I              ADT3ST                          TCT3ST
     I              ADT4ST                          TCT4ST
     I              ADT6ST                          TCT6ST
     I              ADBWC3                          TCBWC3
     I              ADBTC3                          TCBTC3
     I              ADBUC3                          TCBUC3
     I              ADBVC3                          TCBVC3
     I              ADFCAA                          TCFCAA
     I              ADRQSX                          TCRQSX
     I              ADRRSX                          TCRRSX
     I              ADRSSX                          TCRSSX
     I              ADRTSX                          TCRTSX
     I              ADT7ST                          TCT7ST
     I              ADT8ST                          TCT8ST
     I              ADRNSX                          TCRNSX
     I              ADROSX                          TCROSX
     I              ADRPSX                          TCRPSX
     I              ADUVST                          TCUVST
     I              ADUWST                          TCUWST
     I              ADUXST                          TCUXST
     I              ADVSST                          TCVSST
     I              ADAATM                          TCAATM
     I              ADAYNA                          TCAYNA
     I              ADA0NA                          TCA0NA
     I              ADAXDT                          TCAXDT
      *
     I@I5RECR
      * PS Production Department  Converting Depts Only
      * Renamed input format fields
     I              I5AIC3                          TDAIC3
     I              I5R3CD                          TDR3CD
     I              I5MYNA                          TDMYNA
     I              I5DPT1                          TDDPT1
     I              I5UVST                          TDUVST
     I              I5UWST                          TDUWST
     I              I5UXST                          TDUXST
     I              I5VSST                          TDVSST
     I              I5AATM                          TDAATM
     I              I5AYNA                          TDAYNA
     I              I5A0NA                          TDA0NA
     I              I5AXDT                          TDAXDT
      *
     I@I6CPUY
      * PS Std Prod Mix Dist      Retrieval index
      * Renamed input format fields
     I              I6AIC3                          TEAIC3
     I              I6R3CD                          TER3CD
     I              I6T9ST                          TET9ST
     I              I6HGCD                          TEHGCD
     I              I6GJDT                          TEGJDT
     I              I6MXPR                          TEMXPR
     I              I6DHPC                          TEDHPC
     I              I6BMWE                          TEBMWE
     I              I6BMXW                          TEBMXW
     I              I6UAST                          TEUAST
     I              I6UBST                          TEUBST
     I              I6DENB                          TEDENB
     I              I6DFNB                          TEDFNB
     I              I6DHNB                          TEDHNB
     I              I6XRCD                          TEXRCD
     I              I6UVST                          TEUVST
     I              I6UWST                          TEUWST
     I              I6UXST                          TEUXST
     I              I6VSST                          TEVSST
     I              I6AATM                          TEAATM
     I              I6AYNA                          TEAYNA
     I              I6A0NA                          TEA0NA
     I              I6AXDT                          TEAXDT
      *
     I@I5RED6
      * PS Production Department  Fabricating Depts Only
      * Renamed input format fields
     I              I5AIC3                          TFAIC3
     I              I5R3CD                          TFR3CD
     I              I5MYNA                          TFMYNA
     I              I5DPT1                          TFDPT1
     I              I5UVST                          TFUVST
     I              I5UWST                          TFUWST
     I              I5UXST                          TFUXST
     I              I5VSST                          TFVSST
     I              I5AATM                          TFAATM
     I              I5AYNA                          TFAYNA
     I              I5A0NA                          TFA0NA
     I              I5AXDT                          TFAXDT
      *
     I@I5REPY
      * PS Production Department  Credit Depts Only
      * Renamed input format fields
     I              I5AIC3                          TGAIC3
     I              I5R3CD                          TGR3CD
     I              I5MYNA                          TGMYNA
     I              I5DPT1                          TGDPT1
     I              I5UVST                          TGUVST
     I              I5UWST                          TGUWST
     I              I5UXST                          TGUXST
     I              I5VSST                          TGVSST
     I              I5AATM                          TGAATM
     I              I5AYNA                          TGAYNA
     I              I5A0NA                          TGA0NA
     I              I5AXDT                          TGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDJC1    E DSPDJCCPL0
      * UPD : PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WCAIC3
     I              JCV5ST                          WCV5ST
     I              JCELDT                          WCELDT
     I              JCHVHD                          WCHVHD
     I              JCZ6NB                          WCZ6NB
     I              JCZ7NB                          WCZ7NB
     I              JCDGPC                          WCDGPC
     I              JCAVCW                          WCAVCW
     I              JCDIPC                          WCDIPC
     I              JCZ0NB                          WCZ0NB
     I              JCAVLE                          WCAVLE
     I              JCECWG                          WCECWG
     I              JCUVST                          WCUVST
     I              JCUWST                          WCUWST
     I              JCUXST                          WCUXST
     I              JCVSST                          WCVSST
     I              JCAATM                          WCAATM
     I              JCAYNA                          WCAYNA
     I              JCA0NA                          WCA0NA
     I              JCAXDT                          WCAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDIZ1    E DSPDIZREL0
      * UPD : PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WIAIC3
     I              IZRXCD                          WIRXCD
     I              IZGHDT                          WIGHDT
     I              IZUPNB                          WIUPNB
     I              IZUQNB                          WIUQNB
     I              IZULNB                          WIULNB
     I              IZUNNB                          WIUNNB
     I              IZUONB                          WIUONB
     I              IZDIPC                          WIDIPC
     I              IZZ0NB                          WIZ0NB
     I              IZAVLE                          WIAVLE
     I              IZQPNX                          WIQPNX
     I              IZUVST                          WIUVST
     I              IZUWST                          WIUWST
     I              IZUXST                          WIUXST
     I              IZVSST                          WIVSST
     I              IZAATM                          WIAATM
     I              IZAYNA                          WIAYNA
     I              IZA0NA                          WIA0NA
     I              IZAXDT                          WIAXDT
      *
     IYARDCS      DS                             70
     IYBRDCS      DS                             70
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WLAIC3
     I              I8V5ST                          WLV5ST
     I              I8ELDT                          WLELDT
     I              I8HGCD                          WLHGCD
     I              I8AJCD                          WLAJCD
     I              I8GPDT                          WLGPDT
     I              I8WTSP                          WLWTSP
     I              I8QTSP                          WLQTSP
     I              I8DJPC                          WLDJPC
     I              I8F8WG                          WLF8WG
     I              I8WTIN                          WLWTIN
     I              I8D5NB                          WLD5NB
     I              I8DXWG                          WLDXWG
     I              I8B2NB                          WLB2NB
     I              I8WTCN                          WLWTCN
     I              I8PSCV                          WLPSCV
     I              I8SAWT                          WLSAWT
     I              I8B9NB                          WLB9NB
     I              I8D1WG                          WLD1WG
     I              I8CBNB                          WLCBNB
     I              I8EZWG                          WLEZWG
     I              I8CCNB                          WLCCNB
     I              I8E0WG                          WLE0WG
     I              I8D6NB                          WLD6NB
     I              I8OAWT                          WLOAWT
     I              I8CDNB                          WLCDNB
     I              I8UNW2                          WLUNW2
     I              I8CENB                          WLCENB
     I              I8F9WG                          WLF9WG
     I              I8BPNB                          WLBPNB
     I              I8GAWG                          WLGAWG
     I              I8BQNB                          WLBQNB
     I              I8GBWG                          WLGBWG
     I              I8BRNB                          WLBRNB
     I              I8GCWG                          WLGCWG
     I              I8BSNB                          WLBSNB
     I              I8GDWG                          WLGDWG
     I              I8BWNB                          WLBWNB
     I              I8GEWG                          WLGEWG
     I              I8PS6U                          WLPS6U
     I              I8WCST                          WLWCST
     I              I8WPST                          WLWPST
     I              I8B5ST                          WLB5ST
     I              I8TFST                          WLTFST
     I              I8TEST                          WLTEST
     I              I8THST                          WLTHST
     I              I8UDST                          WLUDST
     I              I8UFST                          WLUFST
     I              I8UGST                          WLUGST
     I              I8UHST                          WLUHST
     I              I8B6ST                          WLB6ST
     I              I8B7ST                          WLB7ST
     I              I8DVWG                          WLDVWG
     I              I8D7NB                          WLD7NB
     I              I8FCAD                          WLFCAD
     I              I8D9NB                          WLD9NB
     I              I8DWWG                          WLDWWG
     I              I8EANB                          WLEANB
     I              I8SHWT                          WLSHWT
     I              I8EBNB                          WLEBNB
     I              I8AVWT                          WLAVWT
     I              I8ECNB                          WLECNB
     I              I8WTON                          WLWTON
     I              I8EDNB                          WLEDNB
     I              I8FNWT                          WLFNWT
     I              I8EENB                          WLEENB
     I              I8QTAS                          WLQTAS
     I              I8EFNB                          WLEFNB
     I              I8WAIO                          WLWAIO
     I              I8EGNB                          WLEGNB
     I              I8R3CD                          WLR3CD
     I              I8RGNB                          WLRGNB
     I              I8RHNB                          WLRHNB
     I              I8RINB                          WLRINB
     I              I8XRCD                          WLXRCD
     I              I8UVST                          WLUVST
     I              I8UWST                          WLUWST
     I              I8UXST                          WLUXST
     I              I8VSST                          WLVSST
     I              I8AATM                          WLAATM
     I              I8AYNA                          WLAYNA
     I              I8A0NA                          WLA0NA
     I              I8AXDT                          WLAXDT
      *
     IYCRDCS      DS                            326
     IQPDLM1    E DSPDLMCPL0
      * UPD : PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WRAIC3
     I              LMV5ST                          WRV5ST
     I              LMELDT                          WRELDT
     I              LMR3CD                          WRR3CD
     I              LMRMPA                          WRRMPA
     I              LMGFWG                          WRGFWG
     I              LMGGWG                          WRGGWG
     I              LMCLNB                          WRCLNB
     I              LMGHWG                          WRGHWG
     I              LMDVNB                          WRDVNB
     I              LMGNWG                          WRGNWG
     I              LMDZNB                          WRDZNB
     I              LMGOWG                          WRGOWG
     I              LMD0NB                          WRD0NB
     I              LMGPWG                          WRGPWG
     I              LMD1NB                          WRD1NB
     I              LMGQWG                          WRGQWG
     I              LMD4NB                          WRD4NB
     I              LMGRWG                          WRGRWG
     I              LMTKST                          WRTKST
     I              LMTLST                          WRTLST
     I              LMTNST                          WRTNST
     I              LMCD3S                          WRCD3S
     I              LMTVST                          WRTVST
     I              LMTWST                          WRTWST
     I              LMUVST                          WRUVST
     I              LMUWST                          WRUWST
     I              LMUXST                          WRUXST
     I              LMVSST                          WRVSST
     I              LMAATM                          WRAATM
     I              LMAYNA                          WRAYNA
     I              LMA0NA                          WRA0NA
     I              LMAXDT                          WRAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IYDRDCS      DS                            326
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Kill Date
     I                                    P   3   60P1GGDT
      * I :  Kill Date RGF
     I                                    P   7  100P1IEDT
      * I :  Kill Date RGT
     I                                    P  11  140P1IFDT
      * I :  Production Date
     I                                    P  15  180P1ELDT
      * I :  Production Date RGF
     I                                    P  19  220P1GVDT
      * I :  Production Date RGT
     I                                    P  23  260P1GWDT
      * N :  Cutout Matrix Code
     I                                       27  32 P1RXCD
      * N :  Effective Month/Day
     I                                    P  33  350P1GHDT
      * I :  First Lvl Prod Sts USR
     I                                       36  36 P1KLPN
     IP2PARM      DS
      * N :  System Value Numeric
     I                                    P   1   85P2M8NB
     IP3PARM      DS
      * N :  Average Live Weight
     I                                    P   1   30P3Z6NB
     IP4PARM      DS
      * FLD: Calendar
      * N :  Kill Day Status
     I                                        1   1 P4V9ST
      * N :  Production Day Status
     I                                        2   2 P4WAST
     IP5PARM      DS
      * FLD: User Profile Control
      * N :  User Code Model
     I                                        1  10 P5BUVN
     IP6PARM      DS
      * N :  Production Date USR
     I                                    P   1   40P6GXDT
     IP7PARM      DS
      * I :  Overlay Schedule   USR
     I                                        1   1 P7E6SX
     IP8PARM      DS
      * I :  PSAA Program Name
     I                                        1  10 P8BXVN
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PS Delete Error'
      * Company Number
     I                                        1   3 ZA0001
      * Production Type
     I                                        4   4 ZA0002
      * Production Date
     I                                    P   5   80ZA0003
      * Item Code
     I                                        9  15 ZA0004
      * Warehouse Code
     I                                       16  18 ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1GGDT    PARM           WP0002  70       Kill Date
     C           P1IEDT    PARM           WP0003  70       Kill Date RGF
     C           P1IFDT    PARM           WP0004  70       Kill Date RGT
     C           P1ELDT    PARM           WP0005  70       Production Date
     C           P1GVDT    PARM           WP0006  70       Production Date
     C           P1GWDT    PARM           WP0007  70       Production Date
     C           P1KLPN    PARM           WP0008  1        First Lvl Prod
     C           P7E6SX    PARM           WP0009  1        Overlay Schedul
     C           P8BXVN    PARM           WP0010 10        PSAA Program Na
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPS Bld 1st Lvl cut   XF
      * RMC 9/08/17
      * S11522 chg hog vol calcs- -10% was wrong, and used wrong context
      * ***
      * FP1054 Copied from pdrqxfr to and modified to just build the 1st
      *        level cut for each company as sent thru the par.company
      * FP1054 chg duration from 25 to 40 days -- lcl,*duration (factor)
      * FP1054 pgm is input as MENU or JOBSCHED to control inventory capt
      * in: BPS Conv/Fab/Crd Dept RT - Calendar  *
      * -----------------------------------------------------------------
      * Doc:  Delete Sched/Plan
     C                     EXSR UASUBR                     Doc:  Delete Sc
      * UPS Del Kill/Cut Plan RT - Calendar  * 
     C                     EXSR SARVGN
      * Retrive the default Cutout Matrix for building the Plan.
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0008           Company Number
     C                     MOVEL@CN,001   WL0009    P      Company Value C
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0001    P      System Value Al
     C                     Z-ADD6         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0001:ZQ P1RXCD    P  90  Cutout Matrix C
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD7         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0001:ZQ YL0002    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0002    P1GHDT           Effective Month
      * Process the Calendar for building Schedule for the next
      * production date and the plan for approximately 3 weeks out.
      * UPS Bld Cut Sch/Pln 2 RT - Calendar  * Raw Material Production
     C                     EXSR SFRVGN
      * UPS Bld Kill Sch/Pln  RT - Calendar  * Kill/Rendering Plan
     C                     EXSR TARVGN
      * BPS Conv/Fab/Crd Dept RT - Calendar  * Standard Mix
     C                     EXSR TNRVGN
      * FP1054 Apply production Schedule Override adjustments
      * UPS Apply OV Adj      PF - PS Production Adjustment  * 
     C                     CALL 'PMEFPFR'              90  UPS Apply OV Ad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0082  30       Company Number
     C                     PARM P1GVDT    WQ0083  70       Production Date
     C                     PARM P1GVDT    WQ0084  70       Production Date
     C                     PARM P1GWDT    WQ0085  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMEFPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPS Del Kill/Cut Plan RT - Calendar  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Production Type
     C                     MOVEL*BLANK    WN0002  1        Record Found US
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1GVDT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFRELF                    *
     C           KRSSA     READE@AFRELF                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Post to G/L Date GT PAR.Production Date RGT
     C           WABCDT    IFGT P1GWDT                     *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
      * SetUp Production Type
      * CASE: DB1.Post to G/L Date EQ JOB.*Job date
     C           WABCDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
      * Val Sched Existance   RT - PS Production Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     MOVELWN0001    WL0002    P      Production Type
     C                     Z-ADDWABCDT    WL0003           Production Date
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUWXST    P      Record Found US
      * CASE: PAR.Record Found USR is Record Found
     C           WN0002    IFEQ 'Y'                        *IF
      * UPS Del Sched/Plan    RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0005           Company Number
     C                     MOVELWN0001    WL0006    P      Production Type
     C                     Z-ADDWABCDT    WL0007           Production Date
     C                     EXSR SCRVGN
     C                     END                             *FI
     C           KRSSA     READE@AFRELF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Production Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     MOVELWL0002    WBV5ST           Production Type
     C                     Z-ADDWL0003    WBELDT           Production Date
      * Establish starting position
     C           KRSSB     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0004           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0004           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * UPS Del Sched/Plan    RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0005    WBAIC3           Company Number
     C                     MOVELWL0006    WBV5ST           Production Type
     C                     Z-ADDWL0007    WBELDT           Production Date
      * Establish starting position
     C           KRSSC     CHAIN@JCCPVC              90    *
      * Data record not found
     C   90                MOVEL'USR1795' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Delete the Production Header record
      * DLT Production Hdr     DL - PS Prod Schedule  * 
     C                     EXSR SDDLRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * DLT Production Hdr     DL - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JCCPVB
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     MOVELWBV5ST    WCV5ST           Production Type
     C                     Z-ADDWBELDT    WCELDT           Production Date
      *
     C           KLDLSD    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV5ST           Production Type
     C                     KFLD           WCELDT           Production Date
     C           KLDLSD    CHAIN@JCCPVB              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJCCPL0'MDACP
     C                     MOVEL'@JCCPVB' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JCCPVB                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0008    WDAIC3           Company Number
     C                     MOVELWL0009    WDV8CD           Company Value C
      * Establish starting position
     C           KRSSE     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBXTX    WL0010           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * UPS Bld Cut Sch/Pln 2 RT - Calendar  * Raw Material Production
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Kill Date
     C                     Z-ADD*ZERO     WN0004  50       Hog Volume
     C                     Z-ADD*ZERO     WN0005 155       Std Hot Weight
     C                     Z-ADD*ZERO     WN0006 155       Std Backfat Inc
     C                     Z-ADD*ZERO     WN0007 155       Std Loin-Eye De
     C                     Z-ADD*ZERO     WN0008  50       Hog Volume USR
     C                     MOVEL*BLANK    WN0009  1        Record Found US
     C                     Z-ADD*ZERO     WN0010  50       Hog Volume + 10
     C                     Z-ADD*ZERO     WN0011  50       Hog Volume - 10
     C                     Z-ADD*ZERO     WN0012  50       Count USR
     C                     Z-ADD*ZERO     WN0013 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0014  50       Prior Prod Hog
     C                     Z-ADD*ZERO     WN0015  70       Prior Prod Date
     C                     MOVEL*BLANK    WN0016 10        Library
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0014           Prior Prod Hog
     C                     Z-ADD0         WN0015           Prior Prod Date
      * Rtv Matrix Type       RT - PS Cutout Matrix  * 
     C                     EXSR SGRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSF01           Company Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSF01           Company Number
     C                     Z-ADDP1GVDT    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSF     SETLL@AFREBE                    *
     C           KRSSF     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC 10/12/05 Ovrdbf HPE file PKAOCPP to correct library
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0008           Company Number
     C                     MOVEL@CN,002   WL0009    P      Company Value C
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0016    P      System Value Al
      * CASE: DB1.Plant Date of Last Order GT PAR.Production Date RGT
     C           WEBCDT    IFGT P1GWDT                     *IF
     C                     GOTO SFEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * * Retrieve the Prior Kill Date for creating the Hog Population
      * RTV Kill Dt w/Prd Dt   RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0011           Company Number
     C                     Z-ADDWEBCDT    WL0012           Post to G/L Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WN0003           Kill Date
      * *Retrieve the Hog Volume for Kill Schedule for date being process
      * *NOTE:  Zero Kill Plan and Cut Plan are now allowed in the
      * *       Kill/Cut File in HPE.
      * *       The Retrieve below is needed for Hog Population Only.
      * Rtv Hog Volume  2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKQIXFR'              90  Rtv Hog Volume
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0001  30       Company Number
     C                     PARM WEBCDT    WQ0002  70       Kill Date
     C           WN0004    PARM WN0004    WQ0003  50       Hog Volume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *Retrieve the Cut Est. for Cut Schedule for date being processed.
      * Rtv Cut Estimate 2HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKY6XFR'              90  Rtv Cut Estimat
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0004  30       Company Number
     C                     PARM WEBCDT    WQ0005  70       Kill Date
     C           YL0004    PARM *ZERO     WQ0006  50       Cut Estimate US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CAS: Build Production Schedule/Plan
      * CASE: DB1.Post to G/L Date EQ PAR.Post to G/L Date
     C           WEBCDT    IFEQ P1GVDT                     *IF
      * The population will not be calculated if Hog Volume for the
      * Date being processed is zero.
      * Calculate Hog Population % in the Cutout Matrix.
      * CASE: PAR.First Lvl Prod Sts USR is yes
     C           P1KLPN    IFEQ 'Y'                        *IF
      * Hog Volume + 10%
      * PAR.Hog Volume + 10% USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Hog Volume
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Hog Volume
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON..10
     C           WN0004    MULT .10       W0WD01           *Synon (17,7) w
     C           WN0004    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0010           Hog Volume + 10
      * Hog Volume - 10%
      * PAR.Hog Volume - 10% USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Hog Volume
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Hog Volume
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.-.10
     C           WN0004    MULT -.10      W0WD01           *Synon (17,7) w
     C           WN0004    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0011           Hog Volume - 10
      * Retrieve the Number of Carcass Uploaded.
      * Rtv # Head Killed HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKMSXFR'              90  Rtv # Head Kill
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0007  30       Company Number
     C                     PARM WN0003    WQ0008  70       Kill Date
     C           WN0012    PARM *ZERO     WQ0009  50       Count USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKMSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Count USR is GT 0
     C           WN0012    IFGT 0                          *IF
      * Create Hog Population
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Count USR LE PAR.Hog Volume + 10% USR
      *   |- c2    : PAR.Count USR GE PAR.Hog Volume - 10% USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0012    IFLE WN0010                     *IF
     C           WN0012    IFGE WN0011                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Init Pop Head     RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0014           Company Number
     C                     MOVELP1RXCD    WL0015    P      Cutout Matrix C
     C                     Z-ADDP1GHDT    WL0016           Effective Month
     C                     EXSR SIRVGN
      * Upd Pop Head     2HPE PF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKY2PFR'              90  Upd Pop Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0010  30       Company Number
     C                     PARM WN0003    WQ0011  70       Kill Date
     C                     PARM P1RXCD    WQ0012  6        Cutout Matrix C
     C                     PARM P1GHDT    WQ0013  40       Effective Month
     C           YL0005    PARM *ZERO     WQ0014  50       Head Killed  US
     C                     PARM YL0003    WQ0015  1        Cutout Matrix T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY2PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Clc Population %      RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0017           Company Number
     C                     MOVELP1RXCD    WL0018    P      Cutout Matrix C
     C                     Z-ADDP1GHDT    WL0019           Effective Month
     C                     Z-ADDYL0005    WL0020           Head Killed  US
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Build Schedule w/Cutout Matrix
      * CASE: PAR.First Lvl Prod Sts USR is no
     C           P1KLPN    IFEQ 'N'                        *IF
      * UPS Set Cnv/Fab to 0  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0021           Company Number
     C                     MOVEL'S'       WL0022    P      Production Type
     C                     Z-ADDWEBCDT    WL0023           Production Date
     C                     EXSR SMRVGN
      * UPS Del FG = *All     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0024           Company Number
     C                     MOVEL'S'       WL0025    P      Production Type
     C                     Z-ADDWEBCDT    WL0026           Production Date
     C                     EXSR SORVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Del Sched/Plan    RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0005           Company Number
     C                     MOVEL'S'       WL0006    P      Production Type
     C                     Z-ADDWEBCDT    WL0007           Production Date
     C                     EXSR SCRVGN
      * UPS Delete Dept Sch   RT - PS Prod Dept Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0032           Company Number
     C                     MOVEL'S'       WL0033    P      Production Type
     C                     Z-ADDWEBCDT    WL0034           Production Date
     C                     EXSR SQRVGN
      * UPS Del Schd/Plan Dtl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0035           Company Number
     C                     MOVEL'S'       WL0036    P      Production Type
     C                     Z-ADDWEBCDT    WL0037           Production Date
     C                     EXSR SSRVGN
      * CASE: LCL.Cut Estimate USR is Greater than zero
     C           YL0004    IFGT 0                          *IF
      * U1LP Upd 1st Lvl Plan PF - PS Cutout Item  * 
     C                     CALL 'PDJZPFR'              90  U1LP Upd 1st Lv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0018  30       Company Number
     C                     PARM P1RXCD    WQ0019  6        Cutout Matrix C
     C                     PARM P1GHDT    WQ0020  40       Effective Month
     C                     PARM WN0003    WQ0021  70       Kill Date
     C                     PARM WEBCDT    WQ0022  70       Production Date
     C                     PARM YL0004    WQ0023  50       Hog Volume
     C                     PARM 'S'       WQ0024  1        Production Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Create the Raw Material Production with Zero
      * Cpy Plan to Sched     XF - PS Prod Schedule  * 
     C                     CALL 'PNJ2XFR'              90  Cpy Plan to Sch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0025  30       Company Number
     C                     PARM 'P'       WQ0026  1        Production Type
     C                     PARM WEBCDT    WQ0027  70       Production Date
     C                     PARM 'S'       WQ0028  1        Production Type
     C                     PARM WEBCDT    WQ0029  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNJ2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Build Plan w/Cutout Matrix  (NEW)
      * CASE: PAR.First Lvl Prod Sts USR is no
     C           P1KLPN    IFEQ 'N'                        *IF
      * UPS Set Cnv/Fab to 0  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0021           Company Number
     C                     MOVEL'P'       WL0022    P      Production Type
     C                     Z-ADDWEBCDT    WL0023           Production Date
     C                     EXSR SMRVGN
      * UPS Del FG = *All     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0024           Company Number
     C                     MOVEL'P'       WL0025    P      Production Type
     C                     Z-ADDWEBCDT    WL0026           Production Date
     C                     EXSR SORVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete the Production Header/Detail/Department
      * UPS Del Sched/Plan    RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0005           Company Number
     C                     MOVEL'P'       WL0006    P      Production Type
     C                     Z-ADDWEBCDT    WL0007           Production Date
     C                     EXSR SCRVGN
      * UPS Delete Dept Sch   RT - PS Prod Dept Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0032           Company Number
     C                     MOVEL'P'       WL0033    P      Production Type
     C                     Z-ADDWEBCDT    WL0034           Production Date
     C                     EXSR SQRVGN
      * UPS Del Schd/Plan Dtl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0035           Company Number
     C                     MOVEL'P'       WL0036    P      Production Type
     C                     Z-ADDWEBCDT    WL0037           Production Date
     C                     EXSR SSRVGN
      * CASE: LCL.Cut Estimate USR is Greater than zero
     C           YL0004    IFGT 0                          *IF
      * CASE: LCL.Cut Estimate USR EQ PAR.Prior Prod Hog Vol USR
     C           YL0004    IFEQ WN0014                     *IF
      * * If the Hog Volume did not change from the Prior Day, then the
      * * Copies below will save time by not having to go through the
      * * Cutout Items and build the Raw Material Production.
      * UPS Cpy Prior Prd HDR RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0038           Company Number
     C                     MOVEL'P'       WL0039    P      Production Type
     C                     Z-ADDWN0015    WL0040           Production Date
     C                     Z-ADDWEBCDT    WL0041           Date To
     C                     EXSR STRVGN
      * UPS Cpy Prior Prd DPT RT - PS Prod Dept Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0042           Company Number
     C                     MOVEL'P'       WL0043    P      Production Type
     C                     Z-ADDWN0015    WL0044           Production Date
     C                     Z-ADDWEBCDT    WL0045           Date To
     C                     EXSR SWRVGN
      * UPS Cpy Prior Prd ITM RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     MOVEL'P'       WL0047    P      Production Type
     C                     Z-ADDWN0015    WL0048           Production Date
     C                     Z-ADDWEBCDT    WL0049           Date To
     C                     EXSR SYRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * * The Hog Volume changed from the Prior Day, so the Raw
      * * Material Production needs to be recalculated.
      * U1LP Upd 1st Lvl Plan PF - PS Cutout Item  * 
     C                     CALL 'PDJZPFR'              90  U1LP Upd 1st Lv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0030  30       Company Number
     C                     PARM P1RXCD    WQ0031  6        Cutout Matrix C
     C                     PARM P1GHDT    WQ0032  40       Effective Month
     C                     PARM WN0003    WQ0033  70       Kill Date
     C                     PARM WEBCDT    WQ0034  70       Production Date
     C                     PARM YL0004    WQ0035  50       Hog Volume
     C                     PARM 'P'       WQ0036  1        Production Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Save the Cut Estimate for the date being processed.
      * * It will be checked for the next date being processed.
     C                     Z-ADDYL0004    WN0014           Prior Prod Hog
     C                     Z-ADDWEBCDT    WN0015           Prior Prod Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Create the Raw Material Production with Zero using Schedule recor
      * Cpy Plan to Sched     XF - PS Prod Schedule  * 
     C                     CALL 'PNJ2XFR'              90  Cpy Plan to Sch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0037  30       Company Number
     C                     PARM 'S'       WQ0038  1        Production Type
     C                     PARM ##JDT     WQ0039  70       Production Date
     C                     PARM 'P'       WQ0040  1        Production Type
     C                     PARM WEBCDT    WQ0041  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNJ2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Matrix Type       RT - PS Cutout Matrix  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFRXCD           Cutout Matrix C
     C                     KFLD           WFGHDT           Effective Month
      * Setup key
     C                     Z-ADDP1AIC3    WFAIC3           Company Number
     C                     MOVELP1RXCD    WFRXCD           Cutout Matrix C
     C                     Z-ADDP1GHDT    WFGHDT           Effective Month
      * Establish starting position
     C           KRSSG     CHAIN@I0RES3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1722' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Cutout Matrix T
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFVTST    YL0003           Cutout Matrix T
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Kill Dt w/Prd Dt   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WGBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
      * Setup key
     C                     Z-ADDWL0011    WQSH01           Company Number
     C                     Z-ADDWL0012    WGBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSH     SETLL@AFREPU                    *
     C           KRSSH     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Kill Day Status is yes
     C           WGV9ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWGBCDT    WL0013           Kill Date
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Init Pop Head     RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHRXCD    WQSI02           Cutout Matrix C
     C           *LIKE     DEFN WHGHDT    WQSI03           Effective Month
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Cutout Matrix C
     C                     KFLD           WQSI03           Effective Month
      * Setup key
     C                     Z-ADDWL0014    WQSI01           Company Number
     C                     MOVELWL0015    WQSI02           Cutout Matrix C
     C                     Z-ADDWL0016    WQSI03           Effective Month
      * Establish starting position
     C           KRSSI     SETLL@IZRETC                    *
     C           KRSSI     READE@IZRETC                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Pop Head & %     CH - PS Cutout Dist Lean %  * 
     C                     EXSR SJCHRC
     C           KRSSI     READE@IZRETC                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Pop Head & %     CH - PS Cutout Dist Lean %  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0017  30       Average Cold Wg
     C                     Z-ADD*ZERO     WN0018  52       Average Lean Pe
     C                     Z-ADD*ZERO     WN0019  52       Average Backfat
     C                     Z-ADD*ZERO     WN0020  52       Average Loin-Ey
     C                     MOVEL*BLANK    WN0021  1        EDI Status 1
     C                     MOVEL*BLANK    WN0022  1        EDI Status 2
     C                     MOVEL*BLANK    WN0023  1        EDI Status 3
     C                     MOVEL*BLANK    WN0024  1        Record Status
     C                     Z-ADD*ZERO     WN0025  60       Job Time
     C                     MOVEL*BLANK    WN0026 10        User Id
     C                     MOVEL*BLANK    WN0027 10        Job Name
     C                     Z-ADD*ZERO     WN0028  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @IZRETB
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     MOVELWHRXCD    WIRXCD    P      Cutout Matrix C
     C                     Z-ADDWHGHDT    WIGHDT           Effective Month
     C                     Z-ADDWHUPNB    WIUPNB           Min Carcass Wei
     C                     Z-ADDWHUQNB    WIUQNB           Max Carcass Wei
     C                     Z-ADDWHULNB    WIULNB           Lean Percent
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIRXCD           Cutout Matrix C
     C                     KFLD           WIGHDT           Effective Month
     C                     KFLD           WIUPNB           Min Carcass Wei
     C                     KFLD           WIUQNB           Max Carcass Wei
     C                     KFLD           WIULNB           Lean Percent
     C           KLCHSJ    CHAIN@IZRETB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIZREL0'MDACP
     C                     MOVEL'@IZRETB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIZ1    YARDCS
      * Move non-key fields to @IZRETB
     C                     Z-ADD0         WIUONB           Population Perc
     C                     Z-ADD0         WIQPNX           Population Head
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIZ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@IZRETB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDIZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Clc Population %      RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WJRXCD    WQSK02           Cutout Matrix C
     C           *LIKE     DEFN WJGHDT    WQSK03           Effective Month
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Cutout Matrix C
     C                     KFLD           WQSK03           Effective Month
      * Setup key
     C                     Z-ADDWL0017    WQSK01           Company Number
     C                     MOVELWL0018    WQSK02           Cutout Matrix C
     C                     Z-ADDWL0019    WQSK03           Effective Month
      * Establish starting position
     C           KRSSK     SETLL@IZRENU                    *
     C           KRSSK     READE@IZRENU                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * LCL.Population Percent =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.Population Head
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.Head Killed  USR
      * *     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           WJQPNX    DIV  WL0020    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0006           Population Perc
      * Chg Population %      CH - PS Cutout Dist Lean %  * 
     C                     EXSR SLCHRC
     C           KRSSK     READE@IZRENU                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Population %      CH - PS Cutout Dist Lean %  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0029  30       Average Cold Wg
     C                     Z-ADD*ZERO     WN0030  52       Average Lean Pe
     C                     Z-ADD*ZERO     WN0031  52       Average Backfat
     C                     Z-ADD*ZERO     WN0032  52       Average Loin-Ey
     C                     Z-ADD*ZERO     WN0033  50       Population Head
     C                     MOVEL*BLANK    WN0034  1        EDI Status 1
     C                     MOVEL*BLANK    WN0035  1        EDI Status 2
     C                     MOVEL*BLANK    WN0036  1        EDI Status 3
     C                     MOVEL*BLANK    WN0037  1        Record Status
     C                     Z-ADD*ZERO     WN0038  60       Job Time
     C                     MOVEL*BLANK    WN0039 10        User Id
     C                     MOVEL*BLANK    WN0040 10        Job Name
     C                     Z-ADD*ZERO     WN0041  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @IZRETB
     C                     Z-ADDWJAIC3    WIAIC3           Company Number
     C                     MOVELWJRXCD    WIRXCD    P      Cutout Matrix C
     C                     Z-ADDWJGHDT    WIGHDT           Effective Month
     C                     Z-ADDWJUPNB    WIUPNB           Min Carcass Wei
     C                     Z-ADDWJUQNB    WIUQNB           Max Carcass Wei
     C                     Z-ADDWJULNB    WIULNB           Lean Percent
      *
     C           KLCHSL    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIRXCD           Cutout Matrix C
     C                     KFLD           WIGHDT           Effective Month
     C                     KFLD           WIUPNB           Min Carcass Wei
     C                     KFLD           WIUQNB           Max Carcass Wei
     C                     KFLD           WIULNB           Lean Percent
     C           KLCHSL    CHAIN@IZRETB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIZREL0'MDACP
     C                     MOVEL'@IZRETB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIZ1    YBRDCS
      * Move non-key fields to @IZRETB
     C                     Z-ADDYL0006    WIUONB           Population Perc
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIZ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@IZRETB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDIZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * UPS Set Cnv/Fab to 0  RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WKV5ST    WQSM02           Production Type
     C           *LIKE     DEFN WKELDT    WQSM03           Production Date
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Production Type
     C                     KFLD           WQSM03           Production Date
      * Setup key
     C                     Z-ADDWL0021    WQSM01           Company Number
     C                     MOVELWL0022    WQSM02           Production Type
     C                     Z-ADDWL0023    WQSM03           Production Date
      * Establish starting position
     C           KRSSM     SETLL@I8CPWR                    *
     C           KRSSM     READE@I8CPWR                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * UPS Chg Cnv/Fab to 0  CH - PS Prod Item Schedule  * 
     C                     EXSR SNCHRC
     C           KRSSM     READE@I8CPWR                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * UPS Chg Cnv/Fab to 0  CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0042  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0043  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0044  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0045  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0046  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0047  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0048  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0049  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0050  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0051  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0052  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0053  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0054  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0055  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0056  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0057  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0058  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0059  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0060  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0061  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0062  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0063 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0064  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0065 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0066  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0067 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0068  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0069 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0070  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0071 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0072  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0073 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0074  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0075  3        PS Item Id
     C                     MOVEL*BLANK    WN0076  2        Warehouse Type
     C                     MOVEL*BLANK    WN0077  1        PS Lock Status
     C                     MOVEL*BLANK    WN0078  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0079  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0080  1        PS Piece Count
     C                     MOVEL*BLANK    WN0081  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0082  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0083  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0084  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0085  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0086  3        PS Production W
     C                     Z-ADD*ZERO     WN0087  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0088  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0089  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0090  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0091  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0092  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0093  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0094  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0095  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0096  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0097  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0098  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0099  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0100  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0101  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0102  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0103  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0104  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0105  6        Department Code
     C                     Z-ADD*ZERO     WN0106  30       Item Structure
     C                     Z-ADD*ZERO     WN0107  30       Item Structure
     C                     Z-ADD*ZERO     WN0108  30       Item Structure
     C                     MOVEL*BLANK    WN0109  6        Primal Group Co
     C                     MOVEL*BLANK    WN0110  1        EDI Status 1
     C                     MOVEL*BLANK    WN0111  1        EDI Status 2
     C                     MOVEL*BLANK    WN0112  1        EDI Status 3
     C                     MOVEL*BLANK    WN0113  1        Record Status
     C                     Z-ADD*ZERO     WN0114  60       Job Time
     C                     MOVEL*BLANK    WN0115 10        User Id
     C                     MOVEL*BLANK    WN0116 10        Job Name
     C                     Z-ADD*ZERO     WN0117  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWKAIC3    WLAIC3           Company Number
     C                     MOVELWKV5ST    WLV5ST    P      Production Type
     C                     Z-ADDWKELDT    WLELDT           Production Date
     C                     Z-ADDWKHGCD    WLHGCD           Item Code
     C                     MOVELWKAJCD    WLAJCD    P      Warehouse Code
      *
     C           KLCHSN    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C           KLCHSN    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YCRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADD0         WLWTCN           PS Weight Conve
     C                     Z-ADD0         WLPSCV           PS Pieces Conve
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * UPS Del FG = *All     RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WMV5ST    WQSO02           Production Type
     C           *LIKE     DEFN WMELDT    WQSO03           Production Date
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Production Type
     C                     KFLD           WQSO03           Production Date
      * Setup key
     C                     Z-ADDWL0024    WQSO01           Company Number
     C                     MOVELWL0025    WQSO02           Production Type
     C                     Z-ADDWL0026    WQSO03           Production Date
      * Establish starting position
     C           KRSSO     SETLL@I8CPZZ                    *
     C           KRSSO     READE@I8CPZZ                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Production Dtl    DL - PS Production Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0027           Company Number
     C                     MOVELWMV5ST    WL0028    P      Production Type
     C                     Z-ADDWMELDT    WL0029           Production Date
     C                     Z-ADDWMHGCD    WL0030           Item Code
     C                     MOVELWMAJCD    WL0031    P      Warehouse Code
     C                     EXSR SPDLRC
     C           KRSSO     READE@I8CPZZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPDLRC    BEGSR
      *================================================================
      * Del Production Dtl    DL - PS Production Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I8CPUR
     C                     Z-ADDWL0027    WLAIC3           Company Number
     C                     MOVELWL0028    WLV5ST           Production Type
     C                     Z-ADDWL0029    WLELDT           Production Date
     C                     Z-ADDWL0030    WLHGCD           Item Code
     C                     MOVELWL0031    WLAJCD           Warehouse Code
      *
     C           KLDLSP    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C           KLDLSP    CHAIN@I8CPUR              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I8CPUR                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * UPS Delete Dept Sch   RT - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WOV5ST    WQSQ02           Production Type
     C           *LIKE     DEFN WOELDT    WQSQ03           Production Date
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Production Type
     C                     KFLD           WQSQ03           Production Date
      * Setup key
     C                     Z-ADDWL0032    WQSQ01           Company Number
     C                     MOVELWL0033    WQSQ02           Production Type
     C                     Z-ADDWL0034    WQSQ03           Production Date
      * Establish starting position
     C           KRSSQ     SETLL@LMCPO1                    *
     C           KRSSQ     READE@LMCPO1                  90*
      * Data record not found
     C   90                MOVEL'USR2507' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete PS Prod Dept Sched - PS Prod Dept Schedule  * 
     C                     EXSR SRDLRC
     C           KRSSQ     READE@LMCPO1                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRDLRC    BEGSR
      *================================================================
      * Delete PS Prod Dept Sched - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LMCPO0
     C                     Z-ADDWOAIC3    WRAIC3           Company Number
     C                     MOVELWOV5ST    WRV5ST           Production Type
     C                     Z-ADDWOELDT    WRELDT           Production Date
     C                     MOVELWOR3CD    WRR3CD           Department Code
      *
     C           KLDLSR    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRV5ST           Production Type
     C                     KFLD           WRELDT           Production Date
     C                     KFLD           WRR3CD           Department Code
     C           KLDLSR    CHAIN@LMCPO0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLMCPL0'MDACP
     C                     MOVEL'@LMCPO0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LMCPO0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * UPS Del Schd/Plan Dtl RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WSV5ST    WQSS02           Production Type
     C           *LIKE     DEFN WSELDT    WQSS03           Production Date
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Production Type
     C                     KFLD           WQSS03           Production Date
      * Setup key
     C                     Z-ADDWL0035    WQSS01           Company Number
     C                     MOVELWL0036    WQSS02           Production Type
     C                     Z-ADDWL0037    WQSS03           Production Date
      * Establish starting position
     C           KRSSS     SETLL@I8CPUS                    *
     C           KRSSS     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Production Dtl     DL - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0027           Company Number
     C                     MOVELWSV5ST    WL0028    P      Production Type
     C                     Z-ADDWSELDT    WL0029           Production Date
     C                     Z-ADDWSHGCD    WL0030           Item Code
     C                     MOVELWSAJCD    WL0031    P      Warehouse Code
     C                     EXSR SPDLRC
      * CASE: PGM.*Return code is *Data update error
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           WSAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELWSAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0001           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVELWSV5ST    ZA0002           Production Type
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  WSELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WSHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWSHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWSAJCD    ZA0005           Warehouse Code
      * Retrieve message PS Delete Error
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2305' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKRTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM @CN,004   WQ0016 10        DL List ID
     C                     PARM WUKRTX    WQ0017132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSS     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * UPS Cpy Prior Prd HDR RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0038    WBAIC3           Company Number
     C                     MOVELWL0039    WBV5ST           Production Type
     C                     Z-ADDWL0040    WBELDT           Production Date
      * Establish starting position
     C           KRSST     CHAIN@JCCPVC              90    *
      * Data record not found
     C   90                MOVEL'USR1795' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * U1LP Crt Prd Plan Hdr CR - PS Prod Schedule  * 
     C                     EXSR SUCRRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * U1LP Crt Prd Plan Hdr CR - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JCCPVB
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     MOVELWBV5ST    WCV5ST           Production Type
     C                     Z-ADDWL0041    WCELDT           Production Date
     C                     Z-ADDWBHVHD    WCHVHD           Hog Volume
     C                     Z-ADDWBZ6NB    WCZ6NB           Average Live We
     C                     Z-ADDWBZ7NB    WCZ7NB           Average Hot Wei
     C                     Z-ADDWBDGPC    WCDGPC           Cooler Shrink P
     C                     Z-ADDWBAVCW    WCAVCW           Average Cold We
     C                     Z-ADDWBDIPC    WCDIPC           Average Lean Pe
     C                     Z-ADDWBZ0NB    WCZ0NB           Average Backfat
     C                     Z-ADDWBAVLE    WCAVLE           Average Loin-Ey
     C                     Z-ADDWBECWG    WCECWG           Hot Weight Tota
     C                     MOVELWBUVST    WCUVST           EDI Status 1
     C                     MOVELWBUWST    WCUWST           EDI Status 2
     C                     MOVELWBUXST    WCUXST           EDI Status 3
     C                     MOVELWBVSST    WCVSST           Record Status
     C                     Z-ADDWBAATM    WCAATM           Job Time
     C                     MOVELWBAYNA    WCAYNA           User Id
     C                     MOVELWBA0NA    WCA0NA           Job Name
     C                     Z-ADDWBAXDT    WCAXDT           Job Date
      *
      * USER: Processing before Data update
      * RTV Cooler Shrink %    RT - Company Defaults  * 
     C                     EXSR SVRVGN
      * Cold Weight
      * DB1.Average Cold Weight =
      *    *COMPUTE (x1 - (x1 * (x2 / x3)))
      * x1    : DB1.Average Hot Weight
      * -     : PGM.*Synon (17,7) work field
      * x1    : DB1.Average Hot Weight
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Cooler Shrink Percent
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WCDGPC    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WCZ7NB    MULT W0WD02    W0WD01           *Synon (17,7) w
     C           WCZ7NB    SUB  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WCAVCW           Average Cold We
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WCVSST           Record Status
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSU    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV5ST           Production Type
     C                     KFLD           WCELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSU    SETLL@JCCPVB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1796' W0RTN   7
      * Send message 'PS Prod Schedule       EX'
     C                     MOVEL'USR1796' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@JCCPVB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Cooler Shrink %    RT - Company Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WTAIC3           Company Number
      * Setup key
     C                     Z-ADDWCAIC3    WTAIC3           Company Number
      * Establish starting position
     C           KRSSV     CHAIN@AQREB9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0041' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WCDGPC           Cooler Shrink P
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTDGPC    WCDGPC           Cooler Shrink P
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * UPS Cpy Prior Prd DPT RT - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSW01           Company Number
     C           *LIKE     DEFN WOV5ST    WQSW02           Production Type
     C           *LIKE     DEFN WOELDT    WQSW03           Production Date
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Production Type
     C                     KFLD           WQSW03           Production Date
      * Setup key
     C                     Z-ADDWL0042    WQSW01           Company Number
     C                     MOVELWL0043    WQSW02           Production Type
     C                     Z-ADDWL0044    WQSW03           Production Date
      * Establish starting position
     C           KRSSW     SETLL@LMCPO1                    *
     C           KRSSW     READE@LMCPO1                  90*
      * Data record not found
     C   90                MOVEL'USR2507' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create PS Prod Dept Sched - PS Prod Dept Schedule  * 
     C                     EXSR SXCRRC
     C           KRSSW     READE@LMCPO1                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Create PS Prod Dept Sched - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LMCPO0
     C                     Z-ADDWOAIC3    WRAIC3           Company Number
     C                     MOVELWOV5ST    WRV5ST           Production Type
     C                     Z-ADDWL0045    WRELDT           Production Date
     C                     MOVELWOR3CD    WRR3CD           Department Code
     C                     Z-ADDWORMPA    WRRMPA           CDS RM Pieces A
     C                     Z-ADDWOGFWG    WRGFWG           CDS RM Weight A
     C                     Z-ADDWOGGWG    WRGGWG           CDS Avg Piece W
     C                     Z-ADDWOCLNB    WRCLNB           CDS CV Pieces A
     C                     Z-ADDWOGHWG    WRGHWG           CDS CV Weight A
     C                     Z-ADDWODVNB    WRDVNB           CDS Pieces Unus
     C                     Z-ADDWOGNWG    WRGNWG           CDS Weight Unus
     C                     Z-ADDWODZNB    WRDZNB           CDS Pieces Unus
     C                     Z-ADDWOGOWG    WRGOWG           CDS Weight Unus
     C                     Z-ADDWOD0NB    WRD0NB           CDS Pieces Unus
     C                     Z-ADDWOGPWG    WRGPWG           CDS Weight Unus
     C                     Z-ADDWOD1NB    WRD1NB           CDS Pieces Unus
     C                     Z-ADDWOGQWG    WRGQWG           CDS Weight Unus
     C                     Z-ADDWOD4NB    WRD4NB           CDS Pieces Unus
     C                     Z-ADDWOGRWG    WRGRWG           CDS Weight Unus
     C                     MOVELWOTKST    WRTKST           CDS Department
     C                     MOVELWOTLST    WRTLST           CDS Unused Sts
     C                     MOVELWOTNST    WRTNST           CDS Unused Sts
     C                     MOVELWOCD3S    WRCD3S           CDS Unused Sts
     C                     MOVELWOTVST    WRTVST           CDS Unused Sts
     C                     MOVELWOTWST    WRTWST           CDS Unused Sts
     C                     MOVELWOUVST    WRUVST           EDI Status 1
     C                     MOVELWOUWST    WRUWST           EDI Status 2
     C                     MOVELWOUXST    WRUXST           EDI Status 3
     C                     MOVELWOVSST    WRVSST           Record Status
     C                     Z-ADDWOAATM    WRAATM           Job Time
     C                     MOVELWOAYNA    WRAYNA           User Id
     C                     MOVELWOA0NA    WRA0NA           Job Name
     C                     Z-ADDWOAXDT    WRAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WRVSST           Record Status
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##PGM     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
     C           KLCRSX    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRV5ST           Production Type
     C                     KFLD           WRELDT           Production Date
     C                     KFLD           WRR3CD           Department Code
      * Check for duplicate primary key
     C           KLCRSX    SETLL@LMCPO0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2508' W0RTN   7
      * Send message 'PS Prod Dept Schedule  EX'
     C                     MOVEL'USR2508' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@LMCPO0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * UPS Cpy Prior Prd ITM RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WSV5ST    WQSY02           Production Type
     C           *LIKE     DEFN WSELDT    WQSY03           Production Date
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Production Type
     C                     KFLD           WQSY03           Production Date
      * Setup key
     C                     Z-ADDWL0046    WQSY01           Company Number
     C                     MOVELWL0047    WQSY02           Production Type
     C                     Z-ADDWL0048    WQSY03           Production Date
      * Establish starting position
     C           KRSSY     SETLL@I8CPUS                    *
     C           KRSSY     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * U1LP Crt Prd Plan Dtl CR - PS Prod Item Schedule  * 
     C                     EXSR SZCRRC
     C           KRSSY     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * U1LP Crt Prd Plan Dtl CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWSAIC3    WLAIC3           Company Number
     C                     MOVELWSV5ST    WLV5ST           Production Type
     C                     Z-ADDWL0049    WLELDT           Production Date
     C                     Z-ADDWSHGCD    WLHGCD           Item Code
     C                     MOVELWSAJCD    WLAJCD           Warehouse Code
     C                     Z-ADDWSGPDT    WLGPDT           PS Available Sh
     C                     Z-ADDWSWTSP    WLWTSP           PS Weight Plann
     C                     Z-ADDWSQTSP    WLQTSP           PS Pieces Plann
     C                     Z-ADDWSDJPC    WLDJPC           PS % of Carcass
     C                     Z-ADDWSF8WG    WLF8WG           PS Avg Piece Wg
     C                     Z-ADDWSWTIN    WLWTIN           PS Weight Inv O
     C                     Z-ADDWSD5NB    WLD5NB           PS Pieces Inv O
     C                     Z-ADDWSDXWG    WLDXWG           PS Weight Stand
     C                     Z-ADDWSB2NB    WLB2NB           PS Pieces Stand
     C                     Z-ADDWSWTCN    WLWTCN           PS Weight Conve
     C                     Z-ADDWSPSCV    WLPSCV           PS Pieces Conve
     C                     Z-ADDWSSAWT    WLSAWT           PS Weight Shipp
     C                     Z-ADDWSB9NB    WLB9NB           PS Pieces Shipp
     C                     Z-ADDWSD1WG    WLD1WG           PS Weight Prod
     C                     Z-ADDWSCBNB    WLCBNB           PS Pieces Prod
     C                     Z-ADDWSEZWG    WLEZWG           PS Weight Inv A
     C                     Z-ADDWSCCNB    WLCCNB           PS Pieces Inv A
     C                     Z-ADDWSE0WG    WLE0WG           PS Weight Ship
     C                     Z-ADDWSD6NB    WLD6NB           PS Pieces Ship
     C                     Z-ADDWSOAWT    WLOAWT           PS Weight Prod
     C                     Z-ADDWSCDNB    WLCDNB           PS Pieces Prod
     C                     Z-ADDWSUNW2    WLUNW2           PS Weight Inv A
     C                     Z-ADDWSCENB    WLCENB           PS Pieces Inv A
     C                     Z-ADDWSF9WG    WLF9WG           PS Unit Weight
     C                     Z-ADDWSBPNB    WLBPNB           PS Pieces Whse
     C                     Z-ADDWSGAWG    WLGAWG           PS Weight Whse
     C                     Z-ADDWSBQNB    WLBQNB           PS Pieces Unuse
     C                     Z-ADDWSGBWG    WLGBWG           PS Weight Unuse
     C                     Z-ADDWSBRNB    WLBRNB           PS Pieces Unuse
     C                     Z-ADDWSGCWG    WLGCWG           PS Weight Unuse
     C                     Z-ADDWSBSNB    WLBSNB           PS Pieces Unuse
     C                     Z-ADDWSGDWG    WLGDWG           PS Weight Unuse
     C                     Z-ADDWSBWNB    WLBWNB           PS Pieces Unuse
     C                     Z-ADDWSGEWG    WLGEWG           PS Weight Unuse
     C                     Z-ADDWSPS6U    WLPS6U           PS Pieces Unuse
     C                     MOVELWSWCST    WLWCST           PS Item Id
     C                     MOVELWSWPST    WLWPST           Warehouse Type
     C                     MOVELWSB5ST    WLB5ST           PS Lock Status
     C                     MOVELWSTFST    WLTFST           PS Export/Domes
     C                     MOVELWSTEST    WLTEST           PS Print On Sch
     C                     MOVELWSTHST    WLTHST           PS Piece Count
     C                     MOVELWSUDST    WLUDST           PS Unused Sts 1
     C                     MOVELWSUFST    WLUFST           PS Unused Sts 2
     C                     MOVELWSUGST    WLUGST           PS Unused Sts 3
     C                     MOVELWSUHST    WLUHST           PS Unused Sts 4
     C                     MOVELWSB6ST    WLB6ST           PS Item Sched N
     C                     MOVELWSB7ST    WLB7ST           PS Production W
     C                     Z-ADDWSDVWG    WLDVWG           PS Weight Order
     C                     Z-ADDWSD7NB    WLD7NB           PS Pieces Order
     C                     Z-ADDWSFCAD    WLFCAD           PS Weight FC Ad
     C                     Z-ADDWSD9NB    WLD9NB           PS Pieces FC Ad
     C                     Z-ADDWSDWWG    WLDWWG           PS Weight FX Ad
     C                     Z-ADDWSEANB    WLEANB           PS Pieces FX Ad
     C                     Z-ADDWSSHWT    WLSHWT           PS Weight Sched
     C                     Z-ADDWSEBNB    WLEBNB           PS Pieces Sched
     C                     Z-ADDWSAVWT    WLAVWT           PS Weight Avail
     C                     Z-ADDWSECNB    WLECNB           PS Pieces Avail
     C                     Z-ADDWSWTON    WLWTON           PS Weight Produ
     C                     Z-ADDWSEDNB    WLEDNB           PS Pieces Produ
     C                     Z-ADDWSFNWT    WLFNWT           PS Weight Fab N
     C                     Z-ADDWSEENB    WLEENB           PS Pieces Fab N
     C                     Z-ADDWSQTAS    WLQTAS           PS Weight Sched
     C                     Z-ADDWSEFNB    WLEFNB           PS Pieces Sched
     C                     Z-ADDWSWAIO    WLWAIO           PS Weight Sched
     C                     Z-ADDWSEGNB    WLEGNB           PS Pieces Sched
     C                     MOVELWSR3CD    WLR3CD           Department Code
     C                     Z-ADDWSRGNB    WLRGNB           Item Structure
     C                     Z-ADDWSRHNB    WLRHNB           Item Structure
     C                     Z-ADDWSRINB    WLRINB           Item Structure
     C                     MOVELWSXRCD    WLXRCD           Primal Group Co
     C                     MOVELWSUVST    WLUVST           EDI Status 1
     C                     MOVELWSUWST    WLUWST           EDI Status 2
     C                     MOVELWSUXST    WLUXST           EDI Status 3
     C                     MOVELWSVSST    WLVSST           Record Status
     C                     Z-ADDWSAATM    WLAATM           Job Time
     C                     MOVELWSAYNA    WLAYNA           User Id
     C                     MOVELWSA0NA    WLA0NA           Job Name
     C                     Z-ADDWSAXDT    WLAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WLVSST           Record Status
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     MOVEL'N'       WLB5ST           PS Lock Status
     C           KLCRSZ    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * UPS Bld Kill Sch/Pln  RT - Calendar  * Kill/Rendering Plan
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0118  50       Hog Volume
     C                     Z-ADD*ZERO     WN0119  70       Pieces Per Head
     C                     Z-ADD*ZERO     WN0120 112       Std Weight/Head
     C                     MOVEL*BLANK    WN0121 10        Library
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQTA01           Company Number
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WVBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQTA01           Company Number
     C                     Z-ADDP1IEDT    WVBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTA     SETLL@AFREC2                    *
     C           KRSTA     READE@AFREC2                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Post to G/L Date GT PAR.Kill Date RGT
     C           WVBCDT    IFGT P1IFDT                     *IF
     C                     GOTO TAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Hog Volume  2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKQIXFR'              90  Rtv Hog Volume
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVAIC3    WQ0042  30       Company Number
     C                     PARM WVBCDT    WQ0043  70       Kill Date
     C           WN0118    PARM WN0118    WQ0044  50       Hog Volume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Prd Day Sts       RT - Calendar  * 
     C                     EXSR TBRVGN
      * CASE: DB1.Post to G/L Date EQ PAR.Post to G/L Date
     C           WVBCDT    IFEQ P1IEDT                     *IF
      * UPS Bld Kill Sch/Pln  RT - PS Production Department  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0050           Company Number
     C                     Z-ADDWN0118    WL0051           Hog Volume
     C                     Z-ADDWVBCDT    WL0052           Production Date
     C                     MOVEL'S'       WL0053    P      Production Type
     C                     EXSR TCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Bld Kill Sch/Pln  RT - PS Production Department  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0050           Company Number
     C                     Z-ADDWN0118    WL0051           Hog Volume
     C                     Z-ADDWVBCDT    WL0052           Production Date
     C                     MOVEL'P'       WL0053    P      Production Type
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@AFREC2                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWVAIC3    WEAIC3           Company Number
     C                     Z-ADDWVBCDT    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSTB     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWAST           Production Day
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEWAST    WUWAST           Production Day
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * UPS Bld Kill Sch/Pln  RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTC01           Company Number
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Company Number
      * Setup key
     C                     Z-ADDWL0050    WQTC01           Company Number
      * Establish starting position
     C           KRSTC     SETLL@I5REC4                    *
     C           KRSTC     READE@I5REC4                  90*
      * Data record not found
     C   90                MOVEL'USR1757' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E0178 3/18/2010 RMC Upd std mix per day of week, instead of eff d
      * RTV Day of Week No.   RT - Calendar  * 
     C                     EXSR TDRVGN
      * UPS Bld Kill Sch/Pln  RT - PS Std Prod Mix Dist  * 
     C                     EXSR TERVGN
     C           KRSTC     READE@I5REC4                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Day of Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQTD01           Company Number
     C           *LIKE     DEFN WXBCDT    WQTD02           Post to G/L Dat
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWWAIC3    WQTD01           Company Number
     C                     Z-ADDWL0052    WQTD02           Post to G/L Dat
      * Establish starting position
     C           KRSTD     SETLL@AFREYY                    *
     C           KRSTD     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWXA9ST    YL0007           Day of Week
     C           KRSTD     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * UPS Bld Kill Sch/Pln  RT - PS Std Prod Mix Dist  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0122  70       Pieces Per Head
     C                     Z-ADD*ZERO     WN0123 112       Std Weight/Head
     C                     MOVEL*BLANK    WN0124  3        Default Warehou
     C                     Z-ADD*ZERO     WN0125  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0126  70       PS Pieces Plann
     C                     MOVEL*BLANK    WN0127  3        Production Ware
     C                     Z-ADD*ZERO     WN0128  30       Accounting Comp
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQTE01           Company Number
     C           *LIKE     DEFN WYR3CD    WQTE02           Department Code
     C           *LIKE     DEFN WYT9ST    WQTE03           SM Day of Week
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Company Number
     C                     KFLD           WQTE02           Department Code
     C                     KFLD           WQTE03           SM Day of Week
      * Setup key
     C                     Z-ADDWWAIC3    WQTE01           Company Number
     C                     MOVELWWR3CD    WQTE02           Department Code
     C                     MOVELYL0007    WQTE03           SM Day of Week
      * Establish starting position
     C           KRSTE     SETLL@I6CPBJ                    *
     C           KRSTE     READE@I6CPBJ                  90*
      * Data record not found
     C   90                MOVEL'USR1759' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E0178 3/22/10/ RMC  update every rcd with day of week = prod day
      * Rtv Kill Sch/Pln Info RT - Company Item  * 
     C                     EXSR TFRVGN
      * 08/26/09 PKD S00912 Use Production Warehouse instead of Default W
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0124    WL0054    P      Warehouse Code
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WN0127    P      Production Ware
     C                     Z-ADDWL0056    WN0128           Accounting Comp
     C           WL0051    MULT WN0123    WN0125           PS Weight Plann
     C           WL0051    MULT WN0122    WN0126           PS Pieces Plann
      * UPS Upd Kill Sch/Pln  RT - PS Prod Item Schedule  * 
     C                     EXSR THRVGN
     C           KRSTE     READE@I6CPBJ                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Kill Sch/Pln Info RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
      * Setup key
     C                     Z-ADDWYAIC3    TAAIC3           Company Number
     C                     Z-ADDWYHGCD    TAHGCD           Item Code
      * Establish starting position
     C           KRSTF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0124           Default Warehou
     C                     Z-ADD*ZERO     WN0123           Std Weight/Head
     C                     Z-ADD*ZERO     WN0122           Pieces Per Head
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTAQ1CD    WN0124           Default Warehou
     C                     Z-ADDTASWGH    WN0123           Std Weight/Head
     C                     Z-ADDTAPPHE    WN0122           Pieces Per Head
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           TBAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0054    TBAJCD           Warehouse Code
      * Establish starting position
     C           KRSTG     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0055           Production Ware
     C                     Z-ADD*ZERO     WL0056           Accounting Comp
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBAOCD    WL0055           Production Ware
     C                     Z-ADDTBBTC3    WL0056           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * UPS Upd Kill Sch/Pln  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0129  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0130  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0131  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0132  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0133  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0134  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0135  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0136  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0137  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0138  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0139  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0140  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0141  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0142  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0143  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0144  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0145  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0146  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0147  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0148  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0149  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0150 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0151  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0152 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0153  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0154 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0155  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0156 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0157  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0158 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0159  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0160 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0161  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0162  3        PS Item Id
     C                     MOVEL*BLANK    WN0163  2        Warehouse Type
     C                     MOVEL*BLANK    WN0164  1        PS Lock Status
     C                     MOVEL*BLANK    WN0165  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0166  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0167  1        PS Piece Count
     C                     MOVEL*BLANK    WN0168  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0169  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0170  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0171  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0172  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0173  3        PS Production W
     C                     Z-ADD*ZERO     WN0174  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0175  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0176  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0177  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0178  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0179  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0180  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0181  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0182  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0183  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0184  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0185  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0186  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0187  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0188  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0189  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0190  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0191  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0192  6        Department Code
     C                     Z-ADD*ZERO     WN0193  30       Item Structure
     C                     Z-ADD*ZERO     WN0194  30       Item Structure
     C                     Z-ADD*ZERO     WN0195  30       Item Structure
     C                     MOVEL*BLANK    WN0196  6        Primal Group Co
     C                     MOVEL*BLANK    WN0197  1        EDI Status 1
     C                     MOVEL*BLANK    WN0198  1        EDI Status 2
     C                     MOVEL*BLANK    WN0199  1        EDI Status 3
     C                     MOVEL*BLANK    WN0200  1        Record Status
     C                     Z-ADD*ZERO     WN0201  60       Job Time
     C                     MOVEL*BLANK    WN0202 10        User Id
     C                     MOVEL*BLANK    WN0203 10        Job Name
     C                     Z-ADD*ZERO     WN0204  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWN0128    WSAIC3           Company Number
     C                     MOVELWL0053    WSV5ST           Production Type
     C                     Z-ADDWL0052    WSELDT           Production Date
     C                     Z-ADDWYHGCD    WSHGCD           Item Code
     C                     MOVELWN0127    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTH     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
     C                     EXSR TICRRC
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WN0126    ADD  WSQTSP    WUQTSP           PS Pieces Plann
     C           WN0125    ADD  WSWTSP    WUWTSP           PS Weight Plann
      * UPS Chg Kill Wgt/Pcs  CH - PS Prod Item Schedule  * 
     C                     EXSR TMCHRC
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWN0128    WLAIC3           Company Number
     C                     MOVELWL0053    WLV5ST           Production Type
     C                     Z-ADDWL0052    WLELDT           Production Date
     C                     Z-ADDWYHGCD    WLHGCD           Item Code
     C                     MOVELWN0127    WLAJCD           Warehouse Code
     C                     Z-ADDWN0129    WLGPDT           PS Available Sh
     C                     Z-ADDWN0125    WLWTSP           PS Weight Plann
     C                     Z-ADDWN0126    WLQTSP           PS Pieces Plann
     C                     Z-ADDWN0130    WLDJPC           PS % of Carcass
     C                     Z-ADDWN0131    WLF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0132    WLWTIN           PS Weight Inv O
     C                     Z-ADDWN0133    WLD5NB           PS Pieces Inv O
     C                     Z-ADDWN0134    WLDXWG           PS Weight Stand
     C                     Z-ADDWN0135    WLB2NB           PS Pieces Stand
     C                     Z-ADDWN0136    WLWTCN           PS Weight Conve
     C                     Z-ADDWN0137    WLPSCV           PS Pieces Conve
     C                     Z-ADDWN0138    WLSAWT           PS Weight Shipp
     C                     Z-ADDWN0139    WLB9NB           PS Pieces Shipp
     C                     Z-ADDWN0140    WLD1WG           PS Weight Prod
     C                     Z-ADDWN0141    WLCBNB           PS Pieces Prod
     C                     Z-ADDWN0142    WLEZWG           PS Weight Inv A
     C                     Z-ADDWN0143    WLCCNB           PS Pieces Inv A
     C                     Z-ADDWN0144    WLE0WG           PS Weight Ship
     C                     Z-ADDWN0145    WLD6NB           PS Pieces Ship
     C                     Z-ADDWN0146    WLOAWT           PS Weight Prod
     C                     Z-ADDWN0147    WLCDNB           PS Pieces Prod
     C                     Z-ADDWN0148    WLUNW2           PS Weight Inv A
     C                     Z-ADDWN0149    WLCENB           PS Pieces Inv A
     C                     Z-ADDWN0150    WLF9WG           PS Unit Weight
     C                     Z-ADDWN0151    WLBPNB           PS Pieces Whse
     C                     Z-ADDWN0152    WLGAWG           PS Weight Whse
     C                     Z-ADDWN0153    WLBQNB           PS Pieces Unuse
     C                     Z-ADDWN0154    WLGBWG           PS Weight Unuse
     C                     Z-ADDWN0155    WLBRNB           PS Pieces Unuse
     C                     Z-ADDWN0156    WLGCWG           PS Weight Unuse
     C                     Z-ADDWN0157    WLBSNB           PS Pieces Unuse
     C                     Z-ADDWN0158    WLGDWG           PS Weight Unuse
     C                     Z-ADDWN0159    WLBWNB           PS Pieces Unuse
     C                     Z-ADDWN0160    WLGEWG           PS Weight Unuse
     C                     Z-ADDWN0161    WLPS6U           PS Pieces Unuse
     C                     MOVELWN0162    WLWCST           PS Item Id
     C                     MOVELWN0163    WLWPST           Warehouse Type
     C                     MOVELWN0164    WLB5ST           PS Lock Status
     C                     MOVELWN0165    WLTFST           PS Export/Domes
     C                     MOVELWN0166    WLTEST           PS Print On Sch
     C                     MOVELWN0167    WLTHST           PS Piece Count
     C                     MOVELWN0168    WLUDST           PS Unused Sts 1
     C                     MOVELWN0169    WLUFST           PS Unused Sts 2
     C                     MOVELWN0170    WLUGST           PS Unused Sts 3
     C                     MOVELWN0171    WLUHST           PS Unused Sts 4
     C                     MOVELWN0172    WLB6ST           PS Item Sched N
     C                     MOVELWN0173    WLB7ST           PS Production W
     C                     Z-ADDWN0174    WLDVWG           PS Weight Order
     C                     Z-ADDWN0175    WLD7NB           PS Pieces Order
     C                     Z-ADDWN0176    WLFCAD           PS Weight FC Ad
     C                     Z-ADDWN0177    WLD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0178    WLDWWG           PS Weight FX Ad
     C                     Z-ADDWN0179    WLEANB           PS Pieces FX Ad
     C                     Z-ADDWN0180    WLSHWT           PS Weight Sched
     C                     Z-ADDWN0181    WLEBNB           PS Pieces Sched
     C                     Z-ADDWN0182    WLAVWT           PS Weight Avail
     C                     Z-ADDWN0183    WLECNB           PS Pieces Avail
     C                     Z-ADDWN0184    WLWTON           PS Weight Produ
     C                     Z-ADDWN0185    WLEDNB           PS Pieces Produ
     C                     Z-ADDWN0186    WLFNWT           PS Weight Fab N
     C                     Z-ADDWN0187    WLEENB           PS Pieces Fab N
     C                     Z-ADDWN0188    WLQTAS           PS Weight Sched
     C                     Z-ADDWN0189    WLEFNB           PS Pieces Sched
     C                     Z-ADDWN0190    WLWAIO           PS Weight Sched
     C                     Z-ADDWN0191    WLEGNB           PS Pieces Sched
     C                     MOVELWN0192    WLR3CD           Department Code
     C                     Z-ADDWN0193    WLRGNB           Item Structure
     C                     Z-ADDWN0194    WLRHNB           Item Structure
     C                     Z-ADDWN0195    WLRINB           Item Structure
     C                     MOVELWN0196    WLXRCD           Primal Group Co
     C                     MOVELWN0197    WLUVST           EDI Status 1
     C                     MOVELWN0198    WLUWST           EDI Status 2
     C                     MOVELWN0199    WLUXST           EDI Status 3
     C                     MOVELWN0200    WLVSST           Record Status
     C                     Z-ADDWN0201    WLAATM           Job Time
     C                     MOVELWN0202    WLAYNA           User Id
     C                     MOVELWN0203    WLA0NA           Job Name
     C                     Z-ADDWN0204    WLAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0205 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR TJRVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR TKRVGN
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WLWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WLWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWLAJCD    WL0054    P      Warehouse Code
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WLB7ST    P      Production Ware
     C                     Z-ADDWL0056    YL0008           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0057           Company Number
     C                     Z-ADDWL0052    WL0058           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0059           Fresh Chilling
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0060    WLGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0057           Company Number
     C                     Z-ADDWL0052    WL0058           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0059           Fresh Chilling
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0060    WLGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0126    IFGT 0                          *IF
     C           WN0125    DIV  WN0126    WLF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WLVSST           Record Status
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C                     MOVEL'N'       WLB5ST           PS Lock Status
     C           KLCRTI    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTI    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
      * Setup key
     C                     Z-ADDWLAIC3    TAAIC3           Company Number
     C                     Z-ADDWLHGCD    TAHGCD           Item Code
      * Establish starting position
     C           KRSTJ     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUADCD           U/M - Primary
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     MOVEL*BLANK    WUQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    WLR3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    WLTHST           Piece Count Ite
     C                     Z-ADD*ZERO     WUBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WUBJNB           Bags Per Unit
     C                     MOVEL*BLANK    WLTFST           Export/Domestic
     C                     MOVEL*BLANK    WLTEST           Print On Schedu
     C                     MOVEL*BLANK    WUSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    WUSZST           Fresh Sched As
     C                     MOVEL*BLANK    WUS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    WLXRCD           Primal Group Co
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTAAVNA    WUAVNA           Description Lin
     C                     MOVELTAADCD    WUADCD           U/M - Primary
     C                     Z-ADDTAAIWG    WUAIWG           Unit Weight
     C                     Z-ADDTARINB    WLRINB           Item Structure
     C                     Z-ADDTARHNB    WLRHNB           Item Structure
     C                     Z-ADDTARGNB    WLRGNB           Item Structure
     C                     MOVELTAN0CD    WUN0CD           Item Type Code
     C                     MOVELTAQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDTACHTM    WUCHTM           Fresh Chilling
     C                     MOVELTAQZCD    WUQZCD           Base/Conv/Loss
     C                     MOVELTAXWST    WUXWST           Variety/Rendere
     C                     MOVELTAVMST    WUVMST           Credit Item Sta
     C                     Z-ADDTASWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDTAPPHE    WUPPHE           Pieces Per Head
     C                     MOVELTAR3CD    WLR3CD           Department Code
     C                     MOVELTASDCD    WUSDCD           Group for Packa
     C                     MOVELTAX5ST    WUX5ST           Seconds Item
     C                     MOVELTAPCCT    WLTHST           Piece Count Ite
     C                     Z-ADDTABDNB    WUBDNB           Pieces Per Bag
     C                     Z-ADDTABJNB    WUBJNB           Bags Per Unit
     C                     MOVELTASUST    WLTFST           Export/Domestic
     C                     MOVELTASVST    WLTEST           Print On Schedu
     C                     MOVELTASYST    WUSYST           Fresh Inv Alloc
     C                     MOVELTASZST    WUSZST           Fresh Sched As
     C                     MOVELTAS1ST    WUS1ST           Frozen Inv Allo
     C                     MOVELTAXRCD    WLXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           TCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWLAJCD    TCAJCD           Warehouse Code
      * Establish starting position
     C           KRSTK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WLWPST           Warehouse Type
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUT0ST           Warehouse Locat
     C                     MOVEL*BLANK    WUT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     WUDBNB           Warehouse Chill
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTCWPST    WLWPST           Warehouse Type
     C                     MOVELTCXUST    WUXUST           Trans Contol AS
     C                     MOVELTCT0ST    WUT0ST           Warehouse Locat
     C                     MOVELTCT1ST    WUT1ST           Warehouse Std C
     C                     Z-ADDTCDBNB    WUDBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQTL01           Company Number
      * Define keylist
     C           KPSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
      * Setup key
     C                     Z-ADDWL0057    WQTL01           Company Number
     C                     Z-ADDWL0058    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTL     SETLL@AFREBE                    *
     C           KRSTL     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0059                     *IF
     C                     Z-ADDWEBCDT    WL0060           PS Available Sh
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WEA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSTL     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCHRC    BEGSR
      *================================================================
      * UPS Chg Kill Wgt/Pcs  CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0206  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0207  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0208  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0209  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0210  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0211  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0212  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0213  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0214  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0215  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0216  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0217  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0218  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0219  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0220  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0221  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0222  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0223  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0224  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0225 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0226  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0227 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0228  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0229 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0230  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0231 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0232  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0233 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0234  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0235 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0236  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0237  3        PS Item Id
     C                     MOVEL*BLANK    WN0238  2        Warehouse Type
     C                     MOVEL*BLANK    WN0239  1        PS Lock Status
     C                     MOVEL*BLANK    WN0240  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0241  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0242  1        PS Piece Count
     C                     MOVEL*BLANK    WN0243  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0244  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0245  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0246  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0247  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0248  3        PS Production W
     C                     Z-ADD*ZERO     WN0249  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0250  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0251  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0252  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0253  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0254  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0255  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0256  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0257  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0258  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0259  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0260  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0261  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0262  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0263  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0264  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0265  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0266  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0267  6        Department Code
     C                     Z-ADD*ZERO     WN0268  30       Item Structure
     C                     Z-ADD*ZERO     WN0269  30       Item Structure
     C                     Z-ADD*ZERO     WN0270  30       Item Structure
     C                     MOVEL*BLANK    WN0271  6        Primal Group Co
     C                     MOVEL*BLANK    WN0272  1        EDI Status 1
     C                     MOVEL*BLANK    WN0273  1        EDI Status 2
     C                     MOVEL*BLANK    WN0274  1        EDI Status 3
     C                     MOVEL*BLANK    WN0275  1        Record Status
     C                     Z-ADD*ZERO     WN0276  60       Job Time
     C                     MOVEL*BLANK    WN0277 10        User Id
     C                     MOVEL*BLANK    WN0278 10        Job Name
     C                     Z-ADD*ZERO     WN0279  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WLAIC3           Company Number
     C                     MOVELWSV5ST    WLV5ST    P      Production Type
     C                     Z-ADDWSELDT    WLELDT           Production Date
     C                     Z-ADDWSHGCD    WLHGCD           Item Code
     C                     MOVELWSAJCD    WLAJCD    P      Warehouse Code
      *
     C           KLCHTM    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C           KLCHTM    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YDRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWUWTSP    WLWTSP           PS Weight Plann
     C                     Z-ADDWUQTSP    WLQTSP           PS Pieces Plann
     C                     Z-ADDWSDXWG    WLDXWG           PS Weight Stand
     C                     Z-ADDWSB2NB    WLB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C                     MOVEL##PGM     WLA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * BPS Conv/Fab/Crd Dept RT - Calendar  * Standard Mix
      *================================================================
      *
     C                     MOVEL*BLANK    WN0280  1        Production Type
     C                     Z-ADD*ZERO     WN0281  70       Production Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQTN01           Company Number
      * Define keylist
     C           KPSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQTN01           Company Number
     C                     Z-ADDP1GVDT    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTN     SETLL@AFREBE                    *
     C           KRSTN     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Post to G/L Date GT PAR.Production Date RGT
     C           WEBCDT    IFGT P1GWDT                     *IF
     C                     GOTO TNEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEBCDT    WN0281           Production Date
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     MOVEL'S'       WL0002    P      Production Type
     C                     Z-ADDWN0281    WL0003           Production Date
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUWXST    P      Record Found US
      * Production Type
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
     C                     MOVEL'S'       WN0280           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       WN0280           Production Type
     C                     END                             *FI
      * Create the Finished Goods in the Item Schedule (PDI8CPP)
      * UPS Bld FG Items      XF - Company Item  * 
     C                     CALL 'PDQ7XFR'              90  UPS Bld FG Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0045  30       Company Number
     C                     PARM WN0280    WQ0046  1        Production Type
     C                     PARM WN0281    WQ0047  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Capture Inventory
      * CASE: PAR.PSAA Program Name is JOB SCHEDULER
     C           P8BXVN    IFEQ @CN,005                    *IF
      * ONLY DO THIS IF CALLED FROM THE JOB SCHED IN THE MORNING 6/08/09
      * E4122 -06/17/2014 Move the capture of inventory in PMD1XFR
     C                     ELSE
      * CASE: *OTHERWISE
      * Update PDI8CPP Inventory On-Hand with POCWCPP.
      * CASE: DB1.Post to G/L Date EQ JOB.*Job date
     C           WEBCDT    IFEQ ##JDT                      *IF
      * Upd Item Prod Sched   XF - PS Prod Item Inventory  * 
     C                     CALL 'PNJRXFR'              90  Upd Item Prod S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0048  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNJRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     MOVELWN0280    WL0002    P      Production Type
     C                     Z-ADDWN0281    WL0003           Production Date
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUWXST    P      Record Found US
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
      * BPS Conv Dept RMA/SMP RT - PS Production Department  * 
     C                     EXSR TORVGN
      * BPS Fab Dept SMP      RT - PS Production Department  * 
     C                     EXSR TQRVGN
      * BPS Credit Dept SMP   RT - PS Production Department  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTN     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * BPS Conv Dept RMA/SMP RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDAIC3    WQTO01           Company Number
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTO01           Company Number
      * Establish starting position
     C           KRSTO     SETLL@I5RECR                    *
     C           KRSTO     READE@I5RECR                  90*
      * Data record not found
     C   90                MOVEL'USR1757' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Std Mix Existance RT - PS Std Prod Mix Dist  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0061           Company Number
     C                     MOVELTDR3CD    WL0062    P      Department Code
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WUWXST    P      Record Found US
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
      * BPS Dept RMA          PF - PS Prod Item Schedule  * 
     C                     CALL 'PDAEPFR'              90  BPS Dept RMA
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TDAIC3    WQ0049  30       Company Number
     C                     PARM WN0280    WQ0050  1        Production Type
     C                     PARM WN0281    WQ0051  70       Production Date
     C                     PARM TDR3CD    WQ0052  6        Department Code
     C                     PARM TDDPT1    WQ0053  1        CDS Department
     C                     PARM 'CV'      WQ0054  2        Std Mix Prod Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAEPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * BPS Cnv/Fab/Crd SMP   PF - PS Prod Dept Schedule  * 
     C                     CALL 'PDZ9PFR'              90  BPS Cnv/Fab/Crd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TDAIC3    WQ0055  30       Company Number
     C                     PARM WN0280    WQ0056  1        Production Type
     C                     PARM WN0281    WQ0057  70       Production Date
     C                     PARM TDR3CD    WQ0058  6        Department Code
     C                     PARM 'CV'      WQ0059  2        Std Mix Prod Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSTO     READE@I5RECR                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Val Std Mix Existance RT - PS Std Prod Mix Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEAIC3    WQTP01           Company Number
     C           *LIKE     DEFN TER3CD    WQTP02           Department Code
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Department Code
      * Setup key
     C                     Z-ADDWL0061    WQTP01           Company Number
     C                     MOVELWL0062    WQTP02           Department Code
      * Establish starting position
     C           KRSTP     SETLL@I6CPUY                    *
     C           KRSTP     READE@I6CPUY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1759' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0063           Record Found US
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0063           Record Found US
     C                     GOTO TPEXIT                     *QUIT
     C           KRSTP     READE@I6CPUY                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * BPS Fab Dept SMP      RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQTQ01           Company Number
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Company Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTQ01           Company Number
      * Establish starting position
     C           KRSTQ     SETLL@I5RED6                    *
     C           KRSTQ     READE@I5RED6                  90*
      * Data record not found
     C   90                MOVEL'USR1757' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Std Mix Existance RT - PS Std Prod Mix Dist  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTFAIC3    WL0061           Company Number
     C                     MOVELTFR3CD    WL0062    P      Department Code
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WUWXST    P      Record Found US
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
      * BPS Dept RMA          PF - PS Prod Item Schedule  * 
     C                     CALL 'PDAEPFR'              90  BPS Dept RMA
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TFAIC3    WQ0060  30       Company Number
     C                     PARM WN0280    WQ0061  1        Production Type
     C                     PARM WN0281    WQ0062  70       Production Date
     C                     PARM TFR3CD    WQ0063  6        Department Code
     C                     PARM TFDPT1    WQ0064  1        CDS Department
     C                     PARM 'FB'      WQ0065  2        Std Mix Prod Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAEPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * BPS Cnv/Fab/Crd SMP   PF - PS Prod Dept Schedule  * 
     C                     CALL 'PDZ9PFR'              90  BPS Cnv/Fab/Crd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TFAIC3    WQ0066  30       Company Number
     C                     PARM WN0280    WQ0067  1        Production Type
     C                     PARM WN0281    WQ0068  70       Production Date
     C                     PARM TFR3CD    WQ0069  6        Department Code
     C                     PARM 'FB'      WQ0070  2        Std Mix Prod Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSTQ     READE@I5RED6                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * BPS Credit Dept SMP   RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TGAIC3    WQTR01           Company Number
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTR01           Company Number
      * Establish starting position
     C           KRSTR     SETLL@I5REPY                    *
     C           KRSTR     READE@I5REPY                  90*
      * Data record not found
     C   90                MOVEL'USR1757' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Std Mix Existance RT - PS Std Prod Mix Dist  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTGAIC3    WL0061           Company Number
     C                     MOVELTGR3CD    WL0062    P      Department Code
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WUWXST    P      Record Found US
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
      * BPS Dept RMA          PF - PS Prod Item Schedule  * 
     C                     CALL 'PDAEPFR'              90  BPS Dept RMA
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TGAIC3    WQ0071  30       Company Number
     C                     PARM WN0280    WQ0072  1        Production Type
     C                     PARM WN0281    WQ0073  70       Production Date
     C                     PARM TGR3CD    WQ0074  6        Department Code
     C                     PARM TGDPT1    WQ0075  1        CDS Department
     C                     PARM 'CR'      WQ0076  2        Std Mix Prod Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAEPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * BPS Cnv/Fab/Crd SMP   PF - PS Prod Dept Schedule  * 
     C                     CALL 'PDZ9PFR'              90  BPS Cnv/Fab/Crd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TGAIC3    WQ0077  30       Company Number
     C                     PARM WN0280    WQ0078  1        Production Type
     C                     PARM WN0281    WQ0079  70       Production Date
     C                     PARM TGR3CD    WQ0080  6        Department Code
     C                     PARM 'CR'      WQ0081  2        Std Mix Prod Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSTR     READE@I5REPY                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Doc:  Delete Sched/Plan
      *================================================================
      * Delete Schedule/Plan For Calendar Change
      * If a Kill Plan or a Cut Schedule was built and needs to be
      * deleted.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1RXCD           Cutout Matrix C
     C                     Z-ADD*ZERO     P1GHDT           Effective Month
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     Z-ADD*ZERO     P3Z6NB           Average Live We
     C                     MOVEL*BLANK    P4V9ST           Kill Day Status
     C                     MOVEL*BLANK    P4WAST           Production Day
     C                     MOVEL*BLANK    P5BUVN           User Code Model
     C                     Z-ADD*ZERO     P6GXDT           Production Date
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBHVHD           Hog Volume
     C                     Z-ADD*ZERO     WBZ6NB           Average Live We
     C                     Z-ADD*ZERO     WBZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WBDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WBAVCW           Average Cold We
     C                     Z-ADD*ZERO     WBDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WBZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WBAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WBECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDM8NB           System Value Nu
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFGHDT           Effective Month
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHGHDT           Effective Month
     C                     Z-ADD*ZERO     WHUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WHUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WHULNB           Lean Percent
     C                     Z-ADD*ZERO     WHUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WHUONB           Population Perc
     C                     Z-ADD*ZERO     WHDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WHZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WHAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WHQPNX           Population Head
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKELDT           Production Date
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WKWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WKQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WKDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WKF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WKWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WKD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WKDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WKB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WKWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WKPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WKSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WKB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WKD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WKCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WKEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WKCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WKE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WKD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WKOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WKCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WKUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WKCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WKF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WKBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WKGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WKBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WKGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WKBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WKGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WKBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WKGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WKBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WKGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WKPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WKDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WKD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WKFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WKD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WKDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WKEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WKSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WKEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WKAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WKECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WKWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WKEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WKFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WKEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WKQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WKEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WKWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WKEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WORMPA           CDS RM Pieces A
     C                     Z-ADD*ZERO     WOGFWG           CDS RM Weight A
     C                     Z-ADD*ZERO     WOGGWG           CDS Avg Piece W
     C                     Z-ADD*ZERO     WOCLNB           CDS CV Pieces A
     C                     Z-ADD*ZERO     WOGHWG           CDS CV Weight A
     C                     Z-ADD*ZERO     WODVNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WOGNWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WODZNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WOGOWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WOD0NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WOGPWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WOD1NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WOGQWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WOD4NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WOGRWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field Office Message USR
     C                     MOVEL*BLANK    WUKRTX132
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTASVA           Credit Limit
     C                     Z-ADD*ZERO     WTDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define work field Production Day Status
     C                     MOVEL*BLANK    WUWAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYHGCD           Item Code
     C                     Z-ADD*ZERO     WYGJDT           Effective Produ
     C                     Z-ADD*ZERO     WYMXPR           Mix Priority
     C                     Z-ADD*ZERO     WYDHPC           Mix Percent
     C                     Z-ADD*ZERO     WYBMWE           Export/Domestic
     C                     Z-ADD*ZERO     WYBMXW           Select Range Ma
     C                     Z-ADD*ZERO     WYDENB           Pieces Override
     C                     Z-ADD*ZERO     WYDFNB           SM Unused Nbr 2
     C                     Z-ADD*ZERO     WYDHNB           Weight Override
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAHGCD           Item Code
     C                     Z-ADD*ZERO     TAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     TAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     TAAIWG           Unit Weight
     C                     Z-ADD*ZERO     TACZWG           Minimum Weight
     C                     Z-ADD*ZERO     TAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     TAURTN           Number Cases On
     C                     Z-ADD*ZERO     TAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     TARINB           Item Structure
     C                     Z-ADD*ZERO     TARHNB           Item Structure
     C                     Z-ADD*ZERO     TARGNB           Item Structure
     C                     Z-ADD*ZERO     TATFNB           Transportation
     C                     Z-ADD*ZERO     TATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     TATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     TABLPR           Market Overage
     C                     Z-ADD*ZERO     TABMPR           Standard Overag
     C                     Z-ADD*ZERO     TACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     TACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     TASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     TAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     TAICN1           Item Category N
     C                     Z-ADD*ZERO     TAICN2           Item Category N
     C                     Z-ADD*ZERO     TAV2NB           Item Category N
     C                     Z-ADD*ZERO     TAITCN           Item Category N
     C                     Z-ADD*ZERO     TAITC5           Item Category N
     C                     Z-ADD*ZERO     TAICN6           Item Category N
     C                     Z-ADD*ZERO     TAICN7           Item Category N
     C                     Z-ADD*ZERO     TAICN8           Item Category N
     C                     Z-ADD*ZERO     TAICN9           Item Category N
     C                     Z-ADD*ZERO     TAICN0           Item Category N
     C                     Z-ADD*ZERO     TASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     TAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     TASJNB           Production Lead
     C                     Z-ADD*ZERO     TASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     TASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     TASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     TACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     TACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     TAILNB           Packages per ca
     C                     Z-ADD*ZERO     TACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     TACINB           PM Batch Size
     C                     Z-ADD*ZERO     TACJNB           Package Level s
     C                     Z-ADD*ZERO     TACMNB           Partial Item Co
     C                     Z-ADD*ZERO     TACNNB           WIP Item Code
     C                     Z-ADD*ZERO     TACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     TACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     TACVNB           FP Std Green We
     C                     Z-ADD*ZERO     TACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     TACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     TACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     TAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     TAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     TAB5NB           PM Line Number
     C                     Z-ADD*ZERO     TABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     TABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     TAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     TAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     TAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     TABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     TABNNB           Production Qty
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     TBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     TBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     TBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     TBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field PS Pieces Planned Prod
     C                     Z-ADD*ZERO     WUQTSP  70
      * Define work field PS Weight Planned Prod
     C                     Z-ADD*ZERO     WUWTSP  92
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  1
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006  1
     C                     Z-ADD*ZERO     WL0007  70
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009 10
     C                     MOVEL*BLANK    WL0010 40
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  70
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     MOVEL*BLANK    WL0015  6
     C                     Z-ADD*ZERO     WL0016  40
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  6
     C                     Z-ADD*ZERO     WL0019  40
     C                     Z-ADD*ZERO     WL0020  50
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     MOVEL*BLANK    WL0022  1
     C                     Z-ADD*ZERO     WL0023  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026  70
      * Define local variables for subroutine SPDLRC.
     C                     Z-ADD*ZERO     WL0027  30
     C                     MOVEL*BLANK    WL0028  1
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  70
     C                     MOVEL*BLANK    WL0031  3
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0032  30
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  70
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     MOVEL*BLANK    WL0036  1
     C                     Z-ADD*ZERO     WL0037  70
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0038  30
     C                     MOVEL*BLANK    WL0039  1
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  70
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0042  30
     C                     MOVEL*BLANK    WL0043  1
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  70
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0046  30
     C                     MOVEL*BLANK    WL0047  1
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0050  30
     C                     Z-ADD*ZERO     WL0051  50
     C                     Z-ADD*ZERO     WL0052  70
     C                     MOVEL*BLANK    WL0053  1
      * Define local variables for subroutine TGRVGN.
     C                     MOVEL*BLANK    WL0054  3
     C                     MOVEL*BLANK    WL0055  3
     C                     Z-ADD*ZERO     WL0056  30
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0057  30
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  52
     C                     Z-ADD*ZERO     WL0060  70
      * Define local variables for subroutine TPRVGN.
     C                     Z-ADD*ZERO     WL0061  30
     C                     MOVEL*BLANK    WL0062  6
     C                     MOVEL*BLANK    WL0063  1
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0001 40
      * Define local work field Text USR 4
     C                     MOVEL*BLANK    YL0002  4
      * Define local work field Cutout Matrix Type
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Cut Estimate USR
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Head Killed  USR
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field Population Percent
     C                     Z-ADD*ZERO     YL0006  95
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0008  30
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PPSDFTMTX
00002 HPELIB
00003 Y2U0004
00004 PRKDEV
00005 JOBSCHED
