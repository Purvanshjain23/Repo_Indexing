     H/TITLE Dlt GAF Order Hdr/Dtl  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/24/10  Time  : 16:20:36
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPONMREL1IF  E           K        DISK
      * RTV : WF GAF Batch Control File Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FPOABCPL2IF  E           K        DISK
      * RSQ : WF GAF Order Header Hist  RSQ Cust/Order/Batch (d)
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPOAACPL1IF  E           K        DISK
      * RTV : WF GAF Order Detail Hist  Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDLHCPL3IF  E           K        DISK
      * RSQ : Load Order Change Log     Ld ID,Typ,Dte/Time/Se
      *
     FPONKCPL2IF  E           K        DISK
      * RSQ : WF GAF Order Header       RSQ Co/Order
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPONLCPL1IF  E           K        DISK
      * RTV : WF GAF Order Detail       Retrieval index
      *
     FPDLHCPL0UF  E           K        DISK
      * UPD : Load Order Change Log     Update index
      *
     FPONKCPL0UF  E           K        DISK                      A
      * UPD : WF GAF Order Header       Update index
      *
     FPOABCPL0UF  E           K        DISK                      A
      * UPD : WF GAF Order Header Hist  Update index
      *
     FPONLCPL0UF  E           K        DISK                      A
      * UPD : WF GAF Order Detail       Update index
      *
     FPOAACPL0UF  E           K        DISK                      A
      * UPD : WF GAF Order Detail Hist  Update index
      *
     E                    YDOW        7  1               *Days of week
     I@NMREB0
      * WF GAF Batch Control File Retrieval index
      * Renamed input format fields
     I              NMAIC3                          WAAIC3
     I              NMKFNX                          WAKFNX
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WCBZNA
     I              FFADTX                          WCADTX
     I              FFACNA                          WCACNA
     I              FFADNA                          WCADNA
     I              FFAENA                          WCAENA
     I              FFAJNA                          WCAJNA
     I              FFBTTX                          WCBTTX
     I              FFEZNB                          WCEZNB
     I              FFBGCD                          WCBGCD
     I              FFEEDT                          WCEEDT
     I              FFDUTX                          WCDUTX
     I              FFNRVA                          WCNRVA
     I              FFNSVA                          WCNSVA
     I              FFNTVA                          WCNTVA
     I              FFNUVA                          WCNUVA
     I              FFP1ST                          WCP1ST
     I              FFDVTX                          WCDVTX
     I              FFDWTX                          WCDWTX
     I              FFLVCD                          WCLVCD
     I              FFS8NB                          WCS8NB
     I              FFS9NB                          WCS9NB
     I              FFNMVA                          WCNMVA
     I              FFNOVA                          WCNOVA
     I              FFNPVA                          WCNPVA
     I              FFNQVA                          WCNQVA
     I              FFMFCD                          WCMFCD
     I              FFQXNB                          WCQXNB
     I              FFQ1NB                          WCQ1NB
     I              FFMRNG                          WCMRNG
     I              FFMRNE                          WCMRNE
     I              FFRFNB                          WCRFNB
     I              FFMREG                          WCMREG
     I              FFBQPR                          WCBQPR
     I              FFBRPR                          WCBRPR
     I              FFBSPR                          WCBSPR
     I              FFBTPR                          WCBTPR
     I              FFBUPR                          WCBUPR
     I              FFBVPR                          WCBVPR
     I              FFDJWG                          WCDJWG
     I              FFDKWG                          WCDKWG
     I              FFDLWG                          WCDLWG
     I              FFDMWG                          WCDMWG
     I              FFDNWG                          WCDNWG
     I              FFDOWG                          WCDOWG
     I              FFB2PR                          WCB2PR
     I              FFB3PR                          WCB3PR
     I              FFB4PR                          WCB4PR
     I              FFB5PR                          WCB5PR
     I              FFB6PR                          WCB6PR
     I              FFB7PR                          WCB7PR
     I              FFAAC7                          WCAAC7
     I              FFCOFI                          WCCOFI
     I              FFK6TX                          WCK6TX
     I              FFOCNA                          WCOCNA
     I              FFODNA                          WCODNA
     I              FFW7CD                          WCW7CD
     I              FFK7TX                          WCK7TX
     I              FFTENO                          WCTENO
     I              FFK8TX                          WCK8TX
     I              FFAOFC                          WCAOFC
     I              FFAOLI                          WCAOLI
     I              FFKHDT                          WCKHDT
     I              FFUNUS                          WCUNUS
     I              FFUNU2                          WCUNU2
     I              FFUNU3                          WCUNU3
     I              FFUVST                          WCUVST
     I              FFUWST                          WCUWST
     I              FFUXST                          WCUXST
     I              FFVSST                          WCVSST
     I              FFAATM                          WCAATM
     I              FFAYNA                          WCAYNA
     I              FFA0NA                          WCA0NA
     I              FFAXDT                          WCAXDT
      *
     I@ABCPCO
      * WF GAF Order Header Hist  RSQ Cust/Order/Batch (d)
      * Renamed input format fields
     I              ABKCNX                          WDKCNX
     I              ABVYTX                          WDVYTX
     I              ABVZTX                          WDVZTX
     I              ABKHNX                          WDKHNX
     I              ABV0TX                          WDV0TX
     I              ABV1TX                          WDV1TX
     I              ABV2TX                          WDV2TX
     I              ABV3TX                          WDV3TX
     I              ABV4TX                          WDV4TX
     I              ABV5TX                          WDV5TX
     I              ABV6TX                          WDV6TX
     I              ABV7TX                          WDV7TX
     I              ABV8TX                          WDV8TX
     I              ABV9TX                          WDV9TX
     I              ABHYSX                          WDHYSX
     I              ABLWNX                          WDLWNX
     I              ABW7TX                          WDW7TX
     I              ABUVST                          WDUVST
     I              ABUWST                          WDUWST
     I              ABUXST                          WDUXST
     I              ABAATM                          WDAATM
     I              ABAYNA                          WDAYNA
     I              ABA0NA                          WDA0NA
     I              ABAXDT                          WDAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@AACPCF
      * WF GAF Order Detail Hist  Retrieval index
      * Renamed input format fields
     I              AAVZTX                          WFVZTX
     I              AAWATX                          WFWATX
     I              AAKHNX                          WFKHNX
     I              AAKDNX                          WFKDNX
     I              AAWFTX                          WFWFTX
     I              AAKKNX                          WFKKNX
     I              AAKLNX                          WFKLNX
     I              AAH8SX                          WFH8SX
     I              AAUVST                          WFUVST
     I              AAUWST                          WFUWST
     I              AAUXST                          WFUXST
     I              AAAATM                          WFAATM
     I              AAAYNA                          WFAYNA
     I              AAA0NA                          WFA0NA
     I              AAAXDT                          WFAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     I@LHCPO4
      * Load Order Change Log     Ld ID,Typ,Dte/Time/Se
      * Renamed input format fields
     I              LHK4DT                          WHK4DT
     I              LHA1TM                          WHA1TM
     I              LHDXNB                          WHDXNB
     I              LHRMNB                          WHRMNB
     I              LHRVNB                          WHRVNB
     I              LHRVST                          WHRVST
     I              LHUJST                          WHUJST
     I              LHMNTX                          WHMNTX
     I              LHMOTX                          WHMOTX
     I              LHAYNA                          WHAYNA
     I              LHA0NA                          WHA0NA
     I              LHBZNA                          WHBZNA
     I              LHXMCD                          WHXMCD
     I              LHAIC3                          WHAIC3
     I              LHC4NB                          WHC4NB
      *
     I@LHCPN6
      * Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WIK4DT
     I              LHA1TM                          WIA1TM
     I              LHDXNB                          WIDXNB
     I              LHRMNB                          WIRMNB
     I              LHRVNB                          WIRVNB
     I              LHRVST                          WIRVST
     I              LHUJST                          WIUJST
     I              LHMNTX                          WIMNTX
     I              LHMOTX                          WIMOTX
     I              LHAYNA                          WIAYNA
     I              LHA0NA                          WIA0NA
     I              LHBZNA                          WIBZNA
     I              LHXMCD                          WIXMCD
     I              LHAIC3                          WIAIC3
     I              LHC4NB                          WIC4NB
      *
     I@NKCPCP
      * WF GAF Order Header       RSQ Co/Order
      * Renamed input format fields
     I              NKKCNX                          WJKCNX
     I              NKVYTX                          WJVYTX
     I              NKVZTX                          WJVZTX
     I              NKV0TX                          WJV0TX
     I              NKV1TX                          WJV1TX
     I              NKV2TX                          WJV2TX
     I              NKV3TX                          WJV3TX
     I              NKV4TX                          WJV4TX
     I              NKV5TX                          WJV5TX
     I              NKV6TX                          WJV6TX
     I              NKV7TX                          WJV7TX
     I              NKV8TX                          WJV8TX
     I              NKV9TX                          WJV9TX
     I              NKHYSX                          WJHYSX
     I              NKLWNX                          WJLWNX
     I              NKW7TX                          WJW7TX
      *
     I@NKCPB5
      * WF GAF Order Header       Update index
      * Renamed input format fields
     I              NKKCNX                          WKKCNX
     I              NKVYTX                          WKVYTX
     I              NKVZTX                          WKVZTX
     I              NKV0TX                          WKV0TX
     I              NKV1TX                          WKV1TX
     I              NKV2TX                          WKV2TX
     I              NKV3TX                          WKV3TX
     I              NKV4TX                          WKV4TX
     I              NKV5TX                          WKV5TX
     I              NKV6TX                          WKV6TX
     I              NKV7TX                          WKV7TX
     I              NKV8TX                          WKV8TX
     I              NKV9TX                          WKV9TX
     I              NKHYSX                          WKHYSX
     I              NKLWNX                          WKLWNX
     I              NKW7TX                          WKW7TX
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WLRMNB
     I              FLRUNB                          WLRUNB
     I              FLRVNB                          WLRVNB
     I              FLDQTX                          WLDQTX
     I              FLRWNB                          WLRWNB
     I              FLRXNB                          WLRXNB
     I              FLSQNB                          WLSQNB
     I              FLT0NB                          WLT0NB
     I              FLT1NB                          WLT1NB
     I              FLR1NB                          WLR1NB
     I              FLAIC3                          WLAIC3
     I              FLC4NB                          WLC4NB
     I              FLVCST                          WLVCST
     I              FLKEDT                          WLKEDT
     I              FLSXNB                          WLSXNB
     I              FLKFDT                          WLKFDT
     I              FLACTM                          WLACTM
     I              FLK5TX                          WLK5TX
     I              FLW5CD                          WLW5CD
     I              FLEJDT                          WLEJDT
     I              FLAGTM                          WLAGTM
     I              FLKJDT                          WLKJDT
     I              FLATTM                          WLATTM
     I              FLHDDT                          WLHDDT
     I              FLAUTM                          WLAUTM
     I              FLKKDT                          WLKKDT
     I              FLAVTM                          WLAVTM
     I              FLZ4NB                          WLZ4NB
     I              FLY7ST                          WLY7ST
     I              FLY2ST                          WLY2ST
     I              FLWHTX                          WLWHTX
     I              FLWITX                          WLWITX
     I              FLWJTX                          WLWJTX
     I              FLWKTX                          WLWKTX
     I              FLWLTX                          WLWLTX
     I              FLN7DT                          WLN7DT
     I              FLN8DT                          WLN8DT
     I              FLN9DT                          WLN9DT
     I              FLB3TM                          WLB3TM
     I              FLB4TM                          WLB4TM
     I              FLB5TM                          WLB5TM
     I              FLIASX                          WLIASX
     I              FLIBSX                          WLIBSX
     I              FLICSX                          WLICSX
     I              FLWVTX                          WLWVTX
     I              FLWWTX                          WLWWTX
     I              FLWXTX                          WLWXTX
     I              FLUVST                          WLUVST
     I              FLUWST                          WLUWST
     I              FLUXST                          WLUXST
     I              FLAATM                          WLAATM
     I              FLAYNA                          WLAYNA
     I              FLA0NA                          WLA0NA
     I              FLAXDT                          WLAXDT
      *
     I@ABCPCK
      * WF GAF Order Header Hist  Update index
      * Renamed input format fields
     I              ABKCNX                          WMKCNX
     I              ABVYTX                          WMVYTX
     I              ABVZTX                          WMVZTX
     I              ABKHNX                          WMKHNX
     I              ABV0TX                          WMV0TX
     I              ABV1TX                          WMV1TX
     I              ABV2TX                          WMV2TX
     I              ABV3TX                          WMV3TX
     I              ABV4TX                          WMV4TX
     I              ABV5TX                          WMV5TX
     I              ABV6TX                          WMV6TX
     I              ABV7TX                          WMV7TX
     I              ABV8TX                          WMV8TX
     I              ABV9TX                          WMV9TX
     I              ABHYSX                          WMHYSX
     I              ABLWNX                          WMLWNX
     I              ABW7TX                          WMW7TX
     I              ABUVST                          WMUVST
     I              ABUWST                          WMUWST
     I              ABUXST                          WMUXST
     I              ABAATM                          WMAATM
     I              ABAYNA                          WMAYNA
     I              ABA0NA                          WMA0NA
     I              ABAXDT                          WMAXDT
      *
     I@NLCPB3
      * WF GAF Order Detail       Retrieval index
      * Renamed input format fields
     I              NLVZTX                          WOVZTX
     I              NLWATX                          WOWATX
     I              NLKDNX                          WOKDNX
     I              NLWFTX                          WOWFTX
     I              NLKKNX                          WOKKNX
     I              NLKLNX                          WOKLNX
     I              NLH8SX                          WOH8SX
      *
     I@NLCPB2
      * WF GAF Order Detail       Update index
      * Renamed input format fields
     I              NLVZTX                          WRVZTX
     I              NLWATX                          WRWATX
     I              NLKDNX                          WRKDNX
     I              NLWFTX                          WRWFTX
     I              NLKKNX                          WRKKNX
     I              NLKLNX                          WRKLNX
     I              NLH8SX                          WRH8SX
      *
     I@AACPCE
      * WF GAF Order Detail Hist  Update index
      * Renamed input format fields
     I              AAVZTX                          WSVZTX
     I              AAWATX                          WSWATX
     I              AAKHNX                          WSKHNX
     I              AAKDNX                          WSKDNX
     I              AAWFTX                          WSWFTX
     I              AAKKNX                          WSKKNX
     I              AAKLNX                          WSKLNX
     I              AAH8SX                          WSH8SX
     I              AAUVST                          WSUVST
     I              AAUWST                          WSUWST
     I              AAUXST                          WSUXST
     I              AAAATM                          WSAATM
     I              AAAYNA                          WSAYNA
     I              AAA0NA                          WSA0NA
     I              AAAXDT                          WSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDLH1    E DSPDLHCPL0
      * UPD : Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WIK4DT
     I              LHA1TM                          WIA1TM
     I              LHDXNB                          WIDXNB
     I              LHRMNB                          WIRMNB
     I              LHRVNB                          WIRVNB
     I              LHRVST                          WIRVST
     I              LHUJST                          WIUJST
     I              LHMNTX                          WIMNTX
     I              LHMOTX                          WIMOTX
     I              LHAYNA                          WIAYNA
     I              LHA0NA                          WIA0NA
     I              LHBZNA                          WIBZNA
     I              LHXMCD                          WIXMCD
     I              LHAIC3                          WIAIC3
     I              LHC4NB                          WIC4NB
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPONK1    E DSPONKCPL0
      * UPD : WF GAF Order Header       Update index
      * Renamed input format fields
     I              NKKCNX                          WKKCNX
     I              NKVYTX                          WKVYTX
     I              NKVZTX                          WKVZTX
     I              NKV0TX                          WKV0TX
     I              NKV1TX                          WKV1TX
     I              NKV2TX                          WKV2TX
     I              NKV3TX                          WKV3TX
     I              NKV4TX                          WKV4TX
     I              NKV5TX                          WKV5TX
     I              NKV6TX                          WKV6TX
     I              NKV7TX                          WKV7TX
     I              NKV8TX                          WKV8TX
     I              NKV9TX                          WKV9TX
     I              NKHYSX                          WKHYSX
     I              NKLWNX                          WKLWNX
     I              NKW7TX                          WKW7TX
      *
     IQPOAB1    E DSPOABCPL0
      * UPD : WF GAF Order Header Hist  Update index
      * Renamed input format fields
     I              ABKCNX                          WMKCNX
     I              ABVYTX                          WMVYTX
     I              ABVZTX                          WMVZTX
     I              ABKHNX                          WMKHNX
     I              ABV0TX                          WMV0TX
     I              ABV1TX                          WMV1TX
     I              ABV2TX                          WMV2TX
     I              ABV3TX                          WMV3TX
     I              ABV4TX                          WMV4TX
     I              ABV5TX                          WMV5TX
     I              ABV6TX                          WMV6TX
     I              ABV7TX                          WMV7TX
     I              ABV8TX                          WMV8TX
     I              ABV9TX                          WMV9TX
     I              ABHYSX                          WMHYSX
     I              ABLWNX                          WMLWNX
     I              ABW7TX                          WMW7TX
     I              ABUVST                          WMUVST
     I              ABUWST                          WMUWST
     I              ABUXST                          WMUXST
     I              ABAATM                          WMAATM
     I              ABAYNA                          WMAYNA
     I              ABA0NA                          WMA0NA
     I              ABAXDT                          WMAXDT
      *
     IYARDCS      DS                            580
     IQPONL1    E DSPONLCPL0
      * UPD : WF GAF Order Detail       Update index
      * Renamed input format fields
     I              NLVZTX                          WRVZTX
     I              NLWATX                          WRWATX
     I              NLKDNX                          WRKDNX
     I              NLWFTX                          WRWFTX
     I              NLKKNX                          WRKKNX
     I              NLKLNX                          WRKLNX
     I              NLH8SX                          WRH8SX
      *
     IQPOAA1    E DSPOAACPL0
      * UPD : WF GAF Order Detail Hist  Update index
      * Renamed input format fields
     I              AAVZTX                          WSVZTX
     I              AAWATX                          WSWATX
     I              AAKHNX                          WSKHNX
     I              AAKDNX                          WSKDNX
     I              AAWFTX                          WSWFTX
     I              AAKKNX                          WSKKNX
     I              AAKLNX                          WSKLNX
     I              AAH8SX                          WSH8SX
     I              AAUVST                          WSUVST
     I              AAUWST                          WSUWST
     I              AAUXST                          WSUXST
     I              AAAATM                          WSAATM
     I              AAAYNA                          WSAYNA
     I              AAA0NA                          WSA0NA
     I              AAAXDT                          WSAXDT
      *
     IYBRDCS      DS                            105
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Load ID
     I                                    P   7  100P1RMNB
     IP2PARM      DS
      * FLD: WF GAF Order Header
      * I :  GAF Customer Number
     I                                        1   90P2KCNX
      * N :  GAF Order Type
     I                                       10  10 P2HYSX
     IP3PARM      DS
      * N :  GAF Order Batch No.
     I                                    P   1   40P3KHNX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1RMNB    PARM           WP0003  70       Load ID
     C           P2KCNX    PARM           WP0004  90       GAF Customer Nu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * zDlt GAF Order Hdr/Dtl XF
      * UPD Lock/Unlock HDR ID XF - GAF Order Header  * 
     C                     CALL 'POAVXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0001  1        Lock/Unlock
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POAVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'D'       P2HYSX           GAF Order Type
      * Rtv Batch Control No.  RT - GAF Batch Control File  * 
     C                     EXSR SARVGN
      * CRT GFP Order Header   RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * CASE: PAR.GAF Order Type is Add/Change/Delete
     C           P2HYSX    IFEQ 'A'                        *IF
     C           P2HYSX    OREQ 'C'
     C           P2HYSX    OREQ 'D'
      * CRT GFP Order Detail   RT - PD Order Detail  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
      * UPD Lock/Unlock HDR ID XF - GAF Order Header  * 
     C                     CALL 'POAVXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0002  1        Lock/Unlock
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POAVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Batch Control No.  RT - GAF Batch Control File  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@NMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2914' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3KHNX           GAF Next Order
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAKFNX    P3KHNX           GAF Next Order
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * CRT GFP Order Header   RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 10        GAF Load Id
     C                     MOVEL*BLANK    WN0002 15        GAF Order Numbe
     C                     MOVEL*BLANK    WN0003 10        GAF Customer PO
     C                     MOVEL*BLANK    WN0004 40        GAF Shipto Name
     C                     MOVEL*BLANK    WN0005 40        GAF Shipto Addr
     C                     MOVEL*BLANK    WN0006 40        GAF Shipto Addr
     C                     MOVEL*BLANK    WN0007 20        GAF Shipto City
     C                     MOVEL*BLANK    WN0008  2        GAF Shipto Stat
     C                     MOVEL*BLANK    WN0009 10        GAF Shipto Zip
     C                     MOVEL*BLANK    WN0010 40        GAF Mail Name C
     C                     MOVEL*BLANK    WN0011 10        GAF Ship Date
     C                     MOVEL*BLANK    WN0012255        GAF Shipping Co
     C                     Z-ADD*ZERO     WN0013  50       GAF Stop/Drop
     C                     MOVEL*BLANK    WN0014 40        GAF Shipto Addr
     C                     MOVEL*BLANK    WN0015 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0016 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0017 30        AS Shipping Ins
     C                     Z-ADD*ZERO     WN0018  40       Year Code
     C                     Z-ADD*ZERO     WN0019  20       Month
     C                     Z-ADD*ZERO     WN0020  20       Day of Month US
     C                     MOVEL*BLANK    WN0021  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0022  2        Month (Char) US
     C                     MOVEL*BLANK    WN0023  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0024  60       GAF Order Batch
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * If order not cancelled add to GAF Files
      * CASE: DB1.Header Status is Cancelled
     C           WBGWST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Load GAF file fields
     C                     EXSR UASUBR                     Load GAF file f
      * Val/Rtv Last Order     RT - GAF Order Header History  * 
     C                     EXSR SDRVGN
      * CASE: PAR.GAF Order Type is Blanks
     C           P2HYSX    IFEQ *BLANK                     *IF
      * Set add/change flag
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.GAF Order Type is Delete
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           YL0013    IFEQ 'D'                        *IF
     C           W0RTN     OREQ 'Y2U0005'                  *OR
     C                     MOVEL'A'       P2HYSX           GAF Order Type
     C                     ELSE
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10 OR
      *  -  c11 OR c13
      *   |- c1    : PAR.GAF Load Id NE LCL.GAF Load Id
      *   |- c2    : PAR.GAF Customer PO No. NE LCL.GAF Customer PO No.
      *   |- c3    : PAR.GAF Shipto Name NE LCL.GAF Shipto Name
      *   |- c4    : PAR.GAF Shipto Address 1 NE LCL.GAF Shipto Address 1
      *   |- c5    : PAR.GAF Shipto Address 2 NE LCL.GAF Shipto Address 2
      *   |- c6    : PAR.GAF Shipto City NE LCL.GAF Shipto City
      *   |- c7    : PAR.GAF Shipto State NE LCL.GAF Shipto State
      *   |- c8    : PAR.GAF Shipto Zip NE LCL.GAF Shipto Zip
      *   |- c9    : PAR.GAF Mail Name Carrier NE LCL.GAF Mail Name Carri
      *   |- c10   : PAR.GAF Ship Date NE LCL.GAF Ship Date
      *   |- c11   : PAR.GAF Shipping Comments NE LCL.GAF Shipping Commen
      *   |- c13   : PAR.GAF Shipto Address 3 NE LCL.GAF Shipto Address 3
      *   '-
     C           WN0001    IFNE YL0001                     *IF
     C           WN0003    ORNE YL0002                     *OR
     C           WN0004    ORNE YL0003                     *OR
     C           WN0005    ORNE YL0004                     *OR
     C           WN0006    ORNE YL0005                     *OR
     C           WN0007    ORNE YL0006                     *OR
     C           WN0008    ORNE YL0007                     *OR
     C           WN0009    ORNE YL0008                     *OR
     C           WN0010    ORNE YL0010                     *OR
     C           WN0011    ORNE YL0011                     *OR
     C           WN0012    ORNE YL0012                     *OR
     C           WN0014    ORNE YL0009                     *OR
     C                     MOVEL'C'       P2HYSX           GAF Order Type
     C                     END                             *FI
     C                     END                             *FI
      * If order is not an add or a change then check order detail.
      * CASE: PAR.GAF Order Type is Blanks
     C           P2HYSX    IFEQ *BLANK                     *IF
      * Rtv GFP Or Dtl Add/Chg RT - PD Order Detail  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
      * If order has been added, changed or deleted then add to GAF files
      * CASE: PAR.GAF Order Type is Add/Change/Delete
     C           P2HYSX    IFEQ 'A'                        *IF
     C           P2HYSX    OREQ 'C'
     C           P2HYSX    OREQ 'D'
      * Delete the existing log
      * Del SNDACC Entry/Ord   RT - Load Order Change Log  * 
     C                     EXSR SHRVGN
      * Delete any Existing records prior to creating new
      * Dlt GAF Order Header   RT - GAF Order Header  * 
     C                     EXSR SJRVGN
      * *** Retrieve Stop Number for PK----
      * RTV Stop Number       RT - Load Detail          TRG  * 
     C                     EXSR SLRVGN
      * Crt GAF Order Header   CR - GAF Order Header  * 
     C                     EXSR SMCRRC
      * If order/batch # already exists in hist, change else add
      * CASE: PAR.GAF Order Batch No. EQ PAR.GAF Order Batch No. USR
     C           P3KHNX    IFEQ WN0024                     *IF
      * Chg GAF Order Hdr Hist CH - GAF Order Header History  * 
     C                     EXSR SNCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt GAF Order Hdr Hist CR - GAF Order Header History  * 
     C                     EXSR SOCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBZNA           Carrier Code
      * Setup key
     C                     MOVELWBBZNA    WCBZNA           Carrier Code
      * Establish starting position
     C           KRSSC     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    YL0010           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Val/Rtv Last Order     RT - GAF Order Header History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDKCNX    WQSD01           GAF Customer Nu
     C           *LIKE     DEFN WDVZTX    WQSD02           GAF Order Numbe
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           GAF Customer Nu
     C                     KFLD           WQSD02           GAF Order Numbe
     C                     KFLD           WDKHNX           GAF Order Batch
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           GAF Customer Nu
     C                     KFLD           WQSD02           GAF Order Numbe
      * Setup key
     C                     Z-ADDP2KCNX    WQSD01           GAF Customer Nu
     C                     MOVELWN0002    WQSD02           GAF Order Numbe
     C                     Z-ADD999999    WDKHNX           GAF Order Batch
      * Establish starting position
     C           KPSSD     SETLL@ABCPCO                    *
     C           KRSSD     READE@ABCPCO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2923' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           GAF Load Id
     C                     MOVEL*BLANK    WN0003           GAF Customer PO
     C                     MOVEL*BLANK    WN0004           GAF Shipto Name
     C                     MOVEL*BLANK    WN0005           GAF Shipto Addr
     C                     MOVEL*BLANK    WN0006           GAF Shipto Addr
     C                     MOVEL*BLANK    WN0007           GAF Shipto City
     C                     MOVEL*BLANK    WN0008           GAF Shipto Stat
     C                     MOVEL*BLANK    WN0009           GAF Shipto Zip
     C                     MOVEL*BLANK    WN0010           GAF Mail Name C
     C                     MOVEL*BLANK    WN0011           GAF Ship Date
     C                     MOVEL*BLANK    WN0012           GAF Shipping Co
     C                     MOVEL*BLANK    YL0013           GAF Order Type
     C                     Z-ADD*ZERO     WN0013           GAF Stop/Drop
     C                     MOVEL*BLANK    WN0014           GAF Shipto Addr
     C                     Z-ADD*ZERO     WN0024           GAF Order Batch
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.GAF Customer Number EQ DB1.GAF Customer Number
      *   |- c2    : PAR.GAF Order Number EQ DB1.GAF Order Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2KCNX    IFEQ WDKCNX                     *IF
     C           WN0002    IFEQ WDVZTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR = DB1 By name
     C                     MOVELWDVYTX    WN0001           GAF Load Id
     C                     MOVELWDV0TX    WN0003           GAF Customer PO
     C                     MOVELWDV1TX    WN0004           GAF Shipto Name
     C                     MOVELWDV2TX    WN0005           GAF Shipto Addr
     C                     MOVELWDV3TX    WN0006           GAF Shipto Addr
     C                     MOVELWDV4TX    WN0007           GAF Shipto City
     C                     MOVELWDV5TX    WN0008           GAF Shipto Stat
     C                     MOVELWDV6TX    WN0009           GAF Shipto Zip
     C                     MOVELWDV7TX    WN0010           GAF Mail Name C
     C                     MOVELWDV8TX    WN0011           GAF Ship Date
     C                     MOVELWDV9TX    WN0012           GAF Shipping Co
     C                     MOVELWDHYSX    YL0013           GAF Order Type
     C                     Z-ADDWDLWNX    WN0013           GAF Stop/Drop
     C                     MOVELWDW7TX    WN0014           GAF Shipto Addr
     C                     Z-ADDWDKHNX    WN0024           GAF Order Batch
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@ABCPCO                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv GFP Or Dtl Add/Chg RT - PD Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0025 15        GAF Order Numbe
     C                     MOVEL*BLANK    WN0026 15        GAF Product Cod
     C                     Z-ADD*ZERO     WN0027  90       GAF Quantity Ne
     C                     MOVEL*BLANK    WN0028 25        GAF Product Des
     C                     Z-ADD*ZERO     WN0029  62       GAF Box Weight
     C                     Z-ADD*ZERO     WN0030  84       GAF Tare Weight
     C                     MOVEL*BLANK    WN0031  1        GAF Catchweight
     C                     MOVEL*BLANK    WN0032  1        Catch Weight St
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSE01           Company Number
     C                     Z-ADDWBC4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WEGMST    IFEQ 'X'                        *IF
      * Rtv Order Dtl Hist     RT - GAF Order Detail History  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0025    WL0001    P      GAF Order Numbe
     C                     MOVELWN0026    WL0002    P      GAF Product Cod
     C                     Z-ADDWN0024    WL0003           GAF Order Batch
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WN0027           GAF Quantity Ne
     C                     MOVELWL0005    WN0028    P      GAF Product Des
     C                     Z-ADDWL0006    WN0029           GAF Box Weight
     C                     Z-ADDWL0007    WN0030           GAF Tare Weight
     C                     MOVELWL0008    WN0031    P      GAF Catchweight
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'C'       P2HYSX           GAF Order Type
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Load GAF file fields
     C                     EXSR UBSUBR                     Load GAF file f
      * Rtv Order Dtl Hist     RT - GAF Order Detail History  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0025    WL0001    P      GAF Order Numbe
     C                     MOVELWN0026    WL0002    P      GAF Product Cod
     C                     Z-ADDWN0024    WL0003           GAF Order Batch
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WN0027           GAF Quantity Ne
     C                     MOVELWL0005    WN0028    P      GAF Product Des
     C                     Z-ADDWL0006    WN0029           GAF Box Weight
     C                     Z-ADDWL0007    WN0030           GAF Tare Weight
     C                     MOVELWL0008    WN0031    P      GAF Catchweight
      * If detail line was added or changed then order will be flagged as
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PGM.*Return code is *Record does not exist
      *   |- c2    : PAR.GAF Quantity Needed NE DB1.Quantity Scheduled
      *   |- c3    : PAR.GAF Product Description NE LCL.GAF Product Descr
      *   |- c4    : PAR.GAF Box Weight NE LCL.GAF Box Weight
      *   |- c5    : PAR.GAF Catchweight NE LCL.GAF Catchweight
      *   |- c6    : PAR.GAF Tare Weight NE LCL.GAF Tare Weight
      *   '-
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C           WN0027    ORNE WECCQT                     *OR
     C           WN0028    ORNE YL0014                     *OR
     C           WN0029    ORNE YL0015                     *OR
     C           WN0031    ORNE YL0016                     *OR
     C           WN0030    ORNE YL0017                     *OR
     C                     MOVEL'C'       P2HYSX           GAF Order Type
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Order Dtl Hist     RT - GAF Order Detail History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFVZTX           GAF Order Numbe
     C                     KFLD           WFWATX           GAF Product Cod
     C                     KFLD           WFKHNX           GAF Order Batch
      * Setup key
     C                     MOVELWL0001    WFVZTX           GAF Order Numbe
     C                     MOVELWL0002    WFWATX           GAF Product Cod
     C                     Z-ADDWL0003    WFKHNX           GAF Order Batch
      * Establish starting position
     C           KRSSF     CHAIN@AACPCF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2921' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           GAF Quantity Ne
     C                     MOVEL*BLANK    WL0005           GAF Product Des
     C                     Z-ADD*ZERO     WL0006           GAF Box Weight
     C                     Z-ADD*ZERO     WL0007           GAF Tare Weight
     C                     MOVEL*BLANK    WL0008           GAF Catchweight
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFKDNX    WL0004           GAF Quantity Ne
     C                     MOVELWFWFTX    WL0005           GAF Product Des
     C                     Z-ADDWFKKNX    WL0006           GAF Box Weight
     C                     Z-ADDWFKLNX    WL0007           GAF Tare Weight
     C                     MOVELWFH8SX    WL0008           GAF Catchweight
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Desc,U/Ms,CWT,PrcM RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0009    WGAIC3           Company Number
     C                     Z-ADDWL0010    WGHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0011           Description Lin
     C                     MOVEL*BLANK    WL0012           Description Lin
     C                     MOVEL*BLANK    WL0013           U/M - Primary
     C                     Z-ADD*ZERO     WL0014           Conversion Fact
     C                     MOVEL*BLANK    WL0015           Operation Facto
     C                     MOVEL*BLANK    WL0016           U/M - Second
     C                     Z-ADD*ZERO     WL0017           Conversion Fact
     C                     MOVEL*BLANK    WL0018           Operation Facto
     C                     MOVEL*BLANK    WL0019           U/M - Third
     C                     MOVEL*BLANK    WL0020           U/M - Pricing
     C                     Z-ADD*ZERO     WL0021           Unit Weight
     C                     MOVEL*BLANK    WL0022           Production Date
     C                     MOVEL*BLANK    WL0023           Catch Weight St
     C                     MOVEL*BLANK    WL0024           Default Commod
     C                     MOVEL*BLANK    WL0025           Price Method De
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAVNA    WL0011           Description Lin
     C                     MOVELWGAWNA    WL0012           Description Lin
     C                     MOVELWGADCD    WL0013           U/M - Primary
     C                     Z-ADDWGAWPC    WL0014           Conversion Fact
     C                     MOVELWGLXST    WL0015           Operation Facto
     C                     MOVELWGAECD    WL0016           U/M - Second
     C                     Z-ADDWGAXPC    WL0017           Conversion Fact
     C                     MOVELWGLYST    WL0018           Operation Facto
     C                     MOVELWGAFCD    WL0019           U/M - Third
     C                     MOVELWGAICD    WL0020           U/M - Pricing
     C                     Z-ADDWGAIWG    WL0021           Unit Weight
     C                     MOVELWGFZST    WL0022           Production Date
     C                     MOVELWGAVST    WL0023           Catch Weight St
     C                     MOVELWGLNCD    WL0024           Default Commod
     C                     MOVELWGQ8CD    WL0025           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Del SNDACC Entry/Ord   RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSH02           Load ID
     C           *LIKE     DEFN WHRVST    WQSH03           Load Change Typ
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH02           Load ID
     C                     KFLD           WQSH03           Load Change Typ
      * Setup key
     C                     Z-ADDWBRMNB    WQSH02           Load ID
     C                     MOVEL'SNDGAF'  WQSH03           Load Change Typ
      * Establish starting position
     C           KRSSH     SETLL@LHCPO4                    *
     C           KRSSH     READE@LHCPO4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order Number EQ PAR.Order Number
     C           WHC4NB    IFEQ WBC4NB                     *IF
      * DEL Load/Order Chg Log DR - Load Order Change Log  * 
     C                     EXSR SIDLRC
     C                     END                             *FI
     C           KRSSH     READE@LHCPO4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * DEL Load/Order Chg Log DR - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LHCPN6
     C                     Z-ADDWHK4DT    WIK4DT           Created Date
     C                     Z-ADDWHA1TM    WIA1TM           Created Time
     C                     Z-ADDWHDXNB    WIDXNB           Sequence Number
      *
     C           KLDLSI    KLIST
     C                     KFLD           WIK4DT           Created Date
     C                     KFLD           WIA1TM           Created Time
     C                     KFLD           WIDXNB           Sequence Number
     C           KLDLSI    CHAIN@LHCPN6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLHCPL0'MDACP
     C                     MOVEL'@LHCPN6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LHCPN6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Dlt GAF Order Header   RT - GAF Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJKCNX    WQSJ01           GAF Customer Nu
     C           *LIKE     DEFN WJVZTX    WQSJ02           GAF Order Numbe
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           GAF Customer Nu
     C                     KFLD           WQSJ02           GAF Order Numbe
      * Setup key
     C                     Z-ADDP2KCNX    WQSJ01           GAF Customer Nu
     C                     MOVELWN0002    WQSJ02           GAF Order Numbe
      * Establish starting position
     C           KRSSJ     SETLL@NKCPCP                    *
     C           KRSSJ     READE@NKCPCP                  90*
      * Data record not found
     C   90                MOVEL'USR2909' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt GAF Order Header   DL - GAF Order Header  * 
     C                     EXSR SKDLRC
     C           KRSSJ     READE@NKCPCP                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * Dlt GAF Order Header   DL - GAF Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @NKCPB5
     C                     Z-ADDWJKCNX    WKKCNX           GAF Customer Nu
     C                     MOVELWJVYTX    WKVYTX           GAF Load Id
     C                     MOVELWJVZTX    WKVZTX           GAF Order Numbe
      *
     C           KLDLSK    KLIST
     C                     KFLD           WKKCNX           GAF Customer Nu
     C                     KFLD           WKVYTX           GAF Load Id
     C                     KFLD           WKVZTX           GAF Order Numbe
     C           KLDLSK    CHAIN@NKCPB5              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PONKCPL0'MDACP
     C                     MOVEL'@NKCPB5' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@NKCPB5                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Stop Number       RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0013           Stop/Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQSL01           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSL01           Load ID
      * Establish starting position
     C           KRSSL     SETLL@FLCPBW                    *
     C           KRSSL     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0013           Stop/Drop
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order number is found, retrieve stop number
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           WBC4NB    IFEQ WLC4NB                     *IF
     C                     Z-ADDWLRVNB    WN0013           Stop/Drop
      * PAR = DB1 By name
     C                     Z-ADDWLRVNB    WN0013           Stop/Drop
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt GAF Order Header   CR - GAF Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NKCPB5
     C                     Z-ADDP2KCNX    WKKCNX           GAF Customer Nu
     C                     MOVELYL0001    WKVYTX           GAF Load Id
     C                     MOVELWN0002    WKVZTX           GAF Order Numbe
     C                     MOVELYL0002    WKV0TX           GAF Customer PO
     C                     MOVELYL0003    WKV1TX           GAF Shipto Name
     C                     MOVELYL0004    WKV2TX           GAF Shipto Addr
     C                     MOVELYL0005    WKV3TX           GAF Shipto Addr
     C                     MOVELYL0006    WKV4TX           GAF Shipto City
     C                     MOVELYL0007    WKV5TX           GAF Shipto Stat
     C                     MOVELYL0008    WKV6TX           GAF Shipto Zip
     C                     MOVELYL0010    WKV7TX           GAF Mail Name C
     C                     MOVELYL0011    WKV8TX           GAF Ship Date
     C                     MOVELYL0012    WKV9TX           GAF Shipping Co
     C                     MOVELP2HYSX    WKHYSX           GAF Order Type
     C                     Z-ADDWN0013    WKLWNX           GAF Stop/Drop
     C                     MOVELYL0009    WKW7TX           GAF Shipto Addr
      *
     C           KLCRSM    KLIST
     C                     KFLD           WKKCNX           GAF Customer Nu
     C                     KFLD           WKVYTX           GAF Load Id
     C                     KFLD           WKVZTX           GAF Order Numbe
      * Check for duplicate primary key
     C           KLCRSM    SETLL@NKCPB5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2910' W0RTN   7
      * Send message 'WF GAF Order Header    EX'
     C                     MOVEL'USR2910' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@NKCPB5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg GAF Order Hdr Hist CH - GAF Order Header History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0033  1        EDI Status 1
     C                     MOVEL*BLANK    WN0034  1        EDI Status 2
     C                     MOVEL*BLANK    WN0035  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0036  60       Job Time
     C                     MOVEL*BLANK    WN0037 10        User Id
     C                     MOVEL*BLANK    WN0038 10        Job Name
     C                     Z-ADD*ZERO     WN0039  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ABCPCK
     C                     Z-ADDP2KCNX    WMKCNX           GAF Customer Nu
     C                     MOVELYL0001    WMVYTX    P      GAF Load Id
     C                     MOVELWN0002    WMVZTX    P      GAF Order Numbe
     C                     Z-ADDP3KHNX    WMKHNX           GAF Order Batch
      *
     C           KLCHSN    KLIST
     C                     KFLD           WMKCNX           GAF Customer Nu
     C                     KFLD           WMVYTX           GAF Load Id
     C                     KFLD           WMVZTX           GAF Order Numbe
     C                     KFLD           WMKHNX           GAF Order Batch
     C           KLCHSN    CHAIN@ABCPCK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POABCPL0'MDACP
     C                     MOVEL'@ABCPCK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOAB1    YARDCS
      * Move non-key fields to @ABCPCK
     C                     MOVELYL0002    WMV0TX    P      GAF Customer PO
     C                     MOVELYL0003    WMV1TX    P      GAF Shipto Name
     C                     MOVELYL0004    WMV2TX    P      GAF Shipto Addr
     C                     MOVELYL0005    WMV3TX    P      GAF Shipto Addr
     C                     MOVELYL0006    WMV4TX    P      GAF Shipto City
     C                     MOVELYL0007    WMV5TX    P      GAF Shipto Stat
     C                     MOVELYL0008    WMV6TX    P      GAF Shipto Zip
     C                     MOVELYL0010    WMV7TX    P      GAF Mail Name C
     C                     MOVELYL0011    WMV8TX    P      GAF Ship Date
     C                     MOVELYL0012    WMV9TX    P      GAF Shipping Co
     C                     MOVELP2HYSX    WMHYSX    P      GAF Order Type
     C                     Z-ADDWN0013    WMLWNX           GAF Stop/Drop
     C                     MOVELYL0009    WMW7TX    P      GAF Shipto Addr
      *
      * Set PGM.*Record Data Changed flag
     C           QPOAB1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOAB1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ABCPCK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOABCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt GAF Order Hdr Hist CR - GAF Order Header History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0040  1        EDI Status 1
     C                     MOVEL*BLANK    WN0041  1        EDI Status 2
     C                     MOVEL*BLANK    WN0042  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0043  60       Job Time
     C                     MOVEL*BLANK    WN0044 10        User Id
     C                     MOVEL*BLANK    WN0045 10        Job Name
     C                     Z-ADD*ZERO     WN0046  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ABCPCK
     C                     Z-ADDP2KCNX    WMKCNX           GAF Customer Nu
     C                     MOVELYL0001    WMVYTX           GAF Load Id
     C                     MOVELWN0002    WMVZTX           GAF Order Numbe
     C                     Z-ADDP3KHNX    WMKHNX           GAF Order Batch
     C                     MOVELYL0002    WMV0TX           GAF Customer PO
     C                     MOVELYL0003    WMV1TX           GAF Shipto Name
     C                     MOVELYL0004    WMV2TX           GAF Shipto Addr
     C                     MOVELYL0005    WMV3TX           GAF Shipto Addr
     C                     MOVELYL0006    WMV4TX           GAF Shipto City
     C                     MOVELYL0007    WMV5TX           GAF Shipto Stat
     C                     MOVELYL0008    WMV6TX           GAF Shipto Zip
     C                     MOVELYL0010    WMV7TX           GAF Mail Name C
     C                     MOVELYL0011    WMV8TX           GAF Ship Date
     C                     MOVELYL0012    WMV9TX           GAF Shipping Co
     C                     MOVELP2HYSX    WMHYSX           GAF Order Type
     C                     Z-ADDWN0013    WMLWNX           GAF Stop/Drop
     C                     MOVELYL0009    WMW7TX           GAF Shipto Addr
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C           KLCRSO    KLIST
     C                     KFLD           WMKCNX           GAF Customer Nu
     C                     KFLD           WMVYTX           GAF Load Id
     C                     KFLD           WMVZTX           GAF Order Numbe
     C                     KFLD           WMKHNX           GAF Order Batch
      * Check for duplicate primary key
     C           KLCRSO    SETLL@ABCPCK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2924' W0RTN   7
      * Send message 'WF GAF Order Header Hi EX'
     C                     MOVEL'USR2924' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@ABCPCK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * CRT GFP Order Detail   RT - PD Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0047 15        GAF Order Numbe
     C                     MOVEL*BLANK    WN0048 15        GAF Product Cod
     C                     MOVEL*BLANK    WN0049 25        GAF Product Des
     C                     Z-ADD*ZERO     WN0050  62       GAF Box Weight
     C                     Z-ADD*ZERO     WN0051  84       GAF Tare Weight
     C                     MOVEL*BLANK    WN0052  1        GAF Catchweight
     C                     MOVEL*BLANK    WN0053  1        Catch Weight St
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Delete existing detail records prior to create
     C                     MOVEL*BLANK    WN0047           GAF Order Numbe
     C                     MOVELP1C4NB    WN0047           GAF Order Numbe
      * Dlt GAF Order Detail   RT - GAF Order Detail  * 
     C                     EXSR SQRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSP01           Company Number
     C                     Z-ADDP1C4NB    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WEGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Load GAF file fields
     C                     EXSR UCSUBR                     Load GAF file f
      * Crt GAF Order Detail   CR - GAF Order Detail  * 
     C                     EXSR SSCRRC
      * Create History File
      * Val Order Dtl Hist     RT - GAF Order Detail History  * 
     C                     EXSR STRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Crt GAF Order Dtl Hist CR - GAF Order Detail History  * 
     C                     EXSR SUCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg GAF Order Dtl Hist CH - GAF Order Detail History  * 
     C                     EXSR SVCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Dlt GAF Order Detail   RT - GAF Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOVZTX    WQSQ01           GAF Order Numbe
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           GAF Order Numbe
      * Setup key
     C                     MOVELWN0047    WQSQ01           GAF Order Numbe
      * Establish starting position
     C           KRSSQ     SETLL@NLCPB3                    *
     C           KRSSQ     READE@NLCPB3                  90*
      * Data record not found
     C   90                MOVEL'USR2911' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt GAF Order Detail   DL - GAF Order Detail  * 
     C                     EXSR SRDLRC
     C           KRSSQ     READE@NLCPB3                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRDLRC    BEGSR
      *================================================================
      * Dlt GAF Order Detail   DL - GAF Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @NLCPB2
     C                     MOVELWOVZTX    WRVZTX           GAF Order Numbe
     C                     MOVELWOWATX    WRWATX           GAF Product Cod
      *
     C           KLDLSR    KLIST
     C                     KFLD           WRVZTX           GAF Order Numbe
     C                     KFLD           WRWATX           GAF Product Cod
     C           KLDLSR    CHAIN@NLCPB2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PONLCPL0'MDACP
     C                     MOVEL'@NLCPB2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@NLCPB2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt GAF Order Detail   CR - GAF Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NLCPB2
     C                     MOVELWN0047    WRVZTX           GAF Order Numbe
     C                     MOVELWN0048    WRWATX           GAF Product Cod
     C                     Z-ADDWECCQT    WRKDNX           GAF Quantity Ne
     C                     MOVELWN0049    WRWFTX           GAF Product Des
     C                     Z-ADDWN0050    WRKKNX           GAF Box Weight
     C                     Z-ADDWN0051    WRKLNX           GAF Tare Weight
     C                     MOVELWN0052    WRH8SX           GAF Catchweight
      *
     C           KLCRSS    KLIST
     C                     KFLD           WRVZTX           GAF Order Numbe
     C                     KFLD           WRWATX           GAF Product Cod
      * Check for duplicate primary key
     C           KLCRSS    SETLL@NLCPB2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2912' W0RTN   7
      * Send message 'WF GAF Order Detail    EX'
     C                     MOVEL'USR2912' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@NLCPB2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Val Order Dtl Hist     RT - GAF Order Detail History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WFVZTX           GAF Order Numbe
     C                     KFLD           WFWATX           GAF Product Cod
     C                     KFLD           WFKHNX           GAF Order Batch
      * Setup key
     C                     MOVELWN0047    WFVZTX           GAF Order Numbe
     C                     MOVELWN0048    WFWATX           GAF Product Cod
     C                     Z-ADDP3KHNX    WFKHNX           GAF Order Batch
      * Establish starting position
     C           KRSST     CHAIN@AACPCF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2921' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Crt GAF Order Dtl Hist CR - GAF Order Detail History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0054  1        EDI Status 1
     C                     MOVEL*BLANK    WN0055  1        EDI Status 2
     C                     MOVEL*BLANK    WN0056  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0057  60       Job Time
     C                     MOVEL*BLANK    WN0058 10        User Id
     C                     MOVEL*BLANK    WN0059 10        Job Name
     C                     Z-ADD*ZERO     WN0060  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AACPCE
     C                     MOVELWN0047    WSVZTX           GAF Order Numbe
     C                     MOVELWN0048    WSWATX           GAF Product Cod
     C                     Z-ADDP3KHNX    WSKHNX           GAF Order Batch
     C                     Z-ADDWECCQT    WSKDNX           GAF Quantity Ne
     C                     MOVELWN0049    WSWFTX           GAF Product Des
     C                     Z-ADDWN0050    WSKKNX           GAF Box Weight
     C                     Z-ADDWN0051    WSKLNX           GAF Tare Weight
     C                     MOVELWN0052    WSH8SX           GAF Catchweight
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
     C           KLCRSU    KLIST
     C                     KFLD           WSVZTX           GAF Order Numbe
     C                     KFLD           WSWATX           GAF Product Cod
     C                     KFLD           WSKHNX           GAF Order Batch
      * Check for duplicate primary key
     C           KLCRSU    SETLL@AACPCE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2922' W0RTN   7
      * Send message 'WF GAF Order Detail Hi EX'
     C                     MOVEL'USR2922' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@AACPCE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg GAF Order Dtl Hist CH - GAF Order Detail History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0061  1        EDI Status 1
     C                     MOVEL*BLANK    WN0062  1        EDI Status 2
     C                     MOVEL*BLANK    WN0063  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0064  60       Job Time
     C                     MOVEL*BLANK    WN0065 10        User Id
     C                     MOVEL*BLANK    WN0066 10        Job Name
     C                     Z-ADD*ZERO     WN0067  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AACPCE
     C                     MOVELWN0047    WSVZTX    P      GAF Order Numbe
     C                     MOVELWN0048    WSWATX    P      GAF Product Cod
     C                     Z-ADDP3KHNX    WSKHNX           GAF Order Batch
      *
     C           KLCHSV    KLIST
     C                     KFLD           WSVZTX           GAF Order Numbe
     C                     KFLD           WSWATX           GAF Product Cod
     C                     KFLD           WSKHNX           GAF Order Batch
     C           KLCHSV    CHAIN@AACPCE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POAACPL0'MDACP
     C                     MOVEL'@AACPCE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOAA1    YBRDCS
      * Move non-key fields to @AACPCE
     C                     Z-ADDWECCQT    WSKDNX           GAF Quantity Ne
     C                     MOVELWN0049    WSWFTX    P      GAF Product Des
     C                     Z-ADDWN0050    WSKKNX           GAF Box Weight
     C                     Z-ADDWN0051    WSKLNX           GAF Tare Weight
     C                     MOVELWN0052    WSH8SX    P      GAF Catchweight
      *
      * Set PGM.*Record Data Changed flag
     C           QPOAA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOAA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AACPCE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOAACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Load GAF file fields
      *================================================================
     C                     MOVEL*BLANK    YL0001           GAF Load Id
     C                     MOVELP1RMNB    YL0001           GAF Load Id
     C                     MOVEL*BLANK    WN0002           GAF Order Numbe
     C                     MOVELWBC4NB    WN0002           GAF Order Numbe
     C                     MOVELWBBCNA    YL0002           GAF Customer PO
     C                     MOVEL*BLANK    YL0003           GAF Shipto Name
     C                     MOVELWBBRTX    YL0003           GAF Shipto Name
     C                     MOVEL*BLANK    YL0004           GAF Shipto Addr
     C                     MOVELWBHMNA    YL0004           GAF Shipto Addr
     C                     MOVEL*BLANK    YL0005           GAF Shipto Addr
     C                     MOVELWBHONA    YL0005           GAF Shipto Addr
     C                     MOVELWBHNNA    YL0006           GAF Shipto City
     C                     MOVELWBDBCD    YL0007           GAF Shipto Stat
     C                     MOVELWBCKTX    YL0008           GAF Shipto Zip
     C                     MOVEL*BLANK    YL0009           GAF Shipto Addr
     C                     MOVELWBHPNA    YL0009           GAF Shipto Addr
      * RTV Carrier Name       RT - OM Carrier  * 
     C                     EXSR SCRVGN
      * Setup ship date
      * PAR.Year Code = DB1.Scheduled Ship Date *YEAR
     C           WBAODT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0018
      * PAR.Month                 USR = DB1.Scheduled Ship Date *MONTH
     C           WBAODT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0019
      * PAR.Day of Month USR = DB1.Scheduled Ship Date *DAY OF MONTH
     C           WBAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WN0020
     C                     MOVEL*BLANK    WN0021           Year Alpha (YYY
     C                     MOVELWN0018    WN0021           Year Alpha (YYY
     C                     MOVELWN0019    WN0022           Month (Char) US
     C                     MOVELWN0020    WN0023           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0022    CAT  WN0023:ZQ YL0011    P      GAF Ship Date
     C                     Z-ADD0         ZQ      50
     C           YL0011    CAT  WN0021:ZQ YL0011    P      GAF Ship Date
      * Retrieve shipping comments
     C                     Z-ADD1         ZQ      50
     C           WBB6NA    CAT  WBBYNA:ZQ YL0012    P      GAF Shipping Co
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Load GAF file fields
      *================================================================
     C                     MOVEL*BLANK    WN0025           GAF Order Numbe
     C                     MOVELWEC4NB    WN0025           GAF Order Numbe
     C                     MOVEL*BLANK    WN0026           GAF Product Cod
     C                     MOVELWEHGCD    WN0026           GAF Product Cod
      * RTV Desc,U/Ms,CWT,PrcM RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0009           Company Number
     C                     Z-ADDWEHGCD    WL0010           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    YL0014    P      Description Lin
     C                     MOVELWL0012    YN0002    P      Description Lin
     C                     MOVELWL0013    YN0003    P      U/M - Primary
     C                     Z-ADDWL0014    YN0004           Conversion Fact
     C                     MOVELWL0015    YN0005    P      Operation Facto
     C                     MOVELWL0016    YN0006    P      U/M - Second
     C                     Z-ADDWL0017    YN0007           Conversion Fact
     C                     MOVELWL0018    YN0008    P      Operation Facto
     C                     MOVELWL0019    YN0009    P      U/M - Third
     C                     MOVELWL0020    YN0010    P      U/M - Pricing
     C                     Z-ADDWL0021    YL0015           Unit Weight
     C                     MOVELWL0022    YN0011    P      Production Date
     C                     MOVELWL0023    WN0032    P      Catch Weight St
     C                     MOVELWL0024    YN0012    P      Default Commod
     C                     MOVELWL0025    YN0013    P      Price Method De
      * Set catch weight status
      * CASE: PAR.Catch Weight Status is yes
     C           WN0032    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       YL0016           GAF Catchweight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       YL0016           GAF Catchweight
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Load GAF file fields
      *================================================================
     C                     MOVEL*BLANK    WN0047           GAF Order Numbe
     C                     MOVELWEC4NB    WN0047           GAF Order Numbe
     C                     MOVEL*BLANK    WN0048           GAF Product Cod
     C                     MOVELWEHGCD    WN0048           GAF Product Cod
      * RTV Desc,U/Ms,CWT,PrcM RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0009           Company Number
     C                     Z-ADDWEHGCD    WL0010           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    WN0049    P      Description Lin
     C                     MOVELWL0012    YN0016    P      Description Lin
     C                     MOVELWL0013    YN0017    P      U/M - Primary
     C                     Z-ADDWL0014    YN0018           Conversion Fact
     C                     MOVELWL0015    YN0019    P      Operation Facto
     C                     MOVELWL0016    YN0020    P      U/M - Second
     C                     Z-ADDWL0017    YN0021           Conversion Fact
     C                     MOVELWL0018    YN0022    P      Operation Facto
     C                     MOVELWL0019    YN0023    P      U/M - Third
     C                     MOVELWL0020    YN0024    P      U/M - Pricing
     C                     Z-ADDWL0021    WN0050           Unit Weight
     C                     MOVELWL0022    YN0025    P      Production Date
     C                     MOVELWL0023    WN0053    P      Catch Weight St
     C                     MOVELWL0024    YN0026    P      Default Commod
     C                     MOVELWL0025    YN0027    P      Price Method De
      * CASE: PAR.Catch Weight Status is yes
     C           WN0053    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       WN0052           GAF Catchweight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       WN0052           GAF Catchweight
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2HYSX           GAF Order Type
     C                     Z-ADD*ZERO     P3KHNX           GAF Order Batch
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAKFNX           GAF Next Order
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Unused Date
     C                     Z-ADD*ZERO     WBNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WCEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WCNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WCNSVA           Long hook balan
     C                     Z-ADD*ZERO     WCNTVA           Short hook bala
     C                     Z-ADD*ZERO     WCNUVA           Tub Balance
     C                     Z-ADD*ZERO     WCS8NB           Home Phone
     C                     Z-ADD*ZERO     WCS9NB           Other Phone
     C                     Z-ADD*ZERO     WCNMVA           Flat Rate
     C                     Z-ADD*ZERO     WCNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WCNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WCNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WCQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WCRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WCBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WCB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WCAAC7           Contact Number
     C                     Z-ADD*ZERO     WCTENO           Carrier Unused
     C                     Z-ADD*ZERO     WCAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WCAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WCKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDKCNX           GAF Customer Nu
     C                     Z-ADD*ZERO     WDKHNX           GAF Order Batch
     C                     Z-ADD*ZERO     WDLWNX           GAF Stop/Drop
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WECFC7           Order Group Cod
     C                     Z-ADD*ZERO     WEMAVA           Billing Detail
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEL8VA           Billing Detail
     C                     Z-ADD*ZERO     WEL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WEEXDT           Market Pricing
     C                     Z-ADD*ZERO     WEBZPR           Price Overage O
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WEAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WED0WG           Weight Ordered
     C                     Z-ADD*ZERO     WECCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WECBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WEATWG           Weight Shipped
     C                     Z-ADD*ZERO     WEAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAKPR           Unit Price
     C                     Z-ADD*ZERO     WEALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WEAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WEAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WEA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WEB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WEA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WENTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WENUDT           Consumed Item C
     C                     Z-ADD*ZERO     WENVDT           Deadline Depart
     C                     Z-ADD*ZERO     WENWDT           OD Price Type R
     C                     Z-ADD*ZERO     WENXDT           OD Unused Date
     C                     Z-ADD*ZERO     WEBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WEBVTM           Price Code
     C                     Z-ADD*ZERO     WEBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WEBXTM           Substitution Li
     C                     Z-ADD*ZERO     WEBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WEH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WEH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WEH7NX           OD Item Target
     C                     Z-ADD*ZERO     WEH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WEH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WEDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WEDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WEDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WEDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WEDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WEGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WEGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WEGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WEPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WERINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WETIDT           Production Ovr
     C                     Z-ADD*ZERO     WETJDT           Production Ovr
     C                     Z-ADD*ZERO     WETKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WETLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WETMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFKHNX           GAF Order Batch
     C                     Z-ADD*ZERO     WFKDNX           GAF Quantity Ne
     C                     Z-ADD*ZERO     WFKKNX           GAF Box Weight
     C                     Z-ADD*ZERO     WFKLNX           GAF Tare Weight
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAIWG           Unit Weight
     C                     Z-ADD*ZERO     WGCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WGC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WGURTN           Number Cases On
     C                     Z-ADD*ZERO     WGAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGTFNB           Transportation
     C                     Z-ADD*ZERO     WGTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WGTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WGBLPR           Market Overage
     C                     Z-ADD*ZERO     WGBMPR           Standard Overag
     C                     Z-ADD*ZERO     WGCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WGCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WGSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WGPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WGICN1           Item Category N
     C                     Z-ADD*ZERO     WGICN2           Item Category N
     C                     Z-ADD*ZERO     WGV2NB           Item Category N
     C                     Z-ADD*ZERO     WGITCN           Item Category N
     C                     Z-ADD*ZERO     WGITC5           Item Category N
     C                     Z-ADD*ZERO     WGICN6           Item Category N
     C                     Z-ADD*ZERO     WGICN7           Item Category N
     C                     Z-ADD*ZERO     WGICN8           Item Category N
     C                     Z-ADD*ZERO     WGICN9           Item Category N
     C                     Z-ADD*ZERO     WGICN0           Item Category N
     C                     Z-ADD*ZERO     WGSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WGA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WGSJNB           Production Lead
     C                     Z-ADD*ZERO     WGSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WGSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WGSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WGCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WGCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WGILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WGCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WGCINB           PM Batch Size
     C                     Z-ADD*ZERO     WGCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WGCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WGCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WGCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WGCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WGCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WGCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WGCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WGCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WGC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WGB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WGB5NB           PM Line Number
     C                     Z-ADD*ZERO     WGBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WGBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WGF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WGF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WGF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WGBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WGBNNB           Production Qty
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHK4DT           Created Date
     C                     Z-ADD*ZERO     WHA1TM           Created Time
     C                     Z-ADD*ZERO     WHDXNB           Sequence Number
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJKCNX           GAF Customer Nu
     C                     Z-ADD*ZERO     WJLWNX           GAF Stop/Drop
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WLRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WLRWNB           Miles to next s
     C                     Z-ADD*ZERO     WLRXNB           Freight Charge
     C                     Z-ADD*ZERO     WLSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WLT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WLT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WLSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WLKFDT           Appointment Con
     C                     Z-ADD*ZERO     WLACTM           Appointment Con
     C                     Z-ADD*ZERO     WLEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WLAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WLKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WLATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WLHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WLAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WLKKDT           On Yard Date
     C                     Z-ADD*ZERO     WLAVTM           On Yard Time
     C                     Z-ADD*ZERO     WLZ4NB           MPC Number
     C                     Z-ADD*ZERO     WLN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WLN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WLN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WLB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WLB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WLB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Clear all neither parameters
      * Crt GAF Order Hdr Hist CR - GAF Order Header History  * 
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOKDNX           GAF Quantity Ne
     C                     Z-ADD*ZERO     WOKKNX           GAF Box Weight
     C                     Z-ADD*ZERO     WOKLNX           GAF Tare Weight
      * Clear all neither parameters
      * Crt GAF Order Dtl Hist CR - GAF Order Detail History  * 
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0001 15
     C                     MOVEL*BLANK    WL0002 15
     C                     Z-ADD*ZERO     WL0003  60
     C                     Z-ADD*ZERO     WL0004  90
     C                     MOVEL*BLANK    WL0005 25
     C                     Z-ADD*ZERO     WL0006  62
     C                     Z-ADD*ZERO     WL0007  84
     C                     MOVEL*BLANK    WL0008  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011 30
     C                     MOVEL*BLANK    WL0012 30
     C                     MOVEL*BLANK    WL0013  2
     C                     Z-ADD*ZERO     WL0014  94
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  2
     C                     Z-ADD*ZERO     WL0017  94
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  2
     C                     MOVEL*BLANK    WL0020  2
     C                     Z-ADD*ZERO     WL0021 112
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  3
     C                     MOVEL*BLANK    WL0025  3
      * Define local work field GAF Load Id
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field GAF Customer PO No.
     C                     MOVEL*BLANK    YL0002 10
      * Define local work field GAF Shipto Name
     C                     MOVEL*BLANK    YL0003 40
      * Define local work field GAF Shipto Address 1
     C                     MOVEL*BLANK    YL0004 40
      * Define local work field GAF Shipto Address 2
     C                     MOVEL*BLANK    YL0005 40
      * Define local work field GAF Shipto City
     C                     MOVEL*BLANK    YL0006 20
      * Define local work field GAF Shipto State
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field GAF Shipto Zip
     C                     MOVEL*BLANK    YL0008 10
      * Define local work field GAF Shipto Address 3
     C                     MOVEL*BLANK    YL0009 40
      * Define local work field GAF Mail Name Carrier
     C                     MOVEL*BLANK    YL0010 40
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field GAF Ship Date
     C                     MOVEL*BLANK    YL0011 10
      * Define local work field GAF Shipping Comments
     C                     MOVEL*BLANK    YL0012255
      * Define local work field GAF Order Type
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field GAF Product Description
     C                     MOVEL*BLANK    YL0014 25
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0003  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0004  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0007  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0009  2
      * Define null work field U/M - Pricing
     C                     MOVEL*BLANK    YN0010  2
      * Define local work field GAF Box Weight
     C                     Z-ADD*ZERO     YL0015  62
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0012  3
      * Define null work field Price Method Default
     C                     MOVEL*BLANK    YN0013  3
      * Define local work field GAF Catchweight
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field GAF Tare Weight
     C                     Z-ADD*ZERO     YL0017  84
      * Define null work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YN0014  70
      * Define null work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YN0015  60
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0016 30
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0017  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0018  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0020  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0021  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0023  2
      * Define null work field U/M - Pricing
     C                     MOVEL*BLANK    YN0024  2
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0026  3
      * Define null work field Price Method Default
     C                     MOVEL*BLANK    YN0027  3
      *================================================================
     CSR         ZZEXIT    ENDSR
