/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT PROGRAM WITH SELECTIONS FOR EXPORT LOADS RPT.  */
/*             COMPANY, DATES, LOAD, CARRIER                        */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT EXPORT LOADS REPORT                           */
/*  DATE      - 12/16/96                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL            */
/*          &FRMDATN    - FROM SHIP DATE                            */
/*          &THRDATN    - THROUGH SHIP DATE                         */
/*          &LOADN      - LOAD NUMBER                               */
/*          &CARRIER    - CARRIER CODE                              */
/*          &OUTQ       - OUTPUT QUEUE                              */
/*          &HOLD       - HOLD PRINT                                */
/*          &SAVE       - SAVE PRINT                                */
/*          &COPYN      - NUMBER OF COPIES                          */
/*          &NIGHTQ     - NIGHT OUTPUT QUEUE                        */
/*          &CUST       - SHIP TO CUST   (PASSED)                   */
/********************************************************************/
/*  RMC 1/02/2001  ADD SALESPERSON PARM, BUT ITS NOT USED IN PRTF   */
/*  RMC 6/27/2001  ADDED REASON PARM, BUT ITS NOT USED IN PRTF   */
/*  RMC 5/14/2004  REVERSED COMPANY/LOAD PARM ORDER,CO IS OPTIONAL  */
/*  SLM 1/06/2005  PASS IN THE SELECTION OF THE ORDER COMPANY       */
/*                 ORDER CO WILL BE SELECTED INSIDE THE REPORT      */
/*  LJB 12/07/2005 REMOVED &SALESP, &LOADT, &RPTSEL, &REASON,       */
/*                 &UOM WHICH WERE NOT BEING USED ANYWHERE.         */
/* 01/30/2008 PKD E00025 ADDED WAREHOUSE & COUNTRY, PASS TO REPORT  */
/* 08/22/2008 LJB E00210 ADD COLLECT Y/N TO SCREEN AND PASS         */
/* 11/14/2008 LJB E00269 ADD EMAIL ADDRESS                          */
/* 11/17/2008 LJB E00281 ADD MULTIPLE COUNTRY CODES                 */
/********************************************************************/
 PDUJPCLP:   PGM        PARM(&OUTQ &HOLD &SAVE &NIGHTQ &COMPNYN +
                          &FRMDATN &THRDATN &LOADN &COPYN &CUST +
                          &COLLECT &CARRIER &CNTRY1 &CNTRY2 &CNTRY3 +
                          &CNTRY4 &CNTRY5 &WHS &EMAILYN &EMAIL)
/* PARMS                                                                      */
        DCL    &COMPNYN    *DEC                  /* Load Company   (Passed)   */
        DCL    &FRMDATN    *DEC                  /* FROM SHIP DATE (Passed)   */
        DCL    &THRDATN    *DEC                  /* THRU SHIP DATE (PASSED)   */
        DCL    &LOADN      *DEC                  /* LOAD NUMBER    (PASSED)   */
        DCL    &CARRIER    *CHAR   (3)           /* CARRIER CODE              */
        DCL    &CNTRY1     *CHAR   (6)           /* COUNTRY                   */
        DCL    &CNTRY2     *CHAR   (6)           /* COUNTRY                   */
        DCL    &CNTRY3     *CHAR   (6)           /* COUNTRY                   */
        DCL    &CNTRY4     *CHAR   (6)           /* COUNTRY                   */
        DCL    &CNTRY5     *CHAR   (6)           /* COUNTRY                   */
        DCL    &WHS        *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &EMAIL      *CHAR   (50)
        DCL    &EMAILYN    *CHAR   (1)
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */
        DCL    &COPYN      *DEC                  /* No. of Copies             */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &CUST       *DEC                  /* Ship to Customer          */
        DCL    &RETURN     *CHAR   (7)           /* Return CODE */
        DCL    &COLLECT    *CHAR   (1)           /* COLLECT Y/N */

/* INTERNAL FIELDS                                                            */
        DCL    &COMMAND    *CHAR   (512)
        DCL    &COPY       *DEC    (2 0)         /* Number of copies          */
        DCL    &COMPANY    *DEC    (3 0)         /* Company Number            */
        DCL    &FRMDAT     *DEC    (7 0)         /* FROM SHIP DATE            */
        DCL    &THRDAT     *DEC    (7 0)         /* THRU SHIP DATE            */
        DCL    &LOAD       *DEC    (7 0)         /* LOAD NUMBER               */

/* OPENQRYF FIELDS                                                            */
        DCL    &COMPA      *CHAR    3            /* ACK COMPLETE              */
        DCL    &FRMDATA    *CHAR    7            /* FROM SHIP DATE (Passed)   */
        DCL    &THRDATA    *CHAR    7            /* THRU SHIP DATE (Passed)   */
        DCL     &A        *CHAR   20              /* QRY FROM DATE  */
        DCL     &B        *CHAR   25              /* QRY TO DATE    */
        DCL     &C        *CHAR   25              /* QRY COMPANY    */
        DCL     &D        *CHAR   70              /* QRY ALL        */
/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/
             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
             CHGVAR     VAR(&COMPA) VALUE(&COMPANY)
             CHGVAR     VAR(&FRMDAT) VALUE(&FRMDATN)
             CHGVAR     VAR(&FRMDATA) VALUE(&FRMDAT)
             CHGVAR     VAR(&THRDAT) VALUE(&THRDATN)
             CHGVAR     VAR(&THRDATA) VALUE(&THRDAT)
             CHGVAR     VAR(&LOAD) VALUE(&LOADN)
             CHGVAR     VAR(&COPY) VALUE(&COPYN)

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR INVOICING REPORTS         */
/*********************************************************************/
             CHGVAR     VAR(&A) VALUE('FJAODT *GE ' *CAT +
                         &FRMDATA)
             CHGVAR     VAR(&B) VALUE('*AND FJAODT *LE ' *CAT +
                         &THRDATA)
             IF         (&COMPA *NE '000') THEN(DO)
             CHGVAR     VAR(&C) VALUE('*AND FJAIC3 *EQ ' *CAT +
                         &COMPA)
             ENDDO
             CHGVAR     VAR(&D) VALUE(&A *BCAT &B *BCAT &C)

/*  RUN QUERY TO READ LOAD HEADER BY DATE RANGE  */
             OVRDBF     FILE(OMFJCPL4) SHARE(*YES)
             OPNQRYF    FILE(OMFJCPL4) +
                        QRYSLT(&D) +
                        KEYFLD(*FILE)

/********************************************************************/
/* OVERRIDE PRINTER FILE WITH USER SPECIFIED SELECTION VALUES       */
/********************************************************************/
             IF         COND(&EMAILYN *NE ' ') THEN(CHGVAR +
                          VAR(&OUTQ) VALUE('QPRINT2'))
             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PDUIPFR$) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

/*********************************************************************/
/*   CALL PRINT PROGRAM -
/*********************************************************************/
             CALL       PGM(PDUIPFR) PARM(&RETURN &LOAD &COMPANY +
                          &FRMDAT &CARRIER &THRDAT &CUST &CNTRY1 +
                          &CNTRY2 &CNTRY3 &CNTRY4 &CNTRY5 &WHS +
                          &COLLECT)

             IF         COND(&EMAILYN *NE ' ') THEN(ESNDMAIL +
                          RECIPIENT(&EMAIL) SUBJECT('Export Load +
                          Report') MSGTYPE(*DFT) ATTLIST((PDUIPFR$ +
                          *DFT *N PDUIPFR$)))

             CLOF       OPNID(OMFJCPL4)
             DLTOVR     FILE(OMFJCPL4)

 END:        ENDPGM
