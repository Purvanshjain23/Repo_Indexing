// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLA6PVR
// ?Date: 14.08.2025 Time: 02:53:36
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Number
EXECUTE FUNCTION(Val Appl/User Only    IF) TYPE(EXCINTFUN)                      AB1191075;
PARAMETER(PAR.Oms_Warehouse_Code);
PARAMETER(WRK.CC_Company_Number);
PARAMETER('HPE');
PARAMETER(PAR.Oms_SalesPerson_Code);
PARAMETER(PAR.Oms_Allow_Multi_Company);
PARAMETER(PAR.Oms_Default_Printer);
PARAMETER(PAR.Oms_Name);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(PAR.Oms_Access_Denied_Y_N);
{
 //?Execute internal function

 // Call program Val Application/User  XF.
 CALL PROGRAM(Val Application/User  XF) ('PDGXXFR');
 PARAMETER(PAR.Oms_Warehouse_Code);
 PARAMETER(PAR.CC_Company_Number);
 PARAMETER(PAR.Oms_Application_Code);
 PARAMETER(PAR.Oms_SalesPerson_Code);
 PARAMETER(PAR.Oms_Allow_Multi_Company);
 PARAMETER(PAR.Oms_Default_Printer);
 PARAMETER(PAR.Oms_Name);
 PARAMETER(PAR.Oms_System_Value_Alpha);
 PARAMETER(PAR.Oms_Access_Denied_Y_N);

 CASE;

 // IF PAR.Oms Access Denied (Y/N) is Yes
 IF PAR.Oms_Access_Denied_Y_N = 'Y';

 // Send error message - 'Access Denied for User'
 ERROR(PRK0298);

 ENDIF;

}


//?USER: Load screen

// DTL.CC Company Number = PAR.CC Company Number
DTL.CC_Company_Number = PAR.CC_Company_Number;

// DTL.Time MM USR = CON.12
DTL.Time_MM_USR = 12;

//?USER: Validate fields

CASE;

// IF DTL.DST Kill Day of Week LT DTL.DST Delivery Day of Week
IF DTL.DST_Kill_Day_of_Week < DTL.DST_Delivery_Day_of_Week;

// Send error message - 'Kill day of week must be Start day of week or later.'
ERROR(PRK1056);
MSGPARM(DTL.DST_Kill_Day_of_Week);

ENDIF;

//?Error: Day of Week/Time
CASE;

// IF DTL.DST Day of Week GT DTL.End Day of Week USR
IF DTL.DST_Delivery_Day_of_Week > DTL.End_Day_of_Week_USR;

// OR DTL.DST Day of Week EQ DTL.End Day of Week USR
OR ( DTL.DST_Delivery_Day_of_Week = DTL.End_Day_of_Week_USR;

// AND DTL.DST Delivery Time GT DTL.End Delivery Time USR
AND DTL.DST_Delivery_Time > DTL.End_Delivery_Time_USR );

// Send error message - 'Start Day of Week & Time must be earlier than End Day of Week & Time.'
ERROR(PRK1042);
MSGPARM(DTL.DST_Delivery_Day_of_Week);
MSGPARM(DTL.DST_Delivery_Time);

ENDIF;

//?USER: User defined action

//?Submit Job to generate the templates for the requested slots.
// Call program Gen DS Template Slots XF.
CALL PROGRAM(Gen DS Template Slots XF) ('PLA5XFR');
PARAMETER(DTL.CC_Company_Number);
PARAMETER(DTL.DST_Delivery_Day_of_Week);
PARAMETER(DTL.DST_Delivery_Time);
PARAMETER(DTL.DST_Kill_Day_of_Week);
PARAMETER(DTL.End_Day_of_Week_USR);
PARAMETER(DTL.End_Delivery_Time_USR);
PARAMETER(DTL.Time_MM_USR);

