/***************************************************************** */
/*                                                                 */
/*  SYSTEM:          HOG PRODUCTION SYSTEM                         */
/*  PROGRAM NUMBER:  HP269CL                                       */
/*  PROGRAM NAME:    SAFEDATA: EDIT REPORTED WEEKLY ACTIVITY       */
/*  PROGRAMMER:      LEANNE FEDOR                                  */
/*  CREATE DATE:     10/01/02                                      */
/*                                                                 */
/*  FUNCTION:        THIS CL IS CALLED FROM FTPSDIRTV WHICH IS     */
/*                   SUBMITTED FROM THE JOB SCHEDULER UNDER JOB    */
/*                   FTPSDIRTV AT ??? ON MONDAYS ONLY.             */
/*                                                                 */
/*  THE FUNCTION:                                                  */
/*  EDITS REPORTED WEEKLY ACTIVITY                                 */
/*                                                                 */
/*******************************************************************/
/* MODIFICATIONS:                                                  */
/*******************************************************************/
/* 04/13/10  LEANNE RAMSEY                                         */
/*           CHANGED THE 'COPIES' VALUE FROM 2 TO 1.               */
/*           THE USERS ARE NO LONGER PRINTING THESE; WE HAVE GONE  */
/*           TO ESNDMAIL IN DRIVER CL FTPSDIRTV.                   */
/*  02/28/23  ERIC LOUCHEZ    TICKET 120610                        */
/*            TRYING TO GET THE REPORT ATTACHED TO THE EMAILS      */
/*            THIS CL IS BEING SUBMITTED BY FTPSDIRTV              */
/*            MOVE ESNDMAIL TO THIS CL FROM FTPSDIRTV              */
/*  03/01/23  ERIC LOUCHEZ    TICKET 120610                        */
/*            CHANGE SUBJECT AND MESSAGE                           */
/*  03/17/23  ERIC LOUCHEZ    TICKET 120610                        */
/*            MOVE CPYF & CLRPFM OF HSP263 TO HP263CL              */
/*******************************************************************/

             PGM        PARM(&TSTPRDFL)                  /* 120610 */
/*           PGM                                            120610 */

             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(10)
             DCL        VAR(&COPYS) TYPE(*DEC) LEN(2)
             DCL        VAR(&TSTPRDFL) TYPE(*CHAR) LEN(1)  /* 120610 */
             DCL        VAR(&EMAIL  )  TYPE(*CHAR) LEN(38) /* 120610 */

             CHGVAR     VAR(&HOLD) VALUE(*YES)
             CHGVAR     VAR(&COPYS) VALUE(1)

/*------------------------------------------------------------------*/
/*  CALL PROGRAM TO EDIT REPORTED WEEKLY ACTIVITY                   */
/*------------------------------------------------------------------*/

             OVRPRTF    FILE(QPRINT) TOFILE(QPRINT) OUTQ(GUYPRT02) +
                          COPIES(&COPYS) HOLD(&HOLD) SHARE(*YES)

             CALL       PGM(HP269)
             DLTOVR     FILE(QPRINT)

    /* FORCE QPRINT CLOSED BEFORE EMAILING.                     */
                 RCLRSC                                            /* 120610 */

/*--------------------------------------------------------------*/ /* 120610 */
/*     SENDING EMAILS:                                          */ /* 120610 */
/*--------------------------------------------------------------*/ /* 120610 */
             CHGVAR     VAR(&EMAIL) VALUE('HPS SAFEDATA TEST')     /* 120610 */

  IF         COND(&TSTPRDFL *EQ 'P') THEN(DO)                      /* 120610 */
   CHGVAR VAR(&EMAIL) VALUE('hps Safedata Weekly NurFin Upl')      /* 120610 */
             ESNDMAIL   RECIPIENT(&EMAIL) SUBJECT('NurFin Reported +
                          Weekly Activity') MSG('Distribution List: +
                          NurFin Reported Weekly Activity') +
                          ATTLIST((QPRINT *PDF *N *ALL * *LAST *ONLY))
    MONMSG     MSGID(CPF0000)                                      /* 120610 */
    ENDDO                                                          /* 120610 */

  IF         COND(&TSTPRDFL *EQ 'T') THEN(DO)                      /* 120610 */
   CHGVAR     VAR(&EMAIL) VALUE('hps safedata test')               /* 120610 */
             ESNDMAIL   RECIPIENT(&EMAIL) SUBJECT('TEST: NurFin Reported +
                          Weekly Activity') MSG('TEST: NurFin Reported +
                          Weekly Activity') +
                          ATTLIST((QPRINT *PDF *N *ALL * *LAST *ONLY))
   MONMSG     MSGID(CPF0000)                                       /* 120610 */
   ENDDO                                                           /* 120610 */

  /* ------------ THESE 2 COMMANDS ARE EXECUTED IN HP263CL ----------------- */
  /*   CPYF FROMFILE(HSP263) TOFILE(HSP263SV) MBROPT(*REPLACE)        120610 */
  /*   CLRPFM     FILE(HSP263)                                        120610 */
             ENDPGM

