     H/TITLE Bal/Val Tattoo        XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:10:52
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB6CPL1IF  E           K        DISK
      * RTV : Eval/Loss Error           Retrieval index
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKA4CPL3IF  E           K        DISK
      * RSQ : Tattoo Header Comment     Co/BOL/Tto/KDt/Typ/Lin
      *
     FPKBSCPL3IF  E           K        DISK
      * RSQ : Loss Trans                By Bo/Ld/Tattoo No Delet
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBSCPLBIF  E           K        DISK
      * RSQ : Loss Trans                Co/LsTyp/Bo/Ld/Tto/KDte
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKDYCPL1IF  E           K        DISK
      * RTV : Tattoo Detail Ext         Retrieval index
      *
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKBVCPLHIF  E           K        DISK
      * RSQ : Eval Trans                Co/Bo/Ld/Tto/KDt/AdTy
      *
     FPKCGCPL4IF  E           K        DISK
      * RSQ : Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      *
     FPKB6CPL3IF  E           K        DISK
      * RSQ : Eval/Loss Error           Eval Errors only
      *
     FPKA4CPL2IF  E           K        DISK
      * RSQ : Tattoo Header Comment     THC Comment, Line (D)
      *
     FPKA1CPNDIF  E           K        DISK
      * RTV : Tattoo Header             Retrieval Index 2
      *
     FPKBVCPL2IF  E           K        DISK
      * RSQ : Eval Trans                Next Eval Trans
      *
     FPKBVCPLMIF  E           K        DISK
      * RSQ : Eval Trans                Co/Bl/Tto/KDt/Ln-d/Hw-dN
      *
     FPKBVCPLLIF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/Tto/KDt/Ln-A/Hw-A
      *
     FPKB6CPL0UF  E           K        DISK                      A
      * UPD : Eval/Loss Error           Update index
      *
     FPKBVCPL0UF  E           K        DISK                      A
      * UPD : Eval Trans                Update index
      *
     FPKA4CPL0UF  E           K        DISK                      A
      * UPD : Tattoo Header Comment     Update index
      *
     FPKBSCPL0UF  E           K        DISK
      * UPD : Loss Trans                Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKDYCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Detail Ext         Update index
      *
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@B6CPGX
      * Eval/Loss Error           Retrieval index
      * Renamed input format fields
     I              B6HRNB                          WAHRNB
     I              B6BPDT                          WABPDT
     I              B6IRNB                          WAIRNB
     I              B6BONM                          WABONM
     I              B6LDNM                          WALDNM
     I              B6FPNB                          WAFPNB
     I              B6DYST                          WADYST
     I              B6DXST                          WADXST
     I              B6B7TX                          WAB7TX
     I              B6AAVN                          WAAAVN
     I              B6AADT                          WAAADT
     I              B6AMTM                          WAAMTM
     I              B6AJST                          WAAJST
     I              B6AHVN                          WAAHVN
     I              B6AGVN                          WAAGVN
     I              B6ABVN                          WAABVN
     I              B6ABDT                          WAABDT
     I              B6ABTM                          WAABTM
      *
     I@B6CPGW
      * Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
     I@BVCPQ9
      * Eval Trans                Co/Bol/KillDt/Tattoo
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     I@A4CPL4
      * Tattoo Header Comment     Co/BOL/Tto/KDt/Typ/Lin
      * Renamed input format fields
     I              A4HMNB                          WEHMNB
     I              A4BNNB                          WEBNNB
     I              A4BONB                          WEBONB
     I              A4CVNB                          WECVNB
     I              A4B0DT                          WEB0DT
     I              A4BETX                          WEBETX
     I              A4BFTX                          WEBFTX
     I              A4ETST                          WEETST
     I              A4AAVN                          WEAAVN
     I              A4AADT                          WEAADT
     I              A4AMTM                          WEAMTM
     I              A4AJST                          WEAJST
     I              A4AHVN                          WEAHVN
     I              A4AGVN                          WEAGVN
     I              A4ABVN                          WEABVN
     I              A4ABDT                          WEABDT
     I              A4ABTM                          WEABTM
      *
     I@A4CPC3
      * Tattoo Header Comment     Update index
      * Renamed input format fields
     I              A4HMNB                          WFHMNB
     I              A4BNNB                          WFBNNB
     I              A4BONB                          WFBONB
     I              A4CVNB                          WFCVNB
     I              A4B0DT                          WFB0DT
     I              A4BETX                          WFBETX
     I              A4BFTX                          WFBFTX
     I              A4ETST                          WFETST
     I              A4AAVN                          WFAAVN
     I              A4AADT                          WFAADT
     I              A4AMTM                          WFAMTM
     I              A4AJST                          WFAJST
     I              A4AHVN                          WFAHVN
     I              A4AGVN                          WFAGVN
     I              A4ABVN                          WFABVN
     I              A4ABDT                          WFABDT
     I              A4ABTM                          WFABTM
      *
     I@BSCPLV
      * Loss Trans                By Bo/Ld/Tattoo No Delet
      * Renamed input format fields
     I              BSHUNB                          WGHUNB
     I              BSA7DT                          WGA7DT
     I              BSFHNB                          WGFHNB
     I              BSFFNB                          WGFFNB
     I              BSEBST                          WGEBST
     I              BSDSNB                          WGDSNB
     I              BSS3NB                          WGS3NB
     I              BSS4NB                          WGS4NB
     I              BSD1ST                          WGD1ST
     I              BSH5ST                          WGH5ST
     I              BSJMST                          WGJMST
     I              BSSMST                          WGSMST
     I              BSBWCD                          WGBWCD
     I              BSBYCD                          WGBYCD
     I              BSHMNB                          WGHMNB
     I              BSBNNB                          WGBNNB
     I              BSBONB                          WGBONB
     I              BSCVNB                          WGCVNB
     I              BSB0DT                          WGB0DT
     I              BSAAVN                          WGAAVN
     I              BSAADT                          WGAADT
     I              BSAMTM                          WGAMTM
     I              BSAJST                          WGAJST
     I              BSAHVN                          WGAHVN
     I              BSAGVN                          WGAGVN
     I              BSABVN                          WGABVN
     I              BSABDT                          WGABDT
     I              BSABTM                          WGABTM
     I              BSB8DT                          WGB8DT
     I              BSAOTM                          WGAOTM
      *
     I@BSCPFS
      * Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WIHMNB
     I              A1BNNB                          WIBNNB
     I              A1BONB                          WIBONB
     I              A1CVNB                          WICVNB
     I              A1B0DT                          WIB0DT
     I              A1AWDT                          WIAWDT
     I              A1BICD                          WIBICD
     I              A1CPST                          WICPST
     I              A1ACPR                          WIACPR
     I              A1B9PR                          WIB9PR
     I              A1CAPR                          WICAPR
     I              A1C4ST                          WIC4ST
     I              A1AIPR                          WIAIPR
     I              A1A6DT                          WIA6DT
     I              A1C2ST                          WIC2ST
     I              A1CXNB                          WICXNB
     I              A1CWNB                          WICWNB
     I              A1FCNB                          WIFCNB
     I              A1H9NB                          WIH9NB
     I              A1FDNB                          WIFDNB
     I              A1FENB                          WIFENB
     I              A1HENB                          WIHENB
     I              A1HFNB                          WIHFNB
     I              A1CYNB                          WICYNB
     I              A1LRNB                          WILRNB
     I              A1E0NB                          WIE0NB
     I              A1A5PC                          WIA5PC
     I              A1FBNB                          WIFBNB
     I              A1A4PC                          WIA4PC
     I              A1F7NB                          WIF7NB
     I              A1HDNB                          WIHDNB
     I              A1F5NB                          WIF5NB
     I              A1F4NB                          WIF4NB
     I              A1F3NB                          WIF3NB
     I              A1F2NB                          WIF2NB
     I              A1AVPC                          WIAVPC
     I              A1AWPC                          WIAWPC
     I              A1CWPC                          WICWPC
     I              A1A8PC                          WIA8PC
     I              A1A7PC                          WIA7PC
     I              A1B8PR                          WIB8PR
     I              A1AMPR                          WIAMPR
     I              A1ANPR                          WIANPR
     I              A1AYVA                          WIAYVA
     I              A1AWVA                          WIAWVA
     I              A1AOPR                          WIAOPR
     I              A1AXVA                          WIAXVA
     I              A1APPR                          WIAPPR
     I              A1ASPR                          WIASPR
     I              A1A4VA                          WIA4VA
     I              A1ATPR                          WIATPR
     I              A1A5VA                          WIA5VA
     I              A1CBPR                          WICBPR
     I              A1CCPR                          WICCPR
     I              A1LPNB                          WILPNB
     I              A1CDPR                          WICDPR
     I              A1A7VA                          WIA7VA
     I              A1A2PR                          WIA2PR
     I              A1JWST                          WIJWST
     I              A1CWST                          WICWST
     I              A1D7ST                          WID7ST
     I              A1D8ST                          WID8ST
     I              A1DWST                          WIDWST
     I              A1D6ST                          WID6ST
     I              A1GHNB                          WIGHNB
     I              A1BYDT                          WIBYDT
     I              A1E0ST                          WIE0ST
     I              A1E1ST                          WIE1ST
     I              A1E2ST                          WIE2ST
     I              A1BSDT                          WIBSDT
     I              A1BTDT                          WIBTDT
     I              A1BUDT                          WIBUDT
     I              A1HGNB                          WIHGNB
     I              A1HHNB                          WIHHNB
     I              A1HINB                          WIHINB
     I              A1A3PR                          WIA3PR
     I              A1A4PR                          WIA4PR
     I              A1A6PR                          WIA6PR
     I              A1J9NB                          WIJ9NB
     I              A1D6PR                          WID6PR
     I              A1D7PR                          WID7PR
     I              A1D8PR                          WID8PR
     I              A1D9PR                          WID9PR
     I              A1EAPR                          WIEAPR
     I              A1EBPR                          WIEBPR
     I              A1ECPR                          WIECPR
     I              A1EDPR                          WIEDPR
     I              A1EEPR                          WIEEPR
     I              A1EFPR                          WIEFPR
     I              A1EGPR                          WIEGPR
     I              A1EHPR                          WIEHPR
     I              A1KAST                          WIKAST
     I              A1J7ST                          WIJ7ST
     I              A1J9ST                          WIJ9ST
     I              A1OXNB                          WIOXNB
     I              A1LKST                          WILKST
     I              A1LLST                          WILLST
     I              A1J8ST                          WIJ8ST
     I              A1LIST                          WILIST
     I              A1LJST                          WILJST
     I              A1NZTX                          WINZTX
     I              A1HJCD                          WIHJCD
     I              A1R4ST                          WIR4ST
     I              A1R5ST                          WIR5ST
     I              A1R6ST                          WIR6ST
     I              A1R7ST                          WIR7ST
     I              A1THWT                          WITHWT
     I              A1T2WT                          WIT2WT
     I              A1THHD                          WITHHD
     I              A1T2HD                          WIT2HD
     I              A1OBPR                          WIOBPR
     I              A1KOER                          WIKOER
     I              A1OPIR                          WIOPIR
     I              A1OPEM                          WIOPEM
     I              A1IORP                          WIIORP
     I              A1OWEO                          WIOWEO
     I              A1OQET                          WIOQET
     I              A1URST                          WIURST
     I              A1USST                          WIUSST
     I              A1HHPC                          WIHHPC
     I              A1S9PR                          WIS9PR
     I              A1TAPR                          WITAPR
     I              A1TBPR                          WITBPR
     I              A1JFUR                          WIJFUR
     I              A1KRIF                          WIKRIF
     I              A1KORF                          WIKORF
     I              A1KAPR                          WIKAPR
     I              A1KROT                          WIKROT
     I              A1OTJG                          WIOTJG
     I              A1IRJG                          WIIRJG
     I              A1IMJF                          WIIMJF
     I              A1IRGF                          WIIRGF
     I              A1KRJF                          WIKRJF
     I              A1OJRF                          WIOJRF
     I              A1KFOR                          WIKFOR
     I              A1ORJK                          WIORJK
     I              A1OMVJ                          WIOMVJ
     I              A1MVNF                          WIMVNF
     I              A1MCNF                          WIMCNF
     I              A1NCNF                          WINCNF
     I              A1NCHF                          WINCHF
     I              A1IGIR                          WIIGIR
     I              A1KFJR                          WIKFJR
     I              A1EADT                          WIEADT
     I              A1EBDT                          WIEBDT
     I              A1ECDT                          WIECDT
     I              A1EDDT                          WIEDDT
     I              A1EEDT                          WIEEDT
     I              A1U4ST                          WIU4ST
     I              A1U5ST                          WIU5ST
     I              A1U6ST                          WIU6ST
     I              A1U7ST                          WIU7ST
     I              A1U8ST                          WIU8ST
     I              A1U9ST                          WIU9ST
     I              A1VAST                          WIVAST
     I              A1VBST                          WIVBST
     I              A1BDCD                          WIBDCD
     I              A1CSCD                          WICSCD
     I              A1ABCD                          WIABCD
     I              A1AECD                          WIAECD
     I              A1ACCD                          WIACCD
     I              A1AGCD                          WIAGCD
     I              A1BECD                          WIBECD
     I              A1AAVN                          WIAAVN
     I              A1AADT                          WIAADT
     I              A1AMTM                          WIAMTM
     I              A1AJST                          WIAJST
     I              A1AHVN                          WIAHVN
     I              A1AGVN                          WIAGVN
     I              A1ABVN                          WIABVN
     I              A1ABDT                          WIABDT
     I              A1ABTM                          WIABTM
      *
     I@BSCPEM
      * Loss Trans                Co/LsTyp/Bo/Ld/Tto/KDte
      * Renamed input format fields
     I              BSHUNB                          WJHUNB
     I              BSA7DT                          WJA7DT
     I              BSFHNB                          WJFHNB
     I              BSFFNB                          WJFFNB
     I              BSEBST                          WJEBST
     I              BSDSNB                          WJDSNB
     I              BSS3NB                          WJS3NB
     I              BSS4NB                          WJS4NB
     I              BSD1ST                          WJD1ST
     I              BSH5ST                          WJH5ST
     I              BSJMST                          WJJMST
     I              BSSMST                          WJSMST
     I              BSBWCD                          WJBWCD
     I              BSBYCD                          WJBYCD
     I              BSHMNB                          WJHMNB
     I              BSBNNB                          WJBNNB
     I              BSBONB                          WJBONB
     I              BSCVNB                          WJCVNB
     I              BSB0DT                          WJB0DT
     I              BSAAVN                          WJAAVN
     I              BSAADT                          WJAADT
     I              BSAMTM                          WJAMTM
     I              BSAJST                          WJAJST
     I              BSAHVN                          WJAHVN
     I              BSAGVN                          WJAGVN
     I              BSABVN                          WJABVN
     I              BSABDT                          WJABDT
     I              BSABTM                          WJABTM
     I              BSB8DT                          WJB8DT
     I              BSAOTM                          WJAOTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WKHMNB
     I              A1BNNB                          WKBNNB
     I              A1BONB                          WKBONB
     I              A1CVNB                          WKCVNB
     I              A1B0DT                          WKB0DT
     I              A1AWDT                          WKAWDT
     I              A1BICD                          WKBICD
     I              A1CPST                          WKCPST
     I              A1ACPR                          WKACPR
     I              A1B9PR                          WKB9PR
     I              A1CAPR                          WKCAPR
     I              A1C4ST                          WKC4ST
     I              A1AIPR                          WKAIPR
     I              A1A6DT                          WKA6DT
     I              A1C2ST                          WKC2ST
     I              A1CXNB                          WKCXNB
     I              A1CWNB                          WKCWNB
     I              A1FCNB                          WKFCNB
     I              A1H9NB                          WKH9NB
     I              A1FDNB                          WKFDNB
     I              A1FENB                          WKFENB
     I              A1HENB                          WKHENB
     I              A1HFNB                          WKHFNB
     I              A1CYNB                          WKCYNB
     I              A1LRNB                          WKLRNB
     I              A1E0NB                          WKE0NB
     I              A1A5PC                          WKA5PC
     I              A1FBNB                          WKFBNB
     I              A1A4PC                          WKA4PC
     I              A1F7NB                          WKF7NB
     I              A1HDNB                          WKHDNB
     I              A1F5NB                          WKF5NB
     I              A1F4NB                          WKF4NB
     I              A1F3NB                          WKF3NB
     I              A1F2NB                          WKF2NB
     I              A1AVPC                          WKAVPC
     I              A1AWPC                          WKAWPC
     I              A1CWPC                          WKCWPC
     I              A1A8PC                          WKA8PC
     I              A1A7PC                          WKA7PC
     I              A1B8PR                          WKB8PR
     I              A1AMPR                          WKAMPR
     I              A1ANPR                          WKANPR
     I              A1AYVA                          WKAYVA
     I              A1AWVA                          WKAWVA
     I              A1AOPR                          WKAOPR
     I              A1AXVA                          WKAXVA
     I              A1APPR                          WKAPPR
     I              A1ASPR                          WKASPR
     I              A1A4VA                          WKA4VA
     I              A1ATPR                          WKATPR
     I              A1A5VA                          WKA5VA
     I              A1CBPR                          WKCBPR
     I              A1CCPR                          WKCCPR
     I              A1LPNB                          WKLPNB
     I              A1CDPR                          WKCDPR
     I              A1A7VA                          WKA7VA
     I              A1A2PR                          WKA2PR
     I              A1JWST                          WKJWST
     I              A1CWST                          WKCWST
     I              A1D7ST                          WKD7ST
     I              A1D8ST                          WKD8ST
     I              A1DWST                          WKDWST
     I              A1D6ST                          WKD6ST
     I              A1GHNB                          WKGHNB
     I              A1BYDT                          WKBYDT
     I              A1E0ST                          WKE0ST
     I              A1E1ST                          WKE1ST
     I              A1E2ST                          WKE2ST
     I              A1BSDT                          WKBSDT
     I              A1BTDT                          WKBTDT
     I              A1BUDT                          WKBUDT
     I              A1HGNB                          WKHGNB
     I              A1HHNB                          WKHHNB
     I              A1HINB                          WKHINB
     I              A1A3PR                          WKA3PR
     I              A1A4PR                          WKA4PR
     I              A1A6PR                          WKA6PR
     I              A1J9NB                          WKJ9NB
     I              A1D6PR                          WKD6PR
     I              A1D7PR                          WKD7PR
     I              A1D8PR                          WKD8PR
     I              A1D9PR                          WKD9PR
     I              A1EAPR                          WKEAPR
     I              A1EBPR                          WKEBPR
     I              A1ECPR                          WKECPR
     I              A1EDPR                          WKEDPR
     I              A1EEPR                          WKEEPR
     I              A1EFPR                          WKEFPR
     I              A1EGPR                          WKEGPR
     I              A1EHPR                          WKEHPR
     I              A1KAST                          WKKAST
     I              A1J7ST                          WKJ7ST
     I              A1J9ST                          WKJ9ST
     I              A1OXNB                          WKOXNB
     I              A1LKST                          WKLKST
     I              A1LLST                          WKLLST
     I              A1J8ST                          WKJ8ST
     I              A1LIST                          WKLIST
     I              A1LJST                          WKLJST
     I              A1NZTX                          WKNZTX
     I              A1HJCD                          WKHJCD
     I              A1R4ST                          WKR4ST
     I              A1R5ST                          WKR5ST
     I              A1R6ST                          WKR6ST
     I              A1R7ST                          WKR7ST
     I              A1THWT                          WKTHWT
     I              A1T2WT                          WKT2WT
     I              A1THHD                          WKTHHD
     I              A1T2HD                          WKT2HD
     I              A1OBPR                          WKOBPR
     I              A1KOER                          WKKOER
     I              A1OPIR                          WKOPIR
     I              A1OPEM                          WKOPEM
     I              A1IORP                          WKIORP
     I              A1OWEO                          WKOWEO
     I              A1OQET                          WKOQET
     I              A1URST                          WKURST
     I              A1USST                          WKUSST
     I              A1HHPC                          WKHHPC
     I              A1S9PR                          WKS9PR
     I              A1TAPR                          WKTAPR
     I              A1TBPR                          WKTBPR
     I              A1JFUR                          WKJFUR
     I              A1KRIF                          WKKRIF
     I              A1KORF                          WKKORF
     I              A1KAPR                          WKKAPR
     I              A1KROT                          WKKROT
     I              A1OTJG                          WKOTJG
     I              A1IRJG                          WKIRJG
     I              A1IMJF                          WKIMJF
     I              A1IRGF                          WKIRGF
     I              A1KRJF                          WKKRJF
     I              A1OJRF                          WKOJRF
     I              A1KFOR                          WKKFOR
     I              A1ORJK                          WKORJK
     I              A1OMVJ                          WKOMVJ
     I              A1MVNF                          WKMVNF
     I              A1MCNF                          WKMCNF
     I              A1NCNF                          WKNCNF
     I              A1NCHF                          WKNCHF
     I              A1IGIR                          WKIGIR
     I              A1KFJR                          WKKFJR
     I              A1EADT                          WKEADT
     I              A1EBDT                          WKEBDT
     I              A1ECDT                          WKECDT
     I              A1EDDT                          WKEDDT
     I              A1EEDT                          WKEEDT
     I              A1U4ST                          WKU4ST
     I              A1U5ST                          WKU5ST
     I              A1U6ST                          WKU6ST
     I              A1U7ST                          WKU7ST
     I              A1U8ST                          WKU8ST
     I              A1U9ST                          WKU9ST
     I              A1VAST                          WKVAST
     I              A1VBST                          WKVBST
     I              A1BDCD                          WKBDCD
     I              A1CSCD                          WKCSCD
     I              A1ABCD                          WKABCD
     I              A1AECD                          WKAECD
     I              A1ACCD                          WKACCD
     I              A1AGCD                          WKAGCD
     I              A1BECD                          WKBECD
     I              A1AAVN                          WKAAVN
     I              A1AADT                          WKAADT
     I              A1AMTM                          WKAMTM
     I              A1AJST                          WKAJST
     I              A1AHVN                          WKAHVN
     I              A1AGVN                          WKAGVN
     I              A1ABVN                          WKABVN
     I              A1ABDT                          WKABDT
     I              A1ABTM                          WKABTM
      *
     I@A2CPDG
      * Tattoo Detail             Retrieval index
      * Renamed input format fields
     I              A2HMNB                          WLHMNB
     I              A2BNNB                          WLBNNB
     I              A2BONB                          WLBONB
     I              A2CVNB                          WLCVNB
     I              A2B0DT                          WLB0DT
     I              A2C2NB                          WLC2NB
     I              A2CZNB                          WLCZNB
     I              A2C0NB                          WLC0NB
     I              A2D8NB                          WLD8NB
     I              A2H7NB                          WLH7NB
     I              A2GGST                          WLGGST
     I              A2AJTM                          WLAJTM
     I              A2JEA1                          WLJEA1
     I              A2B7CD                          WLB7CD
     I              A2D7NB                          WLD7NB
     I              A2D9ST                          WLD9ST
     I              A2E3ST                          WLE3ST
     I              A2E4ST                          WLE4ST
     I              A2E5ST                          WLE5ST
     I              A2BVDT                          WLBVDT
     I              A2BWDT                          WLBWDT
     I              A2BXDT                          WLBXDT
     I              A2HVNB                          WLHVNB
     I              A2CMCD                          WLCMCD
     I              A2B9CD                          WLB9CD
     I              A2H8NB                          WLH8NB
     I              A2CYCD                          WLCYCD
     I              A2AAVN                          WLAAVN
     I              A2AADT                          WLAADT
     I              A2AMTM                          WLAMTM
     I              A2AJST                          WLAJST
     I              A2AHVN                          WLAHVN
     I              A2AGVN                          WLAGVN
     I              A2ABVN                          WLABVN
     I              A2ABDT                          WLABDT
     I              A2ABTM                          WLABTM
      *
     I@DYCPXX
      * Tattoo Detail Ext         Retrieval index
      * Renamed input format fields
     I              DYHMNB                          WMHMNB
     I              DYBNNB                          WMBNNB
     I              DYBONB                          WMBONB
     I              DYCVNB                          WMCVNB
     I              DYB0DT                          WMB0DT
     I              DYC2NB                          WMC2NB
     I              DYP3ST                          WMP3ST
     I              DYLENB                          WMLENB
     I              DYLFNB                          WMLFNB
     I              DYLINB                          WMLINB
     I              DYP4ST                          WMP4ST
     I              DYP5ST                          WMP5ST
     I              DYAAVN                          WMAAVN
     I              DYAADT                          WMAADT
     I              DYAMTM                          WMAMTM
     I              DYAJST                          WMAJST
     I              DYAHVN                          WMAHVN
     I              DYAGVN                          WMAGVN
     I              DYABVN                          WMABVN
     I              DYABDT                          WMABDT
     I              DYABTM                          WMABTM
      *
     I@DYCPXW
      * Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WOHMNB
     I              DYBNNB                          WOBNNB
     I              DYBONB                          WOBONB
     I              DYCVNB                          WOCVNB
     I              DYB0DT                          WOB0DT
     I              DYC2NB                          WOC2NB
     I              DYP3ST                          WOP3ST
     I              DYLENB                          WOLENB
     I              DYLFNB                          WOLFNB
     I              DYLINB                          WOLINB
     I              DYP4ST                          WOP4ST
     I              DYP5ST                          WOP5ST
     I              DYAAVN                          WOAAVN
     I              DYAADT                          WOAADT
     I              DYAMTM                          WOAMTM
     I              DYAJST                          WOAJST
     I              DYAHVN                          WOAHVN
     I              DYAGVN                          WOAGVN
     I              DYABVN                          WOABVN
     I              DYABDT                          WOABDT
     I              DYABTM                          WOABTM
      *
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WRBVCD
     I              BOCBTX                          WRCBTX
     I              BOC5ST                          WRC5ST
     I              BOAFPC                          WRAFPC
     I              BOAGPC                          WRAGPC
     I              BOFEST                          WRFEST
     I              BOAAVN                          WRAAVN
     I              BOAADT                          WRAADT
     I              BOAMTM                          WRAMTM
     I              BOAJST                          WRAJST
     I              BOAHVN                          WRAHVN
     I              BOAGVN                          WRAGVN
     I              BOABVN                          WRABVN
     I              BOABDT                          WRABDT
     I              BOABTM                          WRABTM
      *
     I@BVCPEC
      * Eval Trans                Co/Bo/Ld/Tto/KDt/AdTy
      * Renamed input format fields
     I              BVHSNB                          WSHSNB
     I              BVA9DT                          WSA9DT
     I              BVFJNB                          WSFJNB
     I              BVHCNB                          WSHCNB
     I              BVGDNB                          WSGDNB
     I              BVFINB                          WSFINB
     I              BVLKNB                          WSLKNB
     I              BVEAST                          WSEAST
     I              BVAMPC                          WSAMPC
     I              BVAIPC                          WSAIPC
     I              BVAJPC                          WSAJPC
     I              BVAKPC                          WSAKPC
     I              BVX8NB                          WSX8NB
     I              BVFVPC                          WSFVPC
     I              BVFWPC                          WSFWPC
     I              BVFXPC                          WSFXPC
     I              BVALPC                          WSALPC
     I              BVDIST                          WSDIST
     I              BVFYST                          WSFYST
     I              BVD2ST                          WSD2ST
     I              BVEHST                          WSEHST
     I              BVG1ST                          WSG1ST
     I              BVH4ST                          WSH4ST
     I              BVJLST                          WSJLST
     I              BVUUST                          WSUUST
     I              BVVHST                          WSVHST
     I              BVVIST                          WSVIST
     I              BVVJST                          WSVJST
     I              BVVKST                          WSVKST
     I              BVVLST                          WSVLST
     I              BVHMNB                          WSHMNB
     I              BVBNNB                          WSBNNB
     I              BVBONB                          WSBONB
     I              BVCVNB                          WSCVNB
     I              BVB0DT                          WSB0DT
     I              BVAAVN                          WSAAVN
     I              BVAADT                          WSAADT
     I              BVAMTM                          WSAMTM
     I              BVAJST                          WSAJST
     I              BVAHVN                          WSAHVN
     I              BVAGVN                          WSAGVN
     I              BVABVN                          WSABVN
     I              BVABDT                          WSABDT
     I              BVABTM                          WSABTM
     I              BVB8DT                          WSB8DT
     I              BVAOTM                          WSAOTM
      *
     I@CGCPEJ
      * Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      * Renamed input format fields
     I              CGY3A1                          WTY3A1
     I              CGABCD                          WTABCD
     I              CGUVST                          WTUVST
     I              CGDZDT                          WTDZDT
     I              CGOJJF                          WTOJJF
     I              CGALHD                          WTALHD
     I              CGKDUR                          WTKDUR
     I              CGKJOQ                          WTKJOQ
     I              CGJOWR                          WTJOWR
     I              CGOIWE                          WTOIWE
     I              CGIOTR                          WTIOTR
     I              CGJOWK                          WTJOWK
     I              CGUQWP                          WTUQWP
     I              CGO6PC                          WTO6PC
     I              CGJKSE                          WTJKSE
     I              CGG8PC                          WTG8PC
     I              CGHAPC                          WTHAPC
     I              CGORJG                          WTORJG
     I              CGHDPC                          WTHDPC
     I              CGHFPC                          WTHFPC
     I              CGS1PR                          WTS1PR
     I              CGTCPR                          WTTCPR
     I              CGS3PR                          WTS3PR
     I              CGTDPR                          WTTDPR
     I              CGS5PR                          WTS5PR
     I              CGTEPR                          WTTEPR
     I              CGS7PR                          WTS7PR
     I              CGTFPR                          WTTFPR
     I              CGB6A1                          WTB6A1
     I              CGJKOS                          WTJKOS
     I              CGALRC                          WTALRC
     I              CGKDIE                          WTKDIE
     I              CGJOEW                          WTJOEW
     I              CGOWUI                          WTOWUI
     I              CGIOWN                          WTIOWN
     I              CGORMB                          WTORMB
     I              CGJOQR                          WTJOQR
     I              CGPRUR                          WTPRUR
     I              CGG7PC                          WTG7PC
     I              CGIOOG                          WTIOOG
     I              CGG9PC                          WTG9PC
     I              CGHBPC                          WTHBPC
     I              CGUWOE                          WTUWOE
     I              CGHEPC                          WTHEPC
     I              CGHGPC                          WTHGPC
     I              CGS2PR                          WTS2PR
     I              CGTGPR                          WTTGPR
     I              CGS4PR                          WTS4PR
     I              CGTHPR                          WTTHPR
     I              CGS6PR                          WTS6PR
     I              CGTIPR                          WTTIPR
     I              CGS8PR                          WTS8PR
     I              CGTJPR                          WTTJPR
     I              CGB8A1                          WTB8A1
     I              CGAAVN                          WTAAVN
     I              CGAADT                          WTAADT
     I              CGAMTM                          WTAMTM
     I              CGAJST                          WTAJST
     I              CGAHVN                          WTAHVN
     I              CGAGVN                          WTAGVN
     I              CGABVN                          WTABVN
     I              CGABDT                          WTABDT
     I              CGABTM                          WTABTM
      *
     I@B6CPLW
      * Eval/Loss Error           Eval Errors only
      * Renamed input format fields
     I              B6HRNB                          WVHRNB
     I              B6BPDT                          WVBPDT
     I              B6IRNB                          WVIRNB
     I              B6BONM                          WVBONM
     I              B6LDNM                          WVLDNM
     I              B6FPNB                          WVFPNB
     I              B6DYST                          WVDYST
     I              B6DXST                          WVDXST
     I              B6B7TX                          WVB7TX
     I              B6AAVN                          WVAAVN
     I              B6AADT                          WVAADT
     I              B6AMTM                          WVAMTM
     I              B6AJST                          WVAJST
     I              B6AHVN                          WVAHVN
     I              B6AGVN                          WVAGVN
     I              B6ABVN                          WVABVN
     I              B6ABDT                          WVABDT
     I              B6ABTM                          WVABTM
      *
     I@A4CPL3
      * Tattoo Header Comment     THC Comment, Line (D)
      * Renamed input format fields
     I              A4HMNB                          WWHMNB
     I              A4BNNB                          WWBNNB
     I              A4BONB                          WWBONB
     I              A4CVNB                          WWCVNB
     I              A4B0DT                          WWB0DT
     I              A4BETX                          WWBETX
     I              A4BFTX                          WWBFTX
     I              A4ETST                          WWETST
     I              A4AAVN                          WWAAVN
     I              A4AADT                          WWAADT
     I              A4AMTM                          WWAMTM
     I              A4AJST                          WWAJST
     I              A4AHVN                          WWAHVN
     I              A4AGVN                          WWAGVN
     I              A4ABVN                          WWABVN
     I              A4ABDT                          WWABDT
     I              A4ABTM                          WWABTM
      *
     I@A1CPC7
      * Tattoo Header             Retrieval Index 2
      * Renamed input format fields
     I              A1HMNB                          WXHMNB
     I              A1BNNB                          WXBNNB
     I              A1BONB                          WXBONB
     I              A1CVNB                          WXCVNB
     I              A1B0DT                          WXB0DT
     I              A1AWDT                          WXAWDT
     I              A1BICD                          WXBICD
     I              A1CPST                          WXCPST
     I              A1ACPR                          WXACPR
     I              A1B9PR                          WXB9PR
     I              A1CAPR                          WXCAPR
     I              A1C4ST                          WXC4ST
     I              A1AIPR                          WXAIPR
     I              A1A6DT                          WXA6DT
     I              A1C2ST                          WXC2ST
     I              A1CXNB                          WXCXNB
     I              A1CWNB                          WXCWNB
     I              A1FCNB                          WXFCNB
     I              A1H9NB                          WXH9NB
     I              A1FDNB                          WXFDNB
     I              A1FENB                          WXFENB
     I              A1HENB                          WXHENB
     I              A1HFNB                          WXHFNB
     I              A1CYNB                          WXCYNB
     I              A1LRNB                          WXLRNB
     I              A1E0NB                          WXE0NB
     I              A1A5PC                          WXA5PC
     I              A1FBNB                          WXFBNB
     I              A1A4PC                          WXA4PC
     I              A1F7NB                          WXF7NB
     I              A1HDNB                          WXHDNB
     I              A1F5NB                          WXF5NB
     I              A1F4NB                          WXF4NB
     I              A1F3NB                          WXF3NB
     I              A1F2NB                          WXF2NB
     I              A1AVPC                          WXAVPC
     I              A1AWPC                          WXAWPC
     I              A1CWPC                          WXCWPC
     I              A1A8PC                          WXA8PC
     I              A1A7PC                          WXA7PC
     I              A1B8PR                          WXB8PR
     I              A1AMPR                          WXAMPR
     I              A1ANPR                          WXANPR
     I              A1AYVA                          WXAYVA
     I              A1AWVA                          WXAWVA
     I              A1AOPR                          WXAOPR
     I              A1AXVA                          WXAXVA
     I              A1APPR                          WXAPPR
     I              A1ASPR                          WXASPR
     I              A1A4VA                          WXA4VA
     I              A1ATPR                          WXATPR
     I              A1A5VA                          WXA5VA
     I              A1CBPR                          WXCBPR
     I              A1CCPR                          WXCCPR
     I              A1LPNB                          WXLPNB
     I              A1CDPR                          WXCDPR
     I              A1A7VA                          WXA7VA
     I              A1A2PR                          WXA2PR
     I              A1JWST                          WXJWST
     I              A1CWST                          WXCWST
     I              A1D7ST                          WXD7ST
     I              A1D8ST                          WXD8ST
     I              A1DWST                          WXDWST
     I              A1D6ST                          WXD6ST
     I              A1GHNB                          WXGHNB
     I              A1BYDT                          WXBYDT
     I              A1E0ST                          WXE0ST
     I              A1E1ST                          WXE1ST
     I              A1E2ST                          WXE2ST
     I              A1BSDT                          WXBSDT
     I              A1BTDT                          WXBTDT
     I              A1BUDT                          WXBUDT
     I              A1HGNB                          WXHGNB
     I              A1HHNB                          WXHHNB
     I              A1HINB                          WXHINB
     I              A1A3PR                          WXA3PR
     I              A1A4PR                          WXA4PR
     I              A1A6PR                          WXA6PR
     I              A1J9NB                          WXJ9NB
     I              A1D6PR                          WXD6PR
     I              A1D7PR                          WXD7PR
     I              A1D8PR                          WXD8PR
     I              A1D9PR                          WXD9PR
     I              A1EAPR                          WXEAPR
     I              A1EBPR                          WXEBPR
     I              A1ECPR                          WXECPR
     I              A1EDPR                          WXEDPR
     I              A1EEPR                          WXEEPR
     I              A1EFPR                          WXEFPR
     I              A1EGPR                          WXEGPR
     I              A1EHPR                          WXEHPR
     I              A1KAST                          WXKAST
     I              A1J7ST                          WXJ7ST
     I              A1J9ST                          WXJ9ST
     I              A1OXNB                          WXOXNB
     I              A1LKST                          WXLKST
     I              A1LLST                          WXLLST
     I              A1J8ST                          WXJ8ST
     I              A1LIST                          WXLIST
     I              A1LJST                          WXLJST
     I              A1NZTX                          WXNZTX
     I              A1HJCD                          WXHJCD
     I              A1R4ST                          WXR4ST
     I              A1R5ST                          WXR5ST
     I              A1R6ST                          WXR6ST
     I              A1R7ST                          WXR7ST
     I              A1THWT                          WXTHWT
     I              A1T2WT                          WXT2WT
     I              A1THHD                          WXTHHD
     I              A1T2HD                          WXT2HD
     I              A1OBPR                          WXOBPR
     I              A1KOER                          WXKOER
     I              A1OPIR                          WXOPIR
     I              A1OPEM                          WXOPEM
     I              A1IORP                          WXIORP
     I              A1OWEO                          WXOWEO
     I              A1OQET                          WXOQET
     I              A1URST                          WXURST
     I              A1USST                          WXUSST
     I              A1HHPC                          WXHHPC
     I              A1S9PR                          WXS9PR
     I              A1TAPR                          WXTAPR
     I              A1TBPR                          WXTBPR
     I              A1JFUR                          WXJFUR
     I              A1KRIF                          WXKRIF
     I              A1KORF                          WXKORF
     I              A1KAPR                          WXKAPR
     I              A1KROT                          WXKROT
     I              A1OTJG                          WXOTJG
     I              A1IRJG                          WXIRJG
     I              A1IMJF                          WXIMJF
     I              A1IRGF                          WXIRGF
     I              A1KRJF                          WXKRJF
     I              A1OJRF                          WXOJRF
     I              A1KFOR                          WXKFOR
     I              A1ORJK                          WXORJK
     I              A1OMVJ                          WXOMVJ
     I              A1MVNF                          WXMVNF
     I              A1MCNF                          WXMCNF
     I              A1NCNF                          WXNCNF
     I              A1NCHF                          WXNCHF
     I              A1IGIR                          WXIGIR
     I              A1KFJR                          WXKFJR
     I              A1EADT                          WXEADT
     I              A1EBDT                          WXEBDT
     I              A1ECDT                          WXECDT
     I              A1EDDT                          WXEDDT
     I              A1EEDT                          WXEEDT
     I              A1U4ST                          WXU4ST
     I              A1U5ST                          WXU5ST
     I              A1U6ST                          WXU6ST
     I              A1U7ST                          WXU7ST
     I              A1U8ST                          WXU8ST
     I              A1U9ST                          WXU9ST
     I              A1VAST                          WXVAST
     I              A1VBST                          WXVBST
     I              A1BDCD                          WXBDCD
     I              A1CSCD                          WXCSCD
     I              A1ABCD                          WXABCD
     I              A1AECD                          WXAECD
     I              A1ACCD                          WXACCD
     I              A1AGCD                          WXAGCD
     I              A1BECD                          WXBECD
     I              A1AAVN                          WXAAVN
     I              A1AADT                          WXAADT
     I              A1AMTM                          WXAMTM
     I              A1AJST                          WXAJST
     I              A1AHVN                          WXAHVN
     I              A1AGVN                          WXAGVN
     I              A1ABVN                          WXABVN
     I              A1ABDT                          WXABDT
     I              A1ABTM                          WXABTM
      *
     I@BVCPNE
      * Eval Trans                Next Eval Trans
      * Renamed input format fields
     I              BVHSNB                          WYHSNB
     I              BVA9DT                          WYA9DT
     I              BVFJNB                          WYFJNB
     I              BVHCNB                          WYHCNB
     I              BVGDNB                          WYGDNB
     I              BVFINB                          WYFINB
     I              BVLKNB                          WYLKNB
     I              BVEAST                          WYEAST
     I              BVAMPC                          WYAMPC
     I              BVAIPC                          WYAIPC
     I              BVAJPC                          WYAJPC
     I              BVAKPC                          WYAKPC
     I              BVX8NB                          WYX8NB
     I              BVFVPC                          WYFVPC
     I              BVFWPC                          WYFWPC
     I              BVFXPC                          WYFXPC
     I              BVALPC                          WYALPC
     I              BVDIST                          WYDIST
     I              BVFYST                          WYFYST
     I              BVD2ST                          WYD2ST
     I              BVEHST                          WYEHST
     I              BVG1ST                          WYG1ST
     I              BVH4ST                          WYH4ST
     I              BVJLST                          WYJLST
     I              BVUUST                          WYUUST
     I              BVVHST                          WYVHST
     I              BVVIST                          WYVIST
     I              BVVJST                          WYVJST
     I              BVVKST                          WYVKST
     I              BVVLST                          WYVLST
     I              BVHMNB                          WYHMNB
     I              BVBNNB                          WYBNNB
     I              BVBONB                          WYBONB
     I              BVCVNB                          WYCVNB
     I              BVB0DT                          WYB0DT
     I              BVAAVN                          WYAAVN
     I              BVAADT                          WYAADT
     I              BVAMTM                          WYAMTM
     I              BVAJST                          WYAJST
     I              BVAHVN                          WYAHVN
     I              BVAGVN                          WYAGVN
     I              BVABVN                          WYABVN
     I              BVABDT                          WYABDT
     I              BVABTM                          WYABTM
     I              BVB8DT                          WYB8DT
     I              BVAOTM                          WYAOTM
      *
     I@BVCPZA
      * Eval Trans                Co/Bl/Tto/KDt/Ln-d/Hw-dN
      * Renamed input format fields
     I              BVHSNB                          TAHSNB
     I              BVA9DT                          TAA9DT
     I              BVFJNB                          TAFJNB
     I              BVHCNB                          TAHCNB
     I              BVGDNB                          TAGDNB
     I              BVFINB                          TAFINB
     I              BVLKNB                          TALKNB
     I              BVEAST                          TAEAST
     I              BVAMPC                          TAAMPC
     I              BVAIPC                          TAAIPC
     I              BVAJPC                          TAAJPC
     I              BVAKPC                          TAAKPC
     I              BVX8NB                          TAX8NB
     I              BVFVPC                          TAFVPC
     I              BVFWPC                          TAFWPC
     I              BVFXPC                          TAFXPC
     I              BVALPC                          TAALPC
     I              BVDIST                          TADIST
     I              BVFYST                          TAFYST
     I              BVD2ST                          TAD2ST
     I              BVEHST                          TAEHST
     I              BVG1ST                          TAG1ST
     I              BVH4ST                          TAH4ST
     I              BVJLST                          TAJLST
     I              BVUUST                          TAUUST
     I              BVVHST                          TAVHST
     I              BVVIST                          TAVIST
     I              BVVJST                          TAVJST
     I              BVVKST                          TAVKST
     I              BVVLST                          TAVLST
     I              BVHMNB                          TAHMNB
     I              BVBNNB                          TABNNB
     I              BVBONB                          TABONB
     I              BVCVNB                          TACVNB
     I              BVB0DT                          TAB0DT
     I              BVAAVN                          TAAAVN
     I              BVAADT                          TAAADT
     I              BVAMTM                          TAAMTM
     I              BVAJST                          TAAJST
     I              BVAHVN                          TAAHVN
     I              BVAGVN                          TAAGVN
     I              BVABVN                          TAABVN
     I              BVABDT                          TAABDT
     I              BVABTM                          TAABTM
     I              BVB8DT                          TAB8DT
     I              BVAOTM                          TAAOTM
      *
     I@BVCPKU
      * Eval Trans                Co/Bol/Tto/KDt/Ln-A/Hw-A
      * Renamed input format fields
     I              BVHSNB                          TBHSNB
     I              BVA9DT                          TBA9DT
     I              BVFJNB                          TBFJNB
     I              BVHCNB                          TBHCNB
     I              BVGDNB                          TBGDNB
     I              BVFINB                          TBFINB
     I              BVLKNB                          TBLKNB
     I              BVEAST                          TBEAST
     I              BVAMPC                          TBAMPC
     I              BVAIPC                          TBAIPC
     I              BVAJPC                          TBAJPC
     I              BVAKPC                          TBAKPC
     I              BVX8NB                          TBX8NB
     I              BVFVPC                          TBFVPC
     I              BVFWPC                          TBFWPC
     I              BVFXPC                          TBFXPC
     I              BVALPC                          TBALPC
     I              BVDIST                          TBDIST
     I              BVFYST                          TBFYST
     I              BVD2ST                          TBD2ST
     I              BVEHST                          TBEHST
     I              BVG1ST                          TBG1ST
     I              BVH4ST                          TBH4ST
     I              BVJLST                          TBJLST
     I              BVUUST                          TBUUST
     I              BVVHST                          TBVHST
     I              BVVIST                          TBVIST
     I              BVVJST                          TBVJST
     I              BVVKST                          TBVKST
     I              BVVLST                          TBVLST
     I              BVHMNB                          TBHMNB
     I              BVBNNB                          TBBNNB
     I              BVBONB                          TBBONB
     I              BVCVNB                          TBCVNB
     I              BVB0DT                          TBB0DT
     I              BVAAVN                          TBAAVN
     I              BVAADT                          TBAADT
     I              BVAMTM                          TBAMTM
     I              BVAJST                          TBAJST
     I              BVAHVN                          TBAHVN
     I              BVAGVN                          TBAGVN
     I              BVABVN                          TBABVN
     I              BVABDT                          TBABDT
     I              BVABTM                          TBABTM
     I              BVB8DT                          TBB8DT
     I              BVAOTM                          TBAOTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB61    E DSPKB6CPL0
      * UPD : Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     IYARDCS      DS                            144
     IYBRDCS      DS                            144
     IQPKA41    E DSPKA4CPL0
      * UPD : Tattoo Header Comment     Update index
      * Renamed input format fields
     I              A4HMNB                          WFHMNB
     I              A4BNNB                          WFBNNB
     I              A4BONB                          WFBONB
     I              A4CVNB                          WFCVNB
     I              A4B0DT                          WFB0DT
     I              A4BETX                          WFBETX
     I              A4BFTX                          WFBFTX
     I              A4ETST                          WFETST
     I              A4AAVN                          WFAAVN
     I              A4AADT                          WFAADT
     I              A4AMTM                          WFAMTM
     I              A4AJST                          WFAJST
     I              A4AHVN                          WFAHVN
     I              A4AGVN                          WFAGVN
     I              A4ABVN                          WFABVN
     I              A4ABDT                          WFABDT
     I              A4ABTM                          WFABTM
      *
      * Outward parameters
     IPARC        DS                            111
      * RCD : Loss Trans                Retrieval index
      * I : MAP LTN Company Number
     I                                    P   1   20PAHUNB
      * I : MAP LTN Kill Date
     I                                    P   3   60PAA7DT
      * I : MAP LTN Record Number
     I                                    P   7  100PAFHNB
      * I : MAP LTN Tattoo Number
     I                                    P  11  130PAFFNB
      * I : MAP LTN Shift
     I                                       14  14 PAEBST
      * I : MAP LTN Wgt
     I                                    P  15  181PADSNB
      * I : MAP LTN Extent
     I                                       19  20 PAS3NB
      * I : MAP LTN Trim Location
     I                                       21  22 PAS4NB
      * B : MAP LTN Error Sts
     I                                       23  23 PAD1ST
      * I : MAP LTN Record Created Status
     I                                       24  24 PAH5ST
      * I : MAP LTN User Error Override
     I                                       25  25 PAJMST
      * I : MAP LTN Source Type
     I                                       26  26 PASMST
      * I : MAP LT Type Code
     I                                    P  27  280PABWCD
      * I : MAP LR Reason Code
     I                                    P  29  300PABYCD
      * I : MAP BOH Company Number
     I                                    P  31  320PAHMNB
      * I : MAP BOH Buy Order Number
     I                                    P  33  360PABNNB
      * I : MAP BOL Load Number
     I                                    P  37  390PABONB
      * I : MAP TH Tattoo Number
     I                                    P  40  420PACVNB
      * I : MAP TH Kill Date
     I                                    P  43  460PAB0DT
      * I : MAP RS User Changed
     I                                       47  56 PAAAVN
      * I : MAP RS Date Changed
     I                                    P  57  600PAAADT
      * I : MAP RS Time Changed
     I                                    P  61  640PAAMTM
      * I : MAP RS Record Status
     I                                       65  65 PAAJST
      * I : MAP RS Job
     I                                       66  75 PAAHVN
      * I : MAP RS Program
     I                                       76  85 PAAGVN
      * I : MAP RS User Added
     I                                       86  95 PAABVN
      * I : MAP RS Date Added
     I                                    P  96  990PAABDT
      * I : MAP RS Time Added
     I                                    P 100 1030PAABTM
      * I : MAP RU Date
     I                                    P 104 1070PAB8DT
      * I : MAP RU Time
     I                                    P 108 1110PAAOTM
      *
     IQPKBS1    E DSPKBSCPL0
      * UPD : Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
     IYCRDCS      DS                            111
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WKHMNB
     I              A1BNNB                          WKBNNB
     I              A1BONB                          WKBONB
     I              A1CVNB                          WKCVNB
     I              A1B0DT                          WKB0DT
     I              A1AWDT                          WKAWDT
     I              A1BICD                          WKBICD
     I              A1CPST                          WKCPST
     I              A1ACPR                          WKACPR
     I              A1B9PR                          WKB9PR
     I              A1CAPR                          WKCAPR
     I              A1C4ST                          WKC4ST
     I              A1AIPR                          WKAIPR
     I              A1A6DT                          WKA6DT
     I              A1C2ST                          WKC2ST
     I              A1CXNB                          WKCXNB
     I              A1CWNB                          WKCWNB
     I              A1FCNB                          WKFCNB
     I              A1H9NB                          WKH9NB
     I              A1FDNB                          WKFDNB
     I              A1FENB                          WKFENB
     I              A1HENB                          WKHENB
     I              A1HFNB                          WKHFNB
     I              A1CYNB                          WKCYNB
     I              A1LRNB                          WKLRNB
     I              A1E0NB                          WKE0NB
     I              A1A5PC                          WKA5PC
     I              A1FBNB                          WKFBNB
     I              A1A4PC                          WKA4PC
     I              A1F7NB                          WKF7NB
     I              A1HDNB                          WKHDNB
     I              A1F5NB                          WKF5NB
     I              A1F4NB                          WKF4NB
     I              A1F3NB                          WKF3NB
     I              A1F2NB                          WKF2NB
     I              A1AVPC                          WKAVPC
     I              A1AWPC                          WKAWPC
     I              A1CWPC                          WKCWPC
     I              A1A8PC                          WKA8PC
     I              A1A7PC                          WKA7PC
     I              A1B8PR                          WKB8PR
     I              A1AMPR                          WKAMPR
     I              A1ANPR                          WKANPR
     I              A1AYVA                          WKAYVA
     I              A1AWVA                          WKAWVA
     I              A1AOPR                          WKAOPR
     I              A1AXVA                          WKAXVA
     I              A1APPR                          WKAPPR
     I              A1ASPR                          WKASPR
     I              A1A4VA                          WKA4VA
     I              A1ATPR                          WKATPR
     I              A1A5VA                          WKA5VA
     I              A1CBPR                          WKCBPR
     I              A1CCPR                          WKCCPR
     I              A1LPNB                          WKLPNB
     I              A1CDPR                          WKCDPR
     I              A1A7VA                          WKA7VA
     I              A1A2PR                          WKA2PR
     I              A1JWST                          WKJWST
     I              A1CWST                          WKCWST
     I              A1D7ST                          WKD7ST
     I              A1D8ST                          WKD8ST
     I              A1DWST                          WKDWST
     I              A1D6ST                          WKD6ST
     I              A1GHNB                          WKGHNB
     I              A1BYDT                          WKBYDT
     I              A1E0ST                          WKE0ST
     I              A1E1ST                          WKE1ST
     I              A1E2ST                          WKE2ST
     I              A1BSDT                          WKBSDT
     I              A1BTDT                          WKBTDT
     I              A1BUDT                          WKBUDT
     I              A1HGNB                          WKHGNB
     I              A1HHNB                          WKHHNB
     I              A1HINB                          WKHINB
     I              A1A3PR                          WKA3PR
     I              A1A4PR                          WKA4PR
     I              A1A6PR                          WKA6PR
     I              A1J9NB                          WKJ9NB
     I              A1D6PR                          WKD6PR
     I              A1D7PR                          WKD7PR
     I              A1D8PR                          WKD8PR
     I              A1D9PR                          WKD9PR
     I              A1EAPR                          WKEAPR
     I              A1EBPR                          WKEBPR
     I              A1ECPR                          WKECPR
     I              A1EDPR                          WKEDPR
     I              A1EEPR                          WKEEPR
     I              A1EFPR                          WKEFPR
     I              A1EGPR                          WKEGPR
     I              A1EHPR                          WKEHPR
     I              A1KAST                          WKKAST
     I              A1J7ST                          WKJ7ST
     I              A1J9ST                          WKJ9ST
     I              A1OXNB                          WKOXNB
     I              A1LKST                          WKLKST
     I              A1LLST                          WKLLST
     I              A1J8ST                          WKJ8ST
     I              A1LIST                          WKLIST
     I              A1LJST                          WKLJST
     I              A1NZTX                          WKNZTX
     I              A1HJCD                          WKHJCD
     I              A1R4ST                          WKR4ST
     I              A1R5ST                          WKR5ST
     I              A1R6ST                          WKR6ST
     I              A1R7ST                          WKR7ST
     I              A1THWT                          WKTHWT
     I              A1T2WT                          WKT2WT
     I              A1THHD                          WKTHHD
     I              A1T2HD                          WKT2HD
     I              A1OBPR                          WKOBPR
     I              A1KOER                          WKKOER
     I              A1OPIR                          WKOPIR
     I              A1OPEM                          WKOPEM
     I              A1IORP                          WKIORP
     I              A1OWEO                          WKOWEO
     I              A1OQET                          WKOQET
     I              A1URST                          WKURST
     I              A1USST                          WKUSST
     I              A1HHPC                          WKHHPC
     I              A1S9PR                          WKS9PR
     I              A1TAPR                          WKTAPR
     I              A1TBPR                          WKTBPR
     I              A1JFUR                          WKJFUR
     I              A1KRIF                          WKKRIF
     I              A1KORF                          WKKORF
     I              A1KAPR                          WKKAPR
     I              A1KROT                          WKKROT
     I              A1OTJG                          WKOTJG
     I              A1IRJG                          WKIRJG
     I              A1IMJF                          WKIMJF
     I              A1IRGF                          WKIRGF
     I              A1KRJF                          WKKRJF
     I              A1OJRF                          WKOJRF
     I              A1KFOR                          WKKFOR
     I              A1ORJK                          WKORJK
     I              A1OMVJ                          WKOMVJ
     I              A1MVNF                          WKMVNF
     I              A1MCNF                          WKMCNF
     I              A1NCNF                          WKNCNF
     I              A1NCHF                          WKNCHF
     I              A1IGIR                          WKIGIR
     I              A1KFJR                          WKKFJR
     I              A1EADT                          WKEADT
     I              A1EBDT                          WKEBDT
     I              A1ECDT                          WKECDT
     I              A1EDDT                          WKEDDT
     I              A1EEDT                          WKEEDT
     I              A1U4ST                          WKU4ST
     I              A1U5ST                          WKU5ST
     I              A1U6ST                          WKU6ST
     I              A1U7ST                          WKU7ST
     I              A1U8ST                          WKU8ST
     I              A1U9ST                          WKU9ST
     I              A1VAST                          WKVAST
     I              A1VBST                          WKVBST
     I              A1BDCD                          WKBDCD
     I              A1CSCD                          WKCSCD
     I              A1ABCD                          WKABCD
     I              A1AECD                          WKAECD
     I              A1ACCD                          WKACCD
     I              A1AGCD                          WKAGCD
     I              A1BECD                          WKBECD
     I              A1AAVN                          WKAAVN
     I              A1AADT                          WKAADT
     I              A1AMTM                          WKAMTM
     I              A1AJST                          WKAJST
     I              A1AHVN                          WKAHVN
     I              A1AGVN                          WKAGVN
     I              A1ABVN                          WKABVN
     I              A1ABDT                          WKABDT
     I              A1ABTM                          WKABTM
      *
     IYDRDCS      DS                            583
     IQPKDY1    E DSPKDYCPL0
      * UPD : Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WOHMNB
     I              DYBNNB                          WOBNNB
     I              DYBONB                          WOBONB
     I              DYCVNB                          WOCVNB
     I              DYB0DT                          WOB0DT
     I              DYC2NB                          WOC2NB
     I              DYP3ST                          WOP3ST
     I              DYLENB                          WOLENB
     I              DYLFNB                          WOLFNB
     I              DYLINB                          WOLINB
     I              DYP4ST                          WOP4ST
     I              DYP5ST                          WOP5ST
     I              DYAAVN                          WOAAVN
     I              DYAADT                          WOAADT
     I              DYAMTM                          WOAMTM
     I              DYAJST                          WOAJST
     I              DYAHVN                          WOAHVN
     I              DYAGVN                          WOAGVN
     I              DYABVN                          WOABVN
     I              DYABDT                          WOABDT
     I              DYABTM                          WOABTM
      *
     IYERDCS      DS                             88
     IYFRDCS      DS                            144
     IYGRDCS      DS                            144
     IYHRDCS      DS                            583
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IYIRDCS      DS                            144
     IYJRDCS      DS                            144
     IYKRDCS      DS                            144
     IYLRDCS      DS                            144
     IYMRDCS      DS                            144
     IYNRDCS      DS                            144
     IYORDCS      DS                            144
     IYPRDCS      DS                            583
     IYQRDCS      DS                            144
     IYRRDCS      DS                            583
     IYSRDCS      DS                             88
      /EJECT
      * Parameter declarations
     IP1PARM      DS                            583
      * RCD: Tattoo Header             Retrieval index
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I :  BOL Load Number
     I                                    P   7   90P1BONB
      * I :  TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I :  TH Kill Date
     I                                    P  13  160P1B0DT
      * I :  TH Purchase Date
     I                                    P  17  200P1AWDT
      * I :  TH Group Reference
     I                                       21  30 P1BICD
      * I :  TH Live Purchase UOM
     I                                       31  32 P1CPST
      * I :  TH Live Purchase Price
     I                                    P  33  352P1ACPR
      * I :  TH Live Gross Amt
     I                                    P  36  392P1B9PR
      * I :  TH LIve Net Amt
     I                                    P  40  432P1CAPR
      * I :  TH Resale UOM
     I                                       44  45 P1C4ST
      * I :  TH Recalc Live Wgt Yld
     I                                    P  46  482P1AIPR
      * I :  TH Pricing Date
     I                                    P  49  520P1A6DT
      * I :  TH Resale Spread Sts
     I                                       53  53 P1C2ST
      * I :  TH Dead On Arrival
     I                                    P  54  560P1CXNB
      * I :  TH Head Received
     I                                    P  57  590P1CWNB
      * I :  TH Yard Deads
     I                                    P  60  620P1FCNB
      * I :  TH Held Over
     I                                    P  63  650P1H9NB
      * I :  TH Head Condemned
     I                                    P  66  680P1FDNB
      * I :  TH Head Killed
     I                                    P  69  710P1FENB
      * I :  TH Head Adds
     I                                    P  72  740P1HENB
      * I :  TH Head Accepted
     I                                    P  75  770P1HFNB
      * I :  TH Live Wgt
     I                                    P  78  811P1CYNB
      * I :  TH Adj Live Wgt
     I                                    P  82  851P1LRNB
      * I :  TH Hot Wgt
     I                                    P  86  891P1E0NB
      * I :  TH Tot Loin Eye Depth
     I                                    P  90  931P1A5PC
      * I :  TH Tot Backfat Inches
     I                                    P  94  971P1FBNB
      * I :  TH Tot Light Reflectance
     I                                    P  98 1011P1A4PC
      * I :  TH Avg Live Wgt
     I                                    P 102 1041P1F7NB
      * I :  TH Avg Hot Wgt
     I                                    P 105 1071P1HDNB
      * I :  TH Avg Light Reflectance
     I                                    P 108 1091P1F5NB
      * I :  TH Avg Lean Percent
     I                                    P 110 1111P1F4NB
      * I :  TH Avg Loin Eye Depth
     I                                    P 112 1131P1F3NB
      * I :  TH Avg Backfat
     I                                    P 114 1151P1F2NB
      * I :  TH Std Yield Percent
     I                                    P 116 1182P1AVPC
      * I :  TH Actual Yield %
     I                                    P 119 1212P1AWPC
      * I :  TH Adj Actual Yield %
     I                                    P 122 1242P1CWPC
      * I :  TH Yield Difference
     I                                    P 125 1272P1A8PC
      * I :  TH Recalc Live Wgt
     I                                    P 128 1291P1A7PC
      * I :  TH CM Market Price
     I                                    P 130 1322P1B8PR
      * I :  TH CM Base Mkt Price
     I                                    P 133 1352P1AMPR
      * I :  TH CM Base Mkt Price Amt
     I                                    P 136 1392P1ANPR
      * I :  TH CM Sort Discount Amt
     I                                    P 140 1432P1AYVA
      * I :  TH CM Yield Gain/Loss Amt
     I                                    P 144 1472P1AWVA
      * I :  TH CM Base Carcass Value
     I                                    P 148 1512P1AOPR
      * I :  TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552P1AXVA
      * I :  TH CM Carcass Gross Amt
     I                                    P 156 1592P1APPR
      * I :  TH Deduction Amt
     I                                    P 160 1632P1ASPR
      * I :  TH Total Net WO Adds
     I                                    P 164 1672P1A4VA
      * I :  TH Carcass Net Amt
     I                                    P 168 1712P1ATPR
      * I :  TH Additions Amt
     I                                    P 172 1752P1A5VA
      * I :  TH Payment Gross
     I                                    P 176 1792P1CBPR
      * I :  Th Payment Net Amt
     I                                    P 180 1832P1CCPR
      * I :  TH AP Voucher/Document#
     I                                    P 184 1880P1LPNB
      * I :  TH Freight Amount
     I                                    P 189 1922P1CDPR
      * I :  TH Accrual Amount
     I                                    P 193 1962P1A7VA
      * I :  TH Fixed Cost Amount
     I                                    P 197 2002P1A2PR
      * I :  TH Calc Net Sts
     I                                      201 201 P1JWST
      * I :  TH Payment Sts
     I                                      202 203 P1CWST
      * N :  TH Header Error Sts
     I                                      204 204 P1D7ST
      * N :  TH Detail Error Sts
     I                                      205 205 P1D8ST
      * N :  TH Kill Balancing Sts
     I                                      206 206 P1DWST
      * I :  TH Bal to Kill Gen
     I                                      207 207 P1D6ST
      * I :  TH Commission A/P Voucher
     I                                      208 2150P1GHNB
      * I :  TH Voucher Payment Date
     I                                    P 216 2190P1BYDT
      * I :  TH User Error Override
     I                                      220 220 P1E0ST
      * I :  TH Held Over Record
     I                                      221 221 P1E1ST
      * I :  TH Sex
     I                                      222 222 P1E2ST
      * I :  TH Held/Ovr Completed Dte
     I                                    P 223 2260P1BSDT
      * I :  TH Commission Paid Date
     I                                    P 227 2300P1BTDT
      * I :  TH Actual Check Date
     I                                    P 231 2340P1BUDT
      * I :  TH Shipped Weight
     I                                    P 235 2381P1HGNB
      * I :  TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421P1HHNB
      * I :  TH FFLI
     I                                    P 243 2441P1HINB
      * I :  TH Kill Product Value
     I                                    P 245 2482P1A3PR
      * I :  TH Cut Product Value
     I                                    P 249 2522P1A4PR
      * I :  TH Render Product Value
     I                                    P 253 2562P1A6PR
      * I :  TH Head Excluded
     I                                    P 257 2590P1J9NB
      * I :  TH CM Bse Mkt Live /CWT
     I                                    P 260 2622P1D6PR
      * I :  TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652P1D7PR
      * I :  TH CM Srt Dsc Live /CWT
     I                                    P 266 2682P1D8PR
      * I :  TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712P1D9PR
      * I :  TH CM Yld G/L Live /CWT
     I                                    P 272 2742P1EAPR
      * I :  TH CM Yld G/L Carc /CWT
     I                                    P 275 2772P1EBPR
      * I :  TH CM Crc Val Live /CWT
     I                                    P 278 2802P1ECPR
      * I :  TH CM Crc Val Carc /CWT
     I                                    P 281 2832P1EDPR
      * I :  TH CM Lean Prem Live /CWT
     I                                    P 284 2862P1EEPR
      * I :  TH CM Lean Prem Carc /CWT
     I                                    P 287 2892P1EFPR
      * I :  TH CM Gross Live /CWT
     I                                    P 290 2922P1EGPR
      * I :  TH CM Gross Carc /CWT
     I                                    P 293 2952P1EHPR
      * I :  TH Source Type
     I                                      296 296 P1KAST
      * I :  TH Scale Ticket Sts
     I                                      297 297 P1J7ST
      * I :  TH Payment Type
     I                                      298 298 P1J9ST
      * I :  TH HPS Movement Ref #
     I                                    P 299 3020P1OXNB
      * I :  TH Source Code
     I                                      303 305 P1LKST
      * I :  TH Hog Class Type
     I                                      306 306 P1LLST
      * I :  TH Posted to HPS Flag
     I                                      307 307 P1J8ST
      * I :  TH Schedule Kill Shift
     I                                      308 308 P1LIST
      * I :  TH Shift Held Over
     I                                      309 309 P1LJST
      * I :  DF Defect Code
     I                                      492 497 P1BDCD
      * I :  THP Process Code
     I                                      498 503 P1CSCD
      * I :  PD Producer Code
     I                                      504 509 P1ABCD
      * I :  PL Location Code
     I                                      510 515 P1AECD
      * I :  HB Buyer Code
     I                                      516 518 P1ACCD
      * I :  GN Genetic Code
     I                                      519 523 P1AGCD
      * I :  HC Class Code
     I                                      524 526 P1BECD
      * I :  RS User Changed
     I                                      527 536 P1AAVN
      * I :  RS Date Changed
     I                                    P 537 5400P1AADT
      * I :  RS Time Changed
     I                                    P 541 5440P1AMTM
      * I :  RS Record Status
     I                                      545 545 P1AJST
      * I :  RS Job
     I                                      546 555 P1AHVN
      * I :  RS Program
     I                                      556 565 P1AGVN
      * I :  RS User Added
     I                                      566 575 P1ABVN
      * I :  RS Date Added
     I                                    P 576 5790P1ABDT
      * I :  RS Time Added
     I                                    P 580 5830P1ABTM
     IP2PARM      DS
      * FLD: STR Evaluation Min/Max
      * I :  Carcass Dbw Min
     I                                    P   1   41P2I7NB
      * I :  Carcass Dbw Max
     I                                    P   5   81P2I8NB
      * I :  Carcass Lgt Min
     I                                    P   9  121P2I9NB
      * I :  Carcass Lgt Max
     I                                    P  13  161P2JANB
      * I :  %Lean High Min
     I                                    P  17  201P2JBNB
      * I :  %Lean High Max
     I                                    P  21  241P2JLNB
      * I :  %Lean Low Min
     I                                    P  25  281P2JMNB
      * I :  %Lean Low Max
     I                                    P  29  321P2JCNB
      * I :  High Yield Min
     I                                    P  33  361P2JDNB
      * I :  High Yield Max
     I                                    P  37  401P2JENB
      * I :  Low Yield Min
     I                                    P  41  441P2JFNB
      * I :  Low Yield Max
     I                                    P  45  481P2JGNB
      * I :  Head < Percent Min
     I                                    P  49  521P2JHNB
      * I :  Head < Percent Max
     I                                    P  53  561P2JINB
      * I :  Head > Percent Min
     I                                    P  57  601P2JJNB
      * I :  Head > Percent Max
     I                                    P  61  641P2JKNB
      * I :  BackFat High Min
     I                                    P  65  681P2K5NB
      * I :  BackFat High Max
     I                                    P  69  721P2K6NB
      * I :  BackFat Low Min
     I                                    P  73  761P2K7NB
      * I :  Backfat Low Max
     I                                    P  77  801P2K8NB
      * I :  LoinEye High Min
     I                                    P  81  841P2K9NB
      * I :  LoinEye High Max
     I                                    P  85  881P2LANB
      * I :  LoinEye Low Min
     I                                    P  89  921P2LBNB
      * I :  LoinEye Low Max
     I                                    P  93  961P2LCNB
     IP3PARM      DS
      * I :  Requested by User to Bal
     I                                        1   1 P3G2ST
     IP4PARM      DS
      * I :  Bal w/History
     I                                        1   1 P4VRST
     IP5PARM      DS
      * FLD: Tattoo Header
      * I :  TH PHA Add Type
     I                                        1   1 P5OQET
      * I :  TH PHA Average Type
     I                                        2   4 P5URST
      * I :  TH PHA Add Reason
     I                                        5   5 P5USST
     IP6PARM      DS
      * FLD: Producer History WKLY
      * I :  PH GA Avg Live Wgt
     I                                    P   1   31P6ORMB
      * I :  PH GA Adjusted Yield%
     I                                    P   4   62P6G9PC
      * I :  PH GA Avg Lean%
     I                                    P   7   81P6HBPC
      * I :  PH GA Avg Backfat
     I                                    P   9  101P6UWOE
      * I :  PH GA Avg Loin Eye
     I                                    P  11  121P6HEPC
      * I :  PH GA Avg Light Ref
     I                                    P  13  141P6HGPC
      * I :  PH GA Lean Prm /Carc CWT
     I                                    P  15  172P6TIPR
      * I :  PH GA Avg Srt Disc Fctr
     I                                    P  18  203P6B8A1
     IP7PARM      DS
      * I :  Undo MPR USR
     I                                        1   1 P7WFST
     IP8PARM      DS
      * O :  Balance First Day USR
     I                                        1   1 P8WGST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Pay Note:LN% Used Lot Av'
      * Message data for 'Pay Note: Use Prd's HstAV'
      * PH Summary Type
     I                                        1   3 ZA0001
      * Message data for 'Pay Note: Heldover'
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note: History'
      * Date USR
     I                                    P   1   40ZA0002
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: Heldover'
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: History'
      * Date USR
     I                                    P   1   40ZA0003
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: >105 ID'
      * TH PHA Average Type
     I                                        1   3 ZA0004
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: <75% Accepted'
      * TH PHA Average Type
     I                                        1   3 ZA0005
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: >75% Accepted'
      * Message data for 'Pay Note: >75% Accepted2'
      * Message data for 'Pay Note: >100% <105%'
      * Message data for 'Pay Note: >100% <105% 2'
      * Message data for 'Pay Note: >100% <105% 3'
      * Message data for 'Pay Note: Yield Parm'
      * TH Yld Parm Adj Yield%
     I                                    P   1   32ZA0006
      * TH PHA Average Type
     I                                        4   6 ZA0007
      * Message data for 'Pay Note: Yield Parm 2'
      * TH Yld Parm Adj Yield%
     I                                    P   1   32ZA0008
      * TH PHA Average Type
     I                                        4   6 ZA0009
      * Message data for 'Pay Note: Yield Parm 3'
      * TH Yld Parm Adj Yield%
     I                                    P   1   32ZA0010
      * TH PHA Average Type
     I                                        4   6 ZA0011
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: LW Formula'
      * Message data for 'Pay Note: LW Hst Yld'
      * Message data for 'Pay Note: LW Hst Yld 2'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           RCD: Tattoo Hea
     C           P2I7NB    PARM           WP0001  71       Carcass Dbw Min
     C           P2I8NB    PARM           WP0002  71       Carcass Dbw Max
     C           P2I9NB    PARM           WP0003  71       Carcass Lgt Min
     C           P2JANB    PARM           WP0004  71       Carcass Lgt Max
     C           P2JBNB    PARM           WP0005  71       %Lean High Min
     C           P2JLNB    PARM           WP0006  71       %Lean High Max
     C           P2JMNB    PARM           WP0007  71       %Lean Low Min
     C           P2JCNB    PARM           WP0008  71       %Lean Low Max
     C           P2JDNB    PARM           WP0009  71       High Yield Min
     C           P2JENB    PARM           WP0010  71       High Yield Max
     C           P2JFNB    PARM           WP0011  71       Low Yield Min
     C           P2JGNB    PARM           WP0012  71       Low Yield Max
     C           P2JHNB    PARM           WP0013  71       Head < Percent
     C           P2JINB    PARM           WP0014  71       Head < Percent
     C           P2JJNB    PARM           WP0015  71       Head > Percent
     C           P2JKNB    PARM           WP0016  71       Head > Percent
     C           P2K5NB    PARM           WP0017  71       BackFat High Mi
     C           P2K6NB    PARM           WP0018  71       BackFat High Ma
     C           P2K7NB    PARM           WP0019  71       BackFat Low Min
     C           P2K8NB    PARM           WP0020  71       Backfat Low Max
     C           P2K9NB    PARM           WP0021  71       LoinEye High Mi
     C           P2LANB    PARM           WP0022  71       LoinEye High Ma
     C           P2LBNB    PARM           WP0023  71       LoinEye Low Min
     C           P2LCNB    PARM           WP0024  71       LoinEye Low Max
     C           P3G2ST    PARM           WP0025  1        Requested by Us
     C           P4VRST    PARM           WP0026  1        Bal w/History
     C           P5OQET    PARM           WP0027  1        TH PHA Add Type
     C           P5URST    PARM           WP0028  3        TH PHA Average
     C           P5USST    PARM           WP0029  1        TH PHA Add Reas
     C           P6ORMB    PARM           WP0030  51       PH GA Avg Live
     C           P6G9PC    PARM           WP0031  52       PH GA Adjusted
     C           P6HBPC    PARM           WP0032  31       PH GA Avg Lean%
     C           P6UWOE    PARM           WP0033  31       PH GA Avg Backf
     C           P6HEPC    PARM           WP0034  31       PH GA Avg Loin
     C           P6HGPC    PARM           WP0035  31       PH GA Avg Light
     C           P6TIPR    PARM           WP0036  52       PH GA Lean Prm
     C           P6B8A1    PARM           WP0037  53       PH GA Avg Srt D
     C           P7WFST    PARM           WP0038  1        Undo MPR USR
     C           P8WGST    PARM P8WGST    WP0039  1        Balance First D
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bal/Val Tattoo        XF
      * Initialize
      * CASE: LCL.#Sequence Block is NULL
     C           YL0001    IFEQ *BLANK                     *IF
      * Delete All Errors for Tattoo if exists.
      * Dlt All Error's       RT - Eval/Loss Error  * 
     C                     EXSR SARVGN
      * Initialize Evaluation Transaction for re-balancing.
      * Bal Init Eval Trans   RT - Eval Trans  * 
     C                     EXSR SCRVGN
      * Delete Payment Tattoo Header Comments.
      * Del Payment Comments  RT - Tattoo Header Comment  * 
     C                     EXSR SGRVGN
      * Set Status fields to begining value
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL*BLANK    YL0004           TH Kill Balanci
     C                     MOVEL*BLANK    YL0005           THP Process Cod
     C                     MOVEL'SLG'     YL0005           THP Process Cod
      * LCL.TH Bal to Kill Gen
      * CASE: PAR.Requested by User to Bal is Yes
     C           P3G2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'U'       YL0006           TH Bal to Kill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1D6ST    YL0006           TH Bal to Kill
     C                     END                             *FI
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           YL0007    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'N'       YL0008           Hold Over Bal S
     C                     MOVEL'N'       P8WGST           Balance First D
      * 05/27/04 PKD HPEBAL - Initialize with Tattoo Header Recalc
      *                       Live Weight Yield.
     C                     Z-ADDP1AIPR    YL0009           TH Recalc Live
     C                     END                             *FI
      * RTV IHPE Shipper      XF - STR Order Management Sys  * 
     C                     CALL 'PPXJXFR'              90  RTV IHPE Shippe
     C           W0RTN     PARM W0RTN     WQ0004  7        *Return code
     C                     PARM P1HMNB    WQ0005  30       Company Number
     C           YL0010    PARM YL0010    WQ0006  2        CDI Shipper Use
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPXJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Tattoo Header Accumulate/Validate Loss Transaction
      * CASE: LCL.#Sequence Block is NULL
     C           YL0001    IFEQ *BLANK                     *IF
      * Rtv Bal/Tattoo Hdr    RT - Loss Trans  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * Tattoo Header Accumulate/Validate Evaluation Records
      * CASE: LCL.#Sequence Block is NULL
     C           YL0001    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           P1CWNB    SUB  P1FCNB    YL0014           Net Head Usr
     C                     SUB  YL0011    YL0014           Net Head Usr
     C           YL0011    ADD  P1FCNB    YL0015           Net Head Adjust
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                      and Balancing with Producer's History Averag
      *                      *** change to RTV to pass the producer
      * Bal/Val Eval Trans    RT - Eval Trans  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
      * Calculate Percent Identified & Percent Accepted
      * CASE: LCL.Net Head Usr is Not Zero
     C           YL0014    IFNE *ZERO                      *IF
      * Percent Identified
      * LCL.TH Percent Identified =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Head Identified
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0024    DIV  YL0014    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0085           TH Percent Iden
      * Percent Analyzed
      * LCL.TH Percent Analyzed =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Head Accepted
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0018    DIV  YL0014    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0086           TH Percent Acce
     C                     END                             *FI
      * Calculate Tattoo Header Averages/yield
     C                     EXSR UDSUBR                     Calculate Tatto
      * Upd Val Kill Trans    RT - Tattoo Header  * 
     C                     EXSR NBRVGN
      * Re-Calculate for Held Overs: %ID, %Anal, AvgHtWgt f/EXC, Adj Yiel
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : PAR.TH Held Over Record is Yes
      *   |- c2    : LCL.TH Bal to Kill Gen is User Requested Generated
      *   |- c3    : PAR.TH Held Over is greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0006    IFEQ 'U'                        *IF
     C           P1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** WRK is accumulated values, LCL is for current record. **
      *    We will overlay the LCL values of current record with both
      *    days combined.
      * Combine the two days for hold over.
      * Rtv Tot Hd ID/Anl/Net RT - Tattoo Header  * 
     C                     EXSR NDRVGN
      * WRK.Net Head Usr
      * WRK.Net Head Usr =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : WRK.TH Head Received
      * -     : PGM.*Synon (15,0) work field
      * x2    : WRK.TH Yard Deads
      * -     : PGM.*Synon (15,0) work field
      * x3    : WRK.TH Head Condemned
     C           WUCWNB    SUB  WUFCNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WUFDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUF6NB           Net Head Usr
      * LCL.Percent Identified
      * LCL.TH Percent Identified =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Head Identified
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUKOER    DIV  WUF6NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0085           TH Percent Iden
      * LCL.Percent Analyzed
      * LCL.TH Percent Accepted =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Head Accepted
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUHFNB    DIV  WUF6NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0086           TH Percent Acce
      * WRK.Adj Live Weight
      * CASE: WRK.TH Head Received EQ WRK.Net Head Usr
     C           WUCWNB    IFEQ WUF6NB                     *IF
     C                     Z-ADDWUCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: WRK.Net Head Usr EQ LCL.Zero USR
     C           WUF6NB    IFEQ YL0088                     *IF
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
      * WRK.Net Head Adjusted Usr
      * WRK.Net Head Adjusted Usr =
      *    *COMPUTE (x1 + x2)
      * x1    : WRK.TH Head Condemned
      * +     : PGM.*Synon (15,0) work field
      * x2    : WRK.TH Yard Deads
     C           WUFDNB    ADD  WUFCNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUZANB           Net Head Adjust
     C           WUZANB    MULT P1F7NB    YL0089           *Synon (15,2) w
     C           WUCYNB    SUB  YL0089    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     END                             *FI
      * WRK.Adj Actual Yield
      * CASE: WRK.TH Adj Live Wgt NE LCL.Zero USR
     C           WULRNB    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * WRK.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  WULRNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCWPC           TH Adj Actual Y
     C                     END                             *FI
      * LCL.Average Hot Weight for Exclude or Add
      * CASE: WRK.TH Head Killed NE LCL.Zero USR
     C           WUFENB    IFNE YL0088                     *IF
      * Accumulated totals div by head killed
     C           WUE0NB    DIV  WUFENB    YL0092    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0092           TH Avg Hot Wgt
     C                     END                             *FI
      * LCL.Average Lean Percent for Exclude or Add/Backfat/loinEye/etc.
      * CASE: WRK.TH Hot Wgt is Greater then Zero
     C           WUE0NB    IFGT *ZERO                      *IF
     C           WUJONB    DIV  WUE0NB    YL0093    H      TH Avg Lean Per
     C           WUL0NB    DIV  WUE0NB    YL0094    H      TH Avg Backfat
     C           WUL1NB    DIV  WUE0NB    YL0095    H      TH Avg Loin Eye
     C           WUL2NB    DIV  WUE0NB    YL0096    H      TH Avg Light Re
      * LCL.TH Avg Lean % EXC/ADD
      * LCL.TH Avg Lean % EXC/ADD =
      *    *COMPUTE ((x1 / x4))
      * x1    : WRK.Hot Wgt/Lean % Accum Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : WRK.TH Hot Wgt
     C           WUJONB    DIV  WUE0NB    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0097           TH Avg Lean % E
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Undo MPR USR is No
     C           P7WFST    IFEQ 'N'                        *IF
      * 03/01/04 ??? Only EXTERNAL will be paid with Historical Average
      *              if Held Over more then 1 day.
      * 08/19/04 PKD Externals and Internals will be balanced the same.
      *              starting 08/23/04 per Gary Louis.
      * CASE: PAR.BOH Company Number is SBD Farms of Guymon, Ok
     C           P1HMNB    IFEQ 360                        *IF
      * Balance Held Over Tattoo (> 1 day)
      * CASE:
      *  - (c1 OR c2)
      *   |- c1    : PAR.TH Held Over is greater than 0
      *   |- c2    : PAR.TH Held Over Record is Yes
      *   '-
     C           P1H9NB    IFGT *ZERO                      *IF
     C           P1E1ST    OREQ 'Y'                        *OR
      * Balance Held Over Tattoo
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Source Type is External
      *   |- c2    : PAR.TH Source Type is Internal
      *   '-
     C           P1KAST    IFEQ 'E'                        *IF
     C           P1KAST    OREQ 'I'                        *OR
      * Rtv Held Over KillDt  RT - Tattoo Header  * 
     C                     EXSR NERVGN
      * Balance Held Over of greater then 1 day.
      * CASE: PAR.TH Held Over Record is Yes
     C           P1E1ST    IFEQ 'Y'                        *IF
      * LCL.Day of Week USR = PAR.TH Kill Date *DAY OF WEEK
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C           XDAY1     ADD  3         XDWK1   80
     C                     DIV  7         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     Z-ADD7         XDWK1
     C                     END
     C           XDAY1     SUB  XDWK1     XDAY2   60
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0109
      * LCL.Held Over Days USR = PAR.TH Kill Date - LCL.Kill Date Usr *DA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0108    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0110
     C                     ELSE
     C           XDURR     MULT -1        YL0110
     C                     END
      * Monday or Held Over Days > 1
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Day of Week USR is Mon
      *   |- c2    : LCL.Held Over Days USR is GT 1
      *   '-
     C           YL0109    IFEQ 1                          *IF
     C           YL0110    ORGT 1                          *OR
     C                     MOVEL'E'       YL0101           TH PHA Add Type
     C                     MOVEL'4'       YL0103           TH PHA Add Reas
      * Setup message data for message
      * Retrieve message Pay Note: Heldover
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0932' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR NFRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0113    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0113    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0102           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0120    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6ORMB    YL0114           PH GA Avg Live
     C                     Z-ADDP6G9PC    YL0104           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0105           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0118           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0115           PH GA Avg Lean%
      * Setup message data for message
      * Convert Date USR to display format
      * Convert date
     C           1000000   ADD  *ZERO     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Retrieve message Pay Note: History
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0933' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0119    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0396  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0397  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0398  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0399  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0400  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0401  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0402  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0403  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0404  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0405  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0121           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * 03/28/05 SLM TFP0001 -
      *                      - The payment on Hold Over for more then 1 d
      *                      - Triumph will need to pay on the Producer
      *                      - avg live weight.
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0102    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0405           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0102    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0405           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0102    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0405           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ 0                          *IF
     C           P1A7PC    ORGT 0                          *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * 03/28/05 SLM TFP0001 - Add the selection for Triumph on which
      *                        calculation should be used.
      *                        Guymon will pay on the lot average
      *                        Triumph will not pay on the lot average
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3) AND c4
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   |- c4    : PAR.CDI Shipper User is Guymon
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFGT 0                          *IF
     C           YL0086    IFGE 75.00                      *IF
     C           YL0086    IFLE 100                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDYL0091    WN0396           ET Hot Wgt
     C                     MOVEL'LOT'     WN0405           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0114    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0396           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0396           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0406  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0406           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NGRVGN
     C                     MOVEL'CDB'     WN0406           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NHRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0396    IFGT 0                          *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0101    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR NIRVGN
     C                     Z-ADDYL0014    YL0128           Carcass Count U
     C                     Z-ADD*ZERO     YL0016           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0101    IFEQ 'B'                        *IF
     C           YL0014    SUB  YL0016    YL0128           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0116    WN0397           ET Backfat Thic
     C                     Z-ADDYL0117    WN0398           ET Loin-Eye Dep
     C                     Z-ADDYL0118    WN0404           ET Light Reflec
     C                     Z-ADDYL0115    WN0399           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0129           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0399    WQ0035  31       CD Lean Percent
     C                     PARM WN0397    WQ0036  31       CD Backfat Thic
     C                     PARM WN0398    WQ0037  31       CD Loin-Eye Dep
     C                     PARM WN0404    WQ0038  31       CD Light Reflec
     C           WN0400    PARM WN0400    WQ0039  31       CD Backfat Thic
     C           WN0401    PARM WN0401    WQ0040  31       CD Loin-Eye Dep
     C           WN0402    PARM WN0402    WQ0041  31       CD Light Reflec
     C           WN0403    PARM WN0403    WQ0042  31       CD Lean Percent
     C           YL0129    PARM YL0129    WQ0043  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0447  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0448  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0449  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0450  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0128    WN0450           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0450    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR NKRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR NLCRRC
     C                     SUB  1         WN0450           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0128    YL0100           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UGSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR NMRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR NNCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR NPCRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR NRCRRC
     C                     END                             *FI
     C                     MOVEL'Y'       YL0008           Hold Over Bal S
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P8WGST           Balance First D
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.TH Held Over is greater than 0
     C           P1H9NB    IFGT *ZERO                      *IF
      * LCL.Day of Week USR = PAR.TH Kill Date *DAY OF WEEK
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C           XDAY1     ADD  3         XDWK1   80
     C                     DIV  7         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     Z-ADD7         XDWK1
     C                     END
     C           XDAY1     SUB  XDWK1     XDAY2   60
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0109
      * LCL.Held Over Days USR = LCL.Kill Date Usr - PAR.TH Kill Date *DA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0108    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0110
     C                     ELSE
     C           XDURR     MULT -1        YL0110
     C                     END
      * Held Over Days > 1
      * CASE: LCL.Held Over Days USR is GT 1
     C           YL0110    IFGT 1                          *IF
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0044  30       CC Company Numb
     C                     PARM P1B0DT    WQ0045  70       Kill Date Usr
     C           YL0108    PARM *ZERO     WQ0046  70       Next Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * LCL.Day of Week USR = LCL.Kill Date Usr *DAY OF WEEK
     C           YL0108    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C           XDAY1     ADD  3         XDWK1   80
     C                     DIV  7         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     Z-ADD7         XDWK1
     C                     END
     C           XDAY1     SUB  XDWK1     XDAY2   60
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0109
      * CASE: LCL.Day of Week USR is Mon
     C           YL0109    IFEQ 1                          *IF
     C                     MOVEL'E'       YL0101           TH PHA Add Type
     C                     MOVEL'4'       YL0103           TH PHA Add Reas
      * Setup message data for message
      * Retrieve message Pay Note: Heldover
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0932' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR NTRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0113    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0113    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0102           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0120    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6ORMB    YL0114           PH GA Avg Live
     C                     Z-ADDP6G9PC    YL0104           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0105           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0118           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0115           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0119    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0451  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0452  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0453  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0454  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0455  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0456  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0457  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0458  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0459  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0460  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0121           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * 03/28/05 SLM TFP0001 -
      *                      - The payment on Hold Over for more then 1 d
      *                      - Triumph will need to pay on the Producer
      *                      - avg live weight.
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0102    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0460           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0102    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0460           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0102    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0460           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ 0                          *IF
     C           P1A7PC    ORGT 0                          *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * 03/28/05 SLM TFP0001 - Add the selection for Triumph on which
      *                        calculation should be used.
      *                        Guymon will pay on the lot average
      *                        Triumph will not pay on the lot average
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3) AND c4
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   |- c4    : PAR.CDI Shipper User is Guymon
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFGT 0                          *IF
     C           YL0086    IFGE 75.00                      *IF
     C           YL0086    IFLE 100                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDYL0091    WN0451           ET Hot Wgt
     C                     MOVEL'LOT'     WN0460           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0114    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0451           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0451           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0461  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0461           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NURVGN
     C                     MOVEL'CDB'     WN0461           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NVRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0451    IFGT 0                          *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0101    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR NWRVGN
     C                     Z-ADDYL0014    YL0128           Carcass Count U
     C                     Z-ADD*ZERO     YL0016           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0101    IFEQ 'B'                        *IF
     C           YL0014    SUB  YL0016    YL0128           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0116    WN0452           ET Backfat Thic
     C                     Z-ADDYL0117    WN0453           ET Loin-Eye Dep
     C                     Z-ADDYL0118    WN0459           ET Light Reflec
     C                     Z-ADDYL0115    WN0454           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0129           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0454    WQ0047  31       CD Lean Percent
     C                     PARM WN0452    WQ0048  31       CD Backfat Thic
     C                     PARM WN0453    WQ0049  31       CD Loin-Eye Dep
     C                     PARM WN0459    WQ0050  31       CD Light Reflec
     C           WN0455    PARM WN0455    WQ0051  31       CD Backfat Thic
     C           WN0456    PARM WN0456    WQ0052  31       CD Loin-Eye Dep
     C           WN0457    PARM WN0457    WQ0053  31       CD Light Reflec
     C           WN0458    PARM WN0458    WQ0054  31       CD Lean Percent
     C           YL0129    PARM YL0129    WQ0055  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0502  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0503  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0504  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0505  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0128    WN0505           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0505    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR NYRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR NZCRRC
     C                     SUB  1         WN0505           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0128    YL0100           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UISUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR OARVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR OBCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR ODCRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR OFCRRC
     C                     END                             *FI
     C                     MOVEL'Y'       YL0008           Hold Over Bal S
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *************************   PKD   *************************
      * CASE: PAR.TH Held Over Record is Yes
     C           P1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P8WGST           Balance First D
     C                     END                             *FI
      * 02/18/05 PKD COmmented out.
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.TH Held Over Record is Yes
     C           P1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P8WGST           Balance First D
     C                     END                             *FI
     C                     END                             *FI
      * Balance Held Over is Not > 1 Day and Not Held Overs
      * CASE: LCL.Hold Over Bal Sts USR is No
     C           YL0008    IFEQ 'N'                        *IF
      * Balance Tattoo
      * CASE: Not HO Tattoo| User Bal
      *  - c1 OR c4
      *   |- c1    : PAR.TH Held Over is *Zeros
      *   |- c4    : LCL.TH Bal to Kill Gen is User Requested Generated
      *   '-
     C           P1H9NB    IFEQ *ZERO                      *IF
     C           YL0006    OREQ 'U'                        *OR
      * 08/18/04 SLM HPEBAL - External and Internals Hogs with same
      *                       validation rules
      * *------- External and Internal Balance Rules -------*
      * Percent Identified & Percent Analyzed Parameter Balancing
      * CASE: LCL.Net Head Usr is GT Zero
     C           YL0014    IFGT *ZERO                      *IF
      * CASE: PAR.Bal w/History is Prior Week History
     C           P4VRST    IFEQ 'P'                        *IF
     C                     MOVELP5OQET    YL0101           TH PHA Add Type
     C                     MOVELP5USST    YL0103           TH PHA Add Reas
     C                     MOVELP5URST    YL0102           TH PHA Average
     C                     Z-ADDP6ORMB    YL0114           PH GA Avg Live
     C                     Z-ADDP6G9PC    YL0104           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0105           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0118           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0115           PH GA Avg Lean%
      * Setup message data for message
      * Convert Date USR to display format
      * Convert date
     C           1000000   ADD  *ZERO     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Retrieve message Pay Note: History
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0933' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      *
     C                     Z-ADD*ZERO     WN0506  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0507  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0508  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0509  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0510  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0511  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0512  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0513  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0514  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0515  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0121           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * 03/28/05 SLM TFP0001 -
      *                      - The payment on Hold Over for more then 1 d
      *                      - Triumph will need to pay on the Producer
      *                      - avg live weight.
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0102    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0515           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0102    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0515           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0102    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0515           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ 0                          *IF
     C           P1A7PC    ORGT 0                          *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * 03/28/05 SLM TFP0001 - Add the selection for Triumph on which
      *                        calculation should be used.
      *                        Guymon will pay on the lot average
      *                        Triumph will not pay on the lot average
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3) AND c4
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   |- c4    : PAR.CDI Shipper User is Guymon
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFGT 0                          *IF
     C           YL0086    IFGE 75.00                      *IF
     C           YL0086    IFLE 100                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDYL0091    WN0506           ET Hot Wgt
     C                     MOVEL'LOT'     WN0515           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0114    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0506           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0506           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0516  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0516           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR OHRVGN
     C                     MOVEL'CDB'     WN0516           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR OIRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0506    IFGT 0                          *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0101    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR OJRVGN
     C                     Z-ADDYL0014    YL0128           Carcass Count U
     C                     Z-ADD*ZERO     YL0016           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0101    IFEQ 'B'                        *IF
     C           YL0014    SUB  YL0016    YL0128           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0116    WN0507           ET Backfat Thic
     C                     Z-ADDYL0117    WN0508           ET Loin-Eye Dep
     C                     Z-ADDYL0118    WN0514           ET Light Reflec
     C                     Z-ADDYL0115    WN0509           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0129           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0509    WQ0056  31       CD Lean Percent
     C                     PARM WN0507    WQ0057  31       CD Backfat Thic
     C                     PARM WN0508    WQ0058  31       CD Loin-Eye Dep
     C                     PARM WN0514    WQ0059  31       CD Light Reflec
     C           WN0510    PARM WN0510    WQ0060  31       CD Backfat Thic
     C           WN0511    PARM WN0511    WQ0061  31       CD Loin-Eye Dep
     C           WN0512    PARM WN0512    WQ0062  31       CD Light Reflec
     C           WN0513    PARM WN0513    WQ0063  31       CD Lean Percent
     C           YL0129    PARM YL0129    WQ0064  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0557  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0558  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0559  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0560  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0128    WN0560           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0560    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR OLRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR OMCRRC
     C                     SUB  1         WN0560           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0128    YL0100           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UKSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR ONRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR OOCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.TH Percent Identified is GT 105%
     C           YL0085    IFGT 105.00                     *IF
     C                     MOVEL'E'       YL0101           TH PHA Add Type
     C                     MOVEL'2'       YL0103           TH PHA Add Reas
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR OQRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0113    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0113    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0102           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Setup message data for message
     C                     MOVELYL0102    ZA0004           TH PHA Average
      * Retrieve message Pay Note: >105 ID
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0934' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0120    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6ORMB    YL0114           PH GA Avg Live
     C                     Z-ADDP6G9PC    YL0104           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0105           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0118           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0115           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0119    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0561  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0562  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0563  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0564  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0565  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0566  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0567  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0568  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0569  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0570  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0121           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * 03/28/05 SLM TFP0001 -
      *                      - The payment on Hold Over for more then 1 d
      *                      - Triumph will need to pay on the Producer
      *                      - avg live weight.
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0102    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0570           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0102    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0570           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0102    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0570           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ 0                          *IF
     C           P1A7PC    ORGT 0                          *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * 03/28/05 SLM TFP0001 - Add the selection for Triumph on which
      *                        calculation should be used.
      *                        Guymon will pay on the lot average
      *                        Triumph will not pay on the lot average
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3) AND c4
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   |- c4    : PAR.CDI Shipper User is Guymon
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFGT 0                          *IF
     C           YL0086    IFGE 75.00                      *IF
     C           YL0086    IFLE 100                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDYL0091    WN0561           ET Hot Wgt
     C                     MOVEL'LOT'     WN0570           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0114    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0561           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0561           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0571  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0571           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR ORRVGN
     C                     MOVEL'CDB'     WN0571           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR OSRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0561    IFGT 0                          *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0101    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR OTRVGN
     C                     Z-ADDYL0014    YL0128           Carcass Count U
     C                     Z-ADD*ZERO     YL0016           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0101    IFEQ 'B'                        *IF
     C           YL0014    SUB  YL0016    YL0128           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0116    WN0562           ET Backfat Thic
     C                     Z-ADDYL0117    WN0563           ET Loin-Eye Dep
     C                     Z-ADDYL0118    WN0569           ET Light Reflec
     C                     Z-ADDYL0115    WN0564           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0129           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0564    WQ0065  31       CD Lean Percent
     C                     PARM WN0562    WQ0066  31       CD Backfat Thic
     C                     PARM WN0563    WQ0067  31       CD Loin-Eye Dep
     C                     PARM WN0569    WQ0068  31       CD Light Reflec
     C           WN0565    PARM WN0565    WQ0069  31       CD Backfat Thic
     C           WN0566    PARM WN0566    WQ0070  31       CD Loin-Eye Dep
     C           WN0567    PARM WN0567    WQ0071  31       CD Light Reflec
     C           WN0568    PARM WN0568    WQ0072  31       CD Lean Percent
     C           YL0129    PARM YL0129    WQ0073  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0612  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0613  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0614  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0615  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0128    WN0615           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0615    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR OVRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR OWCRRC
     C                     SUB  1         WN0615           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0128    YL0100           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UMSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR OXRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR OYCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR PACRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR PCCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.TH Percent Accepted is LT 75%
     C           YL0086    IFLT 75.00                      *IF
     C                     MOVEL'B'       YL0101           TH PHA Add Type
     C                     MOVEL'1'       YL0103           TH PHA Add Reas
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR PERVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0113    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0113    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0102           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Setup message data for message
     C                     MOVELYL0102    ZA0005           TH PHA Average
      * Retrieve message Pay Note: <75% Accepted
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0935' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0120    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6ORMB    YL0114           PH GA Avg Live
     C                     Z-ADDP6G9PC    YL0104           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0105           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0118           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0115           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0119    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0616  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0617  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0618  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0619  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0620  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0621  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0622  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0623  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0624  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0625  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0121           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * 03/28/05 SLM TFP0001 -
      *                      - The payment on Hold Over for more then 1 d
      *                      - Triumph will need to pay on the Producer
      *                      - avg live weight.
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0102    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0625           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0102    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0625           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0102    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0625           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ 0                          *IF
     C           P1A7PC    ORGT 0                          *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * 03/28/05 SLM TFP0001 - Add the selection for Triumph on which
      *                        calculation should be used.
      *                        Guymon will pay on the lot average
      *                        Triumph will not pay on the lot average
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3) AND c4
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   |- c4    : PAR.CDI Shipper User is Guymon
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFGT 0                          *IF
     C           YL0086    IFGE 75.00                      *IF
     C           YL0086    IFLE 100                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDYL0091    WN0616           ET Hot Wgt
     C                     MOVEL'LOT'     WN0625           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0114    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0616           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0616           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0626  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0626           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PFRVGN
     C                     MOVEL'CDB'     WN0626           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PGRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0616    IFGT 0                          *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0101    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR PHRVGN
     C                     Z-ADDYL0014    YL0128           Carcass Count U
     C                     Z-ADD*ZERO     YL0016           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0101    IFEQ 'B'                        *IF
     C           YL0014    SUB  YL0016    YL0128           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0116    WN0617           ET Backfat Thic
     C                     Z-ADDYL0117    WN0618           ET Loin-Eye Dep
     C                     Z-ADDYL0118    WN0624           ET Light Reflec
     C                     Z-ADDYL0115    WN0619           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0129           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0619    WQ0074  31       CD Lean Percent
     C                     PARM WN0617    WQ0075  31       CD Backfat Thic
     C                     PARM WN0618    WQ0076  31       CD Loin-Eye Dep
     C                     PARM WN0624    WQ0077  31       CD Light Reflec
     C           WN0620    PARM WN0620    WQ0078  31       CD Backfat Thic
     C           WN0621    PARM WN0621    WQ0079  31       CD Loin-Eye Dep
     C           WN0622    PARM WN0622    WQ0080  31       CD Light Reflec
     C           WN0623    PARM WN0623    WQ0081  31       CD Lean Percent
     C           YL0129    PARM YL0129    WQ0082  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0667  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0668  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0669  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0670  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0128    WN0670           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0670    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR PJRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR PKCRRC
     C                     SUB  1         WN0670           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0128    YL0100           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UOSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR PLRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR PMCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR POCRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR PQCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE:  75% <= Pct Analyzed < 100%
      *  - c1 AND c2
      *   |- c1    : LCL.TH Percent Analyzed is GE 75%
      *   |- c2    : LCL.TH Percent Analyzed is LT 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0086    IFGE 75.00                      *IF
     C           YL0086    IFLT 100.00                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0671  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0672  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0673  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0674  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0675  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0676  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0677  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0678  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0679  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0680  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/AVG  IF
     C           YL0014    SUB  YL0016    YL0135           Carcass Count U
     C                     MOVEL'ADD'     WN0680           ET Adjust/Add T
     C                     Z-ADDYL0092    WN0671           ET Hot Wgt
     C                     Z-ADDYL0094    WN0672           ET Backfat Thic
     C                     Z-ADDYL0095    WN0673           ET Loin-Eye Dep
     C                     Z-ADDYL0096    WN0679           ET Light Reflec
     C                     Z-ADDYL0097    WN0674           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
      * * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      * *             Hot Weight range.  If the Hot Weight not within ran
      * *             then do not add carcasses and mark the tattoo with
      * *             error.
      *
     C                     MOVEL*BLANK    WN0681  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0681           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PSRVGN
     C                     MOVEL'CDB'     WN0681           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PTRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ET Hot Wgt GE LCL.EV Minimum
      *   |- c2    : PAR.ET Hot Wgt LE LCL.EV Maximum
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0671    IFGE YL0136                     *IF
     C           WN0671    IFLE YL0137                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0138           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0674    WQ0083  31       CD Lean Percent
     C                     PARM WN0672    WQ0084  31       CD Backfat Thic
     C                     PARM WN0673    WQ0085  31       CD Loin-Eye Dep
     C                     PARM WN0679    WQ0086  31       CD Light Reflec
     C           WN0675    PARM WN0675    WQ0087  31       CD Backfat Thic
     C           WN0676    PARM WN0676    WQ0088  31       CD Loin-Eye Dep
     C           WN0677    PARM WN0677    WQ0089  31       CD Light Reflec
     C           WN0678    PARM WN0678    WQ0090  31       CD Lean Percent
     C           YL0138    PARM YL0138    WQ0091  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/28/04 SLM HPEBAL Populate the new parm on the et adjust/add
      *
     C                     MOVEL*BLANK    WN0682  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0683  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0684  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0685  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0135    WN0685           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0685    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR PURVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR PVCRRC
     C                     SUB  1         WN0685           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0135    YL0017           TH Head Adds
      * Accumulate Totals
     C                     EXSR UPSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR PWCRRC
     C                     END                             *FI
      * Setup message data for message
      * Retrieve message Pay Note: >75% Accepted
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0938' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: >75% Accepted2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0949' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
     C                     ELSE
      * CASE: 100% < Pct Analyzed <= 105%
      *  - c1 AND c2
      *   |- c1    : LCL.TH Percent Analyzed is GT 100%
      *   |- c2    : LCL.TH Percent Analyzed is LE 105%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0086    IFGT 100.00                     *IF
     C           YL0086    IFLE 105.00                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Bal Eval Trans w/EXC  IF
      * *** 9/17/2018 slm
      * Modification History
     C                     EXSR UQSUBR                     Modification Hi
     C           YL0014    SUB  YL0016    YL0142           Carcass Count U
      * CASE: LCL.Carcass Count USR is NE Zero
     C           YL0142    IFNE 0                          *IF
     C                     MULT -1        YL0142           Carcass Count U
      * *** 9/17/2018 slm
      * *** 9/17/2018 Change RTV to use lf -- no errors
      * Bal Eval Trans w/EXC  RT - Eval Trans  * 
     C                     EXSR PYRVGN
      * 4/5/04 RMC Delete carcs in reverse order if necessary to meet car
      * CASE: LCL.Count USR LT LCL.Carcass Count USR
     C           YL0143    IFLT YL0142                     *IF
      * Bal Eval Trans w/EXC2 RT - Eval Trans  * 
     C                     EXSR QARVGN
     C                     END                             *FI
      * Subtract from Totals
     C                     EXSR URSUBR                     Subtract from T
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     END                             *FI
      * Setup message data for message
      * Retrieve message Pay Note: >100% <105%
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0939' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: >100% <105% 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0940' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: >100% <105% 3
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0950' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *---------------------------------------------------*
      * 08/18/04 SLM HPEBAL - External process * out
      * Re-Calculate Tattoo Header Averages/yield
     C                     EXSR USSUBR                     Re-Calculate Ta
      * Upd Val Kill Trans    RT - Tattoo Header  * 
     C                     EXSR QCRVGN
      * 05/28/04 SLM HPEBAL - Chg object was * out to removed for clean u
      *                       * out in 12/01, the UPD above looks like it
      *                       replace the chg object.
      * 05/28/04 SLM HPEBAL - Add new condition of RECALC
      *                       for the Yield Parameter Balancing
      *                       * out old case and copied new case
      * 08/18/04 SLM HPEBAL - External and Internals Hogs with same
      *                       validation rules --- Yeilds
      * Extrnl or Int:  Yield Parameter Balancing
      * CASE: NetHead>Zero/Bal w History=none/Rlw = 0
      *  - c2 AND c3 AND c4
      *   |- c2    : LCL.Net Head Usr is GT Zero
      *   |- c3    : PAR.Bal w/History is *None
      *   |- c4    : PAR.TH Recalc Live Wgt is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0014    IFGT *ZERO                      *IF
     C           P4VRST    IFEQ *BLANK                     *IF
     C           P1A7PC    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 05/27/04 SLM HPEBAL Added the above check on Recalc live weight
      * Re-Calculate for Held Overs: Adj Yield%
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : PAR.TH Held Over Record is Yes
      *   |- c2    : LCL.TH Bal to Kill Gen is User Requested Generated
      *   |- c3    : PAR.TH Held Over is greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0006    IFEQ 'U'                        *IF
     C           P1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** WRK is accumulated values, LCL is for current record. **
      *    We will overlay the LCL values of current record with both
      *    days combined.
      * Combine the two days for hold over.
      * Rtv Tot Hd ID/Anl/Net RT - Tattoo Header  * 
     C                     EXSR QERVGN
      * WRK.Net Head Usr
      * WRK.Net Head Usr =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : WRK.TH Head Received
      * -     : PGM.*Synon (15,0) work field
      * x2    : WRK.TH Yard Deads
      * -     : PGM.*Synon (15,0) work field
      * x3    : WRK.TH Head Condemned
     C           WUCWNB    SUB  WUFCNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WUFDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUF6NB           Net Head Usr
      * WRK.Adj Live Weight
      * CASE: WRK.TH Head Received EQ WRK.Net Head Usr
     C           WUCWNB    IFEQ WUF6NB                     *IF
      * CASE: WRK.Net Head Usr NE WRK.TH Head Killed
     C           WUF6NB    IFNE WUFENB                     *IF
     C           WUF6NB    SUB  WUFENB    WUZANB           Net Head Adjust
     C           WUZANB    MULT P1F7NB    YL0089           *Synon (15,2) w
     C           WUCYNB    SUB  YL0089    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCYNB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Net Head Usr EQ LCL.Zero USR
     C           WUF6NB    IFEQ YL0088                     *IF
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
      * WRK.Net Head Adjusted Usr
      * WRK.Net Head Adjusted Usr =
      *    *COMPUTE (x1 + x2)
      * x1    : WRK.TH Head Condemned
      * +     : PGM.*Synon (15,0) work field
      * x2    : WRK.TH Yard Deads
     C           WUFDNB    ADD  WUFCNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUZANB           Net Head Adjust
      * CASE: WRK.Net Head Usr NE WRK.TH Head Killed
     C           WUF6NB    IFNE WUFENB                     *IF
     C           WUF6NB    SUB  WUFENB    WUZANB           Net Head Adjust
     C                     END                             *FI
     C           WUZANB    MULT P1F7NB    YL0089           *Synon (15,2) w
     C           WUCYNB    SUB  YL0089    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     END                             *FI
      * wrk.Adj Actual Yield
      * CASE: WRK.TH Adj Live Wgt NE LCL.Zero USR
     C           WULRNB    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * WRK.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  WULRNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCWPC           TH Adj Actual Y
     C                     Z-ADDWUCWPC    YL0106           TH Yld Parm Adj
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0090    WUCWPC           TH Adj Actual Y
     C                     Z-ADDWUCWPC    YL0106           TH Yld Parm Adj
     C                     END                             *FI
      * Validate Low and High Yield.
      * CASE: High Yield Min < Adj Yield < Low Yield Max
      *  - c1 OR c2
      *   |- c1    : WRK.TH Adj Actual Yield % GT PAR.High Yield Min
      *   |- c2    : WRK.TH Adj Actual Yield % LT PAR.Low Yield Max
      *   '-
     C           WUCWPC    IFGT P2JDNB                     *IF
     C           WUCWPC    ORLT P2JGNB                     *OR
     C                     MOVEL'E'       YL0101           TH PHA Add Type
     C                     MOVEL'3'       YL0103           TH PHA Add Reas
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR QFRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0113    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0113    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0102           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0102           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Setup message data for message
     C                     Z-ADDYL0106    ZA0006           TH Yld Parm Adj
     C                     MOVELYL0102    ZA0007           TH PHA Average
      * Retrieve message Pay Note: Yield Parm
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0936' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
     C                     Z-ADDYL0106    ZA0008           TH Yld Parm Adj
     C                     MOVELYL0102    ZA0009           TH PHA Average
      * Retrieve message Pay Note: Yield Parm 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0937' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
     C                     Z-ADDYL0106    ZA0010           TH Yld Parm Adj
     C                     MOVELYL0102    ZA0011           TH PHA Average
      * Retrieve message Pay Note: Yield Parm 3
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0951' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0120    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6ORMB    YL0114           PH GA Avg Live
     C                     Z-ADDP6G9PC    YL0104           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0105           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0118           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0115           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0119    MULT 100       YL0107    H      TH PHA Sort Dis
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0896  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0897  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0898  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0899  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0900  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0901  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0902  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0903  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0904  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0905  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0121           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * 03/28/05 SLM TFP0001 -
      *                      - The payment on Hold Over for more then 1 d
      *                      - Triumph will need to pay on the Producer
      *                      - avg live weight.
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0102    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0905           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0102    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0905           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0102    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0905           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ 0                          *IF
     C           P1A7PC    ORGT 0                          *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * 03/28/05 SLM TFP0001 - Add the selection for Triumph on which
      *                        calculation should be used.
      *                        Guymon will pay on the lot average
      *                        Triumph will not pay on the lot average
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3) AND c4
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   |- c4    : PAR.CDI Shipper User is Guymon
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFGT 0                          *IF
     C           YL0086    IFGE 75.00                      *IF
     C           YL0086    IFLE 100                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDYL0091    WN0896           ET Hot Wgt
     C                     MOVEL'LOT'     WN0905           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0114    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0896           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0122    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0123    WL0006           THC Comment Lin
     C                     MOVELYL0122    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0123           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0104    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0124    H      *Synon (15,1) w
     C                     Z-ADDYL0124    WN0896           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0906  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0906           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR QGRVGN
     C                     MOVEL'CDB'     WN0906           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR QHRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0896    IFGT 0                          *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0101    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR QIRVGN
     C                     Z-ADDYL0014    YL0128           Carcass Count U
     C                     Z-ADD*ZERO     YL0016           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0101    IFEQ 'B'                        *IF
     C           YL0014    SUB  YL0016    YL0128           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0116    WN0897           ET Backfat Thic
     C                     Z-ADDYL0117    WN0898           ET Loin-Eye Dep
     C                     Z-ADDYL0118    WN0904           ET Light Reflec
     C                     Z-ADDYL0115    WN0899           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0129           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0899    WQ0092  31       CD Lean Percent
     C                     PARM WN0897    WQ0093  31       CD Backfat Thic
     C                     PARM WN0898    WQ0094  31       CD Loin-Eye Dep
     C                     PARM WN0904    WQ0095  31       CD Light Reflec
     C           WN0900    PARM WN0900    WQ0096  31       CD Backfat Thic
     C           WN0901    PARM WN0901    WQ0097  31       CD Loin-Eye Dep
     C           WN0902    PARM WN0902    WQ0098  31       CD Light Reflec
     C           WN0903    PARM WN0903    WQ0099  31       CD Lean Percent
     C           YL0129    PARM YL0129    WQ0100  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0947  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0948  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0949  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0950  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0128    WN0950           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0950    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR QKRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR QLCRRC
     C                     SUB  1         WN0950           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0128    YL0100           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UVSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR QMRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR QNCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * PHA Not Avail
     C                     EXSR QPCRRC
      * Create Kill Validation - Eval/Loss Error  * Yield Error
     C                     EXSR QRCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR QTCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Re-Calculate Tattoo Header Averages/yield
     C                     EXSR UWSUBR                     Re-Calculate Ta
     C                     END                             *FI
      * ***********
      * 05/27/04 PKD HPEBAL - Retrieve Yield for Recalculate Live Weight
      *                       if Tattoo Header value is zero and recalc
      *                       live wieght is 1 for External Producer only
      * 08/13/04 PKD Moved creating of the comment out from the PHA
      *              processing.  The comment needs to exist for all
      *              types of balancing, not just at history.
      * Recalc Live Weight
      * CASE: PAR.TH Recalc Live Wgt is Greater than 0
     C           P1A7PC    IFGT *ZERO                      *IF
      * CASE: PAR.TH Source Type is Internal
     C           P1KAST    IFEQ 'I'                        *IF
      *    *** On Internal ** Live Weight Based on Seaboard Formula
      * Setup message data for message
      * Retrieve message Pay Note: LW Formula
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1114' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      *    *** External  **   Live Weight Based on producers historical
      *                       adjusted yeild
      * Setup message data for message
      * Retrieve message Pay Note: LW Hst Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1115' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: LW Hst Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1121' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0111    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0112    WL0006           THC Comment Lin
     C                     MOVELYL0111    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0112           THC Comment Lin
      * Recalc Live Weight Yield Percent
      * CASE: LCL.TH Recalc Live Wgt Yld is EQ 0
     C           YL0009    IFEQ 0                          *IF
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR QVRVGN
      * CASE: LCL.PH GA Adjusted Yield% is ne 0
     C           YL0145    IFNE *ZERO                      *IF
     C                     Z-ADDYL0145    YL0009           TH Recalc Live
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR QWCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Kill Balancing Status
      * CASE: LCL.TH Kill Balancing Sts is Error
     C           YL0004    IFEQ 'E'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.TH Head Killed is *Zeros
     C           YL0016    IFEQ *ZERO                      *IF
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     ELSE
      * CASE: LCL.TH Head Killed EQ LCL.Net Head Usr
     C           YL0016    IFEQ YL0014                     *IF
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     ELSE
      * CASE: LCL.TH Head Killed NE LCL.Net Head Usr
     C           YL0016    IFNE YL0014                     *IF
     C                     MOVEL'E'       YL0004           TH Kill Balanci
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Paid Entire Tattoo w/PHA
      * CASE: LCL.TH PHA Add Type is Entire Tattoo
     C           YL0101    IFEQ 'E'                        *IF
     C                     Z-ADD*ZERO     YL0017           TH Head Adds
     C                     Z-ADD*ZERO     YL0025           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0023           TH Head Exclude
     C                     END                             *FI
      * Upd Val Kill Trans    RT - Tattoo Header  * 
     C                     EXSR QYRVGN
      * If Internal, and balanced change the TD Ext complete status to Ye
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.TH Kill Balancing Sts is Balance
      *   |- c2    : PAR.TH Tattoo Number is Internals
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFEQ 'B'                        *IF
     C           P1CVNB    IFGE 7000                       *IF
     C           P1CVNB    ANDLE7999
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RtvChg Td Cmpl Sts     RT - Tattoo Detail Ext  * 
     C                     EXSR RARVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NACRRC    BEGSR
      *================================================================
      * Crt Tattoo Hdr Cmnt   CR - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A4CPC3
     C                     Z-ADDWL0001    WFHMNB           BOH Company Num
     C                     Z-ADDWL0002    WFBNNB           BOH Buy Order N
     C                     Z-ADDWL0003    WFBONB           BOL Load Number
     C                     Z-ADDWL0004    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWL0005    WFB0DT           TH Kill Date
     C                     Z-ADDWL0006    WFBETX           THC Comment Lin
     C                     MOVELWL0007    WFBFTX           THC Comment
     C                     MOVELWL0008    WFETST           THC Comment Typ
     C                     MOVELWL0009    WFAAVN           RS User Changed
     C                     Z-ADDWL0010    WFAADT           RS Date Changed
     C                     Z-ADDWL0011    WFAMTM           RS Time Changed
     C                     MOVELWL0012    WFAJST           RS Record Statu
     C                     MOVELWL0013    WFAHVN           RS Job
     C                     MOVELWL0014    WFAGVN           RS Program
     C                     MOVELWL0015    WFABVN           RS User Added
     C                     Z-ADDWL0016    WFABDT           RS Date Added
     C                     Z-ADDWL0017    WFABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WFAJST           RS Record Statu
     C                     MOVEL##USR     WFABVN           RS User Added
     C                     Z-ADD##JDT     WFABDT           RS Date Added
     C                     Z-ADD##JTM     WFABTM           RS Time Added
     C                     MOVEL##PGM     WFAGVN           RS Program
     C                     MOVEL##JOB     WFAHVN           RS Job
     C           KLCRNA    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBETX           THC Comment Lin
      * Check for duplicate primary key
     C           KLCRNA    SETLL@A4CPC3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0068' W0RTN   7
      * Send message 'Tattoo Header Comment  EX'
     C                     MOVEL'PRK0068' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C                     WRITE@A4CPC3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Upd Val Kill Trans    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WIHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WIBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WIB0DT           TH Kill Date
      * Establish starting position
     C           KRSNB     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Val Kill Trans    CH - Tattoo Header  * 
     C                     EXSR NCCHRC
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCCHRC    BEGSR
      *================================================================
      * Chg Val Kill Trans    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0266  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0267 10        TH Group Refere
     C                     MOVEL*BLANK    WN0268  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0269  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0270  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0271  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0272  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0273  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0274  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0275  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0276  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0277  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0278  50       TH Held Over
     C                     Z-ADD*ZERO     WN0279  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0280  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0281  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0282  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0283  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0284  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0285  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0286  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0287  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0288  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0289  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0290  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0291  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0292  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0293  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0294  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0295  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0296  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0297  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0298  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0299  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0300  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0301  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0302  2        TH Payment Sts
     C                     Z-ADD*ZERO     WN0303  80       TH Commission A
     C                     Z-ADD*ZERO     WN0304  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0305  1        TH User Error O
     C                     MOVEL*BLANK    WN0306  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0307  1        TH Sex
     C                     Z-ADD*ZERO     WN0308  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0309  70       TH Commission P
     C                     Z-ADD*ZERO     WN0310  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0311  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0312  31       TH FFLI
     C                     Z-ADD*ZERO     WN0313  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0314  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0315  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0316  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0317  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0318  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0319  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0320  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0321  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0322  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0323  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0324  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0325  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0326  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0327  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0328  1        TH Source Type
     C                     MOVEL*BLANK    WN0329  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0330  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0331  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0332  3        TH Source Code
     C                     MOVEL*BLANK    WN0333  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0334  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0335  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0336  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0337  3        TH State
     C                     MOVEL*BLANK    WN0338  3        TH Unused Code
     C                     MOVEL*BLANK    WN0339  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0340  1        TH Commission S
     C                     MOVEL*BLANK    WN0341  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0342  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0343  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0344  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0345  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0346  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0347  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0348  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0349  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0350  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0351  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0352  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0353  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0354  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0355  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0356  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0357 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0358 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0359 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0360 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0361  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0362  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0363  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0364  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0365  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0366  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0367  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0368  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0369  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0370  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0371  70       TH Unused Date
     C                     MOVEL*BLANK    WN0372  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0373  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0374  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0375  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0376  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0377  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0378  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0379  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0380  6        DF Defect Code
     C                     MOVEL*BLANK    WN0381  6        THP Process Cod
     C                     MOVEL*BLANK    WN0382  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0383  6        PL Location Cod
     C                     MOVEL*BLANK    WN0384  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0385  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0386  3        HC Class Code
     C                     MOVEL*BLANK    WN0387 10        RS User Changed
     C                     Z-ADD*ZERO     WN0388  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0389  60       RS Time Changed
     C                     MOVEL*BLANK    WN0390  1        RS Record Statu
     C                     MOVEL*BLANK    WN0391 10        RS Job
     C                     MOVEL*BLANK    WN0392 10        RS Program
     C                     MOVEL*BLANK    WN0393 10        RS User Added
     C                     Z-ADD*ZERO     WN0394  70       RS Date Added
     C                     Z-ADD*ZERO     WN0395  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWIHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWIBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWIBONB    WKBONB           BOL Load Number
     C                     Z-ADDWICVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WKB0DT           TH Kill Date
      *
     C           KLCHNC    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C           KLCHNC    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YHRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0009    WKAIPR           TH Recalc Live
     C                     Z-ADDYL0011    WKFDNB           TH Head Condemn
     C                     Z-ADDYL0016    WKFENB           TH Head Killed
     C                     Z-ADDYL0017    WKHENB           TH Head Adds
     C                     Z-ADDYL0018    WKHFNB           TH Head Accepte
     C                     Z-ADDYL0087    WKLRNB           TH Adj Live Wgt
     C                     Z-ADDYL0019    WKE0NB           TH Hot Wgt
     C                     Z-ADDYL0020    WKA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0021    WKFBNB           TH Tot Backfat
     C                     Z-ADDYL0022    WKA4PC           TH Tot Light Re
     C                     Z-ADDYL0091    WKHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0096    WKF5NB           TH Avg Light Re
     C                     Z-ADDYL0093    WKF4NB           TH Avg Lean Per
     C                     Z-ADDYL0095    WKF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0094    WKF2NB           TH Avg Backfat
     C                     Z-ADDYL0098    WKAWPC           TH Actual Yield
     C                     Z-ADDYL0090    WKCWPC           TH Adj Actual Y
     C                     Z-ADDYL0099    WKA2PR           TH Fixed Cost A
     C                     MOVELYL0002    WKD7ST    P      TH Header Error
     C                     MOVELYL0003    WKD8ST    P      TH Detail Error
     C                     MOVELYL0004    WKDWST    P      TH Kill Balanci
     C                     MOVELYL0006    WKD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0092    WKHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0023    WKJ9NB           TH Head Exclude
     C                     Z-ADDYL0097    WKT2WT           TH Avg Lean % E
     C                     Z-ADDYL0024    WKKOER           TH Head Identif
     C                     Z-ADDYL0085    WKOPIR           TH Percent Iden
     C                     Z-ADDYL0086    WKOPEM           TH Percent Acce
     C                     Z-ADDYL0025    WKIORP           TH Head Adjuste
     C                     Z-ADDYL0100    WKOWEO           TH PHA Head Add
     C                     MOVELYL0101    WKOQET    P      TH PHA Add Type
     C                     MOVELYL0102    WKURST    P      TH PHA Average
     C                     MOVELYL0103    WKUSST    P      TH PHA Add Reas
     C                     Z-ADDYL0104    WKHHPC           TH PHA Yield Pe
     C                     Z-ADDYL0105    WKS9PR           TH PHA Lean Prm
     C                     Z-ADDYL0106    WKORJK           TH Yld Parm Adj
     C                     Z-ADDYL0107    WKOMVJ           TH PHA Sort Dis
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Tot Hd ID/Anl/Net RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WUCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUKOER           TH Head Identif
     C                     Z-ADD*ZERO     WUJONB           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     WUL0NB           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     WUL1NB           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     WUL2NB           Hot Wgt/LghtR A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXHMNB    WQND01           BOH Company Num
     C           *LIKE     DEFN WXBNNB    WQND02           BOH Buy Order N
     C           *LIKE     DEFN WXBONB    WQND03           BOL Load Number
     C           *LIKE     DEFN WXCVNB    WQND04           TH Tattoo Numbe
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           BOH Company Num
     C                     KFLD           WQND02           BOH Buy Order N
     C                     KFLD           WQND03           BOL Load Number
     C                     KFLD           WQND04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQND01           BOH Company Num
     C                     Z-ADDP1BNNB    WQND02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQND03           BOL Load Number
     C                     Z-ADDP1CVNB    WQND04           TH Tattoo Numbe
      * Establish starting position
     C           KRSND     SETLL@A1CPC7                    *
     C           KRSND     READE@A1CPC7                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WXCWNB    WUCWNB           TH Head Receive
     C                     ADD  WXFCNB    WUFCNB           TH Yard Deads
     C                     ADD  WXFDNB    WUFDNB           TH Head Condemn
     C                     ADD  WXFENB    WUFENB           TH Head Killed
     C                     ADD  WXHFNB    WUHFNB           TH Head Accepte
     C                     ADD  WXKOER    WUKOER           TH Head Identif
     C                     ADD  WXCYNB    WUCYNB           TH Live Wgt
     C                     ADD  WXE0NB    WUE0NB           TH Hot Wgt
      * Hot Wgt/Lean % Accum USR
      * PAR.Hot Wgt/Lean % Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Lean % Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Lean Percent
     C           WXE0NB    MULT WXF4NB    W0WA01           *Synon (15,2) w
     C           WUJONB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUJONB           Hot Wgt/Lean %
      * Hot Wgt/Backf Accum USR
      * PAR.Hot Wgt/Backf Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Backf Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Backfat
     C           WXE0NB    MULT WXF2NB    W0WA01           *Synon (15,2) w
     C           WUL0NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUL0NB           Hot Wgt/Backf A
      * Hot Wgt/Loine Accum Usr
      * PAR.Hot Wgt/Loine Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Loine Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Loin Eye Depth
     C           WXE0NB    MULT WXF3NB    W0WA01           *Synon (15,2) w
     C           WUL1NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUL1NB           Hot Wgt/Loine A
      * Hot Wgt/LghtR Accum Usr
      * PAR.Hot Wgt/LghtR Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/LghtR Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Light Reflectance
     C           WXE0NB    MULT WXF5NB    W0WA01           *Synon (15,2) w
     C           WUL2NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUL2NB           Hot Wgt/LghtR A
     C           KRSND     READE@A1CPC7                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv Held Over KillDt  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQNE01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQNE02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQNE03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQNE04           TH Tattoo Numbe
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE01           BOH Company Num
     C                     KFLD           WQNE02           BOH Buy Order N
     C                     KFLD           WQNE03           BOL Load Number
     C                     KFLD           WQNE04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNE01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNE02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNE03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNE04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNE     SETLL@A1CPC4                    *
     C           KRSNE     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date NE PAR.Kill Date 1 Usr
     C           WIB0DT    IFNE P1B0DT                     *IF
     C                     Z-ADDWIB0DT    YL0108           Kill Date Usr
     C                     GOTO NEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNE     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0113           PH Summary Type
     C                     Z-ADD*ZERO     YL0114           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0104           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0115           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0116           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0117           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0118           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0105           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0119           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0120           History Avail S
     C                     MOVEL'N'       YL0120           History Avail S
     C                     MOVEL'Y'       YL0070           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY3A1    WQNF01           PH Company Numb
     C           *LIKE     DEFN WTABCD    WQNF02           PD Producer Cod
      * Define keylist
     C           KPSNF     KLIST
     C                     KFLD           WQNF01           PH Company Numb
     C                     KFLD           WQNF02           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           PH Company Numb
     C                     KFLD           WQNF02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQNF01           PH Company Numb
     C                     MOVELP1ABCD    WQNF02           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSNF     SETLL@CGCPEJ                    *
     C           KRSNF     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0070    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0071           PH Week Ending
     C                     MOVEL'N'       YL0070           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0071                     *IF
     C                     GOTO NFEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO NFEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO NFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNF     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0406    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNG     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0125           EV Maximum
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0125           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0406    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNH     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0126           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0126           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQNI01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQNI02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQNI03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQNI04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQNI05           TH Kill Date
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WQNI01           BOH Company Num
     C                     KFLD           WQNI02           BOH Buy Order N
     C                     KFLD           WQNI03           BOL Load Number
     C                     KFLD           WQNI04           TH Tattoo Numbe
     C                     KFLD           WQNI05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNI01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNI02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNI03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNI04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQNI05           TH Kill Date
      * Establish starting position
     C           KRSNI     SETLL@BVCPQ9                    *
     C           KRSNI     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR NJCHRC
      * Subtract from Totals
     C                     EXSR UFSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSNI     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0407  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0408  50       ET Lot
     C                     MOVEL*BLANK    WN0409  1        ET Shift
     C                     Z-ADD*ZERO     WN0410  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0411  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0412  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0413  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0414  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0415  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0416  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0417  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0418  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0419  1        ET Trim Area
     C                     MOVEL*BLANK    WN0420  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0421  1        ET Error Sts
     C                     MOVEL*BLANK    WN0422  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0423  1        ET Record Creat
     C                     MOVEL*BLANK    WN0424  1        ET Record Creat
     C                     MOVEL*BLANK    WN0425  1        ET User Error O
     C                     MOVEL*BLANK    WN0426  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0427  1        ET Broken Back
     C                     MOVEL*BLANK    WN0428  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0429  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0430  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0431  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0432  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0433  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0434  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0435  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0436  70       TH Kill Date
     C                     MOVEL*BLANK    WN0437 10        RS User Changed
     C                     Z-ADD*ZERO     WN0438  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0439  60       RS Time Changed
     C                     MOVEL*BLANK    WN0440 10        RS Job
     C                     MOVEL*BLANK    WN0441 10        RS Program
     C                     MOVEL*BLANK    WN0442 10        RS User Added
     C                     Z-ADD*ZERO     WN0443  70       RS Date Added
     C                     Z-ADD*ZERO     WN0444  60       RS Time Added
     C                     Z-ADD*ZERO     WN0445  70       RU Date
     C                     Z-ADD*ZERO     WN0446  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHNJ    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YIRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQNK01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQNK02           ET Kill Date
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WQNK01           ET Company Numb
     C                     KFLD           WQNK02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNK01           ET Company Numb
     C                     Z-ADDP1B0DT    WQNK02           ET Kill Date
      * Establish starting position
     C           KRSNK     SETLL@BVCPNE                    *
     C           KRSNK     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0130           ET Scale Sequen
     C                     GOTO NKEXIT                     *QUIT
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0130           ET Scale Sequen
     C                     GOTO NKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNK     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0130    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0130    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0396    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0397    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0398    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0399    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0400    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0401    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0402    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0403    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0404    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0405    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0447    WDVIST           ET Unused Sts 2
     C                     MOVELYL0131    WDVJST           ET Adjust/Add S
     C                     MOVELWN0448    WDVKST           ET Unused Sts 4
     C                     MOVELWN0449    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRNL    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRNL    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQNM01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQNM02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQNM03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQNM04           TH Tattoo Numbe
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WQNM01           BOH Company Num
     C                     KFLD           WQNM02           BOH Buy Order N
     C                     KFLD           WQNM03           BOL Load Number
     C                     KFLD           WQNM04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNM01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNM02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNM03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNM04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNM     SETLL@A1CPC4                    *
     C           KRSNM     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,004   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0133    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,004   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR NORVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRNN    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRNN    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNO     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,005   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,005   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR NQRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRNP    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRNP    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNQ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PID'     WBDXST           KV Error Code
     C                     MOVEL@CN,006   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,006   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR NSRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRNR    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRNR    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NREXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PID'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNS     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0113           PH Summary Type
     C                     Z-ADD*ZERO     YL0114           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0104           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0115           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0116           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0117           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0118           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0105           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0119           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0120           History Avail S
     C                     MOVEL'N'       YL0120           History Avail S
     C                     MOVEL'Y'       YL0070           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY3A1    WQNT01           PH Company Numb
     C           *LIKE     DEFN WTABCD    WQNT02           PD Producer Cod
      * Define keylist
     C           KPSNT     KLIST
     C                     KFLD           WQNT01           PH Company Numb
     C                     KFLD           WQNT02           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT01           PH Company Numb
     C                     KFLD           WQNT02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQNT01           PH Company Numb
     C                     MOVELP1ABCD    WQNT02           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSNT     SETLL@CGCPEJ                    *
     C           KRSNT     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0070    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0071           PH Week Ending
     C                     MOVEL'N'       YL0070           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0071                     *IF
     C                     GOTO NTEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO NTEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO NTEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNT     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0461    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNU     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0125           EV Maximum
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0125           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0461    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNV     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0126           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0126           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQNW01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQNW02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQNW03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQNW04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQNW05           TH Kill Date
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           WQNW01           BOH Company Num
     C                     KFLD           WQNW02           BOH Buy Order N
     C                     KFLD           WQNW03           BOL Load Number
     C                     KFLD           WQNW04           TH Tattoo Numbe
     C                     KFLD           WQNW05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNW01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNW02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNW03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNW04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQNW05           TH Kill Date
      * Establish starting position
     C           KRSNW     SETLL@BVCPQ9                    *
     C           KRSNW     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR NXCHRC
      * Subtract from Totals
     C                     EXSR UHSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSNW     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0462  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0463  50       ET Lot
     C                     MOVEL*BLANK    WN0464  1        ET Shift
     C                     Z-ADD*ZERO     WN0465  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0466  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0467  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0468  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0469  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0470  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0471  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0472  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0473  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0474  1        ET Trim Area
     C                     MOVEL*BLANK    WN0475  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0476  1        ET Error Sts
     C                     MOVEL*BLANK    WN0477  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0478  1        ET Record Creat
     C                     MOVEL*BLANK    WN0479  1        ET Record Creat
     C                     MOVEL*BLANK    WN0480  1        ET User Error O
     C                     MOVEL*BLANK    WN0481  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0482  1        ET Broken Back
     C                     MOVEL*BLANK    WN0483  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0484  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0485  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0486  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0487  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0488  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0489  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0490  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0491  70       TH Kill Date
     C                     MOVEL*BLANK    WN0492 10        RS User Changed
     C                     Z-ADD*ZERO     WN0493  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0494  60       RS Time Changed
     C                     MOVEL*BLANK    WN0495 10        RS Job
     C                     MOVEL*BLANK    WN0496 10        RS Program
     C                     MOVEL*BLANK    WN0497 10        RS User Added
     C                     Z-ADD*ZERO     WN0498  70       RS Date Added
     C                     Z-ADD*ZERO     WN0499  60       RS Time Added
     C                     Z-ADD*ZERO     WN0500  70       RU Date
     C                     Z-ADD*ZERO     WN0501  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHNX    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHNX    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YJRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQNY01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQNY02           ET Kill Date
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           WQNY01           ET Company Numb
     C                     KFLD           WQNY02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNY01           ET Company Numb
     C                     Z-ADDP1B0DT    WQNY02           ET Kill Date
      * Establish starting position
     C           KRSNY     SETLL@BVCPNE                    *
     C           KRSNY     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0130           ET Scale Sequen
     C                     GOTO NYEXIT                     *QUIT
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0130           ET Scale Sequen
     C                     GOTO NYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNY     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0130    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0130    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0451    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0452    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0453    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0454    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0455    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0456    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0457    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0458    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0459    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0460    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0502    WDVIST           ET Unused Sts 2
     C                     MOVELYL0131    WDVJST           ET Adjust/Add S
     C                     MOVELWN0503    WDVKST           ET Unused Sts 4
     C                     MOVELWN0504    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRNZ    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRNZ    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQOA01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQOA02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQOA03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQOA04           TH Tattoo Numbe
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           WQOA01           BOH Company Num
     C                     KFLD           WQOA02           BOH Buy Order N
     C                     KFLD           WQOA03           BOL Load Number
     C                     KFLD           WQOA04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQOA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOA04           TH Tattoo Numbe
      * Establish starting position
     C           KRSOA     SETLL@A1CPC4                    *
     C           KRSOA     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,004   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0133    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,004   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OCRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROB    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROB    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OBEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOC     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOC     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,005   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,005   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OERVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROD    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROD    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO ODEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OERVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOE     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOE     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PID'     WBDXST           KV Error Code
     C                     MOVEL@CN,006   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,006   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OGRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROF    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROF    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOG     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PID'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOG     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOH     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0516    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOH     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0125           EV Maximum
     C                     GOTO OHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0125           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOI     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0516    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOI     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0126           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO OIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0126           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQOJ01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQOJ02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQOJ03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQOJ04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQOJ05           TH Kill Date
      * Define keylist
     C           KRSOJ     KLIST
     C                     KFLD           WQOJ01           BOH Company Num
     C                     KFLD           WQOJ02           BOH Buy Order N
     C                     KFLD           WQOJ03           BOL Load Number
     C                     KFLD           WQOJ04           TH Tattoo Numbe
     C                     KFLD           WQOJ05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOJ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOJ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOJ03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOJ04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQOJ05           TH Kill Date
      * Establish starting position
     C           KRSOJ     SETLL@BVCPQ9                    *
     C           KRSOJ     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR OKCHRC
      * Subtract from Totals
     C                     EXSR UJSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSOJ     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0517  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0518  50       ET Lot
     C                     MOVEL*BLANK    WN0519  1        ET Shift
     C                     Z-ADD*ZERO     WN0520  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0521  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0522  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0523  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0524  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0525  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0526  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0527  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0528  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0529  1        ET Trim Area
     C                     MOVEL*BLANK    WN0530  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0531  1        ET Error Sts
     C                     MOVEL*BLANK    WN0532  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0533  1        ET Record Creat
     C                     MOVEL*BLANK    WN0534  1        ET Record Creat
     C                     MOVEL*BLANK    WN0535  1        ET User Error O
     C                     MOVEL*BLANK    WN0536  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0537  1        ET Broken Back
     C                     MOVEL*BLANK    WN0538  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0539  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0540  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0541  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0542  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0543  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0544  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0545  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0546  70       TH Kill Date
     C                     MOVEL*BLANK    WN0547 10        RS User Changed
     C                     Z-ADD*ZERO     WN0548  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0549  60       RS Time Changed
     C                     MOVEL*BLANK    WN0550 10        RS Job
     C                     MOVEL*BLANK    WN0551 10        RS Program
     C                     MOVEL*BLANK    WN0552 10        RS User Added
     C                     Z-ADD*ZERO     WN0553  70       RS Date Added
     C                     Z-ADD*ZERO     WN0554  60       RS Time Added
     C                     Z-ADD*ZERO     WN0555  70       RU Date
     C                     Z-ADD*ZERO     WN0556  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHOK    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHOK    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YKRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQOL01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQOL02           ET Kill Date
      * Define keylist
     C           KRSOL     KLIST
     C                     KFLD           WQOL01           ET Company Numb
     C                     KFLD           WQOL02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOL01           ET Company Numb
     C                     Z-ADDP1B0DT    WQOL02           ET Kill Date
      * Establish starting position
     C           KRSOL     SETLL@BVCPNE                    *
     C           KRSOL     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0130           ET Scale Sequen
     C                     GOTO OLEXIT                     *QUIT
     C                     GOTO OLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0130           ET Scale Sequen
     C                     GOTO OLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOL     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0130    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0130    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0506    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0507    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0508    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0509    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0510    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0511    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0512    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0513    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0514    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0515    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0557    WDVIST           ET Unused Sts 2
     C                     MOVELYL0131    WDVJST           ET Adjust/Add S
     C                     MOVELWN0558    WDVKST           ET Unused Sts 4
     C                     MOVELWN0559    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCROM    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCROM    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OMEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQON01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQON02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQON03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQON04           TH Tattoo Numbe
      * Define keylist
     C           KRSON     KLIST
     C                     KFLD           WQON01           BOH Company Num
     C                     KFLD           WQON02           BOH Buy Order N
     C                     KFLD           WQON03           BOL Load Number
     C                     KFLD           WQON04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQON01           BOH Company Num
     C                     Z-ADDP1BNNB    WQON02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQON03           BOL Load Number
     C                     Z-ADDP1CVNB    WQON04           TH Tattoo Numbe
      * Establish starting position
     C           KRSON     SETLL@A1CPC4                    *
     C           KRSON     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OOCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,004   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0133    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,004   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OPRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROO    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROO    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOP     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOP     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0113           PH Summary Type
     C                     Z-ADD*ZERO     YL0114           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0104           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0115           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0116           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0117           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0118           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0105           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0119           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0120           History Avail S
     C                     MOVEL'N'       YL0120           History Avail S
     C                     MOVEL'Y'       YL0070           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY3A1    WQOQ01           PH Company Numb
     C           *LIKE     DEFN WTABCD    WQOQ02           PD Producer Cod
      * Define keylist
     C           KPSOQ     KLIST
     C                     KFLD           WQOQ01           PH Company Numb
     C                     KFLD           WQOQ02           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSOQ     KLIST
     C                     KFLD           WQOQ01           PH Company Numb
     C                     KFLD           WQOQ02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQOQ01           PH Company Numb
     C                     MOVELP1ABCD    WQOQ02           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSOQ     SETLL@CGCPEJ                    *
     C           KRSOQ     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0070    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0071           PH Week Ending
     C                     MOVEL'N'       YL0070           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0071                     *IF
     C                     GOTO OQEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO OQEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO OQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSOQ     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOR     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0571    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOR     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0125           EV Maximum
     C                     GOTO OREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0125           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOS     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0571    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOS     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0126           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO OSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0126           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQOT01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQOT02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQOT03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQOT04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQOT05           TH Kill Date
      * Define keylist
     C           KRSOT     KLIST
     C                     KFLD           WQOT01           BOH Company Num
     C                     KFLD           WQOT02           BOH Buy Order N
     C                     KFLD           WQOT03           BOL Load Number
     C                     KFLD           WQOT04           TH Tattoo Numbe
     C                     KFLD           WQOT05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOT01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOT02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOT03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOT04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQOT05           TH Kill Date
      * Establish starting position
     C           KRSOT     SETLL@BVCPQ9                    *
     C           KRSOT     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR OUCHRC
      * Subtract from Totals
     C                     EXSR ULSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSOT     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OUCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0572  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0573  50       ET Lot
     C                     MOVEL*BLANK    WN0574  1        ET Shift
     C                     Z-ADD*ZERO     WN0575  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0576  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0577  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0578  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0579  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0580  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0581  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0582  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0583  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0584  1        ET Trim Area
     C                     MOVEL*BLANK    WN0585  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0586  1        ET Error Sts
     C                     MOVEL*BLANK    WN0587  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0588  1        ET Record Creat
     C                     MOVEL*BLANK    WN0589  1        ET Record Creat
     C                     MOVEL*BLANK    WN0590  1        ET User Error O
     C                     MOVEL*BLANK    WN0591  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0592  1        ET Broken Back
     C                     MOVEL*BLANK    WN0593  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0594  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0595  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0596  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0597  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0598  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0599  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0600  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0601  70       TH Kill Date
     C                     MOVEL*BLANK    WN0602 10        RS User Changed
     C                     Z-ADD*ZERO     WN0603  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0604  60       RS Time Changed
     C                     MOVEL*BLANK    WN0605 10        RS Job
     C                     MOVEL*BLANK    WN0606 10        RS Program
     C                     MOVEL*BLANK    WN0607 10        RS User Added
     C                     Z-ADD*ZERO     WN0608  70       RS Date Added
     C                     Z-ADD*ZERO     WN0609  60       RS Time Added
     C                     Z-ADD*ZERO     WN0610  70       RU Date
     C                     Z-ADD*ZERO     WN0611  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHOU    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHOU    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YLRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQOV01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQOV02           ET Kill Date
      * Define keylist
     C           KRSOV     KLIST
     C                     KFLD           WQOV01           ET Company Numb
     C                     KFLD           WQOV02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOV01           ET Company Numb
     C                     Z-ADDP1B0DT    WQOV02           ET Kill Date
      * Establish starting position
     C           KRSOV     SETLL@BVCPNE                    *
     C           KRSOV     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0130           ET Scale Sequen
     C                     GOTO OVEXIT                     *QUIT
     C                     GOTO OVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0130           ET Scale Sequen
     C                     GOTO OVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOV     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0130    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0130    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0561    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0562    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0563    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0564    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0565    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0566    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0567    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0568    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0569    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0570    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0612    WDVIST           ET Unused Sts 2
     C                     MOVELYL0131    WDVJST           ET Adjust/Add S
     C                     MOVELWN0613    WDVKST           ET Unused Sts 4
     C                     MOVELWN0614    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCROW    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCROW    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OWEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQOX01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQOX02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQOX03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQOX04           TH Tattoo Numbe
      * Define keylist
     C           KRSOX     KLIST
     C                     KFLD           WQOX01           BOH Company Num
     C                     KFLD           WQOX02           BOH Buy Order N
     C                     KFLD           WQOX03           BOL Load Number
     C                     KFLD           WQOX04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQOX01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOX02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOX03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOX04           TH Tattoo Numbe
      * Establish starting position
     C           KRSOX     SETLL@A1CPC4                    *
     C           KRSOX     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         OYCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,004   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0133    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,004   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OZRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROY    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROY    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OYEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OYEXIT    ENDSR
      /EJECT
     CSR         OZRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOZ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOZ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OZEXIT    ENDSR
      /EJECT
     CSR         PACRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,005   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,005   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PBRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPA    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPA    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PAEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PAEXIT    ENDSR
      /EJECT
     CSR         PBRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPB     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPB     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PBEXIT    ENDSR
      /EJECT
     CSR         PCCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PID'     WBDXST           KV Error Code
     C                     MOVEL@CN,006   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,006   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PDRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPC    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPC    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PCEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PCEXIT    ENDSR
      /EJECT
     CSR         PDRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPD     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PID'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPD     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PDEXIT    ENDSR
      /EJECT
     CSR         PERVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0113           PH Summary Type
     C                     Z-ADD*ZERO     YL0114           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0104           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0115           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0116           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0117           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0118           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0105           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0119           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0120           History Avail S
     C                     MOVEL'N'       YL0120           History Avail S
     C                     MOVEL'Y'       YL0070           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY3A1    WQPE01           PH Company Numb
     C           *LIKE     DEFN WTABCD    WQPE02           PD Producer Cod
      * Define keylist
     C           KPSPE     KLIST
     C                     KFLD           WQPE01           PH Company Numb
     C                     KFLD           WQPE02           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSPE     KLIST
     C                     KFLD           WQPE01           PH Company Numb
     C                     KFLD           WQPE02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQPE01           PH Company Numb
     C                     MOVELP1ABCD    WQPE02           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSPE     SETLL@CGCPEJ                    *
     C           KRSPE     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0070    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0071           PH Week Ending
     C                     MOVEL'N'       YL0070           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0071                     *IF
     C                     GOTO PEEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO PEEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO PEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSPE     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         PEEXIT    ENDSR
      /EJECT
     CSR         PFRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPF     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0626    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPF     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0125           EV Maximum
     C                     GOTO PFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0125           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PFEXIT    ENDSR
      /EJECT
     CSR         PGRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPG     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0626    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPG     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0126           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO PGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0126           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PGEXIT    ENDSR
      /EJECT
     CSR         PHRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQPH01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQPH02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQPH03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQPH04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQPH05           TH Kill Date
      * Define keylist
     C           KRSPH     KLIST
     C                     KFLD           WQPH01           BOH Company Num
     C                     KFLD           WQPH02           BOH Buy Order N
     C                     KFLD           WQPH03           BOL Load Number
     C                     KFLD           WQPH04           TH Tattoo Numbe
     C                     KFLD           WQPH05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPH01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPH02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPH03           BOL Load Number
     C                     Z-ADDP1CVNB    WQPH04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQPH05           TH Kill Date
      * Establish starting position
     C           KRSPH     SETLL@BVCPQ9                    *
     C           KRSPH     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR PICHRC
      * Subtract from Totals
     C                     EXSR UNSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSPH     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         PHEXIT    ENDSR
      /EJECT
     CSR         PICHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0627  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0628  50       ET Lot
     C                     MOVEL*BLANK    WN0629  1        ET Shift
     C                     Z-ADD*ZERO     WN0630  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0631  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0632  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0633  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0634  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0635  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0636  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0637  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0638  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0639  1        ET Trim Area
     C                     MOVEL*BLANK    WN0640  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0641  1        ET Error Sts
     C                     MOVEL*BLANK    WN0642  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0643  1        ET Record Creat
     C                     MOVEL*BLANK    WN0644  1        ET Record Creat
     C                     MOVEL*BLANK    WN0645  1        ET User Error O
     C                     MOVEL*BLANK    WN0646  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0647  1        ET Broken Back
     C                     MOVEL*BLANK    WN0648  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0649  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0650  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0651  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0652  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0653  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0654  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0655  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0656  70       TH Kill Date
     C                     MOVEL*BLANK    WN0657 10        RS User Changed
     C                     Z-ADD*ZERO     WN0658  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0659  60       RS Time Changed
     C                     MOVEL*BLANK    WN0660 10        RS Job
     C                     MOVEL*BLANK    WN0661 10        RS Program
     C                     MOVEL*BLANK    WN0662 10        RS User Added
     C                     Z-ADD*ZERO     WN0663  70       RS Date Added
     C                     Z-ADD*ZERO     WN0664  60       RS Time Added
     C                     Z-ADD*ZERO     WN0665  70       RU Date
     C                     Z-ADD*ZERO     WN0666  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHPI    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHPI    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YMRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PIEXIT    ENDSR
      /EJECT
     CSR         PJRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQPJ01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQPJ02           ET Kill Date
      * Define keylist
     C           KRSPJ     KLIST
     C                     KFLD           WQPJ01           ET Company Numb
     C                     KFLD           WQPJ02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPJ01           ET Company Numb
     C                     Z-ADDP1B0DT    WQPJ02           ET Kill Date
      * Establish starting position
     C           KRSPJ     SETLL@BVCPNE                    *
     C           KRSPJ     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0130           ET Scale Sequen
     C                     GOTO PJEXIT                     *QUIT
     C                     GOTO PJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0130           ET Scale Sequen
     C                     GOTO PJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSPJ     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         PJEXIT    ENDSR
      /EJECT
     CSR         PKCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0130    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0130    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0616    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0617    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0618    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0619    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0620    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0621    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0622    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0623    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0624    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0625    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0667    WDVIST           ET Unused Sts 2
     C                     MOVELYL0131    WDVJST           ET Adjust/Add S
     C                     MOVELWN0668    WDVKST           ET Unused Sts 4
     C                     MOVELWN0669    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRPK    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRPK    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PKEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PKEXIT    ENDSR
      /EJECT
     CSR         PLRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQPL01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQPL02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQPL03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQPL04           TH Tattoo Numbe
      * Define keylist
     C           KRSPL     KLIST
     C                     KFLD           WQPL01           BOH Company Num
     C                     KFLD           WQPL02           BOH Buy Order N
     C                     KFLD           WQPL03           BOL Load Number
     C                     KFLD           WQPL04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQPL01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPL02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPL03           BOL Load Number
     C                     Z-ADDP1CVNB    WQPL04           TH Tattoo Numbe
      * Establish starting position
     C           KRSPL     SETLL@A1CPC4                    *
     C           KRSPL     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         PLEXIT    ENDSR
      /EJECT
     CSR         PMCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,004   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0133    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,004   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PNRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPM    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPM    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PMEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PMEXIT    ENDSR
      /EJECT
     CSR         PNRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPN     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPN     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PNEXIT    ENDSR
      /EJECT
     CSR         POCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,005   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,005   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PPRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPO    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPO    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO POEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         POEXIT    ENDSR
      /EJECT
     CSR         PPRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPP     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPP     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PPEXIT    ENDSR
      /EJECT
     CSR         PQCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PAN'     WBDXST           KV Error Code
     C                     MOVEL@CN,007   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,007   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PRRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPQ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPQ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PQEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PQEXIT    ENDSR
      /EJECT
     CSR         PRRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPR     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PAN'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPR     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PREXIT    ENDSR
      /EJECT
     CSR         PSRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPS     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0681    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPS     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0136           EV Maximum
     C                     GOTO PSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0136           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PSEXIT    ENDSR
      /EJECT
     CSR         PTRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPT     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0681    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPT     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0137           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO PTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0137           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PTEXIT    ENDSR
      /EJECT
     CSR         PURVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQPU01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQPU02           ET Kill Date
      * Define keylist
     C           KRSPU     KLIST
     C                     KFLD           WQPU01           ET Company Numb
     C                     KFLD           WQPU02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPU01           ET Company Numb
     C                     Z-ADDP1B0DT    WQPU02           ET Kill Date
      * Establish starting position
     C           KRSPU     SETLL@BVCPNE                    *
     C           KRSPU     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0139           ET Scale Sequen
     C                     GOTO PUEXIT                     *QUIT
     C                     GOTO PUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0139           ET Scale Sequen
     C                     GOTO PUEXIT                     *QUIT
     C                     END                             *FI
     C           KRSPU     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         PUEXIT    ENDSR
      /EJECT
     CSR         PVCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0139    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0139    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0671    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0672    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0673    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0674    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0675    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0676    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0677    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0678    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0679    WDALPC           ET Light Reflec
     C                     MOVEL*BLANK    WDDIST           ET Trim Area
     C                     MOVEL'U'       WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0680    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0682    WDVIST           ET Unused Sts 2
     C                     MOVEL*BLANK    WDVJST           ET Adjust/Add S
     C                     MOVELWN0683    WDVKST           ET Unused Sts 4
     C                     MOVELWN0684    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRPV    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRPV    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PVEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PVEXIT    ENDSR
      /EJECT
     CSR         PWCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,004   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0141    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,004   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PXRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPW    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPW    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PWEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PWEXIT    ENDSR
      /EJECT
     CSR         PXRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPX     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPX     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PXEXIT    ENDSR
      /EJECT
     CSR         PYRVGN    BEGSR
      *================================================================
      * Bal Eval Trans w/EXC  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0143           Count USR
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAHMNB    WQPY01           BOH Company Num
     C           *LIKE     DEFN TABNNB    WQPY02           BOH Buy Order N
     C           *LIKE     DEFN TABONB    WQPY03           BOL Load Number
     C           *LIKE     DEFN TACVNB    WQPY04           TH Tattoo Numbe
     C           *LIKE     DEFN TAB0DT    WQPY05           TH Kill Date
      * Define keylist
     C           KPSPY     KLIST
     C                     KFLD           WQPY01           BOH Company Num
     C                     KFLD           WQPY02           BOH Buy Order N
     C                     KFLD           WQPY03           BOL Load Number
     C                     KFLD           WQPY04           TH Tattoo Numbe
     C                     KFLD           WQPY05           TH Kill Date
     C                     KFLD           TAAKPC           ET Lean Percent
     C                     KFLD           TAAMPC           ET Hot Wgt
      * Define keylist
     C           KRSPY     KLIST
     C                     KFLD           WQPY01           BOH Company Num
     C                     KFLD           WQPY02           BOH Buy Order N
     C                     KFLD           WQPY03           BOL Load Number
     C                     KFLD           WQPY04           TH Tattoo Numbe
     C                     KFLD           WQPY05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPY01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPY02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPY03           BOL Load Number
     C                     Z-ADDP1CVNB    WQPY04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQPY05           TH Kill Date
     C                     Z-ADDYL0097    TAAKPC           ET Lean Percent
     C                     Z-ADDYL0092    TAAMPC           ET Hot Wgt
      * Establish starting position
     C           KPSPY     SETLL@BVCPZA                    *
     C           KRSPY     READE@BVCPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'K'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
     C                     GOTO PYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0143           Count USR
      * CASE: PAR.Count USR GT PAR.Carcass Count USR
     C           YL0143    IFGT YL0142                     *IF
     C                     GOTO PYEXIT                     *QUIT
     C                     END                             *FI
      * Chg Add/Del Status    CH - Eval Trans  * 
     C                     EXSR PZCHRC
     C                     ADD  1         YL0023           TH Head Exclude
     C                     SUB  1         YL0016           TH Head Killed
     C           KRSPY     READE@BVCPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         PYEXIT    ENDSR
      /EJECT
     CSR         PZCHRC    BEGSR
      *================================================================
      * Chg Add/Del Status    CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0686  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0687  50       ET Lot
     C                     MOVEL*BLANK    WN0688  1        ET Shift
     C                     Z-ADD*ZERO     WN0689  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0690  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0691  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0692  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0693  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0694  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0695  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0696  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0697  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0698  1        ET Trim Area
     C                     MOVEL*BLANK    WN0699  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0700  1        ET Error Sts
     C                     MOVEL*BLANK    WN0701  1        ET Record Creat
     C                     MOVEL*BLANK    WN0702  1        ET Record Creat
     C                     MOVEL*BLANK    WN0703  1        ET User Error O
     C                     MOVEL*BLANK    WN0704  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0705  1        ET Broken Back
     C                     MOVEL*BLANK    WN0706  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0707  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0708  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0709  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0710  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0711  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0712  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0713  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0714  70       TH Kill Date
     C                     MOVEL*BLANK    WN0715 10        RS User Changed
     C                     Z-ADD*ZERO     WN0716  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0717  60       RS Time Changed
     C                     MOVEL*BLANK    WN0718  1        RS Record Statu
     C                     MOVEL*BLANK    WN0719 10        RS Job
     C                     MOVEL*BLANK    WN0720 10        RS Program
     C                     MOVEL*BLANK    WN0721 10        RS User Added
     C                     Z-ADD*ZERO     WN0722  70       RS Date Added
     C                     Z-ADD*ZERO     WN0723  60       RS Time Added
     C                     Z-ADD*ZERO     WN0724  70       RU Date
     C                     Z-ADD*ZERO     WN0725  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDTAHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDTAA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDTAFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDTAHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDTAGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHPZ    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHPZ    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YNRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDEHST    P      ET Record Add/D
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PZEXIT    ENDSR
      /EJECT
     CSR         QARVGN    BEGSR
      *================================================================
      * Bal Eval Trans w/EXC2 RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Declare restrictor key work fields
     C           *LIKE     DEFN TBHMNB    WQQA01           BOH Company Num
     C           *LIKE     DEFN TBBNNB    WQQA02           BOH Buy Order N
     C           *LIKE     DEFN TBBONB    WQQA03           BOL Load Number
     C           *LIKE     DEFN TBCVNB    WQQA04           TH Tattoo Numbe
     C           *LIKE     DEFN TBB0DT    WQQA05           TH Kill Date
      * Define keylist
     C           KPSQA     KLIST
     C                     KFLD           WQQA01           BOH Company Num
     C                     KFLD           WQQA02           BOH Buy Order N
     C                     KFLD           WQQA03           BOL Load Number
     C                     KFLD           WQQA04           TH Tattoo Numbe
     C                     KFLD           WQQA05           TH Kill Date
     C                     KFLD           TBAKPC           ET Lean Percent
     C                     KFLD           TBAMPC           ET Hot Wgt
      * Define keylist
     C           KRSQA     KLIST
     C                     KFLD           WQQA01           BOH Company Num
     C                     KFLD           WQQA02           BOH Buy Order N
     C                     KFLD           WQQA03           BOL Load Number
     C                     KFLD           WQQA04           TH Tattoo Numbe
     C                     KFLD           WQQA05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQQA04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQQA05           TH Kill Date
     C                     Z-ADDYL0097    TBAKPC           ET Lean Percent
     C                     Z-ADDYL0092    TBAMPC           ET Hot Wgt
      * Establish starting position
     C           KPSQA     SETLL@BVCPKU                    *
     C           KRSQA     READE@BVCPKU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'K'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
     C                     GOTO QAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0143           Count USR
      * CASE: PAR.Count USR GT PAR.Carcass Count USR
     C           YL0143    IFGT YL0142                     *IF
     C                     GOTO QAEXIT                     *QUIT
     C                     END                             *FI
      * Chg Add/Del Status    CH - Eval Trans  * 
     C                     EXSR QBCHRC
     C                     ADD  1         YL0023           TH Head Exclude
     C                     SUB  1         YL0016           TH Head Killed
     C           KRSQA     READE@BVCPKU                  90*
     C                     ENDDO
      *================================================================
     CSR         QAEXIT    ENDSR
      /EJECT
     CSR         QBCHRC    BEGSR
      *================================================================
      * Chg Add/Del Status    CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0726  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0727  50       ET Lot
     C                     MOVEL*BLANK    WN0728  1        ET Shift
     C                     Z-ADD*ZERO     WN0729  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0730  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0731  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0732  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0733  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0734  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0735  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0736  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0737  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0738  1        ET Trim Area
     C                     MOVEL*BLANK    WN0739  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0740  1        ET Error Sts
     C                     MOVEL*BLANK    WN0741  1        ET Record Creat
     C                     MOVEL*BLANK    WN0742  1        ET Record Creat
     C                     MOVEL*BLANK    WN0743  1        ET User Error O
     C                     MOVEL*BLANK    WN0744  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0745  1        ET Broken Back
     C                     MOVEL*BLANK    WN0746  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0747  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0748  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0749  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0750  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0751  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0752  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0753  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0754  70       TH Kill Date
     C                     MOVEL*BLANK    WN0755 10        RS User Changed
     C                     Z-ADD*ZERO     WN0756  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0757  60       RS Time Changed
     C                     MOVEL*BLANK    WN0758  1        RS Record Statu
     C                     MOVEL*BLANK    WN0759 10        RS Job
     C                     MOVEL*BLANK    WN0760 10        RS Program
     C                     MOVEL*BLANK    WN0761 10        RS User Added
     C                     Z-ADD*ZERO     WN0762  70       RS Date Added
     C                     Z-ADD*ZERO     WN0763  60       RS Time Added
     C                     Z-ADD*ZERO     WN0764  70       RU Date
     C                     Z-ADD*ZERO     WN0765  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDTBHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDTBA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDTBFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDTBHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDTBGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHQB    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHQB    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YORDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDEHST    P      ET Record Add/D
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QBEXIT    ENDSR
      /EJECT
     CSR         QCRVGN    BEGSR
      *================================================================
      * Upd Val Kill Trans    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQC     KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WIHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WIBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WIB0DT           TH Kill Date
      * Establish starting position
     C           KRSQC     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Val Kill Trans    CH - Tattoo Header  * 
     C                     EXSR QDCHRC
     C                     ENDIF
      *================================================================
     CSR         QCEXIT    ENDSR
      /EJECT
     CSR         QDCHRC    BEGSR
      *================================================================
      * Chg Val Kill Trans    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0766  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0767 10        TH Group Refere
     C                     MOVEL*BLANK    WN0768  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0769  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0770  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0771  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0772  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0773  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0774  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0775  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0776  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0777  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0778  50       TH Held Over
     C                     Z-ADD*ZERO     WN0779  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0780  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0781  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0782  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0783  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0784  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0785  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0786  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0787  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0788  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0789  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0790  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0791  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0792  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0793  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0794  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0795  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0796  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0797  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0798  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0799  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0800  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0801  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0802  2        TH Payment Sts
     C                     Z-ADD*ZERO     WN0803  80       TH Commission A
     C                     Z-ADD*ZERO     WN0804  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0805  1        TH User Error O
     C                     MOVEL*BLANK    WN0806  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0807  1        TH Sex
     C                     Z-ADD*ZERO     WN0808  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0809  70       TH Commission P
     C                     Z-ADD*ZERO     WN0810  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0811  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0812  31       TH FFLI
     C                     Z-ADD*ZERO     WN0813  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0814  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0815  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0816  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0817  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0818  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0819  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0820  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0821  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0822  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0823  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0824  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0825  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0826  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0827  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0828  1        TH Source Type
     C                     MOVEL*BLANK    WN0829  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0830  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0831  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0832  3        TH Source Code
     C                     MOVEL*BLANK    WN0833  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0834  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0835  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0836  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0837  3        TH State
     C                     MOVEL*BLANK    WN0838  3        TH Unused Code
     C                     MOVEL*BLANK    WN0839  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0840  1        TH Commission S
     C                     MOVEL*BLANK    WN0841  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0842  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0843  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0844  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0845  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0846  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0847  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0848  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0849  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0850  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0851  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0852  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0853  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0854  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0855  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0856  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0857 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0858 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0859 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0860 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0861  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0862  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0863  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0864  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0865  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0866  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0867  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0868  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0869  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0870  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0871  70       TH Unused Date
     C                     MOVEL*BLANK    WN0872  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0873  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0874  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0875  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0876  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0877  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0878  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0879  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0880  6        DF Defect Code
     C                     MOVEL*BLANK    WN0881  6        THP Process Cod
     C                     MOVEL*BLANK    WN0882  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0883  6        PL Location Cod
     C                     MOVEL*BLANK    WN0884  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0885  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0886  3        HC Class Code
     C                     MOVEL*BLANK    WN0887 10        RS User Changed
     C                     Z-ADD*ZERO     WN0888  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0889  60       RS Time Changed
     C                     MOVEL*BLANK    WN0890  1        RS Record Statu
     C                     MOVEL*BLANK    WN0891 10        RS Job
     C                     MOVEL*BLANK    WN0892 10        RS Program
     C                     MOVEL*BLANK    WN0893 10        RS User Added
     C                     Z-ADD*ZERO     WN0894  70       RS Date Added
     C                     Z-ADD*ZERO     WN0895  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWIHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWIBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWIBONB    WKBONB           BOL Load Number
     C                     Z-ADDWICVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WKB0DT           TH Kill Date
      *
     C           KLCHQD    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C           KLCHQD    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YPRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0009    WKAIPR           TH Recalc Live
     C                     Z-ADDYL0011    WKFDNB           TH Head Condemn
     C                     Z-ADDYL0016    WKFENB           TH Head Killed
     C                     Z-ADDYL0017    WKHENB           TH Head Adds
     C                     Z-ADDYL0018    WKHFNB           TH Head Accepte
     C                     Z-ADDYL0087    WKLRNB           TH Adj Live Wgt
     C                     Z-ADDYL0019    WKE0NB           TH Hot Wgt
     C                     Z-ADDYL0020    WKA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0021    WKFBNB           TH Tot Backfat
     C                     Z-ADDYL0022    WKA4PC           TH Tot Light Re
     C                     Z-ADDYL0091    WKHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0096    WKF5NB           TH Avg Light Re
     C                     Z-ADDYL0093    WKF4NB           TH Avg Lean Per
     C                     Z-ADDYL0095    WKF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0094    WKF2NB           TH Avg Backfat
     C                     Z-ADDYL0098    WKAWPC           TH Actual Yield
     C                     Z-ADDYL0090    WKCWPC           TH Adj Actual Y
     C                     Z-ADDYL0099    WKA2PR           TH Fixed Cost A
     C                     MOVELYL0002    WKD7ST    P      TH Header Error
     C                     MOVELYL0003    WKD8ST    P      TH Detail Error
     C                     MOVELYL0004    WKDWST    P      TH Kill Balanci
     C                     MOVELYL0006    WKD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0092    WKHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0023    WKJ9NB           TH Head Exclude
     C                     Z-ADDYL0097    WKT2WT           TH Avg Lean % E
     C                     Z-ADDYL0024    WKKOER           TH Head Identif
     C                     Z-ADDYL0085    WKOPIR           TH Percent Iden
     C                     Z-ADDYL0086    WKOPEM           TH Percent Acce
     C                     Z-ADDYL0025    WKIORP           TH Head Adjuste
     C                     Z-ADDYL0100    WKOWEO           TH PHA Head Add
     C                     MOVELYL0101    WKOQET    P      TH PHA Add Type
     C                     MOVELYL0102    WKURST    P      TH PHA Average
     C                     MOVELYL0103    WKUSST    P      TH PHA Add Reas
     C                     Z-ADDYL0104    WKHHPC           TH PHA Yield Pe
     C                     Z-ADDYL0105    WKS9PR           TH PHA Lean Prm
     C                     Z-ADDYL0106    WKORJK           TH Yld Parm Adj
     C                     Z-ADDYL0107    WKOMVJ           TH PHA Sort Dis
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QDEXIT    ENDSR
      /EJECT
     CSR         QERVGN    BEGSR
      *================================================================
      * Rtv Tot Hd ID/Anl/Net RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WUCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUKOER           TH Head Identif
     C                     Z-ADD*ZERO     WUJONB           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     WUL0NB           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     WUL1NB           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     WUL2NB           Hot Wgt/LghtR A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXHMNB    WQQE01           BOH Company Num
     C           *LIKE     DEFN WXBNNB    WQQE02           BOH Buy Order N
     C           *LIKE     DEFN WXBONB    WQQE03           BOL Load Number
     C           *LIKE     DEFN WXCVNB    WQQE04           TH Tattoo Numbe
      * Define keylist
     C           KRSQE     KLIST
     C                     KFLD           WQQE01           BOH Company Num
     C                     KFLD           WQQE02           BOH Buy Order N
     C                     KFLD           WQQE03           BOL Load Number
     C                     KFLD           WQQE04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQQE01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQE02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQE03           BOL Load Number
     C                     Z-ADDP1CVNB    WQQE04           TH Tattoo Numbe
      * Establish starting position
     C           KRSQE     SETLL@A1CPC7                    *
     C           KRSQE     READE@A1CPC7                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WXCWNB    WUCWNB           TH Head Receive
     C                     ADD  WXFCNB    WUFCNB           TH Yard Deads
     C                     ADD  WXFDNB    WUFDNB           TH Head Condemn
     C                     ADD  WXFENB    WUFENB           TH Head Killed
     C                     ADD  WXHFNB    WUHFNB           TH Head Accepte
     C                     ADD  WXKOER    WUKOER           TH Head Identif
     C                     ADD  WXCYNB    WUCYNB           TH Live Wgt
     C                     ADD  WXE0NB    WUE0NB           TH Hot Wgt
      * Hot Wgt/Lean % Accum USR
      * PAR.Hot Wgt/Lean % Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Lean % Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Lean Percent
     C           WXE0NB    MULT WXF4NB    W0WA01           *Synon (15,2) w
     C           WUJONB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUJONB           Hot Wgt/Lean %
      * Hot Wgt/Backf Accum USR
      * PAR.Hot Wgt/Backf Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Backf Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Backfat
     C           WXE0NB    MULT WXF2NB    W0WA01           *Synon (15,2) w
     C           WUL0NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUL0NB           Hot Wgt/Backf A
      * Hot Wgt/Loine Accum Usr
      * PAR.Hot Wgt/Loine Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Loine Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Loin Eye Depth
     C           WXE0NB    MULT WXF3NB    W0WA01           *Synon (15,2) w
     C           WUL1NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUL1NB           Hot Wgt/Loine A
      * Hot Wgt/LghtR Accum Usr
      * PAR.Hot Wgt/LghtR Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/LghtR Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Light Reflectance
     C           WXE0NB    MULT WXF5NB    W0WA01           *Synon (15,2) w
     C           WUL2NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUL2NB           Hot Wgt/LghtR A
     C           KRSQE     READE@A1CPC7                  90*
     C                     ENDDO
      *================================================================
     CSR         QEEXIT    ENDSR
      /EJECT
     CSR         QFRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0113           PH Summary Type
     C                     Z-ADD*ZERO     YL0114           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0104           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0115           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0116           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0117           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0118           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0105           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0119           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0120           History Avail S
     C                     MOVEL'N'       YL0120           History Avail S
     C                     MOVEL'Y'       YL0070           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY3A1    WQQF01           PH Company Numb
     C           *LIKE     DEFN WTABCD    WQQF02           PD Producer Cod
      * Define keylist
     C           KPSQF     KLIST
     C                     KFLD           WQQF01           PH Company Numb
     C                     KFLD           WQQF02           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSQF     KLIST
     C                     KFLD           WQQF01           PH Company Numb
     C                     KFLD           WQQF02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQQF01           PH Company Numb
     C                     MOVELP1ABCD    WQQF02           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSQF     SETLL@CGCPEJ                    *
     C           KRSQF     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0070    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0071           PH Week Ending
     C                     MOVEL'N'       YL0070           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0071                     *IF
     C                     GOTO QFEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO QFEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0113           PH Summary Type
     C                     Z-ADDWTORMB    YL0114           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0104           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0115           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0116           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0117           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0118           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0105           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0119           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0120           History Avail S
     C                     GOTO QFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSQF     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         QFEXIT    ENDSR
      /EJECT
     CSR         QGRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQG     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0906    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQG     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0125           EV Maximum
     C                     GOTO QGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0125           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         QGEXIT    ENDSR
      /EJECT
     CSR         QHRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQH     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0906    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQH     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0126           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO QHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0126           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         QHEXIT    ENDSR
      /EJECT
     CSR         QIRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQQI01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQQI02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQQI03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQQI04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQQI05           TH Kill Date
      * Define keylist
     C           KRSQI     KLIST
     C                     KFLD           WQQI01           BOH Company Num
     C                     KFLD           WQQI02           BOH Buy Order N
     C                     KFLD           WQQI03           BOL Load Number
     C                     KFLD           WQQI04           TH Tattoo Numbe
     C                     KFLD           WQQI05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQI01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQI02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQI03           BOL Load Number
     C                     Z-ADDP1CVNB    WQQI04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQQI05           TH Kill Date
      * Establish starting position
     C           KRSQI     SETLL@BVCPQ9                    *
     C           KRSQI     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR QJCHRC
      * Subtract from Totals
     C                     EXSR UUSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSQI     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         QIEXIT    ENDSR
      /EJECT
     CSR         QJCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0907  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0908  50       ET Lot
     C                     MOVEL*BLANK    WN0909  1        ET Shift
     C                     Z-ADD*ZERO     WN0910  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0911  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0912  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0913  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0914  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0915  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0916  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0917  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0918  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0919  1        ET Trim Area
     C                     MOVEL*BLANK    WN0920  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0921  1        ET Error Sts
     C                     MOVEL*BLANK    WN0922  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0923  1        ET Record Creat
     C                     MOVEL*BLANK    WN0924  1        ET Record Creat
     C                     MOVEL*BLANK    WN0925  1        ET User Error O
     C                     MOVEL*BLANK    WN0926  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0927  1        ET Broken Back
     C                     MOVEL*BLANK    WN0928  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0929  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0930  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0931  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0932  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0933  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0934  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0935  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0936  70       TH Kill Date
     C                     MOVEL*BLANK    WN0937 10        RS User Changed
     C                     Z-ADD*ZERO     WN0938  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0939  60       RS Time Changed
     C                     MOVEL*BLANK    WN0940 10        RS Job
     C                     MOVEL*BLANK    WN0941 10        RS Program
     C                     MOVEL*BLANK    WN0942 10        RS User Added
     C                     Z-ADD*ZERO     WN0943  70       RS Date Added
     C                     Z-ADD*ZERO     WN0944  60       RS Time Added
     C                     Z-ADD*ZERO     WN0945  70       RU Date
     C                     Z-ADD*ZERO     WN0946  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHQJ    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHQJ    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL021.
     C                     MOVEL'LBL021'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YQRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QJEXIT    ENDSR
      /EJECT
     CSR         QKRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQQK01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQQK02           ET Kill Date
      * Define keylist
     C           KRSQK     KLIST
     C                     KFLD           WQQK01           ET Company Numb
     C                     KFLD           WQQK02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQK01           ET Company Numb
     C                     Z-ADDP1B0DT    WQQK02           ET Kill Date
      * Establish starting position
     C           KRSQK     SETLL@BVCPNE                    *
     C           KRSQK     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0130           ET Scale Sequen
     C                     GOTO QKEXIT                     *QUIT
     C                     GOTO QKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0130           ET Scale Sequen
     C                     GOTO QKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSQK     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         QKEXIT    ENDSR
      /EJECT
     CSR         QLCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0130    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0130    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0896    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0897    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0898    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0899    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0900    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0901    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0902    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0903    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0904    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0905    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0947    WDVIST           ET Unused Sts 2
     C                     MOVELYL0131    WDVJST           ET Adjust/Add S
     C                     MOVELWN0948    WDVKST           ET Unused Sts 4
     C                     MOVELWN0949    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRQL    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRQL    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QLEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QLEXIT    ENDSR
      /EJECT
     CSR         QMRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQQM01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQQM02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQQM03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQQM04           TH Tattoo Numbe
      * Define keylist
     C           KRSQM     KLIST
     C                     KFLD           WQQM01           BOH Company Num
     C                     KFLD           WQQM02           BOH Buy Order N
     C                     KFLD           WQQM03           BOL Load Number
     C                     KFLD           WQQM04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQQM01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQM02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQM03           BOL Load Number
     C                     Z-ADDP1CVNB    WQQM04           TH Tattoo Numbe
      * Establish starting position
     C           KRSQM     SETLL@A1CPC4                    *
     C           KRSQM     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         QMEXIT    ENDSR
      /EJECT
     CSR         QNCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,004   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0133    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,004   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QORVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQN    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQN    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QNEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QNEXIT    ENDSR
      /EJECT
     CSR         QORVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQO     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQO     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QOEXIT    ENDSR
      /EJECT
     CSR         QPCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * PHA Not Avail
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,005   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,005   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QQRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQP    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQP    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QPEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QPEXIT    ENDSR
      /EJECT
     CSR         QQRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQQ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQQ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QQEXIT    ENDSR
      /EJECT
     CSR         QRCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Yield Error
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'YLD'     WBDXST           KV Error Code
     C                     MOVEL@CN,008   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,008   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QSRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQR    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQR    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QREXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QREXIT    ENDSR
      /EJECT
     CSR         QSRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQS     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'YLD'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQS     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QSEXIT    ENDSR
      /EJECT
     CSR         QTCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HLD'     WBDXST           KV Error Code
     C                     MOVEL@CN,009   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,009   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QURVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQT    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQT    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QTEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QTEXIT    ENDSR
      /EJECT
     CSR         QURVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQU     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HLD'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQU     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QUEXIT    ENDSR
      /EJECT
     CSR         QVRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0145           PH GA Adjusted
     C                     MOVEL'N'       YN0009           History Avail S
     C                     MOVEL'Y'       YL0070           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY3A1    WQQV01           PH Company Numb
     C           *LIKE     DEFN WTABCD    WQQV02           PD Producer Cod
      * Define keylist
     C           KPSQV     KLIST
     C                     KFLD           WQQV01           PH Company Numb
     C                     KFLD           WQQV02           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSQV     KLIST
     C                     KFLD           WQQV01           PH Company Numb
     C                     KFLD           WQQV02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQQV01           PH Company Numb
     C                     MOVELP1ABCD    WQQV02           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSQV     SETLL@CGCPEJ                    *
     C           KRSQV     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0070    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0071           PH Week Ending
     C                     MOVEL'N'       YL0070           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0071                     *IF
     C                     GOTO QVEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     Z-ADDWTG9PC    YL0145           PH GA Adjusted
     C                     MOVEL'Y'       YN0009           History Avail S
     C                     GOTO QVEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     Z-ADDWTG9PC    YL0145           PH GA Adjusted
     C                     MOVEL'Y'       YN0009           History Avail S
     C                     GOTO QVEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSQV     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         QVEXIT    ENDSR
      /EJECT
     CSR         QWCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HLD'     WBDXST           KV Error Code
     C                     MOVEL@CN,010   WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,010   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QXRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQW    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQW    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QWEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QWEXIT    ENDSR
      /EJECT
     CSR         QXRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQX     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HLD'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQX     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QXEXIT    ENDSR
      /EJECT
     CSR         QYRVGN    BEGSR
      *================================================================
      * Upd Val Kill Trans    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQY     KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WIHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WIBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WIB0DT           TH Kill Date
      * Establish starting position
     C           KRSQY     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Val Kill Trans    CH - Tattoo Header  * 
     C                     EXSR QZCHRC
     C                     ENDIF
      *================================================================
     CSR         QYEXIT    ENDSR
      /EJECT
     CSR         QZCHRC    BEGSR
      *================================================================
      * Chg Val Kill Trans    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0951  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0952 10        TH Group Refere
     C                     MOVEL*BLANK    WN0953  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0954  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0955  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0956  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0957  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0958  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0959  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0960  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0961  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0962  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0963  50       TH Held Over
     C                     Z-ADD*ZERO     WN0964  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0965  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0966  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0967  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0968  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0969  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0970  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0971  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0972  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0973  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0974  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0975  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0976  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0977  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0978  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0979  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0980  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0981  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0982  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0983  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0984  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0985  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0986  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0987  2        TH Payment Sts
     C                     Z-ADD*ZERO     WN0988  80       TH Commission A
     C                     Z-ADD*ZERO     WN0989  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0990  1        TH User Error O
     C                     MOVEL*BLANK    WN0991  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0992  1        TH Sex
     C                     Z-ADD*ZERO     WN0993  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0994  70       TH Commission P
     C                     Z-ADD*ZERO     WN0995  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0996  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0997  31       TH FFLI
     C                     Z-ADD*ZERO     WN0998  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0999  72       TH Cut Product
     C                     Z-ADD*ZERO     WN1000  72       TH Render Produ
     C                     Z-ADD*ZERO     WN1001  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN1002  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN1003  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN1004  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN1005  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN1006  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN1007  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN1008  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN1009  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1010  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1011  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN1012  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN1013  1        TH Source Type
     C                     MOVEL*BLANK    WN1014  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN1015  1        TH Payment Type
     C                     Z-ADD*ZERO     WN1016  70       TH HPS Movement
     C                     MOVEL*BLANK    WN1017  3        TH Source Code
     C                     MOVEL*BLANK    WN1018  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN1019  1        TH Posted to HP
     C                     MOVEL*BLANK    WN1020  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN1021  1        TH Shift Held O
     C                     MOVEL*BLANK    WN1022  3        TH State
     C                     MOVEL*BLANK    WN1023  3        TH Unused Code
     C                     MOVEL*BLANK    WN1024  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1025  1        TH Commission S
     C                     MOVEL*BLANK    WN1026  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN1027  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN1028  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN1029  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN1030  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN1031  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN1032  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN1033  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN1034  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN1035  50       TH Broken Back
     C                     Z-ADD*ZERO     WN1036  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN1037  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN1038  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN1039  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN1040  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN1041  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN1042 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN1043 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1044 112       TH Break Even P
     C                     Z-ADD*ZERO     WN1045 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN1046  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1047  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1048  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN1049  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN1050  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1051  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN1052  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1053  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1054  70       TH Head LFT
     C                     Z-ADD*ZERO     WN1055  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN1056  70       TH Unused Date
     C                     MOVEL*BLANK    WN1057  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN1058  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1059  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN1060  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN1061  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN1062  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN1063  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN1064  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN1065  6        DF Defect Code
     C                     MOVEL*BLANK    WN1066  6        THP Process Cod
     C                     MOVEL*BLANK    WN1067  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1068  6        PL Location Cod
     C                     MOVEL*BLANK    WN1069  3        HB Buyer Code
     C                     MOVEL*BLANK    WN1070  5        GN Genetic Code
     C                     MOVEL*BLANK    WN1071  3        HC Class Code
     C                     MOVEL*BLANK    WN1072 10        RS User Changed
     C                     Z-ADD*ZERO     WN1073  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1074  60       RS Time Changed
     C                     MOVEL*BLANK    WN1075  1        RS Record Statu
     C                     MOVEL*BLANK    WN1076 10        RS Job
     C                     MOVEL*BLANK    WN1077 10        RS Program
     C                     MOVEL*BLANK    WN1078 10        RS User Added
     C                     Z-ADD*ZERO     WN1079  70       RS Date Added
     C                     Z-ADD*ZERO     WN1080  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWIHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWIBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWIBONB    WKBONB           BOL Load Number
     C                     Z-ADDWICVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WKB0DT           TH Kill Date
      *
     C           KLCHQZ    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C           KLCHQZ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL022.
     C                     MOVEL'LBL022'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YRRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0009    WKAIPR           TH Recalc Live
     C                     Z-ADDYL0011    WKFDNB           TH Head Condemn
     C                     Z-ADDYL0016    WKFENB           TH Head Killed
     C                     Z-ADDYL0017    WKHENB           TH Head Adds
     C                     Z-ADDYL0018    WKHFNB           TH Head Accepte
     C                     Z-ADDYL0087    WKLRNB           TH Adj Live Wgt
     C                     Z-ADDYL0019    WKE0NB           TH Hot Wgt
     C                     Z-ADDYL0020    WKA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0021    WKFBNB           TH Tot Backfat
     C                     Z-ADDYL0022    WKA4PC           TH Tot Light Re
     C                     Z-ADDYL0091    WKHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0096    WKF5NB           TH Avg Light Re
     C                     Z-ADDYL0093    WKF4NB           TH Avg Lean Per
     C                     Z-ADDYL0095    WKF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0094    WKF2NB           TH Avg Backfat
     C                     Z-ADDYL0098    WKAWPC           TH Actual Yield
     C                     Z-ADDYL0090    WKCWPC           TH Adj Actual Y
     C                     Z-ADDYL0099    WKA2PR           TH Fixed Cost A
     C                     MOVELYL0002    WKD7ST    P      TH Header Error
     C                     MOVELYL0003    WKD8ST    P      TH Detail Error
     C                     MOVELYL0004    WKDWST    P      TH Kill Balanci
     C                     MOVELYL0006    WKD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0092    WKHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0023    WKJ9NB           TH Head Exclude
     C                     Z-ADDYL0097    WKT2WT           TH Avg Lean % E
     C                     Z-ADDYL0024    WKKOER           TH Head Identif
     C                     Z-ADDYL0085    WKOPIR           TH Percent Iden
     C                     Z-ADDYL0086    WKOPEM           TH Percent Acce
     C                     Z-ADDYL0025    WKIORP           TH Head Adjuste
     C                     Z-ADDYL0100    WKOWEO           TH PHA Head Add
     C                     MOVELYL0101    WKOQET    P      TH PHA Add Type
     C                     MOVELYL0102    WKURST    P      TH PHA Average
     C                     MOVELYL0103    WKUSST    P      TH PHA Add Reas
     C                     Z-ADDYL0104    WKHHPC           TH PHA Yield Pe
     C                     Z-ADDYL0105    WKS9PR           TH PHA Lean Prm
     C                     Z-ADDYL0106    WKORJK           TH Yld Parm Adj
     C                     Z-ADDYL0107    WKOMVJ           TH PHA Sort Dis
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QZEXIT    ENDSR
      /EJECT
     CSR         RARVGN    BEGSR
      *================================================================
      * RtvChg Td Cmpl Sts     RT - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMHMNB    WQRA01           BOH Company Num
     C           *LIKE     DEFN WMBNNB    WQRA02           BOH Buy Order N
     C           *LIKE     DEFN WMBONB    WQRA03           BOL Load Number
     C           *LIKE     DEFN WMCVNB    WQRA04           TH Tattoo Numbe
     C           *LIKE     DEFN WMB0DT    WQRA05           TH Kill Date
      * Define keylist
     C           KRSRA     KLIST
     C                     KFLD           WQRA01           BOH Company Num
     C                     KFLD           WQRA02           BOH Buy Order N
     C                     KFLD           WQRA03           BOL Load Number
     C                     KFLD           WQRA04           TH Tattoo Numbe
     C                     KFLD           WQRA05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQRA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQRA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQRA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQRA04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQRA05           TH Kill Date
      * Establish starting position
     C           KRSRA     SETLL@DYCPXX                    *
     C           KRSRA     READE@DYCPXX                  90*
      * Data record not found
     C   90                MOVEL'PRK0733' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
     C                     EXSR RBCHRC
     C           KRSRA     READE@DYCPXX                  90*
     C                     ENDDO
      *================================================================
     CSR         RAEXIT    ENDSR
      /EJECT
     CSR         RBCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YSRDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWMHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDWMBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDWMBONB    WOBONB           BOL Load Number
     C                     Z-ADDWMCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDWMB0DT    WOB0DT           TH Kill Date
     C                     Z-ADDWMC2NB    WOC2NB           TD Sequence Num
      *
     C           KLCHRB    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOC2NB           TD Sequence Num
     C           KLCHRB    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL023.
     C                     MOVEL'LBL023'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO RBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO RBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YSRDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WOAAVN           RS User Changed
     C                     Z-ADD##JDT     WOAADT           RS Date Changed
     C                     Z-ADD##JTM     WOAMTM           RS Time Changed
     C                     MOVEL##JOB     WOAHVN           RS Job
     C                     MOVEL##PGM     WOAGVN           RS Program
      * Move non-key fields to @DYCPXW
     C                     MOVEL'Y'       WOP3ST    P      Completed Statu
     C                     Z-ADDWMLENB    WOLENB           Hot Head
     C                     Z-ADDWMLFNB    WOLFNB           TDE Head Condem
     C                     Z-ADDWMLINB    WOLINB           Head 2
     C                     MOVELWMP4ST    WOP4ST    P      Status 1
     C                     MOVELWMP5ST    WOP5ST    P      Status 2
     C                     MOVELWMAAVN    WOAAVN    P      RS User Changed
     C                     Z-ADDWMAADT    WOAADT           RS Date Changed
     C                     Z-ADDWMAMTM    WOAMTM           RS Time Changed
     C                     MOVELWMAJST    WOAJST    P      RS Record Statu
     C                     MOVELWMAHVN    WOAHVN    P      RS Job
     C                     MOVELWMAGVN    WOAGVN    P      RS Program
     C                     MOVELWMABVN    WOABVN    P      RS User Added
     C                     Z-ADDWMABDT    WOABDT           RS Date Added
     C                     Z-ADDWMABTM    WOABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YSRDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         RBEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Dlt All Error's       RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHRNB    WQSA01           KV Company Numb
     C           *LIKE     DEFN WABPDT    WQSA02           KV Kill Date
     C           *LIKE     DEFN WAIRNB    WQSA03           KV TATTOO NUMBE
     C           *LIKE     DEFN WABONM    WQSA04           KV Buy Order Nu
     C           *LIKE     DEFN WALDNM    WQSA05           KV Load Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           KV Company Numb
     C                     KFLD           WQSA02           KV Kill Date
     C                     KFLD           WQSA03           KV TATTOO NUMBE
     C                     KFLD           WQSA04           KV Buy Order Nu
     C                     KFLD           WQSA05           KV Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           KV Company Numb
     C                     Z-ADDP1B0DT    WQSA02           KV Kill Date
     C                     Z-ADDP1CVNB    WQSA03           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WQSA04           KV Buy Order Nu
     C                     Z-ADDP1BONB    WQSA05           KV Load Number
      * Establish starting position
     C           KRSSA     SETLL@B6CPGX                    *
     C           KRSSA     READE@B6CPGX                  90*
      * Data record not found
     C   90                MOVEL'PRK0150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WABONM' defaulted for 'KV Buy Order Number'.
      * Field '(DB1) WALDNM' defaulted for 'KV Load Number'.
      * Delete Kill Validation - Eval/Loss Error  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@B6CPGX                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Delete Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPGW
     C                     Z-ADDWAHRNB    WBHRNB           KV Company Numb
     C                     Z-ADDWABPDT    WBBPDT           KV Kill Date
     C                     Z-ADDWAIRNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWABONM    WBBONM           KV Buy Order Nu
     C                     Z-ADDWALDNM    WBLDNM           KV Load Number
     C                     Z-ADDWAFPNB    WBFPNB           KV Record Numbe
     C                     MOVELWADYST    WBDYST           KV Record Type
     C                     MOVELWADXST    WBDXST           KV Error Code
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
     C           KLDLSB    CHAIN@B6CPGW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB6CPL0'MDACP
     C                     MOVEL'@B6CPGW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPGW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Bal Init Eval Trans   RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSC05           TH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
     C                     KFLD           WQSC05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSC01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSC03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSC04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSC05           TH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@BVCPQ9                    *
     C           KRSSC     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           WCEHST    IFEQ 'A'                        *IF
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SDDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.ET Adjust/Add Type is Adjust w/Average Lean%
     C           WCUUST    IFEQ 'LN%'                      *IF
      * Bal Init EvlTrn NoFOM CH - Eval Trans  * 
     C                     EXSR SECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * 060104 SLM  HPEBAL Add the ET Adjust/Add Source Initial to *none
      * Bal Init Eval Trans   CH - Eval Trans  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLDLSD    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Bal Init EvlTrn NoFOM CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0002  50       ET Lot
     C                     MOVEL*BLANK    WN0003  1        ET Shift
     C                     Z-ADD*ZERO     WN0004  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0005  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0006  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0007  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0008  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0009  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0010  1        ET Trim Area
     C                     MOVEL*BLANK    WN0011  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0012  1        ET Record Creat
     C                     MOVEL*BLANK    WN0013  1        ET Broken Back
     C                     MOVEL*BLANK    WN0014  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0015  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0016  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0017  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0018  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0019  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0020  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0021  70       TH Kill Date
     C                     MOVEL*BLANK    WN0022 10        RS User Changed
     C                     Z-ADD*ZERO     WN0023  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0024  60       RS Time Changed
     C                     MOVEL*BLANK    WN0025 10        RS Job
     C                     MOVEL*BLANK    WN0026 10        RS Program
     C                     MOVEL*BLANK    WN0027 10        RS User Added
     C                     Z-ADD*ZERO     WN0028  70       RS Date Added
     C                     Z-ADD*ZERO     WN0029  60       RS Time Added
     C                     Z-ADD*ZERO     WN0030  70       RU Date
     C                     Z-ADD*ZERO     WN0031  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHSE    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHSE    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YARDCS
      * Move non-key fields to @BVCPF0
     C                     Z-ADD*ZERO     WDX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WDFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WDFWPC           ET Light Reflec
     C                     MOVEL*BLANK    WDD2ST    P      ET Error Sts
     C                     MOVEL*BLANK    WDEHST    P      ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST    P      ET Record Creat
     C                     MOVEL*BLANK    WDJLST    P      ET User Error O
     C                     MOVEL*BLANK    WDUUST    P      ET Adjust/Add T
     C                     MOVEL*BLANK    WDVJST    P      ET Adjust/Add S
     C                     MOVEL'A'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Bal Init Eval Trans   CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0032  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0033  50       ET Lot
     C                     MOVEL*BLANK    WN0034  1        ET Shift
     C                     Z-ADD*ZERO     WN0035  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0036  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0037  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0038  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0039  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0040  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0041  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0042  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0043  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0044  1        ET Trim Area
     C                     MOVEL*BLANK    WN0045  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0046  1        ET Record Creat
     C                     MOVEL*BLANK    WN0047  1        ET Broken Back
     C                     MOVEL*BLANK    WN0048  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0049  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0050  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0051  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0052  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0053  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0054  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0055  70       TH Kill Date
     C                     MOVEL*BLANK    WN0056 10        RS User Changed
     C                     Z-ADD*ZERO     WN0057  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0058  60       RS Time Changed
     C                     MOVEL*BLANK    WN0059 10        RS Job
     C                     MOVEL*BLANK    WN0060 10        RS Program
     C                     MOVEL*BLANK    WN0061 10        RS User Added
     C                     Z-ADD*ZERO     WN0062  70       RS Date Added
     C                     Z-ADD*ZERO     WN0063  60       RS Time Added
     C                     Z-ADD*ZERO     WN0064  70       RU Date
     C                     Z-ADD*ZERO     WN0065  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHSF    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHSF    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YBRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL*BLANK    WDD2ST    P      ET Error Sts
     C                     MOVEL*BLANK    WDEHST    P      ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST    P      ET Record Creat
     C                     MOVEL*BLANK    WDJLST    P      ET User Error O
     C                     MOVEL*BLANK    WDUUST    P      ET Adjust/Add T
     C                     MOVEL*BLANK    WDVJST    P      ET Adjust/Add S
     C                     MOVEL'A'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del Payment Comments  RT - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WEBNNB    WQSG02           BOH Buy Order N
     C           *LIKE     DEFN WEBONB    WQSG03           BOL Load Number
     C           *LIKE     DEFN WECVNB    WQSG04           TH Tattoo Numbe
     C           *LIKE     DEFN WEB0DT    WQSG05           TH Kill Date
     C           *LIKE     DEFN WEETST    WQSG06           THC Comment Typ
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           BOH Buy Order N
     C                     KFLD           WQSG03           BOL Load Number
     C                     KFLD           WQSG04           TH Tattoo Numbe
     C                     KFLD           WQSG05           TH Kill Date
     C                     KFLD           WQSG06           THC Comment Typ
      * Setup key
     C                     Z-ADDP1HMNB    WQSG01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSG02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSG03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSG04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSG05           TH Kill Date
     C                     MOVEL'P'       WQSG06           THC Comment Typ
      * Establish starting position
     C           KRSSG     SETLL@A4CPL4                    *
     C           KRSSG     READE@A4CPL4                  90*
      * Data record not found
     C   90                MOVEL'PRK0067' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Tattoo Header Comm - Tattoo Header Comment  * 
     C                     EXSR SHDLRC
     C           KRSSG     READE@A4CPL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Delete Tattoo Header Comm - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @A4CPC3
     C                     Z-ADDWEHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWEBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWEBONB    WFBONB           BOL Load Number
     C                     Z-ADDWECVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWEB0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWEBETX    WFBETX           THC Comment Lin
      *
     C           KLDLSH    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBETX           THC Comment Lin
     C           KLDLSH    CHAIN@A4CPC3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA4CPL0'MDACP
     C                     MOVEL'@A4CPC3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@A4CPC3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Bal/Tattoo Hdr    RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQSI04           TH Tattoo Numbe
     C           *LIKE     DEFN WGB0DT    WQSI05           TH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           TH Tattoo Numbe
     C                     KFLD           WQSI05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSI01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSI03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSI04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSI05           TH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@BSCPLV                    *
     C           KRSSI     READE@BSCPLV                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.LT Type Code is Carcass Loss
      *   |- c2    : DB1.LTN Wgt is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WGBWCD    IFEQ 02                         *IF
     C           WGDSNB    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP1F7NB    WUDSNB           LTN Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWGDSNB    WUDSNB           LTN Wgt
     C                     END                             *FI
      * Val Loss Trans        XF - Loss Trans  * 
     C                     CLEARPARC
     C                     Z-ADDWGHUNB    PAHUNB           LTN Company Num
     C                     Z-ADDWGA7DT    PAA7DT           LTN Kill Date
     C                     Z-ADDWGFHNB    PAFHNB           LTN Record Numb
     C                     Z-ADDWGFFNB    PAFFNB           LTN Tattoo Numb
     C                     MOVELWGEBST    PAEBST    P      LTN Shift
     C                     Z-ADDWUDSNB    PADSNB           LTN Wgt
     C                     MOVELWGS3NB    PAS3NB    P      LTN Extent
     C                     MOVELWGS4NB    PAS4NB    P      LTN Trim Locati
     C                     MOVELWUD1ST    PAD1ST    P      LTN Error Sts
     C                     MOVELWGH5ST    PAH5ST    P      LTN Record Crea
     C                     MOVELWGJMST    PAJMST    P      LTN User Error
     C                     MOVELWGSMST    PASMST    P      LTN Source Type
     C                     Z-ADDWGBWCD    PABWCD           LT Type Code
     C                     Z-ADDWGBYCD    PABYCD           LR Reason Code
     C                     Z-ADDWGHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    PABONB           BOL Load Number
     C                     Z-ADDWGCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    PAB0DT           TH Kill Date
     C                     MOVELWGAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWGAADT    PAAADT           RS Date Changed
     C                     Z-ADDWGAMTM    PAAMTM           RS Time Changed
     C                     MOVELWGAJST    PAAJST    P      RS Record Statu
     C                     MOVELWGAHVN    PAAHVN    P      RS Job
     C                     MOVELWGAGVN    PAAGVN    P      RS Program
     C                     MOVELWGABVN    PAABVN    P      RS User Added
     C                     Z-ADDWGABDT    PAABDT           RS Date Added
     C                     Z-ADDWGABTM    PAABTM           RS Time Added
     C                     Z-ADDWGB8DT    PAB8DT           RU Date
     C                     Z-ADDWGAOTM    PAAOTM           RU Time
      *
     C                     CALL 'PKPJXFR'              90  Val Loss Trans
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Loss Trans
     C           YL0011    PARM YL0011    WQ0007  50       TH Head Condemn
     C           WUH9ST    PARM WUH9ST    WQ0008  1        Loss Error 1 Us
     C           WUIAST    PARM WUIAST    WQ0009  1        Loss Error 2 Us
     C           WUIBST    PARM WUIBST    WQ0010  1        Loss Error 3 Us
     C           WUICST    PARM WUICST    WQ0011  1        Loss Error 4 Us
     C           WULRST    PARM WULRST    WQ0012  1        Loss Error 5 Us
     C           YL0003    PARM YL0003    WQ0013  1        TH Detail Error
      *
     C                     MOVELPAD1ST    WUD1ST           LTN Error Sts
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Loss Transaction  CH - Loss Trans  * 
     C                     EXSR SJCHRC
     C           KRSSI     READE@BSCPLV                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Loss Transaction  CH - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BSCPFS
     C                     Z-ADDWGHUNB    WHHUNB           LTN Company Num
     C                     Z-ADDWGA7DT    WHA7DT           LTN Kill Date
     C                     Z-ADDWGFHNB    WHFHNB           LTN Record Numb
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WHHUNB           LTN Company Num
     C                     KFLD           WHA7DT           LTN Kill Date
     C                     KFLD           WHFHNB           LTN Record Numb
     C           KLCHSJ    CHAIN@BSCPFS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBSCPL0'MDACP
     C                     MOVEL'@BSCPFS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBS1    YCRDCS
      * Move non-key fields to @BSCPFS
     C                     Z-ADDWGFFNB    WHFFNB           LTN Tattoo Numb
     C                     MOVELWGEBST    WHEBST    P      LTN Shift
     C                     Z-ADDWUDSNB    WHDSNB           LTN Wgt
     C                     MOVELWGS3NB    WHS3NB    P      LTN Extent
     C                     MOVELWGS4NB    WHS4NB    P      LTN Trim Locati
     C                     MOVELWUD1ST    WHD1ST    P      LTN Error Sts
     C                     MOVELWGH5ST    WHH5ST    P      LTN Record Crea
     C                     MOVELWGJMST    WHJMST    P      LTN User Error
     C                     MOVELWGSMST    WHSMST    P      LTN Source Type
     C                     Z-ADDWGBWCD    WHBWCD           LT Type Code
     C                     Z-ADDWGBYCD    WHBYCD           LR Reason Code
     C                     Z-ADDWGHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    WHBONB           BOL Load Number
     C                     Z-ADDWGCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    WHB0DT           TH Kill Date
     C                     MOVEL##USR     WHAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WHAADT           RS Date Changed
     C                     Z-ADD##JTM     WHAMTM           RS Time Changed
     C                     MOVELWGAJST    WHAJST    P      RS Record Statu
     C                     MOVELWGAHVN    WHAHVN    P      RS Job
     C                     MOVELWGAGVN    WHAGVN    P      RS Program
     C                     MOVELWGABVN    WHABVN    P      RS User Added
     C                     Z-ADDWGABDT    WHABDT           RS Date Added
     C                     Z-ADDWGABTM    WHABTM           RS Time Added
     C                     Z-ADDWGB8DT    WHB8DT           RU Date
     C                     Z-ADDWGAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WHAGVN' defaulted for 'RS Program'.
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WHAAVN           RS User Changed
     C                     Z-ADD##JDT     WHAADT           RS Date Changed
     C                     Z-ADD##JTM     WHAMTM           RS Time Changed
     C                     MOVEL##JOB     WHAHVN           RS Job
     C                     MOVEL##PGM     WHAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BSCPFS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Head Condemn      RT - Tattoo Header  * 
     C                     EXSR SKRVGN
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Upd Head Condemn      RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0066  50       TH Head Condemn
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWHHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
     C                     Z-ADDWHCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWHB0DT    WIB0DT           TH Kill Date
      * Establish starting position
     C           KRSSK     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Head Condemned    RT - Loss Trans  * 
     C                     EXSR SLRVGN
      * Chg Head Condemned    CH - Tattoo Header  * 
     C                     EXSR SMCHRC
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Head Condemned    RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0066           TH Head Condemn
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJBWCD    WQSL01           LT Type Code
     C           *LIKE     DEFN WJHMNB    WQSL02           BOH Company Num
     C           *LIKE     DEFN WJBNNB    WQSL03           BOH Buy Order N
     C           *LIKE     DEFN WJBONB    WQSL04           BOL Load Number
     C           *LIKE     DEFN WJCVNB    WQSL05           TH Tattoo Numbe
     C           *LIKE     DEFN WJB0DT    WQSL06           TH Kill Date
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           LT Type Code
     C                     KFLD           WQSL02           BOH Company Num
     C                     KFLD           WQSL03           BOH Buy Order N
     C                     KFLD           WQSL04           BOL Load Number
     C                     KFLD           WQSL05           TH Tattoo Numbe
     C                     KFLD           WQSL06           TH Kill Date
      * Setup key
     C                     Z-ADD02        WQSL01           LT Type Code
     C                     Z-ADDWIHMNB    WQSL02           BOH Company Num
     C                     Z-ADDWIBNNB    WQSL03           BOH Buy Order N
     C                     Z-ADDWIBONB    WQSL04           BOL Load Number
     C                     Z-ADDWICVNB    WQSL05           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQSL06           TH Kill Date
      * Establish starting position
     C           KRSSL     SETLL@BSCPEM                    *
     C           KRSSL     READE@BSCPEM                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0066           TH Head Condemn
     C           KRSSL     READE@BSCPEM                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Head Condemned    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0067  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0068 10        TH Group Refere
     C                     MOVEL*BLANK    WN0069  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0070  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0071  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0072  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0073  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0074  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0075  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0076  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0077  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0078  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0079  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0080  50       TH Held Over
     C                     Z-ADD*ZERO     WN0081  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0082  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0083  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0084  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0085  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0086  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0087  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0088  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0089  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0090  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0091  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0092  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0093  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0094  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0095  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0096  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0097  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0098  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0099  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0100  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0101  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0102  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0103  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0104  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0105  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0106  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0107  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0108  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0109  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0110  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0111  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0112  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0113  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0114  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0115  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0116  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0117  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0118  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0119  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0120  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0121  1        TH Header Error
     C                     MOVEL*BLANK    WN0122  1        TH Detail Error
     C                     MOVEL*BLANK    WN0123  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0124  80       TH Commission A
     C                     Z-ADD*ZERO     WN0125  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0126  1        TH User Error O
     C                     MOVEL*BLANK    WN0127  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0128  1        TH Sex
     C                     Z-ADD*ZERO     WN0129  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0130  70       TH Commission P
     C                     Z-ADD*ZERO     WN0131  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0132  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0133  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0134  31       TH FFLI
     C                     Z-ADD*ZERO     WN0135  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0136  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0137  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0138  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0139  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0140  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0141  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0142  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0143  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0144  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0145  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0146  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0147  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0148  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0149  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0150  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0151  1        TH Source Type
     C                     MOVEL*BLANK    WN0152  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0153  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0154  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0155  3        TH Source Code
     C                     MOVEL*BLANK    WN0156  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0157  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0158  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0159  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0160  3        TH State
     C                     MOVEL*BLANK    WN0161  3        TH Unused Code
     C                     MOVEL*BLANK    WN0162  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0163  1        TH Commission S
     C                     MOVEL*BLANK    WN0164  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0165  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0166  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0167  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0168  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0169  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0170  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0171  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0172  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0173  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0174  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0175  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0176  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0177  3        TH PHA Average
     C                     MOVEL*BLANK    WN0178  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0179  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0180  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0181  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0182  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0183  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0184  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0185  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0186  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0187  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0188  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0189  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0190  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0191 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0192 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0193 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0194 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0195  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0196  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0197  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0198  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0199  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0200  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0201  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0202  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0203  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0204  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0205  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0206  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0207  70       TH Unused Date
     C                     MOVEL*BLANK    WN0208  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0209  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0210  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0211  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0212  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0213  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0214  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0215  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0216  6        DF Defect Code
     C                     MOVEL*BLANK    WN0217  6        THP Process Cod
     C                     MOVEL*BLANK    WN0218  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0219  6        PL Location Cod
     C                     MOVEL*BLANK    WN0220  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0221  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0222  3        HC Class Code
     C                     MOVEL*BLANK    WN0223 10        RS User Changed
     C                     Z-ADD*ZERO     WN0224  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0225  60       RS Time Changed
     C                     MOVEL*BLANK    WN0226  1        RS Record Statu
     C                     MOVEL*BLANK    WN0227 10        RS Job
     C                     MOVEL*BLANK    WN0228 10        RS Program
     C                     MOVEL*BLANK    WN0229 10        RS User Added
     C                     Z-ADD*ZERO     WN0230  70       RS Date Added
     C                     Z-ADD*ZERO     WN0231  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWIHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWIBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWIBONB    WKBONB           BOL Load Number
     C                     Z-ADDWICVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WKB0DT           TH Kill Date
      *
     C           KLCHSM    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C           KLCHSM    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWN0066    WKFDNB           TH Head Condemn
     C                     MOVEL'E'       WKDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Head Condemned    RT - Tattoo Detail  * 
     C                     EXSR SNRVGN
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Upd Head Condemned    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WLBNNB    WQSN02           BOH Buy Order N
     C           *LIKE     DEFN WLBONB    WQSN03           BOL Load Number
     C           *LIKE     DEFN WLCVNB    WQSN04           TH Tattoo Numbe
     C           *LIKE     DEFN WLB0DT    WQSN05           TH Kill Date
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           BOH Buy Order N
     C                     KFLD           WQSN03           BOL Load Number
     C                     KFLD           WQSN04           TH Tattoo Numbe
     C                     KFLD           WQSN05           TH Kill Date
      * Setup key
     C                     Z-ADDWKHMNB    WQSN01           BOH Company Num
     C                     Z-ADDWKBNNB    WQSN02           BOH Buy Order N
     C                     Z-ADDWKBONB    WQSN03           BOL Load Number
     C                     Z-ADDWKCVNB    WQSN04           TH Tattoo Numbe
     C                     Z-ADDWKB0DT    WQSN05           TH Kill Date
      * Establish starting position
     C           KRSSN     SETLL@A2CPDG                    *
     C           KRSSN     READE@A2CPDG                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WLC0NB    SUB  WLD8NB    YL0012           Net Head Usr
      * Rtv Stress Pens Only  XF - Pen Ext  * 
     C                     CALL 'PLPJXFR'              90  Rtv Stress Pens
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLHVNB    WQ0014  30       Pen Company Num
     C                     PARM WLCMCD    WQ0015  3        Pen Number
     C           YL0013    PARM YL0013    WQ0016  1        Stress/Market T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Stress pen is now defined at the pen ext instead of ST1
      * CASE: LCL.Stress/Market Type is Stress
     C           YL0013    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: LCL.Net Head Usr is *Zeros
     C           YL0012    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Head Condemned    RT - Tattoo Detail Ext  * 
     C                     EXSR SORVGN
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@A2CPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Head Condemned    RT - Tattoo Detail Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0232  1        Completed Statu
     C                     Z-ADD*ZERO     WN0233  50       Hot Head
     C                     Z-ADD*ZERO     WN0234  50       Head 2
     C                     MOVEL*BLANK    WN0235  1        Status 1
     C                     MOVEL*BLANK    WN0236  1        Status 2
     C                     MOVEL*BLANK    WN0237 10        RS User Changed
     C                     Z-ADD*ZERO     WN0238  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0239  60       RS Time Changed
     C                     MOVEL*BLANK    WN0240  1        RS Record Statu
     C                     MOVEL*BLANK    WN0241 10        RS Job
     C                     MOVEL*BLANK    WN0242 10        RS Program
     C                     MOVEL*BLANK    WN0243 10        RS User Added
     C                     Z-ADD*ZERO     WN0244  70       RS Date Added
     C                     Z-ADD*ZERO     WN0245  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
     C                     KFLD           WMBONB           BOL Load Number
     C                     KFLD           WMCVNB           TH Tattoo Numbe
     C                     KFLD           WMB0DT           TH Kill Date
     C                     KFLD           WMC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDWLHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWLBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WMBONB           BOL Load Number
     C                     Z-ADDWLCVNB    WMCVNB           TH Tattoo Numbe
     C                     Z-ADDWLB0DT    WMB0DT           TH Kill Date
     C                     Z-ADDWLC2NB    WMC2NB           TD Sequence Num
      * Establish starting position
     C           KRSSO     CHAIN@DYCPXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0733' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
     C                     EXSR SPCRRC
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Head Condemned    CH - Tattoo Detail Ext  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DYCPXW
     C                     Z-ADDWLHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDWLBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WOBONB           BOL Load Number
     C                     Z-ADDWLCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDWLB0DT    WOB0DT           TH Kill Date
     C                     Z-ADDWLC2NB    WOC2NB           TD Sequence Num
     C                     MOVEL'N'       WOP3ST           Completed Statu
     C                     Z-ADD*ZERO     WOLENB           Hot Head
     C                     Z-ADDWKFDNB    WOLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WOLINB           Head 2
     C                     MOVEL'N'       WOP4ST           Status 1
     C                     MOVEL'N'       WOP5ST           Status 2
     C                     MOVELWN0237    WOAAVN           RS User Changed
     C                     Z-ADDWN0238    WOAADT           RS Date Changed
     C                     Z-ADDWN0239    WOAMTM           RS Time Changed
     C                     MOVELWN0240    WOAJST           RS Record Statu
     C                     MOVELWN0241    WOAHVN           RS Job
     C                     MOVELWN0242    WOAGVN           RS Program
     C                     MOVELWN0243    WOABVN           RS User Added
     C                     Z-ADDWN0244    WOABDT           RS Date Added
     C                     Z-ADDWN0245    WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRSP    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOC2NB           TD Sequence Num
      * Check for duplicate primary key
     C           KLCRSP    SETLL@DYCPXW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0734' W0RTN   7
      * Send message 'Tattoo Detail Ext      EX'
     C                     MOVEL'PRK0734' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@DYCPXW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Head Condemned    CH - Tattoo Detail Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0246  1        Completed Statu
     C                     Z-ADD*ZERO     WN0247  50       Hot Head
     C                     Z-ADD*ZERO     WN0248  50       Head 2
     C                     MOVEL*BLANK    WN0249  1        Status 1
     C                     MOVEL*BLANK    WN0250  1        Status 2
     C                     MOVEL*BLANK    WN0251 10        RS User Changed
     C                     Z-ADD*ZERO     WN0252  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0253  60       RS Time Changed
     C                     MOVEL*BLANK    WN0254  1        RS Record Statu
     C                     MOVEL*BLANK    WN0255 10        RS Job
     C                     MOVEL*BLANK    WN0256 10        RS Program
     C                     MOVEL*BLANK    WN0257 10        RS User Added
     C                     Z-ADD*ZERO     WN0258  70       RS Date Added
     C                     Z-ADD*ZERO     WN0259  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWMHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDWMBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDWMBONB    WOBONB           BOL Load Number
     C                     Z-ADDWMCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDWMB0DT    WOB0DT           TH Kill Date
     C                     Z-ADDWMC2NB    WOC2NB           TD Sequence Num
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOC2NB           TD Sequence Num
     C           KLCHSQ    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YERDCS
      * Move non-key fields to @DYCPXW
     C                     Z-ADDWKFDNB    WOLFNB           TDE Head Condem
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Bal/Val Eval Trans    RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       and Balancing with Producer's History Avera
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0016           TH Head Killed
     C                     Z-ADD*ZERO     YL0017           TH Head Adds
     C                     Z-ADD*ZERO     YL0018           TH Head Accepte
     C                     Z-ADD*ZERO     YL0019           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0020           TH Tot Loin Eye
     C                     Z-ADD*ZERO     YL0021           TH Tot Backfat
     C                     Z-ADD*ZERO     YL0022           TH Tot Light Re
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL*BLANK    YL0003           TH Detail Error
     C                     MOVEL*BLANK    YL0004           TH Kill Balanci
     C                     Z-ADD*ZERO     YL0023           TH Head Exclude
     C                     Z-ADD*ZERO     YL0024           TH Head Identif
     C                     Z-ADD*ZERO     YL0025           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0026           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     YL0027           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     YL0028           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     YL0029           Hot Wgt/LghtR A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSR03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSR04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSR05           TH Kill Date
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
     C                     KFLD           WQSR04           TH Tattoo Numbe
     C                     KFLD           WQSR05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSR01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSR02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSR03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSR04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSR05           TH Kill Date
      * Establish starting position
     C           KRSSR     SETLL@BVCPQ9                    *
     C           KRSSR     READE@BVCPQ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Net Head Usr is *Zeros
     C           YL0014    IFEQ 0                          *IF
      * Net head is zeros if there are no transaction then this is ok
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'K'       YL0002           TH Header Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * TH Head Identified.
      * CASE: DB1.ET Record Add/Del Sts is Uploaded Records
     C           WCEHST    IFEQ *BLANK                     *IF
     C           WCEHST    OREQ 'D'
     C                     ADD  1         YL0024           TH Head Identif
     C                     END                             *FI
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Initialize
      * CASE: LCL.#Sequence Block is NULL
     C           YL0030    IFEQ *BLANK                     *IF
     C                     MOVEL'B'       YL0031           ET Error Sts
     C                     Z-ADDWCAKPC    YL0032           ET Lean Percent
     C                     Z-ADDWCFXPC    YL0033           ET Lean Percent
     C                     Z-ADDWCX8NB    YL0034           ET Backfat Thic
     C                     Z-ADDWCFVPC    YL0035           ET Loineye Dept
     C                     Z-ADDWCFWPC    YL0036           ET Light Reflec
     C                     MOVELWCAJST    YL0037           RS Record Statu
     C                     MOVEL*BLANK    YL0038           ET Adjust/Add T
     C                     MOVEL*BLANK    YL0039           ET Adjust/Add S
     C                     END                             *FI
      * Process Carcass
      * CASE: No FOM Reading
      *  - (c1 AND c2 AND c3)
      *   |- c1    : DB1.ET Backfat Thickness MM is Zero
      *   |- c2    : DB1.ET Loineye Depth MM is zero
      *   |- c3    : DB1.ET Light Reflectance MM is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCX8NB    IFEQ 0                          *IF
     C           WCFVPC    IFEQ 0                          *IF
     C           WCFWPC    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'LN%'     YL0038           ET Adjust/Add T
     C                     MOVEL'E'       YL0031           ET Error Sts
      * The reading cannot be replaced with averages because all of the
      * carcasses have not been processed.  (See Exit Program)
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate Lean % FOM
      * CASE: LCL.#Sequence Block is NULL
     C           YL0030    IFEQ *BLANK                     *IF
      * LEAN % FOM
     C                     MOVEL'N'       YL0040           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0017  31       CD Lean Percent
     C                     PARM WCAIPC    WQ0018  31       CD Backfat Thic
     C                     PARM WCAJPC    WQ0019  31       CD Loin-Eye Dep
     C                     PARM WCALPC    WQ0020  31       CD Light Reflec
     C           YL0034    PARM YL0034    WQ0021  31       CD Backfat Thic
     C           YL0035    PARM YL0035    WQ0022  31       CD Loin-Eye Dep
     C           YL0036    PARM YL0036    WQ0023  31       CD Light Reflec
     C           YL0033    PARM YL0033    WQ0024  31       CD Lean Percent
     C           YL0040    PARM YL0040    WQ0025  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UASUBR                     COMPUTE LEAN %
      * Validate Hot Weight
      * CASE: DB1.ET Hot Wgt LE PAR.Carcass Lgt Max
     C           WCAMPC    IFLE P2JANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SUCRRC
     C                     ELSE
      * CASE: DB1.ET Hot Wgt GE PAR.Carcass Dbw Min
     C           WCAMPC    IFGE P2I7NB                     *IF
      * Carcass Double Weight Error
     C                     MOVEL'CDB'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SWCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.ET Backfat Thickness Inch LE PAR.Backfat Low Max
     C           WCAIPC    IFLE P2K8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SYCRRC
     C                     ELSE
      * CASE: DB1.ET Backfat Thickness Inch GE PAR.BackFat High Min
     C           WCAIPC    IFGE P2K5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TACRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.ET Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           WCAJPC    IFLE P2LCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TCCRRC
     C                     ELSE
      * CASE: DB1.ET Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           WCAJPC    IFGE P2K9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TECRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: LCL.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           YL0032    IFLE P2JCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TGCRRC
     C                     ELSE
      * CASE: LCL.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           YL0032    IFGE P2JBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     YL0051           KV Error Code
     C                     MOVEL'E'       YL0031           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TICRRC
     C                     END                             *FI
     C                     END                             *FI
      * Process Balanced or Error
      * CASE: LCL.ET Error Sts is Balance
     C           YL0031    IFEQ 'B'                        *IF
     C                     ADD  1         YL0018           TH Head Accepte
      * Accumulate Totals
     C                     EXSR UBSUBR                     Accumulate Tota
     C                     ELSE
      * CASE: LCL.ET Error Sts is Error
     C           YL0031    IFEQ 'E'                        *IF
     C                     MOVEL'D'       YL0037           RS Record Statu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg Eval Transac      CH - Eval Trans  * 
     C                     EXSR TKCHRC
     C                     END                             *FI
     C           KRSSR     READE@BVCPQ9                  90*
     C                     ENDDO
      * USER: Exit processing
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       add Producer to the parms
      * Bal Eval Trans wo/FOM RT - Eval Trans  * 
     C                     EXSR TLRVGN
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HNE'     WBDXST           KV Error Code
     C                     MOVEL@CN,002   WBB7TX           KV Error Descri
     C                     MOVEL@CN,003   WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,002   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSS    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HNE'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSST     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSU    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSU    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSSV     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSW    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSW    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSSX     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSY    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSY    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSSZ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TBRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTA    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTA    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTB     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTC    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTC    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTD     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTE    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTE    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTF     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR THRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTG    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTG    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTH     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0051    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTI    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTI    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0051    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTJ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Chg Eval Transac      CH - Eval Trans  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0260  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0261  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0262  3        ET Unused Sts 5
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHTK    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHTK    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YFRDCS
      * Move non-key fields to @BVCPF0
     C                     Z-ADDWCFINB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDWCLKNB    WDLKNB           ET Lot
     C                     MOVELWCEAST    WDEAST    P      ET Shift
     C                     Z-ADDWCAMPC    WDAMPC           ET Hot Wgt
     C                     Z-ADDWCAIPC    WDAIPC           ET Backfat Thic
     C                     Z-ADDWCAJPC    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDYL0032    WDAKPC           ET Lean Percent
     C                     Z-ADDYL0034    WDX8NB           ET Backfat Thic
     C                     Z-ADDYL0035    WDFVPC           ET Loineye Dept
     C                     Z-ADDYL0036    WDFWPC           ET Light Reflec
     C                     Z-ADDYL0033    WDFXPC           ET Lean Percent
     C                     Z-ADDWCALPC    WDALPC           ET Light Reflec
     C                     MOVELWCDIST    WDDIST    P      ET Trim Area
     C                     MOVELWCFYST    WDFYST    P      ET Carcass Sex
     C                     MOVELYL0031    WDD2ST    P      ET Error Sts
     C                     MOVELWCEHST    WDEHST    P      ET Record Add/D
     C                     MOVELWCG1ST    WDG1ST    P      ET Record Creat
     C                     MOVELWCH4ST    WDH4ST    P      ET Record Creat
     C                     MOVELWCJLST    WDJLST    P      ET User Error O
     C                     MOVELYL0038    WDUUST    P      ET Adjust/Add T
     C                     MOVELWCVHST    WDVHST    P      ET Broken Back
     C                     MOVELYL0039    WDVJST    P      ET Adjust/Add S
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELYL0037    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
     C                     Z-ADDWCB8DT    WDB8DT           RU Date
     C                     Z-ADDWCAOTM    WDAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Bal Eval Trans wo/FOM RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       Add the New Sts ET adjust/add source
      *                       ET adjust/add source = blanks is the initia
      *                       ET adjust/add source = L is Lots Avg
      *                       ET adjust/add source = H is History Avg
      * Flag - To allow us to know if this process went through
      *        the change processing
     C                     MOVEL'N'       YL0053           Process Flag Us
      * Average Backfat, Loin Eye, Light Ref, & Lean % of Balanced Carcas
      * CASE: PAR.TH Hot Wgt NE LCL.Zero USR
     C           YL0019    IFNE YL0054                     *IF
      * Weighted average
      * 05/27/04 SLM HPEBAL   ET adjust/add source = L is Lots Avg
     C                     MOVEL*BLANK    YL0055           ET Adjust/Add S
     C                     MOVEL'L'       YL0055           ET Adjust/Add S
      * 02/06/02 PKD Change all of the calculations with *Rounded.
     C           YL0026    DIV  YL0019    YL0056    H      TH Avg Lean Per
     C           YL0027    DIV  YL0019    YL0057    H      TH Avg Backfat
     C           YL0028    DIV  YL0019    YL0058    H      TH Avg Loin Eye
     C           YL0029    DIV  YL0019    YL0059    H      TH Avg Light Re
     C                     ELSE
      * CASE: *OTHERWISE
      * 05/27/04 SLM HPEBAL   ET adjust/add source = *NONE set to blank
     C                     MOVEL*BLANK    YL0055           ET Adjust/Add S
     C                     Z-ADD*ZERO     YL0056           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0057           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0058           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0059           TH Avg Light Re
      * 05/27/04 SLM HPEBAL - RTV Producer History, if found then used
      *                       the Producer History, else the LCL
      *                       fields have been init.
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR TMRVGN
      * CASE: LCL.History Avail STS USR is Yes
     C           YL0069    IFEQ 'Y'                        *IF
      * 05/27/04 SLM HPEBAL - History Avail STS USR = Yes Hst was sel.
      *                       ET adjust/add source = H is History Avg
     C                     MOVEL*BLANK    YL0055           ET Adjust/Add S
     C                     MOVEL'H'       YL0055           ET Adjust/Add S
     C                     Z-ADDYL0063    YL0056           TH Avg Lean Per
     C                     Z-ADDYL0064    YL0057           TH Avg Backfat
     C                     Z-ADDYL0065    YL0058           TH Avg Loin Eye
     C                     Z-ADDYL0066    YL0059           TH Avg Light Re
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0072           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUE9NB    WQ0026  31       CD Lean Percent
     C                     PARM YL0057    WQ0027  31       CD Backfat Thic
     C                     PARM YL0058    WQ0028  31       CD Loin-Eye Dep
     C                     PARM WUE9NB    WQ0029  31       CD Light Reflec
     C           YL0073    PARM YL0073    WQ0030  31       CD Backfat Thic
     C           YL0074    PARM YL0074    WQ0031  31       CD Loin-Eye Dep
     C           WUE9NB    PARM WUE9NB    WQ0032  31       CD Light Reflec
     C           WUE9NB    PARM WUE9NB    WQ0033  31       CD Lean Percent
     C           YL0072    PARM YL0072    WQ0034  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSHMNB    WQTL01           BOH Company Num
     C           *LIKE     DEFN WSBNNB    WQTL02           BOH Buy Order N
     C           *LIKE     DEFN WSBONB    WQTL03           BOL Load Number
     C           *LIKE     DEFN WSCVNB    WQTL04           TH Tattoo Numbe
     C           *LIKE     DEFN WSB0DT    WQTL05           TH Kill Date
     C           *LIKE     DEFN WSUUST    WQTL06           ET Adjust/Add T
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           BOH Company Num
     C                     KFLD           WQTL02           BOH Buy Order N
     C                     KFLD           WQTL03           BOL Load Number
     C                     KFLD           WQTL04           TH Tattoo Numbe
     C                     KFLD           WQTL05           TH Kill Date
     C                     KFLD           WQTL06           ET Adjust/Add T
      * Setup key
     C                     Z-ADDP1HMNB    WQTL01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTL02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTL03           BOL Load Number
     C                     Z-ADDP1CVNB    WQTL04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTL05           TH Kill Date
     C                     MOVEL'LN%'     WQTL06           ET Adjust/Add T
      * Establish starting position
     C           KRSTL     SETLL@BVCPEC                    *
     C           KRSTL     READE@BVCPEC                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDYL0057    YL0075           ET Backfat Thic
     C                     Z-ADDYL0058    YL0076           ET Loin-Eye Dep
     C                     Z-ADDYL0059    YL0077           ET Light Reflec
     C                     Z-ADDYL0056    YL0078           ET Lean Percent
     C                     MOVEL'B'       YL0079           ET Error Sts
     C                     MOVELWSAJST    YL0080           RS Record Statu
      * Validate Hot Weight
      * CASE: DB1.ET Hot Wgt LE PAR.Carcass Lgt Max
     C           WSAMPC    IFLE P2JANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     YL0081           KV Error Code
     C                     MOVEL'E'       YL0079           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TNCRRC
     C                     ELSE
      * CASE: DB1.ET Hot Wgt GE PAR.Carcass Dbw Min
     C           WSAMPC    IFGE P2I7NB                     *IF
      * Carcass Double Weight Error
     C                     MOVEL'CDB'     YL0081           KV Error Code
     C                     MOVEL'E'       YL0079           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TPCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: LCL.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           YL0078    IFLE P2JCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     YL0081           KV Error Code
     C                     MOVEL'E'       YL0079           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TRCRRC
     C                     ELSE
      * CASE: LCL.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           YL0078    IFGE P2JBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     YL0081           KV Error Code
     C                     MOVEL'E'       YL0079           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TTCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Process Balanced or Error
      * CASE: LCL.ET Error Sts is Balance
     C           YL0079    IFEQ 'B'                        *IF
     C                     ADD  1         YL0018           TH Head Accepte
     C                     ADD  1         YL0025           TH Head Adjuste
      * Accumulate Totals
     C                     EXSR UCSUBR                     Accumulate Tota
      * Dlt Tto Eval Rec Err  RT - Eval/Loss Error  * 
     C                     EXSR TVRVGN
     C                     MOVEL'Y'       YL0053           Process Flag Us
     C                     ELSE
      * CASE: LCL.ET Error Sts is Error
     C           YL0079    IFEQ 'E'                        *IF
     C                     MOVEL'D'       YL0080           RS Record Statu
     C                     END                             *FI
     C                     END                             *FI
      * Chg Eval Transac      CH - Eval Trans  * 
     C                     EXSR TXCHRC
     C           KRSTL     READE@BVCPEC                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Process Flag User is Yes
     C           YL0053    IFEQ 'Y'                        *IF
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       Write a message to the Tattoo Hdr Comments
      *                       If Lots Avg, or Producer Hst was used.
      *                       ** All new
      * CASE: LCL.ET Adjust/Add Source is LOT - Lot Average
     C           YL0055    IFEQ 'L'                        *IF
      * Setup message data for message
      * Retrieve message Pay Note:LN% Used Lot Av
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1112' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0083    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0084    WL0006           THC Comment Lin
     C                     MOVELYL0083    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVELWSAHVN    WL0013    P      RS Job
     C                     MOVELWSAGVN    WL0014    P      RS Program
     C                     MOVELWSABVN    WL0015    P      RS User Added
     C                     Z-ADDWSABDT    WL0016           RS Date Added
     C                     Z-ADDWSABTM    WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0084           THC Comment Lin
     C                     ELSE
      * CASE: LCL.ET Adjust/Add Source is HST - History Average
     C           YL0055    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     MOVELYL0060    ZA0001           PH Summary Type
      * Retrieve message Pay Note: Use Prd's HstAV
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1113' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0083    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0084    WL0006           THC Comment Lin
     C                     MOVELYL0083    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVELWSAHVN    WL0013    P      RS Job
     C                     MOVELWSAGVN    WL0014    P      RS Program
     C                     MOVELWSABVN    WL0015    P      RS User Added
     C                     Z-ADDWSABDT    WL0016           RS Date Added
     C                     Z-ADDWSABTM    WL0017           RS Time Added
     C                     EXSR TYINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0084           THC Comment Lin
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0060           PH Summary Type
     C                     Z-ADD*ZERO     YL0061           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0062           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0063           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0064           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0065           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0066           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0067           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0068           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0069           History Avail S
     C                     MOVEL'N'       YL0069           History Avail S
     C                     MOVEL'Y'       YL0070           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY3A1    WQTM01           PH Company Numb
     C           *LIKE     DEFN WTABCD    WQTM02           PD Producer Cod
      * Define keylist
     C           KPSTM     KLIST
     C                     KFLD           WQTM01           PH Company Numb
     C                     KFLD           WQTM02           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           PH Company Numb
     C                     KFLD           WQTM02           PD Producer Cod
      * Setup key
     C                     Z-ADDP1HMNB    WQTM01           PH Company Numb
     C                     MOVELP1ABCD    WQTM02           PD Producer Cod
     C                     Z-ADDP1B0DT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSTM     SETLL@CGCPEJ                    *
     C           KRSTM     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0070    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0071           PH Week Ending
     C                     MOVEL'N'       YL0070           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0071                     *IF
     C                     GOTO TMEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0060           PH Summary Type
     C                     Z-ADDWTORMB    YL0061           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0062           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0063           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0064           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0065           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0066           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0067           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0068           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0069           History Avail S
     C                     GOTO TMEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0060           PH Summary Type
     C                     Z-ADDWTORMB    YL0061           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0062           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0063           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0064           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0065           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0066           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0067           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0068           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0069           History Avail S
     C                     GOTO TMEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTM     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0081    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTN    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTN    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0081    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTO     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0081    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TQRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTP    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTP    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0081    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTQ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0081    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TSRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTR    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTR    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0081    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTS     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0081    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TURVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTT    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTT    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0081    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTU     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Dlt Tto Eval Rec Err  RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVHRNB    WQTV01           KV Company Numb
     C           *LIKE     DEFN WVBPDT    WQTV02           KV Kill Date
     C           *LIKE     DEFN WVIRNB    WQTV03           KV TATTOO NUMBE
     C           *LIKE     DEFN WVBONM    WQTV04           KV Buy Order Nu
     C           *LIKE     DEFN WVLDNM    WQTV05           KV Load Number
     C           *LIKE     DEFN WVFPNB    WQTV06           KV Record Numbe
     C           *LIKE     DEFN WVDYST    WQTV07           KV Record Type
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WQTV01           KV Company Numb
     C                     KFLD           WQTV02           KV Kill Date
     C                     KFLD           WQTV03           KV TATTOO NUMBE
     C                     KFLD           WQTV04           KV Buy Order Nu
     C                     KFLD           WQTV05           KV Load Number
     C                     KFLD           WQTV06           KV Record Numbe
     C                     KFLD           WQTV07           KV Record Type
      * Setup key
     C                     Z-ADDWSHSNB    WQTV01           KV Company Numb
     C                     Z-ADDWSA9DT    WQTV02           KV Kill Date
     C                     Z-ADDWSFINB    WQTV03           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WQTV04           KV Buy Order Nu
     C                     Z-ADDWSBONB    WQTV05           KV Load Number
     C                     Z-ADDWSFJNB    WQTV06           KV Record Numbe
     C                     MOVEL'E'       WQTV07           KV Record Type
      * Establish starting position
     C           KRSTV     SETLL@B6CPLW                    *
     C           KRSTV     READE@B6CPLW                  90*
      * Data record not found
     C   90                MOVEL'PRK0150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Kill Validation - Eval/Loss Error  * 
     C                     EXSR TWDLRC
     C           KRSTV     READE@B6CPLW                  90*
     C                     ENDDO
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWDLRC    BEGSR
      *================================================================
      * Delete Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPGW
     C                     Z-ADDWVHRNB    WBHRNB           KV Company Numb
     C                     Z-ADDWVBPDT    WBBPDT           KV Kill Date
     C                     Z-ADDWVIRNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWVBONM    WBBONM           KV Buy Order Nu
     C                     Z-ADDWVLDNM    WBLDNM           KV Load Number
     C                     Z-ADDWVFPNB    WBFPNB           KV Record Numbe
     C                     MOVELWVDYST    WBDYST           KV Record Type
     C                     MOVELWVDXST    WBDXST           KV Error Code
      *
     C           KLDLTW    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
     C           KLDLTW    CHAIN@B6CPGW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB6CPL0'MDACP
     C                     MOVEL'@B6CPGW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPGW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * Chg Eval Transac      CH - Eval Trans  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0263  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0264  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0265  3        ET Unused Sts 5
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWSHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWSA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWSFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWSHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWSGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHTX    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHTX    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YGRDCS
      * Move non-key fields to @BVCPF0
     C                     Z-ADDWSFINB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDWSLKNB    WDLKNB           ET Lot
     C                     MOVELWSEAST    WDEAST    P      ET Shift
     C                     Z-ADDWSAMPC    WDAMPC           ET Hot Wgt
     C                     Z-ADDYL0075    WDAIPC           ET Backfat Thic
     C                     Z-ADDYL0076    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDYL0078    WDAKPC           ET Lean Percent
     C                     Z-ADDYL0073    WDX8NB           ET Backfat Thic
     C                     Z-ADDYL0074    WDFVPC           ET Loineye Dept
     C                     Z-ADDYL0077    WDFWPC           ET Light Reflec
     C                     Z-ADDWSFXPC    WDFXPC           ET Lean Percent
     C                     Z-ADDYL0077    WDALPC           ET Light Reflec
     C                     MOVELWSDIST    WDDIST    P      ET Trim Area
     C                     MOVELWSFYST    WDFYST    P      ET Carcass Sex
     C                     MOVELYL0079    WDD2ST    P      ET Error Sts
     C                     MOVELWSEHST    WDEHST    P      ET Record Add/D
     C                     MOVELWSG1ST    WDG1ST    P      ET Record Creat
     C                     MOVELWSH4ST    WDH4ST    P      ET Record Creat
     C                     MOVELWSJLST    WDJLST    P      ET User Error O
     C                     MOVELWSUUST    WDUUST    P      ET Adjust/Add T
     C                     MOVELWSVHST    WDVHST    P      ET Broken Back
     C                     MOVELYL0055    WDVJST    P      ET Adjust/Add S
     C                     Z-ADDWSHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWSBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWSBONB    WDBONB           BOL Load Number
     C                     Z-ADDWSCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWSB0DT    WDB0DT           TH Kill Date
     C                     MOVELWSAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWSAADT    WDAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WDAMTM           RS Time Changed
     C                     MOVELYL0080    WDAJST    P      RS Record Statu
     C                     MOVELWSAHVN    WDAHVN    P      RS Job
     C                     MOVELWSAGVN    WDAGVN    P      RS Program
     C                     MOVELWSABVN    WDABVN    P      RS User Added
     C                     Z-ADDWSABDT    WDABDT           RS Date Added
     C                     Z-ADDWSABTM    WDABTM           RS Time Added
     C                     Z-ADDWSB8DT    WDB8DT           RU Date
     C                     Z-ADDWSAOTM    WDAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYINFN    BEGSR
      *================================================================
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      *================================================================
      * Crt Tattoo Hdr Cmnt   IF
      * Rtv Next Line Nbr     RT - Tattoo Header Comment  * 
     C                     EXSR TZRVGN
      * Crt Tattoo Hdr Cmnt   CR - Tattoo Header Comment  * 
     C                     EXSR NACRRC
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * Rtv Next Line Nbr     RT - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWHMNB    WQTZ01           BOH Company Num
     C           *LIKE     DEFN WWBNNB    WQTZ02           BOH Buy Order N
     C           *LIKE     DEFN WWBONB    WQTZ03           BOL Load Number
     C           *LIKE     DEFN WWCVNB    WQTZ04           TH Tattoo Numbe
     C           *LIKE     DEFN WWB0DT    WQTZ05           TH Kill Date
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WQTZ01           BOH Company Num
     C                     KFLD           WQTZ02           BOH Buy Order N
     C                     KFLD           WQTZ03           BOL Load Number
     C                     KFLD           WQTZ04           TH Tattoo Numbe
     C                     KFLD           WQTZ05           TH Kill Date
      * Setup key
     C                     Z-ADDWL0001    WQTZ01           BOH Company Num
     C                     Z-ADDWL0002    WQTZ02           BOH Buy Order N
     C                     Z-ADDWL0003    WQTZ03           BOL Load Number
     C                     Z-ADDWL0004    WQTZ04           TH Tattoo Numbe
     C                     Z-ADDWL0005    WQTZ05           TH Kill Date
      * Establish starting position
     C           KRSTZ     SETLL@A4CPL3                    *
     C           KRSTZ     READE@A4CPL3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0067' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0006           THC Comment Lin
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WWBETX    ADD  1         WL0006           THC Comment Lin
     C                     GOTO TZEXIT                     *QUIT
     C           KRSTZ     READE@A4CPL3                  90*
     C                     ENDDO
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     YL0041           Lean % Fld 1 Us
     C           1         MULT 0.469     YL0042           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 YL0043           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 YL0044           Lean % Fld 4 Us
      * CASE: DB1.ET Hot Wgt NE WRK.Zero USR
     C           WCAMPC    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * LCL.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : LCL.Lean % Fld 1 Usr
      * +     : LCL.Lean @ Ext 4 Usr
      * x2    : LCL.Lean % Fld 2 Usr
      * *     : LCL.Lean @ Ext 1 Usr *
      * x5    : DB1.ET Hot Wgt
      * -     : LCL.Lean @ Ext 4 Usr
      * x3    : LCL.Lean % Fld 3 Usr
      * *     : LCL.Lean @ Ext 2 Usr *
      * x6    : DB1.ET Backfat Thickness MM
      * +     : LCL.Lean @ Ext 4 Usr
      * x4    : LCL.Lean % Fld 4 Usr
      * *     : LCL.Lean @ Ext 3 Usr *
      * x7    : DB1.ET Loineye Depth MM
      * /     : LCL.Lean % Fld 5 Usr *
      * x5    : DB1.ET Hot Wgt
      * *     : LCL.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           YL0042    MULT WCAMPC    YL0045           Lean @ Ext 1 Us
     C           YL0041    ADD  YL0045    YL0046           Lean @ Ext 4 Us
     C           YL0043    MULT WCX8NB    YL0047           Lean @ Ext 2 Us
     C                     SUB  YL0047    YL0046           Lean @ Ext 4 Us
     C           YL0044    MULT WCFVPC    YL0048           Lean @ Ext 3 Us
     C                     ADD  YL0048    YL0046           Lean @ Ext 4 Us
     C           YL0046    DIV  WCAMPC    YL0049           Lean % Fld 5 Us
     C           YL0049    MULT 100       YL0050           Lean @ Ext 5 Us
     C                     Z-ADDYL0050    YL0049           Lean % Fld 5 Us
     C                     END                             *FI
     C           YL0049    MULT 1         YL0032    H      ET Lean Percent
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  1         YL0016           TH Head Killed
     C                     ADD  WCAJPC    YL0020           TH Tot Loin Eye
     C                     ADD  WCAIPC    YL0021           TH Tot Backfat
     C                     ADD  WCALPC    YL0022           TH Tot Light Re
     C                     ADD  WCAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           YL0032    MULT WCAMPC    YL0052           Hot Wgt/Weight
     C                     ADD  YL0052    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0052           Hot Wgt/Weight
     C                     ADD  YL0052    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0052           Hot Wgt/Weight
     C                     ADD  YL0052    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0052           Hot Wgt/Weight
     C                     ADD  YL0052    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  1         YL0016           TH Head Killed
     C                     ADD  YL0076    YL0020           TH Tot Loin Eye
     C                     ADD  YL0075    YL0021           TH Tot Backfat
     C                     ADD  YL0077    YL0022           TH Tot Light Re
     C                     ADD  WSAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           YL0078    MULT WSAMPC    YL0082           Hot Wgt/Weight
     C                     ADD  YL0082    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           YL0075    MULT WSAMPC    YL0082           Hot Wgt/Weight
     C                     ADD  YL0082    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           YL0076    MULT WSAMPC    YL0082           Hot Wgt/Weight
     C                     ADD  YL0082    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           YL0077    MULT WSAMPC    YL0082           Hot Wgt/Weight
     C                     ADD  YL0082    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Calculate Tattoo Header Averages/yield
      *================================================================
      * Calculate Adj Live Weight
      * CASE: PAR.TH Head Received EQ LCL.Net Head Usr
     C           P1CWNB    IFEQ YL0014                     *IF
     C                     Z-ADDP1CYNB    YL0087           TH Adj Live Wgt
     C                     ELSE
      * CASE: LCL.Net Head Usr EQ LCL.Zero USR
     C           YL0014    IFEQ YL0088                     *IF
     C                     Z-ADD*ZERO     YL0087           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0015    MULT P1F7NB    YL0089           *Synon (15,2) w
     C           P1CYNB    SUB  YL0089    YL0087           TH Adj Live Wgt
     C                     END                             *FI
     C                     END                             *FI
      * Calculate Adj Actual Yield
     C                     EXSR UESUBR                     Calculate Adj A
      * Calculate Hot Weight
      * CASE: LCL.TH Head Killed NE LCL.Zero USR
     C           YL0016    IFNE YL0088                     *IF
      * Accumulated totals div by head killed
     C           YL0019    DIV  YL0016    YL0091    H      TH Avg Hot Wgt
     C                     Z-ADDYL0091    YL0092           TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0091           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0092           TH Avg Hot Wgt
     C                     END                             *FI
      * Weighted Averages
      * CASE: LCL.TH Hot Wgt NE LCL.Zero USR
     C           YL0019    IFNE YL0088                     *IF
      * Weighted average
     C           YL0026    DIV  YL0019    YL0093    H      TH Avg Lean Per
     C           YL0027    DIV  YL0019    YL0094    H      TH Avg Backfat
     C           YL0028    DIV  YL0019    YL0095    H      TH Avg Loin Eye
     C           YL0029    DIV  YL0019    YL0096    H      TH Avg Light Re
     C                     Z-ADDYL0093    YL0097           TH Avg Lean % E
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0093           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0094           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0095           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0096           TH Avg Light Re
     C                     Z-ADD*ZERO     YL0097           TH Avg Lean % E
     C                     END                             *FI
      * Actual Yield Percent
      * CASE: PAR.TH Live Wgt NE LCL.Zero USR
     C           P1CYNB    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * TH Actual Yield Percent
      * LCL.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0019    DIV  P1CYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0098           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0098           TH Actual Yield
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Calculate Adj Actual Yield
      *================================================================
      * CASE: LCL.TH Adj Live Wgt NE LCL.Zero USR
     C           YL0087    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0019    DIV  YL0087    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0090           TH Adj Actual Y
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0016           TH Head Killed
     C                     SUB  WCAJPC    YL0020           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0021           TH Tot Backfat
     C                     SUB  WCALPC    YL0022           TH Tot Light Re
     C                     SUB  WCAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0128    YL0016           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0396    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0398    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0020    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0397    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0021    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0404    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0022    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0399    MULT WN0396    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0397    MULT WN0396    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0398    MULT WN0396    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0404    MULT WN0396    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0016           TH Head Killed
     C                     SUB  WCAJPC    YL0020           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0021           TH Tot Backfat
     C                     SUB  WCALPC    YL0022           TH Tot Light Re
     C                     SUB  WCAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0128    YL0016           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0451    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0453    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0020    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0452    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0021    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0459    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0022    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0454    MULT WN0451    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0452    MULT WN0451    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0453    MULT WN0451    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0459    MULT WN0451    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0016           TH Head Killed
     C                     SUB  WCAJPC    YL0020           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0021           TH Tot Backfat
     C                     SUB  WCALPC    YL0022           TH Tot Light Re
     C                     SUB  WCAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0128    YL0016           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0506    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0508    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0020    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0507    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0021    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0514    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0022    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0509    MULT WN0506    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0507    MULT WN0506    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0508    MULT WN0506    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0514    MULT WN0506    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0016           TH Head Killed
     C                     SUB  WCAJPC    YL0020           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0021           TH Tot Backfat
     C                     SUB  WCALPC    YL0022           TH Tot Light Re
     C                     SUB  WCAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0128    YL0016           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0561    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0563    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0020    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0562    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0021    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0569    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0022    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0564    MULT WN0561    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0562    MULT WN0561    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0563    MULT WN0561    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0569    MULT WN0561    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0016           TH Head Killed
     C                     SUB  WCAJPC    YL0020           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0021           TH Tot Backfat
     C                     SUB  WCALPC    YL0022           TH Tot Light Re
     C                     SUB  WCAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0128    YL0016           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0616    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0618    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0020    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0617    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0021    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0624    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0022    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0619    MULT WN0616    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0617    MULT WN0616    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0618    MULT WN0616    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0624    MULT WN0616    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0135    YL0016           TH Head Killed
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0673    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0020    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0672    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0021    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0679    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0022    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0671    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0674    MULT WN0671    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0135    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0140           Hot Wgt/Weight
     C                     ADD  YL0140    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0672    MULT WN0671    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0135    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0140           Hot Wgt/Weight
     C                     ADD  YL0140    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0673    MULT WN0671    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0135    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0140           Hot Wgt/Weight
     C                     ADD  YL0140    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0679    MULT WN0671    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0135    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0140           Hot Wgt/Weight
     C                     ADD  YL0140    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * *** 9/17/2018 slm
      * *** 9/17/2018 Change RTV to use lf -- no errors
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
      * Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Loin Eye Depth
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0095    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0020    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Backfat
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0094    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0021    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Light Reflectance
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0096    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0022    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0092    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0019    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           YL0092    MULT YL0097    YL0144           Hot Wgt/Weight
      * Hot Wgt/Lean % Accum Usr
      * PAR.Hot Wgt/Lean % Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/Lean % Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0144    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0026    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           YL0092    MULT YL0094    YL0144           Hot Wgt/Weight
      * Hot Wgt/Backf Accum Usr
      * PAR.Hot Wgt/Backf Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/Backf Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0144    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0027    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           YL0092    MULT YL0095    YL0144           Hot Wgt/Weight
      * Hot Wgt/Loine Accum Usr
      * PAR.Hot Wgt/Loine Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/Loine Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0144    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0028    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           YL0092    MULT YL0096    YL0144           Hot Wgt/Weight
      * Hot Wgt/LghtR Accum Usr
      * PAR.Hot Wgt/LghtR Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/LghtR Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0144    MULT YL0142    W0WA01           *Synon (15,2) w
     C           YL0029    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Re-Calculate Tattoo Header Averages/yield
      *================================================================
      * Calculate Adj Actual Yield
     C                     EXSR UTSUBR                     Calculate Adj A
      * Calculate Hot Weight
      * CASE: LCL.TH Head Killed NE LCL.Zero USR
     C           YL0016    IFNE YL0088                     *IF
      * Accumulated totals div by head killed
     C           YL0019    DIV  YL0016    YL0091    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0091           TH Avg Hot Wgt
     C                     END                             *FI
      * Weighted Averages
      * CASE: LCL.TH Hot Wgt NE LCL.Zero USR
     C           YL0019    IFNE YL0088                     *IF
      * Weighted average
     C           YL0026    DIV  YL0019    YL0093    H      TH Avg Lean Per
     C           YL0027    DIV  YL0019    YL0094    H      TH Avg Backfat
     C           YL0028    DIV  YL0019    YL0095    H      TH Avg Loin Eye
     C           YL0029    DIV  YL0019    YL0096    H      TH Avg Light Re
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0093           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0094           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0095           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0096           TH Avg Light Re
     C                     END                             *FI
      * Actual Yield Percent
      * CASE: PAR.TH Live Wgt NE LCL.Zero USR
     C           P1CYNB    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * TH Actual Yield Percent
      * LCL.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0019    DIV  P1CYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0098           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0098           TH Actual Yield
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Calculate Adj Actual Yield
      *================================================================
      * CASE: LCL.TH Adj Live Wgt NE LCL.Zero USR
     C           YL0087    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0019    DIV  YL0087    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0090           TH Adj Actual Y
     C                     Z-ADDYL0090    YL0106           TH Yld Parm Adj
     C                     END                             *FI
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0016           TH Head Killed
     C                     SUB  WCAJPC    YL0020           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0021           TH Tot Backfat
     C                     SUB  WCALPC    YL0022           TH Tot Light Re
     C                     SUB  WCAMPC    YL0019           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0127           Hot Wgt/Weight
     C                     SUB  YL0127    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0128    YL0016           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0896    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0898    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0020    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0897    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0021    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0904    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0022    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0899    MULT WN0896    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0026           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0897    MULT WN0896    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0027           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0898    MULT WN0896    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0028           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0904    MULT WN0896    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0132           Hot Wgt/Weight
     C                     ADD  YL0132    YL0029           Hot Wgt/LghtR A
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Re-Calculate Tattoo Header Averages/yield
      *================================================================
      * Calculate Adj Actual Yield
     C                     EXSR UXSUBR                     Calculate Adj A
      * Calculate Hot Weight
      * CASE: LCL.TH Head Killed NE LCL.Zero USR
     C           YL0016    IFNE YL0088                     *IF
      * Accumulated totals div by head killed
     C           YL0019    DIV  YL0016    YL0091    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0091           TH Avg Hot Wgt
     C                     END                             *FI
      * Weighted Averages
      * CASE: LCL.TH Hot Wgt NE LCL.Zero USR
     C           YL0019    IFNE YL0088                     *IF
      * Weighted average
     C           YL0026    DIV  YL0019    YL0093    H      TH Avg Lean Per
     C           YL0027    DIV  YL0019    YL0094    H      TH Avg Backfat
     C           YL0028    DIV  YL0019    YL0095    H      TH Avg Loin Eye
     C           YL0029    DIV  YL0019    YL0096    H      TH Avg Light Re
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0093           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0094           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0095           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0096           TH Avg Light Re
     C                     END                             *FI
      * Actual Yield Percent
      * CASE: PAR.TH Live Wgt NE LCL.Zero USR
     C           P1CYNB    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * TH Actual Yield Percent
      * LCL.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0019    DIV  P1CYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0098           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0098           TH Actual Yield
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Calculate Adj Actual Yield
      *================================================================
      * CASE: LCL.TH Adj Live Wgt NE LCL.Zero USR
     C           YL0087    IFNE YL0088                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0019    DIV  YL0087    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0090           TH Adj Actual Y
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1D7ST           TH Header Error
     C                     MOVEL*BLANK    P1D8ST           TH Detail Error
     C                     MOVEL*BLANK    P1DWST           TH Kill Balanci
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHRNB           KV Company Numb
     C                     Z-ADD*ZERO     WABPDT           KV Kill Date
     C                     Z-ADD*ZERO     WAIRNB           KV TATTOO NUMBE
     C                     Z-ADD*ZERO     WABONM           KV Buy Order Nu
     C                     Z-ADD*ZERO     WALDNM           KV Load Number
     C                     Z-ADD*ZERO     WAFPNB           KV Record Numbe
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WCA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WCFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WCHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WCLKNB           ET Lot
     C                     Z-ADD*ZERO     WCAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WCAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WCAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WCAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WCFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WCFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
     C                     Z-ADD*ZERO     WCB8DT           RU Date
     C                     Z-ADD*ZERO     WCAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEBETX           THC Comment Lin
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHUNB           LTN Company Num
     C                     Z-ADD*ZERO     WGA7DT           LTN Kill Date
     C                     Z-ADD*ZERO     WGFHNB           LTN Record Numb
     C                     Z-ADD*ZERO     WGFFNB           LTN Tattoo Numb
     C                     Z-ADD*ZERO     WGDSNB           LTN Wgt
     C                     Z-ADD*ZERO     WGBWCD           LT Type Code
     C                     Z-ADD*ZERO     WGBYCD           LR Reason Code
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
     C                     Z-ADD*ZERO     WGB8DT           RU Date
     C                     Z-ADD*ZERO     WGAOTM           RU Time
      * Define work field LTN Wgt
     C                     Z-ADD*ZERO     WUDSNB  71
      * Define work field LTN Error Sts
     C                     MOVEL*BLANK    WUD1ST  1
      * Define work field Loss Error 1 Usr
     C                     MOVEL*BLANK    WUH9ST  1
      * Define work field Loss Error 2 Usr
     C                     MOVEL*BLANK    WUIAST  1
      * Define work field Loss Error 3 Usr
     C                     MOVEL*BLANK    WUIBST  1
      * Define work field Loss Error 4 Usr
     C                     MOVEL*BLANK    WUICST  1
      * Define work field Loss Error 5 Usr
     C                     MOVEL*BLANK    WULRST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WIBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WIBONB           BOL Load Number
     C                     Z-ADD*ZERO     WICVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WIB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WIAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WIACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WIB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WICAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WIAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WIA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WICXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WICWNB           TH Head Receive
     C                     Z-ADD*ZERO     WIFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WIH9NB           TH Held Over
     C                     Z-ADD*ZERO     WIFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WIFENB           TH Head Killed
     C                     Z-ADD*ZERO     WIHENB           TH Head Adds
     C                     Z-ADD*ZERO     WIHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WICYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WILRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WIE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WIA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WIFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WIA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WIF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WIHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WIF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WIF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WIF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WIF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WIAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WIAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WICWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WIA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WIA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WIB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WIAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WIANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WIAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WIAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WIAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WIAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WIAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WIASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WIA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WIATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WIA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WICBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WICCPR           Th Payment Net
     C                     Z-ADD*ZERO     WILPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WICDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WIA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WIA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WIGHNB           TH Commission A
     C                     Z-ADD*ZERO     WIBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WIBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WIBTDT           TH Commission P
     C                     Z-ADD*ZERO     WIBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WIHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WIHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WIHINB           TH FFLI
     C                     Z-ADD*ZERO     WIA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WIA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WIA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WIJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WID6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WID7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WID8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WID9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WIEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WIEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WIECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WIEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WIEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WIEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WIEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WIEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WIOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WITHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WIT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WITHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WIT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WIOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WIKOER           TH Head Identif
     C                     Z-ADD*ZERO     WIOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WIOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WIIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WIOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WIHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WIS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WITAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WITBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WIJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WIKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WIKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WIKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WIKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WIOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WIIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WIIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WIIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WIKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WIOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WIKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WIORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WIOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WIMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WIMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WINCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WINCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WIIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WIKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WIEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WIEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WIECDT           TH Head LFT
     C                     Z-ADD*ZERO     WIEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WIEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLBONB           BOL Load Number
     C                     Z-ADD*ZERO     WLCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WLB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WLC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WLCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WLC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WLD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WLH7NB           TD Held Over
     C                     Z-ADD*ZERO     WLAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WLJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WLB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WLD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WLBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WLBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WLBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WLHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WLH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WMBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WMBONB           BOL Load Number
     C                     Z-ADD*ZERO     WMCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WMB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WMC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WMLENB           Hot Head
     C                     Z-ADD*ZERO     WMLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WMLINB           Head 2
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAFPC           EV Minimum
     C                     Z-ADD*ZERO     WRAGPC           EV Maximum
     C                     Z-ADD*ZERO     WRAADT           RS Date Changed
     C                     Z-ADD*ZERO     WRAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WRABDT           RS Date Added
     C                     Z-ADD*ZERO     WRABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTY3A1           PH Company Numb
     C                     Z-ADD*ZERO     WTDZDT           PH Week Ending
     C                     Z-ADD*ZERO     WTOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     WTALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     WTKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     WTKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     WTJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     WTOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     WTIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     WTJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     WTUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     WTO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     WTJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     WTG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     WTHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     WTORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     WTHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     WTHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WTS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     WTTCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     WTS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WTTDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WTS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WTTEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WTS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     WTTFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     WTB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     WTJKOS           PH GA DOA
     C                     Z-ADD*ZERO     WTALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     WTKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     WTJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     WTOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     WTIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     WTORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     WTJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     WTPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     WTG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     WTIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     WTG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     WTHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     WTUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     WTHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     WTHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     WTS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     WTTGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     WTS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WTTHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WTS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WTTIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WTS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     WTTJPR           PH GA Gross /Ca
     C                     Z-ADD*ZERO     WTB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Head Accepted
     C                     Z-ADD*ZERO     WUHFNB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH Head Identified
     C                     Z-ADD*ZERO     WUKOER  50
      * Define work field Hot Wgt/Lean % Accum Usr
     C                     Z-ADD*ZERO     WUJONB  91
      * Define work field Hot Wgt/Backf Accum Usr
     C                     Z-ADD*ZERO     WUL0NB  91
      * Define work field Hot Wgt/Loine Accum Usr
     C                     Z-ADD*ZERO     WUL1NB  91
      * Define work field Hot Wgt/LghtR Accum Usr
     C                     Z-ADD*ZERO     WUL2NB  91
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field Net Head Adjusted Usr
     C                     Z-ADD*ZERO     WUZANB  50
      * Define work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     WUCWPC  52
      * Define work field EV Minimum
     C                     Z-ADD*ZERO     WUAFPC  71
      * Define work field EV Maximum
     C                     Z-ADD*ZERO     WUAGPC  71
      * Define work field ET Trim Area
     C                     MOVEL*BLANK    WUDIST  1
      * Define work field ET Carcass Sex
     C                     MOVEL*BLANK    WUFYST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine TYINFN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  50
     C                     Z-ADD*ZERO     WL0004  50
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007 60
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009 10
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013 10
     C                     MOVEL*BLANK    WL0014 10
     C                     MOVEL*BLANK    WL0015 10
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  60
      * Define local work field #Sequence Block
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field TH Header Error Sts
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field TH Detail Error Sts
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0005  6
      * Define local work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Auto Balance HldOvr USR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Hold Over Bal Sts USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YL0009  52
      * Define local work field CDI Shipper User
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field Stress/Market Type
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field Net Head Adjusted Usr
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field TH Head Accepted
     C                     Z-ADD*ZERO     YL0018  50
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0019  71
      * Define local work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YL0020  61
      * Define local work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YL0021  61
      * Define local work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YL0022  61
      * Define local work field TH Head Excluded
     C                     Z-ADD*ZERO     YL0023  50
      * Define local work field TH Head Identified
     C                     Z-ADD*ZERO     YL0024  50
      * Define local work field TH Head Adjusted-LN%
     C                     Z-ADD*ZERO     YL0025  50
      * Define local work field Hot Wgt/Lean % Accum Usr
     C                     Z-ADD*ZERO     YL0026  91
      * Define local work field Hot Wgt/Backf Accum Usr
     C                     Z-ADD*ZERO     YL0027  91
      * Define local work field Hot Wgt/Loine Accum Usr
     C                     Z-ADD*ZERO     YL0028  91
      * Define local work field Hot Wgt/LghtR Accum Usr
     C                     Z-ADD*ZERO     YL0029  91
      * Define local work field #Sequence Block
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field ET Error Sts
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     YL0032  31
      * Define local work field ET Lean Percent FOM
     C                     Z-ADD*ZERO     YL0033  31
      * Define local work field ET Backfat Thickness MM
     C                     Z-ADD*ZERO     YL0034  31
      * Define local work field ET Loineye Depth MM
     C                     Z-ADD*ZERO     YL0035  31
      * Define local work field ET Light Reflectance MM
     C                     Z-ADD*ZERO     YL0036  31
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field ET Adjust/Add Type
     C                     MOVEL*BLANK    YL0038  3
      * Define local work field ET Adjust/Add Source
     C                     MOVEL*BLANK    YL0039  2
      * Define local work field Calculate All Usr
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Lean % Fld 1 Usr
     C                     Z-ADD*ZERO     YL0041 177
      * Define local work field Lean % Fld 2 Usr
     C                     Z-ADD*ZERO     YL0042 177
      * Define local work field Lean % Fld 3 Usr
     C                     Z-ADD*ZERO     YL0043 177
      * Define local work field Lean % Fld 4 Usr
     C                     Z-ADD*ZERO     YL0044 177
      * Define local work field Lean @ Ext 1 Usr
     C                     Z-ADD*ZERO     YL0045 177
      * Define local work field Lean @ Ext 4 Usr
     C                     Z-ADD*ZERO     YL0046 177
      * Define local work field Lean @ Ext 2 Usr
     C                     Z-ADD*ZERO     YL0047 177
      * Define local work field Lean @ Ext 3 Usr
     C                     Z-ADD*ZERO     YL0048 177
      * Define local work field Lean % Fld 5 Usr
     C                     Z-ADD*ZERO     YL0049 177
      * Define local work field Lean @ Ext 5 Usr
     C                     Z-ADD*ZERO     YL0050 177
      * Define local work field KV Error Code
     C                     MOVEL*BLANK    YL0051  3
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0052  91
      * Define local work field Process Flag User
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Zero USR
     C                     Z-ADD*ZERO     YL0054  10
      * Define local work field ET Adjust/Add Source
     C                     MOVEL*BLANK    YL0055  2
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0056  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0057  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0058  31
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0059  31
      * Define local work field PH Summary Type
     C                     MOVEL*BLANK    YL0060  3
      * Define local work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YL0061  51
      * Define local work field PH GA Adjusted Yield%
     C                     Z-ADD*ZERO     YL0062  52
      * Define local work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0063  31
      * Define local work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YL0064  31
      * Define local work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YL0065  31
      * Define local work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YL0066  31
      * Define local work field PH GA Lean Prm /Carc CWT
     C                     Z-ADD*ZERO     YL0067  52
      * Define local work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YL0068  53
      * Define local work field History Avail STS USR
     C                     MOVEL*BLANK    YL0069  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0070  1
      * Define local work field PH Week Ending Date
     C                     Z-ADD*ZERO     YL0071  70
      * Define local work field Calculate All Usr
     C                     MOVEL*BLANK    YL0072  1
      * Define local work field ET Backfat Thickness MM
     C                     Z-ADD*ZERO     YL0073  31
      * Define local work field ET Loineye Depth MM
     C                     Z-ADD*ZERO     YL0074  31
      * Define local work field ET Backfat Thickness Inch
     C                     Z-ADD*ZERO     YL0075  31
      * Define local work field ET Loin-Eye Depth Inches
     C                     Z-ADD*ZERO     YL0076  31
      * Define local work field ET Light Reflectance
     C                     Z-ADD*ZERO     YL0077  31
      * Define local work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     YL0078  31
      * Define local work field ET Error Sts
     C                     MOVEL*BLANK    YL0079  1
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field KV Error Code
     C                     MOVEL*BLANK    YL0081  3
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0082  91
      * Define local work field THC Comment
     C                     MOVEL*BLANK    YL0083 60
      * Define local work field THC Comment Line
     C                     Z-ADD*ZERO     YL0084  30
      * Define local work field TH Percent Identified
     C                     Z-ADD*ZERO     YL0085  52
      * Define local work field TH Percent Accepted
     C                     Z-ADD*ZERO     YL0086  52
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0087  71
      * Define local work field Zero USR
     C                     Z-ADD*ZERO     YL0088  10
      * Define local work field *Synon (15,2) work field
     C                     Z-ADD*ZERO     YL0089 152
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0090  52
      * Define local work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0091  51
      * Define local work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YL0092  71
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0093  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0094  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0095  31
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0096  31
      * Define local work field TH Avg Lean % EXC/ADD
     C                     Z-ADD*ZERO     YL0097  71
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0098  52
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0099  72
      * Define local work field TH PHA Head Adds
     C                     Z-ADD*ZERO     YL0100  50
      * Define local work field TH PHA Add Type
     C                     MOVEL*BLANK    YL0101  1
      * Define local work field TH PHA Average Type
     C                     MOVEL*BLANK    YL0102  3
      * Define local work field TH PHA Add Reason
     C                     MOVEL*BLANK    YL0103  1
      * Define local work field TH PHA Yield Percent
     C                     Z-ADD*ZERO     YL0104  52
      * Define local work field TH PHA Lean Prm /Crc CWT
     C                     Z-ADD*ZERO     YL0105  52
      * Define local work field TH Yld Parm Adj Yield%
     C                     Z-ADD*ZERO     YL0106  52
      * Define local work field TH PHA Sort Disc Fctr %
     C                     Z-ADD*ZERO     YL0107  52
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0108  70
      * Define local work field Day of Week USR
     C                     Z-ADD*ZERO     YL0109  10
      * Define local work field Held Over Days USR
     C                     Z-ADD*ZERO     YL0110  50
      * Define local work field THC Comment
     C                     MOVEL*BLANK    YL0111 60
      * Define local work field THC Comment Line
     C                     Z-ADD*ZERO     YL0112  30
      * Define local work field PH Summary Type
     C                     MOVEL*BLANK    YL0113  3
      * Define local work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YL0114  51
      * Define local work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0115  31
      * Define local work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YL0116  31
      * Define local work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YL0117  31
      * Define local work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YL0118  31
      * Define local work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YL0119  53
      * Define local work field History Avail STS USR
     C                     MOVEL*BLANK    YL0120  1
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0121  51
      * Define local work field THC Comment
     C                     MOVEL*BLANK    YL0122 60
      * Define local work field THC Comment Line
     C                     Z-ADD*ZERO     YL0123  30
      * Define local work field *Synon (15,1) work field
     C                     Z-ADD*ZERO     YL0124 151
      * Define local work field EV Minimum
     C                     Z-ADD*ZERO     YL0125  71
      * Define local work field EV Maximum
     C                     Z-ADD*ZERO     YL0126  71
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0127  91
      * Define local work field Carcass Count USR
     C                     Z-ADD*ZERO     YL0128  30
      * Define local work field Calculate All Usr
     C                     MOVEL*BLANK    YL0129  1
      * Define local work field ET Scale Sequence Number
     C                     Z-ADD*ZERO     YL0130  60
      * Define local work field ET Adjust/Add Source
     C                     MOVEL*BLANK    YL0131  2
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0132  91
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0133  1
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0134  1
      * Define local work field Carcass Count USR
     C                     Z-ADD*ZERO     YL0135  30
      * Define local work field EV Minimum
     C                     Z-ADD*ZERO     YL0136  71
      * Define local work field EV Maximum
     C                     Z-ADD*ZERO     YL0137  71
      * Define local work field Calculate All Usr
     C                     MOVEL*BLANK    YL0138  1
      * Define local work field ET Scale Sequence Number
     C                     Z-ADD*ZERO     YL0139  60
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0140  91
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0141  1
      * Define local work field Carcass Count USR
     C                     Z-ADD*ZERO     YL0142  30
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0143  30
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0144  91
      * Define null work field PH Summary Type
     C                     MOVEL*BLANK    YN0001  3
      * Define null work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YN0002  51
      * Define local work field PH GA Adjusted Yield%
     C                     Z-ADD*ZERO     YL0145  52
      * Define null work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YN0003  31
      * Define null work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YN0004  31
      * Define null work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YN0005  31
      * Define null work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YN0006  31
      * Define null work field PH GA Lean Prm /Carc CWT
     C                     Z-ADD*ZERO     YN0007  52
      * Define null work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YN0008  53
      * Define null work field History Avail STS USR
     C                     MOVEL*BLANK    YN0009  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 BALHLDOVR
00002 Header No Evaluation Recs
00003 *BLANKS
00004 Hot Wgt for Adds Invalid
00005 Producer Hist Not Avail
00006 % Identified > 105%
00007 % Analyzed < 75%
00008 Yield Parameter Error
00009 Held Over Not Balanced
00010 No HST for ReClc Live Wgt
