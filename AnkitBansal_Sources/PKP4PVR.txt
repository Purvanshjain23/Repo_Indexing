     H/TITLE Tmp Scale Weight      PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 08/21/03  Time  : 17:01:40
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKP4PVR#CF  E                    WORKSTN
     F                                              KNUM        1
     F                                              KINFDS INFDS#
      * DSP: Tmp Scale Weight      PV  Prompt & validate record
      *
     FPKEJCPL3IF  E           K        DISK
      * RTV : Buy Order Load Weight     Retrieval Index 2
      *
     FPLAECPL3IF  E           K        DISK
      * RSQ : Delivery Sched Detail     Movement #
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKAZREL1IF  E           K        DISK
      * RTV : Company Control HPE       Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKEJCPL0IF  E           K        DISK                      A
      * UPD : Buy Order Load Weight     Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     I@EJCPBU
      * Buy Order Load Weight     Retrieval Index 2
      * Renamed input format fields
     I              EJHONB                          WAHONB
     I              EJABCD                          WAABCD
     I              EJAECD                          WAAECD
     I              EJBOMV                          WABOMV
     I              EJSRST                          WASRST
     I              EJBOSW                          WABOSW
     I              EJDQDT                          WADQDT
     I              EJA2TM                          WAA2TM
     I              EJSSST                          WASSST
     I              EJSTST                          WASTST
     I              EJSUST                          WASUST
     I              EJHMNB                          WAHMNB
     I              EJBNNB                          WABNNB
     I              EJBONB                          WABONB
     I              EJAAVN                          WAAAVN
     I              EJAADT                          WAAADT
     I              EJAMTM                          WAAMTM
     I              EJAJST                          WAAJST
     I              EJAHVN                          WAAHVN
     I              EJAGVN                          WAAGVN
     I              EJABVN                          WAABVN
     I              EJABDT                          WAABDT
     I              EJABTM                          WAABTM
      *
     I@EJCPBH
      * Buy Order Load Weight     Update index
      * Renamed input format fields
     I              EJHONB                          WBHONB
     I              EJABCD                          WBABCD
     I              EJAECD                          WBAECD
     I              EJBOMV                          WBBOMV
     I              EJSRST                          WBSRST
     I              EJBOSW                          WBBOSW
     I              EJDQDT                          WBDQDT
     I              EJA2TM                          WBA2TM
     I              EJSSST                          WBSSST
     I              EJSTST                          WBSTST
     I              EJSUST                          WBSUST
     I              EJHMNB                          WBHMNB
     I              EJBNNB                          WBBNNB
     I              EJBONB                          WBBONB
     I              EJAAVN                          WBAAVN
     I              EJAADT                          WBAADT
     I              EJAMTM                          WBAMTM
     I              EJAJST                          WBAJST
     I              EJAHVN                          WBAHVN
     I              EJAGVN                          WBAGVN
     I              EJABVN                          WBABVN
     I              EJABDT                          WBABDT
     I              EJABTM                          WBABTM
      *
     I@AECPJB
      * Delivery Sched Detail     Movement #
      * Renamed input format fields
     I              AEHONB                          WCHONB
     I              AEE0DT                          WCE0DT
     I              AEE6DT                          WCE6DT
     I              AEAGTH                          WCAGTH
     I              AEHZA1                          WCHZA1
     I              AEH0A1                          WCH0A1
     I              AEH1A1                          WCH1A1
     I              AEJ4CD                          WCJ4CD
     I              AEJ5CD                          WCJ5CD
     I              AELBCD                          WCLBCD
     I              AELCCD                          WCLCCD
     I              AEIOA1                          WCIOA1
     I              AEH2A1                          WCH2A1
     I              AEIJA1                          WCIJA1
     I              AEK9CD                          WCK9CD
     I              AEK8CD                          WCK8CD
     I              AEJ6CD                          WCJ6CD
     I              AEJ7CD                          WCJ7CD
     I              AEMGCD                          WCMGCD
     I              AEW1ST                          WCW1ST
     I              AEW2ST                          WCW2ST
     I              AEH3A1                          WCH3A1
     I              AEMECD                          WCMECD
     I              AEMFCD                          WCMFCD
     I              AEW4ST                          WCW4ST
     I              AEXWST                          WCXWST
     I              AEFRDT                          WCFRDT
     I              AEBOTH                          WCBOTH
     I              AEE7DT                          WCE7DT
     I              AEAHTH                          WCAHTH
     I              AEE8DT                          WCE8DT
     I              AEAITH                          WCAITH
     I              AEXBST                          WCXBST
     I              AEXGST                          WCXGST
     I              AEXPST                          WCXPST
     I              AEXNST                          WCXNST
     I              AEXTST                          WCXTST
     I              AEXLST                          WCXLST
     I              AEW0ST                          WCW0ST
     I              AEYEST                          WCYEST
     I              AEFZDT                          WCFZDT
     I              AEB1TH                          WCB1TH
     I              AEAACD                          WCAACD
     I              AEABCD                          WCABCD
     I              AEAECD                          WCAECD
     I              AEHMNB                          WCHMNB
     I              AEBNNB                          WCBNNB
     I              AEBONB                          WCBONB
     I              AEAAVN                          WCAAVN
     I              AEAADT                          WCAADT
     I              AEAMTM                          WCAMTM
     I              AEAJST                          WCAJST
     I              AEAHVN                          WCAHVN
     I              AEAGVN                          WCAGVN
     I              AEABVN                          WCABVN
     I              AEABDT                          WCABDT
     I              AEABTM                          WCABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WDHMNB
     I              AXBNNB                          WDBNNB
     I              AXBONB                          WDBONB
     I              AXCQDT                          WDCQDT
     I              AXABTH                          WDABTH
     I              AXACTH                          WDACTH
     I              AXBPNB                          WDBPNB
     I              AXCSNB                          WDCSNB
     I              AXAUDT                          WDAUDT
     I              AXCMST                          WDCMST
     I              AXAGPR                          WDAGPR
     I              AXATVA                          WDATVA
     I              AXI1ST                          WDI1ST
     I              AXDHNB                          WDDHNB
     I              AXDINB                          WDDINB
     I              AXCNST                          WDCNST
     I              AXGINB                          WDGINB
     I              AXBZDT                          WDBZDT
     I              AXLSNB                          WDLSNB
     I              AXF3TX                          WDF3TX
     I              AXO8ST                          WDO8ST
     I              AXO9ST                          WDO9ST
     I              AXPAST                          WDPAST
     I              AXLDSH                          WDLDSH
     I              AXPBST                          WDPBST
     I              AXPCST                          WDPCST
     I              AXPDST                          WDPDST
     I              AXUWST                          WDUWST
     I              AXUXST                          WDUXST
     I              AXUYST                          WDUYST
     I              AXJKRU                          WDJKRU
     I              AXKEOR                          WDKEOR
     I              AXIOEW                          WDIOEW
     I              AXKJIO                          WDKJIO
     I              AXIOJR                          WDIOJR
     I              AXEIRR                          WDEIRR
     I              AXITMF                          WDITMF
     I              AXODJE                          WDODJE
     I              AXRJIF                          WDRJIF
     I              AXOEJF                          WDOEJF
     I              AXD0DT                          WDD0DT
     I              AXD1DT                          WDD1DT
     I              AXD2DT                          WDD2DT
     I              AXD3DT                          WDD3DT
     I              AXD4DT                          WDD4DT
     I              AXBNCD                          WDBNCD
     I              AXABCD                          WDABCD
     I              AXAECD                          WDAECD
     I              AXAAVN                          WDAAVN
     I              AXAADT                          WDAADT
     I              AXAMTM                          WDAMTM
     I              AXAJST                          WDAJST
     I              AXAHVN                          WDAHVN
     I              AXAGVN                          WDAGVN
     I              AXABVN                          WDABVN
     I              AXABDT                          WDABDT
     I              AXABTM                          WDABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WEHMNB
     I              AXBNNB                          WEBNNB
     I              AXBONB                          WEBONB
     I              AXCQDT                          WECQDT
     I              AXABTH                          WEABTH
     I              AXACTH                          WEACTH
     I              AXBPNB                          WEBPNB
     I              AXCSNB                          WECSNB
     I              AXAUDT                          WEAUDT
     I              AXCMST                          WECMST
     I              AXAGPR                          WEAGPR
     I              AXATVA                          WEATVA
     I              AXI1ST                          WEI1ST
     I              AXDHNB                          WEDHNB
     I              AXDINB                          WEDINB
     I              AXCNST                          WECNST
     I              AXGINB                          WEGINB
     I              AXBZDT                          WEBZDT
     I              AXLSNB                          WELSNB
     I              AXF3TX                          WEF3TX
     I              AXO8ST                          WEO8ST
     I              AXO9ST                          WEO9ST
     I              AXPAST                          WEPAST
     I              AXLDSH                          WELDSH
     I              AXPBST                          WEPBST
     I              AXPCST                          WEPCST
     I              AXPDST                          WEPDST
     I              AXUWST                          WEUWST
     I              AXUXST                          WEUXST
     I              AXUYST                          WEUYST
     I              AXJKRU                          WEJKRU
     I              AXKEOR                          WEKEOR
     I              AXIOEW                          WEIOEW
     I              AXKJIO                          WEKJIO
     I              AXIOJR                          WEIOJR
     I              AXEIRR                          WEEIRR
     I              AXITMF                          WEITMF
     I              AXODJE                          WEODJE
     I              AXRJIF                          WERJIF
     I              AXOEJF                          WEOEJF
     I              AXD0DT                          WED0DT
     I              AXD1DT                          WED1DT
     I              AXD2DT                          WED2DT
     I              AXD3DT                          WED3DT
     I              AXD4DT                          WED4DT
     I              AXBNCD                          WEBNCD
     I              AXABCD                          WEABCD
     I              AXAECD                          WEAECD
     I              AXAAVN                          WEAAVN
     I              AXAADT                          WEAADT
     I              AXAMTM                          WEAMTM
     I              AXAJST                          WEAJST
     I              AXAHVN                          WEAHVN
     I              AXAGVN                          WEAGVN
     I              AXABVN                          WEABVN
     I              AXABDT                          WEABDT
     I              AXABTM                          WEABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@AZCPCN
      * Company Control HPE       Retrieval index
      * Renamed input format fields
     I              AZHONB                          WHHONB
     I              AZBSNB                          WHBSNB
     I              AZB1DT                          WHB1DT
     I              AZB2DT                          WHB2DT
     I              AZH4NB                          WHH4NB
     I              AZK3NB                          WHK3NB
     I              AZCDDT                          WHCDDT
     I              AZCEDT                          WHCEDT
     I              AZAAVN                          WHAAVN
     I              AZAADT                          WHAADT
     I              AZAMTM                          WHAMTM
     I              AZAJST                          WHAJST
     I              AZAHVN                          WHAHVN
     I              AZAGVN                          WHAGVN
     I              AZABVN                          WHABVN
     I              AZABDT                          WHABDT
     I              AZABTM                          WHABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WIABCD
     I              AFAECD                          WIAECD
     I              AFA8TX                          WIA8TX
     I              AFGLNB                          WIGLNB
     I              AFATST                          WIATST
     I              AFASNB                          WIASNB
     I              AFAUST                          WIAUST
     I              AFQNST                          WIQNST
     I              AFQOST                          WIQOST
     I              AFQPST                          WIQPST
     I              AFQQST                          WIQQST
     I              AFQRST                          WIQRST
     I              AFN0TX                          WIN0TX
     I              AFQSST                          WIQSST
     I              AFQTST                          WIQTST
     I              AFQUST                          WIQUST
     I              AFQVST                          WIQVST
     I              AFR8ST                          WIR8ST
     I              AFR9ST                          WIR9ST
     I              AFSAST                          WISAST
     I              AFSBST                          WISBST
     I              AFSDST                          WISDST
     I              AFSEST                          WISEST
     I              AFSFST                          WISFST
     I              AFHWNB                          WIHWNB
     I              AFFUCD                          WIFUCD
     I              AFAAVN                          WIAAVN
     I              AFAADT                          WIAADT
     I              AFAMTM                          WIAMTM
     I              AFAJST                          WIAJST
     I              AFAHVN                          WIAHVN
     I              AFAGVN                          WIAGVN
     I              AFABVN                          WIABVN
     I              AFABDT                          WIABDT
     I              AFABTM                          WIABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPKEJ1    E DSPKEJCPL0
      * UPD : Buy Order Load Weight     Update index
      * Renamed input format fields
     I              EJHONB                          WBHONB
     I              EJABCD                          WBABCD
     I              EJAECD                          WBAECD
     I              EJBOMV                          WBBOMV
     I              EJSRST                          WBSRST
     I              EJBOSW                          WBBOSW
     I              EJDQDT                          WBDQDT
     I              EJA2TM                          WBA2TM
     I              EJSSST                          WBSSST
     I              EJSTST                          WBSTST
     I              EJSUST                          WBSUST
     I              EJHMNB                          WBHMNB
     I              EJBNNB                          WBBNNB
     I              EJBONB                          WBBONB
     I              EJAAVN                          WBAAVN
     I              EJAADT                          WBAADT
     I              EJAMTM                          WBAMTM
     I              EJAJST                          WBAJST
     I              EJAHVN                          WBAHVN
     I              EJAGVN                          WBAGVN
     I              EJABVN                          WBABVN
     I              EJABDT                          WBABDT
     I              EJABTM                          WBABTM
      *
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WEHMNB
     I              AXBNNB                          WEBNNB
     I              AXBONB                          WEBONB
     I              AXCQDT                          WECQDT
     I              AXABTH                          WEABTH
     I              AXACTH                          WEACTH
     I              AXBPNB                          WEBPNB
     I              AXCSNB                          WECSNB
     I              AXAUDT                          WEAUDT
     I              AXCMST                          WECMST
     I              AXAGPR                          WEAGPR
     I              AXATVA                          WEATVA
     I              AXI1ST                          WEI1ST
     I              AXDHNB                          WEDHNB
     I              AXDINB                          WEDINB
     I              AXCNST                          WECNST
     I              AXGINB                          WEGINB
     I              AXBZDT                          WEBZDT
     I              AXLSNB                          WELSNB
     I              AXF3TX                          WEF3TX
     I              AXO8ST                          WEO8ST
     I              AXO9ST                          WEO9ST
     I              AXPAST                          WEPAST
     I              AXLDSH                          WELDSH
     I              AXPBST                          WEPBST
     I              AXPCST                          WEPCST
     I              AXPDST                          WEPDST
     I              AXUWST                          WEUWST
     I              AXUXST                          WEUXST
     I              AXUYST                          WEUYST
     I              AXJKRU                          WEJKRU
     I              AXKEOR                          WEKEOR
     I              AXIOEW                          WEIOEW
     I              AXKJIO                          WEKJIO
     I              AXIOJR                          WEIOJR
     I              AXEIRR                          WEEIRR
     I              AXITMF                          WEITMF
     I              AXODJE                          WEODJE
     I              AXRJIF                          WERJIF
     I              AXOEJF                          WEOEJF
     I              AXD0DT                          WED0DT
     I              AXD1DT                          WED1DT
     I              AXD2DT                          WED2DT
     I              AXD3DT                          WED3DT
     I              AXD4DT                          WED4DT
     I              AXBNCD                          WEBNCD
     I              AXABCD                          WEABCD
     I              AXAECD                          WEAECD
     I              AXAAVN                          WEAAVN
     I              AXAADT                          WEAADT
     I              AXAMTM                          WEAMTM
     I              AXAJST                          WEAJST
     I              AXAHVN                          WEAHVN
     I              AXAGVN                          WEAGVN
     I              AXABVN                          WEABVN
     I              AXABDT                          WEABDT
     I              AXABTM                          WEABTM
      *
     IYARDCS      DS                            236
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     IYBRDCS      DS                            582
     IYCRDCS      DS                            236
     IYDRDCS      DS                            582
     IYERDCS      DS                            236
     IYFRDCS      DS                            582
     IYGRDCS      DS                            236
     IYHRDCS      DS                            582
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Buy Order Load Weight
      * I : MAP CC Company Number
     I                                    P   1   20P1HONB
      * I : MAP PD Producer Code
     I                                        3   8 P1ABCD
      * I : MAP PL Location Code
     I                                        9  14 P1AECD
      * I : MAP BOLW Movement Number
     I                                    P  15  180P1BOMV
      * I : MAP BOLW Weight Type
     I                                       19  19 P1SRST
     IP2PARM      DS
      * I :  Oms Name
     I                                        1  30 P2EUTX
     IP3PARM      DS
      * I :  PD Name
     I                                        1  40 P3AGTX
     IP4PARM      DS
      * I :  PL Name
     I                                        1  40 P4A8TX
     IP5PARM      DS
      * I :  Weight Type Desc USR
     I                                        1   3 P5OKTX
     IP6PARM      DS
      * I :  Scheduled Kill Date   USR
     I                                    P   1   40P6DRDT
     IP7PARM      DS
      * FLD: *Arrays
      * N :  Oms Warehouse Code
     I                                        1   3 P7J8NB
      * N :  Oms Application Code
     I                                        4   9 P7C7CD
      * N :  Oms SalesPerson Code
     I                                       10  12 P7C8CD
      * N :  Oms Allow Multi-Company
     I                                       13  13 P7G8ST
      * N :  Oms Default Printer
     I                                       14  23 P7G9ST
      * N :  Oms System Value Alpha
     I                                       24  63 P7EVTX
      * N :  Oms Access Denied (Y/N)
     I                                       64  64 P7HAST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1ABCD    PARM           WP0002  6        PD Producer Cod
     C           P1AECD    PARM           WP0003  6        PL Location Cod
     C           P1BOMV    PARM           WP0004  70       BOLW Movement N
     C           P1SRST    PARM           WP0005  1        BOLW Weight Typ
     C           P2EUTX    PARM           WP0006 30        Oms Name
     C           P3AGTX    PARM           WP0007 40        PD Name
     C           P4A8TX    PARM           WP0008 40        PL Name
     C           P5OKTX    PARM           WP0009  3        Weight Type Des
     C           P6DRDT    PARM           WP0010  70       Scheduled Kill
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C           @#STCD    DOUNE1331
      * Invite
     C                     SETON                     83    *
     C                     WRITE#RCDDTL1
     C                     SETOF                     83
     C                     SETOF                     8625  *
     C                     READ PKP4PVR#               9090*
     C           *IN90     IFEQ '1'
     C           @#STCD    ANDEQ1331
     C                     WRITE#CNLINVT               90  *
     C           *IN90     IFEQ '1'
      * Write failed - clear outstanding read request
     C                     READ PKP4PVR#               9090*
     C                     END
     C                     CALL 'Y2WSTOC'
     C                     PARM           PGMDS
      * Force PUTOVR; suppress OVRDTA, OVRATR
     C                     SETON                     8625  *
     C                     Z-ADD1331      @#STCD
     C                     END                             FI *IN90
     C                     END                             UOD STCD
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
      * F22
      * CASE: DTL.*CMD key is CF22
     C           *IN22     IFEQ '1'                        *IF
      * CASE: DTL.BOLW Weight Type is Out
     C           #1SRST    IFEQ 'O'                        *IF
      * Rtv Buy Order Load    RT - Buy Order Load Weight  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * CASE: DTL.BOLW Scale Weight is Greater then Zero
     C           #1BOSW    IFGT *ZERO                      *IF
      * Crt Scale BOL Weight  CR - Buy Order Load Weight  * 
     C                     EXSR SBCRRC
      * Send message '700 Truck Wgt Accepted'
     C                     MOVEL'PRK0852' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.*CMD key is CF12
     C           *IN12     IFEQ '1'                        *IF
      * CASE: DTL.BOLW Weight Type is Out
     C           #1SRST    IFEQ 'O'                        *IF
      * Rtv Buy Order Load    RT - Buy Order Load Weight  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * CASE: DTL.BOLW Scale Weight is Greater then Zero
     C           #1BOSW    IFGT *ZERO                      *IF
      * Crt Scale BOL Weight  CR - Buy Order Load Weight  * 
     C                     EXSR SMCRRC
      * Send message '700 Truck Wgt Accepted'
     C                     MOVEL'PRK0852' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message '500 Truck Wgt Not Acpt'
     C                     MOVEL'PRK0851' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * F12
      * CASE: DTL.*CMD key is CF12
     C           *IN12     IFEQ '1'                        *IF
      * CASE: DTL.BOLW Weight Type is In
     C           #1SRST    IFEQ 'I'                        *IF
     C                     Z-ADD50000     #1BOSW           BOLW Scale Weig
     C                     ELSE
      * CASE: DTL.BOLW Weight Type is Out
     C           #1SRST    IFEQ 'O'                        *IF
     C                     Z-ADD8000      #1BOSW           BOLW Scale Weig
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Company Control HPE
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Buy Order Load
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * BOLW Scale Weight required
     C           #1BOSW    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     MOVEL*BLANK    #DEUTX           Oms Name
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #DAGTX           PD Name
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVEL*BLANK    #DA8TX           PL Name
     C                     MOVELP1SRST    #1SRST           BOLW Weight Typ
     C                     Z-ADD*ZERO     #1DQDT           BOLW Scale Weig
     C                     Z-ADD*ZERO     #1A2TM           BOLW Scale Weig
     C                     MOVEL*BLANK    #1SSST           BOLW Spread Sta
     C                     MOVEL*BLANK    #1STST           BOLW Unused Sts
     C                     MOVEL*BLANK    #1SUST           BOLW Unused Sts
     C                     Z-ADD*ZERO     #1HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1BONB           BOL Load Number
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADDP1BOMV    #1BOMV           BOLW Movement N
     C                     Z-ADD*ZERO     #1BOSW           BOLW Scale Weig
     C                     MOVEL*BLANK    #DOKTX           Weight Type Des
      * USER: Load screen
      * Time Out Exit         US - Buy Order Load Weight  * 
     C           @#STCD    IFEQ 1331
     C                     EXSR ZXEXPG
     C                     END
      * DTL = PAR By name
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     MOVELP2EUTX    #DEUTX           Oms Name
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP3AGTX    #DAGTX           PD Name
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVELP4A8TX    #DA8TX           PL Name
     C                     MOVELP1SRST    #1SRST           BOLW Weight Typ
     C                     Z-ADDP1BOMV    #1BOMV           BOLW Movement N
     C                     MOVELP5OKTX    #DOKTX           Weight Type Des
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Buy Order Load    RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAAECD           PL Location Cod
     C                     KFLD           WABOMV           BOLW Movement N
     C                     KFLD           WASRST           BOLW Weight Typ
      * Setup key
     C                     Z-ADD#1HONB    WAHONB           CC Company Numb
     C                     MOVEL#1ABCD    WAABCD           PD Producer Cod
     C                     MOVEL#1AECD    WAAECD           PL Location Cod
     C                     Z-ADD#1BOMV    WABOMV           BOLW Movement N
     C                     MOVEL'I'       WASRST           BOLW Weight Typ
      * Establish starting position
     C           KRSSA     CHAIN@EJCPBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1BONB           BOL Load Number
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAHMNB    #1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    #1BONB           BOL Load Number
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Scale BOL Weight  CR - Buy Order Load Weight  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 10        Group Reference
     C                     MOVEL*BLANK    WN0002  5        HPS FS Comp Rel
     C                     MOVEL*BLANK    WN0003  1        BOL Truck Scale
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EJCPBH
     C                     Z-ADD#1HONB    WBHONB           CC Company Numb
     C                     MOVEL#1ABCD    WBABCD           PD Producer Cod
     C                     MOVEL#1AECD    WBAECD           PL Location Cod
     C                     Z-ADD#1BOMV    WBBOMV           BOLW Movement N
     C                     MOVEL#1SRST    WBSRST           BOLW Weight Typ
     C                     Z-ADD#1BOSW    WBBOSW           BOLW Scale Weig
     C                     Z-ADD#1DQDT    WBDQDT           BOLW Scale Weig
     C                     Z-ADD#1A2TM    WBA2TM           BOLW Scale Weig
     C                     MOVEL#1SSST    WBSSST           BOLW Spread Sta
     C                     MOVEL#1STST    WBSTST           BOLW Unused Sts
     C                     MOVEL#1SUST    WBSUST           BOLW Unused Sts
     C                     Z-ADD#1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WBBONB           BOL Load Number
     C                     MOVEL#1AAVN    WBAAVN           RS User Changed
     C                     Z-ADD#1AADT    WBAADT           RS Date Changed
     C                     Z-ADD#1AMTM    WBAMTM           RS Time Changed
     C                     MOVEL#1AJST    WBAJST           RS Record Statu
     C                     MOVEL#1AHVN    WBAHVN           RS Job
     C                     MOVEL#1AGVN    WBAGVN           RS Program
     C                     MOVEL#1ABVN    WBABVN           RS User Added
     C                     Z-ADD#1ABDT    WBABDT           RS Date Added
     C                     Z-ADD#1ABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
      * Rtv System Date       UP - STR User Source Functions  * 
     C                     CALL 'PKPSUPR'              90  Rtv System Date
     C           WUVCNB    PARM *ZERO     WQ0001  70       *DATE
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPSUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Rtv Current Time      US - STR User Source Functions  * 
     C                     TIME           WBABTM
      * DB1.BOLW Scale Weight Date = WRK.System Value Numeric  USR
     C                     Z-ADDWUVCNB    WBDQDT           BOLW Scale Weig
      * DB1.RS Date Added = WRK.System Value Numeric  USR
     C                     Z-ADDWUVCNB    WBABDT           RS Date Added
     C                     Z-ADDWBABTM    WBA2TM           BOLW Scale Weig
      * CASE: PAR.BOLW Weight Type is In
     C           #1SRST    IFEQ 'I'                        *IF
      * *-----------------------------------------------------------*
      * * 01/23/03 PKD PK0495-Retrieve the Buy Order and Load Number
      *                the Delivery Schedule Detail File instead of the
      *                next available load.
      * Rtv Buy Order Load    RT - Delivery Sched Detail  * 
     C                     EXSR SCRVGN
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: PAR.BOLW Weight Type is Out
     C           #1SRST    IFEQ 'O'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Rtv HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0002  7        *Return code
     C                     PARM #1BOMV    WQ0003  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0004 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0005  50       Farm Site USR
     C           WN0002    PARM *BLANK    WQ0006  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0007  3        State
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * BOL Truck Scale Weight Status
      * CASE: PAR.HPS FS Comp Relation USR is Contract
     C           WN0002    IFEQ 'CON'                      *IF
     C                     MOVEL'N'       WN0003           BOL Truck Scale
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'O'       WN0003           BOL Truck Scale
     C                     END                             *FI
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KLCRSB    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBABCD           PD Producer Cod
     C                     KFLD           WBAECD           PL Location Cod
     C                     KFLD           WBBOMV           BOLW Movement N
     C                     KFLD           WBSRST           BOLW Weight Typ
      * Check for duplicate primary key
     C           KLCRSB    SETLL@EJCPBH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0842' W0RTN   7
      * Send message 'Buy Order Load Weight  EX'
     C                     MOVEL'PRK0842' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@EJCPBH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     Z-ADDWBBNNB    #1BNNB           Buy Order Numbe
     C                     Z-ADDWBBONB    #1BONB           Load Number
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Load    RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHONB    WQSC01           CC Company Numb
     C           *LIKE     DEFN WCH3A1    WQSC02           DSD Movement Nu
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CC Company Numb
     C                     KFLD           WQSC02           DSD Movement Nu
      * Setup key
     C                     Z-ADD#1HONB    WQSC01           CC Company Numb
     C                     Z-ADD#1BOMV    WQSC02           DSD Movement Nu
      * Establish starting position
     C           KRSSC     SETLL@AECPJB                    *
     C           KRSSC     READE@AECPJB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Return Code USR
     C                     Z-ADD*ZERO     YL0002           DSH Kill Date
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     MOVEL'Y2U0005' YL0001           Return Code USR
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCE0DT    YL0002           DSH Kill Date
     C                     Z-ADDWCHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WBBONB           BOL Load Number
     C                     MOVEL*BLANK    YL0001           Return Code USR
     C           KRSSC     READE@AECPJB                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
      * Setup key
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WDBONB           BOL Load Number
      * Establish starting position
     C           KRSSD     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'I'       IFEQ 'R'                        *IF
     C           WDPAST    IFEQ 'I'                        *IF
     C           WDPAST    OREQ 'N'
     C           WDPAST    OREQ *BLANK
     C           WDPAST    OREQ 'O'
     C           WDPAST    OREQ 'R'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR SECHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           'I'       IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0005  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0006  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0007  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0008  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0009  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0010  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0011  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0012  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0013  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0014  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0015  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0016  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0017  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0018  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0019  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0020 11        BOL Trailer
     C                     MOVEL*BLANK    WN0021  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0022  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0023  1        Reported to USD
     C                     MOVEL*BLANK    WN0024  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0025  1        BOL Status 4
     C                     MOVEL*BLANK    WN0026  2        BOL Status 5
     C                     MOVEL*BLANK    WN0027  2        BOL Status 6
     C                     MOVEL*BLANK    WN0028  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0029  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0030  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0031  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0032  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0033  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0034 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0035 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0036 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0037 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0038 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0039  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0040  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0041  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0042  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0043  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0044  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0045  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0046  6        PL Location Cod
     C                     MOVEL*BLANK    WN0047 10        RS User Changed
     C                     Z-ADD*ZERO     WN0048  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0049  60       RS Time Changed
     C                     MOVEL*BLANK    WN0050  1        RS Record Statu
     C                     MOVEL*BLANK    WN0051 10        RS Job
     C                     MOVEL*BLANK    WN0052 10        RS Program
     C                     MOVEL*BLANK    WN0053 10        RS User Added
     C                     Z-ADD*ZERO     WN0054  70       RS Date Added
     C                     Z-ADD*ZERO     WN0055  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C           KLCHSE    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YARDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'I'       WEPAST    P      BOL Truck Scale
     C                     Z-ADDWDLDSH    WELDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSF03           BOL Load Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSF01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSF03           BOL Load Number
      * Establish starting position
     C           KRSSF     SETLL@A1CPC4                    *
     C           KRSSF     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WFLLST    IFEQ 'M'                        *IF
     C           WFLLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C           KRSSF     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0056  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0057 10        TH Group Refere
     C                     MOVEL*BLANK    WN0058  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0059  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0060  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0061  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0062  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0063  52       TH Resale Price
     C                     Z-ADD*ZERO     WN0064  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0065  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0066  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0067  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0068  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0069  50       TH Held Over
     C                     Z-ADD*ZERO     WN0070  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0071  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0072  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0073  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0074  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0075  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0076  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0077  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0078  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0079  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0080  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0081  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0082  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0083  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0084  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0085  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0086  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0087  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0088  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0089  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0090  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0091  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0092  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0093  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0094  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0095  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0096  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0097  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0098  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0099  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0100  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0101  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0102  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0103  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0104  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0105  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0106  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0107  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0108  72       TH Actual Value
     C                     MOVEL*BLANK    WN0109  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0110  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0111  1        TH Detail Error
     C                     MOVEL*BLANK    WN0112  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0113  80       TH Commission A
     C                     Z-ADD*ZERO     WN0114  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0115  1        TH User Error O
     C                     MOVEL*BLANK    WN0116  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0117  1        TH Sex
     C                     Z-ADD*ZERO     WN0118  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0119  70       TH Commission P
     C                     Z-ADD*ZERO     WN0120  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0121  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0122  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0123  31       TH FFLI
     C                     Z-ADD*ZERO     WN0124  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0125  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0126  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0127  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0128  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0129  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0130  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0131  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0132  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0133  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0134  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0135  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0136  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0137  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0138  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0139  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0140  1        TH Source Type
     C                     MOVEL*BLANK    WN0141  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0142  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0143  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0144  3        TH Source Code
     C                     MOVEL*BLANK    WN0145  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0146  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0147  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0148  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0149  3        TH State
     C                     MOVEL*BLANK    WN0150  3        TH Unused Code
     C                     MOVEL*BLANK    WN0151  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0152  1        TH Commission S
     C                     MOVEL*BLANK    WN0153  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0154  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0155  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0156  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0157  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0158  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0159  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0160  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0161  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0162  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0163  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0164  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0165  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0166  3        TH PHA Average
     C                     MOVEL*BLANK    WN0167  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0168  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0169  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0170  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0171  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0172  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0173  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0174  70       TH Unused Nbr 3
     C                     Z-ADD*ZERO     WN0175  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0176  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0177  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0178  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0179  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0180 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0181 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0182 112       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0183 112       TH Unsued Nbr 1
     C                     Z-ADD*ZERO     WN0184  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0185  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0186  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0187  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0188  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0189  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0190  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0191  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0192  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0193  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0194  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0195  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0196  70       TH Unused Date
     C                     MOVEL*BLANK    WN0197  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0198  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0199  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0200  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0201  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0202  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0203  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0204  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0205  6        DF Defect Code
     C                     MOVEL*BLANK    WN0206  6        THP Process Cod
     C                     MOVEL*BLANK    WN0207  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0208  6        PL Location Cod
     C                     MOVEL*BLANK    WN0209  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0210  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0211  3        HC Class Code
     C                     MOVEL*BLANK    WN0212 10        RS User Changed
     C                     Z-ADD*ZERO     WN0213  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0214  60       RS Time Changed
     C                     MOVEL*BLANK    WN0215  1        RS Record Statu
     C                     MOVEL*BLANK    WN0216 10        RS Job
     C                     MOVEL*BLANK    WN0217 10        RS Program
     C                     MOVEL*BLANK    WN0218 10        RS User Added
     C                     Z-ADD*ZERO     WN0219  70       RS Date Added
     C                     Z-ADD*ZERO     WN0220  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSG    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       WGD7ST    P      TH Header Error
     C                     MOVEL'E'       WGDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WDBONB           BOL Load Number
      * Establish starting position
     C           KRSSH     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0003    IFEQ 'R'                        *IF
     C           WDPAST    IFEQ 'I'                        *IF
     C           WDPAST    OREQ 'N'
     C           WDPAST    OREQ *BLANK
     C           WDPAST    OREQ 'O'
     C           WDPAST    OREQ 'R'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR SICHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           WN0003    IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0221  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0222  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0223  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0224  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0225  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0226  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0227  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0228  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0229  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0230  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0231  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0232  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0233  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0234  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0235  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0236  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0237 11        BOL Trailer
     C                     MOVEL*BLANK    WN0238  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0239  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0240  1        Reported to USD
     C                     MOVEL*BLANK    WN0241  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0242  1        BOL Status 4
     C                     MOVEL*BLANK    WN0243  2        BOL Status 5
     C                     MOVEL*BLANK    WN0244  2        BOL Status 6
     C                     MOVEL*BLANK    WN0245  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0246  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0247  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0248  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0249  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0250  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0251 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0252 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0253 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0254 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0255 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0256  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0257  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0258  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0259  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0260  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0261  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0262  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0263  6        PL Location Cod
     C                     MOVEL*BLANK    WN0264 10        RS User Changed
     C                     Z-ADD*ZERO     WN0265  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0266  60       RS Time Changed
     C                     MOVEL*BLANK    WN0267  1        RS Record Statu
     C                     MOVEL*BLANK    WN0268 10        RS Job
     C                     MOVEL*BLANK    WN0269 10        RS Program
     C                     MOVEL*BLANK    WN0270 10        RS User Added
     C                     Z-ADD*ZERO     WN0271  70       RS Date Added
     C                     Z-ADD*ZERO     WN0272  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
      *
     C           KLCHSI    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C           KLCHSI    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YCRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVELWN0003    WEPAST    P      BOL Truck Scale
     C                     Z-ADDWDLDSH    WELDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSJ03           BOL Load Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSJ01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSJ03           BOL Load Number
      * Establish starting position
     C           KRSSJ     SETLL@A1CPC4                    *
     C           KRSSJ     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WFLLST    IFEQ 'M'                        *IF
     C           WFLLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR SKCHRC
     C                     END                             *FI
     C           KRSSJ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0273  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0274 10        TH Group Refere
     C                     MOVEL*BLANK    WN0275  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0276  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0277  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0278  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0279  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0280  52       TH Resale Price
     C                     Z-ADD*ZERO     WN0281  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0282  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0283  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0284  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0285  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0286  50       TH Held Over
     C                     Z-ADD*ZERO     WN0287  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0288  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0289  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0290  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0291  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0292  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0293  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0294  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0295  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0296  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0297  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0298  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0299  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0300  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0301  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0302  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0303  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0304  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0305  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0306  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0307  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0308  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0309  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0310  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0311  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0312  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0313  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0314  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0315  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0316  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0317  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0318  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0319  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0320  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0321  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0322  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0323  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0324  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0325  72       TH Actual Value
     C                     MOVEL*BLANK    WN0326  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0327  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0328  1        TH Detail Error
     C                     MOVEL*BLANK    WN0329  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0330  80       TH Commission A
     C                     Z-ADD*ZERO     WN0331  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0332  1        TH User Error O
     C                     MOVEL*BLANK    WN0333  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0334  1        TH Sex
     C                     Z-ADD*ZERO     WN0335  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0336  70       TH Commission P
     C                     Z-ADD*ZERO     WN0337  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0338  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0339  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0340  31       TH FFLI
     C                     Z-ADD*ZERO     WN0341  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0342  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0343  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0344  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0345  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0346  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0347  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0348  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0349  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0350  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0351  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0352  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0353  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0354  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0355  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0356  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0357  1        TH Source Type
     C                     MOVEL*BLANK    WN0358  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0359  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0360  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0361  3        TH Source Code
     C                     MOVEL*BLANK    WN0362  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0363  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0364  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0365  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0366  3        TH State
     C                     MOVEL*BLANK    WN0367  3        TH Unused Code
     C                     MOVEL*BLANK    WN0368  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0369  1        TH Commission S
     C                     MOVEL*BLANK    WN0370  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0371  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0372  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0373  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0374  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0375  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0376  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0377  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0378  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0379  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0380  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0381  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0382  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0383  3        TH PHA Average
     C                     MOVEL*BLANK    WN0384  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0385  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0386  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0387  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0388  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0389  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0390  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0391  70       TH Unused Nbr 3
     C                     Z-ADD*ZERO     WN0392  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0393  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0394  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0395  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0396  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0397 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0398 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0399 112       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0400 112       TH Unsued Nbr 1
     C                     Z-ADD*ZERO     WN0401  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0402  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0403  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0404  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0405  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0406  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0407  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0408  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0409  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0410  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0411  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0412  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0413  70       TH Unused Date
     C                     MOVEL*BLANK    WN0414  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0415  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0416  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0417  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0418  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0419  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0420  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0421  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0422  6        DF Defect Code
     C                     MOVEL*BLANK    WN0423  6        THP Process Cod
     C                     MOVEL*BLANK    WN0424  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0425  6        PL Location Cod
     C                     MOVEL*BLANK    WN0426  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0427  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0428  3        HC Class Code
     C                     MOVEL*BLANK    WN0429 10        RS User Changed
     C                     Z-ADD*ZERO     WN0430  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0431  60       RS Time Changed
     C                     MOVEL*BLANK    WN0432  1        RS Record Statu
     C                     MOVEL*BLANK    WN0433 10        RS Job
     C                     MOVEL*BLANK    WN0434 10        RS Program
     C                     MOVEL*BLANK    WN0435 10        RS User Added
     C                     Z-ADD*ZERO     WN0436  70       RS Date Added
     C                     Z-ADD*ZERO     WN0437  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSK    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSK    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       WGD7ST    P      TH Header Error
     C                     MOVEL'E'       WGDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Load    RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAAECD           PL Location Cod
     C                     KFLD           WABOMV           BOLW Movement N
     C                     KFLD           WASRST           BOLW Weight Typ
      * Setup key
     C                     Z-ADD#1HONB    WAHONB           CC Company Numb
     C                     MOVEL#1ABCD    WAABCD           PD Producer Cod
     C                     MOVEL#1AECD    WAAECD           PL Location Cod
     C                     Z-ADD#1BOMV    WABOMV           BOLW Movement N
     C                     MOVEL'I'       WASRST           BOLW Weight Typ
      * Establish starting position
     C           KRSSL     CHAIN@EJCPBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1BONB           BOL Load Number
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAHMNB    #1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    #1BONB           BOL Load Number
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Scale BOL Weight  CR - Buy Order Load Weight  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0438 10        Group Reference
     C                     MOVEL*BLANK    WN0439  5        HPS FS Comp Rel
     C                     MOVEL*BLANK    WN0440  1        BOL Truck Scale
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EJCPBH
     C                     Z-ADD#1HONB    WBHONB           CC Company Numb
     C                     MOVEL#1ABCD    WBABCD           PD Producer Cod
     C                     MOVEL#1AECD    WBAECD           PL Location Cod
     C                     Z-ADD#1BOMV    WBBOMV           BOLW Movement N
     C                     MOVEL#1SRST    WBSRST           BOLW Weight Typ
     C                     Z-ADD#1BOSW    WBBOSW           BOLW Scale Weig
     C                     Z-ADD#1DQDT    WBDQDT           BOLW Scale Weig
     C                     Z-ADD#1A2TM    WBA2TM           BOLW Scale Weig
     C                     MOVEL#1SSST    WBSSST           BOLW Spread Sta
     C                     MOVEL#1STST    WBSTST           BOLW Unused Sts
     C                     MOVEL#1SUST    WBSUST           BOLW Unused Sts
     C                     Z-ADD#1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WBBONB           BOL Load Number
     C                     MOVEL#1AAVN    WBAAVN           RS User Changed
     C                     Z-ADD#1AADT    WBAADT           RS Date Changed
     C                     Z-ADD#1AMTM    WBAMTM           RS Time Changed
     C                     MOVEL#1AJST    WBAJST           RS Record Statu
     C                     MOVEL#1AHVN    WBAHVN           RS Job
     C                     MOVEL#1AGVN    WBAGVN           RS Program
     C                     MOVEL#1ABVN    WBABVN           RS User Added
     C                     Z-ADD#1ABDT    WBABDT           RS Date Added
     C                     Z-ADD#1ABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
      * Rtv System Date       UP - STR User Source Functions  * 
     C                     CALL 'PKPSUPR'              90  Rtv System Date
     C           WUVCNB    PARM *ZERO     WQ0008  70       *DATE
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPSUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Rtv Current Time      US - STR User Source Functions  * 
     C                     TIME           WBABTM
      * DB1.BOLW Scale Weight Date = WRK.System Value Numeric  USR
     C                     Z-ADDWUVCNB    WBDQDT           BOLW Scale Weig
      * DB1.RS Date Added = WRK.System Value Numeric  USR
     C                     Z-ADDWUVCNB    WBABDT           RS Date Added
     C                     Z-ADDWBABTM    WBA2TM           BOLW Scale Weig
      * CASE: PAR.BOLW Weight Type is In
     C           #1SRST    IFEQ 'I'                        *IF
      * *-----------------------------------------------------------*
      * * 01/23/03 PKD PK0495-Retrieve the Buy Order and Load Number
      *                the Delivery Schedule Detail File instead of the
      *                next available load.
      * Rtv Buy Order Load    RT - Delivery Sched Detail  * 
     C                     EXSR SNRVGN
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR SORVGN
     C                     ELSE
      * CASE: PAR.BOLW Weight Type is Out
     C           #1SRST    IFEQ 'O'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Rtv HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0009  7        *Return code
     C                     PARM #1BOMV    WQ0010  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0011 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0012  50       Farm Site USR
     C           WN0439    PARM *BLANK    WQ0013  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0014  3        State
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * BOL Truck Scale Weight Status
      * CASE: PAR.HPS FS Comp Relation USR is Contract
     C           WN0439    IFEQ 'CON'                      *IF
     C                     MOVEL'N'       WN0440           BOL Truck Scale
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'O'       WN0440           BOL Truck Scale
     C                     END                             *FI
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KLCRSM    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBABCD           PD Producer Cod
     C                     KFLD           WBAECD           PL Location Cod
     C                     KFLD           WBBOMV           BOLW Movement N
     C                     KFLD           WBSRST           BOLW Weight Typ
      * Check for duplicate primary key
     C           KLCRSM    SETLL@EJCPBH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0842' W0RTN   7
      * Send message 'Buy Order Load Weight  EX'
     C                     MOVEL'PRK0842' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@EJCPBH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     Z-ADDWBBNNB    #1BNNB           Buy Order Numbe
     C                     Z-ADDWBBONB    #1BONB           Load Number
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Load    RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHONB    WQSN01           CC Company Numb
     C           *LIKE     DEFN WCH3A1    WQSN02           DSD Movement Nu
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           CC Company Numb
     C                     KFLD           WQSN02           DSD Movement Nu
      * Setup key
     C                     Z-ADD#1HONB    WQSN01           CC Company Numb
     C                     Z-ADD#1BOMV    WQSN02           DSD Movement Nu
      * Establish starting position
     C           KRSSN     SETLL@AECPJB                    *
     C           KRSSN     READE@AECPJB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Return Code USR
     C                     Z-ADD*ZERO     YL0002           DSH Kill Date
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     MOVEL'Y2U0005' YL0001           Return Code USR
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCE0DT    YL0002           DSH Kill Date
     C                     Z-ADDWCHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WBBONB           BOL Load Number
     C                     MOVEL*BLANK    YL0001           Return Code USR
     C           KRSSN     READE@AECPJB                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
      * Setup key
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WDBONB           BOL Load Number
      * Establish starting position
     C           KRSSO     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'I'       IFEQ 'R'                        *IF
     C           WDPAST    IFEQ 'I'                        *IF
     C           WDPAST    OREQ 'N'
     C           WDPAST    OREQ *BLANK
     C           WDPAST    OREQ 'O'
     C           WDPAST    OREQ 'R'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           'I'       IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0441  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0442  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0443  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0444  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0445  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0446  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0447  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0448  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0449  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0450  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0451  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0452  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0453  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0454  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0455  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0456  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0457 11        BOL Trailer
     C                     MOVEL*BLANK    WN0458  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0459  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0460  1        Reported to USD
     C                     MOVEL*BLANK    WN0461  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0462  1        BOL Status 4
     C                     MOVEL*BLANK    WN0463  2        BOL Status 5
     C                     MOVEL*BLANK    WN0464  2        BOL Status 6
     C                     MOVEL*BLANK    WN0465  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0466  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0467  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0468  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0469  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0470  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0471 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0472 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0473 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0474 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0475 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0476  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0477  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0478  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0479  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0480  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0481  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0482  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0483  6        PL Location Cod
     C                     MOVEL*BLANK    WN0484 10        RS User Changed
     C                     Z-ADD*ZERO     WN0485  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0486  60       RS Time Changed
     C                     MOVEL*BLANK    WN0487  1        RS Record Statu
     C                     MOVEL*BLANK    WN0488 10        RS Job
     C                     MOVEL*BLANK    WN0489 10        RS Program
     C                     MOVEL*BLANK    WN0490 10        RS User Added
     C                     Z-ADD*ZERO     WN0491  70       RS Date Added
     C                     Z-ADD*ZERO     WN0492  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
      *
     C           KLCHSP    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C           KLCHSP    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YERDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'I'       WEPAST    P      BOL Truck Scale
     C                     Z-ADDWDLDSH    WELDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSQ02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSQ03           BOL Load Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
     C                     KFLD           WQSQ03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSQ01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSQ02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSQ03           BOL Load Number
      * Establish starting position
     C           KRSSQ     SETLL@A1CPC4                    *
     C           KRSSQ     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WFLLST    IFEQ 'M'                        *IF
     C           WFLLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR SRCHRC
     C                     END                             *FI
     C           KRSSQ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0493  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0494 10        TH Group Refere
     C                     MOVEL*BLANK    WN0495  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0496  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0497  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0498  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0499  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0500  52       TH Resale Price
     C                     Z-ADD*ZERO     WN0501  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0502  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0503  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0504  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0505  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0506  50       TH Held Over
     C                     Z-ADD*ZERO     WN0507  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0508  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0509  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0510  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0511  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0512  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0513  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0514  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0515  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0516  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0517  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0518  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0519  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0520  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0521  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0522  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0523  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0524  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0525  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0526  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0527  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0528  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0529  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0530  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0531  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0532  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0533  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0534  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0535  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0536  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0537  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0538  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0539  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0540  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0541  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0542  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0543  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0544  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0545  72       TH Actual Value
     C                     MOVEL*BLANK    WN0546  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0547  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0548  1        TH Detail Error
     C                     MOVEL*BLANK    WN0549  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0550  80       TH Commission A
     C                     Z-ADD*ZERO     WN0551  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0552  1        TH User Error O
     C                     MOVEL*BLANK    WN0553  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0554  1        TH Sex
     C                     Z-ADD*ZERO     WN0555  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0556  70       TH Commission P
     C                     Z-ADD*ZERO     WN0557  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0558  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0559  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0560  31       TH FFLI
     C                     Z-ADD*ZERO     WN0561  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0562  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0563  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0564  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0565  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0566  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0567  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0568  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0569  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0570  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0571  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0572  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0573  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0574  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0575  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0576  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0577  1        TH Source Type
     C                     MOVEL*BLANK    WN0578  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0579  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0580  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0581  3        TH Source Code
     C                     MOVEL*BLANK    WN0582  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0583  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0584  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0585  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0586  3        TH State
     C                     MOVEL*BLANK    WN0587  3        TH Unused Code
     C                     MOVEL*BLANK    WN0588  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0589  1        TH Commission S
     C                     MOVEL*BLANK    WN0590  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0591  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0592  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0593  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0594  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0595  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0596  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0597  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0598  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0599  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0600  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0601  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0602  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0603  3        TH PHA Average
     C                     MOVEL*BLANK    WN0604  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0605  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0606  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0607  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0608  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0609  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0610  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0611  70       TH Unused Nbr 3
     C                     Z-ADD*ZERO     WN0612  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0613  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0614  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0615  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0616  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0617 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0618 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0619 112       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0620 112       TH Unsued Nbr 1
     C                     Z-ADD*ZERO     WN0621  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0622  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0623  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0624  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0625  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0626  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0627  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0628  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0629  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0630  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0631  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0632  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0633  70       TH Unused Date
     C                     MOVEL*BLANK    WN0634  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0635  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0636  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0637  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0638  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0639  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0640  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0641  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0642  6        DF Defect Code
     C                     MOVEL*BLANK    WN0643  6        THP Process Cod
     C                     MOVEL*BLANK    WN0644  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0645  6        PL Location Cod
     C                     MOVEL*BLANK    WN0646  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0647  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0648  3        HC Class Code
     C                     MOVEL*BLANK    WN0649 10        RS User Changed
     C                     Z-ADD*ZERO     WN0650  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0651  60       RS Time Changed
     C                     MOVEL*BLANK    WN0652  1        RS Record Statu
     C                     MOVEL*BLANK    WN0653 10        RS Job
     C                     MOVEL*BLANK    WN0654 10        RS Program
     C                     MOVEL*BLANK    WN0655 10        RS User Added
     C                     Z-ADD*ZERO     WN0656  70       RS Date Added
     C                     Z-ADD*ZERO     WN0657  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSR    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSR    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YFRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       WGD7ST    P      TH Header Error
     C                     MOVEL'E'       WGDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WDBONB           BOL Load Number
      * Establish starting position
     C           KRSSS     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0440    IFEQ 'R'                        *IF
     C           WDPAST    IFEQ 'I'                        *IF
     C           WDPAST    OREQ 'N'
     C           WDPAST    OREQ *BLANK
     C           WDPAST    OREQ 'O'
     C           WDPAST    OREQ 'R'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR STCHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           WN0440    IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR SURVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0658  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0659  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0660  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0661  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0662  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0663  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0664  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0665  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0666  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0667  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0668  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0669  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0670  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0671  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0672  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0673  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0674 11        BOL Trailer
     C                     MOVEL*BLANK    WN0675  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0676  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0677  1        Reported to USD
     C                     MOVEL*BLANK    WN0678  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0679  1        BOL Status 4
     C                     MOVEL*BLANK    WN0680  2        BOL Status 5
     C                     MOVEL*BLANK    WN0681  2        BOL Status 6
     C                     MOVEL*BLANK    WN0682  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0683  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0684  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0685  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0686  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0687  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0688 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0689 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0690 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0691 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0692 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0693  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0694  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0695  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0696  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0697  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0698  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0699  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0700  6        PL Location Cod
     C                     MOVEL*BLANK    WN0701 10        RS User Changed
     C                     Z-ADD*ZERO     WN0702  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0703  60       RS Time Changed
     C                     MOVEL*BLANK    WN0704  1        RS Record Statu
     C                     MOVEL*BLANK    WN0705 10        RS Job
     C                     MOVEL*BLANK    WN0706 10        RS Program
     C                     MOVEL*BLANK    WN0707 10        RS User Added
     C                     Z-ADD*ZERO     WN0708  70       RS Date Added
     C                     Z-ADD*ZERO     WN0709  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
      *
     C           KLCHST    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C           KLCHST    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YGRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVELWN0440    WEPAST    P      BOL Truck Scale
     C                     Z-ADDWDLDSH    WELDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSU01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSU02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSU03           BOL Load Number
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           BOH Company Num
     C                     KFLD           WQSU02           BOH Buy Order N
     C                     KFLD           WQSU03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSU01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSU02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSU03           BOL Load Number
      * Establish starting position
     C           KRSSU     SETLL@A1CPC4                    *
     C           KRSSU     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WFLLST    IFEQ 'M'                        *IF
     C           WFLLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR SVCHRC
     C                     END                             *FI
     C           KRSSU     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0710  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0711 10        TH Group Refere
     C                     MOVEL*BLANK    WN0712  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0713  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0714  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0715  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0716  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0717  52       TH Resale Price
     C                     Z-ADD*ZERO     WN0718  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0719  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0720  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0721  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0722  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0723  50       TH Held Over
     C                     Z-ADD*ZERO     WN0724  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0725  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0726  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0727  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0728  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0729  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0730  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0731  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0732  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0733  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0734  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0735  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0736  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0737  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0738  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0739  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0740  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0741  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0742  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0743  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0744  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0745  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0746  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0747  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0748  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0749  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0750  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0751  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0752  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0753  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0754  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0755  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0756  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0757  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0758  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0759  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0760  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0761  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0762  72       TH Actual Value
     C                     MOVEL*BLANK    WN0763  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0764  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0765  1        TH Detail Error
     C                     MOVEL*BLANK    WN0766  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0767  80       TH Commission A
     C                     Z-ADD*ZERO     WN0768  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0769  1        TH User Error O
     C                     MOVEL*BLANK    WN0770  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0771  1        TH Sex
     C                     Z-ADD*ZERO     WN0772  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0773  70       TH Commission P
     C                     Z-ADD*ZERO     WN0774  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0775  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0776  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0777  31       TH FFLI
     C                     Z-ADD*ZERO     WN0778  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0779  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0780  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0781  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0782  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0783  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0784  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0785  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0786  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0787  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0788  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0789  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0790  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0791  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0792  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0793  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0794  1        TH Source Type
     C                     MOVEL*BLANK    WN0795  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0796  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0797  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0798  3        TH Source Code
     C                     MOVEL*BLANK    WN0799  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0800  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0801  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0802  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0803  3        TH State
     C                     MOVEL*BLANK    WN0804  3        TH Unused Code
     C                     MOVEL*BLANK    WN0805  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0806  1        TH Commission S
     C                     MOVEL*BLANK    WN0807  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0808  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0809  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0810  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0811  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0812  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0813  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0814  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0815  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0816  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0817  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0818  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0819  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0820  3        TH PHA Average
     C                     MOVEL*BLANK    WN0821  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0822  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0823  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0824  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0825  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0826  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0827  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0828  70       TH Unused Nbr 3
     C                     Z-ADD*ZERO     WN0829  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0830  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0831  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0832  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0833  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0834 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0835 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0836 112       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0837 112       TH Unsued Nbr 1
     C                     Z-ADD*ZERO     WN0838  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0839  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0840  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0841  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0842  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0843  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0844  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0845  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0846  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0847  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0848  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0849  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0850  70       TH Unused Date
     C                     MOVEL*BLANK    WN0851  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0852  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0853  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0854  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0855  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0856  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0857  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0858  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0859  6        DF Defect Code
     C                     MOVEL*BLANK    WN0860  6        THP Process Cod
     C                     MOVEL*BLANK    WN0861  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0862  6        PL Location Cod
     C                     MOVEL*BLANK    WN0863  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0864  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0865  3        HC Class Code
     C                     MOVEL*BLANK    WN0866 10        RS User Changed
     C                     Z-ADD*ZERO     WN0867  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0868  60       RS Time Changed
     C                     MOVEL*BLANK    WN0869  1        RS Record Statu
     C                     MOVEL*BLANK    WN0870 10        RS Job
     C                     MOVEL*BLANK    WN0871 10        RS Program
     C                     MOVEL*BLANK    WN0872 10        RS User Added
     C                     Z-ADD*ZERO     WN0873  70       RS Date Added
     C                     Z-ADD*ZERO     WN0874  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSV    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSV    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YHRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       WGD7ST    P      TH Header Error
     C                     MOVEL'E'       WGDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Company Control HPE
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HONB' defaulted for 'CC Company Number'.
     C                     CALL 'PKV7SRR'              90  PKD SR Test
     C                     PARM *BLANK    W0RTN   7
     C           #1HONB    PARM #1HONB    WQ0015  30       CC Company Numb
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HONB    IFNE *ZERO                      CC Company Numb
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HONB    IFEQ *ZERO                      CC Company Numb
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWH    KLIST
     C                     KFLD           WHHONB           CC Company Numb
      * Setup key
     C                     Z-ADD#1HONB    WHHONB
     C           KLVAWH    CHAIN@AZCPCN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Company Control HPE    NF'
     C                     MOVEL'PRK0055' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0055' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'BOL Kill Date'.
      * Field '(CON) *ZERO' defaulted for 'MEL Date'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
     C                     CALL 'PKYJSRR'              90  Sel Prod Loc w/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0016  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0017  6        PL Location Cod
     C                     PARM *ZERO     WQ0018  70       BOL Kill Date
     C                     PARM *ZERO     WQ0019  70       MEL Date
     C                     PARM #1HMNB    WQ0020  30       BOH Company Num
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKYJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWI    KLIST
     C                     KFLD           WIABCD           PD Producer Cod
     C                     KFLD           WIAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    WIABCD
     C                     MOVEL#1AECD    WIAECD
     C           KLVBWI    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Buy Order Load
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(DTL) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0021  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0022  50       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0023  50       BOL Load Number
     C                     PARM #1ABCD    WQ0024  6        PD Producer Cod
     C                     PARM #1AECD    WQ0025  6        PL Location Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWD    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WDHMNB
     C                     Z-ADD#1BNNB    WDBNNB
     C                     Z-ADD#1BONB    WDBONB
     C           KLVCWD    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7J8NB           Oms Warehouse C
     C                     MOVEL*BLANK    P7C7CD           Oms Application
     C                     MOVEL*BLANK    P7C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P7G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P7G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P7EVTX           Oms System Valu
     C                     MOVEL*BLANK    P7HAST           Oms Access Deni
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WABOMV           BOLW Movement N
     C                     Z-ADD*ZERO     WABOSW           BOLW Scale Weig
     C                     Z-ADD*ZERO     WADQDT           BOLW Scale Weig
     C                     Z-ADD*ZERO     WAA2TM           BOLW Scale Weig
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field System Value Numeric  USR
     C                     Z-ADD*ZERO     WUVCNB 155
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WCE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WCAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WCHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WCH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WCH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WCIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WCH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WCIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WCH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WCFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WCBOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WCE7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WCAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WCE8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WCAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WCFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WCB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WDABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WDACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WDBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WDCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WDAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WDAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WDATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WDDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WDDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WDGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WDBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WDLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WDLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WDJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WDKEOR           BOL Unused Nbr
     C                     Z-ADD*ZERO     WDIOEW           BOL Unused Nbr
     C                     Z-ADD*ZERO     WDKJIO           BOL Unused Nbr
     C                     Z-ADD*ZERO     WDIOJR           BOL Unused Nbr
     C                     Z-ADD*ZERO     WDEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDD0DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WFB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WFAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WFACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WFB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WFCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WFAIPR           TH Resale Price
     C                     Z-ADD*ZERO     WFA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WFCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WFCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WFFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WFH9NB           TH Held Over
     C                     Z-ADD*ZERO     WFFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WFFENB           TH Head Killed
     C                     Z-ADD*ZERO     WFHENB           TH Head Adds
     C                     Z-ADD*ZERO     WFHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WFCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WFLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WFE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WFA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WFFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WFA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WFF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WFHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WFF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WFF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WFF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WFF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WFCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WFASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WFA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WFATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WFA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WFCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WFCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WFLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WFA2PR           TH Actual Value
     C                     Z-ADD*ZERO     WFGHNB           TH Commission A
     C                     Z-ADD*ZERO     WFBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WFBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WFBTDT           TH Commission P
     C                     Z-ADD*ZERO     WFBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WFHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WFHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WFHINB           TH FFLI
     C                     Z-ADD*ZERO     WFA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WFA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WFA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WFJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WFOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WFTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WFT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WFTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WFT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WFOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WFKOER           TH Head Identif
     C                     Z-ADD*ZERO     WFOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WFOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WFIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WFOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WFHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WFS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WFTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WFTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WFJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WFKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WFKORF           TH Unused Nbr 3
     C                     Z-ADD*ZERO     WFKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WFKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WFOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WFIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WFIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WFIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WFKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WFOJRF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WFKFOR           TH Unsued Nbr 1
     C                     Z-ADD*ZERO     WFORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WFOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WFMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WFMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WFNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WFNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WFIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WFKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WFEADT           TH Unused Date
     C                     Z-ADD*ZERO     WFEBDT           TH Unused Date
     C                     Z-ADD*ZERO     WFECDT           TH Unused Date
     C                     Z-ADD*ZERO     WFEDDT           TH Unused Date
     C                     Z-ADD*ZERO     WFEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHONB           CC Company Numb
     C                     Z-ADD*ZERO     WHBSNB           Next Buy Order
     C                     Z-ADD*ZERO     WHB1DT           Current Kill Da
     C                     Z-ADD*ZERO     WHB2DT           Next Kill Date
     C                     Z-ADD*ZERO     WHH4NB           Last Drive Card
     C                     Z-ADD*ZERO     WHK3NB           Last Tattoo Nbr
     C                     Z-ADD*ZERO     WHCDDT           Current Product
     C                     Z-ADD*ZERO     WHCEDT           Next Production
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WIASNB           PL Miles to Com
     C                     Z-ADD*ZERO     WIHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Define work field Oms Name
     C                     MOVEL*BLANK    WUEUTX 30
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Return Code USR
     C                     MOVEL*BLANK    YL0001  7
      * Define local work field DSH Kill Date
     C                     Z-ADD*ZERO     YL0002  70
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Val Application/User  IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P7J8NB    PARM *BLANK    WQ0026  3        Oms Warehouse C
     C           WUHONB    PARM *ZERO     WQ0027  30       CC Company Numb
     C                     PARM 'HPE'     WQ0028  6        Oms Application
     C           P7C8CD    PARM *BLANK    WQ0029  3        Oms SalesPerson
     C           P7G8ST    PARM *BLANK    WQ0030  1        Oms Allow Multi
     C           P7G9ST    PARM *BLANK    WQ0031 10        Oms Default Pri
     C           WUEUTX    PARM *BLANK    WQ0032 30        Oms Name
     C           P7EVTX    PARM *BLANK    WQ0033 40        Oms System Valu
     C           P7HAST    PARM *BLANK    WQ0034  1        Oms Access Deni
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P7HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP7EVTX    ##CMP
     C                     END                             *FI
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
