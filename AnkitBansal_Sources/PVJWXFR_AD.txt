// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PVJWXFR
// ?Date: 14.08.2025 Time: 03:52:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?**************************************************************************
//?** PR1 Parms Represent Old Record Fields (Will be blank for Insert).
//?** PR2 Parms Represent New Record Fields (Will be blank for Delete).
//?**************************************************************************
//?Trigger Processing for Insert Event.
CASE;

// IF PR3.TRG Database Event is Insert
IF PR3.TRG_Database_Event = '1';

EXECUTE FUNCTION(Create Load Order Change) TYPE(CRTOBJ) FILE(PVCPCPP)           AC2240673;
PARAMETER(PR2.Created_Date);
PARAMETER(PR2.Created_Time);
PARAMETER(PR2.Sequence_Number);
PARAMETER(PR2.Order_Number);
PARAMETER(PR2.Load_ID);
PARAMETER(PR3.TRG_Database_Event);
PARAMETER(0);
PARAMETER(*ZERO);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Timestamp TS#     IF) TYPE(EXCINTFUN)                      AC2131367;
 PARAMETER(DB1.LH_Timestamp);
 {
  //?Execute internal function

  // PAR.@Timestamp TS# = JOB.*System timestamp
  PAR.@Timestamp_TS# = JOB.*System_timestamp;

 }

}


//?If Record Already Exist.
CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// Call program RTV System Date/Time   UP.
CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
PARAMETER(LCL.Current_System_Date);
PARAMETER(LCL.Current_System_Time);

// WRK.Current System Time = LCL.Current System Time
WRK.Current_System_Time = LCL.Current_System_Time;

//?WI642 JM 02/19/25-Loop Until System Time Changes.
// DOW LCL.Current System Time EQ WRK.Current System Time
DOW LCL.Current_System_Time = WRK.Current_System_Time;

// Call program RTV System Date/Time   UP.
CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
PARAMETER(LCL.Current_System_Date);
PARAMETER(WRK.Current_System_Time);

ENDDO;

EXECUTE FUNCTION(Create Load Order Change) TYPE(CRTOBJ) FILE(PVCPCPP)           AC2240673;
PARAMETER(LCL.Current_System_Date);
PARAMETER(WRK.Current_System_Time);
PARAMETER(PR2.Sequence_Number);
PARAMETER(PR2.Order_Number);
PARAMETER(PR2.Load_ID);
PARAMETER(PR3.TRG_Database_Event);
PARAMETER(0);
PARAMETER(*ZERO);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Timestamp TS#     IF) TYPE(EXCINTFUN)                      AC2131367;
 PARAMETER(DB1.LH_Timestamp);
 {
  //?Execute internal function

  // PAR.@Timestamp TS# = JOB.*System timestamp
  PAR.@Timestamp_TS# = JOB.*System_timestamp;

 }

}


ENDIF;

ENDIF;

//?Trigger Processing for Update Event.
CASE;

// IF PR3.TRG Database Event is Update
IF PR3.TRG_Database_Event = '3';

EXECUTE FUNCTION(Create Load Order Change) TYPE(CRTOBJ) FILE(PVCPCPP)           AC2240673;
PARAMETER(PR2.Created_Date);
PARAMETER(PR2.Created_Time);
PARAMETER(PR2.Sequence_Number);
PARAMETER(PR2.Order_Number);
PARAMETER(PR2.Load_ID);
PARAMETER(PR3.TRG_Database_Event);
PARAMETER(0);
PARAMETER(*ZERO);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Timestamp TS#     IF) TYPE(EXCINTFUN)                      AC2131367;
 PARAMETER(DB1.LH_Timestamp);
 {
  //?Execute internal function

  // PAR.@Timestamp TS# = JOB.*System timestamp
  PAR.@Timestamp_TS# = JOB.*System_timestamp;

 }

}


//?If Record Already Exist.
CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// Call program RTV System Date/Time   UP.
CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
PARAMETER(LCL.Current_System_Date);
PARAMETER(LCL.Current_System_Time);

// WRK.Current System Time = LCL.Current System Time
WRK.Current_System_Time = LCL.Current_System_Time;

//?WI642 JM 02/19/25-Loop Until System Time Changes.
// DOW LCL.Current System Time EQ WRK.Current System Time
DOW LCL.Current_System_Time = WRK.Current_System_Time;

// Call program RTV System Date/Time   UP.
CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
PARAMETER(LCL.Current_System_Date);
PARAMETER(WRK.Current_System_Time);

ENDDO;

EXECUTE FUNCTION(Create Load Order Change) TYPE(CRTOBJ) FILE(PVCPCPP)           AC2240673;
PARAMETER(LCL.Current_System_Date);
PARAMETER(WRK.Current_System_Time);
PARAMETER(PR2.Sequence_Number);
PARAMETER(PR2.Order_Number);
PARAMETER(PR2.Load_ID);
PARAMETER(PR3.TRG_Database_Event);
PARAMETER(0);
PARAMETER(*ZERO);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Timestamp TS#     IF) TYPE(EXCINTFUN)                      AC2131367;
 PARAMETER(DB1.LH_Timestamp);
 {
  //?Execute internal function

  // PAR.@Timestamp TS# = JOB.*System timestamp
  PAR.@Timestamp_TS# = JOB.*System_timestamp;

 }

}


ENDIF;

ENDIF;

//?Trigger Processing for Delete Event.
CASE;

// IF PR3.TRG Database Event is Delete
IF PR3.TRG_Database_Event = '2';

EXECUTE FUNCTION(Create Load Order Change) TYPE(CRTOBJ) FILE(PVCPCPP)           AC2240673;
PARAMETER(PR1.Created_Date);
PARAMETER(PR1.Created_Time);
PARAMETER(PR1.Sequence_Number);
PARAMETER(PR1.Order_Number);
PARAMETER(PR1.Load_ID);
PARAMETER(PR3.TRG_Database_Event);
PARAMETER(0);
PARAMETER(*ZERO);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Timestamp TS#     IF) TYPE(EXCINTFUN)                      AC2131367;
 PARAMETER(DB1.LH_Timestamp);
 {
  //?Execute internal function

  // PAR.@Timestamp TS# = JOB.*System timestamp
  PAR.@Timestamp_TS# = JOB.*System_timestamp;

 }

}


ENDIF;

