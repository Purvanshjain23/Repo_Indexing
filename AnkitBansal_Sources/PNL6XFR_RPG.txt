     H/TITLE BPS Proc ODBS f/Ovrde XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/27/12  Time  : 11:25:45
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPME6CPL9IF  E           K        DISK
      * RSQ : Order Detail Build Sched  SSD/Ord/Sq/Sq2,sel Ovrd=
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Consmd Retrieval index
      *
     FPOB5CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Inv    Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDKNCPL8IF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/Ord/Seq/Ssq/PDte(d)
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPOB6CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      *
     FPDIORELIIF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Item/CItem StrWgtYld
      *
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FPOB5CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPOB6CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Consmd Update index
      *
     FPOB5CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Inv    Update index
      *
     FPDKNCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Schedule     Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@E6CPC6
      * Order Detail Build Sched  SSD/Ord/Sq/Sq2,sel Ovrd=
      * Renamed input format fields
     I              E6AIC3                          WAAIC3
     I              E6C4NB                          WAC4NB
     I              E6DPNB                          WADPNB
     I              E6UENB                          WAUENB
     I              E6AODT                          WAAODT
     I              E6DBST                          WADBST
     I              E6GMST                          WAGMST
     I              E6GWST                          WAGWST
     I              E6JNCD                          WAJNCD
     I              E6HGCD                          WAHGCD
     I              E6NUDT                          WANUDT
     I              E6AJCD                          WAAJCD
     I              E6RPCD                          WARPCD
     I              E6AVQT                          WAAVQT
     I              E6D0WG                          WAD0WG
     I              E6CCQT                          WACCQT
     I              E6AUWG                          WAAUWG
     I              E6JPCD                          WAJPCD
     I              E6NVDT                          WANVDT
     I              E6BUTM                          WABUTM
     I              E6WPST                          WAWPST
     I              E6RMNB                          WARMNB
     I              E6U2ST                          WAU2ST
     I              E6BKC7                          WABKC7
     I              E6XJST                          WAXJST
     I              E6XIST                          WAXIST
     I              E6PKST                          WAPKST
     I              E6BZNA                          WABZNA
     I              E6CXDT                          WACXDT
     I              E6BQTM                          WABQTM
     I              E6DCST                          WADCST
     I              E6DDST                          WADDST
     I              E6OFNY                          WAOFNY
     I              E6EIDT                          WAEIDT
     I              E6RINY                          WARINY
     I              E6TIDT                          WATIDT
     I              E6TJDT                          WATJDT
     I              E6TNDT                          WATNDT
     I              E6TODT                          WATODT
     I              E6IIST                          WAIIST
     I              E6IJST                          WAIJST
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WFAIC3
     I              B6C4NB                          WFC4NB
     I              B6DPNB                          WFDPNB
     I              B6UENB                          WFUENB
     I              B6JGDT                          WFJGDT
     I              B6OONY                          WFOONY
     I              B6AODT                          WFAODT
     I              B6AJCD                          WFAJCD
     I              B6NUDT                          WFNUDT
     I              B6HGCD                          WFHGCD
     I              B6IGQT                          WFIGQT
     I              B6FLWG                          WFFLWG
     I              B6NSQT                          WFNSQT
     I              B6JQWG                          WFJQWG
     I              B6NVDT                          WFNVDT
     I              B6BUTM                          WFBUTM
     I              B6UVST                          WFUVST
     I              B6UWST                          WFUWST
     I              B6UXST                          WFUXST
     I              B6VSST                          WFVSST
     I              B6AATM                          WFAATM
     I              B6AYNA                          WFAYNA
     I              B6A0NA                          WFA0NA
     I              B6AXDT                          WFAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     I@B5CPM2
      * Order Detail Sched-Inv    Retrieval index
      * Renamed input format fields
     I              B5AIC3                          WHAIC3
     I              B5C4NB                          WHC4NB
     I              B5DPNB                          WHDPNB
     I              B5UENB                          WHUENB
     I              B5JGDT                          WHJGDT
     I              B5AODT                          WHAODT
     I              B5AJCD                          WHAJCD
     I              B5HGCD                          WHHGCD
     I              B5IUQT                          WHIUQT
     I              B5F3WG                          WHF3WG
     I              B5UVST                          WHUVST
     I              B5UWST                          WHUWST
     I              B5UXST                          WHUXST
     I              B5VSST                          WHVSST
     I              B5AATM                          WHAATM
     I              B5AYNA                          WHAYNA
     I              B5A0NA                          WHA0NA
     I              B5AXDT                          WHAXDT
      *
     I@B5CPM1
      * Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WIAIC3
     I              B5C4NB                          WIC4NB
     I              B5DPNB                          WIDPNB
     I              B5UENB                          WIUENB
     I              B5JGDT                          WIJGDT
     I              B5AODT                          WIAODT
     I              B5AJCD                          WIAJCD
     I              B5HGCD                          WIHGCD
     I              B5IUQT                          WIIUQT
     I              B5F3WG                          WIF3WG
     I              B5UVST                          WIUVST
     I              B5UWST                          WIUWST
     I              B5UXST                          WIUXST
     I              B5VSST                          WIVSST
     I              B5AATM                          WIAATM
     I              B5AYNA                          WIAYNA
     I              B5A0NA                          WIA0NA
     I              B5AXDT                          WIAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WJAIC3
     I              AFBCDT                          WJBCDT
     I              AFCQNB                          WJCQNB
     I              AFESNB                          WJESNB
     I              AFETNB                          WJETNB
     I              AFBZNB                          WJBZNB
     I              AFA9ST                          WJA9ST
     I              AFEINB                          WJEINB
     I              AFC5ST                          WJC5ST
     I              AFAQNB                          WJAQNB
     I              AFCMST                          WJCMST
     I              AFV9ST                          WJV9ST
     I              AFWAST                          WJWAST
     I              AFX2ST                          WJX2ST
     I              AFOJDT                          WJOJDT
     I              AFNQNX                          WJNQNX
     I              AFNRNX                          WJNRNX
     I              AFI9SX                          WJI9SX
     I              AFJASX                          WJJASX
     I              AFOKDT                          WJOKDT
     I              AFOLDT                          WJOLDT
     I              AFUVST                          WJUVST
     I              AFUWST                          WJUWST
     I              AFUXST                          WJUXST
     I              AFAATM                          WJAATM
     I              AFAYNA                          WJAYNA
     I              AFA0NA                          WJA0NA
     I              AFAXDT                          WJAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@KNCPM6
      * Order Detail Schedule     Co/Ord/Seq/Ssq/PDte(d)
      * Renamed input format fields
     I              KNAIC3                          WLAIC3
     I              KNC4NB                          WLC4NB
     I              KNDPNB                          WLDPNB
     I              KNUENB                          WLUENB
     I              KNJGDT                          WLJGDT
     I              KNAODT                          WLAODT
     I              KNAJCD                          WLAJCD
     I              KNAYAA                          WLAYAA
     I              KNHGCD                          WLHGCD
     I              KNIGQT                          WLIGQT
     I              KNFLWG                          WLFLWG
     I              KNIUQT                          WLIUQT
     I              KNF3WG                          WLF3WG
     I              KNIVQT                          WLIVQT
     I              KNF4WG                          WLF4WG
     I              KNP7ST                          WLP7ST
     I              KNP8ST                          WLP8ST
     I              KNQAST                          WLQAST
     I              KNUVST                          WLUVST
     I              KNUWST                          WLUWST
     I              KNUXST                          WLUXST
     I              KNVSST                          WLVSST
     I              KNAATM                          WLAATM
     I              KNAYNA                          WLAYNA
     I              KNA0NA                          WLA0NA
     I              KNAXDT                          WLAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WMAJCD
     I              ADF8NA                          WMF8NA
     I              ADACNA                          WMACNA
     I              ADADNA                          WMADNA
     I              ADAENA                          WMAENA
     I              ADAJNA                          WMAJNA
     I              ADBTTX                          WMBTTX
     I              ADAOCD                          WMAOCD
     I              ADBGCD                          WMBGCD
     I              ADVHST                          WMVHST
     I              ADMPNA                          WMMPNA
     I              ADWPST                          WMWPST
     I              ADXUST                          WMXUST
     I              ADT0ST                          WMT0ST
     I              ADT1ST                          WMT1ST
     I              ADDBNB                          WMDBNB
     I              ADT2ST                          WMT2ST
     I              ADT3ST                          WMT3ST
     I              ADT4ST                          WMT4ST
     I              ADT6ST                          WMT6ST
     I              ADBWC3                          WMBWC3
     I              ADBTC3                          WMBTC3
     I              ADBUC3                          WMBUC3
     I              ADBVC3                          WMBVC3
     I              ADFCAA                          WMFCAA
     I              ADRQSX                          WMRQSX
     I              ADRRSX                          WMRRSX
     I              ADRSSX                          WMRSSX
     I              ADRTSX                          WMRTSX
     I              ADT7ST                          WMT7ST
     I              ADT8ST                          WMT8ST
     I              ADRNSX                          WMRNSX
     I              ADROSX                          WMROSX
     I              ADRPSX                          WMRPSX
     I              ADUVST                          WMUVST
     I              ADUWST                          WMUWST
     I              ADUXST                          WMUXST
     I              ADVSST                          WMVSST
     I              ADAATM                          WMAATM
     I              ADAYNA                          WMAYNA
     I              ADA0NA                          WMA0NA
     I              ADAXDT                          WMAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WOAIC3
     I              JCV5ST                          WOV5ST
     I              JCELDT                          WOELDT
     I              JCHVHD                          WOHVHD
     I              JCZ6NB                          WOZ6NB
     I              JCZ7NB                          WOZ7NB
     I              JCDGPC                          WODGPC
     I              JCAVCW                          WOAVCW
     I              JCDIPC                          WODIPC
     I              JCZ0NB                          WOZ0NB
     I              JCAVLE                          WOAVLE
     I              JCECWG                          WOECWG
     I              JCUVST                          WOUVST
     I              JCUWST                          WOUWST
     I              JCUXST                          WOUXST
     I              JCVSST                          WOVSST
     I              JCAATM                          WOAATM
     I              JCAYNA                          WOAYNA
     I              JCA0NA                          WOA0NA
     I              JCAXDT                          WOAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WRAIC3
     I              KNC4NB                          WRC4NB
     I              KNDPNB                          WRDPNB
     I              KNUENB                          WRUENB
     I              KNJGDT                          WRJGDT
     I              KNAODT                          WRAODT
     I              KNAJCD                          WRAJCD
     I              KNAYAA                          WRAYAA
     I              KNHGCD                          WRHGCD
     I              KNIGQT                          WRIGQT
     I              KNFLWG                          WRFLWG
     I              KNIUQT                          WRIUQT
     I              KNF3WG                          WRF3WG
     I              KNIVQT                          WRIVQT
     I              KNF4WG                          WRF4WG
     I              KNP7ST                          WRP7ST
     I              KNP8ST                          WRP8ST
     I              KNQAST                          WRQAST
     I              KNUVST                          WRUVST
     I              KNUWST                          WRUWST
     I              KNUXST                          WRUXST
     I              KNVSST                          WRVSST
     I              KNAATM                          WRAATM
     I              KNAYNA                          WRAYNA
     I              KNA0NA                          WRA0NA
     I              KNAXDT                          WRAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WSAIC3
     I              I8V5ST                          WSV5ST
     I              I8ELDT                          WSELDT
     I              I8HGCD                          WSHGCD
     I              I8AJCD                          WSAJCD
     I              I8GPDT                          WSGPDT
     I              I8WTSP                          WSWTSP
     I              I8QTSP                          WSQTSP
     I              I8DJPC                          WSDJPC
     I              I8F8WG                          WSF8WG
     I              I8WTIN                          WSWTIN
     I              I8D5NB                          WSD5NB
     I              I8DXWG                          WSDXWG
     I              I8B2NB                          WSB2NB
     I              I8WTCN                          WSWTCN
     I              I8PSCV                          WSPSCV
     I              I8SAWT                          WSSAWT
     I              I8B9NB                          WSB9NB
     I              I8D1WG                          WSD1WG
     I              I8CBNB                          WSCBNB
     I              I8EZWG                          WSEZWG
     I              I8CCNB                          WSCCNB
     I              I8E0WG                          WSE0WG
     I              I8D6NB                          WSD6NB
     I              I8OAWT                          WSOAWT
     I              I8CDNB                          WSCDNB
     I              I8UNW2                          WSUNW2
     I              I8CENB                          WSCENB
     I              I8F9WG                          WSF9WG
     I              I8BPNB                          WSBPNB
     I              I8GAWG                          WSGAWG
     I              I8BQNB                          WSBQNB
     I              I8GBWG                          WSGBWG
     I              I8BRNB                          WSBRNB
     I              I8GCWG                          WSGCWG
     I              I8BSNB                          WSBSNB
     I              I8GDWG                          WSGDWG
     I              I8BWNB                          WSBWNB
     I              I8GEWG                          WSGEWG
     I              I8PS6U                          WSPS6U
     I              I8WCST                          WSWCST
     I              I8WPST                          WSWPST
     I              I8B5ST                          WSB5ST
     I              I8TFST                          WSTFST
     I              I8TEST                          WSTEST
     I              I8THST                          WSTHST
     I              I8UDST                          WSUDST
     I              I8UFST                          WSUFST
     I              I8UGST                          WSUGST
     I              I8UHST                          WSUHST
     I              I8B6ST                          WSB6ST
     I              I8B7ST                          WSB7ST
     I              I8DVWG                          WSDVWG
     I              I8D7NB                          WSD7NB
     I              I8FCAD                          WSFCAD
     I              I8D9NB                          WSD9NB
     I              I8DWWG                          WSDWWG
     I              I8EANB                          WSEANB
     I              I8SHWT                          WSSHWT
     I              I8EBNB                          WSEBNB
     I              I8AVWT                          WSAVWT
     I              I8ECNB                          WSECNB
     I              I8WTON                          WSWTON
     I              I8EDNB                          WSEDNB
     I              I8FNWT                          WSFNWT
     I              I8EENB                          WSEENB
     I              I8QTAS                          WSQTAS
     I              I8EFNB                          WSEFNB
     I              I8WAIO                          WSWAIO
     I              I8EGNB                          WSEGNB
     I              I8R3CD                          WSR3CD
     I              I8RGNB                          WSRGNB
     I              I8RHNB                          WSRHNB
     I              I8RINB                          WSRINB
     I              I8XRCD                          WSXRCD
     I              I8UVST                          WSUVST
     I              I8UWST                          WSUWST
     I              I8UXST                          WSUXST
     I              I8VSST                          WSVSST
     I              I8AATM                          WSAATM
     I              I8AYNA                          WSAYNA
     I              I8A0NA                          WSA0NA
     I              I8AXDT                          WSAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WTAIC3
     I              I8V5ST                          WTV5ST
     I              I8ELDT                          WTELDT
     I              I8HGCD                          WTHGCD
     I              I8AJCD                          WTAJCD
     I              I8GPDT                          WTGPDT
     I              I8WTSP                          WTWTSP
     I              I8QTSP                          WTQTSP
     I              I8DJPC                          WTDJPC
     I              I8F8WG                          WTF8WG
     I              I8WTIN                          WTWTIN
     I              I8D5NB                          WTD5NB
     I              I8DXWG                          WTDXWG
     I              I8B2NB                          WTB2NB
     I              I8WTCN                          WTWTCN
     I              I8PSCV                          WTPSCV
     I              I8SAWT                          WTSAWT
     I              I8B9NB                          WTB9NB
     I              I8D1WG                          WTD1WG
     I              I8CBNB                          WTCBNB
     I              I8EZWG                          WTEZWG
     I              I8CCNB                          WTCCNB
     I              I8E0WG                          WTE0WG
     I              I8D6NB                          WTD6NB
     I              I8OAWT                          WTOAWT
     I              I8CDNB                          WTCDNB
     I              I8UNW2                          WTUNW2
     I              I8CENB                          WTCENB
     I              I8F9WG                          WTF9WG
     I              I8BPNB                          WTBPNB
     I              I8GAWG                          WTGAWG
     I              I8BQNB                          WTBQNB
     I              I8GBWG                          WTGBWG
     I              I8BRNB                          WTBRNB
     I              I8GCWG                          WTGCWG
     I              I8BSNB                          WTBSNB
     I              I8GDWG                          WTGDWG
     I              I8BWNB                          WTBWNB
     I              I8GEWG                          WTGEWG
     I              I8PS6U                          WTPS6U
     I              I8WCST                          WTWCST
     I              I8WPST                          WTWPST
     I              I8B5ST                          WTB5ST
     I              I8TFST                          WTTFST
     I              I8TEST                          WTTEST
     I              I8THST                          WTTHST
     I              I8UDST                          WTUDST
     I              I8UFST                          WTUFST
     I              I8UGST                          WTUGST
     I              I8UHST                          WTUHST
     I              I8B6ST                          WTB6ST
     I              I8B7ST                          WTB7ST
     I              I8DVWG                          WTDVWG
     I              I8D7NB                          WTD7NB
     I              I8FCAD                          WTFCAD
     I              I8D9NB                          WTD9NB
     I              I8DWWG                          WTDWWG
     I              I8EANB                          WTEANB
     I              I8SHWT                          WTSHWT
     I              I8EBNB                          WTEBNB
     I              I8AVWT                          WTAVWT
     I              I8ECNB                          WTECNB
     I              I8WTON                          WTWTON
     I              I8EDNB                          WTEDNB
     I              I8FNWT                          WTFNWT
     I              I8EENB                          WTEENB
     I              I8QTAS                          WTQTAS
     I              I8EFNB                          WTEFNB
     I              I8WAIO                          WTWAIO
     I              I8EGNB                          WTEGNB
     I              I8R3CD                          WTR3CD
     I              I8RGNB                          WTRGNB
     I              I8RHNB                          WTRHNB
     I              I8RINB                          WTRINB
     I              I8XRCD                          WTXRCD
     I              I8UVST                          WTUVST
     I              I8UWST                          WTUWST
     I              I8UXST                          WTUXST
     I              I8VSST                          WTVSST
     I              I8AATM                          WTAATM
     I              I8AYNA                          WTAYNA
     I              I8A0NA                          WTA0NA
     I              I8AXDT                          WTAXDT
      *
     I@B6CPAG
      * Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      * Renamed input format fields
     I              B6AIC3                          WVAIC3
     I              B6C4NB                          WVC4NB
     I              B6DPNB                          WVDPNB
     I              B6UENB                          WVUENB
     I              B6JGDT                          WVJGDT
     I              B6OONY                          WVOONY
     I              B6AODT                          WVAODT
     I              B6AJCD                          WVAJCD
     I              B6NUDT                          WVNUDT
     I              B6HGCD                          WVHGCD
     I              B6IGQT                          WVIGQT
     I              B6FLWG                          WVFLWG
     I              B6NSQT                          WVNSQT
     I              B6JQWG                          WVJQWG
     I              B6NVDT                          WVNVDT
     I              B6BUTM                          WVBUTM
     I              B6UVST                          WVUVST
     I              B6UWST                          WVUWST
     I              B6UXST                          WVUXST
     I              B6VSST                          WVVSST
     I              B6AATM                          WVAATM
     I              B6AYNA                          WVAYNA
     I              B6A0NA                          WVA0NA
     I              B6AXDT                          WVAXDT
      *
     I@IOREA4
      * Item Bill Of Material     Co/Item/CItem StrWgtYld
      * Renamed input format fields
     I              IOAIC3                          WWAIC3
     I              IOHGCD                          WWHGCD
     I              IOC9NB                          WWC9NB
     I              IOV2ST                          WWV2ST
     I              IOBOPR                          WWBOPR
     I              IOBPPR                          WWBPPR
     I              IOHGQT                          WWHGQT
     I              IOHHCD                          WWHHCD
     I              IOYAST                          WWYAST
     I              IOCNSM                          WWCNSM
     I              IOBMY1                          WWBMY1
     I              IOBMY2                          WWBMY2
     I              IOIXQT                          WWIXQT
     I              IOIYQT                          WWIYQT
     I              IORSST                          WWRSST
     I              IORTST                          WWRTST
     I              IOUVST                          WWUVST
     I              IOUWST                          WWUWST
     I              IOUXST                          WWUXST
     I              IOVSST                          WWVSST
     I              IOAATM                          WWAATM
     I              IOAYNA                          WWAYNA
     I              IOA0NA                          WWA0NA
     I              IOAXDT                          WWAXDT
      *
     I@CWCPQW
      * PS Prod Item Inventory    Retrieval index
      * Renamed input format fields
     I              CWAIC3                          WXAIC3
     I              CWHGCD                          WXHGCD
     I              CWAJCD                          WXAJCD
     I              CWELDT                          WXELDT
     I              CWACWG                          WXACWG
     I              CWARQT                          WXARQT
     I              CWK7DT                          WXK7DT
     I              CWUVST                          WXUVST
     I              CWUWST                          WXUWST
     I              CWUXST                          WXUXST
     I              CWVSST                          WXVSST
     I              CWAATM                          WXAATM
     I              CWAYNA                          WXAYNA
     I              CWA0NA                          WXA0NA
     I              CWAXDT                          WXAXDT
      *
     I@B5CPM4
      * Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      * Renamed input format fields
     I              B5AIC3                          WYAIC3
     I              B5C4NB                          WYC4NB
     I              B5DPNB                          WYDPNB
     I              B5UENB                          WYUENB
     I              B5JGDT                          WYJGDT
     I              B5AODT                          WYAODT
     I              B5AJCD                          WYAJCD
     I              B5HGCD                          WYHGCD
     I              B5IUQT                          WYIUQT
     I              B5F3WG                          WYF3WG
     I              B5UVST                          WYUVST
     I              B5UWST                          WYUWST
     I              B5UXST                          WYUXST
     I              B5VSST                          WYVSST
     I              B5AATM                          WYAATM
     I              B5AYNA                          WYAYNA
     I              B5A0NA                          WYA0NA
     I              B5AXDT                          WYAXDT
      *
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          TAAIC3
     I              FDHGCD                          TAHGCD
     I              FDD0ST                          TAD0ST
     I              FDD2ST                          TAD2ST
     I              FDD6ST                          TAD6ST
     I              FDWESP                          TAWESP
     I              FDEDST                          TAEDST
     I              FDEFST                          TAEFST
     I              FDEHST                          TAEHST
     I              FDEMST                          TAEMST
     I              FDENST                          TAENST
     I              FDEOST                          TAEOST
     I              FDEPST                          TAEPST
     I              FDEQST                          TAEQST
     I              FDOQNY                          TAOQNY
     I              FDORNY                          TAORNY
     I              FDS2DT                          TAS2DT
     I              FDUFT1                          TAUFT1
     I              FDKUAA                          TAKUAA
     I              FDVSST                          TAVSST
     I              FDMJDT                          TAMJDT
     I              FDBETM                          TABETM
     I              FDCCVN                          TACCVN
     I              FDCDVN                          TACDVN
     I              FDMKDT                          TAMKDT
     I              FDBFTM                          TABFTM
     I              FDCEVN                          TACEVN
     I              FDCFVN                          TACFVN
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          TBAIC3
     I              AFBCDT                          TBBCDT
     I              AFCQNB                          TBCQNB
     I              AFESNB                          TBESNB
     I              AFETNB                          TBETNB
     I              AFBZNB                          TBBZNB
     I              AFA9ST                          TBA9ST
     I              AFEINB                          TBEINB
     I              AFC5ST                          TBC5ST
     I              AFAQNB                          TBAQNB
     I              AFCMST                          TBCMST
     I              AFV9ST                          TBV9ST
     I              AFWAST                          TBWAST
     I              AFX2ST                          TBX2ST
     I              AFOJDT                          TBOJDT
     I              AFNQNX                          TBNQNX
     I              AFNRNX                          TBNRNX
     I              AFI9SX                          TBI9SX
     I              AFJASX                          TBJASX
     I              AFOKDT                          TBOKDT
     I              AFOLDT                          TBOLDT
     I              AFUVST                          TBUVST
     I              AFUWST                          TBUWST
     I              AFUXST                          TBUXST
     I              AFAATM                          TBAATM
     I              AFAYNA                          TBAYNA
     I              AFA0NA                          TBA0NA
     I              AFAXDT                          TBAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          TCAIC3
     I              I8V5ST                          TCV5ST
     I              I8ELDT                          TCELDT
     I              I8HGCD                          TCHGCD
     I              I8AJCD                          TCAJCD
     I              I8GPDT                          TCGPDT
     I              I8WTSP                          TCWTSP
     I              I8QTSP                          TCQTSP
     I              I8DJPC                          TCDJPC
     I              I8F8WG                          TCF8WG
     I              I8WTIN                          TCWTIN
     I              I8D5NB                          TCD5NB
     I              I8DXWG                          TCDXWG
     I              I8B2NB                          TCB2NB
     I              I8WTCN                          TCWTCN
     I              I8PSCV                          TCPSCV
     I              I8SAWT                          TCSAWT
     I              I8B9NB                          TCB9NB
     I              I8D1WG                          TCD1WG
     I              I8CBNB                          TCCBNB
     I              I8EZWG                          TCEZWG
     I              I8CCNB                          TCCCNB
     I              I8E0WG                          TCE0WG
     I              I8D6NB                          TCD6NB
     I              I8OAWT                          TCOAWT
     I              I8CDNB                          TCCDNB
     I              I8UNW2                          TCUNW2
     I              I8CENB                          TCCENB
     I              I8F9WG                          TCF9WG
     I              I8BPNB                          TCBPNB
     I              I8GAWG                          TCGAWG
     I              I8BQNB                          TCBQNB
     I              I8GBWG                          TCGBWG
     I              I8BRNB                          TCBRNB
     I              I8GCWG                          TCGCWG
     I              I8BSNB                          TCBSNB
     I              I8GDWG                          TCGDWG
     I              I8BWNB                          TCBWNB
     I              I8GEWG                          TCGEWG
     I              I8PS6U                          TCPS6U
     I              I8WCST                          TCWCST
     I              I8WPST                          TCWPST
     I              I8B5ST                          TCB5ST
     I              I8TFST                          TCTFST
     I              I8TEST                          TCTEST
     I              I8THST                          TCTHST
     I              I8UDST                          TCUDST
     I              I8UFST                          TCUFST
     I              I8UGST                          TCUGST
     I              I8UHST                          TCUHST
     I              I8B6ST                          TCB6ST
     I              I8B7ST                          TCB7ST
     I              I8DVWG                          TCDVWG
     I              I8D7NB                          TCD7NB
     I              I8FCAD                          TCFCAD
     I              I8D9NB                          TCD9NB
     I              I8DWWG                          TCDWWG
     I              I8EANB                          TCEANB
     I              I8SHWT                          TCSHWT
     I              I8EBNB                          TCEBNB
     I              I8AVWT                          TCAVWT
     I              I8ECNB                          TCECNB
     I              I8WTON                          TCWTON
     I              I8EDNB                          TCEDNB
     I              I8FNWT                          TCFNWT
     I              I8EENB                          TCEENB
     I              I8QTAS                          TCQTAS
     I              I8EFNB                          TCEFNB
     I              I8WAIO                          TCWAIO
     I              I8EGNB                          TCEGNB
     I              I8R3CD                          TCR3CD
     I              I8RGNB                          TCRGNB
     I              I8RHNB                          TCRHNB
     I              I8RINB                          TCRINB
     I              I8XRCD                          TCXRCD
     I              I8UVST                          TCUVST
     I              I8UWST                          TCUWST
     I              I8UXST                          TCUXST
     I              I8VSST                          TCVSST
     I              I8AATM                          TCAATM
     I              I8AYNA                          TCAYNA
     I              I8A0NA                          TCA0NA
     I              I8AXDT                          TCAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          TDAIC3
     I              AFBCDT                          TDBCDT
     I              AFCQNB                          TDCQNB
     I              AFESNB                          TDESNB
     I              AFETNB                          TDETNB
     I              AFBZNB                          TDBZNB
     I              AFA9ST                          TDA9ST
     I              AFEINB                          TDEINB
     I              AFC5ST                          TDC5ST
     I              AFAQNB                          TDAQNB
     I              AFCMST                          TDCMST
     I              AFV9ST                          TDV9ST
     I              AFWAST                          TDWAST
     I              AFX2ST                          TDX2ST
     I              AFOJDT                          TDOJDT
     I              AFNQNX                          TDNQNX
     I              AFNRNX                          TDNRNX
     I              AFI9SX                          TDI9SX
     I              AFJASX                          TDJASX
     I              AFOKDT                          TDOKDT
     I              AFOLDT                          TDOLDT
     I              AFUVST                          TDUVST
     I              AFUWST                          TDUWST
     I              AFUXST                          TDUXST
     I              AFAATM                          TDAATM
     I              AFAYNA                          TDAYNA
     I              AFA0NA                          TDA0NA
     I              AFAXDT                          TDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WIAIC3
     I              B5C4NB                          WIC4NB
     I              B5DPNB                          WIDPNB
     I              B5UENB                          WIUENB
     I              B5JGDT                          WIJGDT
     I              B5AODT                          WIAODT
     I              B5AJCD                          WIAJCD
     I              B5HGCD                          WIHGCD
     I              B5IUQT                          WIIUQT
     I              B5F3WG                          WIF3WG
     I              B5UVST                          WIUVST
     I              B5UWST                          WIUWST
     I              B5UXST                          WIUXST
     I              B5VSST                          WIVSST
     I              B5AATM                          WIAATM
     I              B5AYNA                          WIAYNA
     I              B5A0NA                          WIA0NA
     I              B5AXDT                          WIAXDT
      *
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WRAIC3
     I              KNC4NB                          WRC4NB
     I              KNDPNB                          WRDPNB
     I              KNUENB                          WRUENB
     I              KNJGDT                          WRJGDT
     I              KNAODT                          WRAODT
     I              KNAJCD                          WRAJCD
     I              KNAYAA                          WRAYAA
     I              KNHGCD                          WRHGCD
     I              KNIGQT                          WRIGQT
     I              KNFLWG                          WRFLWG
     I              KNIUQT                          WRIUQT
     I              KNF3WG                          WRF3WG
     I              KNIVQT                          WRIVQT
     I              KNF4WG                          WRF4WG
     I              KNP7ST                          WRP7ST
     I              KNP8ST                          WRP8ST
     I              KNQAST                          WRQAST
     I              KNUVST                          WRUVST
     I              KNUWST                          WRUWST
     I              KNUXST                          WRUXST
     I              KNVSST                          WRVSST
     I              KNAATM                          WRAATM
     I              KNAYNA                          WRAYNA
     I              KNA0NA                          WRA0NA
     I              KNAXDT                          WRAXDT
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WTAIC3
     I              I8V5ST                          WTV5ST
     I              I8ELDT                          WTELDT
     I              I8HGCD                          WTHGCD
     I              I8AJCD                          WTAJCD
     I              I8GPDT                          WTGPDT
     I              I8WTSP                          WTWTSP
     I              I8QTSP                          WTQTSP
     I              I8DJPC                          WTDJPC
     I              I8F8WG                          WTF8WG
     I              I8WTIN                          WTWTIN
     I              I8D5NB                          WTD5NB
     I              I8DXWG                          WTDXWG
     I              I8B2NB                          WTB2NB
     I              I8WTCN                          WTWTCN
     I              I8PSCV                          WTPSCV
     I              I8SAWT                          WTSAWT
     I              I8B9NB                          WTB9NB
     I              I8D1WG                          WTD1WG
     I              I8CBNB                          WTCBNB
     I              I8EZWG                          WTEZWG
     I              I8CCNB                          WTCCNB
     I              I8E0WG                          WTE0WG
     I              I8D6NB                          WTD6NB
     I              I8OAWT                          WTOAWT
     I              I8CDNB                          WTCDNB
     I              I8UNW2                          WTUNW2
     I              I8CENB                          WTCENB
     I              I8F9WG                          WTF9WG
     I              I8BPNB                          WTBPNB
     I              I8GAWG                          WTGAWG
     I              I8BQNB                          WTBQNB
     I              I8GBWG                          WTGBWG
     I              I8BRNB                          WTBRNB
     I              I8GCWG                          WTGCWG
     I              I8BSNB                          WTBSNB
     I              I8GDWG                          WTGDWG
     I              I8BWNB                          WTBWNB
     I              I8GEWG                          WTGEWG
     I              I8PS6U                          WTPS6U
     I              I8WCST                          WTWCST
     I              I8WPST                          WTWPST
     I              I8B5ST                          WTB5ST
     I              I8TFST                          WTTFST
     I              I8TEST                          WTTEST
     I              I8THST                          WTTHST
     I              I8UDST                          WTUDST
     I              I8UFST                          WTUFST
     I              I8UGST                          WTUGST
     I              I8UHST                          WTUHST
     I              I8B6ST                          WTB6ST
     I              I8B7ST                          WTB7ST
     I              I8DVWG                          WTDVWG
     I              I8D7NB                          WTD7NB
     I              I8FCAD                          WTFCAD
     I              I8D9NB                          WTD9NB
     I              I8DWWG                          WTDWWG
     I              I8EANB                          WTEANB
     I              I8SHWT                          WTSHWT
     I              I8EBNB                          WTEBNB
     I              I8AVWT                          WTAVWT
     I              I8ECNB                          WTECNB
     I              I8WTON                          WTWTON
     I              I8EDNB                          WTEDNB
     I              I8FNWT                          WTFNWT
     I              I8EENB                          WTEENB
     I              I8QTAS                          WTQTAS
     I              I8EFNB                          WTEFNB
     I              I8WAIO                          WTWAIO
     I              I8EGNB                          WTEGNB
     I              I8R3CD                          WTR3CD
     I              I8RGNB                          WTRGNB
     I              I8RHNB                          WTRHNB
     I              I8RINB                          WTRINB
     I              I8XRCD                          WTXRCD
     I              I8UVST                          WTUVST
     I              I8UWST                          WTUWST
     I              I8UXST                          WTUXST
     I              I8VSST                          WTVSST
     I              I8AATM                          WTAATM
     I              I8AYNA                          WTAYNA
     I              I8A0NA                          WTA0NA
     I              I8AXDT                          WTAXDT
      *
     IYARDCS      DS                             91
     IYBRDCS      DS                            326
     IYCRDCS      DS                            100
      * Outward parameters
     IPARC        DS                             14
      * KEY : Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Item Code
     I                                    P   3   60PAHGCD
      *
     IYDRDCS      DS                            326
     IYERDCS      DS                            326
     IYFRDCS      DS                             69
     IYGRDCS      DS                            100
     IYHRDCS      DS                            326
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BPS Proc ODBS f/Ovrde XF
      * created because pmd1xfr has reached the 50 file limit
      * BPS Proc ODBS f/Ovrde RT - Order Detail Build Sched  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * BPS Proc ODBS f/Ovrde RT - Order Detail Build Sched  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@E6CPC6                    *
     C                     READ @E6CPC6                  90*
      * Data record not found
     C   90                MOVEL'USR4107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAHGCD    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    YL0001    P      U/M - Primary
     C                     Z-ADDWL0005    YL0002           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    YL0003           Fresh Chilling
     C                     MOVELWL0012    YL0004    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    YL0005           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    YL0006    P      Piece Count Ite
     C                     Z-ADDWL0021    YL0007           Pieces Per Bag
     C                     Z-ADDWL0022    YL0008           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0029    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    YL0009    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    YL0010    P      Warehouse Std C
     C                     Z-ADDWL0034    YL0011           Warehouse Chill
      * UPS Re-Alc Inv/Prd O2 RT - Order Detail  * 
     C                     EXSR SDRVGN
     C                     READ @E6CPC6                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           U/M - Primary
     C                     Z-ADD*ZERO     WL0005           Unit Weight
     C                     Z-ADD*ZERO     WL0006           Item Structure
     C                     Z-ADD*ZERO     WL0007           Item Structure
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0013           Variety/Rendere
     C                     MOVEL*BLANK    WL0014           Credit Item Sta
     C                     Z-ADD*ZERO     WL0015           Std Weight/Head
     C                     Z-ADD*ZERO     WL0016           Pieces Per Head
     C                     MOVEL*BLANK    WL0017           Department Code
     C                     MOVEL*BLANK    WL0018           Group for Packa
     C                     MOVEL*BLANK    WL0019           Seconds Item
     C                     MOVEL*BLANK    WL0020           Piece Count Ite
     C                     Z-ADD*ZERO     WL0021           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0022           Bags Per Unit
     C                     MOVEL*BLANK    WL0023           Export/Domestic
     C                     MOVEL*BLANK    WL0024           Print On Schedu
     C                     MOVEL*BLANK    WL0025           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0026           Fresh Sched As
     C                     MOVEL*BLANK    WL0027           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0028           Primal Group Co
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    WL0003           Description Lin
     C                     MOVELWBADCD    WL0004           U/M - Primary
     C                     Z-ADDWBAIWG    WL0005           Unit Weight
     C                     Z-ADDWBRINB    WL0006           Item Structure
     C                     Z-ADDWBRHNB    WL0007           Item Structure
     C                     Z-ADDWBRGNB    WL0008           Item Structure
     C                     MOVELWBN0CD    WL0009           Item Type Code
     C                     MOVELWBQ1CD    WL0010           Default Warehou
     C                     Z-ADDWBCHTM    WL0011           Fresh Chilling
     C                     MOVELWBQZCD    WL0012           Base/Conv/Loss
     C                     MOVELWBXWST    WL0013           Variety/Rendere
     C                     MOVELWBVMST    WL0014           Credit Item Sta
     C                     Z-ADDWBSWGH    WL0015           Std Weight/Head
     C                     Z-ADDWBPPHE    WL0016           Pieces Per Head
     C                     MOVELWBR3CD    WL0017           Department Code
     C                     MOVELWBSDCD    WL0018           Group for Packa
     C                     MOVELWBX5ST    WL0019           Seconds Item
     C                     MOVELWBPCCT    WL0020           Piece Count Ite
     C                     Z-ADDWBBDNB    WL0021           Pieces Per Bag
     C                     Z-ADDWBBJNB    WL0022           Bags Per Unit
     C                     MOVELWBSUST    WL0023           Export/Domestic
     C                     MOVELWBSVST    WL0024           Print On Schedu
     C                     MOVELWBSYST    WL0025           Fresh Inv Alloc
     C                     MOVELWBSZST    WL0026           Fresh Sched As
     C                     MOVELWBS1ST    WL0027           Frozen Inv Allo
     C                     MOVELWBXRCD    WL0028           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0029    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Warehouse Type
     C                     MOVEL*BLANK    WL0031           Trans Contol AS
     C                     MOVEL*BLANK    WL0032           Warehouse Locat
     C                     MOVEL*BLANK    WL0033           Warehouse Std C
     C                     Z-ADD*ZERO     WL0034           Warehouse Chill
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WL0030           Warehouse Type
     C                     MOVELWCXUST    WL0031           Trans Contol AS
     C                     MOVELWCT0ST    WL0032           Warehouse Locat
     C                     MOVELWCT1ST    WL0033           Warehouse Std C
     C                     Z-ADDWCDBNB    WL0034           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prd O2 RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWAC4NB    WDC4NB           Order Number
     C                     Z-ADDWADPNB    WDDPNB           Order Sequence
     C                     Z-ADDWAUENB    WDUENB           Order Secondary
      * Establish starting position
     C           KRSSD     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           WDGMST    IFEQ 'X'                        *IF
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0002 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0001           Company Number
     C                     Z-ADDWDHGCD    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    YL0012    P      U/M - Primary
     C                     Z-ADDWL0005    YL0013           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    YL0014           Fresh Chilling
     C                     MOVELWL0012    YL0015    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    YL0016           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    YL0017    P      Piece Count Ite
     C                     Z-ADDWL0021    YL0018           Pieces Per Bag
     C                     Z-ADDWL0022    YL0019           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWDAJCD    WL0029    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    YL0020    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    YL0021    P      Warehouse Std C
     C                     Z-ADDWL0034    YL0022           Warehouse Chill
      * UPS Re-Alc Inv/Prd O2 RT - Order Detail Schedule  * 
     C                     EXSR SERVGN
      * order sched should not change
     C                     END                             *FI
     C                     ENDIF
      * USER: Exit processing
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prd O2 RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0004 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Del OrdDtl Sch-Cons-O2RT - Order Detail Sched-Consmd  * 
     C                     EXSR SFRVGN
      * Del Ord Dtl Sch-InvO2 RT - Order Detail Sched-Inv  * 
     C                     EXSR SHRVGN
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Setup key
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDC4NB    WEC4NB           Order Number
     C                     Z-ADDWDDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWDUENB    WEUENB           Order Secondary
     C                     Z-ADD##JDT     WEJGDT           OD Production D
      * Establish starting position
     C           KRSSE     CHAIN@KNCPHO              90    *
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     Z-ADDWEJGDT    WL0047           Post to G/L Dat
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0023    P      Production Day
      * S0538 RMC Always alloc orders 3/16/2010
     C                     MOVEL'Y'       YL0023           Production Day
      * RTV Requested Dlvry dt RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * Allocate Inventory/Production
      * CASE: LCL.Production Day Status is yes
     C           YL0023    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     YL0026           Quantity Ordere
     C                     Z-ADD*ZERO     YL0027           Weight Ordered
     C           WEIGQT    ADD  *ZERO     YL0028           Quantity Schedu
     C           WEFLWG    ADD  *ZERO     YL0029           Weight Schedule
      * make negative
     C           0         SUB  YL0028    YL0030           ATS Quantity Ne
     C           0         SUB  YL0029    YL0031           ATS Weight Need
      * Deallocate Production
      * CASE: LCL.ATS Weight Need USR is Less than zero
     C           YL0031    IFLT *ZERO                      *IF
      * Upd Deallocate PRD    RT - Order Detail Schedule  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
      * make positive
     C           WEIGQT    ADD  *ZERO     YL0030           ATS Quantity Ne
     C           WEFLWG    ADD  *ZERO     YL0031           ATS Weight Need
     C                     Z-ADDYL0030    YL0026           Quantity Ordere
     C                     Z-ADDYL0031    YL0027           Weight Ordered
      * Age Limit   using item age days or from/to date
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0022    YL0040           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0014    YL0040           Chilling Time U
     C                     END                             *FI
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0037  30       Company Number
     C                     PARM YL0040    WQ0038  52       Chilling Time U
     C                     PARM WEAODT    WQ0039  70       Scheduled Ship
     C                     PARM YL0024    WQ0040  70       Requested Deliv
     C                     PARM WDRINY    WQ0041  40       Item Age Days
     C                     PARM WDTIDT    WQ0042  70       Production Ovr
     C                     PARM WDTJDT    WQ0043  70       Production Ovr
     C           YL0041    PARM YL0041    WQ0044  70       Production AgeD
     C           YL0042    PARM YL0042    WQ0045  70       Production AgeD
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** This will create the new order detail schedule record **
      *    for the current date.
      *
     C                     Z-ADD*ZERO     WN0515 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0516 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0517 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0518  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * FP1054 4/14/09 Changed to pass par.to date usr to RTV
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0041    IFLT ##JDT                      *IF
     C           YL0030    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     C                     ADD  YL0028    WN0003           Quantity Schedu
     C                     ADD  YL0029    WN0004           Weight Schedule
      * Allocate Production Or Standard
      * CASE: LCL.ATS Quantity Need USR is Greater than zero
     C           YL0030    IFGT *ZERO                      *IF
     C                     Z-ADDWEIGQT    YL0026           Quantity Ordere
     C                     Z-ADDWEFLWG    YL0027           Weight Ordered
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
     C                     Z-ADDWEJGDT    YL0047           Production Date
      * If Base, allocated Production. If Converted, allocate Standard
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0015    IFEQ 'B'                        *IF
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEAJCD    WL0049    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0048    P      Production Ware
     C                     Z-ADDWL0051    YL0049           Accounting Comp
      *
     C                     MOVEL*BLANK    WN0654  1        Production Type
     C                     Z-ADD*ZERO     WN0655 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0656 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0657  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0658 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0659  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0660  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0661  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0662  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0663  52       Production Yiel
     C                     Z-ADD*ZERO     WN0664  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0665 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UASUBR                     documentation
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0020    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0257           Company Number
     C                     Z-ADDWEHGCD    WL0258           Item Code
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0259    YL0050    P      Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0022    WN0661           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0014    WN0661           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWEJGDT    YL0051           Production Date
      * DOC:  Allocation
     C                     EXSR UBSUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0050    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0047           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWEJGDT    YL0051           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEJGDT    YL0047           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFLE YL0051                     *IF
     C           YL0030    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     Z-ADDYL0047    WL0047           Post to G/L Dat
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0052    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0260           Company Number
     C                     Z-ADDWEHGCD    WL0261           Item Code
     C                     Z-ADDYL0047    WL0262           Production Date
     C                     MOVELYL0053    WL0263    P      Production Day
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0263    YL0053    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0052    IFEQ 'Y'                        *IF
     C           YL0053    IFEQ *BLANK                     *IF
     C           YL0053    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0047    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0654           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0052           Company Number
     C                     MOVELWN0654    WL0053    P      Production Type
     C                     Z-ADDYL0047    WL0054           Production Date
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0654           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0047    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0654           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0264           Company Number
     C                     MOVELWN0654    WL0265    P      Production Type
     C                     Z-ADDYL0047    WL0266           Production Date
     C                     Z-ADDWEHGCD    WL0267           Item Code
     C                     MOVELWEAJCD    WL0268    P      Warehouse Code
     C                     Z-ADDWN0656    WL0270           ATS Weight Avai
     C                     Z-ADDWN0657    WL0271           ATS Pieces Avai
     C                     Z-ADDWN0661    WL0272           Chilling Time U
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0269    WN0662           PS Avg Piece Wg
     C                     Z-ADDWL0270    WN0656           ATS Weight Avai
     C                     Z-ADDWL0271    WN0657           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'Y'                        *IF
     C           YL0018    IFGT *ZERO                      *IF
     C           YL0019    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0018    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           WN0657    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0655           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0017    OREQ 'N'
     C           YL0013    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0656    DIV  YL0013    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0655           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0655           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0655    IFLT YL0030                     *IF
     C                     Z-ADDYL0030    WN0655           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0655    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0030    IFGT WN0655                     *IF
     C                     ADD  WN0655    YL0028           Quantity Schedu
     C           WN0655    MULT YL0013    WN0656           ATS Weight Avai
     C                     ADD  WN0656    YL0029           Weight Schedule
     C                     Z-ADDWN0656    WN0659           Weight Allocate
     C                     Z-ADDWN0655    WN0658           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0030    IFLE WN0655                     *IF
     C                     ADD  YL0030    YL0028           Quantity Schedu
     C           YL0030    MULT YL0013    YL0031           ATS Weight Need
     C                     ADD  YL0031    YL0029           Weight Schedule
     C                     Z-ADDYL0031    WN0659           Weight Allocate
     C                     Z-ADDYL0030    WN0658           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0658    IFGT *ZERO                      *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0658    MULT YL0018    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0019    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0660           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0660    MULT WN0662    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0659           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFEQ WEAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0273           Company Number
     C                     Z-ADDWEC4NB    WL0274           Order Number
     C                     Z-ADDWEDPNB    WL0275           Order Sequence
     C                     Z-ADDWEUENB    WL0276           Order Secondary
     C                     Z-ADDYL0047    WL0277           OD Production D
     C                     Z-ADDWEAODT    WL0278           Scheduled Ship
     C                     MOVELWEAJCD    WL0279    P      Warehouse Code
     C                     MOVELWEAJCD    WL0280    P      Order From Ware
     C                     Z-ADDWEHGCD    WL0281           Item Code
     C                     Z-ADDWN0659    WL0282           Weight Allocate
     C                     Z-ADDWN0658    WL0283           Quantity Alloca
     C                     MOVELYL0015    WL0284    P      Base/Conv/Loss
     C                     EXSR TVRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFNE WEAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0015    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0220           Company Number
     C                     MOVELWN0654    WL0221    P      Production Type
     C                     Z-ADDYL0047    WL0222           Production Date
     C                     Z-ADDWEHGCD    WL0223           Item Code
     C                     MOVELWEAJCD    WL0224    P      Warehouse Code
     C                     Z-ADDWN0659    WL0225           Weight Allocate
     C                     Z-ADDWN0660    WL0226           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0227           Order Number
     C                     Z-ADDWEDPNB    WL0228           Order Sequence
     C                     Z-ADDWEUENB    WL0229           Order Secondary
     C                     MOVEL'N'       WL0230    P      Status Flag 19
     C                     EXSR TERVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0213           Company Number
     C                     MOVELWN0654    WL0214    P      Production Type
     C                     Z-ADDYL0047    WL0215           Production Date
     C                     Z-ADDWEHGCD    WL0216           Item Code
     C                     MOVELWEAJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWN0660    WL0218           Pieces Schedule
     C                     Z-ADDWN0659    WL0219           Weight Schedule
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0071           Company Number
     C                     MOVELWN0654    WL0072    P      Production Type
     C                     Z-ADDYL0047    WL0073           Production Date
     C                     Z-ADDWEHGCD    WL0074           Item Code
     C                     MOVELWEAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWN0659    WL0076           Weight Allocate
     C                     Z-ADDWN0660    WL0077           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0078           Order Number
     C                     Z-ADDWEDPNB    WL0079           Order Sequence
     C                     Z-ADDWEUENB    WL0080           Order Secondary
     C                     MOVEL'N'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0658           Quantity Alloca
     C                     Z-ADD*ZERO     WN0659           Weight Allocate
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0028           Quantity Schedu
     C                     ADD  *ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT *ZERO                      *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0285           Company Number
     C                     Z-ADDYL0047    WL0286           Post to G/L Dat
     C                     Z-ADDYL0047    WL0288           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0289           *Duration (fact
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0287    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0290           Company Number
     C                     Z-ADDYL0047    WL0291           Post to G/L Dat
     C                     Z-ADDYL0047    WL0293           *Date2 (beginni
     C                     Z-ADD1         WL0294           *Duration (fact
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0292    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ *ZERO                      *IF
     C                     Z-ADDYL0047    YL0047           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0050    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWEJGDT    YL0056           Production Date
     C                     Z-ADDWEJGDT    YL0047           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0056           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWEJGDT    YL0051           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEJGDT    YL0047           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFGE YL0056                     *IF
     C           YL0030    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     Z-ADDYL0047    WL0047           Post to G/L Dat
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0052    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0260           Company Number
     C                     Z-ADDWEHGCD    WL0261           Item Code
     C                     Z-ADDYL0047    WL0262           Production Date
     C                     MOVELYL0053    WL0263    P      Production Day
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0263    YL0053    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0052    IFEQ 'Y'                        *IF
     C           YL0053    IFEQ *BLANK                     *IF
     C           YL0053    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0047    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0654           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0052           Company Number
     C                     MOVELWN0654    WL0053    P      Production Type
     C                     Z-ADDYL0047    WL0054           Production Date
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0654           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0047    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0654           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0264           Company Number
     C                     MOVELWN0654    WL0265    P      Production Type
     C                     Z-ADDYL0047    WL0266           Production Date
     C                     Z-ADDWEHGCD    WL0267           Item Code
     C                     MOVELWEAJCD    WL0268    P      Warehouse Code
     C                     Z-ADDWN0656    WL0270           ATS Weight Avai
     C                     Z-ADDWN0657    WL0271           ATS Pieces Avai
     C                     Z-ADDWN0661    WL0272           Chilling Time U
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0269    WN0662           PS Avg Piece Wg
     C                     Z-ADDWL0270    WN0656           ATS Weight Avai
     C                     Z-ADDWL0271    WN0657           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'Y'                        *IF
     C           YL0018    IFGT *ZERO                      *IF
     C           YL0019    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0018    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           WN0657    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0655           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0017    OREQ 'N'
     C           YL0013    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0656    DIV  YL0013    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0655           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0655           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0655    IFLT YL0030                     *IF
     C                     Z-ADDYL0030    WN0655           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0655    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0030    IFGT WN0655                     *IF
     C                     ADD  WN0655    YL0028           Quantity Schedu
     C           WN0655    MULT YL0013    WN0656           ATS Weight Avai
     C                     ADD  WN0656    YL0029           Weight Schedule
     C                     Z-ADDWN0656    WN0659           Weight Allocate
     C                     Z-ADDWN0655    WN0658           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0030    IFLE WN0655                     *IF
     C                     ADD  YL0030    YL0028           Quantity Schedu
     C           YL0030    MULT YL0013    YL0031           ATS Weight Need
     C                     ADD  YL0031    YL0029           Weight Schedule
     C                     Z-ADDYL0031    WN0659           Weight Allocate
     C                     Z-ADDYL0030    WN0658           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0658    IFGT *ZERO                      *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0658    MULT YL0018    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0019    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0660           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0660    MULT WN0662    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0659           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFEQ WEAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0273           Company Number
     C                     Z-ADDWEC4NB    WL0274           Order Number
     C                     Z-ADDWEDPNB    WL0275           Order Sequence
     C                     Z-ADDWEUENB    WL0276           Order Secondary
     C                     Z-ADDYL0047    WL0277           OD Production D
     C                     Z-ADDWEAODT    WL0278           Scheduled Ship
     C                     MOVELWEAJCD    WL0279    P      Warehouse Code
     C                     MOVELWEAJCD    WL0280    P      Order From Ware
     C                     Z-ADDWEHGCD    WL0281           Item Code
     C                     Z-ADDWN0659    WL0282           Weight Allocate
     C                     Z-ADDWN0658    WL0283           Quantity Alloca
     C                     MOVELYL0015    WL0284    P      Base/Conv/Loss
     C                     EXSR TVRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFNE WEAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0015    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0220           Company Number
     C                     MOVELWN0654    WL0221    P      Production Type
     C                     Z-ADDYL0047    WL0222           Production Date
     C                     Z-ADDWEHGCD    WL0223           Item Code
     C                     MOVELWEAJCD    WL0224    P      Warehouse Code
     C                     Z-ADDWN0659    WL0225           Weight Allocate
     C                     Z-ADDWN0660    WL0226           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0227           Order Number
     C                     Z-ADDWEDPNB    WL0228           Order Sequence
     C                     Z-ADDWEUENB    WL0229           Order Secondary
     C                     MOVEL'N'       WL0230    P      Status Flag 19
     C                     EXSR TERVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0213           Company Number
     C                     MOVELWN0654    WL0214    P      Production Type
     C                     Z-ADDYL0047    WL0215           Production Date
     C                     Z-ADDWEHGCD    WL0216           Item Code
     C                     MOVELWEAJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWN0660    WL0218           Pieces Schedule
     C                     Z-ADDWN0659    WL0219           Weight Schedule
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0071           Company Number
     C                     MOVELWN0654    WL0072    P      Production Type
     C                     Z-ADDYL0047    WL0073           Production Date
     C                     Z-ADDWEHGCD    WL0074           Item Code
     C                     MOVELWEAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWN0659    WL0076           Weight Allocate
     C                     Z-ADDWN0660    WL0077           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0078           Order Number
     C                     Z-ADDWEDPNB    WL0079           Order Sequence
     C                     Z-ADDWEUENB    WL0080           Order Secondary
     C                     MOVEL'N'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0658           Quantity Alloca
     C                     Z-ADD*ZERO     WN0659           Weight Allocate
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0028           Quantity Schedu
     C                     ADD  *ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0285           Company Number
     C                     Z-ADDYL0047    WL0286           Post to G/L Dat
     C                     Z-ADDYL0047    WL0288           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0289           *Duration (fact
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0287    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0290           Company Number
     C                     Z-ADDYL0047    WL0291           Post to G/L Dat
     C                     Z-ADDYL0047    WL0293           *Date2 (beginni
     C                     Z-ADD-1        WL0294           *Duration (fact
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0292    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDYL0047    YL0047           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0020    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0057           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0022    WN0661           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0014    WN0661           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWEJGDT    YL0051           Production Date
      * DOC:  Allocation
     C                     EXSR UCSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0057    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWEJGDT    YL0056           Production Date
     C                     Z-ADDWEJGDT    YL0047           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0056           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWEJGDT    YL0051           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEJGDT    YL0047           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFGE YL0056                     *IF
     C           YL0030    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     Z-ADDYL0047    WL0047           Post to G/L Dat
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0052    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0260           Company Number
     C                     Z-ADDWEHGCD    WL0261           Item Code
     C                     Z-ADDYL0047    WL0262           Production Date
     C                     MOVELYL0053    WL0263    P      Production Day
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0263    YL0053    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0052    IFEQ 'Y'                        *IF
     C           YL0053    IFEQ *BLANK                     *IF
     C           YL0053    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0047    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0654           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0052           Company Number
     C                     MOVELWN0654    WL0053    P      Production Type
     C                     Z-ADDYL0047    WL0054           Production Date
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0654           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0047    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0654           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0264           Company Number
     C                     MOVELWN0654    WL0265    P      Production Type
     C                     Z-ADDYL0047    WL0266           Production Date
     C                     Z-ADDWEHGCD    WL0267           Item Code
     C                     MOVELWEAJCD    WL0268    P      Warehouse Code
     C                     Z-ADDWN0656    WL0270           ATS Weight Avai
     C                     Z-ADDWN0657    WL0271           ATS Pieces Avai
     C                     Z-ADDWN0661    WL0272           Chilling Time U
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0269    WN0662           PS Avg Piece Wg
     C                     Z-ADDWL0270    WN0656           ATS Weight Avai
     C                     Z-ADDWL0271    WN0657           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'Y'                        *IF
     C           YL0018    IFGT *ZERO                      *IF
     C           YL0019    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0018    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           WN0657    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0655           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0017    OREQ 'N'
     C           YL0013    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0656    DIV  YL0013    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0655           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0655           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0655    IFLT YL0030                     *IF
     C                     Z-ADDYL0030    WN0655           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0655    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0030    IFGT WN0655                     *IF
     C                     ADD  WN0655    YL0028           Quantity Schedu
     C           WN0655    MULT YL0013    WN0656           ATS Weight Avai
     C                     ADD  WN0656    YL0029           Weight Schedule
     C                     Z-ADDWN0656    WN0659           Weight Allocate
     C                     Z-ADDWN0655    WN0658           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0030    IFLE WN0655                     *IF
     C                     ADD  YL0030    YL0028           Quantity Schedu
     C           YL0030    MULT YL0013    YL0031           ATS Weight Need
     C                     ADD  YL0031    YL0029           Weight Schedule
     C                     Z-ADDYL0031    WN0659           Weight Allocate
     C                     Z-ADDYL0030    WN0658           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0658    IFGT *ZERO                      *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0658    MULT YL0018    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0019    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0660           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0660    MULT WN0662    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0659           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFEQ WEAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0273           Company Number
     C                     Z-ADDWEC4NB    WL0274           Order Number
     C                     Z-ADDWEDPNB    WL0275           Order Sequence
     C                     Z-ADDWEUENB    WL0276           Order Secondary
     C                     Z-ADDYL0047    WL0277           OD Production D
     C                     Z-ADDWEAODT    WL0278           Scheduled Ship
     C                     MOVELWEAJCD    WL0279    P      Warehouse Code
     C                     MOVELWEAJCD    WL0280    P      Order From Ware
     C                     Z-ADDWEHGCD    WL0281           Item Code
     C                     Z-ADDWN0659    WL0282           Weight Allocate
     C                     Z-ADDWN0658    WL0283           Quantity Alloca
     C                     MOVELYL0015    WL0284    P      Base/Conv/Loss
     C                     EXSR TVRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFNE WEAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0220           Company Number
     C                     MOVELWN0654    WL0221    P      Production Type
     C                     Z-ADDYL0047    WL0222           Production Date
     C                     Z-ADDWEHGCD    WL0223           Item Code
     C                     MOVELWEAJCD    WL0224    P      Warehouse Code
     C                     Z-ADDWN0659    WL0225           Weight Allocate
     C                     Z-ADDWN0660    WL0226           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0227           Order Number
     C                     Z-ADDWEDPNB    WL0228           Order Sequence
     C                     Z-ADDWEUENB    WL0229           Order Secondary
     C                     MOVEL'N'       WL0230    P      Status Flag 19
     C                     EXSR TERVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0213           Company Number
     C                     MOVELWN0654    WL0214    P      Production Type
     C                     Z-ADDYL0047    WL0215           Production Date
     C                     Z-ADDWEHGCD    WL0216           Item Code
     C                     MOVELWEAJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWN0660    WL0218           Pieces Schedule
     C                     Z-ADDWN0659    WL0219           Weight Schedule
     C                     EXSR TCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0071           Company Number
     C                     MOVELWN0654    WL0072    P      Production Type
     C                     Z-ADDYL0047    WL0073           Production Date
     C                     Z-ADDWEHGCD    WL0074           Item Code
     C                     MOVELWEAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWN0659    WL0076           Weight Allocate
     C                     Z-ADDWN0660    WL0077           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0078           Order Number
     C                     Z-ADDWEDPNB    WL0079           Order Sequence
     C                     Z-ADDWEUENB    WL0080           Order Secondary
     C                     MOVEL'N'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0658           Quantity Alloca
     C                     Z-ADD*ZERO     WN0659           Weight Allocate
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0028           Quantity Schedu
     C                     ADD  *ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0285           Company Number
     C                     Z-ADDYL0047    WL0286           Post to G/L Dat
     C                     Z-ADDYL0047    WL0288           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0289           *Duration (fact
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0287    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0290           Company Number
     C                     Z-ADDYL0047    WL0291           Post to G/L Dat
     C                     Z-ADDYL0047    WL0293           *Date2 (beginni
     C                     Z-ADD-1        WL0294           *Duration (fact
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0292    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDYL0047    YL0047           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           YL0015    IFEQ 'C'                        *IF
     C           YL0015    OREQ 'F'
      * added 1/21/2010 C0476
      *
     C                     MOVEL*BLANK    WN0693  1        Production Type
     C                     Z-ADD*ZERO     WN0694 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0695 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0696  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0697 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0698  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0699  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0700  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0701  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0702  52       Production Yiel
     C                     Z-ADD*ZERO     WN0703  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0704 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UDSUBR                     documentation
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0020    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0257           Company Number
     C                     Z-ADDWEHGCD    WL0258           Item Code
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0259    YL0050    P      Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0022    WN0700           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0014    WN0700           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWEJGDT    YL0051           Production Date
      * DOC:  Allocation
     C                     EXSR UESUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0050    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0047           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWEJGDT    YL0051           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEJGDT    YL0047           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFLE YL0051                     *IF
     C           YL0030    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     Z-ADDYL0047    WL0047           Post to G/L Dat
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0052    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0260           Company Number
     C                     Z-ADDWEHGCD    WL0261           Item Code
     C                     Z-ADDYL0047    WL0262           Production Date
     C                     MOVELYL0053    WL0263    P      Production Day
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0263    YL0053    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0052    IFEQ 'Y'                        *IF
     C           YL0053    IFEQ *BLANK                     *IF
     C           YL0053    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0047    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0693           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0052           Company Number
     C                     MOVELWN0693    WL0053    P      Production Type
     C                     Z-ADDYL0047    WL0054           Production Date
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0693           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0047    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0693           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0264           Company Number
     C                     MOVELWN0693    WL0265    P      Production Type
     C                     Z-ADDYL0047    WL0266           Production Date
     C                     Z-ADDWEHGCD    WL0267           Item Code
     C                     MOVELWEAJCD    WL0268    P      Warehouse Code
     C                     Z-ADDWN0695    WL0270           ATS Weight Avai
     C                     Z-ADDWN0696    WL0271           ATS Pieces Avai
     C                     Z-ADDWN0700    WL0272           Chilling Time U
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0269    WN0701           PS Avg Piece Wg
     C                     Z-ADDWL0270    WN0695           ATS Weight Avai
     C                     Z-ADDWL0271    WN0696           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'Y'                        *IF
     C           YL0018    IFGT *ZERO                      *IF
     C           YL0019    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0018    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           WN0696    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0694           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0017    OREQ 'N'
     C           YL0013    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0695    DIV  YL0013    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0694           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0694           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0694    IFLT YL0030                     *IF
     C                     Z-ADDYL0030    WN0694           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0694    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0030    IFGT WN0694                     *IF
     C                     ADD  WN0694    YL0028           Quantity Schedu
     C           WN0694    MULT YL0013    WN0695           ATS Weight Avai
     C                     ADD  WN0695    YL0029           Weight Schedule
     C                     Z-ADDWN0695    WN0698           Weight Allocate
     C                     Z-ADDWN0694    WN0697           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0030    IFLE WN0694                     *IF
     C                     ADD  YL0030    YL0028           Quantity Schedu
     C           YL0030    MULT YL0013    YL0031           ATS Weight Need
     C                     ADD  YL0031    YL0029           Weight Schedule
     C                     Z-ADDYL0031    WN0698           Weight Allocate
     C                     Z-ADDYL0030    WN0697           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0697    IFGT *ZERO                      *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0697    MULT YL0018    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0019    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0699           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0699    MULT WN0701    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0698           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFEQ WEAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0273           Company Number
     C                     Z-ADDWEC4NB    WL0274           Order Number
     C                     Z-ADDWEDPNB    WL0275           Order Sequence
     C                     Z-ADDWEUENB    WL0276           Order Secondary
     C                     Z-ADDYL0047    WL0277           OD Production D
     C                     Z-ADDWEAODT    WL0278           Scheduled Ship
     C                     MOVELWEAJCD    WL0279    P      Warehouse Code
     C                     MOVELWEAJCD    WL0280    P      Order From Ware
     C                     Z-ADDWEHGCD    WL0281           Item Code
     C                     Z-ADDWN0698    WL0282           Weight Allocate
     C                     Z-ADDWN0697    WL0283           Quantity Alloca
     C                     MOVELYL0015    WL0284    P      Base/Conv/Loss
     C                     EXSR TVRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFNE WEAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0015    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0220           Company Number
     C                     MOVELWN0693    WL0221    P      Production Type
     C                     Z-ADDYL0047    WL0222           Production Date
     C                     Z-ADDWEHGCD    WL0223           Item Code
     C                     MOVELWEAJCD    WL0224    P      Warehouse Code
     C                     Z-ADDWN0698    WL0225           Weight Allocate
     C                     Z-ADDWN0699    WL0226           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0227           Order Number
     C                     Z-ADDWEDPNB    WL0228           Order Sequence
     C                     Z-ADDWEUENB    WL0229           Order Secondary
     C                     MOVEL'N'       WL0230    P      Status Flag 19
     C                     EXSR TERVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0213           Company Number
     C                     MOVELWN0693    WL0214    P      Production Type
     C                     Z-ADDYL0047    WL0215           Production Date
     C                     Z-ADDWEHGCD    WL0216           Item Code
     C                     MOVELWEAJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWN0699    WL0218           Pieces Schedule
     C                     Z-ADDWN0698    WL0219           Weight Schedule
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0071           Company Number
     C                     MOVELWN0693    WL0072    P      Production Type
     C                     Z-ADDYL0047    WL0073           Production Date
     C                     Z-ADDWEHGCD    WL0074           Item Code
     C                     MOVELWEAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWN0698    WL0076           Weight Allocate
     C                     Z-ADDWN0699    WL0077           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0078           Order Number
     C                     Z-ADDWEDPNB    WL0079           Order Sequence
     C                     Z-ADDWEUENB    WL0080           Order Secondary
     C                     MOVEL'N'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0697           Quantity Alloca
     C                     Z-ADD*ZERO     WN0698           Weight Allocate
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0028           Quantity Schedu
     C                     ADD  *ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT *ZERO                      *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0285           Company Number
     C                     Z-ADDYL0047    WL0286           Post to G/L Dat
     C                     Z-ADDYL0047    WL0288           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0289           *Duration (fact
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0287    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0290           Company Number
     C                     Z-ADDYL0047    WL0291           Post to G/L Dat
     C                     Z-ADDYL0047    WL0293           *Date2 (beginni
     C                     Z-ADD1         WL0294           *Duration (fact
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0292    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ *ZERO                      *IF
     C                     Z-ADDYL0047    YL0047           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0050    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWEJGDT    YL0056           Production Date
     C                     Z-ADDWEJGDT    YL0047           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0056           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWEJGDT    YL0051           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEJGDT    YL0047           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFGE YL0056                     *IF
     C           YL0030    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     Z-ADDYL0047    WL0047           Post to G/L Dat
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0052    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0260           Company Number
     C                     Z-ADDWEHGCD    WL0261           Item Code
     C                     Z-ADDYL0047    WL0262           Production Date
     C                     MOVELYL0053    WL0263    P      Production Day
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0263    YL0053    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0052    IFEQ 'Y'                        *IF
     C           YL0053    IFEQ *BLANK                     *IF
     C           YL0053    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0047    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0693           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0052           Company Number
     C                     MOVELWN0693    WL0053    P      Production Type
     C                     Z-ADDYL0047    WL0054           Production Date
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0693           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0047    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0693           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0264           Company Number
     C                     MOVELWN0693    WL0265    P      Production Type
     C                     Z-ADDYL0047    WL0266           Production Date
     C                     Z-ADDWEHGCD    WL0267           Item Code
     C                     MOVELWEAJCD    WL0268    P      Warehouse Code
     C                     Z-ADDWN0695    WL0270           ATS Weight Avai
     C                     Z-ADDWN0696    WL0271           ATS Pieces Avai
     C                     Z-ADDWN0700    WL0272           Chilling Time U
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0269    WN0701           PS Avg Piece Wg
     C                     Z-ADDWL0270    WN0695           ATS Weight Avai
     C                     Z-ADDWL0271    WN0696           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'Y'                        *IF
     C           YL0018    IFGT *ZERO                      *IF
     C           YL0019    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0018    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           WN0696    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0694           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0017    OREQ 'N'
     C           YL0013    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0695    DIV  YL0013    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0694           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0694           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0694    IFLT YL0030                     *IF
     C                     Z-ADDYL0030    WN0694           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0694    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0030    IFGT WN0694                     *IF
     C                     ADD  WN0694    YL0028           Quantity Schedu
     C           WN0694    MULT YL0013    WN0695           ATS Weight Avai
     C                     ADD  WN0695    YL0029           Weight Schedule
     C                     Z-ADDWN0695    WN0698           Weight Allocate
     C                     Z-ADDWN0694    WN0697           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0030    IFLE WN0694                     *IF
     C                     ADD  YL0030    YL0028           Quantity Schedu
     C           YL0030    MULT YL0013    YL0031           ATS Weight Need
     C                     ADD  YL0031    YL0029           Weight Schedule
     C                     Z-ADDYL0031    WN0698           Weight Allocate
     C                     Z-ADDYL0030    WN0697           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0697    IFGT *ZERO                      *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0697    MULT YL0018    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0019    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0699           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0699    MULT WN0701    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0698           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFEQ WEAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0273           Company Number
     C                     Z-ADDWEC4NB    WL0274           Order Number
     C                     Z-ADDWEDPNB    WL0275           Order Sequence
     C                     Z-ADDWEUENB    WL0276           Order Secondary
     C                     Z-ADDYL0047    WL0277           OD Production D
     C                     Z-ADDWEAODT    WL0278           Scheduled Ship
     C                     MOVELWEAJCD    WL0279    P      Warehouse Code
     C                     MOVELWEAJCD    WL0280    P      Order From Ware
     C                     Z-ADDWEHGCD    WL0281           Item Code
     C                     Z-ADDWN0698    WL0282           Weight Allocate
     C                     Z-ADDWN0697    WL0283           Quantity Alloca
     C                     MOVELYL0015    WL0284    P      Base/Conv/Loss
     C                     EXSR TVRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFNE WEAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0015    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0220           Company Number
     C                     MOVELWN0693    WL0221    P      Production Type
     C                     Z-ADDYL0047    WL0222           Production Date
     C                     Z-ADDWEHGCD    WL0223           Item Code
     C                     MOVELWEAJCD    WL0224    P      Warehouse Code
     C                     Z-ADDWN0698    WL0225           Weight Allocate
     C                     Z-ADDWN0699    WL0226           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0227           Order Number
     C                     Z-ADDWEDPNB    WL0228           Order Sequence
     C                     Z-ADDWEUENB    WL0229           Order Secondary
     C                     MOVEL'N'       WL0230    P      Status Flag 19
     C                     EXSR TERVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0213           Company Number
     C                     MOVELWN0693    WL0214    P      Production Type
     C                     Z-ADDYL0047    WL0215           Production Date
     C                     Z-ADDWEHGCD    WL0216           Item Code
     C                     MOVELWEAJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWN0699    WL0218           Pieces Schedule
     C                     Z-ADDWN0698    WL0219           Weight Schedule
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0071           Company Number
     C                     MOVELWN0693    WL0072    P      Production Type
     C                     Z-ADDYL0047    WL0073           Production Date
     C                     Z-ADDWEHGCD    WL0074           Item Code
     C                     MOVELWEAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWN0698    WL0076           Weight Allocate
     C                     Z-ADDWN0699    WL0077           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0078           Order Number
     C                     Z-ADDWEDPNB    WL0079           Order Sequence
     C                     Z-ADDWEUENB    WL0080           Order Secondary
     C                     MOVEL'N'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0697           Quantity Alloca
     C                     Z-ADD*ZERO     WN0698           Weight Allocate
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0028           Quantity Schedu
     C                     ADD  *ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0285           Company Number
     C                     Z-ADDYL0047    WL0286           Post to G/L Dat
     C                     Z-ADDYL0047    WL0288           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0289           *Duration (fact
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0287    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0290           Company Number
     C                     Z-ADDYL0047    WL0291           Post to G/L Dat
     C                     Z-ADDYL0047    WL0293           *Date2 (beginni
     C                     Z-ADD-1        WL0294           *Duration (fact
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0292    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDYL0047    YL0047           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0020    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0057           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0022    WN0700           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0014    WN0700           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWEJGDT    YL0051           Production Date
      * DOC:  Allocation
     C                     EXSR UFSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0057    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWEJGDT    YL0056           Production Date
     C                     Z-ADDWEJGDT    YL0047           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0056           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WEJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWEJGDT    YL0051           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEJGDT    YL0047           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFGE YL0056                     *IF
     C           YL0030    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0046           Company Number
     C                     Z-ADDYL0047    WL0047           Post to G/L Dat
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0052    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0260           Company Number
     C                     Z-ADDWEHGCD    WL0261           Item Code
     C                     Z-ADDYL0047    WL0262           Production Date
     C                     MOVELYL0053    WL0263    P      Production Day
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0263    YL0053    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0052    IFEQ 'Y'                        *IF
     C           YL0053    IFEQ *BLANK                     *IF
     C           YL0053    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0047    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0693           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0052           Company Number
     C                     MOVELWN0693    WL0053    P      Production Type
     C                     Z-ADDYL0047    WL0054           Production Date
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0693           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0047    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0693           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0264           Company Number
     C                     MOVELWN0693    WL0265    P      Production Type
     C                     Z-ADDYL0047    WL0266           Production Date
     C                     Z-ADDWEHGCD    WL0267           Item Code
     C                     MOVELWEAJCD    WL0268    P      Warehouse Code
     C                     Z-ADDWN0695    WL0270           ATS Weight Avai
     C                     Z-ADDWN0696    WL0271           ATS Pieces Avai
     C                     Z-ADDWN0700    WL0272           Chilling Time U
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0269    WN0701           PS Avg Piece Wg
     C                     Z-ADDWL0270    WN0695           ATS Weight Avai
     C                     Z-ADDWL0271    WN0696           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'Y'                        *IF
     C           YL0018    IFGT *ZERO                      *IF
     C           YL0019    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0018    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           WN0696    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0694           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0017    OREQ 'N'
     C           YL0013    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0695    DIV  YL0013    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0694           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0694           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0694    IFLT YL0030                     *IF
     C                     Z-ADDYL0030    WN0694           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0694    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0030    IFGT WN0694                     *IF
     C                     ADD  WN0694    YL0028           Quantity Schedu
     C           WN0694    MULT YL0013    WN0695           ATS Weight Avai
     C                     ADD  WN0695    YL0029           Weight Schedule
     C                     Z-ADDWN0695    WN0698           Weight Allocate
     C                     Z-ADDWN0694    WN0697           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0030    IFLE WN0694                     *IF
     C                     ADD  YL0030    YL0028           Quantity Schedu
     C           YL0030    MULT YL0013    YL0031           ATS Weight Need
     C                     ADD  YL0031    YL0029           Weight Schedule
     C                     Z-ADDYL0031    WN0698           Weight Allocate
     C                     Z-ADDYL0030    WN0697           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0697    IFGT *ZERO                      *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0697    MULT YL0018    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0019    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0699           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0699    MULT WN0701    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0698           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFEQ WEAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0273           Company Number
     C                     Z-ADDWEC4NB    WL0274           Order Number
     C                     Z-ADDWEDPNB    WL0275           Order Sequence
     C                     Z-ADDWEUENB    WL0276           Order Secondary
     C                     Z-ADDYL0047    WL0277           OD Production D
     C                     Z-ADDWEAODT    WL0278           Scheduled Ship
     C                     MOVELWEAJCD    WL0279    P      Warehouse Code
     C                     MOVELWEAJCD    WL0280    P      Order From Ware
     C                     Z-ADDWEHGCD    WL0281           Item Code
     C                     Z-ADDWN0698    WL0282           Weight Allocate
     C                     Z-ADDWN0697    WL0283           Quantity Alloca
     C                     MOVELYL0015    WL0284    P      Base/Conv/Loss
     C                     EXSR TVRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WEAJCD    IFNE WEAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0220           Company Number
     C                     MOVELWN0693    WL0221    P      Production Type
     C                     Z-ADDYL0047    WL0222           Production Date
     C                     Z-ADDWEHGCD    WL0223           Item Code
     C                     MOVELWEAJCD    WL0224    P      Warehouse Code
     C                     Z-ADDWN0698    WL0225           Weight Allocate
     C                     Z-ADDWN0699    WL0226           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0227           Order Number
     C                     Z-ADDWEDPNB    WL0228           Order Sequence
     C                     Z-ADDWEUENB    WL0229           Order Secondary
     C                     MOVEL'N'       WL0230    P      Status Flag 19
     C                     EXSR TERVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0213           Company Number
     C                     MOVELWN0693    WL0214    P      Production Type
     C                     Z-ADDYL0047    WL0215           Production Date
     C                     Z-ADDWEHGCD    WL0216           Item Code
     C                     MOVELWEAJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWN0699    WL0218           Pieces Schedule
     C                     Z-ADDWN0698    WL0219           Weight Schedule
     C                     EXSR TCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0071           Company Number
     C                     MOVELWN0693    WL0072    P      Production Type
     C                     Z-ADDYL0047    WL0073           Production Date
     C                     Z-ADDWEHGCD    WL0074           Item Code
     C                     MOVELWEAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWN0698    WL0076           Weight Allocate
     C                     Z-ADDWN0699    WL0077           Pieces Allocate
     C                     Z-ADDWEC4NB    WL0078           Order Number
     C                     Z-ADDWEDPNB    WL0079           Order Sequence
     C                     Z-ADDWEUENB    WL0080           Order Secondary
     C                     MOVEL'N'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0697           Quantity Alloca
     C                     Z-ADD*ZERO     WN0698           Weight Allocate
     C                     Z-ADD*ZERO     YL0028           Quantity Schedu
     C                     Z-ADD*ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0028           Quantity Schedu
     C                     ADD  *ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0285           Company Number
     C                     Z-ADDYL0047    WL0286           Post to G/L Dat
     C                     Z-ADDYL0047    WL0288           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0289           *Duration (fact
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0287    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0290           Company Number
     C                     Z-ADDYL0047    WL0291           Post to G/L Dat
     C                     Z-ADDYL0047    WL0293           *Date2 (beginni
     C                     Z-ADD-1        WL0294           *Duration (fact
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0292    YL0047           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDYL0047    YL0047           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C                     END                             *FI
      * UPD Allocate Std      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDHMXFR'              90  UPD Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAJCD    WQ0046  3        Warehouse Code
     C                     PARM WEAIC3    WQ0047  30       Company Number
     C                     PARM WEHGCD    WQ0048  70       Item Code
     C           YL0047    PARM YL0047    WQ0049  70       Production Date
     C                     PARM YL0012    WQ0050  2        U/M - Primary
     C                     PARM YL0013    WQ0051 112       Unit Weight
     C                     PARM YL0014    WQ0052  52       Fresh Chilling
     C                     PARM YL0017    WQ0053  1        Piece Count Ite
     C                     PARM YL0018    WQ0054  70       Pieces Per Bag
     C                     PARM YL0019    WQ0055  70       Bags Per Unit
     C                     PARM YL0020    WQ0056  2        Warehouse Type
     C                     PARM YL0021    WQ0057  1        Warehouse Std C
     C                     PARM YL0022    WQ0058  52       Warehouse Chill
     C                     PARM WEC4NB    WQ0059  70       Order Number
     C                     PARM WEDPNB    WQ0060  30       Order Sequence
     C                     PARM WEUENB    WQ0061  30       Order Secondary
     C                     PARM WEJGDT    WQ0062  70       Production Date
     C                     PARM WEJGDT    WQ0063  70       Production Date
     C                     PARM YL0026    WQ0064 112       Quantity Ordere
     C                     PARM YL0027    WQ0065 112       Weight Ordered
     C           YL0028    PARM YL0028    WQ0066 112       Quantity Schedu
     C           YL0029    PARM YL0029    WQ0067 112       Weight Schedule
     C           YL0030    PARM YL0030    WQ0068 112       ATS Quantity Ne
     C           YL0031    PARM YL0031    WQ0069 112       ATS Weight Need
     C                     PARM WEAODT    WQ0070  70       Ship Date USR
     C                     PARM 'AO'      WQ0071  2        ATS Adj Type US
     C                     PARM @CN,002   WQ0072 10        PSAA Program Na
     C                     PARM WEAYAA    WQ0073  3        Order From Ware
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0028    WN0003           Quantity Schedu
     C                     ADD  YL0029    WN0004           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Del OrdDtl Sch-Cons-O2RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSF03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSF04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQSF05           OD Production D
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WQSF03           Order Sequence
     C                     KFLD           WQSF04           Order Secondary
     C                     KFLD           WQSF05           OD Production D
      * Setup key
     C                     Z-ADDWDAIC3    WQSF01           Company Number
     C                     Z-ADDWDC4NB    WQSF02           Order Number
     C                     Z-ADDWDDPNB    WQSF03           Order Sequence
     C                     Z-ADDWDUENB    WQSF04           Order Secondary
     C                     Z-ADD##JDT     WQSF05           OD Production D
      * Establish starting position
     C           KRSSF     SETLL@B6CPNB                    *
     C           KRSSF     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0035           Company Number
     C                     Z-ADDWFC4NB    WL0036           Order Number
     C                     Z-ADDWFDPNB    WL0037           Order Sequence
     C                     Z-ADDWFUENB    WL0038           Order Secondary
     C                     Z-ADDWFJGDT    WL0039           OD Production D
     C                     Z-ADDWFOONY    WL0040           ODS Sequence Nu
     C                     EXSR SGDLRC
     C           KRSSF     READE@B6CPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWL0035    WGAIC3           Company Number
     C                     Z-ADDWL0036    WGC4NB           Order Number
     C                     Z-ADDWL0037    WGDPNB           Order Sequence
     C                     Z-ADDWL0038    WGUENB           Order Secondary
     C                     Z-ADDWL0039    WGJGDT           OD Production D
     C                     Z-ADDWL0040    WGOONY           ODS Sequence Nu
      *
     C           KLDLSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLDLSG    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Del Ord Dtl Sch-InvO2 RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
      * Setup key
     C                     Z-ADDWDAIC3    WHAIC3           Company Number
     C                     Z-ADDWDC4NB    WHC4NB           Order Number
     C                     Z-ADDWDDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWDUENB    WHUENB           Order Secondary
     C                     Z-ADD##JDT     WHJGDT           OD Production D
      * Establish starting position
     C           KRSSH     CHAIN@B5CPM2              90    *
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0041           Company Number
     C                     Z-ADDWHC4NB    WL0042           Order Number
     C                     Z-ADDWHDPNB    WL0043           Order Sequence
     C                     Z-ADDWHUENB    WL0044           Order Secondary
     C                     Z-ADDWHJGDT    WL0045           OD Production D
     C                     EXSR SIDLRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWL0041    WIAIC3           Company Number
     C                     Z-ADDWL0042    WIC4NB           Order Number
     C                     Z-ADDWL0043    WIDPNB           Order Sequence
     C                     Z-ADDWL0044    WIUENB           Order Secondary
     C                     Z-ADDWL0045    WIJGDT           OD Production D
      *
     C           KLDLSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
     C           KLDLSI    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0046    WJAIC3           Company Number
     C                     Z-ADDWL0047    WJBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSJ     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0048           Production Day
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJWAST    WL0048           Production Day
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Requested Dlvry dt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WKAIC3           Company Number
     C                     Z-ADDWEC4NB    WKC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKEIDT    YL0024           Requested Deliv
     C                     Z-ADDWKAFTM    YL0025           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Deallocate PRD    RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       OD Production D
     C                     Z-ADD*ZERO     WN0006 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0007 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0008  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0009  1        Production Type
     C                     Z-ADD*ZERO     WN0010  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0011  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0012  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0015  52       Production Yiel
     C                     Z-ADD*ZERO     WN0016 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0017  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0018  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0019  92       PS Weight Produ
     C                     MOVEL*BLANK    WN0020  2        Warehouse Type
     C                     MOVEL*BLANK    WN0021  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0022  52       Warehouse Chill
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * C01643 8/02/11 RMC use db1.od avg piece wght instead of pdi8cpp w
      *  its being upd per order on its order dtl schedule rcd
      * The value coming in is Negative, need to make it positive.
     C           -1        MULT YL0030    WUHWQT           ATS Quantity Ne
      * FP1054 new
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0032    WL0049    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0034    P      Production Ware
     C                     Z-ADDWL0051    YL0035           Accounting Comp
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WLC4NB    WQSL02           Order Number
     C           *LIKE     DEFN WLDPNB    WQSL03           Order Sequence
     C           *LIKE     DEFN WLUENB    WQSL04           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WQSL03           Order Sequence
     C                     KFLD           WQSL04           Order Secondary
      * Setup key
     C                     Z-ADDWDAIC3    WQSL01           Company Number
     C                     Z-ADDWDC4NB    WQSL02           Order Number
     C                     Z-ADDWDDPNB    WQSL03           Order Sequence
     C                     Z-ADDWDUENB    WQSL04           Order Secondary
      * Establish starting position
     C           KRSSL     SETLL@KNCPM6                    *
     C           KRSSL     READE@KNCPM6                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: PAR.Production Date USR is Entered
     C           WEJGDT    IFNE *ZERO                      *IF
      * CASE: DB1.OD Production Date NE PAR.Production Date USR
     C           WLJGDT    IFNE WEJGDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     Z-ADDWLJGDT    WN0005           OD Production D
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
     C                     EXSR SNRVGN
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           WN0021    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0022    WN0008           Fresh Chilling
     C                     END                             *FI
      * CASE: WRK.ATS Quantity Need USR is Equal to zero
     C           WUHWQT    IFEQ *ZERO                      *IF
     C                     GOTO SLEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Deallocate Production
      * CASE: DB1.OD Quantity Scheduled is Greater than zero
     C           WLIGQT    IFGT *ZERO                      *IF
      * Determine Production Type
      * CASE: DB1.OD Production Date EQ JOB.*Job date
     C           WLJGDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0009           Production Type
     C                     Z-ADD##JDT     WN0005           OD Production D
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0052           Company Number
     C                     MOVELWN0009    WL0053    P      Production Type
     C                     Z-ADDWN0005    WL0054           Production Date
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0009           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.OD Production Date GT JOB.*Job date
     C           WLJGDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0009           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * De-allocate
      * CASE: DB1.OD Production Date LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
      * DLT Ord Detail Sched   DL - PD Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0056           Company Number
     C                     Z-ADDWLC4NB    WL0057           Order Number
     C                     Z-ADDWLDPNB    WL0058           Order Sequence
     C                     Z-ADDWLUENB    WL0059           Order Secondary
     C                     Z-ADDWLJGDT    WL0060           OD Production D
     C                     EXSR SPDLRC
      * Rtv AvgPcWgt/Prd/PrdAl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0061           Company Number
     C                     MOVELWN0009    WL0062    P      Production Type
     C                     Z-ADDWN0005    WL0063           Production Date
     C                     Z-ADDWLHGCD    WL0064           Item Code
     C                     MOVELWLAJCD    WL0065    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0066    WN0010           PS Weight Plann
     C                     Z-ADDWL0067    WN0011           PS Pieces Plann
     C                     Z-ADDWL0068    WN0012           PS Avg Piece Wg
     C                     Z-ADDWL0069    WN0013           PS Weight Prod
     C                     Z-ADDWL0070    WN0014           PS Pieces Prod
      * Pieces & Weight Deallocated.
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * WRK.Pieces Allocated USR =
      *    *COMPUTE ((x1 * x2 * x3) * x4)
      * x1    : DB1.OD Qty/Cnsmd Pieces Sched
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,0) work field *
      * x4    : CON.-1
     C           WLIGQT    MULT YL0018    W0WJ02    H      *Synon (15,0) w
     C           W0WJ02    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT -1        W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUPCAL           Pieces Allocate
      * C01643 8/5/11 use od sched wgt on order dtl sched
     C           -1        MULT WLFLWG    WUEOWG           ATS Weight Avai
     C                     ELSE
      * CASE: *OTHERWISE
      * ATS Weight Available USR
      * WRK.ATS Weight Available USR =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : DB1.OD Qty/Cnsmd Pieces Sched
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Unit Weight
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.-1
     C           WLIGQT    MULT YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     WUPCAL           Pieces Allocate
     C                     END                             *FI
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0071           Company Number
     C                     MOVEL'S'       WL0072    P      Production Type
     C                     Z-ADD##JDT     WL0073           Production Date
     C                     Z-ADDWLHGCD    WL0074           Item Code
     C                     MOVELWLAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWUEOWG    WL0076           Weight Allocate
     C                     Z-ADDWUPCAL    WL0077           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0078           Order Number
     C                     Z-ADDWLDPNB    WL0079           Order Sequence
     C                     Z-ADDWLUENB    WL0080           Order Secondary
     C                     MOVEL'Y'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
     C                     SUB  WLIGQT    WUHWQT           ATS Quantity Ne
     C                     SUB  WLIGQT    YL0028           Quantity Schedu
     C           YL0028    MULT YL0013    YL0029    H      Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv AvgPcWgt/Prd/PrdAl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0061           Company Number
     C                     MOVELWN0009    WL0062    P      Production Type
     C                     Z-ADDWN0005    WL0063           Production Date
     C                     Z-ADDWLHGCD    WL0064           Item Code
     C                     MOVELWLAJCD    WL0065    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0066    WN0010           PS Weight Plann
     C                     Z-ADDWL0067    WN0011           PS Pieces Plann
     C                     Z-ADDWL0068    WN0012           PS Avg Piece Wg
     C                     Z-ADDWL0069    WN0013           PS Weight Prod
     C                     Z-ADDWL0070    WN0014           PS Pieces Prod
      * Update Production Schedule
      * CASE: DB1.OD Quantity Scheduled GT WRK.ATS Quantity Need USR
     C           WLIGQT    IFGT WUHWQT                     *IF
     C           WLIGQT    SUB  WUHWQT    WN0006           OD Qty/Cnsmd Pi
      * Calc Weight to deallocate from order detail schedule
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * WRK.Pieces Allocated USR =
      *    *COMPUTE ((x1 * x2 * x3) * x4)
      * x1    : WRK.ATS Quantity Need USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,0) work field *
      * x4    : CON.-1
     C           WUHWQT    MULT YL0018    W0WJ02    H      *Synon (15,0) w
     C           W0WJ02    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT -1        W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUPCAL           Pieces Allocate
      * C01643 8/5/11 use od weight sched on order dtl sched
     C           WLFLWG    MULT -1        WUEOWG           ATS Weight Avai
     C           WN0006    MULT YL0013    WN0007           OD Weight Sched
     C                     ELSE
      * CASE: *OTHERWISE
      * ATS Weight Available USR
      * WRK.ATS Weight Available USR =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : WRK.ATS Quantity Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Unit Weight
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.-1
     C           WUHWQT    MULT YL0013    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     WUPCAL           Pieces Allocate
     C           WN0006    MULT YL0013    WN0007           OD Weight Sched
     C                     END                             *FI
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0199           Company Number
     C                     Z-ADDWLC4NB    WL0200           Order Number
     C                     Z-ADDWLDPNB    WL0201           Order Sequence
     C                     Z-ADDWLUENB    WL0202           Order Secondary
     C                     Z-ADDWLJGDT    WL0203           OD Production D
     C                     Z-ADDWN0006    WL0204           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0007    WL0205           OD Weight Sched
     C                     Z-ADDWLIUQT    WL0206           OD Quantity Inv
     C                     Z-ADDWLF3WG    WL0207           OD Weight Inv S
     C                     MOVELWLP7ST    WL0208    P      OD Added to Sch
     C                     EXSR TACHRC
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0071           Company Number
     C                     MOVELWN0009    WL0072    P      Production Type
     C                     Z-ADDWN0005    WL0073           Production Date
     C                     Z-ADDWLHGCD    WL0074           Item Code
     C                     MOVELWLAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWUEOWG    WL0076           Weight Allocate
     C                     Z-ADDWUPCAL    WL0077           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0078           Order Number
     C                     Z-ADDWLDPNB    WL0079           Order Sequence
     C                     Z-ADDWLUENB    WL0080           Order Secondary
     C                     MOVEL'Y'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
      * Production Date > or = Job Date, Add back BASE
      * CASE: DB1.OD Production Date GE JOB.*Job date
     C           WLJGDT    IFGE ##JDT                      *IF
      * If converted item add scheduled quantity back to base item
      * CASE: PAR.Base/Conv/Loss Item is Converted
     C           YL0015    IFEQ 'C'                        *IF
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0209           Company Number
     C                     Z-ADDYL0033    WL0210           Item Code
     C                     Z-ADDWN0015    WL0211           Production Yiel
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0211    WN0015           Production Yiel
     C                     MOVELWL0212    WUWXST    P      Record Found US
      * Add back to the base item and remove from credit items.
      * CASE: PAR.Production Yield is Greater than zero
     C           WN0015    IFGT *ZERO                      *IF
      * If piece count Item, find production avail in pieces else weight
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
     C                     Z-ADDWUPCAL    WN0018           PS Pieces Produ
      * This should be pieces * avg weight of consumed item if consuming
      * only one base item.
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0019           PS Weight Produ
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0019           PS Weight Produ
     C                     Z-ADD*ZERO     WN0018           PS Pieces Produ
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Pieces Production Need is NE Zeros
      *   |- c2    : PAR.PS Weight Production Need is NE Zero
      *   '-
     C           WN0018    IFNE *ZERO                      *IF
     C           WN0019    ORNE *ZERO                      *OR
      * Upd Allocate Std      XF - Item Bill Of Material  * 
     C                     CLEARPARC
     C                     Z-ADDWDAIC3    PAAIC3           Company Number
     C                     Z-ADDYL0033    PAHGCD           Item Code
      *
     C                     CALL 'PDHNXFR'              90  Upd Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Item Bill
     C                     PARM YL0032    WQ0001  3        Warehouse Code
     C                     PARM WN0005    WQ0002  70       Production Date
     C                     PARM WN0009    WQ0003  1        Production Type
     C                     PARM YL0012    WQ0004  2        U/M - Primary
     C                     PARM YL0013    WQ0005 112       Unit Weight
     C                     PARM WN0008    WQ0006  52       Fresh Chilling
     C                     PARM YL0017    WQ0007  1        Piece Count Ite
     C                     PARM YL0018    WQ0008  70       Pieces Per Bag
     C                     PARM YL0019    WQ0009  70       Bags Per Unit
     C                     PARM WN0020    WQ0010  2        Warehouse Type
     C                     PARM WN0021    WQ0011  1        Warehouse Std C
     C                     PARM WN0022    WQ0012  52       Warehouse Chill
     C                     PARM WLC4NB    WQ0013  70       Order Number
     C                     PARM WLDPNB    WQ0014  30       Order Sequence
     C                     PARM WLUENB    WQ0015  30       Order Secondary
     C                     PARM 'OD'      WQ0016  2        ATS Adj Type US
     C           WN0019    PARM WN0019    WQ0017 112       SM Weight Need
     C           WN0018    PARM WN0018    WQ0018  70       SM Pieces Need
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  WUHWQT    YL0028           Quantity Schedu
     C           YL0028    MULT YL0013    YL0029    H      Weight Schedule
      * FP1054 save this for prod whse update outside of this CASE
     C                     Z-ADDWUEOWG    WUF1WG           Weight Dealloca
     C                     Z-ADD*ZERO     WUHWQT           ATS Quantity Ne
     C                     ELSE
      * CASE: *OTHERWISE
      * Calc Weight to deallocate from order detail schedule
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * WRK.Pieces Allocated USR =
      *    *COMPUTE ((x1 * x2 * x3) * x4)
      * x1    : DB1.OD Qty/Cnsmd Pieces Sched
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,0) work field *
      * x4    : CON.-1
     C           WLIGQT    MULT YL0018    W0WJ02           *Synon (15,0) w
     C           W0WJ02    MULT YL0019    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT -1        W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUPCAL           Pieces Allocate
      * C01643 use db1 weight sched
     C           WLFLWG    MULT -1        WUEOWG           ATS Weight Avai
     C                     ELSE
      * CASE: *OTHERWISE
      * ATS Weight Available USR
      * WRK.ATS Weight Available USR =
      *    *COMPUTE (x1 * x3)
      * x1    : DB1.OD Weight Scheduled
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.-1
     C           WLFLWG    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     WUPCAL           Pieces Allocate
     C                     END                             *FI
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0071           Company Number
     C                     MOVELWN0009    WL0072    P      Production Type
     C                     Z-ADDWN0005    WL0073           Production Date
     C                     Z-ADDWLHGCD    WL0074           Item Code
     C                     MOVELWLAJCD    WL0075    P      Warehouse Code
     C                     Z-ADDWUEOWG    WL0076           Weight Allocate
     C                     Z-ADDWUPCAL    WL0077           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0078           Order Number
     C                     Z-ADDWLDPNB    WL0079           Order Sequence
     C                     Z-ADDWLUENB    WL0080           Order Secondary
     C                     MOVEL'Y'       WL0081    P      Status Flag 19
     C                     EXSR SRRVGN
      * Production Date > or = Job Date, Add back Base
      * CASE: DB1.OD Production Date GE JOB.*Job date
     C           WLJGDT    IFGE ##JDT                      *IF
      * If converted item add scheduled quantity back to base item
      * CASE: PAR.Base/Conv/Loss Item is Converted
     C           YL0015    IFEQ 'C'                        *IF
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0209           Company Number
     C                     Z-ADDYL0033    WL0210           Item Code
     C                     Z-ADDWN0015    WL0211           Production Yiel
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0211    WN0015           Production Yiel
     C                     MOVELWL0212    WUWXST    P      Record Found US
      * Add back to the base item and remove from credit items.
      * CASE: PAR.Production Yield is Greater than zero
     C           WN0015    IFGT *ZERO                      *IF
      * If piece count Item, find production avail in pieces else weight
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
     C                     Z-ADDWUPCAL    WN0018           PS Pieces Produ
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ( x1 / (x2 / x3))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0019           PS Weight Produ
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ( x1 / (x2 / x3))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0019           PS Weight Produ
     C                     Z-ADD*ZERO     WN0018           PS Pieces Produ
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Pieces Production Need is NE Zeros
      *   |- c2    : PAR.PS Weight Production Need is NE Zero
      *   '-
     C           WN0018    IFNE *ZERO                      *IF
     C           WN0019    ORNE *ZERO                      *OR
      * Upd Allocate Std      XF - Item Bill Of Material  * 
     C                     CLEARPARC
     C                     Z-ADDWDAIC3    PAAIC3           Company Number
     C                     Z-ADDYL0033    PAHGCD           Item Code
      *
     C                     CALL 'PDHNXFR'              90  Upd Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Item Bill
     C                     PARM YL0032    WQ0019  3        Warehouse Code
     C                     PARM WN0005    WQ0020  70       Production Date
     C                     PARM WN0009    WQ0021  1        Production Type
     C                     PARM YL0012    WQ0022  2        U/M - Primary
     C                     PARM YL0013    WQ0023 112       Unit Weight
     C                     PARM WN0008    WQ0024  52       Fresh Chilling
     C                     PARM YL0017    WQ0025  1        Piece Count Ite
     C                     PARM YL0018    WQ0026  70       Pieces Per Bag
     C                     PARM YL0019    WQ0027  70       Bags Per Unit
     C                     PARM WN0020    WQ0028  2        Warehouse Type
     C                     PARM WN0021    WQ0029  1        Warehouse Std C
     C                     PARM WN0022    WQ0030  52       Warehouse Chill
     C                     PARM WLC4NB    WQ0031  70       Order Number
     C                     PARM WLDPNB    WQ0032  30       Order Sequence
     C                     PARM WLUENB    WQ0033  30       Order Secondary
     C                     PARM 'OD'      WQ0034  2        ATS Adj Type US
     C           WN0019    PARM WN0019    WQ0035 112       SM Weight Need
     C           WN0018    PARM WN0018    WQ0036  70       SM Pieces Need
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  WLIGQT    WUHWQT           ATS Quantity Ne
      * CASE: DB1.OD Quantity Inv Sched is Equal to zero
     C           WLIUQT    IFEQ *ZERO                      *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0056           Company Number
     C                     Z-ADDWLC4NB    WL0057           Order Number
     C                     Z-ADDWLDPNB    WL0058           Order Sequence
     C                     Z-ADDWLUENB    WL0059           Order Secondary
     C                     Z-ADDWLJGDT    WL0060           OD Production D
     C                     EXSR SPDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0199           Company Number
     C                     Z-ADDWLC4NB    WL0200           Order Number
     C                     Z-ADDWLDPNB    WL0201           Order Sequence
     C                     Z-ADDWLUENB    WL0202           Order Secondary
     C                     Z-ADDWLJGDT    WL0203           OD Production D
     C                     Z-ADD*ZERO     WL0204           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WL0205           OD Weight Sched
     C                     Z-ADDWLIUQT    WL0206           OD Quantity Inv
     C                     Z-ADDWLF3WG    WL0207           OD Weight Inv S
     C                     MOVELWLP7ST    WL0208    P      OD Added to Sch
     C                     EXSR TACHRC
     C                     END                             *FI
     C                     SUB  WLIGQT    YL0028           Quantity Schedu
     C           YL0028    MULT YL0013    YL0029           Weight Schedule
      * FP1054 save this for prod whse update outside of this CASE
     C                     Z-ADDWUEOWG    WUF1WG           Weight Dealloca
     C                     END                             *FI
      * FP1054 New
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0015    IFEQ 'B'                        *IF
      * FP1054  Reduce order's warehouse standard prod too & prod whse tx
      * CASE: PAR.Warehouse Code NE LCL.Production Warehouse Code
     C           YL0032    IFNE YL0034                     *IF
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0213           Company Number
     C                     MOVELWN0009    WL0214    P      Production Type
     C                     Z-ADDWLJGDT    WL0215           Production Date
     C                     Z-ADDYL0033    WL0216           Item Code
     C                     MOVELWLAJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWUPCAL    WL0218           Pieces Schedule
     C                     Z-ADDWUF1WG    WL0219           Weight Schedule
     C                     EXSR TCRVGN
      * Move prod that was alloc to order's warehouse back to prod whse's
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0220           Company Number
     C                     MOVELWN0009    WL0221    P      Production Type
     C                     Z-ADDWLJGDT    WL0222           Production Date
     C                     Z-ADDYL0033    WL0223           Item Code
     C                     MOVELYL0034    WL0224    P      Warehouse Code
     C                     Z-ADDWUF1WG    WL0225           Weight Allocate
     C                     Z-ADDWUPCAL    WL0226           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0227           Order Number
     C                     Z-ADDWLDPNB    WL0228           Order Sequence
     C                     Z-ADDWLUENB    WL0229           Order Secondary
     C                     MOVEL'Y'       WL0230    P      Status Flag 19
     C                     EXSR TERVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           KRSSL     READE@KNCPM6                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WMAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0049    WMAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0050           Production Ware
     C                     Z-ADD*ZERO     WL0051           Accounting Comp
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMAOCD    WL0050           Production Ware
     C                     Z-ADDWMBTC3    WL0051           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWLAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0020           Warehouse Type
     C                     MOVEL*BLANK    WN0021           Warehouse Std C
     C                     Z-ADD*ZERO     WN0022           Warehouse Chill
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WN0020           Warehouse Type
     C                     MOVELWCT1ST    WN0021           Warehouse Std C
     C                     Z-ADDWCDBNB    WN0022           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOV5ST           Production Type
     C                     KFLD           WOELDT           Production Date
      * Setup key
     C                     Z-ADDWL0052    WOAIC3           Company Number
     C                     MOVELWL0053    WOV5ST           Production Type
     C                     Z-ADDWL0054    WOELDT           Production Date
      * Establish starting position
     C           KRSSO     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0055           Record Found US
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0055           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - PD Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0056    WRAIC3           Company Number
     C                     Z-ADDWL0057    WRC4NB           Order Number
     C                     Z-ADDWL0058    WRDPNB           Order Sequence
     C                     Z-ADDWL0059    WRUENB           Order Secondary
     C                     Z-ADDWL0060    WRJGDT           OD Production D
      *
     C           KLDLSP    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C                     KFLD           WRJGDT           OD Production D
     C           KLDLSP    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv AvgPcWgt/Prd/PrdAl RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0061    WSAIC3           Company Number
     C                     MOVELWL0062    WSV5ST           Production Type
     C                     Z-ADDWL0063    WSELDT           Production Date
     C                     Z-ADDWL0064    WSHGCD           Item Code
     C                     MOVELWL0065    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0066           PS Weight Plann
     C                     Z-ADD*ZERO     WL0067           PS Pieces Plann
     C                     Z-ADD*ZERO     WL0068           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WL0069           PS Weight Prod
     C                     Z-ADD*ZERO     WL0070           PS Pieces Prod
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSWTSP    WL0066           PS Weight Plann
     C                     Z-ADDWSQTSP    WL0067           PS Pieces Plann
     C                     Z-ADDWSF8WG    WL0068           PS Avg Piece Wg
     C                     Z-ADDWSOAWT    WL0069           PS Weight Prod
     C                     Z-ADDWSCDNB    WL0070           PS Pieces Prod
      * Total Production Weight
      * PAR.PS Weight Planned Prod =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (17,7) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           WSDXWG    ADD  WSD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WSWTCN    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WSGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0066           PS Weight Plann
      * Total Production Pieces
      * PAR.PS Pieces Planned Prod =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (17,7) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           WSB2NB    ADD  WSCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WSPSCV    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WSBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0067           PS Pieces Plann
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0023  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0024  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0025  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0026  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0027  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0028  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0029  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0030  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0031  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0032  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0033  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0034  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0035  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0036  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0037  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0038  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0039  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0040  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0041  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0042  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0043  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0044  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0045  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0046 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0047  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0048 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0049  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0050 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0052 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0054 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0055  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0056 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0057  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0058  3        PS Item Id
     C                     MOVEL*BLANK    WN0059  2        Warehouse Type
     C                     MOVEL*BLANK    WN0060  1        PS Lock Status
     C                     MOVEL*BLANK    WN0061  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0062  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0063  1        PS Piece Count
     C                     MOVEL*BLANK    WN0064  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0065  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0066  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0067  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0068  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0069  3        PS Production W
     C                     Z-ADD*ZERO     WN0070  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0071  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0072  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0073  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0074  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0075  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0076  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0077  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0078  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0079  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0080  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0081  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0082  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0083  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0084  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0085  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0086  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0087  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0088  6        Department Code
     C                     Z-ADD*ZERO     WN0089  30       Item Structure
     C                     Z-ADD*ZERO     WN0090  30       Item Structure
     C                     Z-ADD*ZERO     WN0091  30       Item Structure
     C                     MOVEL*BLANK    WN0092  6        Primal Group Co
     C                     MOVEL*BLANK    WN0093  1        EDI Status 1
     C                     MOVEL*BLANK    WN0094  1        EDI Status 2
     C                     MOVEL*BLANK    WN0095  1        EDI Status 3
     C                     MOVEL*BLANK    WN0096  1        Record Status
     C                     Z-ADD*ZERO     WN0097  60       Job Time
     C                     MOVEL*BLANK    WN0098 10        User Id
     C                     MOVEL*BLANK    WN0099 10        Job Name
     C                     Z-ADD*ZERO     WN0100  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0071    WSAIC3           Company Number
     C                     MOVELWL0072    WSV5ST           Production Type
     C                     Z-ADDWL0073    WSELDT           Production Date
     C                     Z-ADDWL0074    WSHGCD           Item Code
     C                     MOVELWL0075    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSSR     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0076    WN0042           PS Weight Prod
     C                     Z-ADDWL0077    WN0043           PS Pieces Prod
      * CASE: PAR.PS Pieces Prod Allocated is GT Zero
     C           WN0043    IFGT *ZERO                      *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Prod Allocated
     C           WN0042    DIV  WN0043    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0027           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0071    WL0082           Company Number
     C                     MOVELWL0072    WL0083    P      Production Type
     C                     Z-ADDWL0073    WL0084           Production Date
     C                     Z-ADDWL0074    WL0085           Item Code
     C                     MOVELWL0075    WL0086    P      Warehouse Code
     C                     Z-ADDWN0023    WL0087           PS Available Sh
     C                     Z-ADDWN0024    WL0088           PS Weight Plann
     C                     Z-ADDWN0025    WL0089           PS Pieces Plann
     C                     Z-ADDWN0026    WL0090           PS % of Carcass
     C                     Z-ADDWN0027    WL0091           PS Avg Piece Wg
     C                     Z-ADDWN0028    WL0092           PS Weight Inv O
     C                     Z-ADDWN0029    WL0093           PS Pieces Inv O
     C                     Z-ADDWN0030    WL0094           PS Weight Stand
     C                     Z-ADDWN0031    WL0095           PS Pieces Stand
     C                     Z-ADDWN0032    WL0096           PS Weight Conve
     C                     Z-ADDWN0033    WL0097           PS Pieces Conve
     C                     Z-ADDWN0034    WL0098           PS Weight Shipp
     C                     Z-ADDWN0035    WL0099           PS Pieces Shipp
     C                     Z-ADDWN0036    WL0100           PS Weight Prod
     C                     Z-ADDWN0037    WL0101           PS Pieces Prod
     C                     Z-ADDWN0038    WL0102           PS Weight Inv A
     C                     Z-ADDWN0039    WL0103           PS Pieces Inv A
     C                     Z-ADDWN0040    WL0104           PS Weight Ship
     C                     Z-ADDWN0041    WL0105           PS Pieces Ship
     C                     Z-ADDWN0042    WL0106           PS Weight Prod
     C                     Z-ADDWN0043    WL0107           PS Pieces Prod
     C                     Z-ADDWN0044    WL0108           PS Weight Inv A
     C                     Z-ADDWN0045    WL0109           PS Pieces Inv A
     C                     Z-ADDWN0046    WL0110           PS Unit Weight
     C                     Z-ADDWN0047    WL0111           PS Pieces Whse
     C                     Z-ADDWN0048    WL0112           PS Weight Whse
     C                     Z-ADDWN0049    WL0113           PS Pieces Unuse
     C                     Z-ADDWN0050    WL0114           PS Weight Unuse
     C                     Z-ADDWN0051    WL0115           PS Pieces Unuse
     C                     Z-ADDWN0052    WL0116           PS Weight Unuse
     C                     Z-ADDWN0053    WL0117           PS Pieces Unuse
     C                     Z-ADDWN0054    WL0118           PS Weight Unuse
     C                     Z-ADDWN0055    WL0119           PS Pieces Unuse
     C                     Z-ADDWN0056    WL0120           PS Weight Unuse
     C                     Z-ADDWN0057    WL0121           PS Pieces Unuse
     C                     MOVELWN0058    WL0122    P      PS Item Id
     C                     MOVELWN0059    WL0123    P      Warehouse Type
     C                     MOVELWN0060    WL0124    P      PS Lock Status
     C                     MOVELWN0061    WL0125    P      PS Export/Domes
     C                     MOVELWN0062    WL0126    P      PS Print On Sch
     C                     MOVELWN0063    WL0127    P      PS Piece Count
     C                     MOVELWN0064    WL0128    P      PS Unused Sts 1
     C                     MOVELWN0065    WL0129    P      PS Unused Sts 2
     C                     MOVELWN0066    WL0130    P      PS Unused Sts 3
     C                     MOVELWN0067    WL0131    P      PS Unused Sts 4
     C                     MOVELWN0068    WL0132    P      PS Item Sched N
     C                     MOVELWN0069    WL0133    P      PS Production W
     C                     Z-ADDWN0070    WL0134           PS Weight Order
     C                     Z-ADDWN0071    WL0135           PS Pieces Order
     C                     Z-ADDWN0072    WL0136           PS Weight FC Ad
     C                     Z-ADDWN0073    WL0137           PS Pieces FC Ad
     C                     Z-ADDWN0074    WL0138           PS Weight FX Ad
     C                     Z-ADDWN0075    WL0139           PS Pieces FX Ad
     C                     Z-ADDWN0076    WL0140           PS Weight Sched
     C                     Z-ADDWN0077    WL0141           PS Pieces Sched
     C                     Z-ADDWN0078    WL0142           PS Weight Avail
     C                     Z-ADDWN0079    WL0143           PS Pieces Avail
     C                     Z-ADDWN0080    WL0144           PS Weight Produ
     C                     Z-ADDWN0081    WL0145           PS Pieces Produ
     C                     Z-ADDWN0082    WL0146           PS Weight Fab N
     C                     Z-ADDWN0083    WL0147           PS Pieces Fab N
     C                     Z-ADDWN0084    WL0148           PS Weight Sched
     C                     Z-ADDWN0085    WL0149           PS Pieces Sched
     C                     Z-ADDWN0086    WL0150           PS Weight Sched
     C                     Z-ADDWN0087    WL0151           PS Pieces Sched
     C                     MOVELWN0088    WL0152    P      Department Code
     C                     Z-ADDWN0089    WL0153           Item Structure
     C                     Z-ADDWN0090    WL0154           Item Structure
     C                     Z-ADDWN0091    WL0155           Item Structure
     C                     MOVELWN0092    WL0156    P      Primal Group Co
     C                     MOVELWN0093    WL0157    P      EDI Status 1
     C                     MOVELWN0094    WL0158    P      EDI Status 2
     C                     MOVELWN0095    WL0159    P      EDI Status 3
     C                     MOVELWN0096    WL0160    P      Record Status
     C                     Z-ADDWN0097    WL0161           Job Time
     C                     MOVELWN0098    WL0162    P      User Id
     C                     MOVELWN0099    WL0163    P      Job Name
     C                     Z-ADDWN0100    WL0164           Job Date
     C                     EXSR SSCRRC
      * FP1054 create consumed records
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0078    IFGT *ZERO                      *IF
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0071    WL0169           Company Number
     C                     Z-ADDWL0078    WL0170           Order Number
     C                     Z-ADDWL0079    WL0171           Order Sequence
     C                     Z-ADDWL0080    WL0172           Order Secondary
     C                     Z-ADDWL0073    WL0173           OD Production D
     C                     Z-ADDYL0037    WL0174           ODS Sequence Nu
     C                     Z-ADDWL0074    WL0175           Consumed Item C
     C                     Z-ADDWL0074    WL0176           Item Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0174    YL0037           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0037    IFEQ *ZERO                      *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0071    WL0177           Company Number
     C                     Z-ADDWL0078    WL0178           Order Number
     C                     Z-ADDWL0079    WL0179           Order Sequence
     C                     Z-ADDWL0080    WL0180           Order Secondary
     C                     Z-ADDWL0073    WL0181           OD Production D
     C                     Z-ADDYL0037    WL0182           ODS Sequence Nu
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0182    YL0037           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0071    WL0183           Company Number
     C                     Z-ADDWL0078    WL0184           Order Number
     C                     Z-ADDWL0079    WL0185           Order Sequence
     C                     Z-ADDWL0080    WL0186           Order Secondary
     C                     Z-ADDWL0073    WL0187           OD Production D
     C                     Z-ADDYL0037    WL0188           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0189           Scheduled Ship
     C                     MOVELWL0075    WL0190    P      Warehouse Code
     C                     Z-ADDWL0074    WL0191           Consumed Item C
     C                     Z-ADDWL0074    WL0192           Item Code
     C                     Z-ADDWL0077    WL0193           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0076    WL0194           OD Weight Sched
     C                     Z-ADD*ZERO     WL0195           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0196           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0197           Deadline Depart
     C                     Z-ADD*ZERO     WL0198           Deadline Depart
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSOAWT    ADD  WL0076    WN0042           PS Weight Prod
     C           WSCDNB    ADD  WL0077    WN0043           PS Pieces Prod
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
     C                     EXSR SZCHRC
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
      * CASE: PAR.Status Flag 19 Y/N is Yes
     C           WL0081    IFEQ 'Y'                        *IF
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0078    IFGT *ZERO                      *IF
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0071    WL0169           Company Number
     C                     Z-ADDWL0078    WL0170           Order Number
     C                     Z-ADDWL0079    WL0171           Order Sequence
     C                     Z-ADDWL0080    WL0172           Order Secondary
     C                     Z-ADDWL0073    WL0173           OD Production D
     C                     Z-ADDYL0037    WL0174           ODS Sequence Nu
     C                     Z-ADDWL0074    WL0175           Consumed Item C
     C                     Z-ADDWL0074    WL0176           Item Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0174    YL0037           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0037    IFEQ *ZERO                      *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0071    WL0177           Company Number
     C                     Z-ADDWL0078    WL0178           Order Number
     C                     Z-ADDWL0079    WL0179           Order Sequence
     C                     Z-ADDWL0080    WL0180           Order Secondary
     C                     Z-ADDWL0073    WL0181           OD Production D
     C                     Z-ADDYL0037    WL0182           ODS Sequence Nu
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0182    YL0037           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0071    WL0183           Company Number
     C                     Z-ADDWL0078    WL0184           Order Number
     C                     Z-ADDWL0079    WL0185           Order Sequence
     C                     Z-ADDWL0080    WL0186           Order Secondary
     C                     Z-ADDWL0073    WL0187           OD Production D
     C                     Z-ADDYL0037    WL0188           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0189           Scheduled Ship
     C                     MOVELWL0075    WL0190    P      Warehouse Code
     C                     Z-ADDWL0074    WL0191           Consumed Item C
     C                     Z-ADDWL0074    WL0192           Item Code
     C                     Z-ADDWL0077    WL0193           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0076    WL0194           OD Weight Sched
     C                     Z-ADD*ZERO     WL0195           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0196           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0197           Deadline Depart
     C                     Z-ADD*ZERO     WL0198           Deadline Depart
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0082    WTAIC3           Company Number
     C                     MOVELWL0083    WTV5ST           Production Type
     C                     Z-ADDWL0084    WTELDT           Production Date
     C                     Z-ADDWL0085    WTHGCD           Item Code
     C                     MOVELWL0086    WTAJCD           Warehouse Code
     C                     Z-ADDWL0087    WTGPDT           PS Available Sh
     C                     Z-ADDWL0088    WTWTSP           PS Weight Plann
     C                     Z-ADDWL0089    WTQTSP           PS Pieces Plann
     C                     Z-ADDWL0090    WTDJPC           PS % of Carcass
     C                     Z-ADDWL0091    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0092    WTWTIN           PS Weight Inv O
     C                     Z-ADDWL0093    WTD5NB           PS Pieces Inv O
     C                     Z-ADDWL0094    WTDXWG           PS Weight Stand
     C                     Z-ADDWL0095    WTB2NB           PS Pieces Stand
     C                     Z-ADDWL0096    WTWTCN           PS Weight Conve
     C                     Z-ADDWL0097    WTPSCV           PS Pieces Conve
     C                     Z-ADDWL0098    WTSAWT           PS Weight Shipp
     C                     Z-ADDWL0099    WTB9NB           PS Pieces Shipp
     C                     Z-ADDWL0100    WTD1WG           PS Weight Prod
     C                     Z-ADDWL0101    WTCBNB           PS Pieces Prod
     C                     Z-ADDWL0102    WTEZWG           PS Weight Inv A
     C                     Z-ADDWL0103    WTCCNB           PS Pieces Inv A
     C                     Z-ADDWL0104    WTE0WG           PS Weight Ship
     C                     Z-ADDWL0105    WTD6NB           PS Pieces Ship
     C                     Z-ADDWL0106    WTOAWT           PS Weight Prod
     C                     Z-ADDWL0107    WTCDNB           PS Pieces Prod
     C                     Z-ADDWL0108    WTUNW2           PS Weight Inv A
     C                     Z-ADDWL0109    WTCENB           PS Pieces Inv A
     C                     Z-ADDWL0110    WTF9WG           PS Unit Weight
     C                     Z-ADDWL0111    WTBPNB           PS Pieces Whse
     C                     Z-ADDWL0112    WTGAWG           PS Weight Whse
     C                     Z-ADDWL0113    WTBQNB           PS Pieces Unuse
     C                     Z-ADDWL0114    WTGBWG           PS Weight Unuse
     C                     Z-ADDWL0115    WTBRNB           PS Pieces Unuse
     C                     Z-ADDWL0116    WTGCWG           PS Weight Unuse
     C                     Z-ADDWL0117    WTBSNB           PS Pieces Unuse
     C                     Z-ADDWL0118    WTGDWG           PS Weight Unuse
     C                     Z-ADDWL0119    WTBWNB           PS Pieces Unuse
     C                     Z-ADDWL0120    WTGEWG           PS Weight Unuse
     C                     Z-ADDWL0121    WTPS6U           PS Pieces Unuse
     C                     MOVELWL0122    WTWCST           PS Item Id
     C                     MOVELWL0123    WTWPST           Warehouse Type
     C                     MOVELWL0124    WTB5ST           PS Lock Status
     C                     MOVELWL0125    WTTFST           PS Export/Domes
     C                     MOVELWL0126    WTTEST           PS Print On Sch
     C                     MOVELWL0127    WTTHST           PS Piece Count
     C                     MOVELWL0128    WTUDST           PS Unused Sts 1
     C                     MOVELWL0129    WTUFST           PS Unused Sts 2
     C                     MOVELWL0130    WTUGST           PS Unused Sts 3
     C                     MOVELWL0131    WTUHST           PS Unused Sts 4
     C                     MOVELWL0132    WTB6ST           PS Item Sched N
     C                     MOVELWL0133    WTB7ST           PS Production W
     C                     Z-ADDWL0134    WTDVWG           PS Weight Order
     C                     Z-ADDWL0135    WTD7NB           PS Pieces Order
     C                     Z-ADDWL0136    WTFCAD           PS Weight FC Ad
     C                     Z-ADDWL0137    WTD9NB           PS Pieces FC Ad
     C                     Z-ADDWL0138    WTDWWG           PS Weight FX Ad
     C                     Z-ADDWL0139    WTEANB           PS Pieces FX Ad
     C                     Z-ADDWL0140    WTSHWT           PS Weight Sched
     C                     Z-ADDWL0141    WTEBNB           PS Pieces Sched
     C                     Z-ADDWL0142    WTAVWT           PS Weight Avail
     C                     Z-ADDWL0143    WTECNB           PS Pieces Avail
     C                     Z-ADDWL0144    WTWTON           PS Weight Produ
     C                     Z-ADDWL0145    WTEDNB           PS Pieces Produ
     C                     Z-ADDWL0146    WTFNWT           PS Weight Fab N
     C                     Z-ADDWL0147    WTEENB           PS Pieces Fab N
     C                     Z-ADDWL0148    WTQTAS           PS Weight Sched
     C                     Z-ADDWL0149    WTEFNB           PS Pieces Sched
     C                     Z-ADDWL0150    WTWAIO           PS Weight Sched
     C                     Z-ADDWL0151    WTEGNB           PS Pieces Sched
     C                     MOVELWL0152    WTR3CD           Department Code
     C                     Z-ADDWL0153    WTRGNB           Item Structure
     C                     Z-ADDWL0154    WTRHNB           Item Structure
     C                     Z-ADDWL0155    WTRINB           Item Structure
     C                     MOVELWL0156    WTXRCD           Primal Group Co
     C                     MOVELWL0157    WTUVST           EDI Status 1
     C                     MOVELWL0158    WTUWST           EDI Status 2
     C                     MOVELWL0159    WTUXST           EDI Status 3
     C                     MOVELWL0160    WTVSST           Record Status
     C                     Z-ADDWL0161    WTAATM           Job Time
     C                     MOVELWL0162    WTAYNA           User Id
     C                     MOVELWL0163    WTA0NA           Job Name
     C                     Z-ADDWL0164    WTAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0101 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0001           Company Number
     C                     Z-ADDWTHGCD    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WUAIWG           Unit Weight
     C                     Z-ADDWL0006    WTRINB           Item Structure
     C                     Z-ADDWL0007    WTRHNB           Item Structure
     C                     Z-ADDWL0008    WTRGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WUCHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WTR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WTTHST    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WTTFST    P      Export/Domestic
     C                     MOVELWL0024    WTTEST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WTXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWTAJCD    WL0029    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WTWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WTWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WTWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWTAJCD    WL0049    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    WTB7ST    P      Production Ware
     C                     Z-ADDWL0051    YL0036           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0165           Company Number
     C                     Z-ADDWL0084    WL0166           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0167           Fresh Chilling
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0168    WTGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0165           Company Number
     C                     Z-ADDWL0084    WL0166           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0167           Fresh Chilling
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0168    WTGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WL0089    IFGT *ZERO                      *IF
     C           WL0088    DIV  WL0089    WTF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WTVSST           Record Status
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C                     MOVEL'N'       WTB5ST           PS Lock Status
     C           KLCRSS    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSS    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQST01           Company Number
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WJBCDT           Post to G/L Dat
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
      * Setup key
     C                     Z-ADDWL0165    WQST01           Company Number
     C                     Z-ADDWL0166    WJBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSST     SETLL@AFREBE                    *
     C           KRSST     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0167                     *IF
     C                     Z-ADDWJBCDT    WL0168           PS Available Sh
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WJA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSST     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0174           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WVC4NB    WQSU02           Order Number
     C           *LIKE     DEFN WVDPNB    WQSU03           Order Sequence
     C           *LIKE     DEFN WVUENB    WQSU04           Order Secondary
     C           *LIKE     DEFN WVJGDT    WQSU05           OD Production D
     C           *LIKE     DEFN WVNUDT    WQSU06           Consumed Item C
     C           *LIKE     DEFN WVHGCD    WQSU07           Item Code
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           WQSU03           Order Sequence
     C                     KFLD           WQSU04           Order Secondary
     C                     KFLD           WQSU05           OD Production D
     C                     KFLD           WQSU06           Consumed Item C
     C                     KFLD           WQSU07           Item Code
      * Setup key
     C                     Z-ADDWL0169    WQSU01           Company Number
     C                     Z-ADDWL0170    WQSU02           Order Number
     C                     Z-ADDWL0171    WQSU03           Order Sequence
     C                     Z-ADDWL0172    WQSU04           Order Secondary
     C                     Z-ADDWL0173    WQSU05           OD Production D
     C                     Z-ADDWL0175    WQSU06           Consumed Item C
     C                     Z-ADDWL0176    WQSU07           Item Code
      * Establish starting position
     C           KRSSU     SETLL@B6CPAG                    *
     C           KRSSU     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWVOONY    WL0174           ODS Sequence Nu
     C           KRSSU     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0182           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSV02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSV03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSV04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQSV05           OD Production D
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
     C                     KFLD           WQSV03           Order Sequence
     C                     KFLD           WQSV04           Order Secondary
     C                     KFLD           WQSV05           OD Production D
      * Setup key
     C                     Z-ADDWL0177    WQSV01           Company Number
     C                     Z-ADDWL0178    WQSV02           Order Number
     C                     Z-ADDWL0179    WQSV03           Order Sequence
     C                     Z-ADDWL0180    WQSV04           Order Secondary
     C                     Z-ADDWL0181    WQSV05           OD Production D
      * Establish starting position
     C           KRSSV     SETLL@B6CPNB                    *
     C           KRSSV     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWFOONY    WL0182           ODS Sequence Nu
     C           KRSSV     READE@B6CPNB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WL0182           ODS Sequence Nu
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0102  1        EDI Status 1
     C                     MOVEL*BLANK    WN0103  1        EDI Status 2
     C                     MOVEL*BLANK    WN0104  1        EDI Status 3
     C                     MOVEL*BLANK    WN0105  1        Record Status
     C                     Z-ADD*ZERO     WN0106  60       Job Time
     C                     MOVEL*BLANK    WN0107 10        User Id
     C                     MOVEL*BLANK    WN0108 10        Job Name
     C                     Z-ADD*ZERO     WN0109  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C                     KFLD           WFOONY           ODS Sequence Nu
      * Setup key
     C                     Z-ADDWL0183    WFAIC3           Company Number
     C                     Z-ADDWL0184    WFC4NB           Order Number
     C                     Z-ADDWL0185    WFDPNB           Order Sequence
     C                     Z-ADDWL0186    WFUENB           Order Secondary
     C                     Z-ADDWL0187    WFJGDT           OD Production D
     C                     Z-ADDWL0188    WFOONY           ODS Sequence Nu
      * Establish starting position
     C           KRSSW     CHAIN@B6CPNB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3152' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.OD Pieces Scheduled is Greater than zero
      *   |- c2    : PAR.OD Weight Scheduled is Greater than zero
      *   '-
     C           WL0193    IFGT *ZERO                      *IF
     C           WL0194    ORGT *ZERO                      *OR
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
     C                     EXSR SXCRRC
     C                     END                             *FI
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFFLWG    ADD  WL0194    YL0038           OD Weight Sched
     C           WFIGQT    ADD  WL0193    YL0039           OD Qty/Cnsmd Pi
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.OD Pieces Scheduled is Less than or equal zero
      *   |- c2    : LCL.OD Weight Scheduled is Less than or equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0039    IFLE *ZERO                      *IF
     C           YL0038    IFLE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0035           Company Number
     C                     Z-ADDWFC4NB    WL0036           Order Number
     C                     Z-ADDWFDPNB    WL0037           Order Sequence
     C                     Z-ADDWFUENB    WL0038           Order Secondary
     C                     Z-ADDWFJGDT    WL0039           OD Production D
     C                     Z-ADDWFOONY    WL0040           ODS Sequence Nu
     C                     EXSR SGDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
     C                     EXSR SYCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPNA
     C                     Z-ADDWL0183    WGAIC3           Company Number
     C                     Z-ADDWL0184    WGC4NB           Order Number
     C                     Z-ADDWL0185    WGDPNB           Order Sequence
     C                     Z-ADDWL0186    WGUENB           Order Secondary
     C                     Z-ADDWL0187    WGJGDT           OD Production D
     C                     Z-ADDWL0188    WGOONY           ODS Sequence Nu
     C                     Z-ADDWL0189    WGAODT           Scheduled Ship
     C                     MOVELWL0190    WGAJCD           Warehouse Code
     C                     Z-ADDWL0191    WGNUDT           Consumed Item C
     C                     Z-ADDWL0192    WGHGCD           Item Code
     C                     Z-ADDWL0193    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0194    WGFLWG           OD Weight Sched
     C                     Z-ADDWL0195    WGNSQT           ODS Quantity Sh
     C                     Z-ADDWL0196    WGJQWG           ODS Weight Shor
     C                     Z-ADDWL0197    WGNVDT           Deadline Depart
     C                     Z-ADDWL0198    WGBUTM           Deadline Depart
     C                     MOVELWN0102    WGUVST           EDI Status 1
     C                     MOVELWN0103    WGUWST           EDI Status 2
     C                     MOVELWN0104    WGUXST           EDI Status 3
     C                     MOVELWN0105    WGVSST           Record Status
     C                     Z-ADDWN0106    WGAATM           Job Time
     C                     MOVELWN0107    WGAYNA           User Id
     C                     MOVELWN0108    WGA0NA           Job Name
     C                     Z-ADDWN0109    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSX    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
      * Check for duplicate primary key
     C           KLCRSX    SETLL@B6CPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3153' W0RTN   7
      * Send message 'Order Detail Sched-Con EX'
     C                     MOVEL'USR3153' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0110  1        EDI Status 1
     C                     MOVEL*BLANK    WN0111  1        EDI Status 2
     C                     MOVEL*BLANK    WN0112  1        EDI Status 3
     C                     MOVEL*BLANK    WN0113  1        Record Status
     C                     Z-ADD*ZERO     WN0114  60       Job Time
     C                     MOVEL*BLANK    WN0115 10        User Id
     C                     MOVEL*BLANK    WN0116 10        Job Name
     C                     Z-ADD*ZERO     WN0117  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B6CPNA
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     Z-ADDWFJGDT    WGJGDT           OD Production D
     C                     Z-ADDWFOONY    WGOONY           ODS Sequence Nu
      *
     C           KLCHSY    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLCHSY    CHAIN@B6CPNA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB61    YARDCS
      * Move non-key fields to @B6CPNA
     C                     Z-ADDWL0189    WGAODT           Scheduled Ship
     C                     MOVELWL0190    WGAJCD    P      Warehouse Code
     C                     Z-ADDWL0191    WGNUDT           Consumed Item C
     C                     Z-ADDWL0192    WGHGCD           Item Code
     C                     Z-ADDYL0039    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDYL0038    WGFLWG           OD Weight Sched
     C                     Z-ADDWFNSQT    WGNSQT           ODS Quantity Sh
     C                     Z-ADDWFJQWG    WGJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B6CPNA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0118  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0119  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0120  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0121  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0122  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0123  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0124  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0125  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0126  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0127  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0128  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0129  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0130  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0131  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0132  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0133  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0134  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0135  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0136  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0137  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0138 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0139  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0140 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0141  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0142 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0143  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0144 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0145  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0146 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0147  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0148 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0149  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0150  3        PS Item Id
     C                     MOVEL*BLANK    WN0151  2        Warehouse Type
     C                     MOVEL*BLANK    WN0152  1        PS Lock Status
     C                     MOVEL*BLANK    WN0153  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0154  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0155  1        PS Piece Count
     C                     MOVEL*BLANK    WN0156  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0157  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0158  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0159  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0160  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0161  3        PS Production W
     C                     Z-ADD*ZERO     WN0162  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0163  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0164  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0165  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0166  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0167  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0168  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0169  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0170  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0171  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0172  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0173  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0174  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0175  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0176  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0177  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0178  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0179  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0180  6        Department Code
     C                     Z-ADD*ZERO     WN0181  30       Item Structure
     C                     Z-ADD*ZERO     WN0182  30       Item Structure
     C                     Z-ADD*ZERO     WN0183  30       Item Structure
     C                     MOVEL*BLANK    WN0184  6        Primal Group Co
     C                     MOVEL*BLANK    WN0185  1        EDI Status 1
     C                     MOVEL*BLANK    WN0186  1        EDI Status 2
     C                     MOVEL*BLANK    WN0187  1        EDI Status 3
     C                     MOVEL*BLANK    WN0188  1        Record Status
     C                     Z-ADD*ZERO     WN0189  60       Job Time
     C                     MOVEL*BLANK    WN0190 10        User Id
     C                     MOVEL*BLANK    WN0191 10        Job Name
     C                     Z-ADD*ZERO     WN0192  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHSZ    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YBRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWSF8WG    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0042    WTOAWT           PS Weight Prod
     C                     Z-ADDWN0043    WTCDNB           PS Pieces Prod
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0193  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0194  3        Warehouse Code
     C                     MOVEL*BLANK    WN0195  3        Order From Ware
     C                     Z-ADD*ZERO     WN0196  70       Item Code
     C                     Z-ADD*ZERO     WN0197 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0198 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0199  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0200  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0201  1        EDI Status 1
     C                     MOVEL*BLANK    WN0202  1        EDI Status 2
     C                     MOVEL*BLANK    WN0203  1        EDI Status 3
     C                     MOVEL*BLANK    WN0204  1        Record Status
     C                     Z-ADD*ZERO     WN0205  60       Job Time
     C                     MOVEL*BLANK    WN0206 10        User Id
     C                     MOVEL*BLANK    WN0207 10        Job Name
     C                     Z-ADD*ZERO     WN0208  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0199    WRAIC3           Company Number
     C                     Z-ADDWL0200    WRC4NB           Order Number
     C                     Z-ADDWL0201    WRDPNB           Order Sequence
     C                     Z-ADDWL0202    WRUENB           Order Secondary
     C                     Z-ADDWL0203    WRJGDT           OD Production D
      *
     C           KLCHTA    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C                     KFLD           WRJGDT           OD Production D
     C           KLCHTA    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YCRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWL0204    WRIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0205    WRFLWG           OD Weight Sched
     C                     Z-ADDWL0206    WRIUQT           OD Quantity Inv
     C                     Z-ADDWL0207    WRF3WG           OD Weight Inv S
     C                     MOVELWL0208    WRP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0211           Production Yiel
     C                     MOVEL*BLANK    WL0212           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTB01           Company Number
     C           *LIKE     DEFN WWHGCD    WQTB02           Item Code
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Item Code
      * Setup key
     C                     Z-ADDWL0209    WQTB01           Company Number
     C                     Z-ADDWL0210    WQTB02           Item Code
      * Establish starting position
     C           KRSTB     SETLL@IOREA4                    *
     C           KRSTB     READE@IOREA4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0212           Record Found US
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WWBPPR    WL0211           Production Yiel
     C                     MOVEL'Y'       WL0212           Record Found US
     C           KRSTB     READE@IOREA4                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0209  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0210  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0211  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0212  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0213  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0214  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0215  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0216  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0217  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0218  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0219  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0220  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0221  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0222  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0223  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0224  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0226  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0227  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0228  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0229  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0230  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0231  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0232 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0233  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0234 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0235  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0236 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0237  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0238 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0239  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0240 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0241  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0242 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0243  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0244  3        PS Item Id
     C                     MOVEL*BLANK    WN0245  2        Warehouse Type
     C                     MOVEL*BLANK    WN0246  1        PS Lock Status
     C                     MOVEL*BLANK    WN0247  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0248  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0249  1        PS Piece Count
     C                     MOVEL*BLANK    WN0250  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0251  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0252  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0253  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0254  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0255  3        PS Production W
     C                     Z-ADD*ZERO     WN0256  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0257  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0258  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0259  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0260  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0261  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0262  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0263  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0264  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0265  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0266  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0267  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0268  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0269  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0270  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0271  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0272  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0273  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0274  6        Department Code
     C                     Z-ADD*ZERO     WN0275  30       Item Structure
     C                     Z-ADD*ZERO     WN0276  30       Item Structure
     C                     Z-ADD*ZERO     WN0277  30       Item Structure
     C                     MOVEL*BLANK    WN0278  6        Primal Group Co
     C                     MOVEL*BLANK    WN0279  1        EDI Status 1
     C                     MOVEL*BLANK    WN0280  1        EDI Status 2
     C                     MOVEL*BLANK    WN0281  1        EDI Status 3
     C                     MOVEL*BLANK    WN0282  1        Record Status
     C                     Z-ADD*ZERO     WN0283  60       Job Time
     C                     MOVEL*BLANK    WN0284 10        User Id
     C                     MOVEL*BLANK    WN0285 10        Job Name
     C                     Z-ADD*ZERO     WN0286  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0213    WSAIC3           Company Number
     C                     MOVELWL0214    WSV5ST           Production Type
     C                     Z-ADDWL0215    WSELDT           Production Date
     C                     Z-ADDWL0216    WSHGCD           Item Code
     C                     MOVELWL0217    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTC     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0219    WN0216           PS Weight Stand
     C                     Z-ADDWL0218    WN0217           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0217    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0216    DIV  WN0217    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0213           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0213    IFLT *ZERO                      *IF
     C                     MULT -1        WN0213           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0216    IFNE *ZERO                      *IF
     C           WN0217    ORNE *ZERO                      *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0213    WL0082           Company Number
     C                     MOVELWL0214    WL0083    P      Production Type
     C                     Z-ADDWL0215    WL0084           Production Date
     C                     Z-ADDWL0216    WL0085           Item Code
     C                     MOVELWL0217    WL0086    P      Warehouse Code
     C                     Z-ADDWN0209    WL0087           PS Available Sh
     C                     Z-ADDWN0210    WL0088           PS Weight Plann
     C                     Z-ADDWN0211    WL0089           PS Pieces Plann
     C                     Z-ADDWN0212    WL0090           PS % of Carcass
     C                     Z-ADDWN0213    WL0091           PS Avg Piece Wg
     C                     Z-ADDWN0214    WL0092           PS Weight Inv O
     C                     Z-ADDWN0215    WL0093           PS Pieces Inv O
     C                     Z-ADDWN0216    WL0094           PS Weight Stand
     C                     Z-ADDWN0217    WL0095           PS Pieces Stand
     C                     Z-ADDWN0218    WL0096           PS Weight Conve
     C                     Z-ADDWN0219    WL0097           PS Pieces Conve
     C                     Z-ADDWN0220    WL0098           PS Weight Shipp
     C                     Z-ADDWN0221    WL0099           PS Pieces Shipp
     C                     Z-ADDWN0222    WL0100           PS Weight Prod
     C                     Z-ADDWN0223    WL0101           PS Pieces Prod
     C                     Z-ADDWN0224    WL0102           PS Weight Inv A
     C                     Z-ADDWN0225    WL0103           PS Pieces Inv A
     C                     Z-ADDWN0226    WL0104           PS Weight Ship
     C                     Z-ADDWN0227    WL0105           PS Pieces Ship
     C                     Z-ADDWN0228    WL0106           PS Weight Prod
     C                     Z-ADDWN0229    WL0107           PS Pieces Prod
     C                     Z-ADDWN0230    WL0108           PS Weight Inv A
     C                     Z-ADDWN0231    WL0109           PS Pieces Inv A
     C                     Z-ADDWN0232    WL0110           PS Unit Weight
     C                     Z-ADDWN0233    WL0111           PS Pieces Whse
     C                     Z-ADDWN0234    WL0112           PS Weight Whse
     C                     Z-ADDWN0235    WL0113           PS Pieces Unuse
     C                     Z-ADDWN0236    WL0114           PS Weight Unuse
     C                     Z-ADDWN0237    WL0115           PS Pieces Unuse
     C                     Z-ADDWN0238    WL0116           PS Weight Unuse
     C                     Z-ADDWN0239    WL0117           PS Pieces Unuse
     C                     Z-ADDWN0240    WL0118           PS Weight Unuse
     C                     Z-ADDWN0241    WL0119           PS Pieces Unuse
     C                     Z-ADDWN0242    WL0120           PS Weight Unuse
     C                     Z-ADDWN0243    WL0121           PS Pieces Unuse
     C                     MOVELWN0244    WL0122    P      PS Item Id
     C                     MOVELWN0245    WL0123    P      Warehouse Type
     C                     MOVELWN0246    WL0124    P      PS Lock Status
     C                     MOVELWN0247    WL0125    P      PS Export/Domes
     C                     MOVELWN0248    WL0126    P      PS Print On Sch
     C                     MOVELWN0249    WL0127    P      PS Piece Count
     C                     MOVELWN0250    WL0128    P      PS Unused Sts 1
     C                     MOVELWN0251    WL0129    P      PS Unused Sts 2
     C                     MOVELWN0252    WL0130    P      PS Unused Sts 3
     C                     MOVELWN0253    WL0131    P      PS Unused Sts 4
     C                     MOVELWN0254    WL0132    P      PS Item Sched N
     C                     MOVELWN0255    WL0133    P      PS Production W
     C                     Z-ADDWN0256    WL0134           PS Weight Order
     C                     Z-ADDWN0257    WL0135           PS Pieces Order
     C                     Z-ADDWN0258    WL0136           PS Weight FC Ad
     C                     Z-ADDWN0259    WL0137           PS Pieces FC Ad
     C                     Z-ADDWN0260    WL0138           PS Weight FX Ad
     C                     Z-ADDWN0261    WL0139           PS Pieces FX Ad
     C                     Z-ADDWN0262    WL0140           PS Weight Sched
     C                     Z-ADDWN0263    WL0141           PS Pieces Sched
     C                     Z-ADDWN0264    WL0142           PS Weight Avail
     C                     Z-ADDWN0265    WL0143           PS Pieces Avail
     C                     Z-ADDWN0266    WL0144           PS Weight Produ
     C                     Z-ADDWN0267    WL0145           PS Pieces Produ
     C                     Z-ADDWN0268    WL0146           PS Weight Fab N
     C                     Z-ADDWN0269    WL0147           PS Pieces Fab N
     C                     Z-ADDWN0270    WL0148           PS Weight Sched
     C                     Z-ADDWN0271    WL0149           PS Pieces Sched
     C                     Z-ADDWN0272    WL0150           PS Weight Sched
     C                     Z-ADDWN0273    WL0151           PS Pieces Sched
     C                     MOVELWN0274    WL0152    P      Department Code
     C                     Z-ADDWN0275    WL0153           Item Structure
     C                     Z-ADDWN0276    WL0154           Item Structure
     C                     Z-ADDWN0277    WL0155           Item Structure
     C                     MOVELWN0278    WL0156    P      Primal Group Co
     C                     MOVELWN0279    WL0157    P      EDI Status 1
     C                     MOVELWN0280    WL0158    P      EDI Status 2
     C                     MOVELWN0281    WL0159    P      EDI Status 3
     C                     MOVELWN0282    WL0160    P      Record Status
     C                     Z-ADDWN0283    WL0161           Job Time
     C                     MOVELWN0284    WL0162    P      User Id
     C                     MOVELWN0285    WL0163    P      Job Name
     C                     Z-ADDWN0286    WL0164           Job Date
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSDXWG    ADD  WL0219    WN0216           PS Weight Stand
     C           WSB2NB    ADD  WL0218    WN0217           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0217    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0216    DIV  WN0217    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0213           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0213    IFLT *ZERO                      *IF
     C                     MULT -1        WN0213           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
     C                     EXSR TDCHRC
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0287  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0288  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0289  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0290  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0291  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0292  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0293  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0294  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0295  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0296  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0297  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0298  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0299  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0300  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0301  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0302  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0303  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0304  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0305  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0306  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0307 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0308  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0309 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0310  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0311 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0312  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0313 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0314  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0315 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0316  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0317 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0318  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0319  3        PS Item Id
     C                     MOVEL*BLANK    WN0320  2        Warehouse Type
     C                     MOVEL*BLANK    WN0321  1        PS Lock Status
     C                     MOVEL*BLANK    WN0322  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0323  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0324  1        PS Piece Count
     C                     MOVEL*BLANK    WN0325  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0326  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0327  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0328  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0329  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0330  3        PS Production W
     C                     Z-ADD*ZERO     WN0331  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0332  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0333  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0334  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0335  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0336  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0337  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0338  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0339  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0340  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0341  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0342  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0343  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0344  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0345  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0346  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0347  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0348  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0349  6        Department Code
     C                     Z-ADD*ZERO     WN0350  30       Item Structure
     C                     Z-ADD*ZERO     WN0351  30       Item Structure
     C                     Z-ADD*ZERO     WN0352  30       Item Structure
     C                     MOVEL*BLANK    WN0353  6        Primal Group Co
     C                     MOVEL*BLANK    WN0354  1        EDI Status 1
     C                     MOVEL*BLANK    WN0355  1        EDI Status 2
     C                     MOVEL*BLANK    WN0356  1        EDI Status 3
     C                     MOVEL*BLANK    WN0357  1        Record Status
     C                     Z-ADD*ZERO     WN0358  60       Job Time
     C                     MOVEL*BLANK    WN0359 10        User Id
     C                     MOVEL*BLANK    WN0360 10        Job Name
     C                     Z-ADD*ZERO     WN0361  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHTD    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHTD    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YDRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0213    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0216    WTDXWG           PS Weight Stand
     C                     Z-ADDWN0217    WTB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0362  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0363  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0364  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0365  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0366  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0367  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0368  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0369  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0370  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0371  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0372  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0373  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0374  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0375  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0376  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0377  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0378  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0379  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0380  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0381  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0382  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0383  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0384  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0385 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0386  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0387 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0388  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0389 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0390  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0391 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0392  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0393 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0394  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0395 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0396  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0397  3        PS Item Id
     C                     MOVEL*BLANK    WN0398  2        Warehouse Type
     C                     MOVEL*BLANK    WN0399  1        PS Lock Status
     C                     MOVEL*BLANK    WN0400  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0401  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0402  1        PS Piece Count
     C                     MOVEL*BLANK    WN0403  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0404  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0405  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0406  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0407  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0408  3        PS Production W
     C                     Z-ADD*ZERO     WN0409  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0410  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0411  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0412  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0413  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0414  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0415  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0416  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0417  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0418  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0419  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0420  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0421  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0422  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0423  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0424  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0425  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0426  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0427  6        Department Code
     C                     Z-ADD*ZERO     WN0428  30       Item Structure
     C                     Z-ADD*ZERO     WN0429  30       Item Structure
     C                     Z-ADD*ZERO     WN0430  30       Item Structure
     C                     MOVEL*BLANK    WN0431  6        Primal Group Co
     C                     MOVEL*BLANK    WN0432  1        EDI Status 1
     C                     MOVEL*BLANK    WN0433  1        EDI Status 2
     C                     MOVEL*BLANK    WN0434  1        EDI Status 3
     C                     MOVEL*BLANK    WN0435  1        Record Status
     C                     Z-ADD*ZERO     WN0436  60       Job Time
     C                     MOVEL*BLANK    WN0437 10        User Id
     C                     MOVEL*BLANK    WN0438 10        Job Name
     C                     Z-ADD*ZERO     WN0439  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0220    WSAIC3           Company Number
     C                     MOVELWL0221    WSV5ST           Production Type
     C                     Z-ADDWL0222    WSELDT           Production Date
     C                     Z-ADDWL0223    WSHGCD           Item Code
     C                     MOVELWL0224    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTE     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0225    WN0387           PS Weight Whse
     C                     Z-ADDWL0226    WN0386           PS Pieces Whse
      * CASE: PAR.PS Pieces Whse Tfr Adj is GT Zero
     C           WN0386    IFGT *ZERO                      *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Whse Tfr Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Whse Tfr Adj
     C           WN0387    DIV  WN0386    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0366           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0220    WL0082           Company Number
     C                     MOVELWL0221    WL0083    P      Production Type
     C                     Z-ADDWL0222    WL0084           Production Date
     C                     Z-ADDWL0223    WL0085           Item Code
     C                     MOVELWL0224    WL0086    P      Warehouse Code
     C                     Z-ADDWN0362    WL0087           PS Available Sh
     C                     Z-ADDWN0363    WL0088           PS Weight Plann
     C                     Z-ADDWN0364    WL0089           PS Pieces Plann
     C                     Z-ADDWN0365    WL0090           PS % of Carcass
     C                     Z-ADDWN0366    WL0091           PS Avg Piece Wg
     C                     Z-ADDWN0367    WL0092           PS Weight Inv O
     C                     Z-ADDWN0368    WL0093           PS Pieces Inv O
     C                     Z-ADDWN0369    WL0094           PS Weight Stand
     C                     Z-ADDWN0370    WL0095           PS Pieces Stand
     C                     Z-ADDWN0371    WL0096           PS Weight Conve
     C                     Z-ADDWN0372    WL0097           PS Pieces Conve
     C                     Z-ADDWN0373    WL0098           PS Weight Shipp
     C                     Z-ADDWN0374    WL0099           PS Pieces Shipp
     C                     Z-ADDWN0375    WL0100           PS Weight Prod
     C                     Z-ADDWN0376    WL0101           PS Pieces Prod
     C                     Z-ADDWN0377    WL0102           PS Weight Inv A
     C                     Z-ADDWN0378    WL0103           PS Pieces Inv A
     C                     Z-ADDWN0379    WL0104           PS Weight Ship
     C                     Z-ADDWN0380    WL0105           PS Pieces Ship
     C                     Z-ADDWN0381    WL0106           PS Weight Prod
     C                     Z-ADDWN0382    WL0107           PS Pieces Prod
     C                     Z-ADDWN0383    WL0108           PS Weight Inv A
     C                     Z-ADDWN0384    WL0109           PS Pieces Inv A
     C                     Z-ADDWN0385    WL0110           PS Unit Weight
     C                     Z-ADDWN0386    WL0111           PS Pieces Whse
     C                     Z-ADDWN0387    WL0112           PS Weight Whse
     C                     Z-ADDWN0388    WL0113           PS Pieces Unuse
     C                     Z-ADDWN0389    WL0114           PS Weight Unuse
     C                     Z-ADDWN0390    WL0115           PS Pieces Unuse
     C                     Z-ADDWN0391    WL0116           PS Weight Unuse
     C                     Z-ADDWN0392    WL0117           PS Pieces Unuse
     C                     Z-ADDWN0393    WL0118           PS Weight Unuse
     C                     Z-ADDWN0394    WL0119           PS Pieces Unuse
     C                     Z-ADDWN0395    WL0120           PS Weight Unuse
     C                     Z-ADDWN0396    WL0121           PS Pieces Unuse
     C                     MOVELWN0397    WL0122    P      PS Item Id
     C                     MOVELWN0398    WL0123    P      Warehouse Type
     C                     MOVELWN0399    WL0124    P      PS Lock Status
     C                     MOVELWN0400    WL0125    P      PS Export/Domes
     C                     MOVELWN0401    WL0126    P      PS Print On Sch
     C                     MOVELWN0402    WL0127    P      PS Piece Count
     C                     MOVELWN0403    WL0128    P      PS Unused Sts 1
     C                     MOVELWN0404    WL0129    P      PS Unused Sts 2
     C                     MOVELWN0405    WL0130    P      PS Unused Sts 3
     C                     MOVELWN0406    WL0131    P      PS Unused Sts 4
     C                     MOVELWN0407    WL0132    P      PS Item Sched N
     C                     MOVELWN0408    WL0133    P      PS Production W
     C                     Z-ADDWN0409    WL0134           PS Weight Order
     C                     Z-ADDWN0410    WL0135           PS Pieces Order
     C                     Z-ADDWN0411    WL0136           PS Weight FC Ad
     C                     Z-ADDWN0412    WL0137           PS Pieces FC Ad
     C                     Z-ADDWN0413    WL0138           PS Weight FX Ad
     C                     Z-ADDWN0414    WL0139           PS Pieces FX Ad
     C                     Z-ADDWN0415    WL0140           PS Weight Sched
     C                     Z-ADDWN0416    WL0141           PS Pieces Sched
     C                     Z-ADDWN0417    WL0142           PS Weight Avail
     C                     Z-ADDWN0418    WL0143           PS Pieces Avail
     C                     Z-ADDWN0419    WL0144           PS Weight Produ
     C                     Z-ADDWN0420    WL0145           PS Pieces Produ
     C                     Z-ADDWN0421    WL0146           PS Weight Fab N
     C                     Z-ADDWN0422    WL0147           PS Pieces Fab N
     C                     Z-ADDWN0423    WL0148           PS Weight Sched
     C                     Z-ADDWN0424    WL0149           PS Pieces Sched
     C                     Z-ADDWN0425    WL0150           PS Weight Sched
     C                     Z-ADDWN0426    WL0151           PS Pieces Sched
     C                     MOVELWN0427    WL0152    P      Department Code
     C                     Z-ADDWN0428    WL0153           Item Structure
     C                     Z-ADDWN0429    WL0154           Item Structure
     C                     Z-ADDWN0430    WL0155           Item Structure
     C                     MOVELWN0431    WL0156    P      Primal Group Co
     C                     MOVELWN0432    WL0157    P      EDI Status 1
     C                     MOVELWN0433    WL0158    P      EDI Status 2
     C                     MOVELWN0434    WL0159    P      EDI Status 3
     C                     MOVELWN0435    WL0160    P      Record Status
     C                     Z-ADDWN0436    WL0161           Job Time
     C                     MOVELWN0437    WL0162    P      User Id
     C                     MOVELWN0438    WL0163    P      Job Name
     C                     Z-ADDWN0439    WL0164           Job Date
     C                     EXSR SSCRRC
      *  not necessary here ...
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSGAWG    ADD  WL0225    WN0387           PS Weight Whse
     C           WSBPNB    ADD  WL0226    WN0386           PS Pieces Whse
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
     C                     EXSR TFCHRC
      *  not necessary here ...
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0440  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0441  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0442  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0443  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0444  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0445  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0446  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0447  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0448  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0449  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0450  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0451  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0452  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0453  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0454  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0455  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0456  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0457  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0458  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0459  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0460  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0461  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0462 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0463  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0464 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0465  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0466 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0467  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0468 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0469  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0470 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0471  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0472  3        PS Item Id
     C                     MOVEL*BLANK    WN0473  2        Warehouse Type
     C                     MOVEL*BLANK    WN0474  1        PS Lock Status
     C                     MOVEL*BLANK    WN0475  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0476  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0477  1        PS Piece Count
     C                     MOVEL*BLANK    WN0478  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0479  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0480  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0481  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0482  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0483  3        PS Production W
     C                     Z-ADD*ZERO     WN0484  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0485  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0486  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0487  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0488  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0489  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0490  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0491  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0492  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0493  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0494  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0495  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0496  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0497  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0498  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0499  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0500  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0501  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0502  6        Department Code
     C                     Z-ADD*ZERO     WN0503  30       Item Structure
     C                     Z-ADD*ZERO     WN0504  30       Item Structure
     C                     Z-ADD*ZERO     WN0505  30       Item Structure
     C                     MOVEL*BLANK    WN0506  6        Primal Group Co
     C                     MOVEL*BLANK    WN0507  1        EDI Status 1
     C                     MOVEL*BLANK    WN0508  1        EDI Status 2
     C                     MOVEL*BLANK    WN0509  1        EDI Status 3
     C                     MOVEL*BLANK    WN0510  1        Record Status
     C                     Z-ADD*ZERO     WN0511  60       Job Time
     C                     MOVEL*BLANK    WN0512 10        User Id
     C                     MOVEL*BLANK    WN0513 10        Job Name
     C                     Z-ADD*ZERO     WN0514  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHTF    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHTF    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YERDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWSF8WG    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0386    WTBPNB           PS Pieces Whse
     C                     Z-ADDWN0387    WTGAWG           PS Weight Whse
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0519 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0520 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0521  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0522 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0523  92       Weight Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0522           Quantity Alloca
     C                     Z-ADD*ZERO     WN0523           Weight Allocate
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQTG01           Company Number
     C           *LIKE     DEFN WXHGCD    WQTG02           Item Code
     C           *LIKE     DEFN WXAJCD    WQTG03           Warehouse Code
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Item Code
     C                     KFLD           WQTG03           Warehouse Code
     C                     KFLD           WXELDT           Production Date
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Item Code
     C                     KFLD           WQTG03           Warehouse Code
      * Setup key
     C                     Z-ADDWEAIC3    WQTG01           Company Number
     C                     Z-ADDWEHGCD    WQTG02           Item Code
     C                     MOVELWEAJCD    WQTG03           Warehouse Code
     C                     Z-ADDYL0041    WXELDT           Production Date
      * Establish starting position
     C           KPSTG     SETLL@CWCPQW                    *
     C           KRSTG     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * FP1054 this used to quit when the job date was reached.
      *   now it quits when par.to date is reached. for the freezer it wi
      *   be the freeze time number of days before the sched ship.
      *   For Fresh, it will be the job date
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Production Date GE PAR.To Date               USR
      *   |- c2    : PAR.ATS Quantity Need USR is Less than or equal zero
      *   '-
     C           WXELDT    IFGE ##JDT                      *IF
     C           YL0030    ORLE *ZERO                      *OR
     C                     GOTO TGEXIT                     *QUIT
     C                     END                             *FI
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR THRVGN
     C           WXARQT    SUB  YL0043    WN0519           ATS Quantity Av
     C           WXACWG    SUB  YL0044    WN0520           ATS Weight Avai
      * Allocate Available Inventory
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0519    IFGT *ZERO                      *IF
      * Allocate
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0030    IFGT WN0519                     *IF
     C                     ADD  WN0519    YL0028           Quantity Schedu
     C           WN0519    MULT YL0013    WN0520           ATS Weight Avai
     C                     ADD  WN0520    YL0029           Weight Schedule
     C                     Z-ADDWN0519    WN0522           Quantity Alloca
     C                     Z-ADDWN0520    WN0523           Weight Allocate
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0030    IFLE WN0519                     *IF
     C                     ADD  YL0030    YL0028           Quantity Schedu
     C                     ADD  YL0031    YL0029           Weight Schedule
     C                     Z-ADDYL0030    WN0522           Quantity Alloca
     C           WN0522    MULT YL0013    WN0523           Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0028           Quantity Schedu
     C                     ADD  *ZERO     YL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR TIRVGN
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
     C                     EXSR TLRVGN
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     C           YL0026    SUB  YL0028    YL0030           ATS Quantity Ne
     C           YL0027    SUB  YL0029    YL0031           ATS Weight Need
     C           KRSTG     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0043           OD Quantity Inv
     C                     Z-ADD*ZERO     YL0044           OD Weight Inv S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQTH01           Company Number
     C           *LIKE     DEFN WYHGCD    WQTH02           Item Code
     C           *LIKE     DEFN WYAJCD    WQTH03           Warehouse Code
     C           *LIKE     DEFN WYJGDT    WQTH04           OD Production D
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Item Code
     C                     KFLD           WQTH03           Warehouse Code
     C                     KFLD           WQTH04           OD Production D
      * Setup key
     C                     Z-ADDWXAIC3    WQTH01           Company Number
     C                     Z-ADDWXHGCD    WQTH02           Item Code
     C                     MOVELWXAJCD    WQTH03           Warehouse Code
     C                     Z-ADDWXELDT    WQTH04           OD Production D
      * Establish starting position
     C           KRSTH     SETLL@B5CPM4                    *
     C           KRSTH     READE@B5CPM4                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WYIUQT    YL0043           OD Quantity Inv
     C                     ADD  WYF3WG    YL0044           OD Weight Inv S
     C           KRSTH     READE@B5CPM4                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0524  1        EDI Status 1
     C                     MOVEL*BLANK    WN0525  1        EDI Status 2
     C                     MOVEL*BLANK    WN0526  1        EDI Status 3
     C                     MOVEL*BLANK    WN0527  1        Record Status
     C                     Z-ADD*ZERO     WN0528  60       Job Time
     C                     MOVEL*BLANK    WN0529 10        User Id
     C                     MOVEL*BLANK    WN0530 10        Job Name
     C                     Z-ADD*ZERO     WN0531  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
      * Setup key
     C                     Z-ADDWXAIC3    WHAIC3           Company Number
     C                     Z-ADDWEC4NB    WHC4NB           Order Number
     C                     Z-ADDWEDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWEUENB    WHUENB           Order Secondary
     C                     Z-ADDWXELDT    WHJGDT           OD Production D
      * Establish starting position
     C           KRSTI     CHAIN@B5CPM2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3150' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
     C                     EXSR TJCRRC
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHIUQT    ADD  WN0522    YL0045           OD Quantity Inv
     C           WHF3WG    ADD  WN0523    YL0046           OD Weight Inv S
      * CASE: LCL.OD Quantity Inv Sched is LE Zero
     C           YL0045    IFLE *ZERO                      *IF
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0041           Company Number
     C                     Z-ADDWHC4NB    WL0042           Order Number
     C                     Z-ADDWHDPNB    WL0043           Order Sequence
     C                     Z-ADDWHUENB    WL0044           Order Secondary
     C                     Z-ADDWHJGDT    WL0045           OD Production D
     C                     EXSR SIDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
     C                     EXSR TKCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCRRC    BEGSR
      *================================================================
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B5CPM1
     C                     Z-ADDWXAIC3    WIAIC3           Company Number
     C                     Z-ADDWEC4NB    WIC4NB           Order Number
     C                     Z-ADDWEDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWEUENB    WIUENB           Order Secondary
     C                     Z-ADDWXELDT    WIJGDT           OD Production D
     C                     Z-ADDWEAODT    WIAODT           Scheduled Ship
     C                     MOVELWXAJCD    WIAJCD           Warehouse Code
     C                     Z-ADDWXHGCD    WIHGCD           Item Code
     C                     Z-ADDWN0522    WIIUQT           OD Quantity Inv
     C                     Z-ADDWN0523    WIF3WG           OD Weight Inv S
     C                     MOVELWN0524    WIUVST           EDI Status 1
     C                     MOVELWN0525    WIUWST           EDI Status 2
     C                     MOVELWN0526    WIUXST           EDI Status 3
     C                     MOVELWN0527    WIVSST           Record Status
     C                     Z-ADDWN0528    WIAATM           Job Time
     C                     MOVELWN0529    WIAYNA           User Id
     C                     MOVELWN0530    WIA0NA           Job Name
     C                     Z-ADDWN0531    WIAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WIVSST           Record Status
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRTJ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRTJ    SETLL@B5CPM1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3151' W0RTN   7
      * Send message 'Order Detail Sched-Inv EX'
     C                     MOVEL'USR3151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C                     WRITE@B5CPM1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0532  1        EDI Status 1
     C                     MOVEL*BLANK    WN0533  1        EDI Status 2
     C                     MOVEL*BLANK    WN0534  1        EDI Status 3
     C                     MOVEL*BLANK    WN0535  1        Record Status
     C                     Z-ADD*ZERO     WN0536  60       Job Time
     C                     MOVEL*BLANK    WN0537 10        User Id
     C                     MOVEL*BLANK    WN0538 10        Job Name
     C                     Z-ADD*ZERO     WN0539  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @B5CPM1
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
     C                     Z-ADDWHDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWHUENB    WIUENB           Order Secondary
     C                     Z-ADDWHJGDT    WIJGDT           OD Production D
      *
     C           KLCHTK    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
     C           KLCHTK    CHAIN@B5CPM1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB51    YFRDCS
      * Move non-key fields to @B5CPM1
     C                     Z-ADDWHAODT    WIAODT           Scheduled Ship
     C                     MOVELWXAJCD    WIAJCD    P      Warehouse Code
     C                     Z-ADDWXHGCD    WIHGCD           Item Code
     C                     Z-ADDYL0045    WIIUQT           OD Quantity Inv
     C                     Z-ADDYL0046    WIF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@B5CPM1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0540 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0541 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0542 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0543 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0544 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0545 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0546  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0547  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0548  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0549  1        EDI Status 1
     C                     MOVEL*BLANK    WN0550  1        EDI Status 2
     C                     MOVEL*BLANK    WN0551  1        EDI Status 3
     C                     MOVEL*BLANK    WN0552  1        Record Status
     C                     Z-ADD*ZERO     WN0553  60       Job Time
     C                     MOVEL*BLANK    WN0554 10        User Id
     C                     MOVEL*BLANK    WN0555 10        Job Name
     C                     Z-ADD*ZERO     WN0556  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Setup key
     C                     Z-ADDWEAIC3    WEAIC3           Company Number
     C                     Z-ADDWEC4NB    WEC4NB           Order Number
     C                     Z-ADDWEDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWEUENB    WEUENB           Order Secondary
     C                     Z-ADD##JDT     WEJGDT           OD Production D
      * Establish starting position
     C           KRSTL     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0231           Company Number
     C                     Z-ADDWEC4NB    WL0232           Order Number
     C                     Z-ADDWEDPNB    WL0233           Order Sequence
     C                     Z-ADDWEUENB    WL0234           Order Secondary
     C                     Z-ADD##JDT     WL0235           OD Production D
     C                     Z-ADDWEAODT    WL0236           Scheduled Ship
     C                     MOVELWEAJCD    WL0237    P      Warehouse Code
     C                     MOVELWEAJCD    WL0238    P      Order From Ware
     C                     Z-ADDWEHGCD    WL0239           Item Code
     C                     Z-ADDWN0540    WL0240           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0541    WL0241           OD Weight Sched
     C                     Z-ADDWN0522    WL0242           OD Quantity Inv
     C                     Z-ADDWN0523    WL0243           OD Weight Inv S
     C                     Z-ADDWN0544    WL0244           OD Quantity Unu
     C                     Z-ADDWN0545    WL0245           OD Unused weigh
     C                     MOVELWN0546    WL0246    P      OD Added to Sch
     C                     MOVELWN0547    WL0247    P      OD Reallocate S
     C                     MOVELWN0548    WL0248    P      OD Status Unuse
     C                     MOVELWN0549    WL0249    P      EDI Status 1
     C                     MOVELWN0550    WL0250    P      EDI Status 2
     C                     MOVELWN0551    WL0251    P      EDI Status 3
     C                     MOVELWN0552    WL0252    P      Record Status
     C                     Z-ADDWN0553    WL0253           Job Time
     C                     MOVELWN0554    WL0254    P      User Id
     C                     MOVELWN0555    WL0255    P      Job Name
     C                     Z-ADDWN0556    WL0256           Job Date
     C                     EXSR TMCRRC
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEIUQT    ADD  WN0522    WN0542           OD Quantity Inv
     C           WEF3WG    ADD  WN0523    WN0543           OD Weight Inv S
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0542    IFLE *ZERO                      *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0056           Company Number
     C                     Z-ADDWEC4NB    WL0057           Order Number
     C                     Z-ADDWEDPNB    WL0058           Order Sequence
     C                     Z-ADDWEUENB    WL0059           Order Secondary
     C                     Z-ADDWEJGDT    WL0060           OD Production D
     C                     EXSR SPDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
     C                     EXSR TNCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KNCPHN
     C                     Z-ADDWL0231    WRAIC3           Company Number
     C                     Z-ADDWL0232    WRC4NB           Order Number
     C                     Z-ADDWL0233    WRDPNB           Order Sequence
     C                     Z-ADDWL0234    WRUENB           Order Secondary
     C                     Z-ADDWL0235    WRJGDT           OD Production D
     C                     Z-ADDWL0236    WRAODT           Scheduled Ship
     C                     MOVELWL0237    WRAJCD           Warehouse Code
     C                     MOVELWL0238    WRAYAA           Order From Ware
     C                     Z-ADDWL0239    WRHGCD           Item Code
     C                     Z-ADDWL0240    WRIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0241    WRFLWG           OD Weight Sched
     C                     Z-ADDWL0242    WRIUQT           OD Quantity Inv
     C                     Z-ADDWL0243    WRF3WG           OD Weight Inv S
     C                     Z-ADDWL0244    WRIVQT           OD Quantity Unu
     C                     Z-ADDWL0245    WRF4WG           OD Unused weigh
     C                     MOVELWL0246    WRP7ST           OD Added to Sch
     C                     MOVELWL0247    WRP8ST           OD Reallocate S
     C                     MOVELWL0248    WRQAST           OD Status Unuse
     C                     MOVELWL0249    WRUVST           EDI Status 1
     C                     MOVELWL0250    WRUWST           EDI Status 2
     C                     MOVELWL0251    WRUXST           EDI Status 3
     C                     MOVELWL0252    WRVSST           Record Status
     C                     Z-ADDWL0253    WRAATM           Job Time
     C                     MOVELWL0254    WRAYNA           User Id
     C                     MOVELWL0255    WRA0NA           Job Name
     C                     Z-ADDWL0256    WRAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WRVSST           Record Status
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
     C           KLCRTM    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C                     KFLD           WRJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRTM    SETLL@KNCPHN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2239' W0RTN   7
      * Send message 'Order Detail Schedule  EX'
     C                     MOVEL'USR2239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@KNCPHN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0557  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0558  3        Warehouse Code
     C                     MOVEL*BLANK    WN0559  3        Order From Ware
     C                     Z-ADD*ZERO     WN0560  70       Item Code
     C                     Z-ADD*ZERO     WN0561 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0562 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0563 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0564 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0565  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0566  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0567  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0568  1        EDI Status 1
     C                     MOVEL*BLANK    WN0569  1        EDI Status 2
     C                     MOVEL*BLANK    WN0570  1        EDI Status 3
     C                     MOVEL*BLANK    WN0571  1        Record Status
     C                     Z-ADD*ZERO     WN0572  60       Job Time
     C                     MOVEL*BLANK    WN0573 10        User Id
     C                     MOVEL*BLANK    WN0574 10        Job Name
     C                     Z-ADD*ZERO     WN0575  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWEAIC3    WRAIC3           Company Number
     C                     Z-ADDWEC4NB    WRC4NB           Order Number
     C                     Z-ADDWEDPNB    WRDPNB           Order Sequence
     C                     Z-ADDWEUENB    WRUENB           Order Secondary
     C                     Z-ADD##JDT     WRJGDT           OD Production D
      *
     C           KLCHTN    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C                     KFLD           WRJGDT           OD Production D
     C           KLCHTN    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YGRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0542    WRIUQT           OD Quantity Inv
     C                     Z-ADDWN0543    WRF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##PGM     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0576  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0577  70       PS Pieces Inv A
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWEAIC3    WSAIC3           Company Number
     C                     MOVEL'S'       WSV5ST           Production Type
     C                     Z-ADD##JDT     WSELDT           Production Date
     C                     Z-ADDWEHGCD    WSHGCD           Item Code
     C                     MOVELWEAJCD    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTO     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSUNW2    ADD  WN0523    WN0576           PS Weight Inv A
      * PS Pieces Inv Allocated
      * CASE: PAR.Piece Count Item is yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Pieces Inv Allocated
      * PAR.PS Pieces Inv Allocated =
      *    *COMPUTE (x1 + (x2 * (x3 * x4)))
      * x1    : DB1.PS Pieces Inv Allocated
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Bags Per Unit
     C           YL0018    MULT YL0019    W0WJ02           *Synon (15,0) w
     C           WN0522    MULT W0WJ02    W0WJ01    H      *Synon (15,0) w
     C           WSCENB    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0577           PS Pieces Inv A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0577           PS Pieces Inv A
     C                     END                             *FI
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
     C                     EXSR TPCHRC
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCHRC    BEGSR
      *================================================================
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0578  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0579  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0580  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0581  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0582  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0583  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0584  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0585  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0586  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0587  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0588  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0589  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0590  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0591  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0592  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0593  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0594  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0595  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0596  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0597  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0598  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0599 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0600  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0601 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0602  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0603 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0604  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0605 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0606  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0607 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0608  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0609 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0610  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0611  3        PS Item Id
     C                     MOVEL*BLANK    WN0612  2        Warehouse Type
     C                     MOVEL*BLANK    WN0613  1        PS Lock Status
     C                     MOVEL*BLANK    WN0614  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0615  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0616  1        PS Piece Count
     C                     MOVEL*BLANK    WN0617  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0618  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0619  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0620  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0621  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0622  3        PS Production W
     C                     Z-ADD*ZERO     WN0623  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0624  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0625  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0626  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0627  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0628  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0629  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0630  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0631  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0632  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0633  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0634  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0635  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0636  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0637  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0638  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0639  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0640  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0641  6        Department Code
     C                     Z-ADD*ZERO     WN0642  30       Item Structure
     C                     Z-ADD*ZERO     WN0643  30       Item Structure
     C                     Z-ADD*ZERO     WN0644  30       Item Structure
     C                     MOVEL*BLANK    WN0645  6        Primal Group Co
     C                     MOVEL*BLANK    WN0646  1        EDI Status 1
     C                     MOVEL*BLANK    WN0647  1        EDI Status 2
     C                     MOVEL*BLANK    WN0648  1        EDI Status 3
     C                     MOVEL*BLANK    WN0649  1        Record Status
     C                     Z-ADD*ZERO     WN0650  60       Job Time
     C                     MOVEL*BLANK    WN0651 10        User Id
     C                     MOVEL*BLANK    WN0652 10        Job Name
     C                     Z-ADD*ZERO     WN0653  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHTP    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHTP    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YHRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0576    WTUNW2           PS Weight Inv A
     C                     Z-ADDWN0577    WTCENB           PS Pieces Inv A
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQTQ01           Company Number
     C           *LIKE     DEFN TAHGCD    WQTQ02           Item Code
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Company Number
     C                     KFLD           WQTQ02           Item Code
      * Setup key
     C                     Z-ADDWL0257    WQTQ01           Company Number
     C                     Z-ADDWL0258    WQTQ02           Item Code
      * Establish starting position
     C           KRSTQ     SETLL@FDREAW                    *
     C           KRSTQ     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0259           Allocation Meth
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTAENST    WL0259           Allocation Meth
     C           KRSTQ     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQTR01           Company Number
     C           *LIKE     DEFN TAHGCD    WQTR02           Item Code
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WQTR02           Item Code
      * Setup key
     C                     Z-ADDWL0260    WQTR01           Company Number
     C                     Z-ADDWL0261    WQTR02           Item Code
      * Establish starting position
     C           KRSTR     SETLL@FDREAW                    *
     C           KRSTR     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * default to "Y"es if rcd not found. user isnt overriding it to No
     C                     MOVEL*BLANK    WL0263           Production Day
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR TSRVGN
      * CASE: LCL.Day of Week is Sunday
     C           YL0054    IFEQ '1'                        *IF
     C                     MOVELTAD0ST    WL0263           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Monday
     C           YL0054    IFEQ '2'                        *IF
     C                     MOVELTAD2ST    WL0263           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Tuesday
     C           YL0054    IFEQ '3'                        *IF
     C                     MOVELTAD6ST    WL0263           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Wednesday
     C           YL0054    IFEQ '4'                        *IF
     C                     MOVELTAWESP    WL0263           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Thursday
     C           YL0054    IFEQ '5'                        *IF
     C                     MOVELTAEDST    WL0263           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Friday
     C           YL0054    IFEQ '6'                        *IF
     C                     MOVELTAEFST    WL0263           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Saturday
     C           YL0054    IFEQ '7'                        *IF
     C                     MOVELTAEHST    WL0263           Production Day
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTR     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TBAIC3    WQTS01           Company Number
     C           *LIKE     DEFN TBBCDT    WQTS02           Post to G/L Dat
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Company Number
     C                     KFLD           WQTS02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0260    WQTS01           Company Number
     C                     Z-ADDWL0262    WQTS02           Post to G/L Dat
      * Establish starting position
     C           KRSTS     SETLL@AFREYY                    *
     C           KRSTS     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELTBA9ST    YL0054           Day of Week
     C           KRSTS     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0666  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0667  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0668  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0669  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0670  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0671  92       Weight Producti
     C                     Z-ADD*ZERO     WN0672  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0673 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0674 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0675  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0269           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0666           PS Weight Ship
     C                     Z-ADD*ZERO     WN0667           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0270           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0271           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0668           Piece Count Ite
     C                     Z-ADD*ZERO     WN0669           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0670           Bags Per Unit
     C                     Z-ADD*ZERO     WN0671           Weight Producti
     C                     Z-ADD*ZERO     WN0672           Pieces Producti
     C                     Z-ADD*ZERO     WN0673           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0674           OD Weight Sched
     C                     Z-ADD*ZERO     WN0675           Pieces Allocate
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0264    WSAIC3           Company Number
     C                     MOVELWL0265    WSV5ST           Production Type
     C                     Z-ADDWL0266    WSELDT           Production Date
     C                     Z-ADDWL0267    WSHGCD           Item Code
     C                     MOVELWL0268    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTT     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * so calc is: Production = Planned Prod + Standard + Prod Adj - Con
      *  instead of:
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WSB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0272    IFGT *ZERO                      *IF
     C           WSELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR TURVGN
     C                     END                             *FI
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           WSWTSP    ADD  WSDXWG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WSD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WSWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WSGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0671           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (15,0) work field
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           WSQTSP    ADD  WSB2NB    W0WJ03           *Synon (15,0) w
     C           W0WJ03    ADD  WSCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WSPSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WSBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0672           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0671    ADD  WN0666    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WSSAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WSOAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0270           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0672    ADD  WN0667    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WSB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WSCDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0271           ATS Pieces Avai
      * Weight Avail E1971 RMC   2/27/12 change to leave pieces if > 0
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WL0270    IFLT *ZERO                      *IF
      * CASE: PAR.ATS Pieces Available USR is LE Zero
     C           WL0271    IFLE *ZERO                      *IF
     C                     Z-ADD*ZERO     WL0270           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0271           ATS Pieces Avai
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWSF8WG    WL0269           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTU01           Company Number
     C           *LIKE     DEFN TCHGCD    WQTU02           Item Code
     C           *LIKE     DEFN TCAJCD    WQTU03           Warehouse Code
     C           *LIKE     DEFN TCELDT    WQTU04           Production Date
     C           *LIKE     DEFN TCV5ST    WQTU05           Production Type
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           Company Number
     C                     KFLD           WQTU02           Item Code
     C                     KFLD           WQTU03           Warehouse Code
     C                     KFLD           WQTU04           Production Date
     C                     KFLD           WQTU05           Production Type
      * Setup key
     C                     Z-ADDWSAIC3    WQTU01           Company Number
     C                     Z-ADDWSHGCD    WQTU02           Item Code
     C                     MOVELWSAJCD    WQTU03           Warehouse Code
     C                     Z-ADDWSGPDT    WQTU04           Production Date
     C                     MOVEL'P'       WQTU05           Production Type
      * Establish starting position
     C           KRSTU     SETLL@I8CPXP                    *
     C           KRSTU     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0666           PS Weight Ship
     C                     Z-ADD*ZERO     WN0667           PS Pieces Ship
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTCE0WG    WN0666           PS Weight Ship
     C                     Z-ADDTCD6NB    WN0667           PS Pieces Ship
     C           KRSTU     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0676 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0677 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0678 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0679 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0680 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0681 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0682  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0683  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0684  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0685  1        EDI Status 1
     C                     MOVEL*BLANK    WN0686  1        EDI Status 2
     C                     MOVEL*BLANK    WN0687  1        EDI Status 3
     C                     MOVEL*BLANK    WN0688  1        Record Status
     C                     Z-ADD*ZERO     WN0689  60       Job Time
     C                     MOVEL*BLANK    WN0690 10        User Id
     C                     MOVEL*BLANK    WN0691 10        Job Name
     C                     Z-ADD*ZERO     WN0692  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0273    WEAIC3           Company Number
     C                     Z-ADDWL0274    WEC4NB           Order Number
     C                     Z-ADDWL0275    WEDPNB           Order Sequence
     C                     Z-ADDWL0276    WEUENB           Order Secondary
     C                     Z-ADDWL0277    WEJGDT           OD Production D
      * Establish starting position
     C           KRSTV     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0273    WL0231           Company Number
     C                     Z-ADDWL0274    WL0232           Order Number
     C                     Z-ADDWL0275    WL0233           Order Sequence
     C                     Z-ADDWL0276    WL0234           Order Secondary
     C                     Z-ADDWL0277    WL0235           OD Production D
     C                     Z-ADDWL0278    WL0236           Scheduled Ship
     C                     MOVELWL0279    WL0237    P      Warehouse Code
     C                     MOVELWL0280    WL0238    P      Order From Ware
     C                     Z-ADDWL0281    WL0239           Item Code
     C                     Z-ADDWL0283    WL0240           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0282    WL0241           OD Weight Sched
     C                     Z-ADDWN0678    WL0242           OD Quantity Inv
     C                     Z-ADDWN0679    WL0243           OD Weight Inv S
     C                     Z-ADDWN0680    WL0244           OD Quantity Unu
     C                     Z-ADDWN0681    WL0245           OD Unused weigh
     C                     MOVELWN0682    WL0246    P      OD Added to Sch
     C                     MOVELWN0683    WL0247    P      OD Reallocate S
     C                     MOVELWN0684    WL0248    P      OD Status Unuse
     C                     MOVELWN0685    WL0249    P      EDI Status 1
     C                     MOVELWN0686    WL0250    P      EDI Status 2
     C                     MOVELWN0687    WL0251    P      EDI Status 3
     C                     MOVELWN0688    WL0252    P      Record Status
     C                     Z-ADDWN0689    WL0253           Job Time
     C                     MOVELWN0690    WL0254    P      User Id
     C                     MOVELWN0691    WL0255    P      Job Name
     C                     Z-ADDWN0692    WL0256           Job Date
     C                     EXSR TMCRRC
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEIGQT    ADD  WL0283    WN0676           OD Qty/Cnsmd Pi
     C           WEFLWG    ADD  WL0282    WN0677           OD Weight Sched
     C                     MOVELWEP7ST    YL0055           OD Added to Sch
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           WL0284    IFEQ 'C'                        *IF
     C           WL0284    OREQ 'F'
      * CASE: PAR.OD Production Date EQ JOB.*Job date
     C           WL0277    IFEQ ##JDT                      *IF
     C                     MOVEL'Y'       YL0055           OD Added to Sch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.OD Quantity Scheduled is Greater than zero
     C           WN0676    IFGT *ZERO                      *IF
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0199           Company Number
     C                     Z-ADDWEC4NB    WL0200           Order Number
     C                     Z-ADDWEDPNB    WL0201           Order Sequence
     C                     Z-ADDWEUENB    WL0202           Order Secondary
     C                     Z-ADDWEJGDT    WL0203           OD Production D
     C                     Z-ADDWN0676    WL0204           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0677    WL0205           OD Weight Sched
     C                     Z-ADDWEIUQT    WL0206           OD Quantity Inv
     C                     Z-ADDWEF3WG    WL0207           OD Weight Inv S
     C                     MOVELYL0055    WL0208    P      OD Added to Sch
     C                     EXSR TACHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0056           Company Number
     C                     Z-ADDWEC4NB    WL0057           Order Number
     C                     Z-ADDWEDPNB    WL0058           Order Sequence
     C                     Z-ADDWEUENB    WL0059           Order Secondary
     C                     Z-ADDWEJGDT    WL0060           OD Production D
     C                     EXSR SPDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDAIC3    WQTW01           Company Number
      * Define keylist
     C           KPSTW     KLIST
     C                     KFLD           WQTW01           Company Number
     C                     KFLD           TDBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WQTW01           Company Number
      * Setup key
     C                     Z-ADDWL0285    WQTW01           Company Number
     C                     Z-ADDWL0286    TDBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTW     SETLL@AFREPU                    *
     C           KRSTW     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0286    IFEQ TDBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0289                     *IF
     C                     Z-ADDTDBCDT    WL0287           *Date1 (ending)
     C                     GOTO TWEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTW     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TBAIC3    WQTX01           Company Number
      * Define keylist
     C           KPSTX     KLIST
     C                     KFLD           WQTX01           Company Number
     C                     KFLD           TBBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           Company Number
      * Setup key
     C                     Z-ADDWL0290    WQTX01           Company Number
     C                     Z-ADDWL0291    TBBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTX     SETLL@AFREYY                    *
     C           KRSTX     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0291    IFEQ TBBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0294                     *IF
     C                     Z-ADDTBBCDT    WL0292           *Date1 (ending)
     C                     GOTO TXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTX     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WAOFNY           ODBS New Prod H
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATNDT           Production AgeD
     C                     Z-ADD*ZERO     WATODT           Production AgeD
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Production Lead
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WBILNB           Packages per ca
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           Package Level s
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WDDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WDDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WDGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEJGDT           OD Production D
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WEFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WEIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WEF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WEIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WEF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFJGDT           OD Production D
     C                     Z-ADD*ZERO     WFOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WFFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WFNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WFJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHJGDT           OD Production D
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WHF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WJCQNB           Julian Date
     C                     Z-ADD*ZERO     WJESNB           Accounting Year
     C                     Z-ADD*ZERO     WJETNB           Accounting Peri
     C                     Z-ADD*ZERO     WJBZNB           OM Week
     C                     Z-ADD*ZERO     WJEINB           Week Number
     C                     Z-ADD*ZERO     WJAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WJOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WJNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WJNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WJOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WJOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WKA0DT           Order Date
     C                     Z-ADD*ZERO     WKA5DT           Requested Ship
     C                     Z-ADD*ZERO     WKGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WKACDT           Cancel Date
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKCXDT           Date of Origina
     C                     Z-ADD*ZERO     WKJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WKA1WG           Order Weight To
     C                     Z-ADD*ZERO     WKEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WKAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WKATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WKRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WKT3NB           Attach to Order
     C                     Z-ADD*ZERO     WKCONB           Invoice Number
     C                     Z-ADD*ZERO     WKAWDT           Invoice Date
     C                     Z-ADD*ZERO     WKVRVA           A/R order Value
     C                     Z-ADD*ZERO     WKB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WKNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WKNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WKNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WKNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WKNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WKBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WKBQTM           Time of Origina
     C                     Z-ADD*ZERO     WKBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WKBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WKBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WKH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WKH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WKH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WKH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WKH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WKC0C7           Claim Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field ATS Quantity Need USR
     C                     Z-ADD*ZERO     WUHWQT 112
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WOHVHD           Hog Volume
     C                     Z-ADD*ZERO     WOZ6NB           Average Live We
     C                     Z-ADD*ZERO     WOZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WODGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WOAVCW           Average Cold We
     C                     Z-ADD*ZERO     WODIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WOZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WOAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WOECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSELDT           Production Date
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WSWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WSQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WSDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WSF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WSWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WSD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WSDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WSB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WSWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WSPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WSSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WSB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WSD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WSCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WSEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WSCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WSE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WSD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WSOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WSCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WSUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WSCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WSF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WSBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WSGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WSBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WSD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WSFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WSD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WSDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WSEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WSSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WSEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WSAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WSECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WSWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WSEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WSFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WSEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WSQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WSEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WSWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WSEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WSRGNB           Item Structure
     C                     Z-ADD*ZERO     WSRHNB           Item Structure
     C                     Z-ADD*ZERO     WSRINB           Item Structure
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field Pieces Allocated USR
     C                     Z-ADD*ZERO     WUPCAL  70
      * Define work field ATS Weight Available USR
     C                     Z-ADD*ZERO     WUEOWG 112
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWHGCD           Item Code
     C                     Z-ADD*ZERO     WWC9NB           Component Item
     C                     Z-ADD*ZERO     WWBOPR           Sales Yield
     C                     Z-ADD*ZERO     WWBPPR           Production Yiel
     C                     Z-ADD*ZERO     WWHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WWCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WWBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WWBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WWIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WWIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Define work field Weight Deallocate USR
     C                     Z-ADD*ZERO     WUF1WG  92
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXHGCD           Item Code
     C                     Z-ADD*ZERO     WXELDT           Production Date
     C                     Z-ADD*ZERO     WXACWG           Quantity on Han
     C                     Z-ADD*ZERO     WXARQT           Quantity on Han
     C                     Z-ADD*ZERO     WXK7DT           Label Date
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAHGCD           Item Code
     C                     Z-ADD*ZERO     TAOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     TAORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     TAS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     TAMJDT           Create Date
     C                     Z-ADD*ZERO     TABETM           Create Time
     C                     Z-ADD*ZERO     TAMKDT           Change Date
     C                     Z-ADD*ZERO     TABFTM           Change Time
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  6
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  52
      * Define local variables for subroutine SGDLRC.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  30
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  30
      * Define local variables for subroutine SIDLRC.
     C                     Z-ADD*ZERO     WL0041  30
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043  30
     C                     Z-ADD*ZERO     WL0044  30
     C                     Z-ADD*ZERO     WL0045  70
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0046  30
     C                     Z-ADD*ZERO     WL0047  70
     C                     MOVEL*BLANK    WL0048  1
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0049  3
     C                     MOVEL*BLANK    WL0050  3
     C                     Z-ADD*ZERO     WL0051  30
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0052  30
     C                     MOVEL*BLANK    WL0053  1
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  1
      * Define local variables for subroutine SPDLRC.
     C                     Z-ADD*ZERO     WL0056  30
     C                     Z-ADD*ZERO     WL0057  70
     C                     Z-ADD*ZERO     WL0058  30
     C                     Z-ADD*ZERO     WL0059  30
     C                     Z-ADD*ZERO     WL0060  70
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0061  30
     C                     MOVEL*BLANK    WL0062  1
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064  70
     C                     MOVEL*BLANK    WL0065  3
     C                     Z-ADD*ZERO     WL0066  92
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068  92
     C                     Z-ADD*ZERO     WL0069  92
     C                     Z-ADD*ZERO     WL0070  70
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0071  30
     C                     MOVEL*BLANK    WL0072  1
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  70
     C                     MOVEL*BLANK    WL0075  3
     C                     Z-ADD*ZERO     WL0076  92
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  30
     C                     Z-ADD*ZERO     WL0080  30
     C                     MOVEL*BLANK    WL0081  1
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0082  30
     C                     MOVEL*BLANK    WL0083  1
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  70
     C                     MOVEL*BLANK    WL0086  3
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088  92
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  72
     C                     Z-ADD*ZERO     WL0091  92
     C                     Z-ADD*ZERO     WL0092  92
     C                     Z-ADD*ZERO     WL0093  70
     C                     Z-ADD*ZERO     WL0094  92
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  92
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  92
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  92
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  92
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104  92
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  92
     C                     Z-ADD*ZERO     WL0107  70
     C                     Z-ADD*ZERO     WL0108  92
     C                     Z-ADD*ZERO     WL0109  70
     C                     Z-ADD*ZERO     WL0110 112
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112 112
     C                     Z-ADD*ZERO     WL0113  70
     C                     Z-ADD*ZERO     WL0114 112
     C                     Z-ADD*ZERO     WL0115  70
     C                     Z-ADD*ZERO     WL0116 112
     C                     Z-ADD*ZERO     WL0117  70
     C                     Z-ADD*ZERO     WL0118 112
     C                     Z-ADD*ZERO     WL0119  70
     C                     Z-ADD*ZERO     WL0120 112
     C                     Z-ADD*ZERO     WL0121  70
     C                     MOVEL*BLANK    WL0122  3
     C                     MOVEL*BLANK    WL0123  2
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     MOVEL*BLANK    WL0128  1
     C                     MOVEL*BLANK    WL0129  1
     C                     MOVEL*BLANK    WL0130  1
     C                     MOVEL*BLANK    WL0131  1
     C                     MOVEL*BLANK    WL0132  2
     C                     MOVEL*BLANK    WL0133  3
     C                     Z-ADD*ZERO     WL0134  92
     C                     Z-ADD*ZERO     WL0135  70
     C                     Z-ADD*ZERO     WL0136  92
     C                     Z-ADD*ZERO     WL0137  70
     C                     Z-ADD*ZERO     WL0138  92
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140  92
     C                     Z-ADD*ZERO     WL0141  70
     C                     Z-ADD*ZERO     WL0142  92
     C                     Z-ADD*ZERO     WL0143  70
     C                     Z-ADD*ZERO     WL0144  92
     C                     Z-ADD*ZERO     WL0145  70
     C                     Z-ADD*ZERO     WL0146  92
     C                     Z-ADD*ZERO     WL0147  70
     C                     Z-ADD*ZERO     WL0148  92
     C                     Z-ADD*ZERO     WL0149  70
     C                     Z-ADD*ZERO     WL0150  92
     C                     Z-ADD*ZERO     WL0151  70
     C                     MOVEL*BLANK    WL0152  6
     C                     Z-ADD*ZERO     WL0153  30
     C                     Z-ADD*ZERO     WL0154  30
     C                     Z-ADD*ZERO     WL0155  30
     C                     MOVEL*BLANK    WL0156  6
     C                     MOVEL*BLANK    WL0157  1
     C                     MOVEL*BLANK    WL0158  1
     C                     MOVEL*BLANK    WL0159  1
     C                     MOVEL*BLANK    WL0160  1
     C                     Z-ADD*ZERO     WL0161  60
     C                     MOVEL*BLANK    WL0162 10
     C                     MOVEL*BLANK    WL0163 10
     C                     Z-ADD*ZERO     WL0164  70
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0165  30
     C                     Z-ADD*ZERO     WL0166  70
     C                     Z-ADD*ZERO     WL0167  52
     C                     Z-ADD*ZERO     WL0168  70
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0169  30
     C                     Z-ADD*ZERO     WL0170  70
     C                     Z-ADD*ZERO     WL0171  30
     C                     Z-ADD*ZERO     WL0172  30
     C                     Z-ADD*ZERO     WL0173  70
     C                     Z-ADD*ZERO     WL0174  30
     C                     Z-ADD*ZERO     WL0175  70
     C                     Z-ADD*ZERO     WL0176  70
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0177  30
     C                     Z-ADD*ZERO     WL0178  70
     C                     Z-ADD*ZERO     WL0179  30
     C                     Z-ADD*ZERO     WL0180  30
     C                     Z-ADD*ZERO     WL0181  70
     C                     Z-ADD*ZERO     WL0182  30
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0183  30
     C                     Z-ADD*ZERO     WL0184  70
     C                     Z-ADD*ZERO     WL0185  30
     C                     Z-ADD*ZERO     WL0186  30
     C                     Z-ADD*ZERO     WL0187  70
     C                     Z-ADD*ZERO     WL0188  30
     C                     Z-ADD*ZERO     WL0189  70
     C                     MOVEL*BLANK    WL0190  3
     C                     Z-ADD*ZERO     WL0191  70
     C                     Z-ADD*ZERO     WL0192  70
     C                     Z-ADD*ZERO     WL0193 112
     C                     Z-ADD*ZERO     WL0194 112
     C                     Z-ADD*ZERO     WL0195  50
     C                     Z-ADD*ZERO     WL0196  92
     C                     Z-ADD*ZERO     WL0197  70
     C                     Z-ADD*ZERO     WL0198  60
      * Define local variables for subroutine TACHRC.
     C                     Z-ADD*ZERO     WL0199  30
     C                     Z-ADD*ZERO     WL0200  70
     C                     Z-ADD*ZERO     WL0201  30
     C                     Z-ADD*ZERO     WL0202  30
     C                     Z-ADD*ZERO     WL0203  70
     C                     Z-ADD*ZERO     WL0204 112
     C                     Z-ADD*ZERO     WL0205 112
     C                     Z-ADD*ZERO     WL0206 112
     C                     Z-ADD*ZERO     WL0207 112
     C                     MOVEL*BLANK    WL0208  1
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0209  30
     C                     Z-ADD*ZERO     WL0210  70
     C                     Z-ADD*ZERO     WL0211  52
     C                     MOVEL*BLANK    WL0212  1
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0213  30
     C                     MOVEL*BLANK    WL0214  1
     C                     Z-ADD*ZERO     WL0215  70
     C                     Z-ADD*ZERO     WL0216  70
     C                     MOVEL*BLANK    WL0217  3
     C                     Z-ADD*ZERO     WL0218  70
     C                     Z-ADD*ZERO     WL0219 112
      * Define local variables for subroutine TERVGN.
     C                     Z-ADD*ZERO     WL0220  30
     C                     MOVEL*BLANK    WL0221  1
     C                     Z-ADD*ZERO     WL0222  70
     C                     Z-ADD*ZERO     WL0223  70
     C                     MOVEL*BLANK    WL0224  3
     C                     Z-ADD*ZERO     WL0225  92
     C                     Z-ADD*ZERO     WL0226  70
     C                     Z-ADD*ZERO     WL0227  70
     C                     Z-ADD*ZERO     WL0228  30
     C                     Z-ADD*ZERO     WL0229  30
     C                     MOVEL*BLANK    WL0230  1
      * Define local variables for subroutine TMCRRC.
     C                     Z-ADD*ZERO     WL0231  30
     C                     Z-ADD*ZERO     WL0232  70
     C                     Z-ADD*ZERO     WL0233  30
     C                     Z-ADD*ZERO     WL0234  30
     C                     Z-ADD*ZERO     WL0235  70
     C                     Z-ADD*ZERO     WL0236  70
     C                     MOVEL*BLANK    WL0237  3
     C                     MOVEL*BLANK    WL0238  3
     C                     Z-ADD*ZERO     WL0239  70
     C                     Z-ADD*ZERO     WL0240 112
     C                     Z-ADD*ZERO     WL0241 112
     C                     Z-ADD*ZERO     WL0242 112
     C                     Z-ADD*ZERO     WL0243 112
     C                     Z-ADD*ZERO     WL0244 112
     C                     Z-ADD*ZERO     WL0245 112
     C                     MOVEL*BLANK    WL0246  1
     C                     MOVEL*BLANK    WL0247  1
     C                     MOVEL*BLANK    WL0248  2
     C                     MOVEL*BLANK    WL0249  1
     C                     MOVEL*BLANK    WL0250  1
     C                     MOVEL*BLANK    WL0251  1
     C                     MOVEL*BLANK    WL0252  1
     C                     Z-ADD*ZERO     WL0253  60
     C                     MOVEL*BLANK    WL0254 10
     C                     MOVEL*BLANK    WL0255 10
     C                     Z-ADD*ZERO     WL0256  70
      * Define local variables for subroutine TQRVGN.
     C                     Z-ADD*ZERO     WL0257  30
     C                     Z-ADD*ZERO     WL0258  70
     C                     MOVEL*BLANK    WL0259  1
      * Define local variables for subroutine TRRVGN.
     C                     Z-ADD*ZERO     WL0260  30
     C                     Z-ADD*ZERO     WL0261  70
     C                     Z-ADD*ZERO     WL0262  70
     C                     MOVEL*BLANK    WL0263  1
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0264  30
     C                     MOVEL*BLANK    WL0265  1
     C                     Z-ADD*ZERO     WL0266  70
     C                     Z-ADD*ZERO     WL0267  70
     C                     MOVEL*BLANK    WL0268  3
     C                     Z-ADD*ZERO     WL0269  92
     C                     Z-ADD*ZERO     WL0270 112
     C                     Z-ADD*ZERO     WL0271  70
     C                     Z-ADD*ZERO     WL0272  52
      * Define local variables for subroutine TVRVGN.
     C                     Z-ADD*ZERO     WL0273  30
     C                     Z-ADD*ZERO     WL0274  70
     C                     Z-ADD*ZERO     WL0275  30
     C                     Z-ADD*ZERO     WL0276  30
     C                     Z-ADD*ZERO     WL0277  70
     C                     Z-ADD*ZERO     WL0278  70
     C                     MOVEL*BLANK    WL0279  3
     C                     MOVEL*BLANK    WL0280  3
     C                     Z-ADD*ZERO     WL0281  70
     C                     Z-ADD*ZERO     WL0282  92
     C                     Z-ADD*ZERO     WL0283 112
     C                     MOVEL*BLANK    WL0284  2
      * Define local variables for subroutine TWRVGN.
     C                     Z-ADD*ZERO     WL0285  30
     C                     Z-ADD*ZERO     WL0286  70
     C                     Z-ADD*ZERO     WL0287  70
     C                     Z-ADD*ZERO     WL0288  70
     C                     Z-ADD*ZERO     WL0289  80
      * Define local variables for subroutine TXRVGN.
     C                     Z-ADD*ZERO     WL0290  30
     C                     Z-ADD*ZERO     WL0291  70
     C                     Z-ADD*ZERO     WL0292  70
     C                     Z-ADD*ZERO     WL0293  70
     C                     Z-ADD*ZERO     WL0294  80
      * Define local work field U/M - Primary
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0003  52
      * Define local work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0011  52
      * Define local work field U/M - Primary
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0013 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0014  52
      * Define local work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0020  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0022  52
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0025  40
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0029 112
      * Define local work field ATS Quantity Need USR
     C                     Z-ADD*ZERO     YL0030 112
      * Define local work field ATS Weight Need USR
     C                     Z-ADD*ZERO     YL0031 112
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0032  3
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0034  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0035  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0036  30
      * Define local work field ODS Sequence Number
     C                     Z-ADD*ZERO     YL0037  30
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0038 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0039 112
      * Define local work field Chilling Time USR
     C                     Z-ADD*ZERO     YL0040  52
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0041  70
      * Define local work field Production Date RGT
     C                     Z-ADD*ZERO     YL0042  70
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0043 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0044 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0045 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0046 112
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0048  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0049  30
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field Production Date To
     C                     Z-ADD*ZERO     YL0051  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Production Day Status USR
     C                     MOVEL*BLANK    YL0053  1
      * Define null work field Accounting Period Code
     C                     Z-ADD*ZERO     YN0001  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0054  1
      * Define null work field Week Number
     C                     Z-ADD*ZERO     YN0002  20
      * Define local work field OD Added to Sched Today
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0056  70
      * Define local work field Allocation Method USR
     C                     MOVEL*BLANK    YL0057  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ORDREALC
00002 SCHASORD
