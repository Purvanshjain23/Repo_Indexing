     H*OPTION(*SRCSTMT : *NODEBUGIO)
     H DFTACTGRP(*NO)
     H BNDDIR('RDB2000')
       //----------------------------------------------------------------------
       // Program To Get F0006 Records from E1 and Insert into EZ0006 Wordld
       // Programmer  :RST SoLution
       // Date : 5/8/20
       //----------------------------------------------------------------------
      //*******************************************************************************
     FEZ0006L0  UF A E           K DISK
     FF55PICK   IF A E             DISK
     FF55CONFIG1IF   E           K DISK
      // RDB Example program
      //
      // This program provides and example of the use of the RDB APIs
      //*******************************************************************************
      /COPY RDB50/RDBSRC,RDBPROTO
     D Id              S             10I 0
     D rc              S             10I 0
     D @ErrId          S              7A
     D @ErrText        S            100A
     D vBatch          S              8  0 inz
     D $$DOC           S             10  0 inz
     D vBatch1         S             15A
     D X_A7            S             30A   inz
     D X_A8            S             30A   inz
     d sFileSchema     s             30a   inz
     C     BLKY01        KLIST
     C                   KFLD                    BLMCU
     C                   KFLD                    BLACTS
      //
      //     Connect to the remote system using created in the RDB
      //     configuration screen (RDBCFG)
      /FREE
           setll *start F55CONFIG1;
           READ F55CONFIG1;
           Dow Not %EOF(F55CONFIG1);
           X_A7=%TRIML(%TRIMR(S2DL01));
           X_A8=%TRIML(%TRIMR(S2DL02));
           READ F55CONFIG1;
           EndDo;
           BLACTS=%TIMESTAMP();                                                 //|Get a number
       Id = RdbConnect(X_A7);
       If Id >= 0;
         sFileSchema = '[' + %trimr(X_A8) + '].[F580911F]';
         //     After the connection is established, prepare the statement.
         rc = RdbPrepStmt(Id:
             'Select * from' + %trimr(sFileSchema) +
             ' where FFEV01 = ?' +
             ' and FFPID = ?');
         rc = RdbSetStr(Id: 1: '1');
         rc = RdbSetStr(Id: 2: 'R580006');
         rc = RdbPrepExec(Id);
         //     Fetch the first record of the result set that was generated with the
         //     previously executed statement.
         rc = RdbFetchNxt(Id);
          //  Load the local variables from the remote server.  The get ty  pe must match
          // the remote type and the local variable.
         dow  rc >= 0;
           SSUKID= RdbGetNum(Id:1);                                             //|Get a number
           WRITE I55PICK;                                                       //|Get a number
           rc = RdbFetchNxt(Id);
         enddo;
       EndIf;
         //
         //-------------------------------
         // Free the Statement
         //-------------------------------
           RdbFreeStmt(id);
           sFileSchema = '[' + %trimr(X_A8) + '].[F580006]';
           setll *start F55PICK;
           READ F55PICK;
           Dow Not %EOF(F55PICK);
           vBatch=SSUKID;
           vBatch1=%CHAR(SSUKID);
         //
         //     After the connection is established, prepare the statement.
         rc = RdbPrepStmt(Id:
             'Select * from' + %trimr(sFileSchema) +
             ' where MCUKID = ?');
         //     Set the value of the first parameter as a Date
         rc = RdbSetNum(Id: 1: SSUKID);
         rc = RdbPrepExec(Id);
         //
         rc = RdbFetchNxt(Id);
          //  Load the local variables from the remote server.  The get ty  pe must match
          // the remote type and the local variable.
         dow  rc >= 0;
           BLMCU= RdbGetStr(Id:2);                                              //|Get a number
           BLSTYL= RdbGetStr(Id:3);                                             //|Get a String
           BLDC  = RdbGetStr(Id:4);
           BLLDM = RdbGetStr(Id:5);                                             //|Get a Timestamp
           BLCO   = RdbGetStr(Id:6);
           BLAN8  = RdbGetNum(Id:7);
           BLAN8O = RdbGetNum(Id:8);
           BLCNTY = RdbGetStr(Id:9);
           BLADDS= RdbGetStr(Id:10);
           BLFMOD= RdbGetStr(Id:11);
           BLDL01= RdbGetStr(Id:12);
           BLDL02= RdbGetStr(Id:13);
           BLDL03= RdbGetStr(Id:14);
           BLDL04= RdbGetStr(Id:15);
           BLRP01 = RdbGetStr(Id:16);
           BLRP02 = RdbGetStr(Id:17);
           BLRP03 = RdbGetStr(Id:18);
           BLRP04= RdbGetStr(Id:19);
           BLRP05=RdbGetStr(Id:20);
           BLRP06=RdbGetStr(Id:21);
           BLRP07=RdbGetStr(Id:22);
           BLRP08 = RdbGetStr(Id:23);
           BLRP09 = RdbGetStr(Id:24);
           BLRP10= RdbGetStr(Id:25);
           BLRP11= RdbGetStr(Id:26);
           BLRP12= RdbGetStr(Id:27);
           BLRP13= RdbGetStr(Id:28);
           BLRP14= RdbGetStr(Id:29);
           BLRP15= RdbGetStr(Id:30);
           BLRP16= RdbGetStr(Id:31);
           BLRP17= RdbGetStr(Id:32);
           BLRP18= RdbGetStr(Id:33);
           BLRP19 = RdbGetStr(Id:34);
           BLRP20 = RdbGetStr(Id:35);
           BLRP21 = RdbGetStr(Id:36);
           BLRP22 = RdbGetStr(Id:37);
           BLRP23 = RdbGetStr(Id:38);
           BLRP24 = RdbGetStr(Id:39);
           BLRP25 = RdbGetStr(Id:40);
           BLRP26 = RdbGetStr(Id:41);
           BLRP27 = RdbGetStr(Id:42);
           BLRP28 = RdbGetStr(Id:43);
           BLRP29 = RdbGetStr(Id:44);
           BLRP30 = RdbGetStr(Id:45);
           BLTA = RdbGetStr(Id:46);
           BLTXJS = RdbGetNum(Id:47);
           BLTXA1 = RdbGetStr(Id:48);
           BLEXR1 = RdbGetStr(Id:49);
           BLTC01 = RdbGetStr(Id:50);
           BLTC02 = RdbGetStr(Id:51);
           BLTC03 = RdbGetStr(Id:52);
           BLTC04= RdbGetStr(Id:53);
           BLTC05=RdbGetStr(Id:54);
           BLTC06= RdbGetStr(Id:55);
           BLTC07= RdbGetStr(Id:56);
           BLTC08= RdbGetStr(Id:57);
           BLBDCD=RdbGetStr(Id:58);
           BLTC10=RdbGetStr(Id:59);
           BLND01=RdbGetStr(Id:60);
           BLND02= RdbGetStr(Id:61);
           BLND03=RdbGetStr(Id:62);
           BLND04=RdbGetStr(Id:63);
           BLND05=RdbGetStr(Id:64);
           BLND06= RdbGetStr(Id:65);
           BLND07=RdbGetStr(Id:66);
           BLND08=RdbGetStr(Id:67);
           BLND09=RdbGetStr(Id:68);
           BLND10=RdbGetStr(Id:69);
           BLCC01=RdbGetStr(Id:70);
           BLCC02=RdbGetStr(Id:71);
           BLCC03=RdbGetStr(Id:72);
           BLCC04=RdbGetStr(Id:73);
           BLCC05=RdbGetStr(Id:74);
           BLCC06=RdbGetStr(Id:75);
           BLG1ST=RdbGetStr(Id:76);
           BLG2ST=RdbGetStr(Id:77);
           BLG3ST=RdbGetStr(Id:78);
           BLG4ST=RdbGetStr(Id:79);
           BLPECC=RdbGetStr(Id:80);
           BLCALS=RdbGetStr(Id:81);
           BLCISS=RdbGetStr(Id:82);
           BLGLBA=RdbGetStr(Id:83);
           BLALCL=RdbGetStr(Id:84);
           BLLMTH=RdbGetStr(Id:85);
           BLLF  =RdbGetNum(Id:86);
           BLOBJ1=RdbGetStr(Id:87);
           BLOBJ2=RdbGetStr(Id:88);
           BLOBJ3=RdbGetStr(Id:89);
           BLSUB1=RdbGetStr(Id:90);
           BLTOU =RdbGetNum(Id:91);
           BLSBLI=RdbGetStr(Id:92);
           BLANPA=RdbGetNum(Id:93);
           BLCT  =RdbGetStr(Id:94);
           BLCERT=RdbGetStr(Id:95);
           BLMCUS=RdbGetStr(Id:96);
           BLBTYP=RdbGetStr(Id:97);
           BLPC  =RdbGetNum(Id:98);
           BLPCA =RdbGetNum(Id:99);
           BLPCC =RdbGetNum(Id:100);
           BLINTA=RdbGetStr(Id:101);
           BLINTL=RdbGetStr(Id:102);
           BLD1J =RdbGetNum(Id:103);
           BLD2J =RdbGetNum(Id:104);
           BLD3J =RdbGetNum(Id:105);
           BLD4J =RdbGetNum(Id:106);
           BLD5J =RdbGetNum(Id:107);
           BLD6J =RdbGetNum(Id:108);
           BLFPDJ=RdbGetNum(Id:109);
           BLCAC =RdbGetNum(Id:110);
           BLPAC =RdbGetNum(Id:111);
           BLEEO =RdbGetStr(Id:112);
           BLERC =RdbGetStr(Id:113);
           BLUSER=RdbGetStr(Id:114);
           BLPID =RdbGetStr(Id:115);
           BLUPMJ=RdbGetNum(Id:116);
           BLJOBN=RdbGetStr(Id:117);
           BLUPMT=RdbGetNum(Id:118);
           BLBPTP=RdbGetStr(Id:119);
           BLAPSB=RdbGetStr(Id:120);
           BLTSBU=RdbGetStr(Id:121);
           BLRP31=RdbGetStr(Id:122);
           BLRP32=RdbGetStr(Id:123);
           BLRP33=RdbGetStr(Id:124);
           BLRP34=RdbGetStr(Id:125);
           BLRP35=RdbGetStr(Id:126);
           BLRP36=RdbGetStr(Id:127);
           BLRP37=RdbGetStr(Id:128);
           BLRP38=RdbGetStr(Id:129);
           BLRP39=RdbGetStr(Id:130);
           BLRP40=RdbGetStr(Id:131);
           BLRP41=RdbGetStr(Id:132);
           BLRP42=RdbGetStr(Id:133);
           BLRP43=RdbGetStr(Id:134);
           BLRP44=RdbGetStr(Id:135);
           BLRP45=RdbGetStr(Id:136);
           BLRP46=RdbGetStr(Id:137);
           BLRP47=RdbGetStr(Id:138);
           BLRP48=RdbGetStr(Id:139);
           BLRP49=RdbGetStr(Id:140);
           BLRP50=RdbGetStr(Id:141);
           BLGCA1=RdbGetNum(Id:142);
           BLGCA2=RdbGetNum(Id:143);
           BLGCA3=RdbGetNum(Id:144);
           BLGCA4=RdbGetNum(Id:145);
           BLGCA5=RdbGetNum(Id:146);
           BLMCU1=RdbGetStr(Id:147);
           BLDOCO=RdbGetNum(Id:148);
           BLPCTN=RdbGetNum(Id:149);
           BLCLNU=RdbGetNum(Id:150);
           BLBUCA=RdbGetStr(Id:151);
           BLADJE=RdbGetStr(Id:152);
           BLUAFL=RdbGetStr(Id:153);
           chain BLKY01 EZ0006L0;
           if not %found(EZ0006L0);
           WRITE @BLCPF7;
           else;
           UPDATE @BLCPF7;
           endIf;
           rc = RdbFetchNxt(Id);
         enddo;
         if rc < 0;
           RdbError(@ErrId: @ErrText);
         endif;
            Read F55PICK;
           EndDo;
         //
         //
         //-------------------------------
         // Free the Statement
         //-------------------------------
           RdbFreeStmt(id);
         sFileSchema = '[' + %trimr(X_A8) + '].[F580911F]';
           setll *start F55PICK;
           READ F55PICK;
           Dow Not %EOF(F55PICK);
         //
         //     After the connection is established, prepare the statement.
         rc = RdbPrepStmt(Id:
             'Update '+ %trimr(sFileSchema) +
             ' set FFEV01 = ? where FFUKID = ?');
         //
         //     Set the value of the first parameter as a Date
         rc = RdbSetNum(Id: 2: SSUKID);
         rc = RdbSetStr(Id: 1: '2');
         rc = RdbPrepExec(Id);
         if rc < 0;
           RdbError(@ErrId: @ErrText);
         endif;
            Read F55PICK;
           EndDo;
         //
         //     Close the connection to the remote system.
         RdbClose(Id);
       //
       *Inlr = *On;
      /END-FREE
