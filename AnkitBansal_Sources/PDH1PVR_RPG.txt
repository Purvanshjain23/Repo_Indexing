     H/TITLE Relocate Item         PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 01/26/24  Time  : 12:32:48
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDH1PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Relocate Item         PV  Prompt & validate record
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FPDL5CPL6IF  E           K        DISK
      * RSQ : Item Lot Location        Co/Whs/Lt/Itm/Lc/Lv/Pd/Sq
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FPDL4REL0IF  E           K        DISK
      * RTV : Item Hold Reason          Retrieval index
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FPDL2REL1IF  E           K        DISK                      A
      * UPD : Warehouse Location        Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB0REL0UF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 017  5 0A
     E                    W0END   7 017  5 0A
     E                    W0NAM   7 017 10
      * Long constants
     E                    @CN#    1  15  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WAAIC3
     I              L7HGCD                          WAHGCD
     I              L7AJCD                          WAAJCD
     I              L7LTRT                          WALTRT
     I              L7LRDT                          WALRDT
     I              L7LLTS                          WALLTS
     I              L7LSDT                          WALSDT
     I              L7J5QT                          WAJ5QT
     I              L7G8WG                          WAG8WG
     I              L7LLTN                          WALLTN
     I              L7YMCD                          WAYMCD
     I              L7LLCL                          WALLCL
     I              L7BNAA                          WABNAA
     I              L7LLTR                          WALLTR
     I              L7Y2CD                          WAY2CD
     I              L7LLTL                          WALLTL
     I              L7C4NB                          WAC4NB
     I              L7LOST                          WALOST
     I              L7LLTU                          WALLTU
     I              L7LLYT                          WALLYT
     I              L7UVST                          WAUVST
     I              L7UWST                          WAUWST
     I              L7UXST                          WAUXST
     I              L7VSST                          WAVSST
     I              L7AATM                          WAAATM
     I              L7AYNA                          WAAYNA
     I              L7A0NA                          WAA0NA
     I              L7AXDT                          WAAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WBAIC3
     I              L7HGCD                          WBHGCD
     I              L7AJCD                          WBAJCD
     I              L7LTRT                          WBLTRT
     I              L7LRDT                          WBLRDT
     I              L7LLTS                          WBLLTS
     I              L7LSDT                          WBLSDT
     I              L7J5QT                          WBJ5QT
     I              L7G8WG                          WBG8WG
     I              L7LLTN                          WBLLTN
     I              L7YMCD                          WBYMCD
     I              L7LLCL                          WBLLCL
     I              L7BNAA                          WBBNAA
     I              L7LLTR                          WBLLTR
     I              L7Y2CD                          WBY2CD
     I              L7LLTL                          WBLLTL
     I              L7C4NB                          WBC4NB
     I              L7LOST                          WBLOST
     I              L7LLTU                          WBLLTU
     I              L7LLYT                          WBLLYT
     I              L7UVST                          WBUVST
     I              L7UWST                          WBUWST
     I              L7UXST                          WBUXST
     I              L7VSST                          WBVSST
     I              L7AATM                          WBAATM
     I              L7AYNA                          WBAYNA
     I              L7A0NA                          WBA0NA
     I              L7AXDT                          WBAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WCAIC3
     I              L5HGCD                          WCHGCD
     I              L5AJCD                          WCAJCD
     I              L5ELDT                          WCELDT
     I              L5LXNM                          WCLXNM
     I              L5YMCD                          WCYMCD
     I              L5YNCD                          WCYNCD
     I              L5J2QT                          WCJ2QT
     I              L5G5WG                          WCG5WG
     I              L5J3QT                          WCJ3QT
     I              L5G6WG                          WCG6WG
     I              L5J4QT                          WCJ4QT
     I              L5G7WG                          WCG7WG
     I              L5LODT                          WCLODT
     I              L5LPDT                          WCLPDT
     I              L5LQDT                          WCLQDT
     I              L5NBR                           WCNBR
     I              L5YTCD                          WCYTCD
     I              L5AMSX                          WCAMSX
     I              L5ASSX                          WCASSX
     I              L5ATSX                          WCATSX
     I              L5AUSX                          WCAUSX
     I              L5YSCD                          WCYSCD
     I              L5UVST                          WCUVST
     I              L5UWST                          WCUWST
     I              L5UXST                          WCUXST
     I              L5VSST                          WCVSST
     I              L5AATM                          WCAATM
     I              L5AYNA                          WCAYNA
     I              L5A0NA                          WCA0NA
     I              L5AXDT                          WCAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WDAIC3
     I              L5HGCD                          WDHGCD
     I              L5AJCD                          WDAJCD
     I              L5ELDT                          WDELDT
     I              L5LXNM                          WDLXNM
     I              L5YMCD                          WDYMCD
     I              L5YNCD                          WDYNCD
     I              L5J2QT                          WDJ2QT
     I              L5G5WG                          WDG5WG
     I              L5J3QT                          WDJ3QT
     I              L5G6WG                          WDG6WG
     I              L5J4QT                          WDJ4QT
     I              L5G7WG                          WDG7WG
     I              L5LODT                          WDLODT
     I              L5LPDT                          WDLPDT
     I              L5LQDT                          WDLQDT
     I              L5NBR                           WDNBR
     I              L5YTCD                          WDYTCD
     I              L5AMSX                          WDAMSX
     I              L5ASSX                          WDASSX
     I              L5ATSX                          WDATSX
     I              L5AUSX                          WDAUSX
     I              L5YSCD                          WDYSCD
     I              L5UVST                          WDUVST
     I              L5UWST                          WDUWST
     I              L5UXST                          WDUXST
     I              L5VSST                          WDVSST
     I              L5AATM                          WDAATM
     I              L5AYNA                          WDAYNA
     I              L5A0NA                          WDA0NA
     I              L5AXDT                          WDAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WEAIC3
     I              B1HGCD                          WEHGCD
     I              B1AJCD                          WEAJCD
     I              B1ELDT                          WEELDT
     I              B1ABWG                          WEABWG
     I              B1AGQT                          WEAGQT
     I              B1AHQT                          WEAHQT
     I              B1AIQT                          WEAIQT
     I              B1CTST                          WECTST
     I              B1ACWG                          WEACWG
     I              B1ARQT                          WEARQT
     I              B1ASQT                          WEASQT
     I              B1ATQT                          WEATQT
     I              B1HDQT                          WEHDQT
     I              B1HEQT                          WEHEQT
     I              B1F6ST                          WEF6ST
     I              B1BMWG                          WEBMWG
     I              B1DSQT                          WEDSQT
     I              B1DTQT                          WEDTQT
     I              B1DUQT                          WEDUQT
     I              B1DHDT                          WEDHDT
     I              B1AGCS                          WEAGCS
     I              B1AECS                          WEAECS
     I              B1IDVA                          WEIDVA
     I              B1K7DT                          WEK7DT
     I              B1RINB                          WERINB
     I              B1RHNB                          WERHNB
     I              B1RGNB                          WERGNB
     I              B1UVST                          WEUVST
     I              B1UWST                          WEUWST
     I              B1UXST                          WEUXST
     I              B1VSST                          WEVSST
     I              B1AATM                          WEAATM
     I              B1AYNA                          WEAYNA
     I              B1A0NA                          WEA0NA
     I              B1AXDT                          WEAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WFAIC3
     I              B1HGCD                          WFHGCD
     I              B1AJCD                          WFAJCD
     I              B1ELDT                          WFELDT
     I              B1ABWG                          WFABWG
     I              B1AGQT                          WFAGQT
     I              B1AHQT                          WFAHQT
     I              B1AIQT                          WFAIQT
     I              B1CTST                          WFCTST
     I              B1ACWG                          WFACWG
     I              B1ARQT                          WFARQT
     I              B1ASQT                          WFASQT
     I              B1ATQT                          WFATQT
     I              B1HDQT                          WFHDQT
     I              B1HEQT                          WFHEQT
     I              B1F6ST                          WFF6ST
     I              B1BMWG                          WFBMWG
     I              B1DSQT                          WFDSQT
     I              B1DTQT                          WFDTQT
     I              B1DUQT                          WFDUQT
     I              B1DHDT                          WFDHDT
     I              B1AGCS                          WFAGCS
     I              B1AECS                          WFAECS
     I              B1IDVA                          WFIDVA
     I              B1K7DT                          WFK7DT
     I              B1RINB                          WFRINB
     I              B1RHNB                          WFRHNB
     I              B1RGNB                          WFRGNB
     I              B1UVST                          WFUVST
     I              B1UWST                          WFUWST
     I              B1UXST                          WFUXST
     I              B1VSST                          WFVSST
     I              B1AATM                          WFAATM
     I              B1AYNA                          WFAYNA
     I              B1A0NA                          WFA0NA
     I              B1AXDT                          WFAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WGAJCD
     I              L2YMCD                          WGYMCD
     I              L2YPCD                          WGYPCD
     I              L2LCBY                          WGLCBY
     I              L2LCCT                          WGLCCT
     I              L2WLUS                          WGWLUS
     I              L2WUSD                          WGWUSD
     I              L2WLUN                          WGWLUN
     I              L2AGSX                          WGAGSX
     I              L2UVST                          WGUVST
     I              L2UWST                          WGUWST
     I              L2UXST                          WGUXST
     I              L2VSST                          WGVSST
     I              L2AATM                          WGAATM
     I              L2AYNA                          WGAYNA
     I              L2A0NA                          WGA0NA
     I              L2AXDT                          WGAXDT
      *
     I@L2RESN
      * Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WHAJCD
     I              L2YMCD                          WHYMCD
     I              L2YPCD                          WHYPCD
     I              L2LCBY                          WHLCBY
     I              L2LCCT                          WHLCCT
     I              L2WLUS                          WHWLUS
     I              L2WUSD                          WHWUSD
     I              L2WLUN                          WHWLUN
     I              L2AGSX                          WHAGSX
     I              L2UVST                          WHUVST
     I              L2UWST                          WHUWST
     I              L2UXST                          WHUXST
     I              L2VSST                          WHVSST
     I              L2AATM                          WHAATM
     I              L2AYNA                          WHAYNA
     I              L2A0NA                          WHA0NA
     I              L2AXDT                          WHAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WIAGSX
     I              MEOPNA                          WIOPNA
     I              MESLTY                          WISLTY
     I              MEAHSX                          WIAHSX
     I              MEAISX                          WIAISX
     I              MEUVST                          WIUVST
     I              MEUWST                          WIUWST
     I              MEUXST                          WIUXST
     I              MEVSST                          WIVSST
     I              MEAATM                          WIAATM
     I              MEAYNA                          WIAYNA
     I              MEA0NA                          WIA0NA
     I              MEAXDT                          WIAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WJAIC3
     I              ASAXNB                          WJAXNB
     I              ASNGNB                          WJNGNB
     I              ASBZNB                          WJBZNB
     I              ASC5NB                          WJC5NB
     I              ASC3NB                          WJC3NB
     I              ASCYNB                          WJCYNB
     I              ASIONB                          WJIONB
     I              ASI6NB                          WJI6NB
     I              ASDCNB                          WJDCNB
     I              ASC7NB                          WJC7NB
     I              ASC2NB                          WJC2NB
     I              ASC1NB                          WJC1NB
     I              ASL8NB                          WJL8NB
     I              ASBANB                          WJBANB
     I              ASCHST                          WJCHST
     I              ASCKST                          WJCKST
     I              ASCIST                          WJCIST
     I              ASCGST                          WJCGST
     I              ASAIPC                          WJAIPC
     I              ASASPC                          WJASPC
     I              ASA2VA                          WJA2VA
     I              ASC2ST                          WJC2ST
     I              ASD8ST                          WJD8ST
     I              ASD7ST                          WJD7ST
     I              ASA8NA                          WJA8NA
     I              ASA9NA                          WJA9NA
     I              ASBANA                          WJBANA
     I              ASBBNA                          WJBBNA
     I              ASEUST                          WJEUST
     I              ASAADY                          WJAADY
     I              ASABDY                          WJABDY
     I              ASACDY                          WJACDY
     I              ASADDY                          WJADDY
     I              ASAEDY                          WJAEDY
     I              ASAFDY                          WJAFDY
     I              ASAGDY                          WJAGDY
     I              ASAHDY                          WJAHDY
     I              ASAENB                          WJAENB
     I              ASALNB                          WJALNB
     I              ASEVNB                          WJEVNB
     I              ASRPOP                          WJRPOP
     I              ASDWNB                          WJDWNB
     I              ASR3NB                          WJR3NB
     I              ASPNST                          WJPNST
     I              ASR4NB                          WJR4NB
     I              ASPOST                          WJPOST
     I              ASSCNB                          WJSCNB
     I              ASVIST                          WJVIST
     I              ASVJST                          WJVJST
     I              ASBVVN                          WJBVVN
     I              ASUVST                          WJUVST
     I              ASUWST                          WJUWST
     I              ASUXST                          WJUXST
     I              ASVSST                          WJVSST
     I              ASAATM                          WJAATM
     I              ASAYNA                          WJAYNA
     I              ASA0NA                          WJA0NA
     I              ASAXDT                          WJAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WKAIC3
     I              BZHGCD                          WKHGCD
     I              BZAVNA                          WKAVNA
     I              BZAWNA                          WKAWNA
     I              BZL7NA                          WKL7NA
     I              BZL8NA                          WKL8NA
     I              BZL6NA                          WKL6NA
     I              BZMFNA                          WKMFNA
     I              BZADCD                          WKADCD
     I              BZAWPC                          WKAWPC
     I              BZLXST                          WKLXST
     I              BZAECD                          WKAECD
     I              BZAXPC                          WKAXPC
     I              BZLYST                          WKLYST
     I              BZAFCD                          WKAFCD
     I              BZAICD                          WKAICD
     I              BZAIWG                          WKAIWG
     I              BZHICD                          WKHICD
     I              BZRBCD                          WKRBCD
     I              BZFZST                          WKFZST
     I              BZAVST                          WKAVST
     I              BZCZWG                          WKCZWG
     I              BZC0WG                          WKC0WG
     I              BZURTN                          WKURTN
     I              BZAJC8                          WKAJC8
     I              BZRINB                          WKRINB
     I              BZRHNB                          WKRHNB
     I              BZRGNB                          WKRGNB
     I              BZLNCD                          WKLNCD
     I              BZTFNB                          WKTFNB
     I              BZN0CD                          WKN0CD
     I              BZX4ST                          WKX4ST
     I              BZTMVA                          WKTMVA
     I              BZTNVA                          WKTNVA
     I              BZBLPR                          WKBLPR
     I              BZBMPR                          WKBMPR
     I              BZLRCD                          WKLRCD
     I              BZU9ST                          WKU9ST
     I              BZCMCO                          WKCMCO
     I              BZQ1CD                          WKQ1CD
     I              BZQ8CD                          WKQ8CD
     I              BZCHTM                          WKCHTM
     I              BZQZCD                          WKQZCD
     I              BZXWST                          WKXWST
     I              BZXXST                          WKXXST
     I              BZVMST                          WKVMST
     I              BZSWGH                          WKSWGH
     I              BZPPHE                          WKPPHE
     I              BZR3CD                          WKR3CD
     I              BZSDCD                          WKSDCD
     I              BZICN1                          WKICN1
     I              BZSVCD                          WKSVCD
     I              BZICN2                          WKICN2
     I              BZSWCD                          WKSWCD
     I              BZV2NB                          WKV2NB
     I              BZSXCD                          WKSXCD
     I              BZITCN                          WKITCN
     I              BZSYCD                          WKSYCD
     I              BZITC5                          WKITC5
     I              BZSZCD                          WKSZCD
     I              BZICN6                          WKICN6
     I              BZS0CD                          WKS0CD
     I              BZICN7                          WKICN7
     I              BZS1CD                          WKS1CD
     I              BZICN8                          WKICN8
     I              BZS2CD                          WKS2CD
     I              BZICN9                          WKICN9
     I              BZS3CD                          WKS3CD
     I              BZICN0                          WKICN0
     I              BZS4CD                          WKS4CD
     I              BZSFNB                          WKSFNB
     I              BZA3WG                          WKA3WG
     I              BZSJNB                          WKSJNB
     I              BZLLCD                          WKLLCD
     I              BZLMCD                          WKLMCD
     I              BZP3ST                          WKP3ST
     I              BZSKNB                          WKSKNB
     I              BZSLNB                          WKSLNB
     I              BZSMNB                          WKSMNB
     I              BZP4ST                          WKP4ST
     I              BZCFNB                          WKCFNB
     I              BZCGNB                          WKCGNB
     I              BZILNB                          WKILNB
     I              BZCHNB                          WKCHNB
     I              BZCINB                          WKCINB
     I              BZCJNB                          WKCJNB
     I              BZCMNB                          WKCMNB
     I              BZCNNB                          WKCNNB
     I              BZCRNB                          WKCRNB
     I              BZCSNB                          WKCSNB
     I              BZCVNB                          WKCVNB
     I              BZCWNB                          WKCWNB
     I              BZCXNB                          WKCXNB
     I              BZCZNB                          WKCZNB
     I              BZC0NB                          WKC0NB
     I              BZN1CD                          WKN1CD
     I              BZB4NB                          WKB4NB
     I              BZB5NB                          WKB5NB
     I              BZX5ST                          WKX5ST
     I              BZX6ST                          WKX6ST
     I              BZX7ST                          WKX7ST
     I              BZPCCT                          WKPCCT
     I              BZBDNB                          WKBDNB
     I              BZBJNB                          WKBJNB
     I              BZSUST                          WKSUST
     I              BZSVST                          WKSVST
     I              BZSYST                          WKSYST
     I              BZSZST                          WKSZST
     I              BZS1ST                          WKS1ST
     I              BZXRCD                          WKXRCD
     I              BZXTCD                          WKXTCD
     I              BZXUCD                          WKXUCD
     I              BZF5WG                          WKF5WG
     I              BZF6WG                          WKF6WG
     I              BZF7WG                          WKF7WG
     I              BZBLNB                          WKBLNB
     I              BZBNNB                          WKBNNB
     I              BZS2ST                          WKS2ST
     I              BZS4ST                          WKS4ST
     I              BZS5ST                          WKS5ST
     I              BZS6ST                          WKS6ST
     I              BZS8ST                          WKS8ST
     I              BZS9ST                          WKS9ST
     I              BZTCST                          WKTCST
     I              BZTDST                          WKTDST
     I              BZUVST                          WKUVST
     I              BZUWST                          WKUWST
     I              BZUXST                          WKUXST
     I              BZVSST                          WKVSST
     I              BZAATM                          WKAATM
     I              BZAYNA                          WKAYNA
     I              BZA0NA                          WKA0NA
     I              BZAXDT                          WKAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WLAIC3
     I              B0HGCD                          WLHGCD
     I              B0AJCD                          WLAJCD
     I              B0AGCS                          WLAGCS
     I              B0AECS                          WLAECS
     I              B0BACS                          WLBACS
     I              B0BBCS                          WLBBCS
     I              B0CBPR                          WLCBPR
     I              B0GUDT                          WLGUDT
     I              B0XYST                          WLXYST
     I              B0CTPR                          WLCTPR
     I              B0G4DT                          WLG4DT
     I              B0BOWG                          WLBOWG
     I              B0DDQT                          WLDDQT
     I              B0DEQT                          WLDEQT
     I              B0DFQT                          WLDFQT
     I              B0HDQT                          WLHDQT
     I              B0HEQT                          WLHEQT
     I              B0AJQT                          WLAJQT
     I              B0AQQT                          WLAQQT
     I              B0AUQT                          WLAUQT
     I              B0EMQT                          WLEMQT
     I              B0DOQT                          WLDOQT
     I              B0ATNA                          WLATNA
     I              B0AKDT                          WLAKDT
     I              B0ANDT                          WLANDT
     I              B0IDVA                          WLIDVA
     I              B0JVST                          WLJVST
     I              B0BZPC                          WLBZPC
     I              B0DGQT                          WLDGQT
     I              B0DIDT                          WLDIDT
     I              B0ALCD                          WLALCD
     I              B0BFDY                          WLBFDY
     I              B0DJDT                          WLDJDT
     I              B0BGDY                          WLBGDY
     I              B0DKDT                          WLDKDT
     I              B0J2ST                          WLJ2ST
     I              B0DJQT                          WLDJQT
     I              B0BNWG                          WLBNWG
     I              B0DLDT                          WLDLDT
     I              B0DPQT                          WLDPQT
     I              B0DQQT                          WLDQQT
     I              B0DMDT                          WLDMDT
     I              B0M0ST                          WLM0ST
     I              B0J9ST                          WLJ9ST
     I              B0KBST                          WLKBST
     I              B0AKC8                          WLAKC8
     I              B0RINB                          WLRINB
     I              B0RHNB                          WLRHNB
     I              B0RGNB                          WLRGNB
     I              B0UVST                          WLUVST
     I              B0UWST                          WLUWST
     I              B0UXST                          WLUXST
     I              B0VSST                          WLVSST
     I              B0AATM                          WLAATM
     I              B0AYNA                          WLAYNA
     I              B0A0NA                          WLA0NA
     I              B0AXDT                          WLAXDT
      *
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                          WMB3AB
     I              C6HUNZ                          WMHUNZ
     I              C6OCSC                          WMOCSC
     I              C6UNU1                          WMUNU1
     I              C6VSST                          WMVSST
     I              C6BGTS                          WMBGTS
     I              C6RUU1                          WMRUU1
     I              C6RVU1                          WMRVU1
     I              C6BHTS                          WMBHTS
     I              C6RWU1                          WMRWU1
     I              C6RXU1                          WMRXU1
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WOAIC3
     I              B7HGCD                          WOHGCD
     I              B7AJCD                          WOAJCD
     I              B7W9ST                          WOW9ST
     I              B7BSST                          WOBSST
     I              B7B4DT                          WOB4DT
     I              B7C4NY                          WOC4NY
     I              B7DXNB                          WODXNB
     I              B7ELDT                          WOELDT
     I              B7HVCD                          WOHVCD
     I              B7F1ST                          WOF1ST
     I              B7AUNA                          WOAUNA
     I              B7A5QT                          WOA5QT
     I              B7AHWG                          WOAHWG
     I              B7AKCS                          WOAKCS
     I              B7CGCD                          WOCGCD
     I              B7AYVA                          WOAYVA
     I              B7BJNA                          WOBJNA
     I              B7CKNB                          WOCKNB
     I              B7BMST                          WOBMST
     I              B7CQCD                          WOCQCD
     I              B7DTCD                          WODTCD
     I              B7MGNA                          WOMGNA
     I              B7TRBN                          WOTRBN
     I              B7TRBS                          WOTRBS
     I              B7C4NB                          WOC4NB
     I              B7RINB                          WORINB
     I              B7RHNB                          WORHNB
     I              B7RGNB                          WORGNB
     I              B7M3NA                          WOM3NA
     I              B7AWTM                          WOAWTM
     I              B7XLCD                          WOXLCD
     I              B7K7DT                          WOK7DT
     I              B7UVST                          WOUVST
     I              B7UWST                          WOUWST
     I              B7UXST                          WOUXST
     I              B7VSST                          WOVSST
     I              B7AATM                          WOAATM
     I              B7AYNA                          WOAYNA
     I              B7A0NA                          WOA0NA
     I              B7AXDT                          WOAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WRAIC3
     I              B7HGCD                          WRHGCD
     I              B7AJCD                          WRAJCD
     I              B7W9ST                          WRW9ST
     I              B7BSST                          WRBSST
     I              B7B4DT                          WRB4DT
     I              B7C4NY                          WRC4NY
     I              B7DXNB                          WRDXNB
     I              B7ELDT                          WRELDT
     I              B7HVCD                          WRHVCD
     I              B7F1ST                          WRF1ST
     I              B7AUNA                          WRAUNA
     I              B7A5QT                          WRA5QT
     I              B7AHWG                          WRAHWG
     I              B7AKCS                          WRAKCS
     I              B7CGCD                          WRCGCD
     I              B7AYVA                          WRAYVA
     I              B7BJNA                          WRBJNA
     I              B7CKNB                          WRCKNB
     I              B7BMST                          WRBMST
     I              B7CQCD                          WRCQCD
     I              B7DTCD                          WRDTCD
     I              B7MGNA                          WRMGNA
     I              B7TRBN                          WRTRBN
     I              B7TRBS                          WRTRBS
     I              B7C4NB                          WRC4NB
     I              B7RINB                          WRRINB
     I              B7RHNB                          WRRHNB
     I              B7RGNB                          WRRGNB
     I              B7M3NA                          WRM3NA
     I              B7AWTM                          WRAWTM
     I              B7XLCD                          WRXLCD
     I              B7K7DT                          WRK7DT
     I              B7UVST                          WRUVST
     I              B7UWST                          WRUWST
     I              B7UXST                          WRUXST
     I              B7VSST                          WRVSST
     I              B7AATM                          WRAATM
     I              B7AYNA                          WRAYNA
     I              B7A0NA                          WRA0NA
     I              B7AXDT                          WRAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WSAJCD
     I              ADF8NA                          WSF8NA
     I              ADACNA                          WSACNA
     I              ADADNA                          WSADNA
     I              ADAENA                          WSAENA
     I              ADAJNA                          WSAJNA
     I              ADBTTX                          WSBTTX
     I              ADAOCD                          WSAOCD
     I              ADBGCD                          WSBGCD
     I              ADVHST                          WSVHST
     I              ADMPNA                          WSMPNA
     I              ADWPST                          WSWPST
     I              ADXUST                          WSXUST
     I              ADT0ST                          WST0ST
     I              ADT1ST                          WST1ST
     I              ADDBNB                          WSDBNB
     I              ADT2ST                          WST2ST
     I              ADT3ST                          WST3ST
     I              ADT4ST                          WST4ST
     I              ADT6ST                          WST6ST
     I              ADBWC3                          WSBWC3
     I              ADBTC3                          WSBTC3
     I              ADBUC3                          WSBUC3
     I              ADBVC3                          WSBVC3
     I              ADFCAA                          WSFCAA
     I              ADRQSX                          WSRQSX
     I              ADRRSX                          WSRRSX
     I              ADRSSX                          WSRSSX
     I              ADRTSX                          WSRTSX
     I              ADT7ST                          WST7ST
     I              ADT8ST                          WST8ST
     I              ADRNSX                          WSRNSX
     I              ADROSX                          WSROSX
     I              ADRPSX                          WSRPSX
     I              ADUVST                          WSUVST
     I              ADUWST                          WSUWST
     I              ADUXST                          WSUXST
     I              ADVSST                          WSVSST
     I              ADAATM                          WSAATM
     I              ADAYNA                          WSAYNA
     I              ADA0NA                          WSA0NA
     I              ADAXDT                          WSAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WTAIC3
     I              B1HGCD                          WTHGCD
     I              B1AJCD                          WTAJCD
     I              B1ELDT                          WTELDT
     I              B1ABWG                          WTABWG
     I              B1AGQT                          WTAGQT
     I              B1AHQT                          WTAHQT
     I              B1AIQT                          WTAIQT
     I              B1CTST                          WTCTST
     I              B1ACWG                          WTACWG
     I              B1ARQT                          WTARQT
     I              B1ASQT                          WTASQT
     I              B1ATQT                          WTATQT
     I              B1HDQT                          WTHDQT
     I              B1HEQT                          WTHEQT
     I              B1F6ST                          WTF6ST
     I              B1BMWG                          WTBMWG
     I              B1DSQT                          WTDSQT
     I              B1DTQT                          WTDTQT
     I              B1DUQT                          WTDUQT
     I              B1DHDT                          WTDHDT
     I              B1AGCS                          WTAGCS
     I              B1AECS                          WTAECS
     I              B1IDVA                          WTIDVA
     I              B1K7DT                          WTK7DT
     I              B1RINB                          WTRINB
     I              B1RHNB                          WTRHNB
     I              B1RGNB                          WTRGNB
     I              B1UVST                          WTUVST
     I              B1UWST                          WTUWST
     I              B1UXST                          WTUXST
     I              B1VSST                          WTVSST
     I              B1AATM                          WTAATM
     I              B1AYNA                          WTAYNA
     I              B1A0NA                          WTA0NA
     I              B1AXDT                          WTAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WVAIC3
     I              B0HGCD                          WVHGCD
     I              B0AJCD                          WVAJCD
     I              B0AGCS                          WVAGCS
     I              B0AECS                          WVAECS
     I              B0BACS                          WVBACS
     I              B0BBCS                          WVBBCS
     I              B0CBPR                          WVCBPR
     I              B0GUDT                          WVGUDT
     I              B0XYST                          WVXYST
     I              B0CTPR                          WVCTPR
     I              B0G4DT                          WVG4DT
     I              B0BOWG                          WVBOWG
     I              B0DDQT                          WVDDQT
     I              B0DEQT                          WVDEQT
     I              B0DFQT                          WVDFQT
     I              B0HDQT                          WVHDQT
     I              B0HEQT                          WVHEQT
     I              B0AJQT                          WVAJQT
     I              B0AQQT                          WVAQQT
     I              B0AUQT                          WVAUQT
     I              B0EMQT                          WVEMQT
     I              B0DOQT                          WVDOQT
     I              B0ATNA                          WVATNA
     I              B0AKDT                          WVAKDT
     I              B0ANDT                          WVANDT
     I              B0IDVA                          WVIDVA
     I              B0JVST                          WVJVST
     I              B0BZPC                          WVBZPC
     I              B0DGQT                          WVDGQT
     I              B0DIDT                          WVDIDT
     I              B0ALCD                          WVALCD
     I              B0BFDY                          WVBFDY
     I              B0DJDT                          WVDJDT
     I              B0BGDY                          WVBGDY
     I              B0DKDT                          WVDKDT
     I              B0J2ST                          WVJ2ST
     I              B0DJQT                          WVDJQT
     I              B0BNWG                          WVBNWG
     I              B0DLDT                          WVDLDT
     I              B0DPQT                          WVDPQT
     I              B0DQQT                          WVDQQT
     I              B0DMDT                          WVDMDT
     I              B0M0ST                          WVM0ST
     I              B0J9ST                          WVJ9ST
     I              B0KBST                          WVKBST
     I              B0AKC8                          WVAKC8
     I              B0RINB                          WVRINB
     I              B0RHNB                          WVRHNB
     I              B0RGNB                          WVRGNB
     I              B0UVST                          WVUVST
     I              B0UWST                          WVUWST
     I              B0UXST                          WVUXST
     I              B0VSST                          WVVSST
     I              B0AATM                          WVAATM
     I              B0AYNA                          WVAYNA
     I              B0A0NA                          WVA0NA
     I              B0AXDT                          WVAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WWAIC3
     I              B0HGCD                          WWHGCD
     I              B0AJCD                          WWAJCD
     I              B0AGCS                          WWAGCS
     I              B0AECS                          WWAECS
     I              B0BACS                          WWBACS
     I              B0BBCS                          WWBBCS
     I              B0CBPR                          WWCBPR
     I              B0GUDT                          WWGUDT
     I              B0XYST                          WWXYST
     I              B0CTPR                          WWCTPR
     I              B0G4DT                          WWG4DT
     I              B0BOWG                          WWBOWG
     I              B0DDQT                          WWDDQT
     I              B0DEQT                          WWDEQT
     I              B0DFQT                          WWDFQT
     I              B0HDQT                          WWHDQT
     I              B0HEQT                          WWHEQT
     I              B0AJQT                          WWAJQT
     I              B0AQQT                          WWAQQT
     I              B0AUQT                          WWAUQT
     I              B0EMQT                          WWEMQT
     I              B0DOQT                          WWDOQT
     I              B0ATNA                          WWATNA
     I              B0AKDT                          WWAKDT
     I              B0ANDT                          WWANDT
     I              B0IDVA                          WWIDVA
     I              B0JVST                          WWJVST
     I              B0BZPC                          WWBZPC
     I              B0DGQT                          WWDGQT
     I              B0DIDT                          WWDIDT
     I              B0ALCD                          WWALCD
     I              B0BFDY                          WWBFDY
     I              B0DJDT                          WWDJDT
     I              B0BGDY                          WWBGDY
     I              B0DKDT                          WWDKDT
     I              B0J2ST                          WWJ2ST
     I              B0DJQT                          WWDJQT
     I              B0BNWG                          WWBNWG
     I              B0DLDT                          WWDLDT
     I              B0DPQT                          WWDPQT
     I              B0DQQT                          WWDQQT
     I              B0DMDT                          WWDMDT
     I              B0M0ST                          WWM0ST
     I              B0J9ST                          WWJ9ST
     I              B0KBST                          WWKBST
     I              B0AKC8                          WWAKC8
     I              B0RINB                          WWRINB
     I              B0RHNB                          WWRHNB
     I              B0RGNB                          WWRGNB
     I              B0UVST                          WWUVST
     I              B0UWST                          WWUWST
     I              B0UXST                          WWUXST
     I              B0VSST                          WWVSST
     I              B0AATM                          WWAATM
     I              B0AYNA                          WWAYNA
     I              B0A0NA                          WWA0NA
     I              B0AXDT                          WWAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                          WXAIC3
     I              B7HGCD                          WXHGCD
     I              B7AJCD                          WXAJCD
     I              B7W9ST                          WXW9ST
     I              B7BSST                          WXBSST
     I              B7B4DT                          WXB4DT
     I              B7C4NY                          WXC4NY
     I              B7DXNB                          WXDXNB
     I              B7ELDT                          WXELDT
     I              B7HVCD                          WXHVCD
     I              B7F1ST                          WXF1ST
     I              B7AUNA                          WXAUNA
     I              B7A5QT                          WXA5QT
     I              B7AHWG                          WXAHWG
     I              B7AKCS                          WXAKCS
     I              B7CGCD                          WXCGCD
     I              B7AYVA                          WXAYVA
     I              B7BJNA                          WXBJNA
     I              B7CKNB                          WXCKNB
     I              B7BMST                          WXBMST
     I              B7CQCD                          WXCQCD
     I              B7DTCD                          WXDTCD
     I              B7MGNA                          WXMGNA
     I              B7TRBN                          WXTRBN
     I              B7TRBS                          WXTRBS
     I              B7C4NB                          WXC4NB
     I              B7RINB                          WXRINB
     I              B7RHNB                          WXRHNB
     I              B7RGNB                          WXRGNB
     I              B7M3NA                          WXM3NA
     I              B7AWTM                          WXAWTM
     I              B7XLCD                          WXXLCD
     I              B7K7DT                          WXK7DT
     I              B7UVST                          WXUVST
     I              B7UWST                          WXUWST
     I              B7UXST                          WXUXST
     I              B7VSST                          WXVSST
     I              B7AATM                          WXAATM
     I              B7AYNA                          WXAYNA
     I              B7A0NA                          WXA0NA
     I              B7AXDT                          WXAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WYDOCD
     I              DPAUNA                          WYAUNA
     I              DPI5ST                          WYI5ST
     I              DPBXTX                          WYBXTX
     I              DPM8NB                          WYM8NB
     I              DPUVST                          WYUVST
     I              DPUWST                          WYUWST
     I              DPUXST                          WYUXST
     I              DPVSST                          WYVSST
     I              DPAATM                          WYAATM
     I              DPAYNA                          WYAYNA
     I              DPA0NA                          WYA0NA
     I              DPAXDT                          WYAXDT
      *
     I@L5CPUU
      * Item Lot Location        Co/Whs/Lt/Itm/Lc/Lv/Pd/Sq
      * Renamed input format fields
     I              L5AIC3                          TAAIC3
     I              L5HGCD                          TAHGCD
     I              L5AJCD                          TAAJCD
     I              L5ELDT                          TAELDT
     I              L5LXNM                          TALXNM
     I              L5YMCD                          TAYMCD
     I              L5YNCD                          TAYNCD
     I              L5J2QT                          TAJ2QT
     I              L5G5WG                          TAG5WG
     I              L5J3QT                          TAJ3QT
     I              L5G6WG                          TAG6WG
     I              L5J4QT                          TAJ4QT
     I              L5G7WG                          TAG7WG
     I              L5LODT                          TALODT
     I              L5LPDT                          TALPDT
     I              L5LQDT                          TALQDT
     I              L5NBR                           TANBR
     I              L5YTCD                          TAYTCD
     I              L5AMSX                          TAAMSX
     I              L5ASSX                          TAASSX
     I              L5ATSX                          TAATSX
     I              L5AUSX                          TAAUSX
     I              L5YSCD                          TAYSCD
     I              L5UVST                          TAUVST
     I              L5UWST                          TAUWST
     I              L5UXST                          TAUXST
     I              L5VSST                          TAVSST
     I              L5AATM                          TAAATM
     I              L5AYNA                          TAAYNA
     I              L5A0NA                          TAA0NA
     I              L5AXDT                          TAAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          TBAIC3
     I              ABADTX                          TBADTX
     I              ABACNA                          TBACNA
     I              ABADNA                          TBADNA
     I              ABAENA                          TBAENA
     I              ABAJNA                          TBAJNA
     I              ABBTTX                          TBBTTX
     I              ABBVTX                          TBBVTX
     I              ABBWTX                          TBBWTX
     I              ABA2NA                          TBA2NA
     I              ABABTX                          TBABTX
     I              ABBGCD                          TBBGCD
     I              ABKXCD                          TBKXCD
     I              ABUVST                          TBUVST
     I              ABUWST                          TBUWST
     I              ABUXST                          TBUXST
     I              ABVSST                          TBVSST
     I              ABAATM                          TBAATM
     I              ABAYNA                          TBAYNA
     I              ABA0NA                          TBA0NA
     I              ABAXDT                          TBAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          TCAJCD
     I              ADF8NA                          TCF8NA
     I              ADACNA                          TCACNA
     I              ADADNA                          TCADNA
     I              ADAENA                          TCAENA
     I              ADAJNA                          TCAJNA
     I              ADBTTX                          TCBTTX
     I              ADAOCD                          TCAOCD
     I              ADBGCD                          TCBGCD
     I              ADVHST                          TCVHST
     I              ADMPNA                          TCMPNA
     I              ADWPST                          TCWPST
     I              ADXUST                          TCXUST
     I              ADT0ST                          TCT0ST
     I              ADT1ST                          TCT1ST
     I              ADDBNB                          TCDBNB
     I              ADT2ST                          TCT2ST
     I              ADT3ST                          TCT3ST
     I              ADT4ST                          TCT4ST
     I              ADT6ST                          TCT6ST
     I              ADBWC3                          TCBWC3
     I              ADBTC3                          TCBTC3
     I              ADBUC3                          TCBUC3
     I              ADBVC3                          TCBVC3
     I              ADFCAA                          TCFCAA
     I              ADRQSX                          TCRQSX
     I              ADRRSX                          TCRRSX
     I              ADRSSX                          TCRSSX
     I              ADRTSX                          TCRTSX
     I              ADT7ST                          TCT7ST
     I              ADT8ST                          TCT8ST
     I              ADRNSX                          TCRNSX
     I              ADROSX                          TCROSX
     I              ADRPSX                          TCRPSX
     I              ADUVST                          TCUVST
     I              ADUWST                          TCUWST
     I              ADUXST                          TCUXST
     I              ADVSST                          TCVSST
     I              ADAATM                          TCAATM
     I              ADAYNA                          TCAYNA
     I              ADA0NA                          TCA0NA
     I              ADAXDT                          TCAXDT
      *
     I@L4RESS
      * Item Hold Reason          Retrieval index
      * Renamed input format fields
     I              L4AIC3                          TDAIC3
     I              L4YSCD                          TDYSCD
     I              L4OMNA                          TDOMNA
     I              L4ISRU                          TDISRU
     I              L4ISRN                          TDISRN
     I              L4UVST                          TDUVST
     I              L4UWST                          TDUWST
     I              L4UXST                          TDUXST
     I              L4VSST                          TDVSST
     I              L4AATM                          TDAATM
     I              L4AYNA                          TDAYNA
     I              L4A0NA                          TDA0NA
     I              L4AXDT                          TDAXDT
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          TEHGCD
     I              BYAVNA                          TEAVNA
     I              BYAWNA                          TEAWNA
     I              BYL7NA                          TEL7NA
     I              BYL8NA                          TEL8NA
     I              BYL6NA                          TEL6NA
     I              BYMFNA                          TEMFNA
     I              BYHHCD                          TEHHCD
     I              BYAWPC                          TEAWPC
     I              BYLXST                          TELXST
     I              BYLGCD                          TELGCD
     I              BYAXPC                          TEAXPC
     I              BYLYST                          TELYST
     I              BYLHCD                          TELHCD
     I              BYLICD                          TELICD
     I              BYAIWG                          TEAIWG
     I              BYHICD                          TEHICD
     I              BYRBCD                          TERBCD
     I              BYFZST                          TEFZST
     I              BYAVST                          TEAVST
     I              BYCZWG                          TECZWG
     I              BYC0WG                          TEC0WG
     I              BYURTN                          TEURTN
     I              BYACC8                          TEACC8
     I              BYRINB                          TERINB
     I              BYRHNB                          TERHNB
     I              BYRGNB                          TERGNB
     I              BYLNCD                          TELNCD
     I              BYTFNB                          TETFNB
     I              BYN0CD                          TEN0CD
     I              BYX4ST                          TEX4ST
     I              BYCHTM                          TECHTM
     I              BYQZCD                          TEQZCD
     I              BYXWST                          TEXWST
     I              BYXXST                          TEXXST
     I              BYVMST                          TEVMST
     I              BYSWGH                          TESWGH
     I              BYPPHE                          TEPPHE
     I              BYLRCD                          TELRCD
     I              BYSFNB                          TESFNB
     I              BYA3WG                          TEA3WG
     I              BYSJNB                          TESJNB
     I              BYLLCD                          TELLCD
     I              BYLMCD                          TELMCD
     I              BYP3ST                          TEP3ST
     I              BYSKNB                          TESKNB
     I              BYSLNB                          TESLNB
     I              BYSMNB                          TESMNB
     I              BYP4ST                          TEP4ST
     I              BYCFNB                          TECFNB
     I              BYCGNB                          TECGNB
     I              BYILNB                          TEILNB
     I              BYCHNB                          TECHNB
     I              BYCINB                          TECINB
     I              BYCJNB                          TECJNB
     I              BYCMNB                          TECMNB
     I              BYCNNB                          TECNNB
     I              BYCRNB                          TECRNB
     I              BYCSNB                          TECSNB
     I              BYCVNB                          TECVNB
     I              BYCWNB                          TECWNB
     I              BYCXNB                          TECXNB
     I              BYCZNB                          TECZNB
     I              BYC0NB                          TEC0NB
     I              BYN1CD                          TEN1CD
     I              BYB4NB                          TEB4NB
     I              BYX5ST                          TEX5ST
     I              BYX6ST                          TEX6ST
     I              BYX7ST                          TEX7ST
     I              BYTMVA                          TETMVA
     I              BYTNVA                          TETNVA
     I              BYBLPR                          TEBLPR
     I              BYBMPR                          TEBMPR
     I              BYU9ST                          TEU9ST
     I              BYCMCO                          TECMCO
     I              BYQ1CD                          TEQ1CD
     I              BYAIC3                          TEAIC3
     I              BYQ8CD                          TEQ8CD
     I              BYR3CD                          TER3CD
     I              BYSDCD                          TESDCD
     I              BYICN1                          TEICN1
     I              BYSVCD                          TESVCD
     I              BYICN2                          TEICN2
     I              BYSWCD                          TESWCD
     I              BYV2NB                          TEV2NB
     I              BYSXCD                          TESXCD
     I              BYITCN                          TEITCN
     I              BYSYCD                          TESYCD
     I              BYITC5                          TEITC5
     I              BYSZCD                          TESZCD
     I              BYICN6                          TEICN6
     I              BYS0CD                          TES0CD
     I              BYICN7                          TEICN7
     I              BYS1CD                          TES1CD
     I              BYICN8                          TEICN8
     I              BYS2CD                          TES2CD
     I              BYICN9                          TEICN9
     I              BYS3CD                          TES3CD
     I              BYICN0                          TEICN0
     I              BYS4CD                          TES4CD
     I              BYB5NB                          TEB5NB
     I              BYXRCD                          TEXRCD
     I              BYPCCT                          TEPCCT
     I              BYBDNB                          TEBDNB
     I              BYBJNB                          TEBJNB
     I              BYSUST                          TESUST
     I              BYSVST                          TESVST
     I              BYSYST                          TESYST
     I              BYSZST                          TESZST
     I              BYS1ST                          TES1ST
     I              BYXTCD                          TEXTCD
     I              BYXUCD                          TEXUCD
     I              BYF5WG                          TEF5WG
     I              BYF6WG                          TEF6WG
     I              BYF7WG                          TEF7WG
     I              BYBLNB                          TEBLNB
     I              BYBNNB                          TEBNNB
     I              BYS2ST                          TES2ST
     I              BYS4ST                          TES4ST
     I              BYS5ST                          TES5ST
     I              BYS6ST                          TES6ST
     I              BYS8ST                          TES8ST
     I              BYS9ST                          TES9ST
     I              BYTCST                          TETCST
     I              BYTDST                          TETDST
     I              BYUVST                          TEUVST
     I              BYUWST                          TEUWST
     I              BYUXST                          TEUXST
     I              BYVSST                          TEVSST
     I              BYAHTM                          TEAHTM
     I              BYBEVN                          TEBEVN
     I              BYBFVN                          TEBFVN
     I              BYEKDT                          TEEKDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          TFAJVN
     I              DRAUNA                          TFAUNA
     I              DRB8NA                          TFB8NA
     I              DRAHVN                          TFAHVN
     I              DRI6ST                          TFI6ST
     I              DRI7ST                          TFI7ST
     I              DRXMST                          TFXMST
     I              DRXNST                          TFXNST
     I              DRI8ST                          TFI8ST
     I              DRNLNB                          TFNLNB
     I              DRMPNA                          TFMPNA
     I              DRBCCD                          TFBCCD
     I              DRAIC3                          TFAIC3
     I              DRDQCD                          TFDQCD
     I              DRDRCD                          TFDRCD
     I              DRAJCD                          TFAJCD
     I              DRBUVN                          TFBUVN
     I              DRUVST                          TFUVST
     I              DRUWST                          TFUWST
     I              DRUXST                          TFUXST
     I              DRAATM                          TFAATM
     I              DRAYNA                          TFAYNA
     I              DRA0NA                          TFA0NA
     I              DRAXDT                          TFAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          TGAJVN
     I              DTDNCD                          TGDNCD
     I              DTAIC3                          TGAIC3
     I              DTDQCD                          TGDQCD
     I              DTDRCD                          TGDRCD
     I              DTAJCD                          TGAJCD
     I              DTJFST                          TGJFST
     I              DTUVST                          TGUVST
     I              DTUWST                          TGUWST
     I              DTUXST                          TGUXST
     I              DTAATM                          TGAATM
     I              DTAYNA                          TGAYNA
     I              DTA0NA                          TGA0NA
     I              DTAXDT                          TGAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          THDNCD
     I              DNAUNA                          THAUNA
     I              DNVKST                          THVKST
     I              DNRSCD                          THRSCD
     I              DNUVST                          THUVST
     I              DNUWST                          THUWST
     I              DNUXST                          THUXST
     I              DNAATM                          THAATM
     I              DNAYNA                          THAYNA
     I              DNA0NA                          THA0NA
     I              DNAXDT                          THAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WBAIC3
     I              L7HGCD                          WBHGCD
     I              L7AJCD                          WBAJCD
     I              L7LTRT                          WBLTRT
     I              L7LRDT                          WBLRDT
     I              L7LLTS                          WBLLTS
     I              L7LSDT                          WBLSDT
     I              L7J5QT                          WBJ5QT
     I              L7G8WG                          WBG8WG
     I              L7LLTN                          WBLLTN
     I              L7YMCD                          WBYMCD
     I              L7LLCL                          WBLLCL
     I              L7BNAA                          WBBNAA
     I              L7LLTR                          WBLLTR
     I              L7Y2CD                          WBY2CD
     I              L7LLTL                          WBLLTL
     I              L7C4NB                          WBC4NB
     I              L7LOST                          WBLOST
     I              L7LLTU                          WBLLTU
     I              L7LLYT                          WBLLYT
     I              L7UVST                          WBUVST
     I              L7UWST                          WBUWST
     I              L7UXST                          WBUXST
     I              L7VSST                          WBVSST
     I              L7AATM                          WBAATM
     I              L7AYNA                          WBAYNA
     I              L7A0NA                          WBA0NA
     I              L7AXDT                          WBAXDT
      *
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WDAIC3
     I              L5HGCD                          WDHGCD
     I              L5AJCD                          WDAJCD
     I              L5ELDT                          WDELDT
     I              L5LXNM                          WDLXNM
     I              L5YMCD                          WDYMCD
     I              L5YNCD                          WDYNCD
     I              L5J2QT                          WDJ2QT
     I              L5G5WG                          WDG5WG
     I              L5J3QT                          WDJ3QT
     I              L5G6WG                          WDG6WG
     I              L5J4QT                          WDJ4QT
     I              L5G7WG                          WDG7WG
     I              L5LODT                          WDLODT
     I              L5LPDT                          WDLPDT
     I              L5LQDT                          WDLQDT
     I              L5NBR                           WDNBR
     I              L5YTCD                          WDYTCD
     I              L5AMSX                          WDAMSX
     I              L5ASSX                          WDASSX
     I              L5ATSX                          WDATSX
     I              L5AUSX                          WDAUSX
     I              L5YSCD                          WDYSCD
     I              L5UVST                          WDUVST
     I              L5UWST                          WDUWST
     I              L5UXST                          WDUXST
     I              L5VSST                          WDVSST
     I              L5AATM                          WDAATM
     I              L5AYNA                          WDAYNA
     I              L5A0NA                          WDA0NA
     I              L5AXDT                          WDAXDT
      *
     IYARDCS      DS                            111
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WFAIC3
     I              B1HGCD                          WFHGCD
     I              B1AJCD                          WFAJCD
     I              B1ELDT                          WFELDT
     I              B1ABWG                          WFABWG
     I              B1AGQT                          WFAGQT
     I              B1AHQT                          WFAHQT
     I              B1AIQT                          WFAIQT
     I              B1CTST                          WFCTST
     I              B1ACWG                          WFACWG
     I              B1ARQT                          WFARQT
     I              B1ASQT                          WFASQT
     I              B1ATQT                          WFATQT
     I              B1HDQT                          WFHDQT
     I              B1HEQT                          WFHEQT
     I              B1F6ST                          WFF6ST
     I              B1BMWG                          WFBMWG
     I              B1DSQT                          WFDSQT
     I              B1DTQT                          WFDTQT
     I              B1DUQT                          WFDUQT
     I              B1DHDT                          WFDHDT
     I              B1AGCS                          WFAGCS
     I              B1AECS                          WFAECS
     I              B1IDVA                          WFIDVA
     I              B1K7DT                          WFK7DT
     I              B1RINB                          WFRINB
     I              B1RHNB                          WFRHNB
     I              B1RGNB                          WFRGNB
     I              B1UVST                          WFUVST
     I              B1UWST                          WFUWST
     I              B1UXST                          WFUXST
     I              B1VSST                          WFVSST
     I              B1AATM                          WFAATM
     I              B1AYNA                          WFAYNA
     I              B1A0NA                          WFA0NA
     I              B1AXDT                          WFAXDT
      *
     IQPDL21    E DSPDL2REL1
      * UPD : Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WHAJCD
     I              L2YMCD                          WHYMCD
     I              L2YPCD                          WHYPCD
     I              L2LCBY                          WHLCBY
     I              L2LCCT                          WHLCCT
     I              L2WLUS                          WHWLUS
     I              L2WUSD                          WHWUSD
     I              L2WLUN                          WHWLUN
     I              L2AGSX                          WHAGSX
     I              L2UVST                          WHUVST
     I              L2UWST                          WHUWST
     I              L2UXST                          WHUXST
     I              L2VSST                          WHVSST
     I              L2AATM                          WHAATM
     I              L2AYNA                          WHAYNA
     I              L2A0NA                          WHA0NA
     I              L2AXDT                          WHAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WJAIC3
     I              ASAXNB                          WJAXNB
     I              ASNGNB                          WJNGNB
     I              ASBZNB                          WJBZNB
     I              ASC5NB                          WJC5NB
     I              ASC3NB                          WJC3NB
     I              ASCYNB                          WJCYNB
     I              ASIONB                          WJIONB
     I              ASI6NB                          WJI6NB
     I              ASDCNB                          WJDCNB
     I              ASC7NB                          WJC7NB
     I              ASC2NB                          WJC2NB
     I              ASC1NB                          WJC1NB
     I              ASL8NB                          WJL8NB
     I              ASBANB                          WJBANB
     I              ASCHST                          WJCHST
     I              ASCKST                          WJCKST
     I              ASCIST                          WJCIST
     I              ASCGST                          WJCGST
     I              ASAIPC                          WJAIPC
     I              ASASPC                          WJASPC
     I              ASA2VA                          WJA2VA
     I              ASC2ST                          WJC2ST
     I              ASD8ST                          WJD8ST
     I              ASD7ST                          WJD7ST
     I              ASA8NA                          WJA8NA
     I              ASA9NA                          WJA9NA
     I              ASBANA                          WJBANA
     I              ASBBNA                          WJBBNA
     I              ASEUST                          WJEUST
     I              ASAADY                          WJAADY
     I              ASABDY                          WJABDY
     I              ASACDY                          WJACDY
     I              ASADDY                          WJADDY
     I              ASAEDY                          WJAEDY
     I              ASAFDY                          WJAFDY
     I              ASAGDY                          WJAGDY
     I              ASAHDY                          WJAHDY
     I              ASAENB                          WJAENB
     I              ASALNB                          WJALNB
     I              ASEVNB                          WJEVNB
     I              ASRPOP                          WJRPOP
     I              ASDWNB                          WJDWNB
     I              ASR3NB                          WJR3NB
     I              ASPNST                          WJPNST
     I              ASR4NB                          WJR4NB
     I              ASPOST                          WJPOST
     I              ASSCNB                          WJSCNB
     I              ASVIST                          WJVIST
     I              ASVJST                          WJVJST
     I              ASBVVN                          WJBVVN
     I              ASUVST                          WJUVST
     I              ASUWST                          WJUWST
     I              ASUXST                          WJUXST
     I              ASVSST                          WJVSST
     I              ASAATM                          WJAATM
     I              ASAYNA                          WJAYNA
     I              ASA0NA                          WJA0NA
     I              ASAXDT                          WJAXDT
      *
     IYBRDCS      DS                            278
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WRAIC3
     I              B7HGCD                          WRHGCD
     I              B7AJCD                          WRAJCD
     I              B7W9ST                          WRW9ST
     I              B7BSST                          WRBSST
     I              B7B4DT                          WRB4DT
     I              B7C4NY                          WRC4NY
     I              B7DXNB                          WRDXNB
     I              B7ELDT                          WRELDT
     I              B7HVCD                          WRHVCD
     I              B7F1ST                          WRF1ST
     I              B7AUNA                          WRAUNA
     I              B7A5QT                          WRA5QT
     I              B7AHWG                          WRAHWG
     I              B7AKCS                          WRAKCS
     I              B7CGCD                          WRCGCD
     I              B7AYVA                          WRAYVA
     I              B7BJNA                          WRBJNA
     I              B7CKNB                          WRCKNB
     I              B7BMST                          WRBMST
     I              B7CQCD                          WRCQCD
     I              B7DTCD                          WRDTCD
     I              B7MGNA                          WRMGNA
     I              B7TRBN                          WRTRBN
     I              B7TRBS                          WRTRBS
     I              B7C4NB                          WRC4NB
     I              B7RINB                          WRRINB
     I              B7RHNB                          WRRHNB
     I              B7RGNB                          WRRGNB
     I              B7M3NA                          WRM3NA
     I              B7AWTM                          WRAWTM
     I              B7XLCD                          WRXLCD
     I              B7K7DT                          WRK7DT
     I              B7UVST                          WRUVST
     I              B7UWST                          WRUWST
     I              B7UXST                          WRUXST
     I              B7VSST                          WRVSST
     I              B7AATM                          WRAATM
     I              B7AYNA                          WRAYNA
     I              B7A0NA                          WRA0NA
     I              B7AXDT                          WRAXDT
      *
     IYCRDCS      DS                            163
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WVAIC3
     I              B0HGCD                          WVHGCD
     I              B0AJCD                          WVAJCD
     I              B0AGCS                          WVAGCS
     I              B0AECS                          WVAECS
     I              B0BACS                          WVBACS
     I              B0BBCS                          WVBBCS
     I              B0CBPR                          WVCBPR
     I              B0GUDT                          WVGUDT
     I              B0XYST                          WVXYST
     I              B0CTPR                          WVCTPR
     I              B0G4DT                          WVG4DT
     I              B0BOWG                          WVBOWG
     I              B0DDQT                          WVDDQT
     I              B0DEQT                          WVDEQT
     I              B0DFQT                          WVDFQT
     I              B0HDQT                          WVHDQT
     I              B0HEQT                          WVHEQT
     I              B0AJQT                          WVAJQT
     I              B0AQQT                          WVAQQT
     I              B0AUQT                          WVAUQT
     I              B0EMQT                          WVEMQT
     I              B0DOQT                          WVDOQT
     I              B0ATNA                          WVATNA
     I              B0AKDT                          WVAKDT
     I              B0ANDT                          WVANDT
     I              B0IDVA                          WVIDVA
     I              B0JVST                          WVJVST
     I              B0BZPC                          WVBZPC
     I              B0DGQT                          WVDGQT
     I              B0DIDT                          WVDIDT
     I              B0ALCD                          WVALCD
     I              B0BFDY                          WVBFDY
     I              B0DJDT                          WVDJDT
     I              B0BGDY                          WVBGDY
     I              B0DKDT                          WVDKDT
     I              B0J2ST                          WVJ2ST
     I              B0DJQT                          WVDJQT
     I              B0BNWG                          WVBNWG
     I              B0DLDT                          WVDLDT
     I              B0DPQT                          WVDPQT
     I              B0DQQT                          WVDQQT
     I              B0DMDT                          WVDMDT
     I              B0M0ST                          WVM0ST
     I              B0J9ST                          WVJ9ST
     I              B0KBST                          WVKBST
     I              B0AKC8                          WVAKC8
     I              B0RINB                          WVRINB
     I              B0RHNB                          WVRHNB
     I              B0RGNB                          WVRGNB
     I              B0UVST                          WVUVST
     I              B0UWST                          WVUWST
     I              B0UXST                          WVUXST
     I              B0VSST                          WVVSST
     I              B0AATM                          WVAATM
     I              B0AYNA                          WVAYNA
     I              B0A0NA                          WVA0NA
     I              B0AXDT                          WVAXDT
      *
     IYDRDCS      DS                            245
     IYERDCS      DS                            245
     IYFRDCS      DS                            163
      * Outward parameters
     IPARC        DS                            157
      * RCD : PAR API WIM Inv Shipping2
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Ship From Warehouse
     I                                        7   9 PAVPCD
      * I :  WIM Inventory Trans ID
     I                                       10  12 PANOSC
      * I :  WIM Inventory Trans Type
     I                                       13  15 PANPSC
      * I :  Transaction Date
     I                                    P  16  190PAA9DT
      * I :  Production Date
     I                                    P  20  230PAELDT
      * I :  Item Transaction Source
     I                                       24  25 PAF1ST
      * I :  Transaction Description
     I                                       26  55 PAVQNA
      * I :  Transaction Reason Code
     I                                       56  58 PAA1AB
      * I :  Order Number
     I                                    P  59  620PAC4NB
      * I :  Shift Number
     I                                       63  63 PAXLCD
      * I :  Ship To Warehouse
     I                                       64  66 PAL9AA
      * I :  Transaction Weight
     I                                    P  67  722PAAHWG
      * I :  Transaction Quantity
     I                                    P  73  782PAA5QT
      * I :  USR Unship Flag
     I                                       79  79 PAUSST
      * I :  Inter-Plant Transfer USR
     I                                       80  80 PAA5TX
      * O :  API EccResult-MsgId U
     I                                       81  87 PACLAB
      * O :  API EccResult-MsgDesc U
     I                                       88 137 PAVGU1
      * B :  API Request Key U
     I                                      138 147 PACKAB
      * I :  API Mode U
     I                                      148 157 PACJAB
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P1DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P1DRCD
      * N :  Salesperson Code
     I                                       22  24 P1BCCD
      * N :  System Date Format
     I                                       25  27 P1B8NA
      * N :  User Profile Name
     I                                       28  37 P1AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       39  39 P1I8ST
      * N :  Default Printer
     I                                       40  49 P1MPNA
      * N :  First Time Flag
     I                                       50  50 P1TAST
      * N :  Name
     I                                       51  80 P1ADTX
      * N :  System Value Alpha
     I                                       81 120 P1BXTX
      * N :  Access Denied (Y/N)
     I                                      121 121 P1WVST
      * N :  Requested Delivery Date
     I                                    P 122 1250P1EIDT
     IP2PARM      DS
      * N :  Record Found USR
     I                                        1   1 P2WXST
     IP3PARM      DS
      * N :  Record Found -PS CD USR
     I                                        1   1 P3VYST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Item Lot Location      NF'
      * Lot Number
     I                                    P   1   30ZA0001
      * Location Code
     I                                        4   7 ZA0002
      * Message data for 'Warehouse Loc DNE'
      * Warehouse Code
     I                                        1   3 ZA0003
      * Location Code
     I                                        4   7 ZA0004
      * Message data for 'Level Invalid'
      * Location Level
     I                                    P   1   20ZA0005
      * Message data for 'Trns Qty GT On Hand'
      * LLT Transaction Qty
     I                                    P   1   30ZA0006
      * ILL Item Qty On Hand
     I                                    P   4   60ZA0007
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0008
      * Application Code
     I                                       11  16 ZA0009
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0010
      * Application Code
     I                                       11  16 ZA0011
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * WI517 DN 10/12/23-Setup Eradani's Environment Libraries.
      * Upd Setup Eradani Libs CL - /UT User Programs  * 
     C                     CALL 'PVBFUPC'              90  Upd Setup Erada
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *
     C                     Z-ADD*ZERO     WN0001  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0002  70       Avail Ship Date
      *
      * Relocate Item         IF
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Update From Lot/Location
     C           #DJ5QT    MULT -1        WN0001           Quantity Loc Tr
      *
     C                     Z-ADD*ZERO     WN0003  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0004  1        EDI Status 1
     C                     MOVEL*BLANK    WN0005  1        EDI Status 2
     C                     MOVEL*BLANK    WN0006  1        EDI Status 3
     C                     MOVEL*BLANK    WN0007  1        Record Status
     C                     Z-ADD*ZERO     WN0008  60       Job Time
     C                     MOVEL*BLANK    WN0009 10        User Id
     C                     MOVEL*BLANK    WN0010 10        Job Name
     C                     Z-ADD*ZERO     WN0011  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     MOVEL#1AJCD    WL0003    P      Warehouse Code
     C                     MOVEL'T'       WL0004    P      LLT Transaction
     C                     Z-ADD##JDT     WL0005           LLT Transaction
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0003           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0007           Company Number
     C                     Z-ADD#1HGCD    WL0008           Item Code
     C                     MOVEL#1AJCD    WL0009    P      Warehouse Code
     C                     MOVEL'T'       WL0010    P      LLT Transaction
     C                     Z-ADD##JDT     WL0011           LLT Transaction
     C                     Z-ADDWN0003    WL0012           LLT Sequence Nu
     C                     Z-ADD#1ELDT    WL0013           LLT Production
     C                     Z-ADDWN0001    WL0014           LLT Transaction
     C                     Z-ADD*ZERO     WL0015           LLT Transaction
     C                     Z-ADD#1LXNM    WL0016           LLT Lot Number
     C                     MOVEL#1YMCD    WL0017    P      Location Code
     C                     Z-ADD#1YNCD    WL0018           LLT Location Le
     C                     MOVEL#1AJCD    WL0019    P      Transfer Wareho
     C                     Z-ADD#1LXNM    WL0020           LLT Transfer Lo
     C                     MOVEL#DYVCD    WL0021    P      Transfer Locati
     C                     Z-ADD#DSXTX    WL0022           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0023           Order Number
     C                     MOVEL'P'       WL0024    P      LLT Status
     C                     MOVELWULLTU    WL0025    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0026    P      LTT Unused Sts
     C                     MOVELWN0004    WL0027    P      EDI Status 1
     C                     MOVELWN0005    WL0028    P      EDI Status 2
     C                     MOVELWN0006    WL0029    P      EDI Status 3
     C                     MOVELWN0007    WL0030    P      Record Status
     C                     Z-ADDWN0008    WL0031           Job Time
     C                     MOVELWN0009    WL0032    P      User Id
     C                     MOVELWN0010    WL0033    P      Job Name
     C                     Z-ADDWN0011    WL0034           Job Date
     C                     EXSR SBCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     Z-ADD#1HGCD    WL0036           Item Code
     C                     MOVEL#1AJCD    WL0037    P      Warehouse Code
     C                     Z-ADD#1ELDT    WL0038           Production Date
     C                     Z-ADD#1LXNM    WL0039           Lot Number
     C                     MOVEL#1YMCD    WL0040    P      Location Code
     C                     Z-ADD#1YNCD    WL0041           Location Level
     C                     Z-ADD#1G5WG    WL0042           ILL Unit Weight
     C                     Z-ADD#1LODT    WL0043           ILL Avail Ship
     C                     Z-ADD#1LPDT    WL0044           ILL Unused Date
     C                     MOVEL#1AMSX    WL0045    P      ILL Status
     C                     MOVEL#1YSCD    WL0046    P      Inv Hold Reason
     C                     Z-ADDWN0001    WL0047           Quantity Loc Tr
     C                     EXSR SCRVGN
      * Create To Lot/Location
      * Val Location Exists   RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0067    P      Warehouse Code
     C                     MOVEL#DYVCD    WL0068    P      Location Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0069    YL0001    P      Record Found -P
      * Create Warehouse Location if one does not exist.
      * CASE: LCL.Record Found -PS CD USR is Record Not Found
     C           YL0001    IFEQ 'N'                        *IF
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#DYVCD:ZQ YL0002    P  90  Location Aisle
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#DYVCD:ZQ YL0003    P  90  Location Bay Al
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0003    YL0004           Location Bay
      * Crt Whs Location      CR - Warehouse Location  * 
     C                     EXSR SJCRRC
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0055  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0056  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
     C                     EXSR SKRVGN
      * Rtv Chill Time        RT - Warehouse Location Type  * 
     C                     EXSR SLRVGN
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           #1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0056    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0002
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0002
     C                     END
      * To Location Available Ship Date
      * CASE: PAR.Avail Ship Date USR LT PAR.ILL Avail Ship Date
     C           WN0002    IFLT #1LODT                     *IF
     C                     Z-ADDWN0002    #1LODT           ILL Avail Ship
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0057  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0058  1        EDI Status 1
     C                     MOVEL*BLANK    WN0059  1        EDI Status 2
     C                     MOVEL*BLANK    WN0060  1        EDI Status 3
     C                     MOVEL*BLANK    WN0061  1        Record Status
     C                     Z-ADD*ZERO     WN0062  60       Job Time
     C                     MOVEL*BLANK    WN0063 10        User Id
     C                     MOVEL*BLANK    WN0064 10        Job Name
     C                     Z-ADD*ZERO     WN0065  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     MOVEL#1AJCD    WL0003    P      Warehouse Code
     C                     MOVEL'RT'      WL0004    P      LLT Transaction
     C                     Z-ADD##JDT     WL0005           LLT Transaction
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0057           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0007           Company Number
     C                     Z-ADD#1HGCD    WL0008           Item Code
     C                     MOVEL#1AJCD    WL0009    P      Warehouse Code
     C                     MOVEL'RT'      WL0010    P      LLT Transaction
     C                     Z-ADD##JDT     WL0011           LLT Transaction
     C                     Z-ADDWN0057    WL0012           LLT Sequence Nu
     C                     Z-ADD#1ELDT    WL0013           LLT Production
     C                     Z-ADD#DJ5QT    WL0014           LLT Transaction
     C                     Z-ADD*ZERO     WL0015           LLT Transaction
     C                     Z-ADD#1LXNM    WL0016           LLT Lot Number
     C                     MOVEL#DYVCD    WL0017    P      Location Code
     C                     Z-ADD#DSXTX    WL0018           LLT Location Le
     C                     MOVEL#1AJCD    WL0019    P      Transfer Wareho
     C                     Z-ADD#1LXNM    WL0020           LLT Transfer Lo
     C                     MOVEL#1YMCD    WL0021    P      Transfer Locati
     C                     Z-ADD#1YNCD    WL0022           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0023           Order Number
     C                     MOVEL'P'       WL0024    P      LLT Status
     C                     MOVELWULLTU    WL0025    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0026    P      LTT Unused Sts
     C                     MOVELWN0058    WL0027    P      EDI Status 1
     C                     MOVELWN0059    WL0028    P      EDI Status 2
     C                     MOVELWN0060    WL0029    P      EDI Status 3
     C                     MOVELWN0061    WL0030    P      Record Status
     C                     Z-ADDWN0062    WL0031           Job Time
     C                     MOVELWN0063    WL0032    P      User Id
     C                     MOVELWN0064    WL0033    P      Job Name
     C                     Z-ADDWN0065    WL0034           Job Date
     C                     EXSR SBCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     Z-ADD#1HGCD    WL0036           Item Code
     C                     MOVEL#1AJCD    WL0037    P      Warehouse Code
     C                     Z-ADD#1ELDT    WL0038           Production Date
     C                     Z-ADD#1LXNM    WL0039           Lot Number
     C                     MOVEL#DYVCD    WL0040    P      Location Code
     C                     Z-ADD#DSXTX    WL0041           Location Level
     C                     Z-ADD#1G5WG    WL0042           ILL Unit Weight
     C                     Z-ADD#1LODT    WL0043           ILL Avail Ship
     C                     Z-ADD#1LPDT    WL0044           ILL Unused Date
     C                     MOVEL#1AMSX    WL0045    P      ILL Status
     C                     MOVEL#1YSCD    WL0046    P      Inv Hold Reason
     C                     Z-ADD#DJ5QT    WL0047           Quantity Loc Tr
     C                     EXSR SCRVGN
      * ** Process Auto-Locate Whse inventory added       FP1127
      * Transfer Item Balance/Item Balance Detail.
      * CASE: PAR.Reloc/Trans STS USR is Transfer
     C           'R'       IFEQ 'T'                        *IF
      * RTV Next Tran Batch #  CH - Company Control  * 
     C                     EXSR SMCHRC
     C                     Z-ADD#DJ5QT    YL0006           Transaction Qua
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR SNRVGN
      * Rtv Base Values        RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0070           Company Number
     C                     Z-ADD#1HGCD    WL0071           Item Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    YL0008    P      Description Lin
     C                     MOVELWL0073    YL0009    P      Description Lin
     C                     MOVELWL0074    YL0010    P      UOM Primary
     C                     Z-ADDWL0075    YL0011           Conversion Fact
     C                     MOVELWL0076    YL0012    P      Operation Facto
     C                     MOVELWL0077    YL0013    P      UOM Second
     C                     Z-ADDWL0078    YL0014           Conversion Fact
     C                     MOVELWL0079    YL0015    P      Operation Facto
     C                     MOVELWL0080    YL0016    P      UOM Third
     C                     MOVELWL0081    YL0017    P      UOM Pricing
     C                     Z-ADDWL0082    YL0018           Unit Weight
     C                     MOVELWL0083    YL0019    P      Production Date
     C                     MOVELWL0084    YL0020    P      Catch Weight St
     C                     Z-ADDWL0085    YL0021           Fresh Chilling
      * Clc Convert Weight     XF
     C                     Z-ADD*ZERO     YL0023           USR Weight base
     C                     Z-ADD*ZERO     YL0024           USR Weight base
     C                     Z-ADD*ZERO     YL0025           USR Weight base
     C                     Z-ADDYL0018    YL0023           USR Weight base
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           YL0013    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE 0                          *IF
     C           YL0018    DIV  YL0011    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
     C           YL0018    MULT YL0011    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUASWG    YL0024           USR Weight base
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE 0                          *IF
     C           WUASWG    DIV  YL0014    YL0025    H      USR Weight base
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
     C           WUASWG    MULT YL0014    YL0025    H      USR Weight base
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0006    MULT YL0023    YL0026    H      Transaction Wei
      * Rtv Status/Default     RT - Item Balance  * From Warehouse
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1HGCD    WL0087           Item Code
     C                     MOVEL#1AJCD    WL0088    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    YL0027           Unit Cost Per P
     C                     MOVELWL0090    YL0028    P      Cost Update Pen
     C                     MOVELWL0091    YL0029    P      Post GL Status
     C                     Z-ADDWL0092    YL0030           Vendor Item_Whs
     C                     MOVELWL0093    YL0031    P      Record Status
      * Rtv Status/Default     RT - Item Balance  * To Warehouse
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1HGCD    WL0087           Item Code
     C                     MOVEL#1AJCD    WL0088    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    YL0032           Unit Cost Per P
     C                     MOVELWL0090    WUG0TX    P      Cost Update Pen
     C                     MOVELWL0091    WUG0TX    P      Post GL Status
     C                     Z-ADDWL0092    WUNFNN           Vendor Item_Whs
     C                     MOVELWL0093    YL0031    P      Record Status
      * ** Add: Process Auto-Locate Whse inventory             FP1127
      * 9/29/23 DN WI517-Added Parm 'Inventory Updated USR',
      *   'Called From Program' & 'API was Called? U'.
      *
     C                     Z-ADD*ZERO     WN0124  30       Item Structure
     C                     Z-ADD*ZERO     WN0125  30       Item Structure
     C                     Z-ADD*ZERO     WN0126  30       Item Structure
     C                     Z-ADD*ZERO     WN0127  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0128  30       Sequence Number
     C                     Z-ADD*ZERO     WN0129 114       USR Transaction
     C                     Z-ADD*ZERO     WN0130 112       Extended Amount
     C                     Z-ADD*ZERO     WN0131 112       Quantity based
     C                     Z-ADD*ZERO     WN0132 112       Quantity based
     C                     Z-ADD*ZERO     WN0133 112       Quantity based
     C                     Z-ADD*ZERO     WN0134 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0135 112       On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0136 112       Value of On Han
     C                     Z-ADD*ZERO     WN0137  70       Production Date
     C                     Z-ADD*ZERO     WN0138  70       Label Date  USR
     C                     MOVEL*BLANK    WN0139  3        USR Reason Code
      *
      * UPD Balances Transfer  IF
      * NOTES: WI517 DN 10/09/23-Per Business (Ace C./Ryan H.), we will N
      *        pass in the 'negative' Qty/Wgt when processing the WIM API
      *        WIM API logic will handle this scenario.
      * WI517 DN 07/05/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                     EXSR SQRVGN
     C                     MOVEL'N'       YN0001           Inventory Updat
     C                     MOVEL'N'       YN0002           API was Called?
      * WI517 DN 10/09/23-Save Original Transaction Qty/Wgt in LCL contex
      * CASE: *OTHERWISE
     C                     Z-ADDYL0006    YL0035           Transaction Qua
     C                     Z-ADDYL0026    YL0036           Transaction Wei
      * 08/10/23 DN WI517-Call Existing Legacy Process.
      * CASE: *OTHERWISE
     C                     MOVEL'TRF'     WN0139           USR Reason Code
      * Error if FROM unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           YL0027    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0139           USR Reason Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0140 112       Quantity based
     C                     Z-ADD*ZERO     WN0141 112       Quantity based
     C                     Z-ADD*ZERO     WN0142 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0131           USR Qty based o
     C                     Z-ADD*ZERO     WN0132           USR Qty based o
     C                     Z-ADD*ZERO     WN0133           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           YL0010    IFEQ YL0010                     *IF
     C                     Z-ADDYL0006    WN0131           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           YL0013    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
     C           YL0006    MULT YL0011    WN0141    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE 0                          *IF
     C           YL0006    DIV  YL0011    WN0141    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0141    WN0132           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
     C           WN0141    MULT YL0014    WN0142    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE 0                          *IF
     C           WN0141    DIV  YL0014    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           YL0013    IFEQ YL0010                     *IF
     C                     Z-ADDYL0006    WN0132           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE 0                          *IF
     C           YL0006    DIV  YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
     C           YL0006    MULT YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
     C           YL0006    MULT YL0014    WN0142    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE 0                          *IF
     C           YL0006    DIV  YL0014    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           YL0016    IFEQ YL0010                     *IF
     C                     Z-ADDYL0006    WN0133           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0014    IFNE 0                          *IF
     C           YL0006    DIV  YL0014    WN0141    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0015    IFEQ 'D'                        *IF
     C           YL0006    MULT YL0014    WN0141    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0141    WN0132           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0011    IFNE 0                          *IF
     C           WN0141    DIV  YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0012    IFEQ 'D'                        *IF
     C           WN0141    MULT YL0011    WN0131    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0027    MULT YL0026    WN0130    H      Extended Amount
      * Adjust sign of transaction based on transaction type
      * CASE: PAR.Inventory Trans. Type is Transfer Warehouse
     C           'TW'      IFEQ 'TW'                       *IF
     C                     ADD  1         YL0033           Transfer Batch
     C                     Z-ADDYL0026    WUAHWG           Transaction Wei
     C                     Z-ADDYL0006    WUA5QT           Transaction Qua
      * CASE: PAR.USR Unship Flag is yes
     C           'N'       IFEQ 'Y'                        *IF
      * if this is an Unship, reverse the TO whse qty/wgt (neg rct)
     C           *ZERO     SUB  WUA5QT    WUA5QT           Transaction Qua
     C           *ZERO     SUB  WUAHWG    WUAHWG           Transaction Wei
     C                     ELSE
      * CASE: *OTHERWISE
      * if this is NOT an Unship, reverse the FROM whse qty, wgt (reverse
     C           *ZERO     SUB  YL0006    YL0006           Transaction Qua
     C           *ZERO     SUB  WN0131    WN0131           Quantity based
     C           *ZERO     SUB  YL0026    YL0026           Transaction Wei
     C           *ZERO     SUB  WN0130    WN0130           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
      * 08/10/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0034    IFEQ 'N'                        *IF
     C           YL0034    OREQ 'P'                        *OR
      * 09/26/23 DN WI517-Set 'Inventory Updated USR' Flag.
     C                     MOVEL'Y'       YN0001           Inventory Updat
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the FROM ITEM
      * *****************************************************************
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0094           Company Number
     C                     Z-ADD#1HGCD    WL0095           Item Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0096    WN0124           Item Structure
     C                     Z-ADDWL0097    WN0125           Item Structure
     C                     Z-ADDWL0098    WN0126           Item Structure
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0099           Company Number
     C                     Z-ADD#1HGCD    WL0100           Item Code
     C                     MOVEL#1AJCD    WL0101    P      Warehouse Code
     C                     MOVEL'T'       WL0102    P      Inventory Trans
     C                     MOVEL'TW'      WL0103    P      Inventory Trans
     C                     Z-ADD##JDT     WL0104           Transaction Dat
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0105    WN0127           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0106           Company Number
     C                     Z-ADD#1HGCD    WL0107           Item Code
     C                     MOVEL#1AJCD    WL0108    P      Warehouse Code
     C                     MOVEL'T'       WL0109    P      Inventory Trans
     C                     MOVEL'TW'      WL0110    P      Inventory Trans
     C                     Z-ADD##JDT     WL0111           Transaction Dat
     C                     Z-ADDWN0127    WL0112           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0113           Sequence Number
     C                     Z-ADD#1ELDT    WL0114           Production Date
     C                     MOVELYL0010    WL0115    P      UOM Transaction
     C                     MOVEL'IC'      WL0116    P      Item Transactio
     C                     MOVEL@CN,001   WL0117    P      Description
     C                     Z-ADDYL0006    WL0118           Transaction Qua
     C                     Z-ADDYL0026    WL0119           Transaction Wei
     C                     Z-ADD*ZERO     WL0120           USR Transaction
     C                     MOVEL'LB'      WL0121    P      UOM Cost
     C                     Z-ADDWN0130    WL0122           Extended Amount
     C                     MOVEL*BLANK    WL0123           Ticket Number
     C                     Z-ADD*ZERO     WL0124           GL Document Num
     C                     MOVEL'N'       WL0125    P      GL Update Statu
     C                     MOVELWN0139    WL0126    P      Reason Code
     C                     MOVEL*BLANK    WL0127           Reference Numbe
     C                     MOVEL*BLANK    WL0128           Lot ID
     C                     Z-ADDYL0005    WL0129           Transfer Batch
     C                     Z-ADDYL0033    WL0130           Transfer Batch
     C                     Z-ADD*ZERO     WL0131           Order Number
     C                     Z-ADDWN0124    WL0132           Item Structure
     C                     Z-ADDWN0125    WL0133           Item Structure
     C                     Z-ADDWN0126    WL0134           Item Structure
     C                     MOVEL*BLANK    WL0135           Employee Badge
     C                     Z-ADD*ZERO     WL0136           Production Time
     C                     MOVEL'1'       WL0137    P      Shift Number
     C                     Z-ADDYL0007    WL0138           Label Date
     C                     MOVEL*BLANK    WL0139           EDI Status 1
     C                     MOVEL*BLANK    WL0140           EDI Status 2
     C                     MOVEL*BLANK    WL0141           EDI Status 3
     C                     MOVEL'A'       WL0142    P      Record Status
     C                     EXSR STCRRC
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0143           Company Number
     C                     Z-ADD#1HGCD    WL0144           Item Code
     C                     MOVEL#1AJCD    WL0145    P      Warehouse Code
     C                     Z-ADD#1ELDT    WL0146           Production Date
     C                     Z-ADDWN0124    WL0147           Item Structure
     C                     Z-ADDWN0125    WL0148           Item Structure
     C                     Z-ADDWN0126    WL0149           Item Structure
     C                     MOVELYL0010    WL0150    P      UOM Primary
     C                     Z-ADDYL0011    WL0151           Conversion Fact
     C                     MOVELYL0012    WL0152    P      Operation Facto
     C                     MOVELYL0013    WL0153    P      UOM Second
     C                     Z-ADDYL0014    WL0154           Conversion Fact
     C                     MOVELYL0015    WL0155    P      Operation Facto
     C                     MOVELYL0016    WL0156    P      UOM Third
     C                     MOVELYL0019    WL0157    P      Production Date
     C                     MOVELYL0020    WL0158    P      Catch Weight St
     C                     MOVEL'T'       WL0159    P      Inventory Trans
     C                     MOVEL'TW'      WL0160    P      Inventory Trans
     C                     Z-ADD##JDT     WL0161           Transaction Dat
     C                     MOVELYL0010    WL0162    P      UOM Transaction
     C                     Z-ADDWN0131    WL0163           Transaction Qua
     C                     Z-ADDYL0026    WL0164           Transaction Wei
     C                     Z-ADD*ZERO     WL0165           USR Transaction
     C                     MOVEL'LB'      WL0166    P      UOM Cost
     C                     Z-ADDWN0130    WL0167           Extended Amount
     C                     Z-ADDYL0007    WL0168           Label Date  USR
     C                     EXSR SUCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0207           Company Number
     C                     Z-ADD#1HGCD    WL0208           Item Code
     C                     MOVEL#1AJCD    WL0209    P      Warehouse Code
     C                     Z-ADDWN0134    WL0210           Quantity on Han
     C                     Z-ADDWN0135    WL0211           Quantity on Han
     C                     Z-ADDWUNFNN    WL0212           Quantity on Han
     C                     Z-ADDWUNFNN    WL0213           Quantity on Han
     C                     Z-ADDWN0136    WL0214           Value of On Han
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0210    WN0134           Quantity on Han
     C                     Z-ADDWL0211    WN0135           Quantity on Han
     C                     Z-ADDWL0212    WUNFNN           Quantity on Han
     C                     Z-ADDWL0213    WUNFNN           Quantity on Han
     C                     Z-ADDWL0214    WN0136           Value of On Han
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0215           Company Number
     C                     Z-ADD#1HGCD    WL0216           Item Code
     C                     MOVEL#1AJCD    WL0217    P      Warehouse Code
     C                     Z-ADDWN0134    WL0218           On Hand Weight
     C                     Z-ADDWN0135    WL0219           On Hand UOM1 Su
     C                     Z-ADDWN0136    WL0220           Value of On Han
     C                     EXSR SZCHRC
      * ** FP1127:
      * ** Update location quantity on hand for External warehouse that
      * ** is lot controlled and not Carlisle controlled
      * ** Optional Lot number is passed in from the calling program
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0221    P      Warehouse Code
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0222    YN0003    P      Warehouse Descr
     C                     MOVELWL0223    YN0004    P      Address Line 1
     C                     MOVELWL0224    YN0005    P      Address Line 2
     C                     MOVELWL0225    YN0006    P      Address Line 3
     C                     MOVELWL0226    YN0007    P      City
     C                     MOVELWL0227    YN0008    P      Zip Postal Code
     C                     MOVELWL0228    YN0009    P      Production Ware
     C                     MOVELWL0229    YN0010    P      State Code
     C                     MOVELWL0230    YL0037    P      Lot Tracking Fl
     C                     MOVELWL0231    YN0011    P      Default Printer
     C                     MOVELWL0232    YN0012    P      Warehouse Type
     C                     MOVELWL0233    YN0013    P      Trans Contol AS
     C                     MOVELWL0234    YL0038    P      Warehouse Locat
     C                     MOVELWL0235    YN0014    P      Warehouse Std C
     C                     Z-ADDWL0236    YN0015           Warehouse Chill
     C                     MOVELWL0237    YN0016    P      Include in Auto
     C                     MOVELWL0238    YN0017    P      Default Manifes
     C                     MOVELWL0239    YN0018    P      Default Load Se
     C                     MOVELWL0240    YN0019    P      WHS Slotting Li
     C                     Z-ADDWL0241    YN0020           Shipping Compan
     C                     Z-ADDWL0242    YN0021           Accounting Comp
     C                     Z-ADDWL0243    YN0022           WHS Sched Prod
     C                     Z-ADDWL0244    YN0023           WHS Inventory C
     C                     MOVELWL0245    YN0024    P      Parent Warehous
     C                     MOVELWL0246    YN0025    P      Default Shippin
     C                     MOVELWL0247    YL0039    P      WHS Live with C
     C                     MOVELWL0248    YN0026    P      WHS PFS Interfa
     C                     MOVELWL0249    YN0027    P      WHS Req Meter R
     C                     MOVELWL0250    YN0028    P      WHS Default Loa
     C                     MOVELWL0251    YN0029    P      WHS TMS Plannin
     C                     MOVELWL0252    YN0030    P      Default Carrier
     C                     MOVELWL0253    YN0031    P      Inventory Logic
     C                     MOVELWL0254    YN0032    P      WHS Auto Inv Re
     C                     MOVELWL0255    YN0033    P      EDI Status 1
     C                     MOVELWL0256    YN0034    P      EDI Status 2
     C                     MOVELWL0257    YN0035    P      EDI Status 3
     C                     MOVELWL0258    YN0036    P      Record Status
     C                     Z-ADDWL0259    YN0037           Job Time
     C                     MOVELWL0260    YN0038    P      User Id
     C                     MOVELWL0261    YN0039    P      Job Name
     C                     Z-ADDWL0262    YN0040           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0038    IFEQ 'E'                        *IF
     C           YL0039    IFEQ *BLANK                     *IF
     C           YL0039    OREQ 'N'
     C           YL0037    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0263    P      Warehouse Code
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0264    WUYMCD    P      Location Code
     C                     MOVELWL0265    YL0040    P      Location Aisle
     C                     Z-ADDWL0266    YL0041           Location Bay
     C                     Z-ADDWL0267    YL0042           Loc Unused Chil
      * ** Lot # will be the "from warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0056  30       Company Number
     C                     PARM #1HGCD    WQ0057  70       Item Code
     C                     PARM #1AJCD    WQ0058  3        Warehouse Code
     C                     PARM #1ELDT    WQ0059  70       Production Date
     C                     PARM #1LXNM    WQ0060  50       Lot Number
     C                     PARM WUYMCD    WQ0061  4        Location Code
     C                     PARM WUYNCD    WQ0062  20       Location Level
     C                     PARM YL0006    WQ0063  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0064  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     SETON                     3234  *
     C                     END
     C                     END                             *FI
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the TO ITEM
      * *****************************************************************
      * ** 12/05/2008 LJB FP1127 Update Auto-Locate Whse inventory
      * ** Only process auto-locate if not a Carlisle Controlled warehous
      * ** and lot tracking has been turned on.
      * 12/04/06 PKD PK0040 Only add inventory to the To Warehouse
      *              if the Inter-Plant Transfer is No.  If the Inter-Pla
      *              Transfer is Yes, then the receiving plant's receivin
      *              process will add the inventory to the To Warehouse.
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0268    P      Warehouse Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0269    YL0043           Shipping Compan
      * CASE: PAR.Inter-Plant Transfer USR is No
     C           'N'       IFEQ 'N'                        *IF
      * Validate that Item Balance for TO Whse exists; if not, create it
      * Val Item Balance       RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0270           Company Number
     C                     Z-ADD#1HGCD    WL0271           Item Code
     C                     MOVEL#1AJCD    WL0272    P      Warehouse Code
     C                     EXSR TDRVGN
      * Create item balance if none exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Balance       CR - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0273           Company Number
     C                     Z-ADD#1HGCD    WL0274           Item Code
     C                     MOVEL#1AJCD    WL0275    P      Warehouse Code
     C                     Z-ADDYL0032    WL0276           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0277           Last Cost
     C                     Z-ADD*ZERO     WL0278           Cost per Primar
     C                     Z-ADD*ZERO     WL0279           Cost per Pricin
     C                     Z-ADD*ZERO     WL0280           Revaluation Cos
     C                     Z-ADD*ZERO     WL0281           Revaluation Eff
     C                     MOVELWUGSTX    WL0282    P      Revaluation Cos
     C                     Z-ADD*ZERO     WL0283           Last Revaluatio
     C                     Z-ADD*ZERO     WL0284           Last Revaluatio
     C                     Z-ADD*ZERO     WL0285           On Hand Weight
     C                     Z-ADD*ZERO     WL0286           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WL0287           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WL0288           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WL0289           Quantity In Chi
     C                     Z-ADD*ZERO     WL0290           Weight In Chill
     C                     Z-ADD*ZERO     WL0291           Quantity Schedu
     C                     Z-ADD*ZERO     WL0292           Quantity on Sal
     C                     Z-ADD*ZERO     WL0293           Quantity on Pur
     C                     Z-ADD*ZERO     WL0294           Quantity on Tra
     C                     Z-ADD*ZERO     WL0295           Quantity Avail
     C                     MOVEL*BLANK    WL0296           Cycle Count Cod
     C                     Z-ADD*ZERO     WL0297           Date of Last Or
     C                     Z-ADD*ZERO     WL0298           Date of Last Sh
     C                     Z-ADD*ZERO     WL0299           Value of On Han
     C                     MOVELWUGSTX    WL0300    P      Inventory Plann
     C                     Z-ADD*ZERO     WL0301           Safety Allowanc
     C                     Z-ADD*ZERO     WL0302           Safety Allowanc
     C                     Z-ADD*ZERO     WL0303           Stock Out Date
     C                     MOVEL*BLANK    WL0304           Buyer Code
     C                     Z-ADD*ZERO     WL0305           Lead Time Last
     C                     Z-ADD*ZERO     WL0306           Lead Time Date
     C                     Z-ADD*ZERO     WL0307           Lead Time Next
     C                     Z-ADD*ZERO     WL0308           Lead Time Date
     C                     MOVEL'N'       WL0309    P      Lead Time Excep
     C                     Z-ADD*ZERO     WL0310           Usage Qty per C
     C                     Z-ADD*ZERO     WL0311           Usage Weight pe
     C                     Z-ADD*ZERO     WL0312           Inventory Manag
     C                     Z-ADD*ZERO     WL0313           Minimum Quantit
     C                     Z-ADD*ZERO     WL0314           Maximum Quantit
     C                     Z-ADD*ZERO     WL0315           Last Physical C
     C                     MOVELWUGSTX    WL0316    P      Requisition Mod
     C                     MOVELWUGSTX    WL0317    P      Cost Update Pen
     C                     MOVELWUGSTX    WL0318    P      Post GL Status
     C                     Z-ADD*ZERO     WL0319           Vendor Item_Whs
     C                     Z-ADDWN0124    WL0320           Item Structure
     C                     Z-ADDWN0125    WL0321           Item Structure
     C                     Z-ADDWN0126    WL0322           Item Structure
     C                     MOVELWUUVST    WL0323    P      EDI Status 1
     C                     MOVELWUUWST    WL0324    P      EDI Status 2
     C                     MOVELWUUXST    WL0325    P      EDI Status 3
     C                     MOVEL'A'       WL0326    P      Record Status
     C                     EXSR TECRRC
     C                     END                             *FI
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost - Detail EQ WRK.ZERO
     C           YL0032    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0139           USR Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'TRF'     WN0139           USR Reason Code
     C                     END                             *FI
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0094           Company Number
     C                     Z-ADD#1HGCD    WL0095           Item Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0096    WN0124           Item Structure
     C                     Z-ADDWL0097    WN0125           Item Structure
     C                     Z-ADDWL0098    WN0126           Item Structure
     C           YL0032    MULT WUAHWG    WN0130    H      Extended Amount
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0099           Company Number
     C                     Z-ADD#1HGCD    WL0100           Item Code
     C                     MOVEL#1AJCD    WL0101    P      Warehouse Code
     C                     MOVEL'T'       WL0102    P      Inventory Trans
     C                     MOVEL'TW'      WL0103    P      Inventory Trans
     C                     Z-ADD##JDT     WL0104           Transaction Dat
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0105    WN0127           ITD Sequence Nu
      * Reset Production/Label Date if Lot Tracking warehouse.
     C                     EXSR UASUBR                     Reset Productio
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0106           Company Number
     C                     Z-ADD#1HGCD    WL0107           Item Code
     C                     MOVEL#1AJCD    WL0108    P      Warehouse Code
     C                     MOVEL'T'       WL0109    P      Inventory Trans
     C                     MOVEL'TW'      WL0110    P      Inventory Trans
     C                     Z-ADD##JDT     WL0111           Transaction Dat
     C                     Z-ADDWN0127    WL0112           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0113           Sequence Number
     C                     Z-ADDWN0137    WL0114           Production Date
     C                     MOVELYL0010    WL0115    P      UOM Transaction
     C                     MOVEL'IC'      WL0116    P      Item Transactio
     C                     MOVEL@CN,001   WL0117    P      Description
     C                     Z-ADDWUA5QT    WL0118           Transaction Qua
     C                     Z-ADDWUAHWG    WL0119           Transaction Wei
     C                     Z-ADD*ZERO     WL0120           USR Transaction
     C                     MOVEL'LB'      WL0121    P      UOM Cost
     C                     Z-ADDWN0130    WL0122           Extended Amount
     C                     MOVEL*BLANK    WL0123           Ticket Number
     C                     Z-ADD*ZERO     WL0124           GL Document Num
     C                     MOVEL*BLANK    WL0125           GL Update Statu
     C                     MOVELWN0139    WL0126    P      Reason Code
     C                     MOVEL*BLANK    WL0127           Reference Numbe
     C                     MOVEL*BLANK    WL0128           Lot ID
     C                     Z-ADDYL0005    WL0129           Transfer Batch
     C                     Z-ADDYL0033    WL0130           Transfer Batch
     C                     Z-ADD*ZERO     WL0131           Order Number
     C                     Z-ADDWN0124    WL0132           Item Structure
     C                     Z-ADDWN0125    WL0133           Item Structure
     C                     Z-ADDWN0126    WL0134           Item Structure
     C                     MOVEL*BLANK    WL0135           Employee Badge
     C                     Z-ADD*ZERO     WL0136           Production Time
     C                     MOVEL'1'       WL0137    P      Shift Number
     C                     Z-ADDWN0138    WL0138           Label Date
     C                     MOVEL*BLANK    WL0139           EDI Status 1
     C                     MOVEL*BLANK    WL0140           EDI Status 2
     C                     MOVEL*BLANK    WL0141           EDI Status 3
     C                     MOVEL'A'       WL0142    P      Record Status
     C                     EXSR STCRRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * * Post transaction to Item Balance & Item Balance Detail
      * Prc Create Dtl Receipt IF
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0327           Company Number
     C                     Z-ADD#1HGCD    WL0328           Item Code
     C                     MOVEL#1AJCD    WL0329    P      Warehouse Code
     C                     MOVEL'T'       WL0330    P      Inventory Trans
     C                     MOVEL'TW'      WL0331    P      Inventory Trans
     C                     Z-ADD##JDT     WL0332           Transaction Dat
     C                     Z-ADDWN0127    WL0333           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0334           Sequence Number
     C                     MOVEL'1'       WL0335    P      Shift Number
     C                     Z-ADDWN0138    WL0336           Label Date
     C                     EXSR TFRVGN
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0221    P      Warehouse Code
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0222    YN0003    P      Warehouse Descr
     C                     MOVELWL0223    YN0004    P      Address Line 1
     C                     MOVELWL0224    YN0005    P      Address Line 2
     C                     MOVELWL0225    YN0006    P      Address Line 3
     C                     MOVELWL0226    YN0007    P      City
     C                     MOVELWL0227    YN0008    P      Zip Postal Code
     C                     MOVELWL0228    YN0009    P      Production Ware
     C                     MOVELWL0229    YN0010    P      State Code
     C                     MOVELWL0230    YL0037    P      Lot Tracking Fl
     C                     MOVELWL0231    YN0011    P      Default Printer
     C                     MOVELWL0232    YN0012    P      Warehouse Type
     C                     MOVELWL0233    YN0013    P      Trans Contol AS
     C                     MOVELWL0234    YL0038    P      Warehouse Locat
     C                     MOVELWL0235    YN0014    P      Warehouse Std C
     C                     Z-ADDWL0236    YN0015           Warehouse Chill
     C                     MOVELWL0237    YN0016    P      Include in Auto
     C                     MOVELWL0238    YN0017    P      Default Manifes
     C                     MOVELWL0239    YN0018    P      Default Load Se
     C                     MOVELWL0240    YN0019    P      WHS Slotting Li
     C                     Z-ADDWL0241    YN0020           Shipping Compan
     C                     Z-ADDWL0242    YN0021           Accounting Comp
     C                     Z-ADDWL0243    YN0022           WHS Sched Prod
     C                     Z-ADDWL0244    YN0023           WHS Inventory C
     C                     MOVELWL0245    YN0024    P      Parent Warehous
     C                     MOVELWL0246    YN0025    P      Default Shippin
     C                     MOVELWL0247    YL0039    P      WHS Live with C
     C                     MOVELWL0248    YN0026    P      WHS PFS Interfa
     C                     MOVELWL0249    YN0027    P      WHS Req Meter R
     C                     MOVELWL0250    YN0028    P      WHS Default Loa
     C                     MOVELWL0251    YN0029    P      WHS TMS Plannin
     C                     MOVELWL0252    YN0030    P      Default Carrier
     C                     MOVELWL0253    YN0031    P      Inventory Logic
     C                     MOVELWL0254    YN0032    P      WHS Auto Inv Re
     C                     MOVELWL0255    YN0033    P      EDI Status 1
     C                     MOVELWL0256    YN0034    P      EDI Status 2
     C                     MOVELWL0257    YN0035    P      EDI Status 3
     C                     MOVELWL0258    YN0036    P      Record Status
     C                     Z-ADDWL0259    YN0037           Job Time
     C                     MOVELWL0260    YN0038    P      User Id
     C                     MOVELWL0261    YN0039    P      Job Name
     C                     Z-ADDWL0262    YN0040           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0038    IFEQ 'E'                        *IF
     C           YL0039    IFEQ *BLANK                     *IF
     C           YL0039    OREQ 'N'
     C           YL0037    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Lot Number is passed in and is optional
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0263    P      Warehouse Code
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0264    WUYMCD    P      Location Code
     C                     MOVELWL0265    YL0040    P      Location Aisle
     C                     Z-ADDWL0266    YL0041           Location Bay
     C                     Z-ADDWL0267    YL0042           Loc Unused Chil
      * ** Lot# will be the "to warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0079  30       Company Number
     C                     PARM #1HGCD    WQ0080  70       Item Code
     C                     PARM #1AJCD    WQ0081  3        Warehouse Code
     C                     PARM ##JDT     WQ0082  70       Production Date
     C                     PARM *ZERO     WQ0083  50       Lot Number
     C                     PARM WUYMCD    WQ0084  4        Location Code
     C                     PARM WUYNCD    WQ0085  20       Location Level
     C                     PARM WUA5QT    WQ0086  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0087  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     SETON                     32    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * 08/10/23 DN WI517-Call WIM API if Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Is Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0034    IFEQ 'Y'                        *IF
     C           YL0034    OREQ 'P'                        *OR
     C                     MOVEL'Y'       YN0002           API was Called?
     C                     MOVEL*BLANK    YL0044           API EccResult-M
     C                     MOVEL*BLANK    YL0045           API EccResult-M
     C                     MOVEL*BLANK    YL0046           API Request Key
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,004   CAT  'ry':ZQ   YL0047    P      API Name
      * RTV Numeric Value      RT - System Values  * 
     C                     EXSR TKRVGN
      * Call API Wrapper Program for wim.ordershipping.inventory API.
      * 1/6/24 DN SR08283-Added 'API Request Key U' & 'API Mode U' Parms.
      * API WIM Inv Shipping   UP - WIM Item Trans Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1HGCD    PAHGCD           Item Code
     C                     MOVEL#1AJCD    PAVPCD    P      Ship From Wareh
     C                     MOVEL'T'       PANOSC    P      WIM Inventory T
     C                     MOVEL'TW'      PANPSC    P      WIM Inventory T
     C                     Z-ADD##JDT     PAA9DT           Transaction Dat
     C                     Z-ADD#1ELDT    PAELDT           Production Date
     C                     MOVEL'IC'      PAF1ST    P      Item Transactio
     C                     MOVEL@CN,001   PAVQNA    P      Transaction Des
     C                     MOVEL*BLANK    PAA1AB    P      Transaction Rea
     C                     Z-ADD*ZERO     PAC4NB           Order Number
     C                     MOVEL'1'       PAXLCD    P      Shift Number
     C                     MOVEL#1AJCD    PAL9AA    P      Ship To Warehou
     C                     Z-ADDYL0036    PAAHWG           Transaction Wei
     C                     Z-ADDYL0035    PAA5QT           Transaction Qua
     C                     MOVEL'N'       PAUSST    P      USR Unship Flag
     C                     MOVEL'N'       PAA5TX    P      Inter-Plant Tra
     C                     MOVELYL0046    PACKAB    P      API Request Key
     C                     MOVEL'*SNDRCV' PACJAB    P      API Mode U
      *
     C                     CALL 'PVAYUPR'              90  API WIM Inv Shi
     C                     PARM YL0048    WQ0088  50       API Wait Time U
     C                     PARM           PARC             RCD: *Arrays
      *
     C                     MOVELPACLAB    YL0044           API EccResult-M
     C                     MOVELPAVGU1    YL0045           API EccResult-M
     C                     MOVELPACKAB    YL0046           API Request Key
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAYUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993133*
     C                     SETON                     3232  *
     C                     END
      * API Call Successful? If Not, Create Log & Send Email.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.API EccResult-MsgId U is Success
      *   |- c2    : LCL.API EccResult-MsgId U is Timeout
      *   '-
     C           YL0044    IFEQ @CN,006                    *IF
     C           YL0044    OREQ @CN,007                    *OR
     C                     MOVEL'Y'       YN0001           Inventory Updat
      * 01/06/24 DN SR08283-Create Log Record for Timeout Transaction.
      * CASE: LCL.API EccResult-MsgId U is Timeout
     C           YL0044    IFEQ @CN,007                    *IF
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Timeout Failur
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0047    WQ0089 45        API Name
     C                     PARM YL0044    WQ0090  7        API EccResult M
     C                     PARM YL0045    WQ0091 50        API EccResult-M
     C                     PARM YL0046    WQ0092 10        API Request Key
     C                     PARM @CN,002   WQ0093 10        Called From Pro
     C                     PARM #1AIC3    WQ0094  30       Company Number
     C                     PARM #1HGCD    WQ0095  70       Item Code
     C                     PARM #1AJCD    WQ0096  3        Ship From Wareh
     C                     PARM 'T'       WQ0097  3        WIM Inventory T
     C                     PARM 'TW'      WQ0098  3        WIM Inventory T
     C                     PARM ##JDT     WQ0099  70       Transaction Dat
     C                     PARM #1ELDT    WQ0100  70       Production Date
     C                     PARM 'IC'      WQ0101  2        Item Transactio
     C                     PARM @CN,001   WQ0102 30        Transaction Des
     C                     PARM *BLANK    WQ0103  3        Transaction Rea
     C                     PARM *ZERO     WQ0104  70       Order Number
     C                     PARM '1'       WQ0105  1        Shift Number
     C                     PARM #1AJCD    WQ0106  3        Ship To Warehou
     C                     PARM YL0036    WQ0107 112       Transaction Wei
     C                     PARM YL0035    WQ0108 112       Transaction Qua
     C                     PARM 'N'       WQ0109  1        Unship Flag
     C                     PARM 'N'       WQ0110  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     SETON                     3232  *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * SR07943 DN 12/21/23-Added 'API EccResult-MsgId U is Entered' Cond
      * CASE: LCL.API EccResult-MsgId U is Entered
     C           YL0044    IFNE *BLANK                     *IF
     C                     MOVEL'N'       YN0001           Inventory Updat
      * 1/6/24 DN SR08283-Added 'API Request Key' as Input Parm.
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Hardstop Failu
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0047    WQ0111 45        API Name
     C                     PARM YL0044    WQ0112  7        API EccResult M
     C                     PARM YL0045    WQ0113 50        API EccResult-M
     C                     PARM YL0046    WQ0114 10        API Request Key
     C                     PARM @CN,002   WQ0115 10        Called From Pro
     C                     PARM #1AIC3    WQ0116  30       Company Number
     C                     PARM #1HGCD    WQ0117  70       Item Code
     C                     PARM #1AJCD    WQ0118  3        Ship From Wareh
     C                     PARM 'T'       WQ0119  3        WIM Inventory T
     C                     PARM 'TW'      WQ0120  3        WIM Inventory T
     C                     PARM ##JDT     WQ0121  70       Transaction Dat
     C                     PARM #1ELDT    WQ0122  70       Production Date
     C                     PARM 'IC'      WQ0123  2        Item Transactio
     C                     PARM @CN,001   WQ0124 30        Transaction Des
     C                     PARM *BLANK    WQ0125  3        Transaction Rea
     C                     PARM *ZERO     WQ0126  70       Order Number
     C                     PARM '1'       WQ0127  1        Shift Number
     C                     PARM #1AJCD    WQ0128  3        Ship To Warehou
     C                     PARM YL0036    WQ0129 112       Transaction Wei
     C                     PARM YL0035    WQ0130 112       Transaction Qua
     C                     PARM 'N'       WQ0131  1        Unship Flag
     C                     PARM 'N'       WQ0132  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     SETON                     3232  *
     C                     END
      * Keep Track of Batch Processing Functions so Email will NOT be Sen
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Called From Program is Exc Upd EDI 944 Trsn   XF
      *   |- c2    : PAR.Called From Program is EDT Confirm Ship Detl  DF
      *   |- c3    : PAR.Called From Program is ADD Ready to Confirm  XL
      *   |- c4    : PAR.Called From Program is Exc Upd EDI 945 Trsn   XF
      *   |- c5    : PAR.Called From Program is PFS Reopen Order      XL
      *   |- c6    : PAR.Called From Program is WW Unship Orders       DF
      *   '-
     C           @CN,002   IFEQ @CN,008                    *IF
     C           @CN,002   OREQ @CN,009                    *OR
     C           @CN,002   OREQ @CN,010                    *OR
     C           @CN,002   OREQ @CN,011                    *OR
     C           @CN,002   OREQ @CN,012                    *OR
     C           @CN,002   OREQ @CN,013                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Send Email to Business & IT.
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,002   WQ0133 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
     C                     END                             *FI
      * Initialize Detail fields
     C                     EXSR UBSUBR                     Initialize Deta
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,014                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,014                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * SEL:  To Location Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Location Code USR
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DYVCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Whs Location      SR - Warehouse Location  * 
     C                     CALL 'PDHSSRR'              90  Sel Whs Locatio
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0134  3        Warehouse Code
     C           #DYVCD    PARM #DYVCD    WQ0135  4        Location Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993237*
     C                     END
     C                     END                             *FI
      * Rtv Lot/Loc/Lvl Info  RT - Item Lot Location  * 
     C                     EXSR TLRVGN
      * LLT Trans Qty
      * CASE: DTL.LLT Trans Qty is GT Zero
     C           #DJ5QT    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1J2QT    #DJ5QT           LLT Transaction
     C                     END                             *FI
      * IC Item Lot Location   NF
      * CASE: PAR.Record Found USR is Record Not Found
     C           P2WXST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     Z-ADD#1LXNM    ZA0001           Lot Number
     C                     MOVEL#1YMCD    ZA0002           Location Code
      * Send message 'Item Lot Location      NF'
     C                     MOVEL'USR2634' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993435*
      *
     C                     END                             *FI
      * Init:  To Location Level
      * CASE: DTL.Item Code is Pancreas
     C           #1HGCD    IFEQ 93210                      *IF
     C                     Z-ADD1         #DSXTX           Location Level
     C                     END                             *FI
      * VAL:  To Location Code
      * CASE: DTL.Location Code USR NE WRK.BLANK
     C           #DYVCD    IFNE WUGSTX                     *IF
      * Val Location Exists   RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0067    P      Warehouse Code
     C                     MOVEL#DYVCD    WL0068    P      Location Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0069    P3VYST    P      Record Found -P
      * CASE: PAR.Record Found -PS CD USR is Record Not Found
     C           P3VYST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0003           Warehouse Code
     C                     MOVEL#DYVCD    ZA0004           Location Code U
      * Send message 'Warehouse Loc DNE'
     C                     MOVEL'USR2705' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993237*
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  To Location Level
      * CASE: DTL.Location Level USR is 0 through 5
     C           #DSXTX    IFGE 0                          *IF
     C           #DSXTX    ANDLE5
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#DSXTX    ZA0005           Location Level
      * Send message 'Level Invalid'
     C                     MOVEL'USR3135' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
      * VAL:  Transfer Quantity
      * CASE: DTL.LLT Trans Qty GT DTL.ILL Item Qty On-Hand
     C           #DJ5QT    IFGT #1J2QT                     *IF
      * Setup message data for message
     C                     Z-ADD#DJ5QT    ZA0006           LLT Transaction
     C                     Z-ADD#1J2QT    ZA0007           ILL Item Qty On
      * Send message 'Trns Qty GT On Hand'
     C                     MOVEL'USR2704' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0337           Company Number
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0338    #DADTX    P      Name
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0339    P      Warehouse Code
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0340    #DF8NA    P      Warehouse Descr
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Item Balance Detail
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993133*
     C                     SETON                     32    *
     C                     END
      * Check reference to Warehouse Location
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993235*
     C                     END
      * Check reference to Item Hold Reason
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR TORVGN
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           *IN79     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Warehouse Code required
     C           #1AJCD    IFEQ *BLANK                     IF
     C           *IN78     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Item Code required
     C           #1HGCD    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Lot Number required
     C           #1LXNM    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Location Code required
     C           #1YMCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Location Code USR required
     C           #DYVCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * LLT Transaction Qty required
     C           #DJ5QT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9939  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P1I8ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1LPDT           ILL Unused Date
     C                     Z-ADD*ZERO     #DLTNT           Lot Number USR
     C                     Z-ADD*ZERO     #1G5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     #1J3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     #1G6WG           ILL Item Wgt On
     C                     Z-ADD*ZERO     #1J4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     #1G7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     #1LQDT           ILL Unused Date
     C                     Z-ADD*ZERO     #1NBR            ILL Unused Nbr
     C                     MOVEL*BLANK    #1YTCD           ILL Customer Co
     C                     MOVEL*BLANK    #1ASSX           ILL Unused Sts
     C                     MOVEL*BLANK    #1ATSX           ILL Unused Sts
     C                     MOVEL*BLANK    #1AUSX           ILL Unused Sts
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     Z-ADD*ZERO     #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVEL*BLANK    #DOONA           Item Desc DRV
     C                     Z-ADD*ZERO     #1LXNM           Lot Number
     C                     Z-ADD*ZERO     #1ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1ELDT
     C                     Z-ADD*ZERO     #1LODT           ILL Avail Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1LODT
     C                     MOVEL*BLANK    #1YMCD           Location Code
     C                     Z-ADD*ZERO     #1J2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     #1YNCD           Location Level
     C                     MOVEL*BLANK    #1AMSX           ILL Status
     C                     MOVEL*BLANK    #1YSCD           Inv Hold Reason
     C                     MOVEL*BLANK    #DYVCD           Location Code U
     C                     Z-ADD*ZERO     #DSXTX           Location Level
     C                     Z-ADD*ZERO     #DJ5QT           LLT Transaction
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR TPRVGN
      * USER: Load screen
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     MOVELP1AJCD    #1AJCD           Warehouse Code
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0337           Company Number
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0338    #DADTX    P      Name
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0339    P      Warehouse Code
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0340    #DF8NA    P      Warehouse Descr
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1ELDT
      * Convert ILL Avail Ship Date to display format
      * Convert date
     C           1000000   ADD  #1LODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1LODT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
     C           *LIKE     DEFN WAAJCD    WQSA03           Warehouse Code
     C           *LIKE     DEFN WALTRT    WQSA04           LLT Transaction
     C           *LIKE     DEFN WALRDT    WQSA05           LLT Transaction
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Item Code
     C                     KFLD           WQSA03           Warehouse Code
     C                     KFLD           WQSA04           LLT Transaction
     C                     KFLD           WQSA05           LLT Transaction
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
     C                     Z-ADDWL0002    WQSA02           Item Code
     C                     MOVELWL0003    WQSA03           Warehouse Code
     C                     MOVELWL0004    WQSA04           LLT Transaction
     C                     Z-ADDWL0005    WQSA05           LLT Transaction
      * Establish starting position
     C           KRSSA     SETLL@L7CPUK                    *
     C           KRSSA     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0006           LLT Sequence Nu
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WALLTS    ADD  1         WL0006           LLT Sequence Nu
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0007    WBAIC3           Company Number
     C                     Z-ADDWL0008    WBHGCD           Item Code
     C                     MOVELWL0009    WBAJCD           Warehouse Code
     C                     MOVELWL0010    WBLTRT           LLT Transaction
     C                     Z-ADDWL0011    WBLRDT           LLT Transaction
     C                     Z-ADDWL0012    WBLLTS           LLT Sequence Nu
     C                     Z-ADDWL0013    WBLSDT           LLT Production
     C                     Z-ADDWL0014    WBJ5QT           LLT Transaction
     C                     Z-ADDWL0015    WBG8WG           LLT Transaction
     C                     Z-ADDWL0016    WBLLTN           LLT Lot Number
     C                     MOVELWL0017    WBYMCD           Location Code
     C                     Z-ADDWL0018    WBLLCL           LLT Location Le
     C                     MOVELWL0019    WBBNAA           Transfer Wareho
     C                     Z-ADDWL0020    WBLLTR           LLT Transfer Lo
     C                     MOVELWL0021    WBY2CD           Transfer Locati
     C                     Z-ADDWL0022    WBLLTL           LLT Transfer Lo
     C                     Z-ADDWL0023    WBC4NB           Order Number
     C                     MOVELWL0024    WBLOST           LLT Status
     C                     MOVELWL0025    WBLLTU           LTT Unused Sts
     C                     MOVELWL0026    WBLLYT           LTT Unused Sts
     C                     MOVELWL0027    WBUVST           EDI Status 1
     C                     MOVELWL0028    WBUWST           EDI Status 2
     C                     MOVELWL0029    WBUXST           EDI Status 3
     C                     MOVELWL0030    WBVSST           Record Status
     C                     Z-ADDWL0031    WBAATM           Job Time
     C                     MOVELWL0032    WBAYNA           User Id
     C                     MOVELWL0033    WBA0NA           Job Name
     C                     Z-ADDWL0034    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C           KLCRSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
     C                     KFLD           WBLTRT           LLT Transaction
     C                     KFLD           WBLRDT           LLT Transaction
     C                     KFLD           WBLLTS           LLT Sequence Nu
      * Check for duplicate primary key
     C           KLCRSB    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0012  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0013  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0014 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0015  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0016 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0017  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0018  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0019  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0020  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0021  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0022  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0023  1        EDI Status 1
     C                     MOVEL*BLANK    WN0024  1        EDI Status 2
     C                     MOVEL*BLANK    WN0025  1        EDI Status 3
     C                     MOVEL*BLANK    WN0026  1        Record Status
     C                     Z-ADD*ZERO     WN0027  60       Job Time
     C                     MOVEL*BLANK    WN0028 10        User Id
     C                     MOVEL*BLANK    WN0029 10        Job Name
     C                     Z-ADD*ZERO     WN0030  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C                     KFLD           WCELDT           Production Date
     C                     KFLD           WCLXNM           Lot Number
     C                     KFLD           WCYMCD           Location Code
     C                     KFLD           WCYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0035    WCAIC3           Company Number
     C                     Z-ADDWL0036    WCHGCD           Item Code
     C                     MOVELWL0037    WCAJCD           Warehouse Code
     C                     Z-ADDWL0038    WCELDT           Production Date
     C                     Z-ADDWL0039    WCLXNM           Lot Number
     C                     MOVELWL0040    WCYMCD           Location Code
     C                     Z-ADDWL0041    WCYNCD           Location Level
      * Establish starting position
     C           KRSSC     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Loc          CR - Item Lot Location  * 
     C                     EXSR SDCRRC
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCJ2QT    ADD  WL0047    WN0012           ILL Item Qty On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0012    IFGT 0                          *IF
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0048           Company Number
     C                     Z-ADDWCHGCD    WL0049           Item Code
     C                     MOVELWCAJCD    WL0050    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0051           Production Date
     C                     Z-ADDWCLXNM    WL0052           Lot Number
     C                     MOVELWCYMCD    WL0053    P      Location Code
     C                     Z-ADDWCYNCD    WL0054           Location Level
     C                     Z-ADDWN0012    WL0055           ILL Item Qty On
     C                     EXSR SECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - IC Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0056           Company Number
     C                     Z-ADDWCHGCD    WL0057           Item Code
     C                     MOVELWCAJCD    WL0058    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0059           Production Date
     C                     Z-ADDWCLXNM    WL0060           Lot Number
     C                     MOVELWCYMCD    WL0061    P      Location Code
     C                     Z-ADDWCYNCD    WL0062           Location Level
     C                     EXSR SFDLRC
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0063           Company Number
     C                     Z-ADDWCHGCD    WL0064           Item Code
     C                     MOVELWCAJCD    WL0065    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0066           Production Date
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0035    WDAIC3           Company Number
     C                     Z-ADDWL0036    WDHGCD           Item Code
     C                     MOVELWL0037    WDAJCD           Warehouse Code
     C                     Z-ADDWL0038    WDELDT           Production Date
     C                     Z-ADDWL0039    WDLXNM           Lot Number
     C                     MOVELWL0040    WDYMCD           Location Code
     C                     Z-ADDWL0041    WDYNCD           Location Level
     C                     Z-ADDWL0047    WDJ2QT           ILL Item Qty On
     C                     Z-ADDWL0042    WDG5WG           ILL Unit Weight
     C                     Z-ADDWN0013    WDJ3QT           ILL Co-Packer L
     C                     Z-ADDWN0014    WDG6WG           ILL Item Wgt On
     C                     Z-ADDWN0015    WDJ4QT           ILL Unused Qty
     C                     Z-ADDWN0016    WDG7WG           ILL Unused Wgt
     C                     Z-ADDWL0043    WDLODT           ILL Avail Ship
     C                     Z-ADDWL0044    WDLPDT           ILL Unused Date
     C                     Z-ADDWN0017    WDLQDT           ILL Unused Date
     C                     Z-ADDWN0018    WDNBR            ILL Unused Nbr
     C                     MOVELWN0019    WDYTCD           ILL Customer Co
     C                     MOVELWL0045    WDAMSX           ILL Status
     C                     MOVELWN0020    WDASSX           ILL Unused Sts
     C                     MOVELWN0021    WDATSX           ILL Unused Sts
     C                     MOVELWN0022    WDAUSX           ILL Unused Sts
     C                     MOVELWL0046    WDYSCD           Inv Hold Reason
     C                     MOVELWN0023    WDUVST           EDI Status 1
     C                     MOVELWN0024    WDUWST           EDI Status 2
     C                     MOVELWN0025    WDUXST           EDI Status 3
     C                     MOVELWN0026    WDVSST           Record Status
     C                     Z-ADDWN0027    WDAATM           Job Time
     C                     MOVELWN0028    WDAYNA           User Id
     C                     MOVELWN0029    WDA0NA           Job Name
     C                     Z-ADDWN0030    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDLXNM           Lot Number
     C                     KFLD           WDYMCD           Location Code
     C                     KFLD           WDYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSD    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0031 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0032  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0033 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0034  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0035 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0036  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0037  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0038  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0039  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0040  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0041  1        ILL Status
     C                     MOVEL*BLANK    WN0042  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0043  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0044  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0045  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0046  1        EDI Status 1
     C                     MOVEL*BLANK    WN0047  1        EDI Status 2
     C                     MOVEL*BLANK    WN0048  1        EDI Status 3
     C                     MOVEL*BLANK    WN0049  1        Record Status
     C                     Z-ADD*ZERO     WN0050  60       Job Time
     C                     MOVEL*BLANK    WN0051 10        User Id
     C                     MOVEL*BLANK    WN0052 10        Job Name
     C                     Z-ADD*ZERO     WN0053  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0048    WDAIC3           Company Number
     C                     Z-ADDWL0049    WDHGCD           Item Code
     C                     MOVELWL0050    WDAJCD    P      Warehouse Code
     C                     Z-ADDWL0051    WDELDT           Production Date
     C                     Z-ADDWL0052    WDLXNM           Lot Number
     C                     MOVELWL0053    WDYMCD    P      Location Code
     C                     Z-ADDWL0054    WDYNCD           Location Level
      *
     C           KLCHSE    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDLXNM           Lot Number
     C                     KFLD           WDYMCD           Location Code
     C                     KFLD           WDYNCD           Location Level
     C           KLCHSE    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YARDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWL0055    WDJ2QT           ILL Item Qty On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - IC Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0054  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0056    WDAIC3           Company Number
     C                     Z-ADDWL0057    WDHGCD           Item Code
     C                     MOVELWL0058    WDAJCD           Warehouse Code
     C                     Z-ADDWL0059    WDELDT           Production Date
     C                     Z-ADDWL0060    WDLXNM           Lot Number
     C                     MOVELWL0061    WDYMCD           Location Code
     C                     Z-ADDWL0062    WDYNCD           Location Level
      *
     C           KLDLSF    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDLXNM           Lot Number
     C                     KFLD           WDYMCD           Location Code
     C                     KFLD           WDYNCD           Location Level
     C           KLDLSF    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADDWL0063    WEAIC3           Company Number
     C                     Z-ADDWL0064    WEHGCD           Item Code
     C                     MOVELWL0065    WEAJCD           Warehouse Code
     C                     Z-ADDWL0066    WEELDT           Production Date
      * Establish starting position
     C           KRSSG     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           WEARQT    IFEQ 0                          *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR SHDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEHGCD    WFHGCD           Item Code
     C                     MOVELWEAJCD    WFAJCD           Warehouse Code
     C                     Z-ADDWEELDT    WFELDT           Production Date
      *
     C           KLDLSH    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLDLSH    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val Location Exists   RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGYMCD           Location Code
      * Setup key
     C                     MOVELWL0067    WGAJCD           Warehouse Code
     C                     MOVELWL0068    WGYMCD           Location Code
      * Establish starting position
     C           KRSSI     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0069           Record Found -P
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0069           Record Found -P
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Whs Location      CR - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L2RESN
     C                     MOVEL#1AJCD    WHAJCD           Warehouse Code
     C                     MOVEL#DYVCD    WHYMCD           Location Code
     C                     MOVELYL0002    WHYPCD           Location Aisle
     C                     Z-ADDYL0004    WHLCBY           Location Bay
     C                     Z-ADD*ZERO     WHLCCT           Loc Unused Chil
     C                     MOVELWUWLUS    WHWLUS           WL Unused Sts 1
     C                     MOVELWUWUSD    WHWUSD           WL Unused Sts 2
     C                     MOVELWUWLUN    WHWLUN           WL PFS Zone
     C                     MOVEL'F'       WHAGSX           WLT Type Code
     C                     MOVELWUUVST    WHUVST           EDI Status 1
     C                     MOVELWUUWST    WHUWST           EDI Status 2
     C                     MOVELWUUXST    WHUXST           EDI Status 3
     C                     MOVELWUVSST    WHVSST           Record Status
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     MOVEL*BLANK    WHAYNA           User Id
     C                     MOVEL*BLANK    WHA0NA           Job Name
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WHVSST           Record Status
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSJ    KLIST
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHYMCD           Location Code
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@L2RESN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2629' W0RTN   7
      * Send message 'Warehouse Location     EX'
     C                     MOVEL'USR2629' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@L2RESN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGYMCD           Location Code
      * Setup key
     C                     MOVEL#1AJCD    WGAJCD           Warehouse Code
     C                     MOVEL#DYVCD    WGYMCD           Location Code
      * Establish starting position
     C           KRSSK     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0055           WLT Type Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAGSX    WN0055           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIAGSX           WLT Type Code
      * Setup key
     C                     MOVELWN0055    WIAGSX           WLT Type Code
      * Establish starting position
     C           KRSSL     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0056           WLT Type Chill
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWISLTY    WN0056           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * RTV Next Tran Batch #  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0066  40       Current Account
     C                     Z-ADD*ZERO     WN0067  20       Current Account
     C                     Z-ADD*ZERO     WN0068  30       OM Week
     C                     Z-ADD*ZERO     WN0069  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0070  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0071  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0072  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN0073  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0074  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0075  70       Next Customer #
     C                     Z-ADD*ZERO     WN0076  70       Next Inventory
     C                     Z-ADD*ZERO     WN0077  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0078  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0079  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0080  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0081  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0082  1        Auto Customers
     C                     MOVEL*BLANK    WN0083  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0084  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0085  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0086 112       Late Charge Min
     C                     MOVEL*BLANK    WN0087  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0088  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0089  1        Allocate Credit
     C                     MOVEL*BLANK    WN0090 30        Message Line 1
     C                     MOVEL*BLANK    WN0091 30        Message Line 2
     C                     MOVEL*BLANK    WN0092 30        Message Line 3
     C                     MOVEL*BLANK    WN0093 30        Message Line 4
     C                     MOVEL*BLANK    WN0094  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0095  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0096  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0097  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0098  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0099  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0100  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0101  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0102  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0103  30       Retention Perio
     C                     Z-ADD*ZERO     WN0104  30       Retention Perio
     C                     Z-ADD*ZERO     WN0105  30       Retention Perio
     C                     Z-ADD*ZERO     WN0106  30       Retention Perio
     C                     Z-ADD*ZERO     WN0107  30       Retention Perio
     C                     Z-ADD*ZERO     WN0108  70       Next Load ID
     C                     MOVEL*BLANK    WN0109  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0110  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0111  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0112  30       Production Numb
     C                     MOVEL*BLANK    WN0113  1        Freight by Poun
     C                     MOVEL*BLANK    WN0114  1        Price Audit Act
     C                     MOVEL*BLANK    WN0115 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0116  1        EDI Status 1
     C                     MOVEL*BLANK    WN0117  1        EDI Status 2
     C                     MOVEL*BLANK    WN0118  1        EDI Status 3
     C                     MOVEL*BLANK    WN0119  1        Record Status
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD#1AIC3    WJAIC3           Company Number
      *
     C           KLCHSM    KLIST
     C                     KFLD           WJAIC3           Company Number
     C           KLCHSM    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YBRDCS
      * USER: Processing after Data read
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADDWJBANB    YL0005           Transfer Batch
     C                     ADD  1         WJBANB           Next HPB Batch
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1HGCD    WEHGCD           Item Code
     C                     MOVEL#1AJCD    WEAJCD           Warehouse Code
     C                     Z-ADD#1ELDT    WEELDT           Production Date
      * Establish starting position
     C           KRSSN     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEK7DT    YL0007           Label Date
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0070    WKAIC3           Company Number
     C                     Z-ADDWL0071    WKHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0072           Description Lin
     C                     MOVEL*BLANK    WL0073           Description Lin
     C                     MOVEL*BLANK    WL0074           UOM Primary
     C                     Z-ADD*ZERO     WL0075           Conversion Fact
     C                     MOVEL*BLANK    WL0076           Operation Facto
     C                     MOVEL*BLANK    WL0077           UOM Second
     C                     Z-ADD*ZERO     WL0078           Conversion Fact
     C                     MOVEL*BLANK    WL0079           Operation Facto
     C                     MOVEL*BLANK    WL0080           UOM Third
     C                     MOVEL*BLANK    WL0081           UOM Pricing
     C                     Z-ADD*ZERO     WL0082           Unit Weight
     C                     MOVEL*BLANK    WL0083           Production Date
     C                     MOVEL*BLANK    WL0084           Catch Weight St
     C                     Z-ADD*ZERO     WL0085           Fresh Chilling
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKAVNA    WL0072           Description Lin
     C                     MOVELWKAWNA    WL0073           Description Lin
     C                     MOVELWKADCD    WL0074           UOM Primary
     C                     Z-ADDWKAWPC    WL0075           Conversion Fact
     C                     MOVELWKLXST    WL0076           Operation Facto
     C                     MOVELWKAECD    WL0077           UOM Second
     C                     Z-ADDWKAXPC    WL0078           Conversion Fact
     C                     MOVELWKLYST    WL0079           Operation Facto
     C                     MOVELWKAFCD    WL0080           UOM Third
     C                     MOVELWKAICD    WL0081           UOM Pricing
     C                     Z-ADDWKAIWG    WL0082           Unit Weight
     C                     MOVELWKFZST    WL0083           Production Date
     C                     MOVELWKAVST    WL0084           Catch Weight St
     C                     Z-ADDWKCHTM    WL0085           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Status/Default     RT - Item Balance  * From Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0086    WLAIC3           Company Number
     C                     Z-ADDWL0087    WLHGCD           Item Code
     C                     MOVELWL0088    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0089           Unit Cost Per P
     C                     MOVEL*BLANK    WL0090           Cost Update Pen
     C                     MOVEL*BLANK    WL0091           Post GL Status
     C                     Z-ADD*ZERO     WL0092           Vendor Item_Whs
     C                     MOVEL*BLANK    WL0093           Record Status
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLAGCS    WL0089           Unit Cost Per P
     C                     MOVELWLJ9ST    WL0090           Cost Update Pen
     C                     MOVELWLKBST    WL0091           Post GL Status
     C                     Z-ADDWLAKC8    WL0092           Vendor Item_Whs
     C                     MOVELWLVSST    WL0093           Record Status
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0034           Module Release
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WMB3AB           Module ID
     C                     KFLD           WMHUNZ           Release Number
      * Setup key
     C                     MOVEL'WIM'     WMB3AB           Module ID
     C                     Z-ADD1         WMHUNZ           Release Number
      * Establish starting position
     C           KRSSQ     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WMVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWMOCSC    YL0034           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0094    WKAIC3           Company Number
     C                     Z-ADDWL0095    WKHGCD           Item Code
      * Establish starting position
     C           KRSSR     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKRINB    WL0096           Item Structure
     C                     Z-ADDWKRHNB    WL0097           Item Structure
     C                     Z-ADDWKRGNB    WL0098           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WOHGCD    WQSS02           Item Code
     C           *LIKE     DEFN WOAJCD    WQSS03           Warehouse Code
     C           *LIKE     DEFN WOW9ST    WQSS04           Inventory Trans
     C           *LIKE     DEFN WOBSST    WQSS05           Inventory Trans
     C           *LIKE     DEFN WOB4DT    WQSS06           Transaction Dat
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Item Code
     C                     KFLD           WQSS03           Warehouse Code
     C                     KFLD           WQSS04           Inventory Trans
     C                     KFLD           WQSS05           Inventory Trans
     C                     KFLD           WQSS06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0099    WQSS01           Company Number
     C                     Z-ADDWL0100    WQSS02           Item Code
     C                     MOVELWL0101    WQSS03           Warehouse Code
     C                     MOVELWL0102    WQSS04           Inventory Trans
     C                     MOVELWL0103    WQSS05           Inventory Trans
     C                     Z-ADDWL0104    WQSS06           Transaction Dat
      * Establish starting position
     C           KRSSS     SETLL@B7CPZA                    *
     C           KRSSS     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0105           ITD Sequence Nu
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WOC4NY    ADD  1         WL0105           ITD Sequence Nu
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0143  60       Job Time
     C                     MOVEL*BLANK    WN0144 10        User Id
     C                     MOVEL*BLANK    WN0145 10        Job Name
     C                     Z-ADD*ZERO     WN0146  70       Job Date
     C                     Z-ADD*ZERO     WN0147  20       Production Hour
     C                     Z-ADD*ZERO     WN0148 112       Production Weig
     C                     Z-ADD*ZERO     WN0149  50       Production Quan
     C                     Z-ADD*ZERO     WN0150  70       Production Piec
     C                     MOVEL*BLANK    WN0151  1        Export_Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0106    WRAIC3           Company Number
     C                     Z-ADDWL0107    WRHGCD           Item Code
     C                     MOVELWL0108    WRAJCD           Warehouse Code
     C                     MOVELWL0109    WRW9ST           Inventory Trans
     C                     MOVELWL0110    WRBSST           Inventory Trans
     C                     Z-ADDWL0111    WRB4DT           Transaction Dat
     C                     Z-ADDWL0112    WRC4NY           ITD Sequence Nu
     C                     Z-ADDWL0113    WRDXNB           Sequence Number
     C                     Z-ADDWL0114    WRELDT           Production Date
     C                     MOVELWL0115    WRHVCD           UOM Transaction
     C                     MOVELWL0116    WRF1ST           Item Transactio
     C                     MOVELWL0117    WRAUNA           Description
     C                     Z-ADDWL0118    WRA5QT           Transaction Qua
     C                     Z-ADDWL0119    WRAHWG           Transaction Wei
     C                     Z-ADDWL0120    WRAKCS           USR Transaction
     C                     MOVELWL0121    WRCGCD           UOM Cost
     C                     Z-ADDWL0122    WRAYVA           Extended Amount
     C                     MOVELWL0123    WRBJNA           Ticket Number
     C                     Z-ADDWL0124    WRCKNB           GL Document Num
     C                     MOVELWL0125    WRBMST           GL Update Statu
     C                     MOVELWL0126    WRCQCD           Reason Code
     C                     MOVELWL0127    WRDTCD           Reference Numbe
     C                     MOVELWL0128    WRMGNA           Lot ID
     C                     Z-ADDWL0129    WRTRBN           Transfer Batch
     C                     Z-ADDWL0130    WRTRBS           Transfer Batch
     C                     Z-ADDWL0131    WRC4NB           Order Number
     C                     Z-ADDWL0132    WRRINB           Item Structure
     C                     Z-ADDWL0133    WRRHNB           Item Structure
     C                     Z-ADDWL0134    WRRGNB           Item Structure
     C                     MOVELWL0135    WRM3NA           Employee Badge
     C                     Z-ADDWL0136    WRAWTM           Production Time
     C                     MOVELWL0137    WRXLCD           Shift Number
     C                     Z-ADDWL0138    WRK7DT           Label Date
     C                     MOVELWL0139    WRUVST           EDI Status 1
     C                     MOVELWL0140    WRUWST           EDI Status 2
     C                     MOVELWL0141    WRUXST           EDI Status 3
     C                     MOVELWL0142    WRVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WRAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WRAATM    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRST    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
     C                     KFLD           WRAJCD           Warehouse Code
     C                     KFLD           WRW9ST           Inventory Trans
     C                     KFLD           WRBSST           Inventory Trans
     C                     KFLD           WRB4DT           Transaction Dat
     C                     KFLD           WRC4NY           ITD Sequence Nu
     C                     KFLD           WRDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRST    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WRAIC3    WQ0003  30       Company Number
     C                     PARM WRHGCD    WQ0004  70       Item Code
     C                     PARM WRAJCD    WQ0005  3        Warehouse Code
     C                     PARM WRW9ST    WQ0006  1        Inventory Trans
     C                     PARM WRBSST    WQ0007  2        Inventory Trans
     C                     PARM WRB4DT    WQ0008  70       Transaction Dat
     C                     PARM WRDXNB    WQ0009  30       Sequence Number
     C                     PARM WRELDT    WQ0010  70       Production Date
     C                     PARM WRHVCD    WQ0011  2        UOM Transaction
     C                     PARM WRF1ST    WQ0012  2        Item Transactio
     C                     PARM WRAUNA    WQ0013 30        Description
     C                     PARM WRA5QT    WQ0014 112       Transaction Qua
     C                     PARM WRAHWG    WQ0015 112       Transaction Wei
     C                     PARM WRAKCS    WQ0016 114       USR Transaction
     C                     PARM WRCGCD    WQ0017  2        UOM Cost
     C                     PARM WRAYVA    WQ0018 112       Extended Amount
     C                     PARM WRBJNA    WQ0019  6        Ticket Number
     C                     PARM WRCKNB    WQ0020  80       GL Document Num
     C                     PARM WRBMST    WQ0021  1        GL Update Statu
     C                     PARM WRCQCD    WQ0022  3        Reason Code
     C                     PARM WRDTCD    WQ0023 15        Reference Numbe
     C                     PARM WRMGNA    WQ0024 10        Lot ID
     C                     PARM WRTRBN    WQ0025  70       Transfer Batch
     C                     PARM WRTRBS    WQ0026  30       Transfer Batch
     C                     PARM WRC4NB    WQ0027  70       Order Number
     C                     PARM WRRINB    WQ0028  30       Item Structure
     C                     PARM WRRHNB    WQ0029  30       Item Structure
     C                     PARM WRRGNB    WQ0030  30       Item Structure
     C                     PARM WRM3NA    WQ0031 10        Employee Badge
     C                     PARM WRAWTM    WQ0032  60       Production Time
     C                     PARM WRXLCD    WQ0033  1        Shift Number
     C                     PARM WRK7DT    WQ0034  70       Label Date
     C                     PARM WRVSST    WQ0035  1        Record Status
     C                     PARM WRAATM    WQ0036  60       Job Time
     C                     PARM WRAXDT    WQ0037  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0152 112       Physical Count
     C                     Z-ADD*ZERO     WN0153 112       Physical Count
     C                     Z-ADD*ZERO     WN0154 112       Physical Count
     C                     Z-ADD*ZERO     WN0155 112       Physical Count
     C                     MOVEL*BLANK    WN0156  1        Physical Count
     C                     Z-ADD*ZERO     WN0157 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0158 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0159 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0160 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0161 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0162 112       Weight In Chill
     C                     MOVEL*BLANK    WN0163  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0164 112       Physical Start
     C                     Z-ADD*ZERO     WN0165 112       Physical Start
     C                     Z-ADD*ZERO     WN0166 112       Physical Start
     C                     Z-ADD*ZERO     WN0167 112       Physical Start
     C                     Z-ADD*ZERO     WN0168  70       Physical Start
     C                     Z-ADD*ZERO     WN0169 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0170 114       Last Cost
     C                     Z-ADD*ZERO     WN0171 112       Value of On Han
     C                     Z-ADD*ZERO     WN0172  70       Label Date
     C                     MOVEL*BLANK    WN0173  1        EDI Status 1
     C                     MOVEL*BLANK    WN0174  1        EDI Status 2
     C                     MOVEL*BLANK    WN0175  1        EDI Status 3
     C                     MOVEL*BLANK    WN0176  1        Record Status
     C                     Z-ADD*ZERO     WN0177  60       Job Time
     C                     MOVEL*BLANK    WN0178 10        User Id
     C                     MOVEL*BLANK    WN0179 10        Job Name
     C                     Z-ADD*ZERO     WN0180  70       Job Date
     C                     MOVEL*BLANK    WN0181  1        Shift Number
     C                     MOVEL*BLANK    WN0182  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0181           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0143    WFAIC3           Company Number
     C                     Z-ADDWL0144    WFHGCD           Item Code
     C                     MOVELWL0145    WFAJCD    P      Warehouse Code
     C                     Z-ADDWL0146    WFELDT           Production Date
      *
     C           KLCHSU    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLCHSU    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0143    WL0169           Company Number
     C                     Z-ADDWL0144    WL0170           Item Code
     C                     MOVELWL0145    WL0171    P      Warehouse Code
     C                     Z-ADDWL0146    WL0172           Production Date
     C                     Z-ADD*ZERO     WL0173           Physical Count
     C                     Z-ADD*ZERO     WL0174           Physical Count
     C                     Z-ADD*ZERO     WL0175           Physical Count
     C                     Z-ADD*ZERO     WL0176           Physical Count
     C                     MOVEL*BLANK    WL0177           Physical Count
     C                     Z-ADDWL0164    WL0178           Quantity on Han
     C                     Z-ADDWL0163    WL0179           Quantity on Han
     C                     Z-ADD*ZERO     WL0180           Quantity on Han
     C                     Z-ADD*ZERO     WL0181           Quantity on Han
     C                     Z-ADD*ZERO     WL0182           Quantity In Chi
     C                     Z-ADD*ZERO     WL0183           Weight In Chill
     C                     MOVEL'N'       WL0184    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0185           Physical Start
     C                     Z-ADD*ZERO     WL0186           Physical Start
     C                     Z-ADD*ZERO     WL0187           Physical Start
     C                     Z-ADD*ZERO     WL0188           Physical Start
     C                     Z-ADD*ZERO     WL0189           Physical Start
     C                     Z-ADD*ZERO     WL0190           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0191           Last Cost
     C                     Z-ADDWL0167    WL0192           Value of On Han
     C                     Z-ADDWL0168    WL0193           Label Date
     C                     Z-ADDWL0147    WL0194           Item Structure
     C                     Z-ADDWL0148    WL0195           Item Structure
     C                     Z-ADDWL0149    WL0196           Item Structure
     C                     MOVEL*BLANK    WL0197           EDI Status 1
     C                     MOVEL*BLANK    WL0198           EDI Status 2
     C                     MOVEL*BLANK    WL0199           EDI Status 3
     C                     MOVEL'A'       WL0200    P      Record Status
     C                     EXSR SVCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YCRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWL0147    WFRINB           Item Structure
     C                     Z-ADDWL0148    WFRHNB           Item Structure
     C                     Z-ADDWL0149    WFRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
     C                     ADD  WL0163    WFARQT           Quantity on Han
     C                     ADD  WL0164    WFACWG           Quantity on Han
     C                     ADD  WL0167    WFIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WFARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0040  30       Company Number
     C                     PARM WFHGCD    WQ0041  70       Item Code
     C                     PARM WFAJCD    WQ0042  3        Warehouse Code
     C                     PARM WL0161    WQ0043  70       Transaction Dat
     C                     PARM WFELDT    WQ0044  70       Production Date
     C                     PARM WL0162    WQ0045  2        UOM Transaction
     C                     PARM WFACWG    WQ0046 112       Transaction Wei
     C                     PARM WL0165    WQ0047 114       USR Transaction
     C                     PARM WL0166    WQ0048  2        UOM Cost
     C                     PARM WFRINB    WQ0049  30       Item Structure
     C                     PARM WFRHNB    WQ0050  30       Item Structure
     C                     PARM WFRGNB    WQ0051  30       Item Structure
     C                     PARM WN0181    WQ0052  1        Shift Number
     C                     PARM WFK7DT    WQ0053  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WFACWG           Quantity on Han
     C                     Z-ADD*ZERO     WFIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WFAXDT    PARM *ZERO     WQ0054 155       Current System
     C           WFAATM    PARM *ZERO     WQ0055 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WFARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWFAJCD    WL0201    P      Warehouse Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0202    WN0182    P      Lot Tracking Fl
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0182    IFEQ *BLANK                     *IF
     C           WN0182    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0203           Company Number
     C                     Z-ADDWFHGCD    WL0204           Item Code
     C                     MOVELWFAJCD    WL0205    P      Warehouse Code
     C                     Z-ADDWFELDT    WL0206           Production Date
     C                     EXSR SXDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0183  60       Job Time
     C                     MOVEL*BLANK    WN0184 10        User Id
     C                     MOVEL*BLANK    WN0185 10        Job Name
     C                     Z-ADD*ZERO     WN0186  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0169    WFAIC3           Company Number
     C                     Z-ADDWL0170    WFHGCD           Item Code
     C                     MOVELWL0171    WFAJCD           Warehouse Code
     C                     Z-ADDWL0172    WFELDT           Production Date
     C                     Z-ADDWL0173    WFABWG           Physical Count
     C                     Z-ADDWL0174    WFAGQT           Physical Count
     C                     Z-ADDWL0175    WFAHQT           Physical Count
     C                     Z-ADDWL0176    WFAIQT           Physical Count
     C                     MOVELWL0177    WFCTST           Physical Count
     C                     Z-ADDWL0178    WFACWG           Quantity on Han
     C                     Z-ADDWL0179    WFARQT           Quantity on Han
     C                     Z-ADDWL0180    WFASQT           Quantity on Han
     C                     Z-ADDWL0181    WFATQT           Quantity on Han
     C                     Z-ADDWL0182    WFHDQT           Quantity In Chi
     C                     Z-ADDWL0183    WFHEQT           Weight In Chill
     C                     MOVELWL0184    WFF6ST           Update Exceptio
     C                     Z-ADDWL0185    WFBMWG           Physical Start
     C                     Z-ADDWL0186    WFDSQT           Physical Start
     C                     Z-ADDWL0187    WFDTQT           Physical Start
     C                     Z-ADDWL0188    WFDUQT           Physical Start
     C                     Z-ADDWL0189    WFDHDT           Physical Start
     C                     Z-ADDWL0190    WFAGCS           Unit Cost Per P
     C                     Z-ADDWL0191    WFAECS           Last Cost
     C                     Z-ADDWL0192    WFIDVA           Value of On Han
     C                     Z-ADDWL0193    WFK7DT           Label Date
     C                     Z-ADDWL0194    WFRINB           Item Structure
     C                     Z-ADDWL0195    WFRHNB           Item Structure
     C                     Z-ADDWL0196    WFRGNB           Item Structure
     C                     MOVELWL0197    WFUVST           EDI Status 1
     C                     MOVELWL0198    WFUWST           EDI Status 2
     C                     MOVELWL0199    WFUXST           EDI Status 3
     C                     MOVELWL0200    WFVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WFAXDT    PARM *ZERO     WQ0038 155       Current System
     C           WFAATM    PARM *ZERO     WQ0039 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSV    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSV    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0201    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSSW     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0202           Lot Tracking Fl
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSVHST    WL0202           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0203    WFAIC3           Company Number
     C                     Z-ADDWL0204    WFHGCD           Item Code
     C                     MOVELWL0205    WFAJCD           Warehouse Code
     C                     Z-ADDWL0206    WFELDT           Production Date
      *
     C           KLDLSX    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLDLSX    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0210           Quantity on Han
     C                     Z-ADD*ZERO     WL0211           Quantity on Han
     C                     Z-ADD*ZERO     WL0212           Quantity on Han
     C                     Z-ADD*ZERO     WL0213           Quantity on Han
     C                     Z-ADD*ZERO     WL0214           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WTHGCD    WQSY02           Item Code
     C           *LIKE     DEFN WTAJCD    WQSY03           Warehouse Code
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Item Code
     C                     KFLD           WQSY03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0207    WQSY01           Company Number
     C                     Z-ADDWL0208    WQSY02           Item Code
     C                     MOVELWL0209    WQSY03           Warehouse Code
      * Establish starting position
     C           KRSSY     SETLLCAB1RL4                    *
     C           KRSSY     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WTACWG    WL0210           Quantity on Han
     C                     ADD  WTARQT    WL0211           Quantity on Han
     C                     ADD  WTASQT    WL0212           Quantity on Han
     C                     ADD  WTATQT    WL0213           Quantity on Han
     C                     ADD  WTIDVA    WL0214           Value of On Han
     C           KRSSY     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0187 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0188 114       Last Cost
     C                     Z-ADD*ZERO     WN0189 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0190 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0191 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0192  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0193  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0194 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0195  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0196 112       On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0197 112       On Hand UOM3 Su
     C                     Z-ADD*ZERO     WN0198 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0199 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0200 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0201 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0202 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0203 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0204 112       Quantity Avail
     C                     MOVEL*BLANK    WN0205  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0206  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0207  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0208  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0209  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0210 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0211  70       Stock Out Date
     C                     MOVEL*BLANK    WN0212  3        Buyer Code
     C                     Z-ADD*ZERO     WN0213  30       Lead Time Last
     C                     Z-ADD*ZERO     WN0214  70       Lead Time Date
     C                     Z-ADD*ZERO     WN0215  30       Lead Time Next
     C                     Z-ADD*ZERO     WN0216  70       Lead Time Date
     C                     MOVEL*BLANK    WN0217  1        Lead Time Excep
     C                     Z-ADD*ZERO     WN0218 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0219 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0220  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0221 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0222 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0223  70       Last Physical C
     C                     MOVEL*BLANK    WN0224  1        Requisition Mod
     C                     MOVEL*BLANK    WN0225  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0226  1        Post GL Status
     C                     Z-ADD*ZERO     WN0227  80       Vendor Item_Whs
     C                     Z-ADD*ZERO     WN0228  30       Item Structure
     C                     Z-ADD*ZERO     WN0229  30       Item Structure
     C                     Z-ADD*ZERO     WN0230  30       Item Structure
     C                     MOVEL*BLANK    WN0231  1        EDI Status 1
     C                     MOVEL*BLANK    WN0232  1        EDI Status 2
     C                     MOVEL*BLANK    WN0233  1        EDI Status 3
     C                     MOVEL*BLANK    WN0234  1        Record Status
     C                     Z-ADD*ZERO     WN0235  60       Job Time
     C                     MOVEL*BLANK    WN0236 10        User Id
     C                     MOVEL*BLANK    WN0237 10        Job Name
     C                     Z-ADD*ZERO     WN0238  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWL0215    WVAIC3           Company Number
     C                     Z-ADDWL0216    WVHGCD           Item Code
     C                     MOVELWL0217    WVAJCD    P      Warehouse Code
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
     C           KLCHSZ    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YDRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWL0218    WVBOWG           On Hand Weight
     C                     Z-ADDWL0219    WVDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0220    WVIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YDRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWVDDQT    WVDOQT           Quantity Avail
     C                     SUB  WVAQQT    WVDOQT           Quantity Avail
     C                     SUB  WVAUQT    WVDOQT           Quantity Avail
     C                     SUB  WVEMQT    WVDOQT           Quantity Avail
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0221    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTA     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0222           Warehouse Descr
     C                     MOVEL*BLANK    WL0223           Address Line 1
     C                     MOVEL*BLANK    WL0224           Address Line 2
     C                     MOVEL*BLANK    WL0225           Address Line 3
     C                     MOVEL*BLANK    WL0226           City
     C                     MOVEL*BLANK    WL0227           Zip Postal Code
     C                     MOVEL*BLANK    WL0228           Production Ware
     C                     MOVEL*BLANK    WL0229           State Code
     C                     MOVEL*BLANK    WL0230           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0231           Default Printer
     C                     MOVEL*BLANK    WL0232           Warehouse Type
     C                     MOVEL*BLANK    WL0233           Trans Contol AS
     C                     MOVEL*BLANK    WL0234           Warehouse Locat
     C                     MOVEL*BLANK    WL0235           Warehouse Std C
     C                     Z-ADD*ZERO     WL0236           Warehouse Chill
     C                     MOVEL*BLANK    WL0237           Include in Auto
     C                     MOVEL*BLANK    WL0238           Default Manifes
     C                     MOVEL*BLANK    WL0239           Default Load Se
     C                     MOVEL*BLANK    WL0240           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0241           Shipping Compan
     C                     Z-ADD*ZERO     WL0242           Accounting Comp
     C                     Z-ADD*ZERO     WL0243           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0244           WHS Inventory C
     C                     MOVEL*BLANK    WL0245           Parent Warehous
     C                     MOVEL*BLANK    WL0246           Default Shippin
     C                     MOVEL*BLANK    WL0247           WHS Live with C
     C                     MOVEL*BLANK    WL0248           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0249           WHS Req Meter R
     C                     MOVEL*BLANK    WL0250           WHS Default Loa
     C                     MOVEL*BLANK    WL0251           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0252           Default Carrier
     C                     MOVEL*BLANK    WL0253           Inventory Logic
     C                     MOVEL*BLANK    WL0254           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0255           EDI Status 1
     C                     MOVEL*BLANK    WL0256           EDI Status 2
     C                     MOVEL*BLANK    WL0257           EDI Status 3
     C                     MOVEL*BLANK    WL0258           Record Status
     C                     Z-ADD*ZERO     WL0259           Job Time
     C                     MOVEL*BLANK    WL0260           User Id
     C                     MOVEL*BLANK    WL0261           Job Name
     C                     Z-ADD*ZERO     WL0262           Job Date
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSF8NA    WL0222           Warehouse Descr
     C                     MOVELWSACNA    WL0223           Address Line 1
     C                     MOVELWSADNA    WL0224           Address Line 2
     C                     MOVELWSAENA    WL0225           Address Line 3
     C                     MOVELWSAJNA    WL0226           City
     C                     MOVELWSBTTX    WL0227           Zip Postal Code
     C                     MOVELWSAOCD    WL0228           Production Ware
     C                     MOVELWSBGCD    WL0229           State Code
     C                     MOVELWSVHST    WL0230           Lot Tracking Fl
     C                     MOVELWSMPNA    WL0231           Default Printer
     C                     MOVELWSWPST    WL0232           Warehouse Type
     C                     MOVELWSXUST    WL0233           Trans Contol AS
     C                     MOVELWST0ST    WL0234           Warehouse Locat
     C                     MOVELWST1ST    WL0235           Warehouse Std C
     C                     Z-ADDWSDBNB    WL0236           Warehouse Chill
     C                     MOVELWST2ST    WL0237           Include in Auto
     C                     MOVELWST3ST    WL0238           Default Manifes
     C                     MOVELWST4ST    WL0239           Default Load Se
     C                     MOVELWST6ST    WL0240           WHS Slotting Li
     C                     Z-ADDWSBWC3    WL0241           Shipping Compan
     C                     Z-ADDWSBTC3    WL0242           Accounting Comp
     C                     Z-ADDWSBUC3    WL0243           WHS Sched Prod
     C                     Z-ADDWSBVC3    WL0244           WHS Inventory C
     C                     MOVELWSFCAA    WL0245           Parent Warehous
     C                     MOVELWSRQSX    WL0246           Default Shippin
     C                     MOVELWSRRSX    WL0247           WHS Live with C
     C                     MOVELWSRSSX    WL0248           WHS PFS Interfa
     C                     MOVELWSRTSX    WL0249           WHS Req Meter R
     C                     MOVELWST7ST    WL0250           WHS Default Loa
     C                     MOVELWST8ST    WL0251           WHS TMS Plannin
     C                     MOVELWSRNSX    WL0252           Default Carrier
     C                     MOVELWSROSX    WL0253           Inventory Logic
     C                     MOVELWSRPSX    WL0254           WHS Auto Inv Re
     C                     MOVELWSUVST    WL0255           EDI Status 1
     C                     MOVELWSUWST    WL0256           EDI Status 2
     C                     MOVELWSUXST    WL0257           EDI Status 3
     C                     MOVELWSVSST    WL0258           Record Status
     C                     Z-ADDWSAATM    WL0259           Job Time
     C                     MOVELWSAYNA    WL0260           User Id
     C                     MOVELWSA0NA    WL0261           Job Name
     C                     Z-ADDWSAXDT    WL0262           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAJCD    WQTB01           Warehouse Code
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Warehouse Code
      * Setup key
     C                     MOVELWL0263    WQTB01           Warehouse Code
      * Establish starting position
     C           KRSTB     SETLL@L2RESM                    *
     C           KRSTB     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0264           Location Code
     C                     MOVEL*BLANK    WL0265           Location Aisle
     C                     Z-ADD*ZERO     WL0266           Location Bay
     C                     Z-ADD*ZERO     WL0267           Loc Unused Chil
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGYMCD    WL0264           Location Code
     C                     MOVELWGYPCD    WL0265           Location Aisle
     C                     Z-ADDWGLCBY    WL0266           Location Bay
     C                     Z-ADDWGLCCT    WL0267           Loc Unused Chil
     C                     GOTO TBEXIT                     *QUIT
     C           KRSTB     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0268    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0269           Shipping Compan
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSBWC3    WL0269           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Val Item Balance       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWHGCD           Item Code
     C                     KFLD           WWAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0270    WWAIC3           Company Number
     C                     Z-ADDWL0271    WWHGCD           Item Code
     C                     MOVELWL0272    WWAJCD           Warehouse Code
      * Establish starting position
     C           KRSTD     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0239  60       Job Time
     C                     MOVEL*BLANK    WN0240 10        User Id
     C                     MOVEL*BLANK    WN0241 10        Job Name
     C                     Z-ADD*ZERO     WN0242  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDWL0273    WVAIC3           Company Number
     C                     Z-ADDWL0274    WVHGCD           Item Code
     C                     MOVELWL0275    WVAJCD           Warehouse Code
     C                     Z-ADDWL0276    WVAGCS           Unit Cost Per P
     C                     Z-ADDWL0277    WVAECS           Last Cost
     C                     Z-ADDWL0278    WVBACS           Cost per Primar
     C                     Z-ADDWL0279    WVBBCS           Cost per Pricin
     C                     Z-ADDWL0280    WVCBPR           Revaluation Cos
     C                     Z-ADDWL0281    WVGUDT           Revaluation Eff
     C                     MOVELWL0282    WVXYST           Revaluation Cos
     C                     Z-ADDWL0283    WVCTPR           Last Revaluatio
     C                     Z-ADDWL0284    WVG4DT           Last Revaluatio
     C                     Z-ADDWL0285    WVBOWG           On Hand Weight
     C                     Z-ADDWL0286    WVDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0287    WVDEQT           On Hand UOM2 Su
     C                     Z-ADDWL0288    WVDFQT           On Hand UOM3 Su
     C                     Z-ADDWL0289    WVHDQT           Quantity In Chi
     C                     Z-ADDWL0290    WVHEQT           Weight In Chill
     C                     Z-ADDWL0291    WVAJQT           Quantity Schedu
     C                     Z-ADDWL0292    WVAQQT           Quantity on Sal
     C                     Z-ADDWL0293    WVAUQT           Quantity on Pur
     C                     Z-ADDWL0294    WVEMQT           Quantity on Tra
     C                     Z-ADDWL0295    WVDOQT           Quantity Avail
     C                     MOVELWL0296    WVATNA           Cycle Count Cod
     C                     Z-ADDWL0297    WVAKDT           Date of Last Or
     C                     Z-ADDWL0298    WVANDT           Date of Last Sh
     C                     Z-ADDWL0299    WVIDVA           Value of On Han
     C                     MOVELWL0300    WVJVST           Inventory Plann
     C                     Z-ADDWL0301    WVBZPC           Safety Allowanc
     C                     Z-ADDWL0302    WVDGQT           Safety Allowanc
     C                     Z-ADDWL0303    WVDIDT           Stock Out Date
     C                     MOVELWL0304    WVALCD           Buyer Code
     C                     Z-ADDWL0305    WVBFDY           Lead Time Last
     C                     Z-ADDWL0306    WVDJDT           Lead Time Date
     C                     Z-ADDWL0307    WVBGDY           Lead Time Next
     C                     Z-ADDWL0308    WVDKDT           Lead Time Date
     C                     MOVELWL0309    WVJ2ST           Lead Time Excep
     C                     Z-ADDWL0310    WVDJQT           Usage Qty per C
     C                     Z-ADDWL0311    WVBNWG           Usage Weight pe
     C                     Z-ADDWL0312    WVDLDT           Inventory Manag
     C                     Z-ADDWL0313    WVDPQT           Minimum Quantit
     C                     Z-ADDWL0314    WVDQQT           Maximum Quantit
     C                     Z-ADDWL0315    WVDMDT           Last Physical C
     C                     MOVELWL0316    WVM0ST           Requisition Mod
     C                     MOVELWL0317    WVJ9ST           Cost Update Pen
     C                     MOVELWL0318    WVKBST           Post GL Status
     C                     Z-ADDWL0319    WVAKC8           Vendor Item_Whs
     C                     Z-ADDWL0320    WVRINB           Item Structure
     C                     Z-ADDWL0321    WVRHNB           Item Structure
     C                     Z-ADDWL0322    WVRGNB           Item Structure
     C                     MOVELWL0323    WVUVST           EDI Status 1
     C                     MOVELWL0324    WVUWST           EDI Status 2
     C                     MOVELWL0325    WVUXST           EDI Status 3
     C                     MOVELWL0326    WVVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
     C           KLCRTE    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTE    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0243  2        UOM Cost
     C                     Z-ADD*ZERO     WN0244 112       Extended Amount
     C                     MOVEL*BLANK    WN0245  1        GL Update Statu
     C                     MOVEL*BLANK    WN0246 30        Description Lin
     C                     MOVEL*BLANK    WN0247  2        UOM Primary
     C                     Z-ADD*ZERO     WN0248  94       Conversion Fact
     C                     MOVEL*BLANK    WN0249  1        Operation Facto
     C                     MOVEL*BLANK    WN0250  2        UOM Second
     C                     Z-ADD*ZERO     WN0251  94       Conversion Fact
     C                     MOVEL*BLANK    WN0252  1        Operation Facto
     C                     MOVEL*BLANK    WN0253  2        UOM Third
     C                     MOVEL*BLANK    WN0254  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0255 112       Unit Weight
     C                     MOVEL*BLANK    WN0256  1        Production Date
     C                     MOVEL*BLANK    WN0257  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0258  30       Item Structure
     C                     Z-ADD*ZERO     WN0259  30       Item Structure
     C                     Z-ADD*ZERO     WN0260  30       Item Structure
     C                     Z-ADD*ZERO     WN0261 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0262 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0263 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0264 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0265 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXAJCD           Warehouse Code
     C                     KFLD           WXW9ST           Inventory Trans
     C                     KFLD           WXBSST           Inventory Trans
     C                     KFLD           WXB4DT           Transaction Dat
     C                     KFLD           WXC4NY           ITD Sequence Nu
     C                     KFLD           WXDXNB           Sequence Number
      * Setup key
     C                     Z-ADDWL0327    WXAIC3           Company Number
     C                     Z-ADDWL0328    WXHGCD           Item Code
     C                     MOVELWL0329    WXAJCD           Warehouse Code
     C                     MOVELWL0330    WXW9ST           Inventory Trans
     C                     MOVELWL0331    WXBSST           Inventory Trans
     C                     Z-ADDWL0332    WXB4DT           Transaction Dat
     C                     Z-ADDWL0333    WXC4NY           ITD Sequence Nu
     C                     Z-ADDWL0334    WXDXNB           Sequence Number
      * Establish starting position
     C           KRSTF     CHAINRB7CPJ3              90    *
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0070           Company Number
     C                     Z-ADDWXHGCD    WL0071           Item Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    WN0246    P      Description Lin
     C                     MOVELWL0073    WUAWNA    P      Description Lin
     C                     MOVELWL0074    WN0247    P      UOM Primary
     C                     Z-ADDWL0075    WN0248           Conversion Fact
     C                     MOVELWL0076    WN0249    P      Operation Facto
     C                     MOVELWL0077    WN0250    P      UOM Second
     C                     Z-ADDWL0078    WN0251           Conversion Fact
     C                     MOVELWL0079    WN0252    P      Operation Facto
     C                     MOVELWL0080    WN0253    P      UOM Third
     C                     MOVELWL0081    WUAICD    P      UOM Pricing
     C                     Z-ADDWL0082    WN0255           Unit Weight
     C                     MOVELWL0083    WN0256    P      Production Date
     C                     MOVELWL0084    WN0257    P      Catch Weight St
     C                     Z-ADDWL0085    WUCHTM           Fresh Chilling
      * Rtv Quantity/Dollars   RT - Item Balance  * 
     C                     EXSR TGRVGN
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
     C                     EXSR THCHRC
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWXAIC3    WLAIC3           Company Number
     C                     Z-ADDWXHGCD    WLHGCD           Item Code
     C                     MOVELWXAJCD    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSTG     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0265           Unit Cost Per P
     C                     Z-ADD*ZERO     WN0261           On Hand Weight
     C                     Z-ADD*ZERO     WN0262           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0263           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0264           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WUIDVA           Value of On Han
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLAGCS    WN0265           Unit Cost Per P
     C                     Z-ADDWLBOWG    WN0261           On Hand Weight
     C                     Z-ADDWLDDQT    WN0262           On Hand UOM1 Su
     C                     Z-ADDWLDEQT    WN0263           On Hand UOM2 Su
     C                     Z-ADDWLDFQT    WN0264           On Hand UOM3 Su
     C                     Z-ADDWLIDVA    WUIDVA           Value of On Han
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0266 112       Quantity based
     C                     Z-ADD*ZERO     WN0267 112       Quantity based
     C                     Z-ADD*ZERO     WN0268 112       Quantity based
     C                     Z-ADD*ZERO     WN0269 114       Cost based on U
     C                     Z-ADD*ZERO     WN0270 114       Cost based on U
     C                     Z-ADD*ZERO     WN0271 114       Cost based on U
     C                     Z-ADD*ZERO     WN0272 112       Quantity Total
     C                     Z-ADD*ZERO     WN0273 112       Quantity Total
     C                     Z-ADD*ZERO     WN0274 112       Cost Replace Do
     C                     Z-ADD*ZERO     WN0275 112       USR Allocated P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      *
     C                     Z-ADD*ZERO     WN0276 114       Cost based on U
     C                     Z-ADD*ZERO     WN0277 114       Cost based on U
     C                     Z-ADD*ZERO     WN0278 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0269           Cost based on U
     C                     Z-ADD*ZERO     WN0270           Cost based on U
     C                     Z-ADD*ZERO     WN0271           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0247    IFEQ WXCGCD                     *IF
     C                     Z-ADDWN0265    WN0269           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0250    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE 0                          *IF
     C           WN0265    DIV  WN0248    WN0277    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
     C           WN0265    MULT WN0248    WN0277    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0277    WN0270           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE 0                          *IF
     C           WN0277    DIV  WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
     C           WN0277    MULT WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0250    IFEQ WXCGCD                     *IF
     C                     Z-ADDWN0265    WN0270           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
     C           WN0265    MULT WN0248    WN0269    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE 0                          *IF
     C           WN0265    DIV  WN0248    WN0269    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE 0                          *IF
     C           WN0265    DIV  WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
     C           WN0265    MULT WN0251    WN0271    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0253    IFEQ WXCGCD                     *IF
     C                     Z-ADDWN0265    WN0271           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
     C           WN0265    MULT WN0251    WN0277    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE 0                          *IF
     C           WN0265    DIV  WN0251    WN0277    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0277    WN0270           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
     C           WN0277    MULT WN0248    WN0269    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE 0                          *IF
     C           WN0277    DIV  WN0248    WN0269    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0279 112       Quantity based
     C                     Z-ADD*ZERO     WN0280 112       Quantity based
     C                     Z-ADD*ZERO     WN0281 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0266           USR Qty based o
     C                     Z-ADD*ZERO     WN0267           USR Qty based o
     C                     Z-ADD*ZERO     WN0268           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0247    IFEQ WXHVCD                     *IF
     C                     Z-ADDWXA5QT    WN0266           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0250    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
     C           WXA5QT    MULT WN0248    WN0280    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE 0                          *IF
     C           WXA5QT    DIV  WN0248    WN0280    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0280    WN0267           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
     C           WN0280    MULT WN0251    WN0281    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE 0                          *IF
     C           WN0280    DIV  WN0251    WN0281    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0281    WN0268           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0250    IFEQ WXHVCD                     *IF
     C                     Z-ADDWXA5QT    WN0267           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE 0                          *IF
     C           WXA5QT    DIV  WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
     C           WXA5QT    MULT WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0253    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
     C           WXA5QT    MULT WN0251    WN0281    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE 0                          *IF
     C           WXA5QT    DIV  WN0251    WN0281    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0281    WN0268           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0253    IFEQ WXHVCD                     *IF
     C                     Z-ADDWXA5QT    WN0268           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0252    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0251    IFNE 0                          *IF
     C           WXA5QT    DIV  WN0251    WN0280    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0252    IFEQ 'D'                        *IF
     C           WXA5QT    MULT WN0251    WN0280    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0280    WN0267           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0249    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0248    IFNE 0                          *IF
     C           WN0280    DIV  WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0249    IFEQ 'D'                        *IF
     C           WN0280    MULT WN0248    WN0266    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWXAIC3    WVAIC3           Company Number
     C                     Z-ADDWXHGCD    WVHGCD           Item Code
     C                     MOVELWXAJCD    WVAJCD    P      Warehouse Code
      *
     C           KLCHTH    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
     C           KLCHTH    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YERDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YERDC            *Record Data Ch
      * (Creates IB if not found or updates if it exists)
      * Update IC Item Balance Detail
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
     C                     EXSR TIRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0207           Company Number
     C                     Z-ADDWVHGCD    WL0208           Item Code
     C                     MOVELWVAJCD    WL0209    P      Warehouse Code
     C                     Z-ADDWVBOWG    WL0210           Quantity on Han
     C                     Z-ADDWVDDQT    WL0211           Quantity on Han
     C                     Z-ADDWUNFNN    WL0212           Quantity on Han
     C                     Z-ADDWUNFNN    WL0213           Quantity on Han
     C                     Z-ADDWVIDVA    WL0214           Value of On Han
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0210    WVBOWG           Quantity on Han
     C                     Z-ADDWL0211    WVDDQT           Quantity on Han
     C                     Z-ADDWL0212    WUNFNN           Quantity on Han
     C                     Z-ADDWL0213    WUNFNN           Quantity on Han
     C                     Z-ADDWL0214    WVIDVA           Value of On Han
     C                     Z-ADD*ZERO     WVDOQT           Available Prima
      * Available Primary U/M
     C           WVDDQT    SUB  WVAJQT    WVDOQT           Available Prima
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WVAATM' defaulted for 'Job Time'.
      * Field '(DB1) WVAYNA' defaulted for 'User Id'.
      * Field '(DB1) WVA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WVAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0282 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0283 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0284 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0285 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0286 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0287 114       Last Cost
     C                     Z-ADD*ZERO     WN0288 112       Value of On Han
     C                     MOVEL*BLANK    WN0289  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADDWVAIC3    WEAIC3           Company Number
     C                     Z-ADDWVHGCD    WEHGCD           Item Code
     C                     MOVELWVAJCD    WEAJCD           Warehouse Code
     C                     Z-ADDWXELDT    WEELDT           Production Date
      * Establish starting position
     C           KRSTI     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
     C           WN0266    IFEQ WUW0NB                     *IF
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0169           Company Number
     C                     Z-ADDWVHGCD    WL0170           Item Code
     C                     MOVELWVAJCD    WL0171    P      Warehouse Code
     C                     Z-ADDWXELDT    WL0172           Production Date
     C                     Z-ADD*ZERO     WL0173           Physical Count
     C                     Z-ADD*ZERO     WL0174           Physical Count
     C                     Z-ADD*ZERO     WL0175           Physical Count
     C                     Z-ADD*ZERO     WL0176           Physical Count
     C                     MOVEL*BLANK    WL0177           Physical Count
     C                     Z-ADD*ZERO     WL0178           Quantity on Han
     C                     Z-ADDWN0266    WL0179           Quantity on Han
     C                     Z-ADD*ZERO     WL0180           Quantity on Han
     C                     Z-ADD*ZERO     WL0181           Quantity on Han
     C                     Z-ADD*ZERO     WL0182           Quantity In Chi
     C                     Z-ADD*ZERO     WL0183           Weight In Chill
     C                     MOVEL'N'       WL0184    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0185           Physical Start
     C                     Z-ADD*ZERO     WL0186           Physical Start
     C                     Z-ADD*ZERO     WL0187           Physical Start
     C                     Z-ADD*ZERO     WL0188           Physical Start
     C                     Z-ADD*ZERO     WL0189           Physical Start
     C                     Z-ADD*ZERO     WL0190           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0191           Last Cost
     C                     Z-ADD*ZERO     WL0192           Value of On Han
     C                     Z-ADDWXK7DT    WL0193           Label Date
     C                     Z-ADDWVRINB    WL0194           Item Structure
     C                     Z-ADDWVRHNB    WL0195           Item Structure
     C                     Z-ADDWVRGNB    WL0196           Item Structure
     C                     MOVEL*BLANK    WL0197           EDI Status 1
     C                     MOVEL*BLANK    WL0198           EDI Status 2
     C                     MOVEL*BLANK    WL0199           EDI Status 3
     C                     MOVEL'A'       WL0200    P      Record Status
     C                     EXSR SVCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0169           Company Number
     C                     Z-ADDWVHGCD    WL0170           Item Code
     C                     MOVELWVAJCD    WL0171    P      Warehouse Code
     C                     Z-ADDWXELDT    WL0172           Production Date
     C                     Z-ADD*ZERO     WL0173           Physical Count
     C                     Z-ADD*ZERO     WL0174           Physical Count
     C                     Z-ADD*ZERO     WL0175           Physical Count
     C                     Z-ADD*ZERO     WL0176           Physical Count
     C                     MOVEL*BLANK    WL0177           Physical Count
     C                     Z-ADDWXAHWG    WL0178           Quantity on Han
     C                     Z-ADDWN0266    WL0179           Quantity on Han
     C                     Z-ADD*ZERO     WL0180           Quantity on Han
     C                     Z-ADD*ZERO     WL0181           Quantity on Han
     C                     Z-ADD*ZERO     WL0182           Quantity In Chi
     C                     Z-ADD*ZERO     WL0183           Weight In Chill
     C                     MOVEL'N'       WL0184    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0185           Physical Start
     C                     Z-ADD*ZERO     WL0186           Physical Start
     C                     Z-ADD*ZERO     WL0187           Physical Start
     C                     Z-ADD*ZERO     WL0188           Physical Start
     C                     Z-ADD*ZERO     WL0189           Physical Start
     C                     Z-ADD*ZERO     WL0190           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0191           Last Cost
     C                     Z-ADDWXAYVA    WL0192           Value of On Han
     C                     Z-ADDWXK7DT    WL0193           Label Date
     C                     Z-ADDWVRINB    WL0194           Item Structure
     C                     Z-ADDWVRHNB    WL0195           Item Structure
     C                     Z-ADDWVRGNB    WL0196           Item Structure
     C                     MOVEL*BLANK    WL0197           EDI Status 1
     C                     MOVEL*BLANK    WL0198           EDI Status 2
     C                     MOVEL*BLANK    WL0199           EDI Status 3
     C                     MOVEL'A'       WL0200    P      Record Status
     C                     EXSR SVCRRC
     C                     END                             *FI
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cycle Count
     C           WXBSST    IFEQ 'AC'                       *IF
     C           WEIDVA    ADD  WXAYVA    WN0288           Value of On Han
     C                     ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C           WXBSST    IFEQ 'R'                        *IF
     C           WXBSST    OREQ 'RP'
     C           WXBSST    OREQ 'S'
     C           WXBSST    OREQ 'TW'
     C           WXBSST    OREQ 'RW'
     C           WXBSST    OREQ 'RR'
     C           WEIDVA    ADD  WXAYVA    WN0288           Value of On Han
     C                     END                             *FI
     C                     END                             *FI
     C           WXAHWG    ADD  WEACWG    WN0282           Quantity on Han
     C           WEARQT    ADD  WN0266    WN0283           Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WN0283    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0065  30       Company Number
     C                     PARM WEHGCD    WQ0066  70       Item Code
     C                     PARM WEAJCD    WQ0067  3        Warehouse Code
     C                     PARM WXB4DT    WQ0068  70       Transaction Dat
     C                     PARM WEELDT    WQ0069  70       Production Date
     C                     PARM WXHVCD    WQ0070  2        UOM Transaction
     C                     PARM WN0282    WQ0071 112       Transaction Wei
     C                     PARM WN0286    WQ0072 114       USR Transaction
     C                     PARM WXCGCD    WQ0073  2        UOM Cost
     C                     PARM WERINB    WQ0074  30       Item Structure
     C                     PARM WERHNB    WQ0075  30       Item Structure
     C                     PARM WERGNB    WQ0076  30       Item Structure
     C                     PARM WL0335    WQ0077  1        Shift Number
     C                     PARM WEK7DT    WQ0078  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0282           Quantity on Han
     C                     Z-ADD*ZERO     WN0288           Value of On Han
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEAJCD    WL0201    P      Warehouse Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0202    WN0289    P      Lot Tracking Fl
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0283    IFEQ WUW0NB                     *IF
     C           WEELDT    IFNE WUW0NB                     *IF
     C           WN0289    IFEQ *BLANK                     *IF
     C           WN0289    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0203           Company Number
     C                     Z-ADDWEHGCD    WL0204           Item Code
     C                     MOVELWEAJCD    WL0205    P      Warehouse Code
     C                     Z-ADDWEELDT    WL0206           Production Date
     C                     EXSR SXDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR TJCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0290  70       Label Date
     C                     MOVEL*BLANK    WN0291  1        EDI Status 1
     C                     MOVEL*BLANK    WN0292  1        EDI Status 2
     C                     MOVEL*BLANK    WN0293  1        EDI Status 3
     C                     MOVEL*BLANK    WN0294  1        Record Status
     C                     Z-ADD*ZERO     WN0295  60       Job Time
     C                     MOVEL*BLANK    WN0296 10        User Id
     C                     MOVEL*BLANK    WN0297 10        Job Name
     C                     Z-ADD*ZERO     WN0298  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEHGCD    WFHGCD           Item Code
     C                     MOVELWEAJCD    WFAJCD    P      Warehouse Code
     C                     Z-ADDWEELDT    WFELDT           Production Date
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C           KLCHTJ    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YFRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWEABWG    WFABWG           Physical Count
     C                     Z-ADDWEAGQT    WFAGQT           Physical Count
     C                     Z-ADDWEAHQT    WFAHQT           Physical Count
     C                     Z-ADDWEAIQT    WFAIQT           Physical Count
     C                     MOVELWECTST    WFCTST    P      Physical Count
     C                     Z-ADDWN0282    WFACWG           Quantity on Han
     C                     Z-ADDWN0283    WFARQT           Quantity on Han
     C                     Z-ADDWEASQT    WFASQT           Quantity on Han
     C                     Z-ADDWEATQT    WFATQT           Quantity on Han
     C                     Z-ADDWEHDQT    WFHDQT           Quantity In Chi
     C                     Z-ADDWEHEQT    WFHEQT           Weight In Chill
     C                     MOVELWEF6ST    WFF6ST    P      Update Exceptio
     C                     Z-ADDWEBMWG    WFBMWG           Physical Start
     C                     Z-ADDWEDSQT    WFDSQT           Physical Start
     C                     Z-ADDWEDTQT    WFDTQT           Physical Start
     C                     Z-ADDWEDUQT    WFDUQT           Physical Start
     C                     Z-ADDWEDHDT    WFDHDT           Physical Start
     C                     Z-ADDWEAGCS    WFAGCS           Unit Cost Per P
     C                     Z-ADDWEAECS    WFAECS           Last Cost
     C                     Z-ADDWN0288    WFIDVA           Value of On Han
     C                     Z-ADDWERINB    WFRINB           Item Structure
     C                     Z-ADDWERHNB    WFRHNB           Item Structure
     C                     Z-ADDWERGNB    WFRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C                     MOVEL##PGM     WFA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WYDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,005   WYDOCD           System Value Co
      * Establish starting position
     C           KRSTK     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWYM8NB    YL0048           System Value Nu
     C                     GOTO TKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Lot/Loc/Lvl Info  RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQTL01           Company Number
     C           *LIKE     DEFN TAAJCD    WQTL02           Warehouse Code
     C           *LIKE     DEFN TALXNM    WQTL03           Lot Number
     C           *LIKE     DEFN TAHGCD    WQTL04           Item Code
     C           *LIKE     DEFN TAYMCD    WQTL05           Location Code
     C           *LIKE     DEFN TAYNCD    WQTL06           Location Level
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Warehouse Code
     C                     KFLD           WQTL03           Lot Number
     C                     KFLD           WQTL04           Item Code
     C                     KFLD           WQTL05           Location Code
     C                     KFLD           WQTL06           Location Level
      * Setup key
     C                     Z-ADD#1AIC3    WQTL01           Company Number
     C                     MOVEL#1AJCD    WQTL02           Warehouse Code
     C                     Z-ADD#1LXNM    WQTL03           Lot Number
     C                     Z-ADD#1HGCD    WQTL04           Item Code
     C                     MOVEL#1YMCD    WQTL05           Location Code
     C                     Z-ADD#1YNCD    WQTL06           Location Level
      * Establish starting position
     C           KRSTL     SETLL@L5CPUU                    *
     C           KRSTL     READE@L5CPUU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1ELDT           Production Date
     C                     Z-ADD*ZERO     #1J2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     #1G5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     #1LODT           ILL Avail Ship
     C                     Z-ADD*ZERO     #1LPDT           ILL Unused Date
     C                     MOVEL*BLANK    #1AMSX           ILL Status
     C                     MOVEL*BLANK    #1YSCD           Inv Hold Reason
     C                     MOVEL*BLANK    P2WXST           Record Found US
     C                     MOVEL'N'       P2WXST           Record Found US
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTAELDT    #1ELDT           Production Date
     C                     Z-ADDTAJ2QT    #1J2QT           ILL Item Qty On
     C                     Z-ADDTAG5WG    #1G5WG           ILL Unit Weight
     C                     Z-ADDTALODT    #1LODT           ILL Avail Ship
     C                     Z-ADDTALPDT    #1LPDT           ILL Unused Date
     C                     MOVELTAAMSX    #1AMSX           ILL Status
     C                     MOVELTAYSCD    #1YSCD           Inv Hold Reason
     C                     MOVEL'Y'       P2WXST           Record Found US
     C           KRSTL     READE@L5CPUU                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           TBAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0337    TBAIC3           Company Number
      * Establish starting position
     C           KRSTM     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0338           Name
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBADTX    WL0338           Name
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           TCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0339    TCAJCD           Warehouse Code
      * Establish starting position
     C           KRSTN     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0340           Warehouse Descr
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELTCF8NA    WL0340           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           TEHGCD           Item Code
      * Setup key
     C                     Z-ADD#1HGCD    TEHGCD           Item Code
      * Establish starting position
     C           KRSTO     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DOONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTEAVNA    #DOONA           Description Lin
     C                     MOVELTEAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           TEHGCD           Item Code
      * Setup key
     C                     Z-ADD#1HGCD    TEHGCD           Item Code
      * Establish starting position
     C           KRSTP     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DOONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTEAVNA    #DOONA           Description Lin
     C                     MOVELTEAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           TFAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0299    TFAJVN           User Profile Na
      * Establish starting position
     C           KRSTQ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTFI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELTFMPNA    P1MPNA           Default Printer
     C                     MOVELTFBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDTFAIC3    YL0050           Company Number
     C                     MOVELTFBUVN    WN0300           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           TGAJVN           User Profile Na
     C                     KFLD           TGDNCD           Application Cod
      * Setup key
     C                     MOVELWL0341    TGAJVN           User Profile Na
     C                     MOVELWL0342    TGDNCD           Application Cod
      * Establish starting position
     C           KRSTR     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTGAIC3    WL0343           Company Number
     C                     MOVELTGAJCD    WL0344           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN THDNCD    WQTS01           Application Cod
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTS01           Application Cod
     C                     MOVEL'I/C'     WQTS01           Application Cod
      * Establish starting position
     C           KRSTS     SETLL@DNRESF                    *
     C           KRSTS     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           THRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELTHAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TTRVGN
     C                     END                             *FI
     C           KRSTS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN THDNCD    WQTT01           Application Cod
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           Application Cod
      * Setup key
     C                     MOVELTHRSCD    WQTT01           Application Cod
      * Establish starting position
     C           KRSTT     SETLL@DNRESF                    *
     C           KRSTT     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTHAUNA    WUAUNA           Description
     C           KRSTT     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           TFAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     TFAJVN           User Profile Na
      * Establish starting position
     C           KRSTU     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTFI8ST    P1I8ST           Allow Multi War
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Reset Production/Label Date if Lot Tracking warehouse.
      *================================================================
     C                     Z-ADD#1ELDT    WN0137           Production Date
     C                     Z-ADDYL0007    WN0138           Label Date  USR
      * Determine the Lot Tracking Flag for From Warehouse.
      * If the From Warehouse Lot Tracking Flag is "N", then perform the
      * following "Clc" to determine if the To Warehouse Lot Tracking
      * Flag is "Y" and replace the Production Date with Job Date if it
      * is "Y".
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Initialize Detail fields
      *================================================================
     C                     Z-ADD*ZERO     #1HGCD           Item Code
     C                     Z-ADD*ZERO     #1ELDT           Production Date
     C                     Z-ADD*ZERO     #1J2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     #1LXNM           Lot Number
     C                     Z-ADD*ZERO     #1LODT           ILL Avail Ship
     C                     MOVEL*BLANK    #1YMCD           Location Code
     C                     MOVELWUGSTX    #1AMSX           ILL Status
     C                     Z-ADD*ZERO     #1YNCD           Location Level
     C                     MOVELWUGSTX    #1YSCD           Inv Hold Reason
     C                     Z-ADD*ZERO     #DLTNT           Lot Number USR
     C                     MOVEL*BLANK    #DYVCD           Location Code U
     C                     Z-ADD*ZERO     #DSXTX           Location Level
     C                     Z-ADD*ZERO     #DJ5QT           LLT Transaction
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1AJCD    WK1X02  1
     C                     MOVELV1HGCD    WK1X04  1
     C                     MOVEL#1YMCD    WK1X05  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           YPMTFD    OREQ '#1LXNM'
     C           WK1X04    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     C           WK1X05    OREQ '?'                        Location Code
     C           YPMTFD    OREQ '#1YMCD'
     C           YPMTFD    OREQ '#1YNCD'
     C           YPMTFD    OREQ '#1ELDT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1HGCD' defaulted for 'Item Code'.
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1ELDT' defaulted for 'Production Date'.
      * Field '(DTL) #1LXNM' defaulted for 'Lot Number'.
      * Field '(DTL) #1YMCD' defaulted for 'Location Code'.
      * Field '(DTL) #1YNCD' defaulted for 'Location Level'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1J2QT' defaulted for 'ILL Item Qty On Hand'.
      * Field '(DTL) #1LODT' defaulted for 'ILL Avail Ship Date'.
      * Field '(DTL) #1LPDT' defaulted for 'ILL Unused Date 1'.
      * Field '(DTL) #1AMSX' defaulted for 'ILL Status'.
      * Field '(DTL) #1YSCD' defaulted for 'Inv Hold Reason Code'.
     C                     CALL 'PDK4SRR'              90  Sel Item Lot/Lo
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0136  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0137  70       Item Code
     C           #1AJCD    PARM #1AJCD    WQ0138  3        Warehouse Code
     C           #1ELDT    PARM #1ELDT    WQ0139  70       Production Date
     C           #1LXNM    PARM #1LXNM    WQ0140  50       Lot Number
     C           #1YMCD    PARM #1YMCD    WQ0141  4        Location Code
     C           #1YNCD    PARM #1YNCD    WQ0142  20       Location Level
     C           #1J2QT    PARM #1J2QT    WQ0143  50       ILL Item Qty On
     C           #1LODT    PARM #1LODT    WQ0144  70       ILL Avail Ship
     C           #1LPDT    PARM #1LPDT    WQ0145  70       ILL Unused Date
     C           #1AMSX    PARM #1AMSX    WQ0146  1        ILL Status
     C           #1YSCD    PARM #1YSCD    WQ0147  3        Inv Hold Reason
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDK4SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993133*
     C                     SETON                     323435*
     C                     SETON                     36    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1LXNM    IFNE *ZERO                      Lot Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X04    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YMCD    IFNE *BLANK                     Location Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X05    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YNCD    IFNE *ZERO                      Location Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1ELDT    IFNE *ZERO                      Production Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Item Balance Detail
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1HGCD    WK1X02  1
     C                     MOVEL#1AJCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     C           WK1X03    OREQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           YPMTFD    OREQ '#1ELDT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1HGCD' defaulted for 'Item Code'.
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1ELDT' defaulted for 'Production Date'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0049' defaulted for 'Label Date'.
     C                     CALL 'PDZESRR'              90  Sel Prod Date-M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0148  30       Company Number
     C                     PARM #1HGCD    WQ0149  70       Item Code
     C                     PARM #1AJCD    WQ0150  3        Warehouse Code
     C           #1ELDT    PARM #1ELDT    WQ0151  70       Production Date
     C           YL0049    PARM *ZERO     WQ0152  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993133*
     C                     SETON                     32    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1ELDT    IFNE *ZERO                      Production Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HGCD    IFEQ *ZERO                      Item Code
     C           #1ELDT    ANDEQ*ZERO                      Production Date
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3
     C                     Z-ADD#1HGCD    WEHGCD
     C                     MOVEL#1AJCD    WEAJCD
     C                     Z-ADD#1ELDT    WEELDT
     C           KLVBWE    CHAIN@B1REJ0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Item Balance Detail    NF'
     C                     MOVEL'USR0330' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0330' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C                     MOVEL#1YMCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           WK1X02    OREQ '?'                        Location Code
     C           YPMTFD    OREQ '#1YMCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1YMCD' defaulted for 'Location Code'.
     C                     CALL 'PDHSSRR'              90  Sel Whs Locatio
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0153  3        Warehouse Code
     C           #1YMCD    PARM #1YMCD    WQ0154  4        Location Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993235*
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YMCD    IFNE *BLANK                     Location Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1YMCD    IFEQ *BLANK                     Location Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWG    KLIST
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGYMCD           Location Code
      * Setup key
     C                     MOVEL#1AJCD    WGAJCD
     C                     MOVEL#1YMCD    WGYMCD
     C           KLVCWG    CHAIN@L2RESM              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Warehouse Location     NF'
     C                     MOVEL'USR2628' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2628' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Item Hold Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1YSCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Inv Hold Reason
     C           YPMTFD    OREQ '#1YSCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1YSCD' defaulted for 'Inv Hold Reason Code'.
     C                     CALL 'PDHWSRR'              90  Sel Item Hold R
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0155  30       Company Number
     C           #1YSCD    PARM #1YSCD    WQ0156  3        Inv Hold Reason
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1YSCD    IFNE *BLANK                     Inv Hold Reason
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1YSCD    IFEQ *BLANK                     Inv Hold Reason
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDTD    KLIST
     C                     KFLD           TDAIC3           Company Number
     C                     KFLD           TDYSCD           Inv Hold Reason
      * Setup key
     C                     Z-ADD#1AIC3    TDAIC3
     C                     MOVEL#1YSCD    TDYSCD
     C           KLVDTD    CHAIN@L4RESS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Item Hold Reason       NF'
     C                     MOVEL'USR2632' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2632' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE024
     C           ZHCSCL    ANDLE026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDGE024
     C           ZHCSCL    ANDLE026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#1AJCD'  YPMTFD           Warehouse Code
     C                     END
      *
     C           ZHCSRW    IFEQ 007
     C           ZHCSCL    ANDGE024
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1HGCD'  YPMTFD           Item Code
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDGE024
     C           ZHCSCL    ANDLE028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1LXNM'  YPMTFD           Lot Number
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE024
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1YMCD'  YPMTFD           Location Code
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE024
     C           ZHCSCL    ANDLE025
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1YNCD'  YPMTFD           Location Level
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     MOVEL*BLANK    P1ADTX           Name
     C                     MOVEL*BLANK    P1BXTX           System Value Al
     C                     MOVEL*BLANK    P1WVST           Access Denied (
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2WXST           Record Found US
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3VYST           Record Found -P
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WALRDT           LLT Transaction
     C                     Z-ADD*ZERO     WALLTS           LLT Sequence Nu
     C                     Z-ADD*ZERO     WALSDT           LLT Production
     C                     Z-ADD*ZERO     WAJ5QT           LLT Transaction
     C                     Z-ADD*ZERO     WAG8WG           LLT Transaction
     C                     Z-ADD*ZERO     WALLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WALLCL           LLT Location Le
     C                     Z-ADD*ZERO     WALLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WALLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCLXNM           Lot Number
     C                     Z-ADD*ZERO     WCYNCD           Location Level
     C                     Z-ADD*ZERO     WCJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WCG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WCJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WCG6WG           ILL Item Wgt On
     C                     Z-ADD*ZERO     WCJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WCG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WCLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WCLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WCLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WCNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEABWG           Physical Count
     C                     Z-ADD*ZERO     WEAGQT           Physical Count
     C                     Z-ADD*ZERO     WEAHQT           Physical Count
     C                     Z-ADD*ZERO     WEAIQT           Physical Count
     C                     Z-ADD*ZERO     WEACWG           Quantity on Han
     C                     Z-ADD*ZERO     WEARQT           Quantity on Han
     C                     Z-ADD*ZERO     WEASQT           Quantity on Han
     C                     Z-ADD*ZERO     WEATQT           Quantity on Han
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WEBMWG           Physical Start
     C                     Z-ADD*ZERO     WEDSQT           Physical Start
     C                     Z-ADD*ZERO     WEDTQT           Physical Start
     C                     Z-ADD*ZERO     WEDUQT           Physical Start
     C                     Z-ADD*ZERO     WEDHDT           Physical Start
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     Z-ADD*ZERO     WEK7DT           Label Date
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGLCBY           Location Bay
     C                     Z-ADD*ZERO     WGLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field WL Unused Sts 1
     C                     MOVEL*BLANK    WUWLUS  1
      * Define work field WL Unused Sts 2
     C                     MOVEL*BLANK    WUWUSD  1
      * Define work field WL PFS Zone
     C                     MOVEL*BLANK    WUWLUN  2
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WISLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAXNB           Current Account
     C                     Z-ADD*ZERO     WJNGNB           Current Account
     C                     Z-ADD*ZERO     WJBZNB           OM Week
     C                     Z-ADD*ZERO     WJC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WJC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WJCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WJIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WJI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WJDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WJC7NB           Next Customer #
     C                     Z-ADD*ZERO     WJC2NB           Next Inventory
     C                     Z-ADD*ZERO     WJC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WJL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WJBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WJAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WJASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WJA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WJAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WJABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAENB           Retention Perio
     C                     Z-ADD*ZERO     WJALNB           Retention Perio
     C                     Z-ADD*ZERO     WJEVNB           Retention Perio
     C                     Z-ADD*ZERO     WJRPOP           Retention Perio
     C                     Z-ADD*ZERO     WJDWNB           Retention Perio
     C                     Z-ADD*ZERO     WJR3NB           Next Load ID
     C                     Z-ADD*ZERO     WJR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WJSCNB           Production Numb
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAIWG           Unit Weight
     C                     Z-ADD*ZERO     WKCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WKC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WKURTN           Number Cases On
     C                     Z-ADD*ZERO     WKAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKTFNB           Transportation
     C                     Z-ADD*ZERO     WKTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WKTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WKBLPR           Market Overage
     C                     Z-ADD*ZERO     WKBMPR           Standard Overag
     C                     Z-ADD*ZERO     WKCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WKCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WKSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WKPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WKICN1           Item Category N
     C                     Z-ADD*ZERO     WKICN2           Item Category N
     C                     Z-ADD*ZERO     WKV2NB           Item Category N
     C                     Z-ADD*ZERO     WKITCN           Item Category N
     C                     Z-ADD*ZERO     WKITC5           Item Category N
     C                     Z-ADD*ZERO     WKICN6           Item Category N
     C                     Z-ADD*ZERO     WKICN7           Item Category N
     C                     Z-ADD*ZERO     WKICN8           Item Category N
     C                     Z-ADD*ZERO     WKICN9           Item Category N
     C                     Z-ADD*ZERO     WKICN0           Item Category N
     C                     Z-ADD*ZERO     WKSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WKA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WKSJNB           Production Lead
     C                     Z-ADD*ZERO     WKSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WKSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WKSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WKCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WKCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WKILNB           Packages per ca
     C                     Z-ADD*ZERO     WKCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WKCINB           PM Batch Size
     C                     Z-ADD*ZERO     WKCJNB           Package Level s
     C                     Z-ADD*ZERO     WKCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WKCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WKCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WKCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WKCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WKCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WKCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WKCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WKC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WKB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WKB5NB           PM Line Number
     C                     Z-ADD*ZERO     WKBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WKBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WKF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WKF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WKF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WKBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WKBNNB           Production Qty
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field USR Weight
     C                     Z-ADD*ZERO     WUASWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLAECS           Last Cost
     C                     Z-ADD*ZERO     WLBACS           Cost per Primar
     C                     Z-ADD*ZERO     WLBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WLCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WLGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WLCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WLG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WLBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WLDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WLDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WLDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WLHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WLHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WLAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WLAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WLAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WLEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WLDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WLAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WLANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WLIDVA           Value of On Han
     C                     Z-ADD*ZERO     WLBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WLDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WLDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WLBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WLDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WLBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WLDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WLDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WLBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WLDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WLDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WLDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WLDMDT           Last Physical C
     C                     Z-ADD*ZERO     WLAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMHUNZ           Release Number
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,003   XDTSDL
     C                     MOVELXDTSDL    WMBGTS           Create Date Tim
     C                     MOVELXDTSDL    WMBHTS           Update Date Tim
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Transaction Weight
     C                     Z-ADD*ZERO     WUAHWG 112
      * Define work field Transaction Quantity
     C                     Z-ADD*ZERO     WUA5QT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WOC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WODXNB           Sequence Number
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WOA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WOAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WOAKCS           USR Transaction
     C                     Z-ADD*ZERO     WOAYVA           Extended Amount
     C                     Z-ADD*ZERO     WOCKNB           GL Document Num
     C                     Z-ADD*ZERO     WOTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WOTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WORINB           Item Structure
     C                     Z-ADD*ZERO     WORHNB           Item Structure
     C                     Z-ADD*ZERO     WORGNB           Item Structure
     C                     Z-ADD*ZERO     WOAWTM           Production Time
     C                     Z-ADD*ZERO     WOK7DT           Label Date
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WSBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WSBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WSBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WSBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Clear all neither parameters
      * Crt Item Balance       CR - Item Balance  * 
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field UOM Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     WUIDVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYM8NB           System Value Nu
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TDAIC3           Company Number
     C                     Z-ADD*ZERO     TDAATM           Job Time
     C                     Z-ADD*ZERO     TDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TEHGCD           Item Code
     C                     Z-ADD*ZERO     TEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     TEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     TEAIWG           Unit Weight
     C                     Z-ADD*ZERO     TECZWG           Minimum Weight
     C                     Z-ADD*ZERO     TEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     TEURTN           Number Cases On
     C                     Z-ADD*ZERO     TEACC8           Vendor item Def
     C                     Z-ADD*ZERO     TERINB           Item Structure
     C                     Z-ADD*ZERO     TERHNB           Item Structure
     C                     Z-ADD*ZERO     TERGNB           Item Structure
     C                     Z-ADD*ZERO     TETFNB           Transportation
     C                     Z-ADD*ZERO     TECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     TESWGH           Std Weight_Head
     C                     Z-ADD*ZERO     TEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     TESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     TEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     TESJNB           Production Lead
     C                     Z-ADD*ZERO     TESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     TESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     TESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     TECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     TECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     TEILNB           Packages per ca
     C                     Z-ADD*ZERO     TECHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     TECINB           PM Batch Size
     C                     Z-ADD*ZERO     TECJNB           Package Level s
     C                     Z-ADD*ZERO     TECMNB           Partial Item Co
     C                     Z-ADD*ZERO     TECNNB           WIP Item Code
     C                     Z-ADD*ZERO     TECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     TECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     TECVNB           FP Std Green We
     C                     Z-ADD*ZERO     TECWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     TECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     TECZNB           PM Formula LBS
     C                     Z-ADD*ZERO     TEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     TEB4NB           PM Raw Material
     C                     Z-ADD*ZERO     TETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     TETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     TEBLPR           Market Overage
     C                     Z-ADD*ZERO     TEBMPR           Standard Overag
     C                     Z-ADD*ZERO     TECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     TEAIC3           Company Number
     C                     Z-ADD*ZERO     TEICN1           Item Category N
     C                     Z-ADD*ZERO     TEICN2           Item Category N
     C                     Z-ADD*ZERO     TEV2NB           Item Category N
     C                     Z-ADD*ZERO     TEITCN           Item Category N
     C                     Z-ADD*ZERO     TEITC5           Item Category N
     C                     Z-ADD*ZERO     TEICN6           Item Category N
     C                     Z-ADD*ZERO     TEICN7           Item Category N
     C                     Z-ADD*ZERO     TEICN8           Item Category N
     C                     Z-ADD*ZERO     TEICN9           Item Category N
     C                     Z-ADD*ZERO     TEICN0           Item Category N
     C                     Z-ADD*ZERO     TEB5NB           PM Line Number
     C                     Z-ADD*ZERO     TEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     TEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     TEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     TEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     TEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     TEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     TEBNNB           Production Qty
     C                     Z-ADD*ZERO     TEAHTM           Job Time 1
     C                     Z-ADD*ZERO     TEEKDT           Job Date 1
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TFNLNB           Entity Number
     C                     Z-ADD*ZERO     TFAIC3           Company Number
     C                     Z-ADD*ZERO     TFAATM           Job Time
     C                     Z-ADD*ZERO     TFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TGAIC3           Company Number
     C                     Z-ADD*ZERO     TGAATM           Job Time
     C                     Z-ADD*ZERO     TGAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     THAATM           Job Time
     C                     Z-ADD*ZERO     THAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
      * Define local variables for subroutine SBCRRC.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  50
     C                     MOVEL*BLANK    WL0017  4
     C                     Z-ADD*ZERO     WL0018  20
     C                     MOVEL*BLANK    WL0019  3
     C                     Z-ADD*ZERO     WL0020  50
     C                     MOVEL*BLANK    WL0021  4
     C                     Z-ADD*ZERO     WL0022  20
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     Z-ADD*ZERO     WL0031  60
     C                     MOVEL*BLANK    WL0032 10
     C                     MOVEL*BLANK    WL0033 10
     C                     Z-ADD*ZERO     WL0034  70
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  50
     C                     MOVEL*BLANK    WL0040  4
     C                     Z-ADD*ZERO     WL0041  20
     C                     Z-ADD*ZERO     WL0042 112
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  70
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  3
     C                     Z-ADD*ZERO     WL0047  70
      * Define local variables for subroutine SECHRC.
     C                     Z-ADD*ZERO     WL0048  30
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050  3
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  50
     C                     MOVEL*BLANK    WL0053  4
     C                     Z-ADD*ZERO     WL0054  20
     C                     Z-ADD*ZERO     WL0055  50
      * Define local variables for subroutine SFDLRC.
     C                     Z-ADD*ZERO     WL0056  30
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  3
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  50
     C                     MOVEL*BLANK    WL0061  4
     C                     Z-ADD*ZERO     WL0062  20
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0063  30
     C                     Z-ADD*ZERO     WL0064  70
     C                     MOVEL*BLANK    WL0065  3
     C                     Z-ADD*ZERO     WL0066  70
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0067  3
     C                     MOVEL*BLANK    WL0068  4
     C                     MOVEL*BLANK    WL0069  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0070  30
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072 30
     C                     MOVEL*BLANK    WL0073 30
     C                     MOVEL*BLANK    WL0074  2
     C                     Z-ADD*ZERO     WL0075  94
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  2
     C                     Z-ADD*ZERO     WL0078  94
     C                     MOVEL*BLANK    WL0079  1
     C                     MOVEL*BLANK    WL0080  2
     C                     MOVEL*BLANK    WL0081  2
     C                     Z-ADD*ZERO     WL0082 112
     C                     MOVEL*BLANK    WL0083  1
     C                     MOVEL*BLANK    WL0084  1
     C                     Z-ADD*ZERO     WL0085  52
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  3
     C                     Z-ADD*ZERO     WL0089 114
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091  1
     C                     Z-ADD*ZERO     WL0092  80
     C                     MOVEL*BLANK    WL0093  1
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0094  30
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  30
     C                     Z-ADD*ZERO     WL0098  30
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0099  30
     C                     Z-ADD*ZERO     WL0100  70
     C                     MOVEL*BLANK    WL0101  3
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  2
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  50
      * Define local variables for subroutine STCRRC.
     C                     Z-ADD*ZERO     WL0106  30
     C                     Z-ADD*ZERO     WL0107  70
     C                     MOVEL*BLANK    WL0108  3
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  2
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112  50
     C                     Z-ADD*ZERO     WL0113  30
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  2
     C                     MOVEL*BLANK    WL0116  2
     C                     MOVEL*BLANK    WL0117 30
     C                     Z-ADD*ZERO     WL0118 112
     C                     Z-ADD*ZERO     WL0119 112
     C                     Z-ADD*ZERO     WL0120 114
     C                     MOVEL*BLANK    WL0121  2
     C                     Z-ADD*ZERO     WL0122 112
     C                     MOVEL*BLANK    WL0123  6
     C                     Z-ADD*ZERO     WL0124  80
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  3
     C                     MOVEL*BLANK    WL0127 15
     C                     MOVEL*BLANK    WL0128 10
     C                     Z-ADD*ZERO     WL0129  70
     C                     Z-ADD*ZERO     WL0130  30
     C                     Z-ADD*ZERO     WL0131  70
     C                     Z-ADD*ZERO     WL0132  30
     C                     Z-ADD*ZERO     WL0133  30
     C                     Z-ADD*ZERO     WL0134  30
     C                     MOVEL*BLANK    WL0135 10
     C                     Z-ADD*ZERO     WL0136  60
     C                     MOVEL*BLANK    WL0137  1
     C                     Z-ADD*ZERO     WL0138  70
     C                     MOVEL*BLANK    WL0139  1
     C                     MOVEL*BLANK    WL0140  1
     C                     MOVEL*BLANK    WL0141  1
     C                     MOVEL*BLANK    WL0142  1
      * Define local variables for subroutine SUCHRC.
     C                     Z-ADD*ZERO     WL0143  30
     C                     Z-ADD*ZERO     WL0144  70
     C                     MOVEL*BLANK    WL0145  3
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  30
     C                     Z-ADD*ZERO     WL0148  30
     C                     Z-ADD*ZERO     WL0149  30
     C                     MOVEL*BLANK    WL0150  2
     C                     Z-ADD*ZERO     WL0151  94
     C                     MOVEL*BLANK    WL0152  1
     C                     MOVEL*BLANK    WL0153  2
     C                     Z-ADD*ZERO     WL0154  94
     C                     MOVEL*BLANK    WL0155  1
     C                     MOVEL*BLANK    WL0156  2
     C                     MOVEL*BLANK    WL0157  1
     C                     MOVEL*BLANK    WL0158  1
     C                     MOVEL*BLANK    WL0159  1
     C                     MOVEL*BLANK    WL0160  2
     C                     Z-ADD*ZERO     WL0161  70
     C                     MOVEL*BLANK    WL0162  2
     C                     Z-ADD*ZERO     WL0163 112
     C                     Z-ADD*ZERO     WL0164 112
     C                     Z-ADD*ZERO     WL0165 114
     C                     MOVEL*BLANK    WL0166  2
     C                     Z-ADD*ZERO     WL0167 112
     C                     Z-ADD*ZERO     WL0168  70
      * Define local variables for subroutine SVCRRC.
     C                     Z-ADD*ZERO     WL0169  30
     C                     Z-ADD*ZERO     WL0170  70
     C                     MOVEL*BLANK    WL0171  3
     C                     Z-ADD*ZERO     WL0172  70
     C                     Z-ADD*ZERO     WL0173 112
     C                     Z-ADD*ZERO     WL0174 112
     C                     Z-ADD*ZERO     WL0175 112
     C                     Z-ADD*ZERO     WL0176 112
     C                     MOVEL*BLANK    WL0177  1
     C                     Z-ADD*ZERO     WL0178 112
     C                     Z-ADD*ZERO     WL0179 112
     C                     Z-ADD*ZERO     WL0180 112
     C                     Z-ADD*ZERO     WL0181 112
     C                     Z-ADD*ZERO     WL0182 112
     C                     Z-ADD*ZERO     WL0183 112
     C                     MOVEL*BLANK    WL0184  1
     C                     Z-ADD*ZERO     WL0185 112
     C                     Z-ADD*ZERO     WL0186 112
     C                     Z-ADD*ZERO     WL0187 112
     C                     Z-ADD*ZERO     WL0188 112
     C                     Z-ADD*ZERO     WL0189  70
     C                     Z-ADD*ZERO     WL0190 114
     C                     Z-ADD*ZERO     WL0191 114
     C                     Z-ADD*ZERO     WL0192 112
     C                     Z-ADD*ZERO     WL0193  70
     C                     Z-ADD*ZERO     WL0194  30
     C                     Z-ADD*ZERO     WL0195  30
     C                     Z-ADD*ZERO     WL0196  30
     C                     MOVEL*BLANK    WL0197  1
     C                     MOVEL*BLANK    WL0198  1
     C                     MOVEL*BLANK    WL0199  1
     C                     MOVEL*BLANK    WL0200  1
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0201  3
     C                     MOVEL*BLANK    WL0202  1
      * Define local variables for subroutine SXDLRC.
     C                     Z-ADD*ZERO     WL0203  30
     C                     Z-ADD*ZERO     WL0204  70
     C                     MOVEL*BLANK    WL0205  3
     C                     Z-ADD*ZERO     WL0206  70
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0207  30
     C                     Z-ADD*ZERO     WL0208  70
     C                     MOVEL*BLANK    WL0209  3
     C                     Z-ADD*ZERO     WL0210 112
     C                     Z-ADD*ZERO     WL0211 112
     C                     Z-ADD*ZERO     WL0212 112
     C                     Z-ADD*ZERO     WL0213 112
     C                     Z-ADD*ZERO     WL0214 112
      * Define local variables for subroutine SZCHRC.
     C                     Z-ADD*ZERO     WL0215  30
     C                     Z-ADD*ZERO     WL0216  70
     C                     MOVEL*BLANK    WL0217  3
     C                     Z-ADD*ZERO     WL0218 112
     C                     Z-ADD*ZERO     WL0219 112
     C                     Z-ADD*ZERO     WL0220 112
      * Define local variables for subroutine TARVGN.
     C                     MOVEL*BLANK    WL0221  3
     C                     MOVEL*BLANK    WL0222 30
     C                     MOVEL*BLANK    WL0223 30
     C                     MOVEL*BLANK    WL0224 30
     C                     MOVEL*BLANK    WL0225 30
     C                     MOVEL*BLANK    WL0226 20
     C                     MOVEL*BLANK    WL0227 11
     C                     MOVEL*BLANK    WL0228  3
     C                     MOVEL*BLANK    WL0229  2
     C                     MOVEL*BLANK    WL0230  1
     C                     MOVEL*BLANK    WL0231 10
     C                     MOVEL*BLANK    WL0232  2
     C                     MOVEL*BLANK    WL0233  1
     C                     MOVEL*BLANK    WL0234  1
     C                     MOVEL*BLANK    WL0235  1
     C                     Z-ADD*ZERO     WL0236  52
     C                     MOVEL*BLANK    WL0237  1
     C                     MOVEL*BLANK    WL0238  1
     C                     MOVEL*BLANK    WL0239  1
     C                     MOVEL*BLANK    WL0240  1
     C                     Z-ADD*ZERO     WL0241  30
     C                     Z-ADD*ZERO     WL0242  30
     C                     Z-ADD*ZERO     WL0243  30
     C                     Z-ADD*ZERO     WL0244  30
     C                     MOVEL*BLANK    WL0245  3
     C                     MOVEL*BLANK    WL0246  1
     C                     MOVEL*BLANK    WL0247  1
     C                     MOVEL*BLANK    WL0248  1
     C                     MOVEL*BLANK    WL0249  1
     C                     MOVEL*BLANK    WL0250  2
     C                     MOVEL*BLANK    WL0251  2
     C                     MOVEL*BLANK    WL0252  3
     C                     MOVEL*BLANK    WL0253  3
     C                     MOVEL*BLANK    WL0254  3
     C                     MOVEL*BLANK    WL0255  1
     C                     MOVEL*BLANK    WL0256  1
     C                     MOVEL*BLANK    WL0257  1
     C                     MOVEL*BLANK    WL0258  1
     C                     Z-ADD*ZERO     WL0259  60
     C                     MOVEL*BLANK    WL0260 10
     C                     MOVEL*BLANK    WL0261 10
     C                     Z-ADD*ZERO     WL0262  70
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0263  3
     C                     MOVEL*BLANK    WL0264  4
     C                     MOVEL*BLANK    WL0265  2
     C                     Z-ADD*ZERO     WL0266  20
     C                     Z-ADD*ZERO     WL0267  52
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0268  3
     C                     Z-ADD*ZERO     WL0269  30
      * Define local variables for subroutine TDRVGN.
     C                     Z-ADD*ZERO     WL0270  30
     C                     Z-ADD*ZERO     WL0271  70
     C                     MOVEL*BLANK    WL0272  3
      * Define local variables for subroutine TECRRC.
     C                     Z-ADD*ZERO     WL0273  30
     C                     Z-ADD*ZERO     WL0274  70
     C                     MOVEL*BLANK    WL0275  3
     C                     Z-ADD*ZERO     WL0276 114
     C                     Z-ADD*ZERO     WL0277 114
     C                     Z-ADD*ZERO     WL0278 114
     C                     Z-ADD*ZERO     WL0279 114
     C                     Z-ADD*ZERO     WL0280 114
     C                     Z-ADD*ZERO     WL0281  70
     C                     MOVEL*BLANK    WL0282  1
     C                     Z-ADD*ZERO     WL0283 114
     C                     Z-ADD*ZERO     WL0284  70
     C                     Z-ADD*ZERO     WL0285 112
     C                     Z-ADD*ZERO     WL0286 112
     C                     Z-ADD*ZERO     WL0287 112
     C                     Z-ADD*ZERO     WL0288 112
     C                     Z-ADD*ZERO     WL0289 112
     C                     Z-ADD*ZERO     WL0290 112
     C                     Z-ADD*ZERO     WL0291 112
     C                     Z-ADD*ZERO     WL0292 112
     C                     Z-ADD*ZERO     WL0293 112
     C                     Z-ADD*ZERO     WL0294 112
     C                     Z-ADD*ZERO     WL0295 112
     C                     MOVEL*BLANK    WL0296  3
     C                     Z-ADD*ZERO     WL0297  70
     C                     Z-ADD*ZERO     WL0298  70
     C                     Z-ADD*ZERO     WL0299 112
     C                     MOVEL*BLANK    WL0300  1
     C                     Z-ADD*ZERO     WL0301  52
     C                     Z-ADD*ZERO     WL0302 112
     C                     Z-ADD*ZERO     WL0303  70
     C                     MOVEL*BLANK    WL0304  3
     C                     Z-ADD*ZERO     WL0305  30
     C                     Z-ADD*ZERO     WL0306  70
     C                     Z-ADD*ZERO     WL0307  30
     C                     Z-ADD*ZERO     WL0308  70
     C                     MOVEL*BLANK    WL0309  1
     C                     Z-ADD*ZERO     WL0310 112
     C                     Z-ADD*ZERO     WL0311 112
     C                     Z-ADD*ZERO     WL0312  70
     C                     Z-ADD*ZERO     WL0313 112
     C                     Z-ADD*ZERO     WL0314 112
     C                     Z-ADD*ZERO     WL0315  70
     C                     MOVEL*BLANK    WL0316  1
     C                     MOVEL*BLANK    WL0317  1
     C                     MOVEL*BLANK    WL0318  1
     C                     Z-ADD*ZERO     WL0319  80
     C                     Z-ADD*ZERO     WL0320  30
     C                     Z-ADD*ZERO     WL0321  30
     C                     Z-ADD*ZERO     WL0322  30
     C                     MOVEL*BLANK    WL0323  1
     C                     MOVEL*BLANK    WL0324  1
     C                     MOVEL*BLANK    WL0325  1
     C                     MOVEL*BLANK    WL0326  1
      * Define local variables for subroutine TFRVGN.
     C                     Z-ADD*ZERO     WL0327  30
     C                     Z-ADD*ZERO     WL0328  70
     C                     MOVEL*BLANK    WL0329  3
     C                     MOVEL*BLANK    WL0330  1
     C                     MOVEL*BLANK    WL0331  2
     C                     Z-ADD*ZERO     WL0332  70
     C                     Z-ADD*ZERO     WL0333  50
     C                     Z-ADD*ZERO     WL0334  30
     C                     MOVEL*BLANK    WL0335  1
     C                     Z-ADD*ZERO     WL0336  70
      * Define local variables for subroutine TMRVGN.
     C                     Z-ADD*ZERO     WL0337  30
     C                     MOVEL*BLANK    WL0338 30
      * Define local variables for subroutine TNRVGN.
     C                     MOVEL*BLANK    WL0339  3
     C                     MOVEL*BLANK    WL0340 30
      * Define local variables for subroutine TRRVGN.
     C                     MOVEL*BLANK    WL0341 10
     C                     MOVEL*BLANK    WL0342  6
     C                     Z-ADD*ZERO     WL0343  30
     C                     MOVEL*BLANK    WL0344  3
      * Define local work field Record Found -PS CD USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Location Bay Alpha
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0004  20
      * Define local work field Transfer Batch Number
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Transaction Quantity
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Label Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Description Line Two
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field UOM Primary
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field Conversion Factor 1
     C                     Z-ADD*ZERO     YL0011  94
      * Define local work field Operation Factor 1
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field UOM Second
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Conversion Factor 2
     C                     Z-ADD*ZERO     YL0014  94
      * Define local work field Operation Factor 2
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field UOM Third
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field UOM Pricing
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field Production Date Control
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Catch Weight Status
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0021  52
      * Define local work field UOM Transaction
     C                     MOVEL*BLANK    YL0022  2
      * Define local work field USR Weight based on U/M1
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field USR Weight based on U/M2
     C                     Z-ADD*ZERO     YL0024 112
      * Define local work field USR Weight based on U/M3
     C                     Z-ADD*ZERO     YL0025 112
      * Define local work field Transaction Weight
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     YL0027 114
      * Define local work field Cost Update Pending
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Post GL Status
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Vendor Item_Whse Default
     C                     Z-ADD*ZERO     YL0030  80
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Unit Cost - Detail
     C                     Z-ADD*ZERO     YL0032 114
      * Define local work field Transfer Batch Sequence
     C                     Z-ADD*ZERO     YL0033  30
      * Define null work field Inventory Updated USR
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field API was Called? U
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field Transaction Quantity
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field Transaction Weight
     C                     Z-ADD*ZERO     YL0036 112
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0007 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0008 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0009  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0010  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0037  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0011 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0012  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0038  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0015  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0022  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0023  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0024  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0025  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0039  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0028  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0029  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0031  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0032  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0037  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0038 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0039 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0040  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0040  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0041  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0042  52
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0043  30
      * Define local work field API EccResult-MsgId U
     C                     MOVEL*BLANK    YL0044  7
      * Define local work field API EccResult-MsgDesc U
     C                     MOVEL*BLANK    YL0045 50
      * Define local work field API Request Key U
     C                     MOVEL*BLANK    YL0046 10
      * Define local work field API Name
     C                     MOVEL*BLANK    YL0047 45
      * Define local work field API Wait Time U
     C                     Z-ADD*ZERO     YL0048  50
      * Define local work field Label Date
     C                     Z-ADD*ZERO     YL0049  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0050  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0051  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0299 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0299           User Profile Na
      *
     C                     MOVEL*BLANK    WN0300 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TQRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,015                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0299    ZA0008           User Profile Na
     C                     MOVEL'I/C'     ZA0009           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0300    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0299    WL0341    P      User Profile Na
     C                     MOVEL'I/C'     WL0342    P      Application Cod
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0343    P1AIC3           Company Number
     C                     MOVELWL0344    YL0051    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0300    WL0341    P      User Profile Na
     C                     MOVEL'I/C'     WL0342    P      Application Cod
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0343    P1AIC3           Company Number
     C                     MOVELWL0344    YL0051    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0051    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0299    ZA0010           User Profile Na
     C                     MOVEL'I/C'     ZA0011           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0050    IFNE 0                          *IF
     C                     Z-ADDYL0050    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0051    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0157  3        Warehouse Code
     C                     PARM YL0050    WQ0158  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TSRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
     C                     EXSR TURVGN
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01304013160156001572018160182802072
02109021200232802365025840262102625
033520360803864
** W0END
01306013450156201601018220185702076
02116021270233102369025850262102627
033550360903868
** W0NAM
V1AIC3    #DADTX    #1AJCD    #DF8NA    V1HGCD    #DOONA    #1LXNM
V1ELDT    V1LODT    #1YMCD    #1J2QT    #1YNCD    #1AMSX    #1YSCD
#DYVCD    #DSXTX    #DJ5QT
** @CN
00001 Warehouse Transfer
00002 PDH1PVR
00003 0001-01-01-00.00.00.00000
00004 wim.ordershipping.invento
00005 APIWAITTME
00006 ECC0000
00007 TIMEOUT
00008 PUDLXFR
00009 PDL8DFR
00010 PNTKXFR
00011 PUEJXFR
00012 PNTWXFR
00013 PDMLDFR
00014 USR0752
00015 Y2U0005
