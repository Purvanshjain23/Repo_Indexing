/*                                                                     */
/*  PROGRAM NUMBER --> SH219CL                                         */
/*  PROGRAM NAME ----> DATAMART SALES: ACCRUAL RATES                   */
/*  PROGRAMMER ------> LEANNE RAMSEY                                   */
/*  DATE ------------> 01/15/14                                        */
/*                                                                     */
/*  This is for PORK only....no Dailys.                                */
/*                                                                     */
/***********************************************************************/
/*  MODIFIED:                                                          */
/*                                                                     */
/*  03/17/14  LeAnne Ramsey (E3051)                                    */
/*            Adam Gross now wants us to add Loins to this.            */
/*  03/06/23  RMC CHANGE OPNQRYF TO OPNSQLF                            */
/***********************************************************************/

             PGM

             DCL        VAR(&QDATA)   TYPE(*CHAR) LEN(76)

/*************************************************************************/
/* EXTRACT THE DATA FROM THE COMPANY ITEM FILE                           */
/*************************************************************************/

             CHGVAR     VAR(&QDATA) VALUE(' ')

/* Only Active, FG records for Item Structure Type 720-Trim                  */

             CHGVAR     VAR(%SST(&QDATA 1 76)) VALUE('(BZRGNB =   +
                          720  OR BZRGNB =   200)  AND BZVSST =   +
                          "A"  AND BZN0CD  =  "FG"')

/* Extract data from the Company/Item file                             */

 /*          OVRDBF     FILE(CABZREL1) SHARE(*YES)             */
   /*        OPNQRYF    FILE((CABZREL1)) QRYSLT(&QDATA) +
                          KEYFLD(*FILE) SEQONLY(*YES)           */
/*   OPEN SQL                                                      */
             OVRDBF     FILE(CABZREP) TOFILE(CABZREP) LVLCHK(*NO)
             OPNSQLF    SQL('SELECT * FROM CABZREP WHERE' *BCAT &QDATA +
                          *BCAT 'ORDER BY  BZAIC3 ASC,BZHGCD +
                          ASC') OPNID(CABZREL1) +
                          RCDFMT(@BZREJU)    ALWCPY(*IFRQD)
   /*  Fromfile is the file in the program, tofile is 1st file in the opnsqlf */
     /*  For the override to be SEEN BY ALL PROGRAMS, THE OVRDBF +
                command must specify OVRSCOPE(*JOB) and OPNSCOPE(*JOB). */

             OVRDBF     FILE(CABZREL1) TOFILE(CABZREP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

/*------------------------------------------------------------------*/
/*  CALL THE PROGRAM                                                */
/*------------------------------------------------------------------*/

             CALL       PGM(SH219)

             CLOF       OPNID(CABZREL1)
/*           DLTOVR     FILE(CABZREL1)             */

             ENDPGM

