// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLJYXFR
// ?Date: 14.08.2025 Time: 02:54:29
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?E3814 JJH 10/05/14 - Recompile to add PS Premises ID to Producer Site
//?H16853 ISE 11/05/2020 - Recompiled due to change in Buy Order Number
EXECUTE FUNCTION(Crt Farm Summary      RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1279207;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.Date_From_USR);
PARAMETER(PAR.Date_To_USR);
{
 //?USER: Initialize routine

 //?Modifications and Comments
 DO;

 //?R10690 JJH 06/12/17 - Vendor Location Address
 //?- Get Address from Producer Location Addresss
 //?- Comment out VNDFAXR to get address from JDE Vendor
 ENDDO;

 //?E2423 Mtech Live or Not Live *** Interfaces to HPS ***
 //?Get the MTech Live Yes or No
 DO;

 //?Mtech Live Yes or no
 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER('MTECHLIVE');
 PARAMETER(WRK.System_Value_Alpha_USR);

 // LCL.MTech Live Yes or No = WRK.System Value Alpha    USR
 LCL.MTech_Live_Yes_or_No = WRK.System_Value_Alpha_USR;

 ENDDO;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?QUIT: Kill Date GT Date To
 CASE;

 // IF DB1.TH Kill Date GT PAR.Date To   USR
 IF DB1.TH_Kill_Date > PAR.Date_To_USR;

 QUIT;

 ENDIF;

 //?OMT: Hog Class Type = M
 CASE;

 // IF DB1.TH Hog Class Type is Not Market
 IF DB1.TH_Hog_Class_Type = 'R'/'S';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?Process Record
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 EXECUTE FUNCTION(Rtv Site ID            RT) TYPE(RTVOBJ) FILE(PKDNCPP)          AB1268433;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(NLL.PD_Producer_Code);
 PARAMETER(LCL.PS_Site_ID);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?CHG: Producer/Location/Farm/Site
 CASE;

 // IF DB1.PD Producer Code NE PAR.PD Producer Code
 IF DB1.PD_Producer_Code <> PAR.PD_Producer_Code;

 // OR DB1.PL Location Code NE PAR.PL Location Code
 OR DB1.PL_Location_Code <> PAR.PL_Location_Code;

 // OR DB1.TH HPS Farm Site NE PAR.TH HPS Farm Site
 OR DB1.TH_HPS_Farm_Site <> PAR.TH_HPS_Farm_Site;

 // OR LCL.PS Site ID NE PAR.PS Site ID
 OR LCL.PS_Site_ID <> PAR.PS_Site_ID;

 // PAR.FS Company Number = DB1.BOH Company Number
 PAR.FS_Company_Number = DB1.BOH_Company_Number;

 // PAR.FS Producer Code = DB1.PD Producer Code
 PAR.FS_Producer_Code = DB1.PD_Producer_Code;

 // PAR.FS Producer Location = DB1.PL Location Code
 PAR.FS_Producer_Location = DB1.PL_Location_Code;

 // PAR.FS Farm/Site ID = DB1.PL Location Code
 PAR.FS_Farm_Site_ID = DB1.PL_Location_Code;

 CASE;

 // IF DB1.TH Source Type is Internal
 IF DB1.TH_Source_Type = 'I';

 // PAR.FS Farm/Site ID = DB1.TH HPS Farm Site
 PAR.FS_Farm_Site_ID = DB1.TH_HPS_Farm_Site;

 CASE;

 // IF LCL.MTech Live Yes or No is No MTech not Live
 IF LCL.MTech_Live_Yes_or_No = 'N';

 // Call program Z1v HPS Trace f/ Mvmt UP.
 CALL PROGRAM(Z1v HPS Trace f/ Mvmt UP) ('HP259');
 PARAMETER(WRK.Return_Code_USR);
 PARAMETER(DB1.TH_HPS_Movement_Ref_#);
 PARAMETER(NLL.HPS_Group_Code_Alpha);
 PARAMETER(NLL.Farm_Site_USR);
 PARAMETER(PAR.FS_Name);
 PARAMETER(PAR.FS_State);
 PARAMETER(NLL.HPS_Cell_Manager_Code_USR);
 PARAMETER(NLL.HPS_Cell_Manager_Nm_USR);
 PARAMETER(NLL.TH_Sex);
 PARAMETER(NLL.GN_Genetic_Code);
 PARAMETER(PAR.FS_City);

 // PAR.FS Address Line 1 = CON.*BLANK
 PAR.FS_Address_Line_1 = *BLANK;

 // PAR.FS Address Line 2 = CON.*BLANK
 PAR.FS_Address_Line_2 = *BLANK;

 // PAR.FS Address Line 3 = CON.*BLANK
 PAR.FS_Address_Line_3 = *BLANK;

 // LCL.Farm Site 6.0 USR = DB1.TH HPS Farm Site + CON.350000
 LCL.Farm_Site_6_0_USR = DB1.TH_HPS_Farm_Site + 350000;

 // PAR.FS Certified Number = CVTVAR(LCL.Farm Site 6.0 USR)
 PAR.FS_Certified_Number = CVTVAR(LCL.Farm_Site_6_0_USR);

 // IF LCL.MTech Live Yes or No is Yes MTech is Live
 IF LCL.MTech_Live_Yes_or_No = 'Y';

 // Call program Rtv HPS Farm Inf-Mtech UP.
 CALL PROGRAM(Rtv HPS Farm Inf-Mtech UP) ('HP293');
 PARAMETER(PGM.*Return_code);
 PARAMETER(PAR.FS_Name);
 PARAMETER(DB1.TH_HPS_Farm_Site);
 PARAMETER(WRK.HPS_FS_Comp_Relation_USR);
 PARAMETER(WRK.State);
 PARAMETER(WRK.HPS_Farm_County);
 PARAMETER(WRK.HPS_Cell_Manager_Code_USR);
 PARAMETER(WRK.HPS_Cell_Manager_Nm_USR);
 PARAMETER(NLL.MTech_Farm_Site_Ref);
 PARAMETER(NLL.MTech_Cell_Manager_Ref);

 // PAR.FS Address Line 1 = CON.*BLANK
 PAR.FS_Address_Line_1 = *BLANK;

 // PAR.FS Address Line 2 = CON.*BLANK
 PAR.FS_Address_Line_2 = *BLANK;

 // PAR.FS Address Line 3 = CON.*BLANK
 PAR.FS_Address_Line_3 = *BLANK;

 // LCL.Farm Site 6.0 USR = DB1.TH HPS Farm Site
 LCL.Farm_Site_6_0_USR = DB1.TH_HPS_Farm_Site;

 // PAR.FS Certified Number = CVTVAR(LCL.Farm Site 6.0 USR)
 PAR.FS_Certified_Number = CVTVAR(LCL.Farm_Site_6_0_USR);

 ENDIF;

 // IF DB1.TH Source Type is External
 IF DB1.TH_Source_Type = 'E';

 EXECUTE FUNCTION(Rtv Site/Vnd          RT) TYPE(RTVOBJ) FILE(PKAFREP)           AB1279225;
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(LCL.Pl_VND_Address_Number);
 PARAMETER(LCL.PL_Site_ID_Required);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?R10690 JJH 06/12/17 - Get Address from Producer Location Address
 // Call program Rtv Producer Loc Addr XF.
 CALL PROGRAM(Rtv Producer Loc Addr XF) ('PWC6XFR');
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(NLL.Address_Number);
 PARAMETER(PAR.FS_Name);
 PARAMETER(PAR.FS_Address_Line_1);
 PARAMETER(PAR.FS_Address_Line_2);
 PARAMETER(PAR.FS_Address_Line_3);
 PARAMETER(PAR.FS_City);
 PARAMETER(PAR.FS_State);
 PARAMETER(PAR.FS_Zip);
 PARAMETER(WRK.Area_Code);
 PARAMETER(WRK.Country_Code);
 PARAMETER(WRK.Telephone);
 PARAMETER(WRK.Fax_Area_Code_#);
 PARAMETER(WRK.Fax_Telephone);
 PARAMETER(WRK.Fax_Attn_1);
 PARAMETER(WRK.Fax_Area_Code_#_2);
 PARAMETER(WRK.Fax_Telephone_2);
 PARAMETER(WRK.Fax_Attn_2);
 PARAMETER(WRK.Vendor_1099);
 PARAMETER(WRK.Vendor_Tax_Id);

 //?OVRRIDE: w/Site ID Info
 CASE;

 // IF LCL.PL Site ID Required is Yes
 IF LCL.PL_Site_ID_Required = 'Y';

 // PAR.FS Farm/Site ID = LCL.PS Site ID
 PAR.FS_Farm_Site_ID = LCL.PS_Site_ID;

 // PAR.FS Address Line 2 = CON.*BLANK
 PAR.FS_Address_Line_2 = *BLANK;

 // PAR.FS Address Line 3 = CON.*BLANK
 PAR.FS_Address_Line_3 = *BLANK;

 EXECUTE FUNCTION(Rtv PrdSite Inform    RT) TYPE(RTVOBJ) FILE(PLATREP)           AB1273272;
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(LCL.PS_Site_ID);
 PARAMETER(PAR.FS_Name);
 PARAMETER(NLL.PS_Manager);
 PARAMETER(PAR.FS_Address_Line_1);
 PARAMETER(PAR.FS_City);
 PARAMETER(PAR.FS_State);
 PARAMETER(PAR.FS_Zip);
 PARAMETER(NLL.PS_Latitude);
 PARAMETER(NLL.PS_Longitude);
 PARAMETER(NLL.PS_User_Mileage_1);
 PARAMETER(NLL.PS_User_Mileage_2);
 PARAMETER(NLL.PS_Facility_Type_County);
 PARAMETER(NLL.PS_Status_1);
 PARAMETER(NLL.PS_Status_2);
 PARAMETER(NLL.PS_Status_3);
 PARAMETER(LCL.PS_Trace_Sequence_#);
 PARAMETER(NLL.PS_Veterinarian);
 PARAMETER(NLL.PS_Nutritionist);
 PARAMETER(NLL.PS_Premises_ID);
 PARAMETER(NLL.RS_Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // PAR.FS Certified Number = CVTVAR(LCL.PS Trace Sequence #)
 PAR.FS_Certified_Number = CVTVAR(LCL.PS_Trace_Sequence_#);

 //?OVRRIDE: w/Site ID Info
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Farm Site 6.0 USR = LCL.Pl VND Address Number
 LCL.Farm_Site_6_0_USR = LCL.Pl_VND_Address_Number;

 // PAR.FS Certified Number = CVTVAR(LCL.Farm Site 6.0 USR)
 PAR.FS_Certified_Number = CVTVAR(LCL.Farm_Site_6_0_USR);

 ENDIF;

 ENDIF;

 //?** CRT: WF Farm Summary
 // PAR.FS Certified Name = CONCAT(CON.Seaboard Certified Farm #,PAR.FS Certified Number,CON.1)
 PAR.FS_Certified_Name = 'Seaboard Certified Farm #' + PAR.FS_Certified_Number (1);

 // Call program Rtv State Description UP.
 CALL PROGRAM(Rtv State Description UP) ('STATERET');
 PARAMETER(LCL.Return_Code_USR);
 PARAMETER(PAR.FS_State);
 PARAMETER(PAR.FS_State_Name);

 EXECUTE FUNCTION(Crt Farm Summary      RT) TYPE(RTVOBJ) FILE(PLAYCPP)           AB1279317;
 PARAMETER(PAR.FS_Company_Number);
 PARAMETER(PAR.FS_Producer_Code);
 PARAMETER(PAR.FS_Producer_Location);
 PARAMETER(PAR.FS_Farm_Site_ID);
 PARAMETER(PAR.FS_Name);
 PARAMETER(PAR.FS_Address_Line_1);
 PARAMETER(PAR.FS_Address_Line_2);
 PARAMETER(PAR.FS_Address_Line_3);
 PARAMETER(PAR.FS_City);
 PARAMETER(PAR.FS_State);
 PARAMETER(PAR.FS_State_Name);
 PARAMETER(PAR.FS_Zip);
 PARAMETER(PAR.FS_Certified_Number);
 PARAMETER(PAR.FS_Certified_Name);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create WF Farm Summary) TYPE(CRTOBJ) FILE(PLAYCPP)             AB1279196;
  PARAMETER(PAR.FS_Company_Number);
  PARAMETER(PAR.FS_Producer_Code);
  PARAMETER(PAR.FS_Producer_Location);
  PARAMETER(PAR.FS_Farm_Site_ID);
  PARAMETER(PAR.FS_Name);
  PARAMETER(PAR.FS_Address_Line_1);
  PARAMETER(PAR.FS_Address_Line_2);
  PARAMETER(PAR.FS_Address_Line_3);
  PARAMETER(PAR.FS_City);
  PARAMETER(PAR.FS_State);
  PARAMETER(PAR.FS_State_Name);
  PARAMETER(PAR.FS_Zip);
  PARAMETER(PAR.FS_Certified_Number);
  PARAMETER(PAR.FS_Certified_Name);
 }

 //?** INIT: Hold Values
 // PAR.PD Producer Code = DB1.PD Producer Code
 PAR.PD_Producer_Code = DB1.PD_Producer_Code;

 // PAR.PL Location Code = DB1.PL Location Code
 PAR.PL_Location_Code = DB1.PL_Location_Code;

 // PAR.TH HPS Farm Site = DB1.TH HPS Farm Site
 PAR.TH_HPS_Farm_Site = DB1.TH_HPS_Farm_Site;

 // PAR.PS Site ID = LCL.PS Site ID
 PAR.PS_Site_ID = LCL.PS_Site_ID;

 //?** INIT: Farm Summary Fields
 EXECUTE FUNCTION(INT WF Farm Summary   IF) TYPE(EXCINTFUN)                      AB1279253;
 PARAMETER(PAR.FS_Company_Number);
 PARAMETER(PAR.FS_Producer_Code);
 PARAMETER(PAR.FS_Producer_Location);
 PARAMETER(PAR.FS_Farm_Site_ID);
 PARAMETER(PAR.FS_Name);
 PARAMETER(PAR.FS_Address_Line_1);
 PARAMETER(PAR.FS_Address_Line_2);
 PARAMETER(PAR.FS_Address_Line_3);
 PARAMETER(PAR.FS_City);
 PARAMETER(PAR.FS_State);
 PARAMETER(PAR.FS_State_Name);
 PARAMETER(PAR.FS_Zip);
 PARAMETER(PAR.FS_Certified_Number);
 PARAMETER(PAR.FS_Certified_Name);
 {
  //?Execute internal function

  MOVE *ALL (To: PAR From: CON);

 }

 ENDIF;

 ENDIF;

}


