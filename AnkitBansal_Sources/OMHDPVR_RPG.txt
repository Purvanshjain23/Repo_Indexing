     H/TITLE Edt Enter Transfer Trn PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/30/23  Time  : 09:54:19
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMHDPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Enter Transfer Trn PV Prompt & validate record
      *
     FCAB7CPL7IF  E           K        DISK
      * RSQ : Item Transaction Detail   Trans Date/Batch no.
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDL1REL1IF  E           K        DISK
      * RTV : User Warehouse Access     Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FCAEFREL1IF  E           K        DISK
      * RTV : Reason Codes              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAAMREL3IF  E           K        DISK
      * RTV : Unit of Measure           Active Records
      *
     FCAEFREL2IF  E           K        DISK
      * RTV : Reason Codes              Rtv Active Reason Codes
      *
     FCADVREL2IF  E           K        DISK
      * RTV : Reference Number Master   Active Only
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     E                    #L7         7  1
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 023  5 0A
     E                    W0END   7 023  5 0A
     E                    W0NAM   7 023 10
      * Long constants
     E                    @CN#    1  07  6   @CN    25
     I@B7CPH4
      * Item Transaction Detail   Trans Date/Batch no.
      * Renamed input format fields
     I              B7AIC3                          WAAIC3
     I              B7HGCD                          WAHGCD
     I              B7AJCD                          WAAJCD
     I              B7W9ST                          WAW9ST
     I              B7BSST                          WABSST
     I              B7B4DT                          WAB4DT
     I              B7C4NY                          WAC4NY
     I              B7DXNB                          WADXNB
     I              B7ELDT                          WAELDT
     I              B7HVCD                          WAHVCD
     I              B7F1ST                          WAF1ST
     I              B7AUNA                          WAAUNA
     I              B7A5QT                          WAA5QT
     I              B7AHWG                          WAAHWG
     I              B7AKCS                          WAAKCS
     I              B7CGCD                          WACGCD
     I              B7AYVA                          WAAYVA
     I              B7BJNA                          WABJNA
     I              B7CKNB                          WACKNB
     I              B7BMST                          WABMST
     I              B7CQCD                          WACQCD
     I              B7MGNA                          WAMGNA
     I              B7TRBN                          WATRBN
     I              B7TRBS                          WATRBS
     I              B7C4NB                          WAC4NB
     I              B7RINB                          WARINB
     I              B7RHNB                          WARHNB
     I              B7RGNB                          WARGNB
     I              B7M3NA                          WAM3NA
     I              B7AWTM                          WAAWTM
     I              B7XLCD                          WAXLCD
     I              B7K7DT                          WAK7DT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WBAJVN
     I              DRAUNA                          WBAUNA
     I              DRB8NA                          WBB8NA
     I              DRAHVN                          WBAHVN
     I              DRI6ST                          WBI6ST
     I              DRI7ST                          WBI7ST
     I              DRXMST                          WBXMST
     I              DRXNST                          WBXNST
     I              DRI8ST                          WBI8ST
     I              DRNLNB                          WBNLNB
     I              DRMPNA                          WBMPNA
     I              DRBCCD                          WBBCCD
     I              DRAIC3                          WBAIC3
     I              DRDQCD                          WBDQCD
     I              DRDRCD                          WBDRCD
     I              DRAJCD                          WBAJCD
     I              DRBUVN                          WBBUVN
     I              DRUVST                          WBUVST
     I              DRUWST                          WBUWST
     I              DRUXST                          WBUXST
     I              DRAATM                          WBAATM
     I              DRAYNA                          WBAYNA
     I              DRA0NA                          WBA0NA
     I              DRAXDT                          WBAXDT
      *
     I@L1RESJ
      * User Warehouse Access     Retrieval index
      * Renamed input format fields
     I              L1AJVN                          WCAJVN
     I              L1AJCD                          WCAJCD
     I              L1UWAS                          WCUWAS
     I              L1EPSX                          WCEPSX
     I              L1EQSX                          WCEQSX
     I              L1ERSX                          WCERSX
     I              L1UWAT                          WCUWAT
     I              L1EKSX                          WCEKSX
     I              L1ECSX                          WCECSX
     I              L1EDSX                          WCEDSX
     I              L1EESX                          WCEESX
     I              L1EFSX                          WCEFSX
     I              L1EGSX                          WCEGSX
     I              L1EHSX                          WCEHSX
     I              L1EISX                          WCEISX
     I              L1EJSX                          WCEJSX
     I              L1UWAU                          WCUWAU
     I              L1ELSX                          WCELSX
     I              L1EMSX                          WCEMSX
     I              L1ENSX                          WCENSX
     I              L1EOSX                          WCEOSX
     I              L1UVST                          WCUVST
     I              L1UWST                          WCUWST
     I              L1UXST                          WCUXST
     I              L1VSST                          WCVSST
     I              L1AATM                          WCAATM
     I              L1AYNA                          WCAYNA
     I              L1A0NA                          WCA0NA
     I              L1AXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WEAIC3
     I              BZHGCD                          WEHGCD
     I              BZAVNA                          WEAVNA
     I              BZAWNA                          WEAWNA
     I              BZL7NA                          WEL7NA
     I              BZL8NA                          WEL8NA
     I              BZL6NA                          WEL6NA
     I              BZMFNA                          WEMFNA
     I              BZADCD                          WEADCD
     I              BZAWPC                          WEAWPC
     I              BZLXST                          WELXST
     I              BZAECD                          WEAECD
     I              BZAXPC                          WEAXPC
     I              BZLYST                          WELYST
     I              BZAFCD                          WEAFCD
     I              BZAICD                          WEAICD
     I              BZAIWG                          WEAIWG
     I              BZHICD                          WEHICD
     I              BZRBCD                          WERBCD
     I              BZFZST                          WEFZST
     I              BZAVST                          WEAVST
     I              BZCZWG                          WECZWG
     I              BZC0WG                          WEC0WG
     I              BZURTN                          WEURTN
     I              BZAJC8                          WEAJC8
     I              BZRINB                          WERINB
     I              BZRHNB                          WERHNB
     I              BZRGNB                          WERGNB
     I              BZLNCD                          WELNCD
     I              BZTFNB                          WETFNB
     I              BZN0CD                          WEN0CD
     I              BZX4ST                          WEX4ST
     I              BZTMVA                          WETMVA
     I              BZTNVA                          WETNVA
     I              BZBLPR                          WEBLPR
     I              BZBMPR                          WEBMPR
     I              BZLRCD                          WELRCD
     I              BZU9ST                          WEU9ST
     I              BZCMCO                          WECMCO
     I              BZQ1CD                          WEQ1CD
     I              BZQ8CD                          WEQ8CD
     I              BZCHTM                          WECHTM
     I              BZQZCD                          WEQZCD
     I              BZXWST                          WEXWST
     I              BZXXST                          WEXXST
     I              BZVMST                          WEVMST
     I              BZSWGH                          WESWGH
     I              BZPPHE                          WEPPHE
     I              BZR3CD                          WER3CD
     I              BZSDCD                          WESDCD
     I              BZICN1                          WEICN1
     I              BZSVCD                          WESVCD
     I              BZICN2                          WEICN2
     I              BZSWCD                          WESWCD
     I              BZV2NB                          WEV2NB
     I              BZSXCD                          WESXCD
     I              BZITCN                          WEITCN
     I              BZSYCD                          WESYCD
     I              BZITC5                          WEITC5
     I              BZSZCD                          WESZCD
     I              BZICN6                          WEICN6
     I              BZS0CD                          WES0CD
     I              BZICN7                          WEICN7
     I              BZS1CD                          WES1CD
     I              BZICN8                          WEICN8
     I              BZS2CD                          WES2CD
     I              BZICN9                          WEICN9
     I              BZS3CD                          WES3CD
     I              BZICN0                          WEICN0
     I              BZS4CD                          WES4CD
     I              BZSFNB                          WESFNB
     I              BZA3WG                          WEA3WG
     I              BZSJNB                          WESJNB
     I              BZLLCD                          WELLCD
     I              BZLMCD                          WELMCD
     I              BZP3ST                          WEP3ST
     I              BZSKNB                          WESKNB
     I              BZSLNB                          WESLNB
     I              BZSMNB                          WESMNB
     I              BZP4ST                          WEP4ST
     I              BZCFNB                          WECFNB
     I              BZCGNB                          WECGNB
     I              BZILNB                          WEILNB
     I              BZCHNB                          WECHNB
     I              BZCINB                          WECINB
     I              BZCJNB                          WECJNB
     I              BZCMNB                          WECMNB
     I              BZCNNB                          WECNNB
     I              BZCRNB                          WECRNB
     I              BZCSNB                          WECSNB
     I              BZCVNB                          WECVNB
     I              BZCWNB                          WECWNB
     I              BZCXNB                          WECXNB
     I              BZCZNB                          WECZNB
     I              BZC0NB                          WEC0NB
     I              BZN1CD                          WEN1CD
     I              BZB4NB                          WEB4NB
     I              BZB5NB                          WEB5NB
     I              BZX5ST                          WEX5ST
     I              BZX6ST                          WEX6ST
     I              BZX7ST                          WEX7ST
     I              BZPCCT                          WEPCCT
     I              BZBDNB                          WEBDNB
     I              BZBJNB                          WEBJNB
     I              BZSUST                          WESUST
     I              BZSVST                          WESVST
     I              BZSYST                          WESYST
     I              BZSZST                          WESZST
     I              BZS1ST                          WES1ST
     I              BZXRCD                          WEXRCD
     I              BZXTCD                          WEXTCD
     I              BZXUCD                          WEXUCD
     I              BZF5WG                          WEF5WG
     I              BZF6WG                          WEF6WG
     I              BZF7WG                          WEF7WG
     I              BZBLNB                          WEBLNB
     I              BZBNNB                          WEBNNB
     I              BZS2ST                          WES2ST
     I              BZS4ST                          WES4ST
     I              BZS5ST                          WES5ST
     I              BZS6ST                          WES6ST
     I              BZS8ST                          WES8ST
     I              BZS9ST                          WES9ST
     I              BZTCST                          WETCST
     I              BZTDST                          WETDST
     I              BZUVST                          WEUVST
     I              BZUWST                          WEUWST
     I              BZUXST                          WEUXST
     I              BZVSST                          WEVSST
     I              BZAATM                          WEAATM
     I              BZAYNA                          WEAYNA
     I              BZA0NA                          WEA0NA
     I              BZAXDT                          WEAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WFAIC3
     I              B1HGCD                          WFHGCD
     I              B1AJCD                          WFAJCD
     I              B1ELDT                          WFELDT
     I              B1ABWG                          WFABWG
     I              B1AGQT                          WFAGQT
     I              B1AHQT                          WFAHQT
     I              B1AIQT                          WFAIQT
     I              B1CTST                          WFCTST
     I              B1ACWG                          WFACWG
     I              B1ARQT                          WFARQT
     I              B1ASQT                          WFASQT
     I              B1ATQT                          WFATQT
     I              B1HDQT                          WFHDQT
     I              B1HEQT                          WFHEQT
     I              B1F6ST                          WFF6ST
     I              B1BMWG                          WFBMWG
     I              B1DSQT                          WFDSQT
     I              B1DTQT                          WFDTQT
     I              B1DUQT                          WFDUQT
     I              B1DHDT                          WFDHDT
     I              B1AGCS                          WFAGCS
     I              B1AECS                          WFAECS
     I              B1IDVA                          WFIDVA
     I              B1K7DT                          WFK7DT
     I              B1RINB                          WFRINB
     I              B1RHNB                          WFRHNB
     I              B1RGNB                          WFRGNB
     I              B1UVST                          WFUVST
     I              B1UWST                          WFUWST
     I              B1UXST                          WFUXST
     I              B1VSST                          WFVSST
     I              B1AATM                          WFAATM
     I              B1AYNA                          WFAYNA
     I              B1A0NA                          WFA0NA
     I              B1AXDT                          WFAXDT
      *
     I@EFREV2
      * Reason Codes              Retrieval index       NV
      * Renamed input format fields
     I              EFCQCD                          WGCQCD
     I              EFAUNA                          WGAUNA
     I              EFUVST                          WGUVST
     I              EFUWST                          WGUWST
     I              EFUXST                          WGUXST
     I              EFVSST                          WGVSST
     I              EFAATM                          WGAATM
     I              EFAYNA                          WGAYNA
     I              EFA0NA                          WGA0NA
     I              EFAXDT                          WGAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WHAIC3
     I              B0HGCD                          WHHGCD
     I              B0AJCD                          WHAJCD
     I              B0AGCS                          WHAGCS
     I              B0AECS                          WHAECS
     I              B0BACS                          WHBACS
     I              B0BBCS                          WHBBCS
     I              B0CBPR                          WHCBPR
     I              B0GUDT                          WHGUDT
     I              B0XYST                          WHXYST
     I              B0CTPR                          WHCTPR
     I              B0G4DT                          WHG4DT
     I              B0BOWG                          WHBOWG
     I              B0DDQT                          WHDDQT
     I              B0DEQT                          WHDEQT
     I              B0DFQT                          WHDFQT
     I              B0HDQT                          WHHDQT
     I              B0HEQT                          WHHEQT
     I              B0AJQT                          WHAJQT
     I              B0AQQT                          WHAQQT
     I              B0AUQT                          WHAUQT
     I              B0EMQT                          WHEMQT
     I              B0DOQT                          WHDOQT
     I              B0ATNA                          WHATNA
     I              B0AKDT                          WHAKDT
     I              B0ANDT                          WHANDT
     I              B0IDVA                          WHIDVA
     I              B0JVST                          WHJVST
     I              B0BZPC                          WHBZPC
     I              B0DGQT                          WHDGQT
     I              B0DIDT                          WHDIDT
     I              B0ALCD                          WHALCD
     I              B0BFDY                          WHBFDY
     I              B0DJDT                          WHDJDT
     I              B0BGDY                          WHBGDY
     I              B0DKDT                          WHDKDT
     I              B0J2ST                          WHJ2ST
     I              B0DJQT                          WHDJQT
     I              B0BNWG                          WHBNWG
     I              B0DLDT                          WHDLDT
     I              B0DPQT                          WHDPQT
     I              B0DQQT                          WHDQQT
     I              B0DMDT                          WHDMDT
     I              B0M0ST                          WHM0ST
     I              B0J9ST                          WHJ9ST
     I              B0KBST                          WHKBST
     I              B0AKC8                          WHAKC8
     I              B0RINB                          WHRINB
     I              B0RHNB                          WHRHNB
     I              B0RGNB                          WHRGNB
     I              B0UVST                          WHUVST
     I              B0UWST                          WHUWST
     I              B0UXST                          WHUXST
     I              B0VSST                          WHVSST
     I              B0AATM                          WHAATM
     I              B0AYNA                          WHAYNA
     I              B0A0NA                          WHA0NA
     I              B0AXDT                          WHAXDT
      *
     I@AMREU9
      * Unit of Measure           Active Records
      * Renamed input format fields
     I              AMHHCD                          WIHHCD
     I              AMAUNA                          WIAUNA
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
     I@EFREU4
      * Reason Codes              Rtv Active Reason Codes
      * Renamed input format fields
     I              EFCQCD                          WJCQCD
     I              EFAUNA                          WJAUNA
     I              EFUVST                          WJUVST
     I              EFUWST                          WJUWST
     I              EFUXST                          WJUXST
     I              EFVSST                          WJVSST
     I              EFAATM                          WJAATM
     I              EFAYNA                          WJAYNA
     I              EFA0NA                          WJA0NA
     I              EFAXDT                          WJAXDT
      *
     I@DVREWC
      * Reference Number Master   Active Only
      * Renamed input format fields
     I              DVAIC3                          WKAIC3
     I              DVDTCD                          WKDTCD
     I              DVBZTX                          WKBZTX
     I              DVUVST                          WKUVST
     I              DVUWST                          WKUWST
     I              DVUXST                          WKUXST
     I              DVVSST                          WKVSST
     I              DVAATM                          WKAATM
     I              DVAYNA                          WKAYNA
     I              DVA0NA                          WKA0NA
     I              DVAXDT                          WKAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     I@FAREBE
      * Item Structure Class      Retrieval index
      * Renamed input format fields
     I              FARINB                          WMRINB
     I              FARHNB                          WMRHNB
     I              FADETX                          WMDETX
     I              FAUVST                          WMUVST
     I              FAUWST                          WMUWST
     I              FAUXST                          WMUXST
     I              FAVSST                          WMVSST
     I              FAAATM                          WMAATM
     I              FAAYNA                          WMAYNA
     I              FAA0NA                          WMA0NA
     I              FAAXDT                          WMAXDT
      *
     I@E9REA8
      * Item Structure Group      Retrieval index
      * Renamed input format fields
     I              E9RHNB                          WORHNB
     I              E9RGNB                          WORGNB
     I              E9DDTX                          WODDTX
     I              E9UVST                          WOUVST
     I              E9UWST                          WOUWST
     I              E9UXST                          WOUXST
     I              E9VSST                          WOVSST
     I              E9AATM                          WOAATM
     I              E9AYNA                          WOAYNA
     I              E9A0NA                          WOA0NA
     I              E9AXDT                          WOAXDT
      *
     I@E8REBB
      * Item Structure Type       Retrieval index
      * Renamed input format fields
     I              E8RGNB                          WRRGNB
     I              E8DCTX                          WRDCTX
     I              E8UVST                          WRUVST
     I              E8UWST                          WRUWST
     I              E8UXST                          WRUXST
     I              E8VSST                          WRVSST
     I              E8AATM                          WRAATM
     I              E8AYNA                          WRAYNA
     I              E8A0NA                          WRA0NA
     I              E8AXDT                          WRAXDT
      *
     I@AMREB0
      * Unit of Measure           Retrieval index       NV
      * Renamed input format fields
     I              AMHHCD                          WSHHCD
     I              AMAUNA                          WSAUNA
     I              AMUVST                          WSUVST
     I              AMUWST                          WSUWST
     I              AMUXST                          WSUXST
     I              AMVSST                          WSVSST
     I              AMAATM                          WSAATM
     I              AMAYNA                          WSAYNA
     I              AMA0NA                          WSA0NA
     I              AMAXDT                          WSAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WTAIC3
     I              ABADTX                          WTADTX
     I              ABACNA                          WTACNA
     I              ABADNA                          WTADNA
     I              ABAENA                          WTAENA
     I              ABAJNA                          WTAJNA
     I              ABBTTX                          WTBTTX
     I              ABBVTX                          WTBVTX
     I              ABBWTX                          WTBWTX
     I              ABA2NA                          WTA2NA
     I              ABABTX                          WTABTX
     I              ABBGCD                          WTBGCD
     I              ABKXCD                          WTKXCD
     I              ABUVST                          WTUVST
     I              ABUWST                          WTUWST
     I              ABUXST                          WTUXST
     I              ABVSST                          WTVSST
     I              ABAATM                          WTAATM
     I              ABAYNA                          WTAYNA
     I              ABA0NA                          WTA0NA
     I              ABAXDT                          WTAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WVAJCD
     I              ADF8NA                          WVF8NA
     I              ADACNA                          WVACNA
     I              ADADNA                          WVADNA
     I              ADAENA                          WVAENA
     I              ADAJNA                          WVAJNA
     I              ADBTTX                          WVBTTX
     I              ADAOCD                          WVAOCD
     I              ADBGCD                          WVBGCD
     I              ADVHST                          WVVHST
     I              ADMPNA                          WVMPNA
     I              ADWPST                          WVWPST
     I              ADXUST                          WVXUST
     I              ADT0ST                          WVT0ST
     I              ADT1ST                          WVT1ST
     I              ADDBNB                          WVDBNB
     I              ADT2ST                          WVT2ST
     I              ADT3ST                          WVT3ST
     I              ADT4ST                          WVT4ST
     I              ADT6ST                          WVT6ST
     I              ADBWC3                          WVBWC3
     I              ADBTC3                          WVBTC3
     I              ADBUC3                          WVBUC3
     I              ADBVC3                          WVBVC3
     I              ADFCAA                          WVFCAA
     I              ADRQSX                          WVRQSX
     I              ADRRSX                          WVRRSX
     I              ADRSSX                          WVRSSX
     I              ADRTSX                          WVRTSX
     I              ADT7ST                          WVT7ST
     I              ADT8ST                          WVT8ST
     I              ADRNSX                          WVRNSX
     I              ADROSX                          WVROSX
     I              ADRPSX                          WVRPSX
     I              ADUVST                          WVUVST
     I              ADUWST                          WVUWST
     I              ADUXST                          WVUXST
     I              ADVSST                          WVVSST
     I              ADAATM                          WVAATM
     I              ADAYNA                          WVAYNA
     I              ADA0NA                          WVA0NA
     I              ADAXDT                          WVAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WWAIC3
     I              ASAXNB                          WWAXNB
     I              ASNGNB                          WWNGNB
     I              ASBZNB                          WWBZNB
     I              ASC5NB                          WWC5NB
     I              ASC3NB                          WWC3NB
     I              ASCYNB                          WWCYNB
     I              ASIONB                          WWIONB
     I              ASI6NB                          WWI6NB
     I              ASDCNB                          WWDCNB
     I              ASC7NB                          WWC7NB
     I              ASC2NB                          WWC2NB
     I              ASC1NB                          WWC1NB
     I              ASL8NB                          WWL8NB
     I              ASBANB                          WWBANB
     I              ASCHST                          WWCHST
     I              ASCKST                          WWCKST
     I              ASCIST                          WWCIST
     I              ASCGST                          WWCGST
     I              ASAIPC                          WWAIPC
     I              ASASPC                          WWASPC
     I              ASA2VA                          WWA2VA
     I              ASC2ST                          WWC2ST
     I              ASD8ST                          WWD8ST
     I              ASD7ST                          WWD7ST
     I              ASA8NA                          WWA8NA
     I              ASA9NA                          WWA9NA
     I              ASBANA                          WWBANA
     I              ASBBNA                          WWBBNA
     I              ASEUST                          WWEUST
     I              ASAADY                          WWAADY
     I              ASABDY                          WWABDY
     I              ASACDY                          WWACDY
     I              ASADDY                          WWADDY
     I              ASAEDY                          WWAEDY
     I              ASAFDY                          WWAFDY
     I              ASAGDY                          WWAGDY
     I              ASAHDY                          WWAHDY
     I              ASAENB                          WWAENB
     I              ASALNB                          WWALNB
     I              ASEVNB                          WWEVNB
     I              ASRPOP                          WWRPOP
     I              ASDWNB                          WWDWNB
     I              ASR3NB                          WWR3NB
     I              ASPNST                          WWPNST
     I              ASR4NB                          WWR4NB
     I              ASPOST                          WWPOST
     I              ASSCNB                          WWSCNB
     I              ASVIST                          WWVIST
     I              ASVJST                          WWVJST
     I              ASBVVN                          WWBVVN
     I              ASUVST                          WWUVST
     I              ASUWST                          WWUWST
     I              ASUXST                          WWUXST
     I              ASVSST                          WWVSST
     I              ASAATM                          WWAATM
     I              ASAYNA                          WWAYNA
     I              ASA0NA                          WWA0NA
     I              ASAXDT                          WWAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WXDNCD
     I              DNAUNA                          WXAUNA
     I              DNVKST                          WXVKST
     I              DNRSCD                          WXRSCD
     I              DNUVST                          WXUVST
     I              DNUWST                          WXUWST
     I              DNUXST                          WXUXST
     I              DNAATM                          WXAATM
     I              DNAYNA                          WXAYNA
     I              DNA0NA                          WXA0NA
     I              DNAXDT                          WXAXDT
      *
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                          WYB3AB
     I              C6HUNZ                          WYHUNZ
     I              C6OCSC                          WYOCSC
     I              C6UNU1                          WYUNU1
     I              C6VSST                          WYVSST
     I              C6BGTS                          WYBGTS
     I              C6RUU1                          WYRUU1
     I              C6RVU1                          WYRVU1
     I              C6BHTS                          WYBHTS
     I              C6RWU1                          WYRWU1
     I              C6RXU1                          WYRXU1
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                              9
      * KEY : Item Balance              Co/Whse/Item
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Warehouse Code
     I                                        3   5 PAAJCD
      * B : MAP Item Code
     I                                    P   6   90PAHGCD
      *
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WWAIC3
     I              ASAXNB                          WWAXNB
     I              ASNGNB                          WWNGNB
     I              ASBZNB                          WWBZNB
     I              ASC5NB                          WWC5NB
     I              ASC3NB                          WWC3NB
     I              ASCYNB                          WWCYNB
     I              ASIONB                          WWIONB
     I              ASI6NB                          WWI6NB
     I              ASDCNB                          WWDCNB
     I              ASC7NB                          WWC7NB
     I              ASC2NB                          WWC2NB
     I              ASC1NB                          WWC1NB
     I              ASL8NB                          WWL8NB
     I              ASBANB                          WWBANB
     I              ASCHST                          WWCHST
     I              ASCKST                          WWCKST
     I              ASCIST                          WWCIST
     I              ASCGST                          WWCGST
     I              ASAIPC                          WWAIPC
     I              ASASPC                          WWASPC
     I              ASA2VA                          WWA2VA
     I              ASC2ST                          WWC2ST
     I              ASD8ST                          WWD8ST
     I              ASD7ST                          WWD7ST
     I              ASA8NA                          WWA8NA
     I              ASA9NA                          WWA9NA
     I              ASBANA                          WWBANA
     I              ASBBNA                          WWBBNA
     I              ASEUST                          WWEUST
     I              ASAADY                          WWAADY
     I              ASABDY                          WWABDY
     I              ASACDY                          WWACDY
     I              ASADDY                          WWADDY
     I              ASAEDY                          WWAEDY
     I              ASAFDY                          WWAFDY
     I              ASAGDY                          WWAGDY
     I              ASAHDY                          WWAHDY
     I              ASAENB                          WWAENB
     I              ASALNB                          WWALNB
     I              ASEVNB                          WWEVNB
     I              ASRPOP                          WWRPOP
     I              ASDWNB                          WWDWNB
     I              ASR3NB                          WWR3NB
     I              ASPNST                          WWPNST
     I              ASR4NB                          WWR4NB
     I              ASPOST                          WWPOST
     I              ASSCNB                          WWSCNB
     I              ASVIST                          WWVIST
     I              ASVJST                          WWVJST
     I              ASBVVN                          WWBVVN
     I              ASUVST                          WWUVST
     I              ASUWST                          WWUWST
     I              ASUXST                          WWUXST
     I              ASVSST                          WWVSST
     I              ASAATM                          WWAATM
     I              ASAYNA                          WWAYNA
     I              ASA0NA                          WWA0NA
     I              ASAXDT                          WWAXDT
      *
     IYARDCS      DS                            278
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Warehouse Codes
      * B : MAP Warehouse Code
     I                                        1   3 P1AJCD
      * N : MAP Warehouse Description
     I                                        4  33 P1F8NA
      * N :  Trans Contol AS400_Plant
     I                                       34  34 P1XUST
      * N :  WHS Live with Carlisle
     I                                       35  35 P1RRSX
      * N :  WHS PFS Interface
     I                                       36  36 P1RSSX
     IP2PARM      DS
      * FLD: Company Item
      * I : MAP Company Number
     I                                    P   1   20P2AIC3
      * N : MAP Description Line One
     I                                        3  32 P2AVNA
      * N :  Description Line Two
     I                                       33  62 P2AWNA
      * N :  UOM Primary
     I                                       63  64 P2ADCD
      * N :  Conversion Factor 1
     I                                    P  65  694P2AWPC
      * N :  Operation Factor 1
     I                                       70  70 P2LXST
      * N :  UOM Second
     I                                       71  72 P2AECD
      * N :  Conversion Factor 2
     I                                    P  73  774P2AXPC
      * N :  Operation Factor 2
     I                                       78  78 P2LYST
      * N :  UOM Third
     I                                       79  80 P2AFCD
      * N :  UOM Pricing
     I                                       81  82 P2AICD
      * N :  Unit Weight
     I                                    P  83  882P2AIWG
      * N :  Production Date Control
     I                                       89  89 P2FZST
      * N :  Catch Weight Status
     I                                       90  90 P2AVST
     IP3PARM      DS
      * FLD: Item Transaction Detail
      * I : MAP Inventory Trans ID
     I                                        1   1 P3W9ST
      * I : MAP Inventory Trans Type
     I                                        2   3 P3BSST
      * I : MAP Transaction Date Code
     I                                    P   4   70P3B4DT
      * N :  GL Update Status
     I                                        8   8 P3BMST
     IP4PARM      DS
      * I : MAP USR Hold Description
     I                                        1  30 P4CUNA
     IP5PARM      DS
      * I : MAP Name
     I                                        1  30 P5ADTX
     IP6PARM      DS
      * O :  Printed Status
     I                                        1   1 P6C1ST
     IP7PARM      DS
      * N :  USR Return Code
     I                                        1   1 P7N7CD
     IP8PARM      DS
      * FLD: Item Balance
      * N :  Revaluation Cost
     I                                    P   1   64P8CBPR
      * N :  Cost Update Pending
     I                                        7   7 P8J9ST
      * N :  Post GL Status
     I                                        8   8 P8KBST
      * N :  Vendor Item_Whse Default
     I                                    P   9  130P8AKC8
      * N :  Record Status
     I                                       14  14 P8VSST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Last item processed'
      * @Item Code
     I                                        1   7 ZA0001
      * Message data for 'Last item not processed'
      * @Item Code
     I                                        1   7 ZA0002
      * Message data for 'Last item not processed'
      * @Item Code
     I                                        1   7 ZA0003
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0004
      * Warehouse Code
     I                                       11  13 ZA0005
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0006
      * Condition Name USR
     I                                       11  35 ZA0007
      * Warehouse Code
     I                                       36  38 ZA0008
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0009
      * Condition Name USR
     I                                       11  35 ZA0010
      * Warehouse Code
     I                                       36  38 ZA0011
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0012
      * Condition Name USR
     I                                       11  35 ZA0013
      * Warehouse Code
     I                                       36  38 ZA0014
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0015
      * Condition Name USR
     I                                       11  35 ZA0016
      * Warehouse Code
     I                                       36  38 ZA0017
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0018
      * Condition Name USR
     I                                       11  35 ZA0019
      * Warehouse Code
     I                                       36  38 ZA0020
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0021
      * Condition Name USR
     I                                       11  35 ZA0022
      * Warehouse Code
     I                                       36  38 ZA0023
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0024
      * Condition Name USR
     I                                       11  35 ZA0025
      * Warehouse Code
     I                                       36  38 ZA0026
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0027
      * Condition Name USR
     I                                       11  35 ZA0028
      * Warehouse Code
     I                                       36  38 ZA0029
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0030
      * Warehouse Code
     I                                       11  13 ZA0031
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0032
      * Condition Name USR
     I                                       11  35 ZA0033
      * Warehouse Code
     I                                       36  38 ZA0034
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0035
      * Condition Name USR
     I                                       11  35 ZA0036
      * Warehouse Code
     I                                       36  38 ZA0037
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0038
      * Condition Name USR
     I                                       11  35 ZA0039
      * Warehouse Code
     I                                       36  38 ZA0040
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0041
      * Condition Name USR
     I                                       11  35 ZA0042
      * Warehouse Code
     I                                       36  38 ZA0043
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0044
      * Condition Name USR
     I                                       11  35 ZA0045
      * Warehouse Code
     I                                       36  38 ZA0046
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0047
      * Condition Name USR
     I                                       11  35 ZA0048
      * Warehouse Code
     I                                       36  38 ZA0049
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0050
      * Condition Name USR
     I                                       11  35 ZA0051
      * Warehouse Code
     I                                       36  38 ZA0052
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0053
      * Condition Name USR
     I                                       11  35 ZA0054
      * Warehouse Code
     I                                       36  38 ZA0055
      * Message data for 'PFS ctrld can't be used'
      * Warehouse Code
     I                                        1   3 ZA0056
      * Message data for 'Warehouse not found'
      * Message data for 'Prod Date must be blank'
      * Production Date
     I                                    P   1   40ZA0057
      * Message data for 'Item balance detail not f'
      * Message data for 'Date In Cannot Be < 2yrs'
      * Generic Message 80 USR
     I                                        1  80 ZA0058
      * Date In  (7,0) USR
     I                                    P  81  840ZA0059
      * Message data for 'Item not found'
      * Message data for 'Item blance is not active'
      * Item Code
     I                                        1   7 ZA0060
      * Warehouse Code
     I                                        8  10 ZA0061
      * Message data for 'Item Balance           NF'
      * Company Number
     I                                        1   3 ZA0062
      * Item Code
     I                                        4  10 ZA0063
      * Warehouse Code
     I                                       11  13 ZA0064
      * Message data for 'Item Balance           NF'
      * Company Number
     I                                        1   3 ZA0065
      * Item Code
     I                                        4  10 ZA0066
      * Warehouse Code
     I                                       11  13 ZA0067
      * Message data for 'Warehouse must differ tr.'
      * Message data for 'UOM not on item'
      * UOM Primary
     I                                        1   2 ZA0068
      * UOM Second
     I                                        3   4 ZA0069
      * UOM Third
     I                                        5   6 ZA0070
      * Item Code
     I                                        7  13 ZA0071
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AJCD    PARM P1AJCD    WP0001  3        Warehouse Code
     C           P2AIC3    PARM           WP0002  30       Company Number
     C           P3W9ST    PARM           WP0003  1        Inventory Trans
     C           P3BSST    PARM           WP0004  2        Inventory Trans
     C           P3B4DT    PARM           WP0005  70       Transaction Dat
     C           P4CUNA    PARM           WP0006 30        USR Hold Descri
     C           P5ADTX    PARM           WP0007 30        Name
     C           P6C1ST    PARM P6C1ST    WP0008  1        Printed Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
     C                     MOVEL'LB'      #1CGCD           UOM Cost
      * WI517 DN 09/29/23-Added Output Parm 'Inventory Updated USR'.
      * Edt Enter Transfer Dtl EF - Item Balance Detail  * 
     C                     CALL 'OMHEEFR'              90  Edt Enter Trans
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0001  30       Company Number
     C                     PARM #1HGCD    WQ0002  70       Item Code
     C                     PARM #1AJCD    WQ0003  3        Warehouse Code
     C                     PARM P3W9ST    WQ0004  1        Inventory Trans
     C                     PARM P3BSST    WQ0005  2        Inventory Trans
     C                     PARM P3B4DT    WQ0006  70       Transaction Dat
     C                     PARM #1ELDT    WQ0007  70       Production Date
     C                     PARM #1HVCD    WQ0008  2        UOM Transaction
     C                     PARM #1AUNA    WQ0009 30        Description
     C                     PARM #1CGCD    WQ0010  2        UOM Cost
     C                     PARM #1CQCD    WQ0011  3        Reason Code
     C                     PARM #1TRBN    WQ0012  70       Transfer Batch
     C           #1TRBS    PARM #1TRBS    WQ0013  30       Transfer Batch
     C                     PARM #1XLCD    WQ0014  1        Shift Number
     C                     PARM #PAVNA    WQ0015 30        Description Lin
     C                     PARM P2ADCD    WQ0016  2        UOM Primary
     C                     PARM P2AWPC    WQ0017  94       Conversion Fact
     C                     PARM P2LXST    WQ0018  1        Operation Facto
     C                     PARM P2AECD    WQ0019  2        UOM Second
     C                     PARM P2AXPC    WQ0020  94       Conversion Fact
     C                     PARM P2LYST    WQ0021  1        Operation Facto
     C                     PARM P2AFCD    WQ0022  2        UOM Third
     C                     PARM P2AIWG    WQ0023 112       Unit Weight
     C                     PARM P2FZST    WQ0024  1        Production Date
     C                     PARM P2AVST    WQ0025  1        Catch Weight St
     C                     PARM #PF8NA    WQ0026 30        Warehouse Descr
     C                     PARM #DCPCD    WQ0027  3        USR Warehouse C
     C                     PARM #PADTX    WQ0028 30        Name
     C                     PARM #DHLTX    WQ0029 25        Condition Desc.
     C                     PARM #PCUNA    WQ0030 30        USR Hold Descri
     C                     PARM #DAGCS    WQ0031 114       Unit Cost Per P
     C                     PARM #DARCS    WQ0032 114       Unit Cost - Det
     C                     PARM #DLXNM    WQ0033  50       Lot Number
     C                     PARM #DLTNT    WQ0034  50       Lot Number USR
     C           YL0001    PARM *BLANK    WQ0035  1        Inventory Updat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMHEEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993237*
     C                     SETON                     343336*
     C                     SETON                     353139*
     C                     SETON                     3840  *
     C                     END
      * Process return code from called program
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * WI517 DN 09/29/23-Commented Out & Moved Below.
      * WI517 DN 09/29/23-Send Info Msg Based on Inventory was Updated or
      * CASE: LCL.Inventory Updated USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Check WIM Release 1 Flag.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0002    IFEQ 'N'                        *IF
     C           YL0002    OREQ 'P'                        *OR
      * Val Transfer Batch No. RT - IC Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1B4DT    WL0002           Transaction Dat
     C                     Z-ADD#1TRBN    WL0003           Transfer Batch
     C                     EXSR SARVGN
      * Update USR Update Flag which inputs Entry of To Whse if = Yes
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUR4ST           USR Update Flag
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Live with WIM.
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
     C                     END                             *FI
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Last item processed'
     C                     MOVEL'USR0400' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Last item not processed'
     C                     MOVEL'USR0399' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Last item not processed'
     C                     MOVEL'USR0399' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Reset screen for next entry
     C                     Z-ADD*ZERO     #1HGCD           Item Code
     C                     MOVEL*BLANK    #PAVNA           Description Lin
     C                     MOVEL*BLANK    #1HVCD           UOM Transaction
     C                     MOVEL*BLANK    #DDL01           Description. .
     C                     MOVELP4CUNA    #1AUNA           Description
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Production Date
      * External date
     C                     Z-ADDV1ELDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #1ELDT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      *
     C                     MOVEL*BLANK    WN0001  1        UWA Inventory T
     C                     MOVEL*BLANK    WN0002  1        UWA Lot Loc Tra
     C                     MOVEL*BLANK    WN0003  1        UWA Shipping Tr
     C                     MOVEL*BLANK    WN0004  1        UWA Cross Appli
     C                     MOVEL*BLANK    WN0005  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0006  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0007  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0008  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0009  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0010  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0011  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0012  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0013  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0014  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0015  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0016  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0017  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0018  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0019  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0020 10        User Code Model
     C                     MOVEL*BLANK    WN0021  1        Record Found US
      *
      * Val User Whs Access   IF
      * Rtv Profile Model     RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0004    P      User Profile Na
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0020    P      User Code Model
      * Retrieve User Warehouse Access Type
      * CASE: PAR.User Code Model is equal to blank
     C           WN0020    IFEQ *BLANK                     *IF
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0006    P      User Profile Na
     C                     MOVEL#1AJCD    WL0007    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    WN0001    P      UWA Inventory T
     C                     MOVELWL0009    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0010    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0011    WN0004    P      UWA Cross Appli
     C                     MOVELWL0012    WN0005    P      UWA Unused Stat
     C                     MOVELWL0013    WN0006    P      UWA Unused Stat
     C                     MOVELWL0014    WN0007    P      UWA Unused Sts
     C                     MOVELWL0015    WN0008    P      UWA Unused Sts
     C                     MOVELWL0016    WN0009    P      UWA Unused Sts
     C                     MOVELWL0017    WN0010    P      UWA Unused Sts
     C                     MOVELWL0018    WN0011    P      UWA Unused Sts
     C                     MOVELWL0019    WN0012    P      UWA Unused Sts
     C                     MOVELWL0020    WN0013    P      UWA Unused Sts
     C                     MOVELWL0021    WN0014    P      UWA Unused Sts
     C                     MOVELWL0022    WN0015    P      UWA Unused Sts
     C                     MOVELWL0023    WN0016    P      UWA Unused Sts
     C                     MOVELWL0024    WN0017    P      UWA Unused Sts
     C                     MOVELWL0025    WN0018    P      UWA Unused Sts
     C                     MOVELWL0026    WN0019    P      UWA Unused Sts
     C                     MOVELWL0027    WN0021    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0020    WL0006    P      User Profile Na
     C                     MOVEL#1AJCD    WL0007    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    WN0001    P      UWA Inventory T
     C                     MOVELWL0009    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0010    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0011    WN0004    P      UWA Cross Appli
     C                     MOVELWL0012    WN0005    P      UWA Unused Stat
     C                     MOVELWL0013    WN0006    P      UWA Unused Stat
     C                     MOVELWL0014    WN0007    P      UWA Unused Sts
     C                     MOVELWL0015    WN0008    P      UWA Unused Sts
     C                     MOVELWL0016    WN0009    P      UWA Unused Sts
     C                     MOVELWL0017    WN0010    P      UWA Unused Sts
     C                     MOVELWL0018    WN0011    P      UWA Unused Sts
     C                     MOVELWL0019    WN0012    P      UWA Unused Sts
     C                     MOVELWL0020    WN0013    P      UWA Unused Sts
     C                     MOVELWL0021    WN0014    P      UWA Unused Sts
     C                     MOVELWL0022    WN0015    P      UWA Unused Sts
     C                     MOVELWL0023    WN0016    P      UWA Unused Sts
     C                     MOVELWL0024    WN0017    P      UWA Unused Sts
     C                     MOVELWL0025    WN0018    P      UWA Unused Sts
     C                     MOVELWL0026    WN0019    P      UWA Unused Sts
     C                     MOVELWL0027    WN0021    P      Record Found US
     C                     END                             *FI
      * Validate Access
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0021    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0004           User Profile Na
     C                     MOVEL#1AJCD    ZA0005           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Inventory Transactions
      * CASE: PAR.Access Area Needed USR is Inventory Transactions
     C           'I'       IFEQ 'I'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Inventory Trans is *Not Update
     C           WN0001    IFEQ 'N'                        *IF
     C           WN0001    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0022 10        Condition Name
     C                     MOVEL*BLANK    WN0023 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0022    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0023    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0022    ZA0006           Condition Name
     C                     MOVELWN0023    ZA0007           Condition Name
     C                     MOVEL#1AJCD    ZA0008           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Inventory Trans is None
     C           WN0001    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0024 10        Condition Name
     C                     MOVEL*BLANK    WN0025 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0024    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0025    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0024    ZA0009           Condition Name
     C                     MOVELWN0025    ZA0010           Condition Name
     C                     MOVEL#1AJCD    ZA0011           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lot Loc Transactions
      * CASE: PAR.Access Area Needed USR is Lot Loc Transactions
     C           'I'       IFEQ 'L'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is *Not Update
     C           WN0002    IFEQ 'N'                        *IF
     C           WN0002    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0026 10        Condition Name
     C                     MOVEL*BLANK    WN0027 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0026    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0027    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0026    ZA0012           Condition Name
     C                     MOVELWN0027    ZA0013           Condition Name
     C                     MOVEL#1AJCD    ZA0014           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is None
     C           WN0002    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0028 10        Condition Name
     C                     MOVEL*BLANK    WN0029 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0028    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0029    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0028    ZA0015           Condition Name
     C                     MOVELWN0029    ZA0016           Condition Name
     C                     MOVEL#1AJCD    ZA0017           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shipping Transactions
      * CASE: PAR.Access Area Needed USR is Shipping Transactions
     C           'I'       IFEQ 'S'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Shipping Trans is *Not Update
     C           WN0003    IFEQ 'N'                        *IF
     C           WN0003    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0030 10        Condition Name
     C                     MOVEL*BLANK    WN0031 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0030    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0031    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0030    ZA0018           Condition Name
     C                     MOVELWN0031    ZA0019           Condition Name
     C                     MOVEL#1AJCD    ZA0020           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Shipping Trans is None
     C           WN0003    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0032 10        Condition Name
     C                     MOVEL*BLANK    WN0033 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0032    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0033    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0032    ZA0021           Condition Name
     C                     MOVELWN0033    ZA0022           Condition Name
     C                     MOVEL#1AJCD    ZA0023           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cross Applications
      * CASE: PAR.Access Area Needed USR is Cross Applications
     C           'I'       IFEQ 'C'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Unused Sts is *Not Update
     C           WN0004    IFEQ 'N'                        *IF
     C           WN0004    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0034 10        Condition Name
     C                     MOVEL*BLANK    WN0035 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0034    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0035    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0034    ZA0024           Condition Name
     C                     MOVELWN0035    ZA0025           Condition Name
     C                     MOVEL#1AJCD    ZA0026           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Unused Sts is None
     C           WN0004    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0036 10        Condition Name
     C                     MOVEL*BLANK    WN0037 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0036    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0037    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0036    ZA0027           Condition Name
     C                     MOVELWN0037    ZA0028           Condition Name
     C                     MOVEL#1AJCD    ZA0029           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0038  1        UWA Inventory T
     C                     MOVEL*BLANK    WN0039  1        UWA Lot Loc Tra
     C                     MOVEL*BLANK    WN0040  1        UWA Shipping Tr
     C                     MOVEL*BLANK    WN0041  1        UWA Cross Appli
     C                     MOVEL*BLANK    WN0042  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0043  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0044  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0045  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0046  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0047  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0048  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0049  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0050  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0051  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0052  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0053  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0054  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0055  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0056  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0057 10        User Code Model
     C                     MOVEL*BLANK    WN0058  1        Record Found US
      *
      * Val User Whs Access   IF
      * Rtv Profile Model     RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0004    P      User Profile Na
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0057    P      User Code Model
      * Retrieve User Warehouse Access Type
      * CASE: PAR.User Code Model is equal to blank
     C           WN0057    IFEQ *BLANK                     *IF
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0006    P      User Profile Na
     C                     MOVEL#DCPCD    WL0007    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    WN0038    P      UWA Inventory T
     C                     MOVELWL0009    WN0039    P      UWA Lot Loc Tra
     C                     MOVELWL0010    WN0040    P      UWA Shipping Tr
     C                     MOVELWL0011    WN0041    P      UWA Cross Appli
     C                     MOVELWL0012    WN0042    P      UWA Unused Stat
     C                     MOVELWL0013    WN0043    P      UWA Unused Stat
     C                     MOVELWL0014    WN0044    P      UWA Unused Sts
     C                     MOVELWL0015    WN0045    P      UWA Unused Sts
     C                     MOVELWL0016    WN0046    P      UWA Unused Sts
     C                     MOVELWL0017    WN0047    P      UWA Unused Sts
     C                     MOVELWL0018    WN0048    P      UWA Unused Sts
     C                     MOVELWL0019    WN0049    P      UWA Unused Sts
     C                     MOVELWL0020    WN0050    P      UWA Unused Sts
     C                     MOVELWL0021    WN0051    P      UWA Unused Sts
     C                     MOVELWL0022    WN0052    P      UWA Unused Sts
     C                     MOVELWL0023    WN0053    P      UWA Unused Sts
     C                     MOVELWL0024    WN0054    P      UWA Unused Sts
     C                     MOVELWL0025    WN0055    P      UWA Unused Sts
     C                     MOVELWL0026    WN0056    P      UWA Unused Sts
     C                     MOVELWL0027    WN0058    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0057    WL0006    P      User Profile Na
     C                     MOVEL#DCPCD    WL0007    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    WN0038    P      UWA Inventory T
     C                     MOVELWL0009    WN0039    P      UWA Lot Loc Tra
     C                     MOVELWL0010    WN0040    P      UWA Shipping Tr
     C                     MOVELWL0011    WN0041    P      UWA Cross Appli
     C                     MOVELWL0012    WN0042    P      UWA Unused Stat
     C                     MOVELWL0013    WN0043    P      UWA Unused Stat
     C                     MOVELWL0014    WN0044    P      UWA Unused Sts
     C                     MOVELWL0015    WN0045    P      UWA Unused Sts
     C                     MOVELWL0016    WN0046    P      UWA Unused Sts
     C                     MOVELWL0017    WN0047    P      UWA Unused Sts
     C                     MOVELWL0018    WN0048    P      UWA Unused Sts
     C                     MOVELWL0019    WN0049    P      UWA Unused Sts
     C                     MOVELWL0020    WN0050    P      UWA Unused Sts
     C                     MOVELWL0021    WN0051    P      UWA Unused Sts
     C                     MOVELWL0022    WN0052    P      UWA Unused Sts
     C                     MOVELWL0023    WN0053    P      UWA Unused Sts
     C                     MOVELWL0024    WN0054    P      UWA Unused Sts
     C                     MOVELWL0025    WN0055    P      UWA Unused Sts
     C                     MOVELWL0026    WN0056    P      UWA Unused Sts
     C                     MOVELWL0027    WN0058    P      Record Found US
     C                     END                             *FI
      * Validate Access
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0058    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0030           User Profile Na
     C                     MOVEL#DCPCD    ZA0031           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Inventory Transactions
      * CASE: PAR.Access Area Needed USR is Inventory Transactions
     C           'I'       IFEQ 'I'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Inventory Trans is *Not Update
     C           WN0038    IFEQ 'N'                        *IF
     C           WN0038    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0059 10        Condition Name
     C                     MOVEL*BLANK    WN0060 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0059    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0060    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0059    ZA0032           Condition Name
     C                     MOVELWN0060    ZA0033           Condition Name
     C                     MOVEL#DCPCD    ZA0034           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Inventory Trans is None
     C           WN0038    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0061 10        Condition Name
     C                     MOVEL*BLANK    WN0062 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0061    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0062    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0061    ZA0035           Condition Name
     C                     MOVELWN0062    ZA0036           Condition Name
     C                     MOVEL#DCPCD    ZA0037           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lot Loc Transactions
      * CASE: PAR.Access Area Needed USR is Lot Loc Transactions
     C           'I'       IFEQ 'L'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is *Not Update
     C           WN0039    IFEQ 'N'                        *IF
     C           WN0039    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0063 10        Condition Name
     C                     MOVEL*BLANK    WN0064 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0063    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0064    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0063    ZA0038           Condition Name
     C                     MOVELWN0064    ZA0039           Condition Name
     C                     MOVEL#DCPCD    ZA0040           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is None
     C           WN0039    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0065 10        Condition Name
     C                     MOVEL*BLANK    WN0066 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0065    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0066    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0065    ZA0041           Condition Name
     C                     MOVELWN0066    ZA0042           Condition Name
     C                     MOVEL#DCPCD    ZA0043           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shipping Transactions
      * CASE: PAR.Access Area Needed USR is Shipping Transactions
     C           'I'       IFEQ 'S'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Shipping Trans is *Not Update
     C           WN0040    IFEQ 'N'                        *IF
     C           WN0040    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0067 10        Condition Name
     C                     MOVEL*BLANK    WN0068 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0067    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0068    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0067    ZA0044           Condition Name
     C                     MOVELWN0068    ZA0045           Condition Name
     C                     MOVEL#DCPCD    ZA0046           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Shipping Trans is None
     C           WN0040    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0069 10        Condition Name
     C                     MOVEL*BLANK    WN0070 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0069    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0070    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0069    ZA0047           Condition Name
     C                     MOVELWN0070    ZA0048           Condition Name
     C                     MOVEL#DCPCD    ZA0049           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cross Applications
      * CASE: PAR.Access Area Needed USR is Cross Applications
     C           'I'       IFEQ 'C'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Unused Sts is *Not Update
     C           WN0041    IFEQ 'N'                        *IF
     C           WN0041    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0071 10        Condition Name
     C                     MOVEL*BLANK    WN0072 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0071    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0072    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0071    ZA0050           Condition Name
     C                     MOVELWN0072    ZA0051           Condition Name
     C                     MOVEL#DCPCD    ZA0052           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Unused Sts is None
     C           WN0041    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0073 10        Condition Name
     C                     MOVEL*BLANK    WN0074 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0073    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0074    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0073    ZA0053           Condition Name
     C                     MOVELWN0074    ZA0054           Condition Name
     C                     MOVEL#DCPCD    ZA0055           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate fields will check the major relational entries
      * F4 to Select Item or Warehouse or To Warehouse
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Select item
      * CASE: PGM.*Cursor field <IS> DTL.Item Code
     C           W0CFL     IFEQ 'V1HGCD'                   *IF
      * SEL Actv Item by Co    SR - Item  * 
     C                     CALL 'PDL9SRR'              90  SEL Actv Item b
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0036  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0037  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL9SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * Select warehouse
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse Code
     C           W0CFL     IFEQ '#1AJCD'                   *IF
      * SEL Non-Prod Whse      SR - Warehouse  * 
     C                     CALL 'PDL4SRR'              90  SEL Non-Prod Wh
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0038  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL4SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     END                             *FI
      * Select to warehouse
      * CASE: PGM.*Cursor field <IS> DTL.USR Warehouse Code
     C           W0CFL     IFEQ '#DCPCD'                   *IF
      * SEL Non-Prod Whse      SR - Warehouse  * 
     C                     CALL 'PDL4SRR'              90  SEL Non-Prod Wh
     C                     PARM *BLANK    W0RTN   7
     C           #DCPCD    PARM #DCPCD    WQ0039  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL4SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate From warehouse/Carlisle/Plant                 FP1127
      * Rtv Dsc/TrCtl/PFS flgs RT - Warehouse  * 
     C                     EXSR SDRVGN
      * Check return code/Carlisle/Plant and process accordingly  FP1127
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.WHS Live w/Carlisle is Yes
      *   |- c2    : PAR.Trans Contol AS400/Plant is Plant
      *   '-
     C           P1RRSX    IFEQ 'Y'                        *IF
     C           P1XUST    OREQ 'P'                        *OR
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0056           Warehouse Code
      * Send message 'PFS ctrld can't be used'
     C                     MOVEL'USR4098' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SERVGN
      * Check return code and process accordingly
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * If no production date controlled item, date can't be entered
      * CASE: PAR.Production Date Control is no
     C           P2FZST    IFEQ 'N'                        *IF
      * CASE: DTL.Production Date is entered
     C           #1ELDT    IFNE *ZERO                      *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0057
      * Send message 'Prod Date must be blank'
     C                     MOVEL'USR1917' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Production Date is entered
     C           #1ELDT    IFNE *ZERO                      *IF
      * Val Item Balance Dtl   RT - IC Item Balance Detail  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'Item balance detail not f'
     C                     MOVEL'USR0426' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * S13514 DN 08/06/18-Prod Dte must be >= Jan 1 (2yrs ago) & <= Curr
      * CASE: DTL.Production Date is entered
     C           #1ELDT    IFNE *ZERO                      *IF
      * Val Date In Not < 2yrs IF
      * Date In must be >= Jan 1 (2 yrs ago) and <= Current Date.
      * Initialize.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0003           Generic Message
      * Set 'Date In' Text.
      * CASE: PAR.Date In Type USR is Transaction Date
     C           'P'       IFEQ 'T'                        *IF
     C                     MOVEL@CN,003   YL0004           Text USR 15
     C                     ELSE
      * CASE: PAR.Date In Type USR is Production Date
     C           'P'       IFEQ 'P'                        *IF
     C                     MOVEL@CN,004   YL0004           Text USR 15
     C                     ELSE
      * CASE: PAR.Date In Type USR is Label Date
     C           'P'       IFEQ 'L'                        *IF
     C                     MOVEL*BLANK    YL0004           Text USR 15
     C                     MOVEL'Label'   YL0004           Text USR 15
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Get System Date & Set Date 2 Years Back on Jan 1.
      * CASE: *OTHERWISE
      * Rtv System Date *CYMD IF
      * LCL.*System timestamp = JOB.*System timestamp
     C                     EXSR XSTMS
     C                     MOVEL##TMS     YL0006           *System timesta
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0006:ZQ YL0007    P  90  Year USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0006:ZQ YL0008    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0006:ZQ YL0009    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0007    CAT  YL0008:ZQ YL0010    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0010    CAT  YL0009:ZQ YL0010    P      Date (Char-8) U
     C                     MOVE YL0010    YL0011           DATE
      *
     C                     Z-ADD*ZERO     WN0075  40       Year Code
     C                     Z-ADD*ZERO     WN0076  20       Month
     C                     Z-ADD*ZERO     WN0077  20       Day of Month US
     C                     MOVEL*BLANK    WN0078  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0079  2        Month (Char) US
     C                     MOVEL*BLANK    WN0080  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0081  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0082  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0083  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0011    DIV  10000     WN0075           Year Code
     C                     Z-ADDWN0075    WN0081           Year  NBR USR
     C                     MOVELWN0081    WN0082           Year  (Char) US
      * ** MONTH **
     C           YL0011    DIV  100       WN0076           Month
     C                     MOVELWN0076    WN0079           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0011    WN0077           Day of Month US
     C                     MOVELWN0077    WN0080           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0075    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0082:ZQ WN0083    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0082:ZQ WN0083    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0083    CAT  WN0079:ZQ WN0083    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0083    CAT  WN0080:ZQ WN0083    P      Date (Alpha) US
     C                     MOVE WN0083    YL0005           Date
      * LCL.Transaction Date D8# USR = LCL.System Date USR
     C           YL0005    IFEQ *ZERO
     C                     Z-ADD*ZERO     YL0012
     C                     ELSE
     C           YL0005    ADD  19000000  YL0012           Transaction Dat
     C                     END
      * ** YEAR ** (Go Back 2 Years)
     C           YL0012    DIV  10000     YL0013           Year Code
     C                     SUB  2         YL0013           Year Code
     C                     MOVEL*BLANK    YL0014           Year Alpha (YYY
     C                     MOVELYL0013    YL0014           Year Alpha (YYY
     C                     Z-ADDYL0013    YL0015           Year  NBR USR
     C                     MOVELYL0015    YL0016           Year  (Char) US
      * ** MONTH ** (Default to Jan)
     C                     MOVEL'01'      YL0017           Month (Char) US
      * ** DAY ** (Default to 01)
     C                     MOVEL'01'      YL0018           Day   (Char) US
      * ** Convert Date to CYYMMDD Format **
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0014    CAT  YL0017:ZQ YL0019    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0019    CAT  YL0018:ZQ YL0019    P      Date (Char-8) U
      * ** Convert Date to CYYMMDD Format **
      * CENTURY+YEAR
      * CASE: LCL.Year Code is Twentieth Century
     C           YL0013    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  YL0016:ZQ YL0020    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  YL0016:ZQ YL0020    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0020    CAT  YL0017:ZQ YL0020    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0020    CAT  YL0018:ZQ YL0020    P      Date (Alpha) US
     C                     MOVE YL0020    YL0021           Date
      * Send Error Message.
      * CASE: PAR.Date In  (7,0) USR GT LCL.System Date USR
     C           #1ELDT    IFGT YL0005                     *IF
      * Cannot be a future date.
     C                     Z-ADD1         ZQ      50
     C           YL0004    CAT  @CN,006:ZQYL0003    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0003    CAT  'date.':ZQYL0003    P      Generic Message
     C                     ELSE
      * CASE: PAR.Date In  (7,0) USR LT LCL.Date                  USR
     C           #1ELDT    IFLT YL0021                     *IF
      * Cannot be older than last 2 years ago.
     C                     Z-ADD1         ZQ      50
     C           YL0004    CAT  @CN,007:ZQYL0003    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0003    CAT  YL0019:ZQ YL0003    P      Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0003    CAT  '.':ZQ    YL0003    P      Generic Message
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Generic Message 80 USR is Entered
     C           YL0003    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVELYL0003    ZA0058           Generic Message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0059
      * Send message 'Date In Cannot Be < 2yrs'
     C                     MOVEL'USR5086' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Item not found'
     C                     MOVEL'USR0374' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * Rtv Reason Code Desc.  RT - Reason Codes  * 
     C                     EXSR SGRVGN
      * Rtv Status/Default     RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0028           Company Number
     C                     Z-ADD#1HGCD    WL0029           Item Code
     C                     MOVEL#1AJCD    WL0030    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0031    #DAGCS           Unit Cost Per P
     C                     MOVELWL0032    P8J9ST    P      Cost Update Pen
     C                     MOVELWL0033    P8KBST    P      Post GL Status
     C                     Z-ADDWL0034    P8AKC8           Vendor Item_Whs
     C                     MOVELWL0035    P8VSST    P      Record Status
      * Check return code and process accordingly
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send error message if item is not active or has no unit cost
      * CASE: PAR.Record Status is Deleted & Inactive
     C           P8VSST    IFEQ 'D'                        *IF
     C           P8VSST    OREQ 'I'
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0060           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0060           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0061           Warehouse Code
      * Send message 'Item blance is not active'
     C                     MOVEL'USR1918' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993237*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0062           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0062           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0063           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0063           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0064           Warehouse Code
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993237*
      *
     C                     END                             *FI
      * Validate Item balance for to item and to warehouse
      * Rtv Status/Default     RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0028           Company Number
     C                     Z-ADD#1HGCD    WL0029           Item Code
     C                     MOVEL#DCPCD    WL0030    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0031    #DARCS           Unit Cost Per P
     C                     MOVELWL0032    WUG0TX    P      Cost Update Pen
     C                     MOVELWL0033    WUG0TX    P      Post GL Status
     C                     Z-ADDWL0034    WUNFNN           Vendor Item_Whs
     C                     MOVELWL0035    P8VSST    P      Record Status
      * Check return code and process accordingly
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * 07/19/10 PKD E884 Remove Unit Cost validation.
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0065           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0065           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0066           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0066           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#DCPCD    ZA0067           USR Warehouse C
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993239*
      *
     C                     END                             *FI
      * From and to warehouse cannot be equal
      * CASE: DTL.Warehouse Code EQ DTL.USR Warehouse Code
     C           #1AJCD    IFEQ #DCPCD                     *IF
      * Setup message data for message
      * Send message 'Warehouse must differ tr.'
     C                     MOVEL'USR0433' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Item Balance
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993237*
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9933  *
     C                     END
      * Check reference to Reason Codes
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9935  *
     C                     END
      * Check reference to Reference Number Master
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Order Header TRG
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Class
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Group
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Type
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * If unit of measure is not entered then default to the primary
      * CASE: DTL.U/M - Transaction is Not Entered
     C           #1HVCD    IFEQ *BLANK                     *IF
     C                     MOVELP2ADCD    #1HVCD           UOM Transaction
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.U/M - Transaction NE PAR.U/M - Primary
      *   |- c2    : DTL.U/M - Transaction NE PAR.U/M - Second
      *   |- c3    : DTL.U/M - Transaction NE PAR.U/M - Third
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HVCD    IFNE P2ADCD                     *IF
     C           #1HVCD    IFNE P2AECD                     *IF
     C           #1HVCD    IFNE P2AFCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELP2ADCD    ZA0068           UOM Primary
     C                     MOVELP2AECD    ZA0069           UOM Second
     C                     MOVELP2AFCD    ZA0070           UOM Third
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0071           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0071           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'UOM not on item'
     C                     MOVEL'USR1955' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993332*
      *
     C                     END                             *FI
     C                     END                             *FI
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR SIRVGN
      * If the company number has changed issue error
      * CASE: PAR.Accounting Company Number NE DTL.Accounting Company Num
     C           P2AIC3    IFNE #1AIC3                     *IF
      * Send message 'Company must match GEN'
     C                     MOVEL'USR0916' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Fill in shift number
      * CASE: DTL.Shift Number EQ WRK.BLANK
     C           #1XLCD    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       #1XLCD           Shift Number
     C                     END                             *FI
     C                     END
      * Shift Number required
     C           #1XLCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Item Code required
     C           #1HGCD    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Warehouse Code required
     C           #1AJCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           WUR4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1DXNB           Sequence Number
     C                     MOVEL*BLANK    #1BJNA           Ticket Number
     C                     MOVEL*BLANK    #1F1ST           Item Transactio
     C                     MOVELP3BSST    #1BSST           Inventory Trans
     C                     Z-ADD*ZERO     #1C4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     #1K7DT           Label Date
     C                     Z-ADD*ZERO     #1A5QT           Transaction Qua
     C                     Z-ADD*ZERO     #1AHWG           Transaction Wei
     C                     Z-ADD*ZERO     #1AKCS           USR Transaction
     C                     MOVEL*BLANK    #1DTCD           Reference Numbe
     C                     MOVEL*BLANK    #1MGNA           Lot ID
     C                     Z-ADD*ZERO     #1TRBS           Transfer Batch
     C                     Z-ADD*ZERO     #1C4NB           Order Number
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     MOVEL*BLANK    #1M3NA           Employee Badge
     C                     Z-ADD*ZERO     #1AWTM           Production Time
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVELP3W9ST    #1W9ST           Inventory Trans
     C                     MOVEL*BLANK    #1CGCD           UOM Cost
     C                     MOVEL*BLANK    #1BMST           GL Update Statu
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1TRBN           Transfer Batch
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELP5ADTX    #PADTX           Name
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVELP4CUNA    #PCUNA           USR Hold Descri
     C                     Z-ADDP3B4DT    #1B4DT           Transaction Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1B4DT
     C                     MOVEL*BLANK    #1XLCD           Shift Number
     C                     Z-ADD*ZERO     #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVELP2AVNA    #PAVNA           Description Lin
     C                     MOVEL*BLANK    #1HVCD           UOM Transaction
     C                     MOVEL*BLANK    #DDL01           Description. .
     C                     Z-ADD*ZERO     #1ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1ELDT
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #DM1NA           Reason Descript
     C                     MOVEL*BLANK    #1AUNA           Description
     C                     MOVELP1AJCD    #1AJCD           Warehouse Code
     C                     MOVELP1F8NA    #PF8NA           Warehouse Descr
     C                     Z-ADD*ZERO     #DAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     #DLXNM           Lot Number
     C                     MOVEL*BLANK    #DCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #DCCNA           USR Warehouse d
     C                     Z-ADD*ZERO     #DARCS           Unit Cost - Det
     C                     Z-ADD*ZERO     #DLTNT           Lot Number USR
      * USER: Load screen
      * DTL.Condition Desc. 1  USR = Condition name of PAR.Inventory Tran
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1304090   Y2LSNO  70       List number
     C                     PARM P3W9ST    W0INVL 25        Inventory Trans
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     MOVELP4CUNA    #1AUNA           Description
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SJRVGN
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SKRVGN
      * Get batch control #
      * CASE: DTL.Transfer Batch Number is Not entered
     C           #1TRBN    IFEQ *ZERO                      *IF
      * Rtv Next Tran Batch #  CH - Company Control  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     MOVEL'1'       #1XLCD           Shift Number
      * *Set Cursor: DTL.Item Code  (*Override=*YES)
     C                     Z-ADD011       W0ROW0
     C                     Z-ADD028       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Transaction Date Code to display format
      * Convert date
     C           1000000   ADD  #1B4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B4DT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1ELDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Val Transfer Batch No. RT - IC Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAB4DT    WQSA02           Transaction Dat
     C           *LIKE     DEFN WATRBN    WQSA03           Transfer Batch
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Transaction Dat
     C                     KFLD           WQSA03           Transfer Batch
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
     C                     Z-ADDWL0002    WQSA02           Transaction Dat
     C                     Z-ADDWL0003    WQSA03           Transfer Batch
      * Establish starting position
     C           KRSSA     SETLL@B7CPH4                    *
     C           KRSSA     READE@B7CPH4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@B7CPH4                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0004    WBAJVN           User Profile Na
      * Establish starting position
     C           KRSSB     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           User Code Model
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBUVN    WL0005           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJVN           User Profile Na
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0006    WCAJVN           User Profile Na
     C                     MOVELWL0007    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@L1RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2626' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           UWA Inventory T
     C                     MOVEL*BLANK    WL0009           UWA Lot Loc Tra
     C                     MOVEL*BLANK    WL0010           UWA Shipping Tr
     C                     MOVEL*BLANK    WL0011           UWA Cross Appli
     C                     MOVEL*BLANK    WL0012           UWA Unused Stat
     C                     MOVEL*BLANK    WL0013           UWA Unused Stat
     C                     MOVEL*BLANK    WL0014           UWA Unused Sts
     C                     MOVEL*BLANK    WL0015           UWA Unused Sts
     C                     MOVEL*BLANK    WL0016           UWA Unused Sts
     C                     MOVEL*BLANK    WL0017           UWA Unused Sts
     C                     MOVEL*BLANK    WL0018           UWA Unused Sts
     C                     MOVEL*BLANK    WL0019           UWA Unused Sts
     C                     MOVEL*BLANK    WL0020           UWA Unused Sts
     C                     MOVEL*BLANK    WL0021           UWA Unused Sts
     C                     MOVEL*BLANK    WL0022           UWA Unused Sts
     C                     MOVEL*BLANK    WL0023           UWA Unused Sts
     C                     MOVEL*BLANK    WL0024           UWA Unused Sts
     C                     MOVEL*BLANK    WL0025           UWA Unused Sts
     C                     MOVEL*BLANK    WL0026           UWA Unused Sts
     C                     MOVEL*BLANK    WL0027           Record Found US
     C                     MOVEL'N'       WL0027           Record Found US
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCUWAS    WL0008           UWA Inventory T
     C                     MOVELWCEPSX    WL0009           UWA Lot Loc Tra
     C                     MOVELWCEQSX    WL0010           UWA Shipping Tr
     C                     MOVELWCERSX    WL0011           UWA Cross Appli
     C                     MOVELWCUWAT    WL0012           UWA Unused Stat
     C                     MOVELWCEKSX    WL0013           UWA Unused Stat
     C                     MOVELWCECSX    WL0014           UWA Unused Sts
     C                     MOVELWCEDSX    WL0015           UWA Unused Sts
     C                     MOVELWCEESX    WL0016           UWA Unused Sts
     C                     MOVELWCEFSX    WL0017           UWA Unused Sts
     C                     MOVELWCEGSX    WL0018           UWA Unused Sts
     C                     MOVELWCEHSX    WL0019           UWA Unused Sts
     C                     MOVELWCEISX    WL0020           UWA Unused Sts
     C                     MOVELWCEJSX    WL0021           UWA Unused Sts
     C                     MOVELWCUWAU    WL0022           UWA Unused Sts
     C                     MOVELWCELSX    WL0023           UWA Unused Sts
     C                     MOVELWCEMSX    WL0024           UWA Unused Sts
     C                     MOVELWCENSX    WL0025           UWA Unused Sts
     C                     MOVELWCEOSX    WL0026           UWA Unused Sts
     C                     MOVEL'Y'       WL0027           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Dsc/TrCtl/PFS flgs RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PF8NA           Warehouse Descr
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1RRSX           WHS Live with C
     C                     MOVEL*BLANK    P1RSSX           WHS PFS Interfa
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDF8NA    #PF8NA           Warehouse Descr
     C                     MOVELWDXUST    P1XUST           Trans Contol AS
     C                     MOVELWDRRSX    P1RRSX           WHS Live with C
     C                     MOVELWDRSSX    P1RSSX           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1HGCD    WEHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PAVNA           Description Lin
     C                     MOVEL*BLANK    P2AWNA           Description Lin
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAVNA    #PAVNA           Description Lin
     C                     MOVELWEAWNA    P2AWNA           Description Lin
     C                     MOVELWEADCD    P2ADCD           UOM Primary
     C                     Z-ADDWEAWPC    P2AWPC           Conversion Fact
     C                     MOVELWELXST    P2LXST           Operation Facto
     C                     MOVELWEAECD    P2AECD           UOM Second
     C                     Z-ADDWEAXPC    P2AXPC           Conversion Fact
     C                     MOVELWELYST    P2LYST           Operation Facto
     C                     MOVELWEAFCD    P2AFCD           UOM Third
     C                     MOVELWEAICD    P2AICD           UOM Pricing
     C                     Z-ADDWEAIWG    P2AIWG           Unit Weight
     C                     MOVELWEFZST    P2FZST           Production Date
     C                     MOVELWEAVST    P2AVST           Catch Weight St
     C                     Z-ADDWECHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Item Balance Dtl   RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
      * Setup key
     C                     Z-ADD#1AIC3    WFAIC3           Company Number
     C                     Z-ADD#1HGCD    WFHGCD           Item Code
     C                     MOVEL#1AJCD    WFAJCD           Warehouse Code
     C                     Z-ADD#1ELDT    WFELDT           Production Date
      * Establish starting position
     C           KRSSF     CHAINCAB1RL4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Reason Code Desc.  RT - Reason Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    WGCQCD           Reason Code
      * Establish starting position
     C           KRSSG     CHAIN@EFREV2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0858' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    #DM1NA           Description
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAUNA    #DM1NA           Description
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Status/Default     RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0028    WHAIC3           Company Number
     C                     Z-ADDWL0029    WHHGCD           Item Code
     C                     MOVELWL0030    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0031           Unit Cost Per P
     C                     MOVEL*BLANK    WL0032           Cost Update Pen
     C                     MOVEL*BLANK    WL0033           Post GL Status
     C                     Z-ADD*ZERO     WL0034           Vendor Item_Whs
     C                     MOVEL*BLANK    WL0035           Record Status
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHAGCS    WL0031           Unit Cost Per P
     C                     MOVELWHJ9ST    WL0032           Cost Update Pen
     C                     MOVELWHKBST    WL0033           Post GL Status
     C                     Z-ADDWHAKC8    WL0034           Vendor Item_Whs
     C                     MOVELWHVSST    WL0035           Record Status
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WSHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1HVCD    WSHHCD           UOM Primary Dft
      * Establish starting position
     C           KRSSI     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDL01           Description
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWSAUNA    #DDL01           Description
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WTAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WTAIC3           Company Number
      * Establish starting position
     C           KRSSJ     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PADTX           Name
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTADTX    #PADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WVAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    WVAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #PF8NA           Warehouse Descr
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWVF8NA    #PF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Rtv Next Tran Batch #  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0084  40       Current Account
     C                     Z-ADD*ZERO     WN0085  20       Current Account
     C                     Z-ADD*ZERO     WN0086  30       OM Week
     C                     Z-ADD*ZERO     WN0087  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0088  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0089  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0090  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN0091  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0092  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0093  70       Next Customer #
     C                     Z-ADD*ZERO     WN0094  70       Next Inventory
     C                     Z-ADD*ZERO     WN0095  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0096  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0097  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0098  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0099  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0100  1        Auto Customers
     C                     MOVEL*BLANK    WN0101  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0102  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0103  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0104 112       Late Charge Min
     C                     MOVEL*BLANK    WN0105  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0106  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0107  1        Allocate Credit
     C                     MOVEL*BLANK    WN0108 30        Message Line 1
     C                     MOVEL*BLANK    WN0109 30        Message Line 2
     C                     MOVEL*BLANK    WN0110 30        Message Line 3
     C                     MOVEL*BLANK    WN0111 30        Message Line 4
     C                     MOVEL*BLANK    WN0112  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0113  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0114  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0115  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0116  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0117  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0118  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0119  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0120  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0121  30       Retention Perio
     C                     Z-ADD*ZERO     WN0122  30       Retention Perio
     C                     Z-ADD*ZERO     WN0123  30       Retention Perio
     C                     Z-ADD*ZERO     WN0124  30       Retention Perio
     C                     Z-ADD*ZERO     WN0125  30       Retention Perio
     C                     Z-ADD*ZERO     WN0126  70       Next Load ID
     C                     MOVEL*BLANK    WN0127  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0128  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0129  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0130  30       Production Numb
     C                     MOVEL*BLANK    WN0131  1        Freight by Poun
     C                     MOVEL*BLANK    WN0132  1        Price Audit Act
     C                     MOVEL*BLANK    WN0133 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0134  1        EDI Status 1
     C                     MOVEL*BLANK    WN0135  1        EDI Status 2
     C                     MOVEL*BLANK    WN0136  1        EDI Status 3
     C                     MOVEL*BLANK    WN0137  1        Record Status
     C                     Z-ADD*ZERO     WN0138  60       Job Time
     C                     MOVEL*BLANK    WN0139 10        User Id
     C                     MOVEL*BLANK    WN0140 10        Job Name
     C                     Z-ADD*ZERO     WN0141  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADDP2AIC3    WWAIC3           Company Number
      *
     C           KLCHSL    KLIST
     C                     KFLD           WWAIC3           Company Number
     C           KLCHSL    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YARDCS
      * USER: Processing after Data read
     C                     MOVEL'Y'       YARDC            *Record Data Ch
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADDWWBANB    #1TRBN           Transfer Batch
     C                     ADD  1         WWBANB           Next HPB Batch
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WWAATM           Job Time
     C                     MOVEL##USR     WWAYNA           User Id
     C                     MOVEL##JOB     WWA0NA           Job Name
     C                     Z-ADD##JDT     WWAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXDNCD    WQSM01           Application Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSM01           Application Cod
     C                     MOVEL'I/C'     WQSM01           Application Cod
      * Establish starting position
     C           KRSSM     SETLL@DNRESF                    *
     C           KRSSM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WXRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWXAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     C           KRSSM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXDNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVELWXRSCD    WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWXAUNA    WUAUNA           Description
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Module Release
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WYB3AB           Module ID
     C                     KFLD           WYHUNZ           Release Number
      * Setup key
     C                     MOVEL'WIM'     WYB3AB           Module ID
     C                     Z-ADD1         WYHUNZ           Release Number
      * Establish starting position
     C           KRSSO     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WYVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWYOCSC    YL0002           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Item Balance
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1HGCD    WK1X02  1
     C                     MOVEL#1AJCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     C           WK1X03    OREQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1HGCD' defaulted for 'Item Code'.
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     MOVEL#1AJCD    PAAJCD    P      Warehouse Code
     C                     Z-ADD#1HGCD    PAHGCD           Item Code
      *
     C                     CALL 'PNMPSRR'              90  Sel Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Item Balan
      *
     C                     Z-ADDPAHGCD    #1HGCD           Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993732*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAWH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     Z-ADD#1AIC3    WHAIC3
     C                     Z-ADD#1HGCD    WHHGCD
     C                     MOVEL#1AJCD    WHAJCD
     C           KLVAWH    CHAIN@B0REJX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0328' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HVCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1HVCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HVCD' defaulted for 'UOM Transaction'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1HVCD    PARM #1HVCD    WQ0040  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9933  *
     C                     END
      *
     C           #1HVCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HVCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWI    KLIST
     C                     KFLD           WIHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1HVCD    WIHHCD
     C           KLVBWI    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                     CALL 'CAMWSRR'              90  SEL Active Reas
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0041  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAMWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9935  *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWJ    KLIST
     C                     KFLD           WJCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    WJCQCD
     C           KLVCWJ    CHAIN@EFREU4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Reason Codes           NF'
     C                     MOVEL'USR0858' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0858' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Reference Number Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1DTCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Reference Numbe
     C           YPMTFD    OREQ '#1DTCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1DTCD' defaulted for 'Reference Number Code'.
     C                     CALL 'PDE1SRR'              90  SEL Reference N
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0042  30       Company Number
     C           #1DTCD    PARM #1DTCD    WQ0043 15        Reference Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1DTCD    IFNE *BLANK                     Reference Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DTCD    IFEQ *BLANK                     Reference Numbe
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWK    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKDTCD           Reference Numbe
      * Setup key
     C                     Z-ADD#1AIC3    WKAIC3
     C                     MOVEL#1DTCD    WKDTCD
     C           KLVDWK    CHAIN@DVREWC              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Reference Number Maste NF'
     C                     MOVEL'USR0771' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0771' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0044  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0045  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C4NB    IFEQ *ZERO                      Order Number
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWL    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WLAIC3
     C                     Z-ADD#1C4NB    WLC4NB
     C           KLVEWL    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Class
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RINB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RINB' defaulted for 'Item Structure Class Code'.
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #1RINB    PARM #1RINB    WQ0046  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RINB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RINB    IFEQ *ZERO                      Item Structure
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWM    KLIST
     C                     KFLD           WMRINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    WMRINB
     C           KLVFWM    CHAIN@FAREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Item Structure Class   NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1170' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0047  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWO    KLIST
     C                     KFLD           WORHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    WORHNB
     C           KLVGWO    CHAIN@E9REA8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0048  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHWR    KLIST
     C                     KFLD           WRRGNB           Item Structure
      * Setup key
     C                     Z-ADD#1RGNB    WRRGNB
     C           KLVHWR    CHAIN@E8REBB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XSTMS     BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                     CALL 'Y2RTTSK'
     C                     PARM           ##TMS  26        System timestam
      *================================================================
     CSR         XSTMSE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1HGCD'  YPMTFD           Item Code
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1HVCD'  YPMTFD           UOM Transaction
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1CQCD'  YPMTFD           Reason Code
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1AJCD'  YPMTFD           Warehouse Code
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'OMHDPVRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: WRK.USR Update Flag is Yes
     C           WUR4ST    IFEQ 'Y'                        *IF
      * WI517 DN 09/29/23-Commented Out & Moved Below.
      * WI517 DN 09/29/23-Check WIM Release 1 Flag.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0002    IFEQ 'N'                        *IF
     C           YL0002    OREQ 'P'                        *OR
      * Prt Transfer B.O.L     UP - IC Transaction Detail  * 
     C                     CALL 'OMBLLCLP'             90  Prt Transfer B.
     C                     PARM #1AIC3    WQ0049  30       Company Number
     C                     PARM 'G'       WQ0050  1        USR RTYPE
     C                     PARM #1HGCD    WQ0051  70       Item Code
     C                     PARM #1AJCD    WQ0052  3        Warehouse Code
     C                     PARM #1B4DT    WQ0053  70       Transaction Dat
     C                     PARM #1TRBN    WQ0054  70       Transfer Batch
     C                     PARM #DCPCD    WQ0055  3        USR Warehouse C
     C                     PARM *BLANK    WQ0056  1        Printed Status
     C           P7N7CD    PARM *BLANK    WQ0057  1        USR Return Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMBLLCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993237*
     C                     SETON                     39    *
     C                     END
      * CASE: PAR.USR Return Code is Returned
     C           P7N7CD    IFEQ 'R'                        *IF
     C                     MOVEL'N'       P6C1ST           Printed Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P6C1ST           Printed Status
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Live with WIM.
      * ***9/29/23-DN-We will NEED to revisit this function before we go
      *   Live with WIM Rls1=Y, to build new prtfil for BOL report
      *   against the WIM Item Trans Detail table!!!
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1F8NA           Warehouse Descr
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1RRSX           WHS Live with C
     C                     MOVEL*BLANK    P1RSSX           WHS PFS Interfa
     C                     MOVEL*BLANK    P2AVNA           Description Lin
     C                     MOVEL*BLANK    P2AWNA           Description Lin
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     MOVEL*BLANK    P3BMST           GL Update Statu
     C                     MOVEL*BLANK    P7N7CD           USR Return Code
     C                     Z-ADD*ZERO     P8CBPR           Revaluation Cos
     C                     MOVEL*BLANK    P8J9ST           Cost Update Pen
     C                     MOVEL*BLANK    P8KBST           Post GL Status
     C                     Z-ADD*ZERO     P8AKC8           Vendor Item_Whs
     C                     MOVEL*BLANK    P8VSST           Record Status
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WAC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WAAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WAAKCS           USR Transaction
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WACKNB           GL Document Num
     C                     Z-ADD*ZERO     WATRBN           Transfer Batch
     C                     Z-ADD*ZERO     WATRBS           Transfer Batch
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAWTM           Production Time
     C                     Z-ADD*ZERO     WAK7DT           Label Date
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBNLNB           Entity Number
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFELDT           Production Date
     C                     Z-ADD*ZERO     WFABWG           Physical Count
     C                     Z-ADD*ZERO     WFAGQT           Physical Count
     C                     Z-ADD*ZERO     WFAHQT           Physical Count
     C                     Z-ADD*ZERO     WFAIQT           Physical Count
     C                     Z-ADD*ZERO     WFACWG           Quantity on Han
     C                     Z-ADD*ZERO     WFARQT           Quantity on Han
     C                     Z-ADD*ZERO     WFASQT           Quantity on Han
     C                     Z-ADD*ZERO     WFATQT           Quantity on Han
     C                     Z-ADD*ZERO     WFHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WFHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WFBMWG           Physical Start
     C                     Z-ADD*ZERO     WFDSQT           Physical Start
     C                     Z-ADD*ZERO     WFDTQT           Physical Start
     C                     Z-ADD*ZERO     WFDUQT           Physical Start
     C                     Z-ADD*ZERO     WFDHDT           Physical Start
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAECS           Last Cost
     C                     Z-ADD*ZERO     WFIDVA           Value of On Han
     C                     Z-ADD*ZERO     WFK7DT           Label Date
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,005   XDTSDL
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAECS           Last Cost
     C                     Z-ADD*ZERO     WHBACS           Cost per Primar
     C                     Z-ADD*ZERO     WHBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WHCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WHGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WHCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WHG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WHBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WHDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WHDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WHDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WHHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WHHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WHAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WHAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WHAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WHEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WHDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WHAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WHANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     Z-ADD*ZERO     WHBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WHDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WHDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WHBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WHDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WHBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WHDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WHDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WHBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WHDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WHDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WHDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WHDMDT           Last Physical C
     C                     Z-ADD*ZERO     WHAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLANC7           AR Customer Num
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WLA0DT           Order Date
     C                     Z-ADD*ZERO     WLA5DT           Requested Ship
     C                     Z-ADD*ZERO     WLGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WLACDT           Cancel Date
     C                     Z-ADD*ZERO     WLAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WLCXDT           Date of Origina
     C                     Z-ADD*ZERO     WLJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WLA1WG           Order Weight To
     C                     Z-ADD*ZERO     WLEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WLAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
     C                     Z-ADD*ZERO     WLRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WLATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WLRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WLT3NB           Attach to Order
     C                     Z-ADD*ZERO     WLCONB           Invoice Number
     C                     Z-ADD*ZERO     WLAWDT           Invoice Date
     C                     Z-ADD*ZERO     WLVRVA           A/R order Value
     C                     Z-ADD*ZERO     WLB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WLNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WLNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WLNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WLNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WLNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WLBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WLBQTM           Time of Origina
     C                     Z-ADD*ZERO     WLBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WLBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WLBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WLH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WLH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WLH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WLH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WLH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WLC0C7           Claim Number
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WORHNB           Item Structure
     C                     Z-ADD*ZERO     WORGNB           Item Structure
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRRGNB           Item Structure
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWAXNB           Current Account
     C                     Z-ADD*ZERO     WWNGNB           Current Account
     C                     Z-ADD*ZERO     WWBZNB           OM Week
     C                     Z-ADD*ZERO     WWC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WWC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WWCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WWIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WWI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WWDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WWC7NB           Next Customer #
     C                     Z-ADD*ZERO     WWC2NB           Next Inventory
     C                     Z-ADD*ZERO     WWC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WWL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WWBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WWAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WWASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WWA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WWAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WWABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WWACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WWADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WWAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WWAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WWAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WWAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WWAENB           Retention Perio
     C                     Z-ADD*ZERO     WWALNB           Retention Perio
     C                     Z-ADD*ZERO     WWEVNB           Retention Perio
     C                     Z-ADD*ZERO     WWRPOP           Retention Perio
     C                     Z-ADD*ZERO     WWDWNB           Retention Perio
     C                     Z-ADD*ZERO     WWR3NB           Next Load ID
     C                     Z-ADD*ZERO     WWR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WWSCNB           Production Numb
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYHUNZ           Release Number
     C                     MOVELXDTSDL    WYBGTS           Create Date Tim
     C                     MOVELXDTSDL    WYBHTS           Update Date Tim
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0004 10
     C                     MOVEL*BLANK    WL0005 10
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0006 10
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  2
     C                     MOVEL*BLANK    WL0025  2
     C                     MOVEL*BLANK    WL0026  2
     C                     MOVEL*BLANK    WL0027  1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030  3
     C                     Z-ADD*ZERO     WL0031 114
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  80
     C                     MOVEL*BLANK    WL0035  1
      * Define local work field Inventory Updated USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0003 80
      * Define local work field Text USR 15
     C                     MOVEL*BLANK    YL0004 15
      * Define local work field System Date USR
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field *System timestamp
     C                     MOVELXDTSDL    YL0006 26
      * Define local work field Year USR
     C                     MOVEL*BLANK    YL0007  4
      * Define local work field Month USR
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Day USR
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0010  8
      * Define local work field DATE
     C                     Z-ADD*ZERO     YL0011  80
      * Define local work field Transaction Date D8# USR
     C                     Z-ADD*ZERO     YL0012  80
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0013  40
      * Define local work field Year Alpha (YYYY) USR
     C                     MOVEL*BLANK    YL0014  4
      * Define local work field Year  NBR USR
     C                     Z-ADD*ZERO     YL0015  20
      * Define local work field Year  (Char) USR
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Month (Char) USR
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Day   (Char) USR
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0019  8
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0020  7
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0021  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * WI517 DN 09/29/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                     EXSR SORVGN
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01052013080131301820020760233202588
02844028540310003110033560361203622
03868041240413404380046360514805154
0540405660
** W0END
01058013100134201844021050233902588
02850028830310103139033630361403651
03897041260416304391046400515005183
0541505664
** W0NAM
#1TRBN    V1AIC3    #PADTX    #DHLTX    #PCUNA    V1B4DT    #1XLCD
V1HGCD    #PAVNA    #1HVCD    #DDL01    V1ELDT    #1CQCD    #DM1NA
#1AUNA    #1AJCD    #PF8NA    #DAGCS    #DLXNM    #DCPCD    #DCCNA
#DARCS    #DLTNT
** @CN
00001 USR0752
00002 Y2U0005
00003 Transaction
00004 Production
00005 0001-01-01-00.00.00.00000
00006 Date cannot be a future
00007 Date cannot be prior to
