     H/TITLE Bld Producer Dist WRK XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:40:05
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKACREL2IF  E           K        DISK
      * RTV : Producer                  Active Producers
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKAXCPLIIF  E           K        DISK
      * RSQ : Buy Order Load            Co/Prd/KillDt/DlvDt/DlvT
      *
     FPVCRREL1IF  E           K        DISK
      * RTV : Producer Distribution Ent Retrieval index
      *
     FPKAFREL3IF  E           K        DISK
      * RSQ : Producer Location         Active Prdcr Locations
      *
     FPKAXCPLEIF  E           K        DISK
      * RSQ : Buy Order Load            Co/Prd/Lc/KlD
      *
     FPWALREL1IF  E           K        DISK
      * RTV : Producer Loc Distrib Ent  Retrieval index
      *
     FPWABCPL0IF  E           K        DISK                      A
      * UPD : Producer Distribution Wrk Update index
      *
     FPWAMCPL0IF  E           K        DISK                      A
      * UPD : Producer Loc Distrib Wrk  Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@ACREG3
      * Producer                  Active Producers
      * Renamed input format fields
     I              ACABCD                          WAABCD
     I              ACAGTX                          WAAGTX
     I              ACALNB                          WAALNB
     I              ACAATH                          WAAATH
     I              ACAMNB                          WAAMNB
     I              ACIWST                          WAIWST
     I              ACAPST                          WAAPST
     I              ACGCNB                          WAGCNB
     I              ACGJNB                          WAGJNB
     I              ACC2TX                          WAC2TX
     I              ACAACD                          WAAACD
     I              ACACCD                          WAACCD
     I              ACADCD                          WAADCD
     I              ACAAVN                          WAAAVN
     I              ACAADT                          WAAADT
     I              ACAMTM                          WAAMTM
     I              ACAJST                          WAAJST
     I              ACAHVN                          WAAHVN
     I              ACAGVN                          WAAGVN
     I              ACABVN                          WAABVN
     I              ACABDT                          WAABDT
     I              ACABTM                          WAABTM
      *
     I@AAREAC
      * Source                    Retrieval index
      * Renamed input format fields
     I              AAAACD                          WBAACD
     I              AAAFTX                          WBAFTX
     I              AAIXST                          WBIXST
     I              AACYSS                          WBCYSS
     I              AACZSS                          WBCZSS
     I              AAC0SS                          WBC0SS
     I              AAC1SS                          WBC1SS
     I              AAAAVN                          WBAAVN
     I              AAAADT                          WBAADT
     I              AAAMTM                          WBAMTM
     I              AAAJST                          WBAJST
     I              AAAHVN                          WBAHVN
     I              AAAGVN                          WBAGVN
     I              AAABVN                          WBABVN
     I              AAABDT                          WBABDT
     I              AAABTM                          WBABTM
      *
     I@AXCPWV
      * Buy Order Load            Co/Prd/KillDt/DlvDt/DlvT
      * Renamed input format fields
     I              AXHMNB                          WCHMNB
     I              AXBNNB                          WCBNNB
     I              AXBONB                          WCBONB
     I              AXCQDT                          WCCQDT
     I              AXABTH                          WCABTH
     I              AXACTH                          WCACTH
     I              AXBPNB                          WCBPNB
     I              AXCSNB                          WCCSNB
     I              AXAUDT                          WCAUDT
     I              AXCMST                          WCCMST
     I              AXAGPR                          WCAGPR
     I              AXATVA                          WCATVA
     I              AXI1ST                          WCI1ST
     I              AXDHNB                          WCDHNB
     I              AXDINB                          WCDINB
     I              AXCNST                          WCCNST
     I              AXGINB                          WCGINB
     I              AXBZDT                          WCBZDT
     I              AXLSNB                          WCLSNB
     I              AXF3TX                          WCF3TX
     I              AXO8ST                          WCO8ST
     I              AXO9ST                          WCO9ST
     I              AXPAST                          WCPAST
     I              AXLDSH                          WCLDSH
     I              AXPBST                          WCPBST
     I              AXPCST                          WCPCST
     I              AXPDST                          WCPDST
     I              AXUWST                          WCUWST
     I              AXUXST                          WCUXST
     I              AXUYST                          WCUYST
     I              AXJKRU                          WCJKRU
     I              AXKEOR                          WCKEOR
     I              AXIOEW                          WCIOEW
     I              AXKJIO                          WCKJIO
     I              AXIOJR                          WCIOJR
     I              AXEIRR                          WCEIRR
     I              AXITMF                          WCITMF
     I              AXODJE                          WCODJE
     I              AXRJIF                          WCRJIF
     I              AXOEJF                          WCOEJF
     I              AXD0DT                          WCD0DT
     I              AXD1DT                          WCD1DT
     I              AXD2DT                          WCD2DT
     I              AXD3DT                          WCD3DT
     I              AXD4DT                          WCD4DT
     I              AXBNCD                          WCBNCD
     I              AXABCD                          WCABCD
     I              AXAECD                          WCAECD
     I              AXAAVN                          WCAAVN
     I              AXAADT                          WCAADT
     I              AXAMTM                          WCAMTM
     I              AXAJST                          WCAJST
     I              AXAHVN                          WCAHVN
     I              AXAGVN                          WCAGVN
     I              AXABVN                          WCABVN
     I              AXABDT                          WCABDT
     I              AXABTM                          WCABTM
      *
     I@CRREWR
      * Producer Distribution Ent Retrieval index
      * Renamed input format fields
     I              CRABCD                          WDABCD
     I              CRR2CD                          WDR2CD
     I              CRYSA1                          WDYSA1
     I              CRCMT1                          WDCMT1
     I              CRHYSS                          WDHYSS
     I              CRCLT1                          WDCLT1
     I              CRAAVN                          WDAAVN
     I              CRAADT                          WDAADT
     I              CRAMTM                          WDAMTM
     I              CRAJST                          WDAJST
     I              CRAHVN                          WDAHVN
     I              CRAGVN                          WDAGVN
     I              CRABVN                          WDABVN
     I              CRABDT                          WDABDT
     I              CRABTM                          WDABTM
      *
     I@ABCPW1
      * Producer Distribution Wrk Update index
      * Renamed input format fields
     I              ABYUA1                          WEYUA1
     I              ABR7CD                          WER7CD
     I              ABC2T1                          WEC2T1
     I              ABHNDT                          WEHNDT
     I              ABHQDT                          WEHQDT
      *
     I@AFRELR
      * Producer Location         Active Prdcr Locations
      * Renamed input format fields
     I              AFABCD                          WFABCD
     I              AFAECD                          WFAECD
     I              AFA8TX                          WFA8TX
     I              AFGLNB                          WFGLNB
     I              AFATST                          WFATST
     I              AFASNB                          WFASNB
     I              AFAUST                          WFAUST
     I              AFQNST                          WFQNST
     I              AFQOST                          WFQOST
     I              AFQPST                          WFQPST
     I              AFQQST                          WFQQST
     I              AFQRST                          WFQRST
     I              AFN0TX                          WFN0TX
     I              AFQSST                          WFQSST
     I              AFQTST                          WFQTST
     I              AFQUST                          WFQUST
     I              AFQVST                          WFQVST
     I              AFR8ST                          WFR8ST
     I              AFR9ST                          WFR9ST
     I              AFSAST                          WFSAST
     I              AFSBST                          WFSBST
     I              AFSDST                          WFSDST
     I              AFSEST                          WFSEST
     I              AFSFST                          WFSFST
     I              AFHWNB                          WFHWNB
     I              AFFUCD                          WFFUCD
     I              AFAAVN                          WFAAVN
     I              AFAADT                          WFAADT
     I              AFAMTM                          WFAMTM
     I              AFAJST                          WFAJST
     I              AFAHVN                          WFAHVN
     I              AFAGVN                          WFAGVN
     I              AFABVN                          WFABVN
     I              AFABDT                          WFABDT
     I              AFABTM                          WFABTM
      *
     I@AXCPJ2
      * Buy Order Load            Co/Prd/Lc/KlD
      * Renamed input format fields
     I              AXHMNB                          WGHMNB
     I              AXBNNB                          WGBNNB
     I              AXBONB                          WGBONB
     I              AXCQDT                          WGCQDT
     I              AXABTH                          WGABTH
     I              AXACTH                          WGACTH
     I              AXBPNB                          WGBPNB
     I              AXCSNB                          WGCSNB
     I              AXAUDT                          WGAUDT
     I              AXCMST                          WGCMST
     I              AXAGPR                          WGAGPR
     I              AXATVA                          WGATVA
     I              AXI1ST                          WGI1ST
     I              AXDHNB                          WGDHNB
     I              AXDINB                          WGDINB
     I              AXCNST                          WGCNST
     I              AXGINB                          WGGINB
     I              AXBZDT                          WGBZDT
     I              AXLSNB                          WGLSNB
     I              AXF3TX                          WGF3TX
     I              AXO8ST                          WGO8ST
     I              AXO9ST                          WGO9ST
     I              AXPAST                          WGPAST
     I              AXLDSH                          WGLDSH
     I              AXPBST                          WGPBST
     I              AXPCST                          WGPCST
     I              AXPDST                          WGPDST
     I              AXUWST                          WGUWST
     I              AXUXST                          WGUXST
     I              AXUYST                          WGUYST
     I              AXJKRU                          WGJKRU
     I              AXKEOR                          WGKEOR
     I              AXIOEW                          WGIOEW
     I              AXKJIO                          WGKJIO
     I              AXIOJR                          WGIOJR
     I              AXEIRR                          WGEIRR
     I              AXITMF                          WGITMF
     I              AXODJE                          WGODJE
     I              AXRJIF                          WGRJIF
     I              AXOEJF                          WGOEJF
     I              AXD0DT                          WGD0DT
     I              AXD1DT                          WGD1DT
     I              AXD2DT                          WGD2DT
     I              AXD3DT                          WGD3DT
     I              AXD4DT                          WGD4DT
     I              AXBNCD                          WGBNCD
     I              AXABCD                          WGABCD
     I              AXAECD                          WGAECD
     I              AXAAVN                          WGAAVN
     I              AXAADT                          WGAADT
     I              AXAMTM                          WGAMTM
     I              AXAJST                          WGAJST
     I              AXAHVN                          WGAHVN
     I              AXAGVN                          WGAGVN
     I              AXABVN                          WGABVN
     I              AXABDT                          WGABDT
     I              AXABTM                          WGABTM
      *
     I@ALREYJ
      * Producer Loc Distrib Ent  Retrieval index
      * Renamed input format fields
     I              ALABCD                          WHABCD
     I              ALAECD                          WHAECD
     I              ALR2CD                          WHR2CD
     I              ALYSA1                          WHYSA1
     I              ALCMT1                          WHCMT1
     I              ALHYSS                          WHHYSS
     I              ALCLT1                          WHCLT1
     I              ALAAVN                          WHAAVN
     I              ALAADT                          WHAADT
     I              ALAMTM                          WHAMTM
     I              ALAJST                          WHAJST
     I              ALAHVN                          WHAHVN
     I              ALAGVN                          WHAGVN
     I              ALABVN                          WHABVN
     I              ALABDT                          WHABDT
     I              ALABTM                          WHABTM
      *
     I@AMCPYL
      * Producer Loc Distrib Wrk  Update index
      * Renamed input format fields
     I              AMYUA1                          WIYUA1
     I              AMR7CD                          WIR7CD
     I              AMS2CD                          WIS2CD
     I              AMC2T1                          WIC2T1
     I              AMHNDT                          WIHNDT
     I              AMHQDT                          WIHQDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPWAB1    E DSPWABCPL0
      * UPD : Producer Distribution Wrk Update index
      * Renamed input format fields
     I              ABYUA1                          WEYUA1
     I              ABR7CD                          WER7CD
     I              ABC2T1                          WEC2T1
     I              ABHNDT                          WEHNDT
     I              ABHQDT                          WEHQDT
      *
     IQPWAM1    E DSPWAMCPL0
      * UPD : Producer Loc Distrib Wrk  Update index
      * Renamed input format fields
     I              AMYUA1                          WIYUA1
     I              AMR7CD                          WIR7CD
     I              AMS2CD                          WIS2CD
     I              AMC2T1                          WIC2T1
     I              AMHNDT                          WIHNDT
     I              AMHQDT                          WIHQDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  PDW Input
     I                                        1   1 P1H5SS
     IP2PARM      DS
      * FLD: *Arrays
      * I :  PDW Company Number
     I                                    P   1   20P2YUA1
      * I :  PDW Producer Code
     I                                        3   8 P2R7CD
      * I :  PDW BOL Kill Date
     I                                    P   9  120P2HNDT
      * I :  PDW BOL Kill Date To
     I                                    P  13  160P2HODT
      * I :  SR Type
     I                                       17  17 P2IXST
      * I :  SR Source Code
     I                                       18  20 P2AACD
      * I :  PDW Producer Loc Code
     I                                       21  26 P2S2CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1H5SS    PARM           WP0001  1        PDW Input
     C           P2YUA1    PARM           WP0002  30       PDW Company Num
     C           P2R7CD    PARM           WP0003  6        PDW Producer Co
     C           P2HNDT    PARM           WP0004  70       PDW BOL Kill Da
     C           P2HODT    PARM           WP0005  70       PDW BOL Kill Da
     C           P2IXST    PARM           WP0006  1        SR Type
     C           P2AACD    PARM           WP0007  3        SR Source Code
     C           P2S2CD    PARM           WP0008  6        PDW Producer Lo
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Producer Dist WRK XF
      * CASE: PAR.PDW Input is Prt Delivery Schedule PV
     C           P1H5SS    IFEQ 'P'                        *IF
      * T13559 DN 08/10/18-Pass in Producer Location.
      * Bld Producer Dist WRK RT - Producer  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: PAR.PDW Input is Delivery Sched Detail UPL
     C           P1H5SS    IFEQ 'D'                        *IF
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Bld Producer Dist WRK RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAABCD           PD Producer Cod
      * Setup key
     C                     MOVELP2R7CD    WAABCD           PD Producer Cod
      * Establish starting position
     C           KPSSA     SETLL@ACREG3                    *
     C                     READ @ACREG3                  90*
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Initialize Selection Criteria Fields
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL*BLANK    YL0001           Blank Usr 1 fld
     C                     MOVEL*BLANK    YL0002           Blank Usr 3 cha
      * Record Selection for Producer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PD Producer Code is Entered
      *   |- c2    : PAR.PD Producer Code NE DB1.PD Producer Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2R7CD    IFNE *BLANK                     *IF
     C           P2R7CD    IFNE WAABCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Source Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.SR Source Code NE LCL.Blank Usr 3 char
      *   |- c2    : PAR.SR Source Code NE DB1.SR Source Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2AACD    IFNE YL0002                     *IF
     C           P2AACD    IFNE WAAACD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Souce Type
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SBRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.SR Type NE LCL.Blank Usr 1 fld Usr
      *   |- c2    : PAR.SR Type NE LCL.SR Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2IXST    IFNE YL0001                     *IF
     C           P2IXST    IFNE YL0003                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * T13559 DN 08/10/18-Added Logic to also Process by Producer Locati
      * CASE: *OTHERWISE
      * CASE: PAR.PDW Producer Loc Code is Blank
     C           P2S2CD    IFEQ *BLANK                     *IF
      * Create Producer Distribution Wrk Record by Producer Level.
      * CASE: *OTHERWISE
      * Validate at least 1 Qualifed Buy Order Load
      * E11641 - Pass in PAR.PDW BOL Kill Date To for PDW BOL Kill Date
      * Rtv Producer Dist WRK RT - Buy Order Load  * 
     C                     EXSR SCRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0004    IFEQ 'Y'                        *IF
      * Create Producer Distribution WRK record for each Email
      * record set up for Producer
      * E11641 - Delivery Scheduling Report
      * - Only print Emails if the Producer Distribution Ent record is
      *   A=Active.
      * Crt Prdcr Dlv Sch Rpt RT - Producer Distribution Ent  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Create Producer Loc Distrib Wrk Record by Producer/Producer Loc L
      * CASE: *OTHERWISE
      * Crt Prod Loc Dist Wrk RT - Producer Location  * 
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Create Producer Loc Distrib Wrk Record by Producer/Producer Loc L
      * CASE: *OTHERWISE
      * Rtv Prod Loc Dist Wrk RT - Buy Order Load  * 
     C                     EXSR SJRVGN
      * At Least 1 Qualified Buy Order Load then Create It.
      * CASE: LCL.Record Found USR is Record Found
     C           YL0004    IFEQ 'Y'                        *IF
      * Crt Prod Loc Dist Wrk RT - Producer Loc Distrib Ent  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @ACREG3                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAACD           SR Source Code
      * Setup key
     C                     MOVELWAAACD    WBAACD           SR Source Code
      * Establish starting position
     C           KRSSB     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBIXST    YL0003           SR Type
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Producer Dist WRK RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0004           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCABCD    WQSC02           PD Producer Cod
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           PD Producer Cod
     C                     KFLD           WCCQDT           BOL Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           PD Producer Cod
      * Setup key
     C                     Z-ADDP2YUA1    WQSC01           BOH Company Num
     C                     MOVELWAABCD    WQSC02           PD Producer Cod
     C                     Z-ADDP2HNDT    WCCQDT           BOL Kill Date
      * Establish starting position
     C           KPSSC     SETLL@AXCPWV                    *
     C           KRSSC     READE@AXCPWV                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOL Kill Date LE PAR.PDW BOL Kill Date From
     C           WCCQDT    IFLE P2HODT                     *IF
     C                     MOVEL'Y'       YL0004           Record Found US
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0004           Record Found US
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@AXCPWV                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Crt Prdcr Dlv Sch Rpt RT - Producer Distribution Ent  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDABCD    WQSD01           PD Producer Cod
     C           *LIKE     DEFN WDR2CD    WQSD02           PD Distribution
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           PD Producer Cod
     C                     KFLD           WQSD02           PD Distribution
      * Setup key
     C                     MOVELWAABCD    WQSD01           PD Producer Cod
     C                     MOVEL@CN,001   WQSD02           PD Distribution
      * Establish starting position
     C           KRSSD     SETLL@CRREWR                    *
     C           KRSSD     READE@CRREWR                  90*
      * Data record not found
     C   90                MOVEL'PRK1407' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E11641 - Delivery Scheduling Report
      * - Only print Emails if the Producer Distribution Ent record is
      *   A=Active.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PDE Destination Type is Email
      *   |- c2    : DB1.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDHYSS    IFEQ 'E'                        *IF
     C           WDAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Crt Producer Dist WRK CR - Producer Distribution Wrk  * 
     C                     EXSR SECRRC
     C                     END                             *FI
     C           KRSSD     READE@CRREWR                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Producer Dist WRK CR - Producer Distribution Wrk  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ABCPW1
     C                     Z-ADDP2YUA1    WEYUA1           PDW Company Num
     C                     MOVELWDABCD    WER7CD           PDW Producer Co
     C                     MOVELWDCLT1    WEC2T1           PDW Email
     C                     Z-ADDP2HNDT    WEHNDT           PDW BOL Kill Da
     C                     Z-ADDP2HODT    WEHQDT           PDW Date To
      *
     C           KLCRSE    KLIST
     C                     KFLD           WEYUA1           PDW Company Num
     C                     KFLD           WER7CD           PDW Producer Co
     C                     KFLD           WEC2T1           PDW Email
      * Check for duplicate primary key
     C           KLCRSE    SETLL@ABCPW1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1416' W0RTN   7
      * Send message 'Producer Distrb WRK    EX'
     C                     MOVEL'PRK1416' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@ABCPW1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Crt Prod Loc Dist Wrk RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFABCD    WQSF01           PD Producer Cod
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           PD Producer Cod
      * Setup key
     C                     MOVELWAABCD    WQSF01           PD Producer Cod
      * Establish starting position
     C           KRSSF     SETLL@AFRELR                    *
     C           KRSSF     READE@AFRELR                  90*
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Prod Loc Dist Wrk RT - Buy Order Load  * 
     C                     EXSR SGRVGN
      * At Least 1 Qualified Buy Order Load then Create It.
      * CASE: LCL.Record Found USR is Record Found
     C           YL0005    IFEQ 'Y'                        *IF
      * Crt Prod Loc Dist Wrk RT - Producer Loc Distrib Ent  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C           KRSSF     READE@AFRELR                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Prod Loc Dist Wrk RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0005           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WGABCD    WQSG02           PD Producer Cod
     C           *LIKE     DEFN WGAECD    WQSG03           PL Location Cod
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           PD Producer Cod
     C                     KFLD           WQSG03           PL Location Cod
     C                     KFLD           WGCQDT           BOL Kill Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           PD Producer Cod
     C                     KFLD           WQSG03           PL Location Cod
      * Setup key
     C                     Z-ADDP2YUA1    WQSG01           BOH Company Num
     C                     MOVELWAABCD    WQSG02           PD Producer Cod
     C                     MOVELWFAECD    WQSG03           PL Location Cod
     C                     Z-ADDP2HNDT    WGCQDT           BOL Kill Date
      * Establish starting position
     C           KPSSG     SETLL@AXCPJ2                    *
     C           KRSSG     READE@AXCPJ2                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOL Kill Date LE PAR.PDW BOL Kill Date To
     C           WGCQDT    IFLE P2HODT                     *IF
     C                     MOVEL'Y'       YL0005           Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0005           Record Found US
     C                     END                             *FI
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@AXCPJ2                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Crt Prod Loc Dist Wrk RT - Producer Loc Distrib Ent  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHABCD    WQSH01           PD Producer Cod
     C           *LIKE     DEFN WHAECD    WQSH02           PL Location Cod
     C           *LIKE     DEFN WHR2CD    WQSH03           PD Distribution
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           PD Producer Cod
     C                     KFLD           WQSH02           PL Location Cod
     C                     KFLD           WQSH03           PD Distribution
      * Setup key
     C                     MOVELWAABCD    WQSH01           PD Producer Cod
     C                     MOVELWFAECD    WQSH02           PL Location Cod
     C                     MOVEL@CN,001   WQSH03           PD Distribution
      * Establish starting position
     C           KRSSH     SETLL@ALREYJ                    *
     C           KRSSH     READE@ALREYJ                  90*
      * Data record not found
     C   90                MOVEL'PRK1476' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create a Producer Loc Distrib Ent record for each active email.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PDE Destination Type is Email
      *   |- c2    : DB1.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WHHYSS    IFEQ 'E'                        *IF
     C           WHAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Crt Prod Loc Dist Ent CR - Producer Loc Distrib Wrk  * 
     C                     EXSR SICRRC
     C                     END                             *FI
     C           KRSSH     READE@ALREYJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Prod Loc Dist Ent CR - Producer Loc Distrib Wrk  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMCPYL
     C                     Z-ADDP2YUA1    WIYUA1           PDW Company Num
     C                     MOVELWAABCD    WIR7CD           PDW Producer Co
     C                     MOVELWFAECD    WIS2CD           PDW Producer Lo
     C                     MOVELWHCLT1    WIC2T1           PDW Email
     C                     Z-ADDP2HNDT    WIHNDT           PDW BOL Kill Da
     C                     Z-ADDP2HODT    WIHQDT           PDW Date To
      *
     C           KLCRSI    KLIST
     C                     KFLD           WIYUA1           PDW Company Num
     C                     KFLD           WIR7CD           PDW Producer Co
     C                     KFLD           WIS2CD           PDW Producer Lo
     C                     KFLD           WIC2T1           PDW Email
      * Check for duplicate primary key
     C           KLCRSI    SETLL@AMCPYL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1479' W0RTN   7
      * Send message 'Producer Loc Distrib W EX'
     C                     MOVEL'PRK1479' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@AMCPYL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Prod Loc Dist Wrk RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0004           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WGABCD    WQSJ02           PD Producer Cod
     C           *LIKE     DEFN WGAECD    WQSJ03           PL Location Cod
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           PD Producer Cod
     C                     KFLD           WQSJ03           PL Location Cod
     C                     KFLD           WGCQDT           BOL Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           PD Producer Cod
     C                     KFLD           WQSJ03           PL Location Cod
      * Setup key
     C                     Z-ADDP2YUA1    WQSJ01           BOH Company Num
     C                     MOVELP2R7CD    WQSJ02           PD Producer Cod
     C                     MOVELP2S2CD    WQSJ03           PL Location Cod
     C                     Z-ADDP2HNDT    WGCQDT           BOL Kill Date
      * Establish starting position
     C           KPSSJ     SETLL@AXCPJ2                    *
     C           KRSSJ     READE@AXCPJ2                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOL Kill Date LE PAR.PDW BOL Kill Date To
     C           WGCQDT    IFLE P2HODT                     *IF
     C                     MOVEL'Y'       YL0004           Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0004           Record Found US
     C                     END                             *FI
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@AXCPJ2                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Crt Prod Loc Dist Wrk RT - Producer Loc Distrib Ent  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHABCD    WQSK01           PD Producer Cod
     C           *LIKE     DEFN WHAECD    WQSK02           PL Location Cod
     C           *LIKE     DEFN WHR2CD    WQSK03           PD Distribution
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           PD Producer Cod
     C                     KFLD           WQSK02           PL Location Cod
     C                     KFLD           WQSK03           PD Distribution
      * Setup key
     C                     MOVELP2R7CD    WQSK01           PD Producer Cod
     C                     MOVELP2S2CD    WQSK02           PL Location Cod
     C                     MOVEL@CN,001   WQSK03           PD Distribution
      * Establish starting position
     C           KRSSK     SETLL@ALREYJ                    *
     C           KRSSK     READE@ALREYJ                  90*
      * Data record not found
     C   90                MOVEL'PRK1476' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create a Producer Loc Distrib Ent record for each active email.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PDE Destination Type is Email
      *   |- c2    : DB1.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WHHYSS    IFEQ 'E'                        *IF
     C           WHAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Crt Prod Loc Dist Ent CR - Producer Loc Distrib Wrk  * 
     C                     EXSR SLCRRC
     C                     END                             *FI
     C           KRSSK     READE@ALREYJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Prod Loc Dist Ent CR - Producer Loc Distrib Wrk  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMCPYL
     C                     Z-ADDP2YUA1    WIYUA1           PDW Company Num
     C                     MOVELP2R7CD    WIR7CD           PDW Producer Co
     C                     MOVELP2S2CD    WIS2CD           PDW Producer Lo
     C                     MOVELWHCLT1    WIC2T1           PDW Email
     C                     Z-ADDP2HNDT    WIHNDT           PDW BOL Kill Da
     C                     Z-ADDP2HODT    WIHQDT           PDW Date To
      *
     C           KLCRSL    KLIST
     C                     KFLD           WIYUA1           PDW Company Num
     C                     KFLD           WIR7CD           PDW Producer Co
     C                     KFLD           WIS2CD           PDW Producer Lo
     C                     KFLD           WIC2T1           PDW Email
      * Check for duplicate primary key
     C           KLCRSL    SETLL@AMCPYL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1479' W0RTN   7
      * Send message 'Producer Loc Distrib W EX'
     C                     MOVEL'PRK1479' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@AMCPYL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAALNB           PD Production C
     C                     Z-ADD*ZERO     WAAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WAAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WAGCNB           PD VND Address
     C                     Z-ADD*ZERO     WAGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WCABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WCACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WCBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WCCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WCAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WCAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WCATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WCDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WCDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WCGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WCBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WCLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WCLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WCJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WCKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WCIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WCKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WCIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WCEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WCD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDYSA1           PDE Sequence Nu
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEYUA1           PDW Company Num
     C                     Z-ADD*ZERO     WEHNDT           PDW BOL Kill Da
     C                     Z-ADD*ZERO     WEHQDT           PDW Date To
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WFASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WFHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHYSA1           PDE Sequence Nu
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIYUA1           PDW Company Num
     C                     Z-ADD*ZERO     WIHNDT           PDW BOL Kill Da
     C                     Z-ADD*ZERO     WIHQDT           PDW Date To
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Blank Usr 3 char
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field SR Type
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 HPE-DLVRCV
