/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - THIS PROGRAM IS SUBMITTED FROM PPICUPC WHICH IS      */
/*             CALLED FROM PROMPT PROGRAM PDUJPVR.                  */
/*             IT THEN CALLS THE ORDER EXPORT LOAD REPORT AND       */
/*             PASSES PARMS FOR COMPANY NUMBER, DATES, CARRIER,     */
/*             LOAD ID                                              */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT ORDER EXPORT LOAD REPORT                      */
/*  DATE      - 05/01/2007                                          */
/*                                                                  */
/* PARAMETERS RECEIVED:                                             */
/*     &COMPNYN - COMPANY NUMBER - BLANK FOR ALL - 15.5             */
/*     &FRMDATN - FROM SHIP DATE - 15.5                             */
/*     &THRDATN - THROUGH SHIP DATE - 15.5                          */
/*     &LOADN   - LOAD NUMBER - 15.5                                */
/*     &CARRIER - CARRIER CODE                                      */
/*     &OUTQ    - OUTPUT QUEUE                                      */
/*     &HOLD    - HOLD PRINT                                        */
/*     &SAVE    - SAVE PRINT                                        */
/*     &COPYN   - NUMBER OF COPIES - 15.5                           */
/*     &NIGHTQ  - NIGHT OUTPUT QUEUE                                */
/*     &CUST    - SHIP TO CUST - 15.5                               */
/********************************************************************/
/*  XXX 99/99/2099                                                  */
/*                                                                  */
/********************************************************************/
 PMGDUPC:    PGM        PARM(&OUTQ &HOLD &SAVE &NIGHTQ &COMPNYN +
                          &FRMDATN &THRDATN &LOADN &COPYN &CUST +
                          &ORDCOMN &CARRIER)

/* PARMS                                                             */
        DCL    &COMPNYN    *DEC         /* LOAD COMPANY   (PASSED)   */
        DCL    &FRMDATN    *DEC         /* FROM SHIP DATE (PASSED)   */
        DCL    &THRDATN    *DEC         /* THRU SHIP DATE (PASSED)   */
        DCL    &LOADN      *DEC         /* LOAD NUMBER    (PASSED)   */
        DCL    &CARRIER    *CHAR   (3)  /* CARRIER CODE              */
        DCL    &OUTQ       *CHAR   (10) /* OUTPUT QUEUE              */
        DCL    &HOLD       *CHAR   (4)  /* HOLD STATUS               */
        DCL    &SAVE       *CHAR   (4)  /* SAVE STATUS               */
        DCL    &COPYN      *DEC         /* NO. OF COPIES             */
        DCL    &NIGHTQ     *CHAR   (10) /* NIGHT JOB QUEUE           */
        DCL    &CUST       *DEC         /* SHIP TO CUSTOMER          */
        DCL    &ORDCOMN    *DEC         /* ORDER COMPANY  (PASSED)   */
        DCL    &RETURN     *CHAR   (7)  /* RETURN CODE               */

/*      DCL    &RPTSEL     *CHAR   (1)                               */
/*      DCL    &SALESP     *CHAR   (3)  /* SALESPERSON               */
/*      DCL    &LOADT      *CHAR   (1)  /* NOT USED                  */
/*      DCL    &UOM        *CHAR   (2)                               */
/*      DCL    &REASON     *CHAR   (1)                               */

/* INTERNAL FIELDS                                                   */
        DCL    &COPY       *DEC   (2 0) /* COMPANY NUMBER            */
        DCL    &COMPANY    *DEC   (3 0) /* FROM SHIP DATE            */
        DCL    &FRMDAT     *DEC   (7 0) /* THRU SHIP DATE            */
        DCL    &THRDAT     *DEC   (7 0) /* LOAD NUMBER               */
        DCL    &LOAD       *DEC   (7 0) /* ORDER COMPANY             */
        DCL    &ORDERCO    *DEC   (3 0)

/* OPENQRYF FIELDS                                                   */
        DCL    &COMPA      *CHAR    3   /* ACK COMPLETE              */
        DCL    &FRMDATA    *CHAR    7   /* FROM SHIP DATE (PASSED)   */
        DCL    &THRDATA    *CHAR    7   /* THRU SHIP DATE (PASSED)   */

        DCL     &A        *CHAR   20    /* QRY FROM DATE            */
        DCL     &B        *CHAR   25    /* QRY TO DATE              */
        DCL     &C        *CHAR   25    /* QRY COMPANY              */
        DCL     &D        *CHAR   70    /* QRY ALL                  */
/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/

             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
             CHGVAR     VAR(&COMPA) VALUE(&COMPANY)
             CHGVAR     VAR(&ORDERCO) VALUE(&ORDCOMN)
             CHGVAR     VAR(&FRMDAT) VALUE(&FRMDATN)
             CHGVAR     VAR(&FRMDATA) VALUE(&FRMDAT)
             CHGVAR     VAR(&THRDAT) VALUE(&THRDATN)
             CHGVAR     VAR(&THRDATA) VALUE(&THRDAT)
             CHGVAR     VAR(&LOAD) VALUE(&LOADN)
             CHGVAR     VAR(&COPY) VALUE(&COPYN)

/*********************************************************************/
/*   CREATE OPEN QUERY FILE                                          */
/*********************************************************************/

             CHGVAR     VAR(&A) VALUE('BEAODT *GE ' *CAT +
                         &FRMDATA)

             CHGVAR     VAR(&B) VALUE('*AND BEAODT *LE ' *CAT +
                         &THRDATA)

             IF         (&COMPA *NE '000') THEN(DO)
             CHGVAR     VAR(&C) VALUE('*AND BEAIC3 *EQ ' *CAT +
                         &COMPA)
             ENDDO

             CHGVAR     VAR(&D) VALUE(&A *BCAT &B *BCAT &C)

/*  RUN QUERY TO READ ORDER HEADER BY DATE RANGE                     */

             OVRDBF     FILE(OPBFCPMY) SHARE(*YES)
             OPNQRYF    FILE(OPBFCPMY) +
                        QRYSLT(&D) +
                        KEYFLD(*FILE)
/********************************************************************/
/* OVERRIDE PRINTER FILE WITH USER SPECIFIED SELECTION VALUES       */
/********************************************************************/

             OVRPRTF    FILE(PMGCPFR$) OUTQ(&OUTQ) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)

/*********************************************************************/
/*   CALL PRINT PROGRAM -
/*********************************************************************/

             CALL       PGM(PMGCPFR) PARM(&RETURN &COMPANY &CARRIER +
                          &FRMDAT &LOAD &THRDAT &CUST &ORDERCO)

 END:        ENDPGM
