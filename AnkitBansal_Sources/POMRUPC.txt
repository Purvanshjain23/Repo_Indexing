/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  POMRUPC                                       */
/*  PROGRAM NAME:    Print WEIGHT EXCEPTION REPORT                 */
/*  PROGRAMMER:      JOHN TREMPER                                  */
/*  CREATE DATE:     04/23/99                                      */
/*                                                                 */
/*  FUNCTION:        This CLP is submitted FROM THE PRINT WEIGHT   */
/*                   EXCEPTION REPORT PMT.                         */
/*                                                                 */
/*                   USER OPTIONS ARE PASSED THROUGH THE PARMS.    */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*  RMC 1/31/02 - ADDED 2 PARMS: &RPTTYP FOR REPORT TYPE           */
/*                1=BY SHIP DATE AND 2=BY SALES ROUTE              */
/*                AND SLOT TYPE FOR LOAD (BX,CB,EX,MX)             */
/*  LJB 10/26/06- ADDED PARM TO SELECT WHETHER OR NOT TO PRINT     */
/*                RECORDS WITH SALES ROUTE = ZERO                  */
/*                                                                 */
/*******************************************************************/
 POMRUPC:    PGM        PARM(&COMP &FDATE &TDATE &SHPFLG &SLSRT +
                          &SHPTO &CARR &SHPMTH &SHPORD &WGT &LTL +
                          &LDTYP &RPTTYP &SLOT &PDEV &HOLD &SAVE +
                          &COPIES &SLSRTEZERO)
/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* INPUT PARAMETERS                                                */
             DCL        VAR(&COMP)  TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&FDATE) TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&TDATE) TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&SHPFLG) TYPE(*CHAR)  LEN(1)
             DCL        VAR(&SLSRT) TYPE(*CHAR)  LEN(3)
             DCL        VAR(&SHPTO) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&CARR) TYPE(*CHAR) LEN(3)
             DCL        VAR(&SHPMTH) TYPE(*CHAR) LEN(2)
             DCL        VAR(&SHPORD) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WGT) TYPE(*DEC) LEN(11 2)
             DCL        VAR(&LTL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&LDTYP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&PDEV) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&COPIES) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&RPTTYP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&SLOT) TYPE(*CHAR) LEN(2)
             DCL        VAR(&SLSRTEZERO) TYPE(*CHAR) LEN(1)

/* PROGRAM VARIABLES                                               */
             DCL        VAR(&COMMAND) TYPE(*CHAR) LEN(512)
             DCL        VAR(&ADATE) TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&SHPUSHP) TYPE(*CHAR)  LEN(1)

/*-----------------------------------------------------------------*/
/* PRINT REPORT TYPE 1 - BY SHIP DATE                              */
/*-----------------------------------------------------------------*/
             IF         COND(&RPTTYP = '1') THEN(DO)
             SBDPRTOVR  CMDVAR(&COMMAND) FILE(POMOPFR$) OUTQ(&PDEV) +
                          COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)


             IF         COND(&SHPFLG *EQ ' ' *OR &SHPFLG *EQ 'U') THEN(DO)
             CHGVAR     VAR(&SHPUSHP) VALUE('U')
             CHGVAR     VAR(&ADATE) VALUE(0)
/*********   CALL       PGM(POMOPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &TDATE &SHPUSHP &SLSRT &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT)*****/
             CALL       PGM(POMOPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &TDATE &SHPUSHP &SLSRT &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT +
                          &SLSRTEZERO)
             ENDDO

             IF         COND(&SHPFLG *EQ ' ' *OR &SHPFLG *EQ 'S') THEN(DO)
             CHGVAR     VAR(&SHPUSHP) VALUE('S')
             CHGVAR     VAR(&ADATE) VALUE(&FDATE)
/*********   CALL       PGM(POMOPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &TDATE &SHPUSHP &SLSRT &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT)*****/
             CALL       PGM(POMOPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &TDATE &SHPUSHP &SLSRT &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT +
                          &SLSRTEZERO)
             ENDDO

             ENDDO
/*-----------------------------------------------------------------*/
/* PRINT REPORT TYPE 2 - BY SALES ROUTE                            */
/*-----------------------------------------------------------------*/
             IF         COND(&RPTTYP = '2') THEN(DO)
             SBDPRTOVR  CMDVAR(&COMMAND) FILE(POOXPFR$) OUTQ(&PDEV) +
                          COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)


             IF         COND(&SHPFLG *EQ ' ' *OR &SHPFLG *EQ 'U') THEN(DO)
             CHGVAR     VAR(&SHPUSHP) VALUE('U')
             CHGVAR     VAR(&ADATE) VALUE(0)
/************CALL       PGM(POOXPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &SLSRT &TDATE &SHPUSHP &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT)*****/
             CALL       PGM(POOXPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &SLSRT &TDATE &SHPUSHP &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT +
                          &SLSRTEZERO)
             ENDDO

             IF         COND(&SHPFLG *EQ ' ' *OR &SHPFLG *EQ 'S') THEN(DO)
             CHGVAR     VAR(&SHPUSHP) VALUE('S')
             CHGVAR     VAR(&ADATE) VALUE(&FDATE)
/************CALL       PGM(POOXPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &SLSRT &TDATE &SHPUSHP &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT)*****/
             CALL       PGM(POOXPFR) PARM(' ' &COMP &ADATE &FDATE +
                          &SLSRT &TDATE &SHPUSHP &SHPTO &CARR +
                          &SHPMTH &SHPORD &WGT &LTL &LDTYP &SLOT +
                          &SLSRTEZERO)
             ENDDO

             ENDDO
/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
 ENDPGM:

             ENDPGM
