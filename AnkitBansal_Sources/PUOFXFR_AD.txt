// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUOFXFR
// ?Date: 14.08.2025 Time: 03:50:57
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?** Read for extracts with "Historical" in the file name -mark processed
EXECUTE FUNCTION(Rtv Historical Unpr   RT) TYPE(RTVOBJ) FILE(PBCRCPP)           AC2176878;
{
 //?USER: Process Data record

 // Call program CLC Call Qclscan       UP.
 CALL PROGRAM(CLC Call Qclscan       UP) ('QCLSCAN');
 PARAMETER(DB1.TMS_Extract_File_Name);
 PARAMETER(25);
 PARAMETER(1);
 PARAMETER('Historical');
 PARAMETER(10);
 PARAMETER(*BLANK);
 PARAMETER(1);
 PARAMETER(*BLANK);
 PARAMETER(WRK.USR_Qclscan_Result);

 CASE;

 // IF WRK.USR Qclscan Result ? is Does contain
 IF WRK.USR_Qclscan_Result > 0;

 //?Upd rcd as processed or error or no change
 EXECUTE FUNCTION(Chg TMS Load          CH) TYPE(CHGOBJ) FILE(PBCRCPP)           AC2122573;
 PARAMETER(DB1.TMS_Load_ID);
 PARAMETER(DB1.TMS_Extract_Date);
 PARAMETER(DB1.TMS_Extract_Time);
 PARAMETER(DB1.TMS_Extract_File_Name);
 PARAMETER(DB1.TMS_Customer_Load_ID);
 PARAMETER(DB1.TMS_Temperature);
 PARAMETER(DB1.TMS_Temperature_UOM);
 PARAMETER(DB1.TMS_Movement_Type);
 PARAMETER(DB1.TMS_Shipment_Type);
 PARAMETER(DB1.TMS_Payment_Method);
 PARAMETER(DB1.TMS_POD_Received);
 PARAMETER(DB1.TMS_Load_Status);
 PARAMETER(DB1.TMS_Load_Owner);
 PARAMETER(DB1.TMS_Carrier_SCAC);
 PARAMETER(DB1.TMS_Carrier_Mode);
 PARAMETER(DB1.TMS_Carrier_Distance);
 PARAMETER(DB1.TMS_Deadline_Depart_Date);
 PARAMETER(DB1.TMS_Deadline_Depart_Time);
 PARAMETER(DB1.TMS_Trailer_Number);
 PARAMETER(DB1.TMS_Container_Number);
 PARAMETER(DB1.TMS_Move_Type);
 PARAMETER(DB1.TMS_Vessel_Name);
 PARAMETER(DB1.TMS_Voyage_Number);
 PARAMETER(DB1.TMS_Booking_Number);
 PARAMETER(DB1.TMS_OTR_Destination_Name);
 PARAMETER(DB1.TMS_OTR_Destination_Addr1);
 PARAMETER(DB1.TMS_OTR_Destination_Addr2);
 PARAMETER(DB1.TMS_OTR_Destination_City);
 PARAMETER(DB1.TMS_OTR_Destination_State);
 PARAMETER(DB1.TMS_OTR_Destination_Zip);
 PARAMETER(DB1.TMS_OTR_Destination_Cntry);
 PARAMETER(DB1.TMS_Vessel_ETD_Date);
 PARAMETER(DB1.TMS_Vessel_ETA_Date);
 PARAMETER(DB1.TMS_Carrier_Ref_PRO_Inv);
 PARAMETER(DB1.TMS_Record_Status);
 PARAMETER(1);
 PARAMETER(PAR.TMS_Error_Reason);
 PARAMETER(JOB.*Job_date);
 PARAMETER(JOB.*Job_time);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set TMS Record Stampp IF) TYPE(EXCINTFUN)                      AC2123222;
  PARAMETER(DB1.TMS_Record_Status);
  PARAMETER(DB1.TMS_Change_Date);
  PARAMETER(DB1.TMS_Change_time);
  {
   //?Execute internal function

   // PAR.TMS Change time = JOB.*Job time
   PAR.TMS_Change_time = JOB.*Job_time;

   // PAR.TMS Change Date = JOB.*Job date
   PAR.TMS_Change_Date = JOB.*Job_date;

  }

 }

 ENDIF;

}


