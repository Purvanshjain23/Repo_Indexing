     H/TITLE Clc Freight Charges   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/06/19  Time  : 10:58:04
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOBCCPL1IF  E           K        DISK
      * RTV : Load Freight Charge       Retrieval index
      *
     FPOA9REL2IF  E           K        DISK
      * RTV : Freight Charge            Auto Calc=Yes/Active
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPOBAREL1IF  E           K        DISK
      * RTV : Freight Charge State      Retrieval index
      *
     FOPBFCPMGIF  E           K        DISK
      * RSQ : Order Header TRG          Load/State/City/Ord
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPOBBCPL1IF  E           K        DISK
      * RTV : Freight Charge Rate       Retrieval index
      *
     FPME4REL1IF  E           K        DISK
      * RTV : Freight Charge Company    Retrieval index
      *
     FPME5REL1IF  E           K        DISK
      * RTV : Freight Charge Co/Carrier Retrieval index
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FPMAMREL2IF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPMABREL2IF  E           K        DISK
      * RSQ : Carrier Freight Charge    Carr/cfc chrg/Dt(D)/Line
      *
     FPOBCCPL6IF  E           K        DISK
      * RSQ : Load Freight Charge       Ld/FCde/Seq(d)
      *
     FPMDJREL3IF  E           K        DISK
      * RSQ : Freight Charge Reference  FCde/RefTyp/RefCde
      *
     FPMDIREL1IF  E           K        DISK
      * RTV : Charge Reference          Retrieval index
      *
     FPOA9REL1IF  E           K        DISK
      * RTV : Freight Charge            Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPMDKCPL1IF  E           K        DISK
      * RTV : Load Freight Charge Ref   Retrieval index
      *
     FPOBCCPL0UF  E           K        DISK                      A
      * UPD : Load Freight Charge       Update index
      *
     FPMDKCPL0IF  E           K        DISK                      A
      * UPD : Load Freight Charge Ref   Update index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BCCPJ8
      * Load Freight Charge       Retrieval index
      * Renamed input format fields
     I              BCRMNB                          WARMNB
     I              BCCDAA                          WACDAA
     I              BCEPNY                          WAEPNY
     I              BCC5VL                          WAC5VL
     I              BCKBSX                          WAKBSX
     I              BCCFAA                          WACFAA
     I              BCKDSX                          WAKDSX
     I              BCKESX                          WAKESX
     I              BCKFSX                          WAKFSX
     I              BCKGSX                          WAKGSX
     I              BCKSSX                          WAKSSX
     I              BCKTSX                          WAKTSX
     I              BCKHSX                          WAKHSX
     I              BCKISX                          WAKISX
     I              BCKJSX                          WAKJSX
     I              BCEQNY                          WAEQNY
     I              BCVSST                          WAVSST
     I              BCMJDT                          WAMJDT
     I              BCBETM                          WABETM
     I              BCCCVN                          WACCVN
     I              BCCDVN                          WACDVN
     I              BCMKDT                          WAMKDT
     I              BCBFTM                          WABFTM
     I              BCCEVN                          WACEVN
     I              BCCFVN                          WACFVN
      *
     I@BCCPJ7
      * Load Freight Charge       Update index
      * Renamed input format fields
     I              BCRMNB                          WBRMNB
     I              BCCDAA                          WBCDAA
     I              BCEPNY                          WBEPNY
     I              BCC5VL                          WBC5VL
     I              BCKBSX                          WBKBSX
     I              BCCFAA                          WBCFAA
     I              BCKDSX                          WBKDSX
     I              BCKESX                          WBKESX
     I              BCKFSX                          WBKFSX
     I              BCKGSX                          WBKGSX
     I              BCKSSX                          WBKSSX
     I              BCKTSX                          WBKTSX
     I              BCKHSX                          WBKHSX
     I              BCKISX                          WBKISX
     I              BCKJSX                          WBKJSX
     I              BCEQNY                          WBEQNY
     I              BCVSST                          WBVSST
     I              BCMJDT                          WBMJDT
     I              BCBETM                          WBBETM
     I              BCCCVN                          WBCCVN
     I              BCCDVN                          WBCDVN
     I              BCMKDT                          WBMKDT
     I              BCBFTM                          WBBFTM
     I              BCCEVN                          WBCEVN
     I              BCCFVN                          WBCFVN
      *
     I@A9REKD
      * Freight Charge            Auto Calc=Yes/Active
      * Renamed input format fields
     I              A9CDAA                          WCCDAA
     I              A9PNNA                          WCPNNA
     I              A9C3VL                          WCC3VL
     I              A9JUSX                          WCJUSX
     I              A9JZSX                          WCJZSX
     I              A9J5SX                          WCJ5SX
     I              A9JVSX                          WCJVSX
     I              A9JWSX                          WCJWSX
     I              A9JXSX                          WCJXSX
     I              A9JYSX                          WCJYSX
     I              A9KKSX                          WCKKSX
     I              A9J0SX                          WCJ0SX
     I              A9J1SX                          WCJ1SX
     I              A9KRSX                          WCKRSX
     I              A9KPSX                          WCKPSX
     I              A9KQSX                          WCKQSX
     I              A9J2SX                          WCJ2SX
     I              A9J3SX                          WCJ3SX
     I              A9J4SX                          WCJ4SX
     I              A9J6SX                          WCJ6SX
     I              A9J7SX                          WCJ7SX
     I              A9J8SX                          WCJ8SX
     I              A9J9SX                          WCJ9SX
     I              A9KASX                          WCKASX
     I              A9OPDT                          WCOPDT
     I              A9VSST                          WCVSST
     I              A9MJDT                          WCMJDT
     I              A9BETM                          WCBETM
     I              A9CCVN                          WCCCVN
     I              A9CDVN                          WCCDVN
     I              A9MKDT                          WCMKDT
     I              A9BFTM                          WCBFTM
     I              A9CEVN                          WCCEVN
     I              A9CFVN                          WCCFVN
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@BAREJ5
      * Freight Charge State      Retrieval index
      * Renamed input format fields
     I              BACDAA                          WECDAA
     I              BABGCD                          WEBGCD
     I              BAVSST                          WEVSST
     I              BAMJDT                          WEMJDT
     I              BABETM                          WEBETM
     I              BACCVN                          WECCVN
     I              BACDVN                          WECDVN
     I              BAMKDT                          WEMKDT
     I              BABFTM                          WEBFTM
     I              BACEVN                          WECEVN
     I              BACFVN                          WECFVN
      *
     I@BFCPKE
      * Order Header TRG          Load/State/City/Ord
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WGAIC3
     I              AFBCDT                          WGBCDT
     I              AFCQNB                          WGCQNB
     I              AFESNB                          WGESNB
     I              AFETNB                          WGETNB
     I              AFBZNB                          WGBZNB
     I              AFA9ST                          WGA9ST
     I              AFEINB                          WGEINB
     I              AFC5ST                          WGC5ST
     I              AFAQNB                          WGAQNB
     I              AFCMST                          WGCMST
     I              AFV9ST                          WGV9ST
     I              AFWAST                          WGWAST
     I              AFX2ST                          WGX2ST
     I              AFOJDT                          WGOJDT
     I              AFNQNX                          WGNQNX
     I              AFNRNX                          WGNRNX
     I              AFI9SX                          WGI9SX
     I              AFJASX                          WGJASX
     I              AFOKDT                          WGOKDT
     I              AFOLDT                          WGOLDT
     I              AFUVST                          WGUVST
     I              AFUWST                          WGUWST
     I              AFUXST                          WGUXST
     I              AFAATM                          WGAATM
     I              AFAYNA                          WGAYNA
     I              AFA0NA                          WGA0NA
     I              AFAXDT                          WGAXDT
      *
     I@BBCPJ2
      * Freight Charge Rate       Retrieval index
      * Renamed input format fields
     I              BBCDAA                          WHCDAA
     I              BBONDT                          WHONDT
     I              BBC4VL                          WHC4VL
     I              BBDNVL                          WHDNVL
     I              BBDKVL                          WHDKVL
     I              BBDLVL                          WHDLVL
     I              BBDMVL                          WHDMVL
     I              BBK6SX                          WHK6SX
     I              BBK7SX                          WHK7SX
     I              BBK8SX                          WHK8SX
     I              BBVSST                          WHVSST
     I              BBMJDT                          WHMJDT
     I              BBBETM                          WHBETM
     I              BBCCVN                          WHCCVN
     I              BBCDVN                          WHCDVN
     I              BBMKDT                          WHMKDT
     I              BBBFTM                          WHBFTM
     I              BBCEVN                          WHCEVN
     I              BBCFVN                          WHCFVN
      *
     I@E4REAV
      * Freight Charge Company    Retrieval index
      * Renamed input format fields
     I              E4CDAA                          WICDAA
     I              E4AIC3                          WIAIC3
     I              E4VSST                          WIVSST
     I              E4MJDT                          WIMJDT
     I              E4BETM                          WIBETM
     I              E4CCVN                          WICCVN
     I              E4CDVN                          WICDVN
     I              E4MKDT                          WIMKDT
     I              E4BFTM                          WIBFTM
     I              E4CEVN                          WICEVN
     I              E4CFVN                          WICFVN
      *
     I@E5REAS
      * Freight Charge Co/Carrier Retrieval index
      * Renamed input format fields
     I              E5CDAA                          WJCDAA
     I              E5AIC3                          WJAIC3
     I              E5BZNA                          WJBZNA
     I              E5VSST                          WJVSST
     I              E5MJDT                          WJMJDT
     I              E5BETM                          WJBETM
     I              E5CCVN                          WJCCVN
     I              E5CDVN                          WJCDVN
     I              E5MKDT                          WJMKDT
     I              E5BFTM                          WJBFTM
     I              E5CEVN                          WJCEVN
     I              E5CFVN                          WJCFVN
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WKRMNB
     I              FLRUNB                          WKRUNB
     I              FLRVNB                          WKRVNB
     I              FLDQTX                          WKDQTX
     I              FLRWNB                          WKRWNB
     I              FLRXNB                          WKRXNB
     I              FLSQNB                          WKSQNB
     I              FLT0NB                          WKT0NB
     I              FLT1NB                          WKT1NB
     I              FLR1NB                          WKR1NB
     I              FLAIC3                          WKAIC3
     I              FLC4NB                          WKC4NB
     I              FLVCST                          WKVCST
     I              FLKEDT                          WKKEDT
     I              FLSXNB                          WKSXNB
     I              FLKFDT                          WKKFDT
     I              FLACTM                          WKACTM
     I              FLK5TX                          WKK5TX
     I              FLW5CD                          WKW5CD
     I              FLEJDT                          WKEJDT
     I              FLAGTM                          WKAGTM
     I              FLKJDT                          WKKJDT
     I              FLATTM                          WKATTM
     I              FLHDDT                          WKHDDT
     I              FLAUTM                          WKAUTM
     I              FLKKDT                          WKKKDT
     I              FLAVTM                          WKAVTM
     I              FLZ4NB                          WKZ4NB
     I              FLY7ST                          WKY7ST
     I              FLY2ST                          WKY2ST
     I              FLWHTX                          WKWHTX
     I              FLWITX                          WKWITX
     I              FLWJTX                          WKWJTX
     I              FLWKTX                          WKWKTX
     I              FLWLTX                          WKWLTX
     I              FLN7DT                          WKN7DT
     I              FLN8DT                          WKN8DT
     I              FLN9DT                          WKN9DT
     I              FLB3TM                          WKB3TM
     I              FLB4TM                          WKB4TM
     I              FLB5TM                          WKB5TM
     I              FLIASX                          WKIASX
     I              FLIBSX                          WKIBSX
     I              FLICSX                          WKICSX
     I              FLWVTX                          WKWVTX
     I              FLWWTX                          WKWWTX
     I              FLWXTX                          WKWXTX
     I              FLUVST                          WKUVST
     I              FLUWST                          WKUWST
     I              FLUXST                          WKUXST
     I              FLAATM                          WKAATM
     I              FLAYNA                          WKAYNA
     I              FLA0NA                          WKA0NA
     I              FLAXDT                          WKAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                          WMR4CD
     I              JEMZNA                          WMMZNA
     I              JEBCCD                          WMBCCD
     I              JEBFCD                          WMBFCD
     I              JEQ4CD                          WMQ4CD
     I              JEWOST                          WMWOST
     I              JER8CD                          WMR8CD
     I              JEUVST                          WMUVST
     I              JEUWST                          WMUWST
     I              JEUXST                          WMUXST
     I              JEVSST                          WMVSST
     I              JEAATM                          WMAATM
     I              JEAYNA                          WMAYNA
     I              JEA0NA                          WMA0NA
     I              JEAXDT                          WMAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WOBCCD
     I              APALTX                          WOALTX
     I              APACNA                          WOACNA
     I              APADNA                          WOADNA
     I              APAENA                          WOAENA
     I              APAJNA                          WOAJNA
     I              APBGCD                          WOBGCD
     I              APBTTX                          WOBTTX
     I              APBVTX                          WOBVTX
     I              APBWTX                          WOBWTX
     I              APDZTX                          WODZTX
     I              APD0TX                          WOD0TX
     I              APD1TX                          WOD1TX
     I              APLVCD                          WOLVCD
     I              APKZCD                          WOKZCD
     I              APAIC3                          WOAIC3
     I              APAVNB                          WOAVNB
     I              APDSCD                          WODSCD
     I              APUVST                          WOUVST
     I              APUWST                          WOUWST
     I              APUXST                          WOUXST
     I              APVSST                          WOVSST
     I              APAATM                          WOAATM
     I              APAYNA                          WOAYNA
     I              APA0NA                          WOA0NA
     I              APAXDT                          WOAXDT
      *
     I@LECPM7
      * Carrier Destination Rate  Retrieval index
      * Renamed input format fields
     I              LEBZNA                          WRBZNA
     I              LEAJCD                          WRAJCD
     I              LEXECD                          WRXECD
     I              LEBGCD                          WRBGCD
     I              LENMVA                          WRNMVA
     I              LEAVTX                          WRAVTX
     I              LEEPPR                          WREPPR
     I              LEEQPR                          WREQPR
     I              LEERPR                          WRERPR
     I              LELUSX                          WRLUSX
     I              LELVSX                          WRLVSX
     I              LEOQDT                          WROQDT
     I              LEORDT                          WRORDT
     I              LEGXVL                          WRGXVL
     I              LEAATM                          WRAATM
     I              LEAYNA                          WRAYNA
     I              LEA0NA                          WRA0NA
     I              LEAXDT                          WRAXDT
      *
     I@AMREJM
      * Order Header Extension    Load ID/Order#/Co#
      * Renamed input format fields
     I              AMAIC3                          WSAIC3
     I              AMC4NB                          WSC4NB
     I              AMRMNB                          WSRMNB
     I              AMRUNB                          WSRUNB
     I              AMXACD                          WSXACD
     I              AMOANA                          WSOANA
     I              AMHBAA                          WSHBAA
     I              AMJ0T1                          WSJ0T1
     I              AMGENY                          WSGENY
     I              AMJ1T1                          WSJ1T1
     I              AMHCAA                          WSHCAA
     I              AMQWDT                          WSQWDT
     I              AMQXDT                          WSQXDT
     I              AMQYDT                          WSQYDT
     I              AMHDAA                          WSHDAA
     I              AMCCTX                          WSCCTX
     I              AMJ2T1                          WSJ2T1
     I              AMRLNA                          WSRLNA
     I              AMRMNA                          WSRMNA
     I              AMGINY                          WSGINY
     I              AMGFNY                          WSGFNY
     I              AMGGNY                          WSGGNY
     I              AMGHNY                          WSGHNY
     I              AMHEVL                          WSHEVL
     I              AMHFVL                          WSHFVL
     I              AMHGVL                          WSHGVL
     I              AMQZDT                          WSQZDT
     I              AMQ0DT                          WSQ0DT
     I              AMQ1DT                          WSQ1DT
     I              AMQ2DT                          WSQ2DT
     I              AMC2TX                          WSC2TX
     I              AMC3TX                          WSC3TX
     I              AMC6TX                          WSC6TX
     I              AMCHTX                          WSCHTX
     I              AMCITX                          WSCITX
     I              AMCLTX                          WSCLTX
     I              AMB4TX                          WSB4TX
     I              AMCUTX                          WSCUTX
     I              AMCVTX                          WSCVTX
     I              AMB9TX                          WSB9TX
     I              AMJWSC                          WSJWSC
     I              AMITNY                          WSITNY
     I              AMLMT1                          WSLMT1
     I              AMLWAA                          WSLWAA
     I              AMFVST                          WSFVST
     I              AMF0ST                          WSF0ST
     I              AMF2ST                          WSF2ST
     I              AMF3ST                          WSF3ST
     I              AMJUSC                          WSJUSC
     I              AMJVSC                          WSJVSC
     I              AMV3T1                          WSV3T1
     I              AMV4T1                          WSV4T1
     I              AMV5T1                          WSV5T1
     I              AMV6T1                          WSV6T1
     I              AMV7T1                          WSV7T1
     I              AMV8T1                          WSV8T1
     I              AMV9T1                          WSV9T1
     I              AMWAT1                          WSWAT1
     I              AMWBT1                          WSWBT1
     I              AMWCT1                          WSWCT1
     I              AMWDT1                          WSWDT1
     I              AMQJNY                          WSQJNY
     I              AMQKNY                          WSQKNY
     I              AMQLNY                          WSQLNY
     I              AMP8NY                          WSP8NY
     I              AMP9NY                          WSP9NY
     I              AMQANY                          WSQANY
     I              AMQCNY                          WSQCNY
     I              AMQDNY                          WSQDNY
     I              AMQENY                          WSQENY
     I              AMQFNY                          WSQFNY
     I              AMQGNY                          WSQGNY
     I              AMQHNY                          WSQHNY
     I              AMQINY                          WSQINY
     I              AMQMNY                          WSQMNY
     I              AMMYU1                          WSMYU1
     I              AMJXSC                          WSJXSC
     I              AMJYSC                          WSJYSC
     I              AMJZSC                          WSJZSC
     I              AMJ0SC                          WSJ0SC
     I              AMMZU1                          WSMZU1
     I              AMM0U1                          WSM0U1
     I              AMM1U1                          WSM1U1
     I              AMM2U1                          WSM2U1
     I              AMM3U1                          WSM3U1
     I              AMW5DT                          WSW5DT
     I              AMW6DT                          WSW6DT
     I              AMUVST                          WSUVST
     I              AMUWST                          WSUWST
     I              AMUXST                          WSUXST
     I              AMVSST                          WSVSST
     I              AMAATM                          WSAATM
     I              AMAYNA                          WSAYNA
     I              AMA0NA                          WSA0NA
     I              AMAXDT                          WSAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WTRMNB
     I              FJAIC3                          WTAIC3
     I              FJAODT                          WTAODT
     I              FJPJST                          WTPJST
     I              FJPKST                          WTPKST
     I              FJRNNB                          WTRNNB
     I              FJDMTX                          WTDMTX
     I              FJDNTX                          WTDNTX
     I              FJDOTX                          WTDOTX
     I              FJWTTX                          WTWTTX
     I              FJWUTX                          WTWUTX
     I              FJRPNB                          WTRPNB
     I              FJFLAM                          WTFLAM
     I              FJXQST                          WTXQST
     I              FJRRNB                          WTRRNB
     I              FJDXTX                          WTDXTX
     I              FJDYTX                          WTDYTX
     I              FJSBNB                          WTSBNB
     I              FJBZNA                          WTBZNA
     I              FJRONB                          WTRONB
     I              FJSQNB                          WTSQNB
     I              FJR1NB                          WTR1NB
     I              FJVCST                          WTVCST
     I              FJVDST                          WTVDST
     I              FJSDNB                          WTSDNB
     I              FJPAOU                          WTPAOU
     I              FJDGWG                          WTDGWG
     I              FJSXNB                          WTSXNB
     I              FJHADT                          WTHADT
     I              FJAART                          WTAART
     I              FJDHWG                          WTDHWG
     I              FJDIWG                          WTDIWG
     I              FJAQDT                          WTAQDT
     I              FJS6NB                          WTS6NB
     I              FJT4NB                          WTT4NB
     I              FJPRTM                          WTPRTM
     I              FJNPSV                          WTNPSV
     I              FJJ8TX                          WTJ8TX
     I              FJTLMI                          WTTLMI
     I              FJJ9TX                          WTJ9TX
     I              FJQ2CD                          WTQ2CD
     I              FJVPCD                          WTVPCD
     I              FJDBCD                          WTDBCD
     I              FJGRWE                          WTGRWE
     I              FJXCCD                          WTXCCD
     I              FJU2ST                          WTU2ST
     I              FJF9DT                          WTF9DT
     I              FJONTM                          WTONTM
     I              FJJ4DT                          WTJ4DT
     I              FJTRTM                          WTTRTM
     I              FJJ5DT                          WTJ5DT
     I              FJSPTM                          WTSPTM
     I              FJJ6DT                          WTJ6DT
     I              FJLFTM                          WTLFTM
     I              FJJ7DT                          WTJ7DT
     I              FJBOTM                          WTBOTM
     I              FJJ8DT                          WTJ8DT
     I              FJBLTM                          WTBLTM
     I              FJKIDT                          WTKIDT
     I              FJASTM                          WTASTM
     I              FJKADT                          WTKADT
     I              FJAJCM                          WTAJCM
     I              FJXACD                          WTXACD
     I              FJOANA                          WTOANA
     I              FJK4TX                          WTK4TX
     I              FJVOAG                          WTVOAG
     I              FJKBDT                          WTKBDT
     I              FJNBBO                          WTNBBO
     I              FJW4CD                          WTW4CD
     I              FJEFDT                          WTEFDT
     I              FJCNTN                          WTCNTN
     I              FJKCDT                          WTKCDT
     I              FJTMIN                          WTTMIN
     I              FJKDDT                          WTKDDT
     I              FJVMNB                          WTVMNB
     I              FJOCFR                          WTOCFR
     I              FJKJDT                          WTKJDT
     I              FJATTM                          WTATTM
     I              FJOTRS                          WTOTRS
     I              FJRNST                          WTRNST
     I              FJBRBK                          WTBRBK
     I              FJEIDT                          WTEIDT
     I              FJRMST                          WTRMST
     I              FJAJCD                          WTAJCD
     I              FJKKDT                          WTKKDT
     I              FJAVTM                          WTAVTM
     I              FJKZDT                          WTKZDT
     I              FJAXTM                          WTAXTM
     I              FJLHOS                          WTLHOS
     I              FJLHOR                          WTLHOR
     I              FJWNTX                          WTWNTX
     I              FJOITX                          WTOITX
     I              FJOJTX                          WTOJTX
     I              FJLLDT                          WTLLDT
     I              FJLSHG                          WTLSHG
     I              FJYPST                          WTYPST
     I              FJK0DT                          WTK0DT
     I              FJAYTM                          WTAYTM
     I              FJKNNX                          WTKNNX
     I              FJICWG                          WTICWG
     I              FJIDWG                          WTIDWG
     I              FJH9SX                          WTH9SX
     I              FJWOTX                          WTWOTX
     I              FJK1DT                          WTK1DT
     I              FJAZTM                          WTAZTM
     I              FJK2DT                          WTK2DT
     I              FJA0TM                          WTA0TM
     I              FJROST                          WTROST
     I              FJRPST                          WTRPST
     I              FJRQST                          WTRQST
     I              FJRRST                          WTRRST
     I              FJZBVA                          WTZBVA
     I              FJWPTX                          WTWPTX
     I              FJWQTX                          WTWQTX
     I              FJWRTX                          WTWRTX
     I              FJWSTX                          WTWSTX
     I              FJRVSX                          WTRVSX
     I              FJRUSX                          WTRUSX
     I              FJRWSX                          WTRWSX
     I              FJRXSX                          WTRXSX
     I              FJRYSX                          WTRYSX
     I              FJRZSX                          WTRZSX
     I              FJR0SX                          WTR0SX
     I              FJR1SX                          WTR1SX
     I              FJR2SX                          WTR2SX
     I              FJR3SX                          WTR3SX
     I              FJR4SX                          WTR4SX
     I              FJPYDT                          WTPYDT
     I              FJCKTM                          WTCKTM
     I              FJPZDT                          WTPZDT
     I              FJCLTM                          WTCLTM
     I              FJP0DT                          WTP0DT
     I              FJCMTM                          WTCMTM
     I              FJP1DT                          WTP1DT
     I              FJCNTM                          WTCNTM
     I              FJP2DT                          WTP2DT
     I              FJCOTM                          WTCOTM
     I              FJP3DT                          WTP3DT
     I              FJCQTM                          WTCQTM
     I              FJUVST                          WTUVST
     I              FJUWST                          WTUWST
     I              FJUXST                          WTUXST
     I              FJAATM                          WTAATM
     I              FJAYNA                          WTAYNA
     I              FJA0NA                          WTA0NA
     I              FJAXDT                          WTAXDT
      *
     I@ABREHD
      * Carrier Freight Charge    Carr/cfc chrg/Dt(D)/Line
      * Renamed input format fields
     I              ABBZNA                          WVBZNA
     I              ABG7AA                          WVG7AA
     I              ABFDNY                          WVFDNY
     I              ABFENY                          WVFENY
     I              ABAWTX                          WVAWTX
     I              ABQODT                          WVQODT
     I              ABAXTX                          WVAXTX
     I              ABAZTX                          WVAZTX
     I              ABFFNY                          WVFFNY
     I              ABVSST                          WVVSST
     I              ABMJDT                          WVMJDT
     I              ABBETM                          WVBETM
     I              ABCCVN                          WVCCVN
     I              ABCDVN                          WVCDVN
     I              ABMKDT                          WVMKDT
     I              ABBFTM                          WVBFTM
     I              ABCEVN                          WVCEVN
     I              ABCFVN                          WVCFVN
      *
     I@BCCPRK
      * Load Freight Charge       Ld/FCde/Seq(d)
      * Renamed input format fields
     I              BCRMNB                          WWRMNB
     I              BCCDAA                          WWCDAA
     I              BCEPNY                          WWEPNY
     I              BCC5VL                          WWC5VL
     I              BCKBSX                          WWKBSX
     I              BCCFAA                          WWCFAA
     I              BCKDSX                          WWKDSX
     I              BCKESX                          WWKESX
     I              BCKFSX                          WWKFSX
     I              BCKGSX                          WWKGSX
     I              BCKSSX                          WWKSSX
     I              BCKTSX                          WWKTSX
     I              BCKHSX                          WWKHSX
     I              BCKISX                          WWKISX
     I              BCKJSX                          WWKJSX
     I              BCEQNY                          WWEQNY
     I              BCVSST                          WWVSST
     I              BCMJDT                          WWMJDT
     I              BCBETM                          WWBETM
     I              BCCCVN                          WWCCVN
     I              BCCDVN                          WWCDVN
     I              BCMKDT                          WWMKDT
     I              BCBFTM                          WWBFTM
     I              BCCEVN                          WWCEVN
     I              BCCFVN                          WWCFVN
      *
     I@DJREYA
      * Freight Charge Reference  FCde/RefTyp/RefCde
      * Renamed input format fields
     I              DJCDAA                          WXCDAA
     I              DJIYAA                          WXIYAA
     I              DJAYST                          WXAYST
     I              DJVSST                          WXVSST
     I              DJMJDT                          WXMJDT
     I              DJBETM                          WXBETM
     I              DJCCVN                          WXCCVN
     I              DJCDVN                          WXCDVN
     I              DJMKDT                          WXMKDT
     I              DJBFTM                          WXBFTM
     I              DJCEVN                          WXCEVN
     I              DJCFVN                          WXCFVN
      *
     I@DIREQ5
      * Charge Reference          Retrieval index
      * Renamed input format fields
     I              DIIYAA                          WYIYAA
     I              DIR8NA                          WYR8NA
     I              DIKCTX                          WYKCTX
     I              DIVSST                          WYVSST
     I              DIMJDT                          WYMJDT
     I              DIBETM                          WYBETM
     I              DICCVN                          WYCCVN
     I              DICDVN                          WYCDVN
     I              DIMKDT                          WYMKDT
     I              DIBFTM                          WYBFTM
     I              DICEVN                          WYCEVN
     I              DICFVN                          WYCFVN
      *
     I@A9REJZ
      * Freight Charge            Retrieval index
      * Renamed input format fields
     I              A9CDAA                          TACDAA
     I              A9PNNA                          TAPNNA
     I              A9C3VL                          TAC3VL
     I              A9JUSX                          TAJUSX
     I              A9JZSX                          TAJZSX
     I              A9J5SX                          TAJ5SX
     I              A9JVSX                          TAJVSX
     I              A9JWSX                          TAJWSX
     I              A9JXSX                          TAJXSX
     I              A9JYSX                          TAJYSX
     I              A9KKSX                          TAKKSX
     I              A9J0SX                          TAJ0SX
     I              A9J1SX                          TAJ1SX
     I              A9KRSX                          TAKRSX
     I              A9KPSX                          TAKPSX
     I              A9KQSX                          TAKQSX
     I              A9J2SX                          TAJ2SX
     I              A9J3SX                          TAJ3SX
     I              A9J4SX                          TAJ4SX
     I              A9J6SX                          TAJ6SX
     I              A9J7SX                          TAJ7SX
     I              A9J8SX                          TAJ8SX
     I              A9J9SX                          TAJ9SX
     I              A9KASX                          TAKASX
     I              A9OPDT                          TAOPDT
     I              A9VSST                          TAVSST
     I              A9MJDT                          TAMJDT
     I              A9BETM                          TABETM
     I              A9CCVN                          TACCVN
     I              A9CDVN                          TACDVN
     I              A9MKDT                          TAMKDT
     I              A9BFTM                          TABFTM
     I              A9CEVN                          TACEVN
     I              A9CFVN                          TACFVN
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          TBRMNB
     I              FLRUNB                          TBRUNB
     I              FLRVNB                          TBRVNB
     I              FLDQTX                          TBDQTX
     I              FLRWNB                          TBRWNB
     I              FLRXNB                          TBRXNB
     I              FLSQNB                          TBSQNB
     I              FLT0NB                          TBT0NB
     I              FLT1NB                          TBT1NB
     I              FLR1NB                          TBR1NB
     I              FLAIC3                          TBAIC3
     I              FLC4NB                          TBC4NB
     I              FLVCST                          TBVCST
     I              FLKEDT                          TBKEDT
     I              FLSXNB                          TBSXNB
     I              FLKFDT                          TBKFDT
     I              FLACTM                          TBACTM
     I              FLK5TX                          TBK5TX
     I              FLW5CD                          TBW5CD
     I              FLEJDT                          TBEJDT
     I              FLAGTM                          TBAGTM
     I              FLKJDT                          TBKJDT
     I              FLATTM                          TBATTM
     I              FLHDDT                          TBHDDT
     I              FLAUTM                          TBAUTM
     I              FLKKDT                          TBKKDT
     I              FLAVTM                          TBAVTM
     I              FLZ4NB                          TBZ4NB
     I              FLY7ST                          TBY7ST
     I              FLY2ST                          TBY2ST
     I              FLWHTX                          TBWHTX
     I              FLWITX                          TBWITX
     I              FLWJTX                          TBWJTX
     I              FLWKTX                          TBWKTX
     I              FLWLTX                          TBWLTX
     I              FLN7DT                          TBN7DT
     I              FLN8DT                          TBN8DT
     I              FLN9DT                          TBN9DT
     I              FLB3TM                          TBB3TM
     I              FLB4TM                          TBB4TM
     I              FLB5TM                          TBB5TM
     I              FLIASX                          TBIASX
     I              FLIBSX                          TBIBSX
     I              FLICSX                          TBICSX
     I              FLWVTX                          TBWVTX
     I              FLWWTX                          TBWWTX
     I              FLWXTX                          TBWXTX
     I              FLUVST                          TBUVST
     I              FLUWST                          TBUWST
     I              FLUXST                          TBUXST
     I              FLAATM                          TBAATM
     I              FLAYNA                          TBAYNA
     I              FLA0NA                          TBA0NA
     I              FLAXDT                          TBAXDT
      *
     I@DKCPRF
      * Load Freight Charge Ref   Retrieval index
      * Renamed input format fields
     I              DKRMNB                          TCRMNB
     I              DKCDAA                          TCCDAA
     I              DKEPNY                          TCEPNY
     I              DKIYAA                          TCIYAA
     I              DKKFTX                          TCKFTX
     I              DKKBNY                          TCKBNY
     I              DKNET1                          TCNET1
     I              DKAZST                          TCAZST
     I              DKVSST                          TCVSST
     I              DKMJDT                          TCMJDT
     I              DKBETM                          TCBETM
     I              DKCCVN                          TCCCVN
     I              DKCDVN                          TCCDVN
     I              DKMKDT                          TCMKDT
     I              DKBFTM                          TCBFTM
     I              DKCEVN                          TCCEVN
     I              DKCFVN                          TCCFVN
      *
     I@DKCPRE
      * Load Freight Charge Ref   Update index
      * Renamed input format fields
     I              DKRMNB                          TDRMNB
     I              DKCDAA                          TDCDAA
     I              DKEPNY                          TDEPNY
     I              DKIYAA                          TDIYAA
     I              DKKFTX                          TDKFTX
     I              DKKBNY                          TDKBNY
     I              DKNET1                          TDNET1
     I              DKAZST                          TDAZST
     I              DKVSST                          TDVSST
     I              DKMJDT                          TDMJDT
     I              DKBETM                          TDBETM
     I              DKCCVN                          TDCCVN
     I              DKCDVN                          TDCDVN
     I              DKMKDT                          TDMKDT
     I              DKBFTM                          TDBFTM
     I              DKCEVN                          TDCEVN
     I              DKCFVN                          TDCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOBC1    E DSPOBCCPL0
      * UPD : Load Freight Charge       Update index
      * Renamed input format fields
     I              BCRMNB                          WBRMNB
     I              BCCDAA                          WBCDAA
     I              BCEPNY                          WBEPNY
     I              BCC5VL                          WBC5VL
     I              BCKBSX                          WBKBSX
     I              BCCFAA                          WBCFAA
     I              BCKDSX                          WBKDSX
     I              BCKESX                          WBKESX
     I              BCKFSX                          WBKFSX
     I              BCKGSX                          WBKGSX
     I              BCKSSX                          WBKSSX
     I              BCKTSX                          WBKTSX
     I              BCKHSX                          WBKHSX
     I              BCKISX                          WBKISX
     I              BCKJSX                          WBKJSX
     I              BCEQNY                          WBEQNY
     I              BCVSST                          WBVSST
     I              BCMJDT                          WBMJDT
     I              BCBETM                          WBBETM
     I              BCCCVN                          WBCCVN
     I              BCCDVN                          WBCDVN
     I              BCMKDT                          WBMKDT
     I              BCBFTM                          WBBFTM
     I              BCCEVN                          WBCEVN
     I              BCCFVN                          WBCFVN
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMDK1    E DSPMDKCPL0
      * UPD : Load Freight Charge Ref   Update index
      * Renamed input format fields
     I              DKRMNB                          TDRMNB
     I              DKCDAA                          TDCDAA
     I              DKEPNY                          TDEPNY
     I              DKIYAA                          TDIYAA
     I              DKKFTX                          TDKFTX
     I              DKKBNY                          TDKBNY
     I              DKNET1                          TDNET1
     I              DKAZST                          TDAZST
     I              DKVSST                          TDVSST
     I              DKMJDT                          TDMJDT
     I              DKBETM                          TDBETM
     I              DKCCVN                          TDCCVN
     I              DKCDVN                          TDCDVN
     I              DKMKDT                          TDMKDT
     I              DKBFTM                          TDBFTM
     I              DKCEVN                          TDCEVN
     I              DKCFVN                          TDCFVN
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Scheduled Ship Date
     I                                    P   7  100P1AODT
      * I :  Load Status
     I                                       11  11 P1PKST
      * I :  Flat Amount
     I                                    P  12  172P1FLAM
      * I :  Total Stops
     I                                    P  18  200P1RRNB
      * I :  Carrier Code
     I                                       21  23 P1BZNA
      * I :  Load Type
     I                                       24  24 P1VDST
      * I :  Total Load Miles
     I                                    P  25  280P1TLMI
      * I :  Shipping Method
     I                                       29  30 P1Q2CD
      * I :  Ship From Warehouse
     I                                       31  33 P1VPCD
      * I :  Ship To State Code
     I                                       34  35 P1DBCD
      * I :  Export Status
     I                                       36  36 P1U2ST
      * I :  BOL Complete Date
     I                                    P  37  400P1J7DT
      * I :  Shipping Line
     I                                       41  43 P1XACD
      * I :  Discharge Port
     I                                       44  63 P1W4CD
      * I :  Load Shag Flag
     I                                       64  64 P1LSHG
      * I :  Load Wash Flag
     I                                       65  65 P1YPST
      * I :  Override Total Load Miles
     I                                    P  66  690P1K2DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1AODT    PARM           WP0003  70       Scheduled Ship
     C           P1PKST    PARM           WP0004  1        Load Status
     C           P1FLAM    PARM           WP0005 112       Flat Amount
     C           P1RRNB    PARM           WP0006  50       Total Stops
     C           P1BZNA    PARM           WP0007  3        Carrier Code
     C           P1VDST    PARM           WP0008  1        Load Type
     C           P1TLMI    PARM           WP0009  70       Total Load Mile
     C           P1Q2CD    PARM           WP0010  2        Shipping Method
     C           P1VPCD    PARM           WP0011  3        Ship From Wareh
     C           P1DBCD    PARM           WP0012  2        Ship To State C
     C           P1U2ST    PARM           WP0013  1        Export Status
     C           P1J7DT    PARM           WP0014  70       BOL Complete Da
     C           P1XACD    PARM           WP0015  3        Shipping Line
     C           P1W4CD    PARM           WP0016 20        Discharge Port
     C           P1LSHG    PARM           WP0017  1        Load Shag Flag
     C           P1YPST    PARM           WP0018  1        Load Wash Flag
     C           P1K2DT    PARM           WP0019  70       Override Total
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc Freight Charges   XF
      * Del Auto Frt Charges  RT - Load Freight Charge  * 
     C                     EXSR SARVGN
      * Clc Freight Charges   RT - Freight Charge  * 
     C                     EXSR SCRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Del Auto Frt Charges  RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA01           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSA01           Load ID
      * Establish starting position
     C           KRSSA     SETLL@BCCPJ8                    *
     C           KRSSA     READE@BCCPJ8                  90*
      * Data record not found
     C   90                MOVEL'USR3058' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LFC Create Status is Auto
     C           WAKDSX    IFEQ 'A'                        *IF
      * Del Load Freight Chrg DL - Load Freight Charge  * 
     C                     EXSR SBDLRC
     C                     END                             *FI
     C           KRSSA     READE@BCCPJ8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Del Load Freight Chrg DL - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BCCPJ7
     C                     Z-ADDWARMNB    WBRMNB           Load ID
     C                     MOVELWACDAA    WBCDAA           FC Code
     C                     Z-ADDWAEPNY    WBEPNY           LFC Sequence Nu
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBRMNB           Load ID
     C                     KFLD           WBCDAA           FC Code
     C                     KFLD           WBEPNY           LFC Sequence Nu
     C           KLDLSB    CHAIN@BCCPJ7              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POBCCPL0'MDACP
     C                     MOVEL'@BCCPJ7' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BCCPJ7                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Clc Freight Charges   RT - Freight Charge  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  72       FC Rate Amount
     C                     Z-ADD*ZERO     WN0002  72       LFC Amount
     C                     MOVEL*BLANK    WN0003  4        LFC Carrier Cod
     C                     Z-ADD*ZERO     WN0004  94       FCR Rate Amount
     C                     Z-ADD*ZERO     WN0005  94       Freight Rate US
     C                     MOVEL*BLANK    WN0006  1        Double Fuel Sur
     C                     MOVEL*BLANK    WN0007 20        Destination Cit
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Establish starting position
     C           *LOVAL    SETLL@A9REKD                    *
     C                     READ @A9REKD                  90*
      * Data record not found
     C   90                MOVEL'USR3052' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SDRVGN
      * SEL: Load Type
      * CASE: DB1.FC Load Type Select is Bulk/Regular
     C           WCJVSX    IFEQ 'B'                        *IF
     C           WCJVSX    OREQ 'R'
      * CASE: PAR.Load Type NE DB1.FC Load Type Select
     C           P1VDST    IFNE WCJVSX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Export Select
      * CASE: DB1.FC Export Select is Export
     C           WCJXSX    IFEQ 'E'                        *IF
      * CASE: PAR.Export Status is no
     C           P1U2ST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Export Select is Domestic
     C           WCJXSX    IFEQ 'D'                        *IF
      * CASE: PAR.Export Status is yes
     C           P1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Export Select is Not International
     C           WCJXSX    IFEQ 'N'                        *IF
      * CASE: PAR.Ship To State Code is International Accounts
     C           P1DBCD    IFEQ '.'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Export Select is International
     C           WCJXSX    IFEQ 'I'                        *IF
      * CASE: PAR.Ship To State Code is Not International
     C           P1DBCD    IFNE '.'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Ship To State
      * CASE: DB1.FC State Select is Yes
     C           WCJWSX    IFEQ 'Y'                        *IF
      * Clc State Charge      RT - Freight Charge State  * 
     C                     EXSR SERVGN
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0008  70       FCR Week Begin
      *
      * Rtv Fuel SurChrg Rate IF
      * Rtv Prior Sunday      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1AODT    WL0002           Post to G/L Dat
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WN0008           Date Sun USR
      * Rtv Frt Charge Rate   RT - Freight Charge Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'FUEL'    WL0004    P      FC Code
     C                     Z-ADDWN0008    WL0005           FCR Week Begin
     C                     MOVELP1VDST    WL0007    P      Load Type
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0003           FCR Rate Amount
      * CASE: LCL.FC Rate Amount is Not Entered
     C           YL0003    IFEQ 0                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Shag/Wash Select
      * CASE: DB1.FC Shag/Wash Select is Yes
     C           WCJYSX    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.FC Special Type is Shag
      *   |- c2    : PAR.Load Shag Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCKQSX    IFEQ 'H'                        *IF
     C           P1LSHG    IFEQ *BLANK                     *IF
     C           P1LSHG    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.FC Special Type is Wash
      *   |- c2    : PAR.Load Wash Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCKQSX    IFEQ 'W'                        *IF
     C           P1YPST    IFEQ *BLANK                     *IF
     C           P1YPST    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Effective Date
      * CASE: PAR.Scheduled Ship Date LT DB1.FC Auto Calc Effective
     C           P1AODT    IFLT WCOPDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL: Export Fresh/Frozen Select
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Export Status is yes
      *   |- c2    : PAR.Ship To State Code is International Accounts
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1U2ST    IFEQ 'Y'                        *IF
     C           P1DBCD    IFEQ '.'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.FC Fresh/Frozen Select is Fresh
     C           WCJ2SX    IFEQ '1'                        *IF
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0001    IFEQ 'FZ'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Fresh/Frozen Select is Frozen
     C           WCJ2SX    IFEQ '2'                        *IF
      * CASE: LCL.Warehouse Type is Fresh
     C           YL0001    IFEQ 'FR'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Transportation Mode
      * CASE: DB1.FC Trans Mode Select is Valid Values
     C           WCJ4SX    IFEQ 'R'                        *IF
     C           WCJ4SX    OREQ 'T'
     C                     MOVEL*BLANK    YL0004           Transportation
      * Transportation Mode DRV
     C                     Z-ADD1         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00002
     C           ZQ        ORGT 00002
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP1Q2CD:ZQ YL0004    P  90  Transportation
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * CASE: LCL.Transportation Mode DRV NE DB1.FC Trans Mode Select
     C           YL0004    IFNE WCJ4SX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Freight Rate Type Select
      * CASE: DB1.FC Freight Rate Type is Flat Rate
     C           WCJ6SX    IFEQ 'F'                        *IF
      * CASE: PAR.Flat Amount is EQ Zero
     C           P1FLAM    IFEQ 0                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Freight Rate Type is Rated by Mile/State
     C           WCJ6SX    IFEQ 'R'                        *IF
      * CASE: PAR.Flat Amount is GT Zero
     C           P1FLAM    IFGT 0                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Company
      * CASE: DB1.FC Company Select is Not All
     C           WCJ7SX    IFEQ 'X'                        *IF
     C           WCJ7SX    OREQ 'S'
      * Sel Company           RT - Freight Charge Company  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * SEL: Company Carrier
      * CASE: DB1.FC Company/Carrier Select is Not All
     C           WCJ8SX    IFEQ 'X'                        *IF
     C           WCJ8SX    OREQ 'S'
      * Sel Co/Carrier        RT - Freight Charge Co/Carrier  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      * Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WN0003           LFC Carrier Cod
     C                     MOVELP1BZNA    WN0003           LFC Carrier Cod
     C                     MOVEL'N'       WN0006           Double Fuel Sur
     C                     Z-ADDWCC3VL    WN0005           Freight Rate US
      * Fuel/Freight/Port/Pier/Terminal
      * CASE: DB1.FC Special Type is Fuel Base
     C           WCKQSX    IFEQ 'F'                        *IF
      * Use BOL Cmplt dt, if not there use Sched Ship Date as it was befo
      * CASE: PAR.BOL Complete Date is Entered
     C           P1J7DT    IFNE 0                          *IF
     C                     Z-ADDP1J7DT    WUAODT           Scheduled Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1AODT    WUAODT           Scheduled Ship
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0009  70       FCR Week Begin
      *
      * Rtv Fuel SurChrg Rate IF
      * Rtv Prior Sunday      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDWUAODT    WL0002           Post to G/L Dat
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WN0009           Date Sun USR
      * Rtv Frt Charge Rate   RT - Freight Charge Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWCCDAA    WL0004    P      FC Code
     C                     Z-ADDWN0009    WL0005           FCR Week Begin
     C                     MOVELP1VDST    WL0007    P      Load Type
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0005           FCR Rate Amount
      * RTV Last Stop Info    RT - Load Detail  * 
     C                     EXSR SKRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0007    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       YL0009           LOAD OUTPUT
      * Rtv double fuel surch RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1BZNA    WL0008    P      Carrier Code
     C                     MOVELP1VPCD    WL0009    P      Warehouse Code
     C                     MOVELYL0009    WL0010    P      Destination Cit
     C                     MOVELP1DBCD    WL0011    P      State Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    WN0006    P      Double Fuel Sur
      * Check for double fuel per State / State
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Rtv double fuel surch RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1BZNA    WL0008    P      Carrier Code
     C                     MOVELP1VPCD    WL0009    P      Warehouse Code
     C                     MOVELP1DBCD    WL0010    P      Destination Cit
     C                     MOVELP1DBCD    WL0011    P      State Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    WN0006    P      Double Fuel Sur
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Special Type is Ocean
     C           WCKQSX    IFEQ 'O'                        *IF
      * Rtv Destination Rates RT - Carrier Destination Rate  * 
     C                     EXSR SPRVGN
      * CASE: LCL.Warehouse Type is Fresh
     C           YL0001    IFEQ 'FR'                       *IF
     C                     Z-ADDYL0010    WN0005           Freight Rate US
     C                     ELSE
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0001    IFEQ 'FZ'                       *IF
     C                     Z-ADDYL0011    WN0005           Freight Rate US
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Special Type is Pier Pass
     C           WCKQSX    IFEQ 'P'                        *IF
      * Rtv Pier Pass Fee     RT - Order Header Extension  * 
     C                     EXSR SQRVGN
     C                     ELSE
      * CASE: DB1.FC Special Type is Port Check
     C           WCKQSX    IFEQ 'C'                        *IF
      * Rtv Port Check        RT - Order Header Extension  * 
     C                     EXSR SRRVGN
     C                     ELSE
      * CASE: DB1.FC Special Type is Terminal
     C           WCKQSX    IFEQ 'T'                        *IF
      * Rtv Terminal Fee      RT - Order Header Extension  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Use Override miles, if entered, else use Total Load Miles
      * CASE: PAR.Override Total Load Miles is Entered
     C           P1K2DT    IFNE 0                          *IF
     C                     Z-ADDP1K2DT    WUTLMI           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1TLMI    WUTLMI           Total Load Mile
     C                     END                             *FI
      * Clc Frt Charge UOM    IF
      * ** Pass either Override Total Load Miles or Total Load Miles
      * ** in the PAR.Total Load Miles field              E00207
      * CASE: PAR.FC Unit of Measure is Flat
     C           WCJUSX    IFEQ 'FL'                       *IF
      * Flat Amount
      * PAR.LFC Amount =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Freight Rate USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.1
     C           WN0005    MULT 1         W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0002           LFC Amount
     C                     ELSE
      * CASE: PAR.FC Unit of Measure is Mile
     C           WCJUSX    IFEQ 'ML'                       *IF
     C           WN0005    MULT WUTLMI    WN0002    H      LFC Amount
     C                     ELSE
      * CASE: PAR.FC Unit of Measure is Stop
     C           WCJUSX    IFEQ 'ST'                       *IF
      * Rtv Stop Charge Amt   RT - Carrier Freight Charge  * 
     C                     EXSR SURVGN
      * If Tiered stop charges not found
      * CASE: PAR.LFC Amount is Not Entered
     C           WN0002    IFEQ 0                          *IF
      * Amount by Stop
      * PAR.LFC Amount =
      *    *COMPUTE (x1 * (x2 - x3))
      * x1    : PAR.Freight Rate USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Total Stops
      * -     : PGM.*Synon (15,0) work field
      * x3    : CON.1
     C           P1RRNB    SUB  1         W0WJ01           *Synon (15,0) w
     C           WN0005    MULT W0WJ01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0002           LFC Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.FC Frt Add/Deduct is Deduct
     C           WCJ5SX    IFEQ 'D'                        *IF
     C                     MULT -1        WN0002           LFC Amount
     C                     END                             *FI
      * CASE: DB1.FC Special Type is Fuel Base
     C           WCKQSX    IFEQ 'F'                        *IF
      * TRF015 11/6/6 RMC Double charge if par.double is Yes
      * CASE: PAR.Double Fuel Surcharge Sts is Yes
     C           WN0006    IFEQ 'Y'                        *IF
     C                     MULT 2         WN0002           LFC Amount
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.LFC Amount is Entered
     C           WN0002    IFNE 0                          *IF
      * 02/29/08 PKD Replaced the CR with IF.
      * Crt Load Freight Chrg IF
      * Rtv Next Seq          RT - Load Freight Charge  * 
     C                     EXSR SVRVGN
      * Crt Load Freight Chrg CR - Load Freight Charge  * 
     C                     EXSR SWCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @A9REKD                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1VPCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Warehouse Type
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDWPST    YL0001           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Clc State Charge      RT - Freight Charge State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0002           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WECDAA    WQSE01           FC Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           FC Code
      * Setup key
     C                     MOVELWCCDAA    WQSE01           FC Code
      * Establish starting position
     C           KRSSE     SETLL@BAREJ5                    *
     C           KRSSE     READE@BAREJ5                  90*
      * Data record not found
     C   90                MOVEL'USR3054' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Clc State Charge      RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * CASE: PAR.Record Found USR is Record Found
     C           YL0002    IFEQ 'Y'                        *IF
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@BAREJ5                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Clc State Charge      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQSF02           Load ID
     C           *LIKE     DEFN WFDBCD    WQSF03           Ship To State C
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
     C                     KFLD           WQSF03           Ship To State C
      * Setup key
     C                     Z-ADDP1RMNB    WQSF02           Load ID
     C                     MOVELWEBGCD    WQSF03           Ship To State C
      * Establish starting position
     C           KRSSF     SETLL@BFCPKE                    *
     C           KRSSF     READE@BFCPKE                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0002           Record Found US
     C           KRSSF     READE@BFCPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Prior Sunday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WGBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
      * Setup key
     C                     Z-ADDWL0001    WQSG01           Company Number
     C                     Z-ADDWL0002    WGBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSG     SETLL@AFREPU                    *
     C           KRSSG     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Date Sun USR
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Sunday
     C           WGA9ST    IFEQ '1'                        *IF
     C                     Z-ADDWGBCDT    WL0003           Date Sun USR
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Frt Charge Rate   RT - Freight Charge Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHCDAA           FC Code
     C                     KFLD           WHONDT           FCR Week Begin
      * Setup key
     C                     MOVELWL0004    WHCDAA           FC Code
     C                     Z-ADDWL0005    WHONDT           FCR Week Begin
      * Establish starting position
     C           KRSSH     CHAIN@BBCPJ2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3056' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0006           FCR Rate Amount
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHC4VL    WL0006           FCR Rate Amount
     C                     Z-ADDWHC4VL    WL0006           FCR Rate Amount
      * CASE: PAR.Load Type is Bulk
     C           WL0007    IFEQ 'B'                        *IF
     C                     Z-ADDWHDKVL    WL0006           FCR Rate Amount
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Sel Company           RT - Freight Charge Company  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0005           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WICDAA    WQSI01           FC Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           FC Code
      * Setup key
     C                     MOVELWCCDAA    WQSI01           FC Code
      * Establish starting position
     C           KRSSI     SETLL@E4REAV                    *
     C           KRSSI     READE@E4REAV                  90*
      * Data record not found
     C   90                MOVEL'USR4103' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active/*blanks
     C           WIVSST    IFEQ *BLANK                     *IF
     C           WIVSST    OREQ 'A'
      * CASE: PAR.FC Company Select is All Except
     C           WCJ7SX    IFEQ 'X'                        *IF
      * CASE: PAR.Company Number EQ DB1.Company Number
     C           P1AIC3    IFEQ WIAIC3                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.FC Company Select is Only Selected
     C           WCJ7SX    IFEQ 'S'                        *IF
      * CASE: PAR.Company Number EQ DB1.Company Number
     C           P1AIC3    IFEQ WIAIC3                     *IF
     C                     MOVEL'Y'       YL0005           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@E4REAV                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.FC Company Select is Only Selected
     C           WCJ7SX    IFEQ 'S'                        *IF
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0005    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Sel Co/Carrier        RT - Freight Charge Co/Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0006           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJCDAA    WQSJ01           FC Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           FC Code
      * Setup key
     C                     MOVELWCCDAA    WQSJ01           FC Code
      * Establish starting position
     C           KRSSJ     SETLL@E5REAS                    *
     C           KRSSJ     READE@E5REAS                  90*
      * Data record not found
     C   90                MOVEL'USR4105' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active/*blanks
     C           WJVSST    IFEQ *BLANK                     *IF
     C           WJVSST    OREQ 'A'
      * CASE: PAR.FC Carrier Select is All Except
     C           WCJ8SX    IFEQ 'X'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ DB1.Carrier Code
      *   |- c2    : PAR.Company Number EQ DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BZNA    IFEQ WJBZNA                     *IF
     C           P1AIC3    IFEQ WJAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.FC Carrier Select is Only Selected
     C           WCJ8SX    IFEQ 'S'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ DB1.Carrier Code
      *   |- c2    : PAR.Company Number EQ DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BZNA    IFEQ WJBZNA                     *IF
     C           P1AIC3    IFEQ WJAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@E5REAS                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.FC Carrier Select is Only Selected
     C           WCJ8SX    IFEQ 'S'                        *IF
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0006    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Last Stop Info    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQSK02           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSK02           Load ID
      * Establish starting position
     C           KRSSK     SETLL@FLCPE8                    *
     C           KRSSK     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Last Stop Info     RT - Order Header TRG  * 
     C                     EXSR SLRVGN
      * RTV Salesman Code      RT - Sales Route  * 
     C                     EXSR SMRVGN
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SNRVGN
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Last Stop Info     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
      * Setup key
     C                     Z-ADDWKAIC3    WLAIC3           Company Number
     C                     Z-ADDWKC4NB    WLC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLHNNA    WN0007           Ship To City
     C                     MOVELWLBCNA    WUG0TX           Customer Purcha
     C                     MOVELWLB6NA    WUG0TX           Special Instruc
     C                     MOVELWLBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWLEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWLAFTM    WUNFNN           Requested Deliv
     C                     MOVELWLR4CD    YL0007           Sales Route Cod
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WMR4CD           Sales Route Cod
      * Setup key
     C                     MOVELYL0007    WMR4CD           Sales Route Cod
      * Establish starting position
     C           KRSSM     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           Salesperson Cod
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBCCD    YL0008           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WOBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0008    WOBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSN     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           Salesperson Cod
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOBCCD    YL0008           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv double fuel surch RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WRBZNA           Carrier Code
     C                     KFLD           WRAJCD           Warehouse Code
     C                     KFLD           WRXECD           Destination Cit
     C                     KFLD           WRBGCD           State Code
      * Setup key
     C                     MOVELWL0008    WRBZNA           Carrier Code
     C                     MOVELWL0009    WRAJCD           Warehouse Code
     C                     MOVELWL0010    WRXECD           Destination Cit
     C                     MOVELWL0011    WRBGCD           State Code
      * Establish starting position
     C           KRSSO     CHAIN@LECPM7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2455' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0012           Double Fuel Sur
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRLUSX    WL0012           Double Fuel Sur
     C                     GOTO SOEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Destination Rates RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WRBZNA           Carrier Code
     C                     KFLD           WRAJCD           Warehouse Code
     C                     KFLD           WRXECD           Destination Cit
     C                     KFLD           WRBGCD           State Code
      * Setup key
     C                     MOVELP1XACD    WRBZNA           Carrier Code
     C                     MOVELP1VPCD    WRAJCD           Warehouse Code
     C                     MOVELP1W4CD    WRXECD           Destination Cit
     C                     MOVELP1DBCD    WRBGCD           State Code
      * Establish starting position
     C           KRSSP     CHAIN@LECPM7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2455' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0010           Export Fresh Fl
     C                     Z-ADD*ZERO     YL0011           Export Frozen F
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWREQPR    YL0010           Export Fresh Fl
     C                     Z-ADDWRERPR    YL0011           Export Frozen F
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Pier Pass Fee     RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0005           OHE Pier Pass F
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQSQ01           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSQ01           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@AMREJM                    *
     C           KRSSQ     READE@AMREJM                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WSP8NY    WN0005           OHE Pier Pass F
     C           KRSSQ     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Port Check        RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0005           OHE Port Check
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQSR01           Load ID
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSR01           Load ID
      * Establish starting position
     C           KRSSR     SETLL@AMREJM                    *
     C           KRSSR     READE@AMREJM                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WSP9NY    WN0005           OHE Port Check
     C           KRSSR     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Terminal Fee      RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0005           Transload Termi
     C                     MOVEL*BLANK    WN0003           Transloader Car
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQSS01           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSS01           Load ID
      * Establish starting position
     C           KRSSS     SETLL@AMREJM                    *
     C           KRSSS     READE@AMREJM                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WSHGVL    WN0005           Transload Termi
      * Rtv Transload Carrier RT - Load Header  * 
     C                     EXSR STRVGN
     C           KRSSS     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Transload Carrier RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WTRMNB           Load ID
      * Setup key
     C                     Z-ADDWSRMNB    WTRMNB           Load ID
      * Establish starting position
     C           KRSST     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0003           Transloader Car
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTDYTX    WN0003           Transloader Car
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Stop Charge Amt   RT - Carrier Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0002           Stop Charge USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVBZNA    WQSU01           Carrier Code
     C           *LIKE     DEFN WVG7AA    WQSU02           CFC Freight Cha
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Carrier Code
     C                     KFLD           WQSU02           CFC Freight Cha
     C                     KFLD           WVQODT           CFC Effective D
     C                     KFLD           WVFDNY           CFC Line/Stop N
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Carrier Code
     C                     KFLD           WQSU02           CFC Freight Cha
      * Setup key
     C                     MOVELP1BZNA    WQSU01           Carrier Code
     C                     MOVE *BLANK    WQSU02           CFC Freight Cha
     C                     MOVEL'STOP'    WQSU02           CFC Freight Cha
     C                     Z-ADD##JDT     WVQODT           CFC Effective D
     C                     Z-ADD0         WVFDNY           CFC Line/Stop N
      * Establish starting position
     C           KPSSU     SETLL@ABREHD                    *
     C           KRSSU     READE@ABREHD                  90*
      * Data record not found
     C   90                MOVEL'USR3652' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First time - save effective date to only read those records
      * CASE: LCL.CFC Effective Date is not entered
     C           YL0012    IFEQ 0                          *IF
     C                     Z-ADDWVQODT    YL0012           CFC Effective D
     C                     END                             *FI
      * Calc if ...
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.CFC Effective Date NE LCL.CFC Effective Date
      *   |- c2    : PAR.Total Stops is One Stop
      *   '-
     C           WVQODT    IFNE YL0012                     *IF
     C           P1RRNB    OREQ 1                          *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WVFDNY    ADD  1         YL0013           CFC Line/Stop N
      * CASE: LCL.CFC Line/Stop Number LE PAR.Total Stops
     C           YL0013    IFLE P1RRNB                     *IF
     C                     ADD  WVFENY    WN0002           Stop Charge USR
     C                     Z-ADDWVFENY    YL0014           CFC Charge Amou
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSU     READE@ABREHD                  90*
     C                     ENDDO
      * USER: Exit processing
      * If total stops exceeds Tiered stop charges, use the last charge f
      *  the remaining stops
      * CASE: PAR.Total Stops GT LCL.CFC Line/Stop Number
     C           P1RRNB    IFGT YL0013                     *IF
     C           P1RRNB    SUB  YL0013    YL0015           Total Stops
     C           YL0015    MULT YL0014    WUFGNY           Stop Charge USR
     C                     ADD  WUFGNY    WN0002           Stop Charge USR
     C                     END                             *FI
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Next Seq          RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQSV01           Load ID
     C           *LIKE     DEFN WWCDAA    WQSV02           FC Code
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Load ID
     C                     KFLD           WQSV02           FC Code
      * Setup key
     C                     Z-ADDP1RMNB    WQSV01           Load ID
     C                     MOVELWCCDAA    WQSV02           FC Code
      * Establish starting position
     C           KRSSV     SETLL@BCCPRK                    *
     C           KRSSV     READE@BCCPRK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3058' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUEPNY           LFC Sequence Nu
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WWEPNY    ADD  1         WUEPNY           LFC Sequence Nu
     C                     GOTO SVEXIT                     *QUIT
     C           KRSSV     READE@BCCPRK                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Crt Load Freight Chrg CR - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCCPJ7
     C                     Z-ADDP1RMNB    WBRMNB           Load ID
     C                     MOVELWCCDAA    WBCDAA           FC Code
     C                     Z-ADDWUEPNY    WBEPNY           LFC Sequence Nu
     C                     Z-ADDWN0002    WBC5VL           LFC Amount
     C                     MOVELWCJZSX    WBKBSX           LFC Act Frt Inc
     C                     MOVELWN0003    WBCFAA           LFC Carrier Cod
     C                     MOVEL'A'       WBKDSX           LFC Create Stat
     C                     MOVEL*BLANK    WBKESX           LFC Unused Sts
     C                     MOVELWCJ0SX    WBKFSX           LFC Charge Cate
     C                     MOVELWCJ1SX    WBKGSX           LFC Shag/Wash C
     C                     MOVELWCKPSX    WBKSSX           LFC Tot Freight
     C                     MOVELWCKQSX    WBKTSX           LFC Special Typ
     C                     MOVELWUKHSX    WBKHSX           LFC TFP Process
     C                     MOVELWCJ3SX    WBKISX           LFC Reference R
     C                     MOVELWUKJSX    WBKJSX           LFC Unused Sts
     C                     Z-ADD0         WBEQNY           LFC TFP Carrier
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD0         WBMJDT           Create Date
     C                     Z-ADD0         WBBETM           Create Time
     C                     MOVEL*BLANK    WBCCVN           Create User
     C                     MOVEL*BLANK    WBCDVN           Create Program
     C                     Z-ADD0         WBMKDT           Change Date
     C                     Z-ADD0         WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WBVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WBMJDT           Create Date
     C                     Z-ADD##JTM     WBBETM           Create Time
     C                     MOVEL##USR     WBCCVN           Create User
     C                     MOVEL##PGM     WBCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WBMKDT           Change Date
     C                     Z-ADD0         WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
     C           KLCRSW    KLIST
     C                     KFLD           WBRMNB           Load ID
     C                     KFLD           WBCDAA           FC Code
     C                     KFLD           WBEPNY           LFC Sequence Nu
      * Check for duplicate primary key
     C           KLCRSW    SETLL@BCCPJ7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3059' W0RTN   7
      * Send message 'Load Freight Charge    EX'
     C                     MOVEL'USR3059' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@BCCPJ7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: PAR.LFC Reference Required is Yes
     C           WCJ3SX    IFEQ 'Y'                        *IF
      * Crt Ld Frt Chrg Ref   RT - Freight Charge Reference  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Crt Ld Frt Chrg Ref   RT - Freight Charge Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXCDAA    WQSX01           FC Code
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           FC Code
      * Setup key
     C                     MOVELWBCDAA    WQSX01           FC Code
      * Establish starting position
     C           KRSSX     SETLL@DJREYA                    *
     C           KRSSX     READE@DJREYA                  90*
      * Data record not found
     C   90                MOVEL'USR3891' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WXVSST    IFEQ 'A'                        *IF
      * Rtv Charge Info       RT - Charge Reference  * 
     C                     EXSR SYRVGN
     C                     Z-ADD0         YL0017           LFCR Numeric Va
      * CASE: DB1.CR Reference Code is Company
     C           WXIYAA    IFEQ @CN,002                    *IF
      * Rtv Frt Charge Info   RT - Freight Charge  * 
     C                     EXSR SZRVGN
      * CASE: LCL.FC Unused Sts 9 is Shared
     C           YL0018    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
     C                     EXSR TARVGN
      * CASE: LCL.Multi Company Load is no
     C           YL0020    IFEQ 'N'                        *IF
     C                     Z-ADDYL0019    YL0017           LFCR Numeric Va
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Ld Frt Chrg Ref   RT - Load Freight Charge Ref  * 
     C                     EXSR TBRVGN
     C                     END                             *FI
     C           KRSSX     READE@DJREYA                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Charge Info       RT - Charge Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WYIYAA           CR Reference Co
      * Setup key
     C                     MOVELWXIYAA    WYIYAA           CR Reference Co
      * Establish starting position
     C           KRSSY     CHAIN@DIREQ5              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3889' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0016           CR Value Type
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWYKCTX    YL0016           CR Value Type
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Frt Charge Info   RT - Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           TACDAA           FC Code
      * Setup key
     C                     MOVELWXCDAA    TACDAA           FC Code
      * Establish starting position
     C           KRSSZ     CHAIN@A9REJZ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3052' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0018           FC Shared Respo
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTAJ9SX    YL0018           FC Shared Respo
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0020           Multi Company L
     C                     Z-ADD0         YL0019           Company Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN TBRMNB    WQTA01           Load ID
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQTA01           Load ID
      * Establish starting position
     C           KRSTA     SETLL@FLCPBW                    *
     C           KRSTA     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Company Number is Equal to zero
     C           YL0019    IFEQ 0                          *IF
     C                     Z-ADDTBAIC3    YL0019           Company Number
     C                     END                             *FI
      * CASE: PAR.Company Number NE DB1.Company Number
     C           YL0019    IFNE TBAIC3                     *IF
     C                     MOVEL'Y'       YL0020           Multi Company L
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Crt Ld Frt Chrg Ref   RT - Load Freight Charge Ref  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0010 40        LFCR Alpha Valu
     C                     MOVEL*BLANK    WN0011  1        Record Status
     C                     Z-ADD*ZERO     WN0012  70       Create Date
     C                     Z-ADD*ZERO     WN0013  60       Create Time
     C                     MOVEL*BLANK    WN0014 10        Create User
     C                     MOVEL*BLANK    WN0015 10        Create Program
     C                     Z-ADD*ZERO     WN0016  70       Change Date
     C                     Z-ADD*ZERO     WN0017  60       Change Time
     C                     MOVEL*BLANK    WN0018 10        Change User
     C                     MOVEL*BLANK    WN0019 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           TCRMNB           Load ID
     C                     KFLD           TCCDAA           FC Code
     C                     KFLD           TCEPNY           LFC Sequence Nu
     C                     KFLD           TCIYAA           CR Reference Co
      * Setup key
     C                     Z-ADDWBRMNB    TCRMNB           Load ID
     C                     MOVELWBCDAA    TCCDAA           FC Code
     C                     Z-ADDWBEPNY    TCEPNY           LFC Sequence Nu
     C                     MOVELWXIYAA    TCIYAA           CR Reference Co
      * Establish starting position
     C           KRSTB     CHAIN@DKCPRF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3893' W0RTN   7
      * USER: Processing if Data record not found
      * Crt LD Frt Chrg Ref   CR - Load Freight Charge Ref  * 
     C                     EXSR TCCRRC
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Crt LD Frt Chrg Ref   CR - Load Freight Charge Ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DKCPRE
     C                     Z-ADDWBRMNB    TDRMNB           Load ID
     C                     MOVELWBCDAA    TDCDAA           FC Code
     C                     Z-ADDWBEPNY    TDEPNY           LFC Sequence Nu
     C                     MOVELWXIYAA    TDIYAA           CR Reference Co
     C                     MOVELYL0016    TDKFTX           LFCR Value Type
     C                     Z-ADDYL0017    TDKBNY           LFCR Numeric Va
     C                     MOVELWN0010    TDNET1           LFCR Alpha Valu
     C                     MOVELWXAYST    TDAZST           LFCR Reference
     C                     MOVELWN0011    TDVSST           Record Status
     C                     Z-ADDWN0012    TDMJDT           Create Date
     C                     Z-ADDWN0013    TDBETM           Create Time
     C                     MOVELWN0014    TDCCVN           Create User
     C                     MOVELWN0015    TDCDVN           Create Program
     C                     Z-ADDWN0016    TDMKDT           Change Date
     C                     Z-ADDWN0017    TDBFTM           Change Time
     C                     MOVELWN0018    TDCEVN           Change User
     C                     MOVELWN0019    TDCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       TDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     TDMJDT           Create Date
     C                     Z-ADD##JTM     TDBETM           Create Time
     C                     MOVEL##USR     TDCCVN           Create User
     C                     MOVEL##PGM     TDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         TDMKDT           Change Date
     C                     Z-ADD0         TDBFTM           Change Time
     C                     MOVEL*BLANK    TDCEVN           Change User
     C                     MOVEL*BLANK    TDCFVN           Change Program
     C           KLCRTC    KLIST
     C                     KFLD           TDRMNB           Load ID
     C                     KFLD           TDCDAA           FC Code
     C                     KFLD           TDEPNY           LFC Sequence Nu
     C                     KFLD           TDIYAA           CR Reference Co
      * Check for duplicate primary key
     C           KLCRTC    SETLL@DKCPRE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3894' W0RTN   7
      * Send message 'Load Freight Charge Re EX'
     C                     MOVEL'USR3894' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@DKCPRE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 10/10/2011 LJB E001755
      * ** Transload Terminal Fees was added as a new parm
      * ** Changed Terminal Fees from 5.0 to 11.2 field
      * ** 09/08/2011 Purva
      * ** Added Pier Pass, Port Check, and Terminal fees calcs.
      * ** 08/12/2008 LJB E00207
      * ** Override Total Load Miles was added as a new parm
      * ** Use override in Clc Frt Charge UOM IF, instead of total ld mil
      * ** 08/04/2006 LJB A005-T025
      * ** Retrieve the next seq# for this freight charge code
      * ** 11/06/2006 RMC TRF015
      * ** If FUEL, check carrier for double fuel flag to double the char
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAEPNY           LFC Sequence Nu
     C                     Z-ADD*ZERO     WAC5VL           LFC Amount
     C                     Z-ADD*ZERO     WAEQNY           LFC TFP Carrier
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCC3VL           FC Rate Amount
     C                     Z-ADD*ZERO     WCOPDT           FC Auto Calc Ef
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A/R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WFNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WFNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WFNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WFNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WFBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WFBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WGCQNB           Julian Date
     C                     Z-ADD*ZERO     WGESNB           Accounting Year
     C                     Z-ADD*ZERO     WGETNB           Accounting Peri
     C                     Z-ADD*ZERO     WGBZNB           OM Week
     C                     Z-ADD*ZERO     WGEINB           Week Number
     C                     Z-ADD*ZERO     WGAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WGOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WGNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WGNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WGOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WGOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHONDT           FCR Week Begin
     C                     Z-ADD*ZERO     WHC4VL           FCR Rate Amount
     C                     Z-ADD*ZERO     WHDNVL           FCR Doe Nationa
     C                     Z-ADD*ZERO     WHDKVL           FCR Rate Amount
     C                     Z-ADD*ZERO     WHDLVL           FCR Unused Amt
     C                     Z-ADD*ZERO     WHDMVL           FCR Unused Amt
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIMJDT           Create Date
     C                     Z-ADD*ZERO     WIBETM           Create Time
     C                     Z-ADD*ZERO     WIMKDT           Change Date
     C                     Z-ADD*ZERO     WIBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WKRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WKRWNB           Miles to next s
     C                     Z-ADD*ZERO     WKRXNB           Freight Charge
     C                     Z-ADD*ZERO     WKSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WKT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WKT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WKSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WKKFDT           Appointment Con
     C                     Z-ADD*ZERO     WKACTM           Appointment Con
     C                     Z-ADD*ZERO     WKEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WKAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WKKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WKATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WKHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WKAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WKKKDT           On Yard Date
     C                     Z-ADD*ZERO     WKAVTM           On Yard Time
     C                     Z-ADD*ZERO     WKZ4NB           MPC Number
     C                     Z-ADD*ZERO     WKN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WKN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WKN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WKB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WKB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WKB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRNMVA           Flat Rate
     C                     Z-ADD*ZERO     WREPPR           Bulk Rate
     C                     Z-ADD*ZERO     WREQPR           Export Fresh Fl
     C                     Z-ADD*ZERO     WRERPR           Export Frozen F
     C                     Z-ADD*ZERO     WROQDT           CDR Unused Date
     C                     Z-ADD*ZERO     WRORDT           CDR Unused Date
     C                     Z-ADD*ZERO     WRGXVL           CDR Unused Amou
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSC4NB           Order Number
     C                     Z-ADD*ZERO     WSRMNB           Load ID
     C                     Z-ADD*ZERO     WSRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WSQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WSQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WSQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WSGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WSHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WSHGVL           Transload Termi
     C                     Z-ADD*ZERO     WSQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WSQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WSQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WSQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WSITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WSQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WSQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WSQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WSP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WSQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WSQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WSQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WSQENY           Original Appoin
     C                     Z-ADD*ZERO     WSQFNY           Original Appoin
     C                     Z-ADD*ZERO     WSQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WSQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WSQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WSQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WSW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WSW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTRMNB           Load ID
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WTRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WTRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WTFLAM           Flat Amount
     C                     Z-ADD*ZERO     WTRRNB           Total Stops
     C                     Z-ADD*ZERO     WTSBNB           BOL Time
     C                     Z-ADD*ZERO     WTSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WTR1NB           Rated Freight
     C                     Z-ADD*ZERO     WTSDNB           Number Pallets
     C                     Z-ADD*ZERO     WTPAOU           Number Pallets
     C                     Z-ADD*ZERO     WTDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WTSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WTHADT           Actual Arrival
     C                     Z-ADD*ZERO     WTAART           Actual Arrival
     C                     Z-ADD*ZERO     WTDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WTDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WTAQDT           Actual Departur
     C                     Z-ADD*ZERO     WTS6NB           Departure Time
     C                     Z-ADD*ZERO     WTT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WTPRTM           Product Tempera
     C                     Z-ADD*ZERO     WTNPSV           Number Spacers
     C                     Z-ADD*ZERO     WTTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WTGRWE           Gross Weight
     C                     Z-ADD*ZERO     WTF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WTJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WTTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WTJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WTSPTM           Spotted Time
     C                     Z-ADD*ZERO     WTJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WTLFTM           Load Finished T
     C                     Z-ADD*ZERO     WTJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WTBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WTJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WTBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WTKIDT           Truck Departure
     C                     Z-ADD*ZERO     WTASTM           Truck Departure
     C                     Z-ADD*ZERO     WTKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WTAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WTVOAG           Voyage
     C                     Z-ADD*ZERO     WTKBDT           Sail Date
     C                     Z-ADD*ZERO     WTEFDT           Arrival Date
     C                     Z-ADD*ZERO     WTKCDT           Date In
     C                     Z-ADD*ZERO     WTTMIN           Time In
     C                     Z-ADD*ZERO     WTKDDT           Date Out
     C                     Z-ADD*ZERO     WTVMNB           Time Out
     C                     Z-ADD*ZERO     WTOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WTKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WTATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WTBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WTEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WTKKDT           On Yard Date
     C                     Z-ADD*ZERO     WTAVTM           On Yard Time
     C                     Z-ADD*ZERO     WTKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WTAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WTLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WTK0DT           Product Complet
     C                     Z-ADD*ZERO     WTAYTM           Product Complet
     C                     Z-ADD*ZERO     WTKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WTICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WTIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WTK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WTAZTM           Load Door 1
     C                     Z-ADD*ZERO     WTK2DT           Override Total
     C                     Z-ADD*ZERO     WTA0TM           Load Door 2
     C                     Z-ADD*ZERO     WTZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WTPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WTCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WTPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WTCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WTP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WTCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WTP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WTCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WTP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WTCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WTP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WTCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVFDNY           CFC Line/Stop N
     C                     Z-ADD*ZERO     WVFENY           CFC Charge Amou
     C                     Z-ADD*ZERO     WVQODT           CFC Effective D
     C                     Z-ADD*ZERO     WVFFNY           CFC Unused Amou
     C                     Z-ADD*ZERO     WVMJDT           Create Date
     C                     Z-ADD*ZERO     WVBETM           Create Time
     C                     Z-ADD*ZERO     WVMKDT           Change Date
     C                     Z-ADD*ZERO     WVBFTM           Change Time
      * Define work field Stop Charge USR
     C                     Z-ADD*ZERO     WUFGNY  72
      * Define work field LFC Sequence Number
     C                     Z-ADD*ZERO     WUEPNY  30
      * Define work field LFC TFP Processed
     C                     MOVEL*BLANK    WUKHSX  1
      * Define work field LFC Unused Sts 5
     C                     MOVEL*BLANK    WUKJSX  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXMJDT           Create Date
     C                     Z-ADD*ZERO     WXBETM           Create Time
     C                     Z-ADD*ZERO     WXMKDT           Change Date
     C                     Z-ADD*ZERO     WXBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYMJDT           Create Date
     C                     Z-ADD*ZERO     WYBETM           Create Time
     C                     Z-ADD*ZERO     WYMKDT           Change Date
     C                     Z-ADD*ZERO     WYBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCRMNB           Load ID
     C                     Z-ADD*ZERO     TCEPNY           LFC Sequence Nu
     C                     Z-ADD*ZERO     TCKBNY           LFCR Numeric Va
     C                     Z-ADD*ZERO     TCMJDT           Create Date
     C                     Z-ADD*ZERO     TCBETM           Create Time
     C                     Z-ADD*ZERO     TCMKDT           Change Date
     C                     Z-ADD*ZERO     TCBFTM           Change Time
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0004  6
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  94
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010 20
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012  1
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field FC Rate Amount
     C                     Z-ADD*ZERO     YL0003  72
      * Define local work field Transportation Mode DRV
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0007 11
      * Define null work field Salesperson Name
     C                     MOVEL*BLANK    YN0008 30
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Destination City
     C                     MOVEL*BLANK    YL0009 20
      * Define null work field Flat Rate
     C                     Z-ADD*ZERO     YN0009 112
      * Define null work field CDR Unit of Measure
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Bulk Rate
     C                     Z-ADD*ZERO     YN0011 114
      * Define local work field Export Fresh Flat Amt
     C                     Z-ADD*ZERO     YL0010 114
      * Define local work field Export Frozen Flat Amt
     C                     Z-ADD*ZERO     YL0011 114
      * Define null work field Double Fuel Surcharge Sts
     C                     MOVEL*BLANK    YN0012  1
      * Define local work field CFC Effective Date
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field CFC Line/Stop Number
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field CFC Charge Amount
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field Total Stops
     C                     Z-ADD*ZERO     YL0015  50
      * Define null work field CR Reference Desc
     C                     MOVEL*BLANK    YN0013 30
      * Define local work field CR Value Type
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field LFCR Numeric Value
     C                     Z-ADD*ZERO     YL0017 155
      * Define null work field FC Description
     C                     MOVEL*BLANK    YN0014 30
      * Define null work field FC Rate Amount
     C                     Z-ADD*ZERO     YN0015  72
      * Define null work field FC Unit of Measure
     C                     MOVEL*BLANK    YN0016  2
      * Define null work field FC Act Frt Include Sts
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field FC Frt Add/Deduct
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field FC Load Type Select
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field FC State Select
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field FC Export Select
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field FC Shag/Wash Select
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field FC Auto Calc Sts
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field FC Charge Category
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field FC Shag/Wash Comp
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field FC Edit Sequence
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field FC Tot Freight Inc Sts
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field FC Special Type
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field FC ExpInt FR/FZ Select
     C                     MOVEL*BLANK    YN0029  1
      * Define null work field FC Reference Required
     C                     MOVEL*BLANK    YN0030  1
      * Define null work field FC Trans Mode Select
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field FC Freight Rate Type Sel
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field FC Company Select
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field FC Company/Carrier Select
     C                     MOVEL*BLANK    YN0034  1
      * Define local work field FC Shared Responsibility
     C                     MOVEL*BLANK    YL0018  1
      * Define null work field FC Unused Sts 10
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field FC Auto Calc Effective
     C                     Z-ADD*ZERO     YN0036  70
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0037  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0019  30
      * Define local work field Multi Company Load
     C                     MOVEL*BLANK    YL0020  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 COMPNY
