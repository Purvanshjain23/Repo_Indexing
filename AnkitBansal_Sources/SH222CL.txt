/*                                                                     */
/*  PROGRAM NUMBER --> SH222CL                                         */
/*  PROGRAM NAME ----> DATAMART SALES: FRESH TO FROZEN REWORK          */
/*  PROGRAMMER ------> LEANNE RAMSEY                                   */
/*  DATE ------------> 03/26/14                                        */
/*                                                                     */
/*  This is for PORK only....no Dailys.                                */
/*  We will run this every morning at 4:00am.                          */
/*                                                                     */
/***********************************************************************/
/*  MODIFIED:                                                          */
/*                                                                     */
/***********************************************************************/

             PGM

             DCL        VAR(&ERR)      TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&EMAIL)    TYPE(*CHAR) LEN(38)
             DCL        VAR(&TSTPRDFL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&SUBJECT)  TYPE(*CHAR) LEN(60) +
                          VALUE('SH222CL-Build Fresh-to-Frozen +
                          .........DIST LIST: prk cognos')


/*------------------------------------------------------------------*/
/* Set up the Email Recipient (either Test or Production)           */
/*------------------------------------------------------------------*/

/* Retrieve the Data Area that lets us know whether we are in TEST  */
/* or PRODUCTION. (Always default to the 'TEST' Distribution List.) */

             CHGVAR     VAR(&EMAIL) VALUE('prk cognos test')
             RTVDTAARA  DTAARA(DATSTPRD (1 1)) RTNVAR(&TSTPRDFL)
             IF         COND(&TSTPRDFL *EQ 'P') THEN(CHGVAR +
                          VAR(&EMAIL) VALUE('prk cognos'))


/*-----------------------------------------------------------------*/
/* Add PRKDMFLIB to the top of the library list.                   */
/* We do not expect PRKDMFLIB to already be in the library list;   */
/* but, since we want it at the top of the list, we will remove/add*/
/* it.                                                             */
/*-----------------------------------------------------------------*/
             RMVLIBLE   LIB(PRKDMFLIB)
             MONMSG     MSGID(CPF0000)
             ADDLIBLE   LIB(PRKDMFLIB)

/*------------------------------------------------------------------*/
/*  CALL THE PROGRAM                                                */
/*------------------------------------------------------------------*/

             CALL       PGM(SH222)

             RGZPFM     FILE(*LIBL/SHP222)
             MONMSG     MSGID(CPF0000)

/*---------------------------------------------------------------------*/
/* SEND COMPLETION MESSAGE TO I.S. FOLKS                               */
/*---------------------------------------------------------------------*/
/* We are currently not monitoring for any errors. So, &ERR will       */
/* always be No.                                                       */

             IF         COND(&ERR = 'N') THEN(ESNDMAIL +
                          RECIPIENT(&EMAIL) SUBJECT(&SUBJECT) +
                          MSG('The Fresh-To-Frozen Transaction data +
                          was successfully built in PRKDMFLIB; the +
                          build completed normally.') +
                          IMPORTANCE(*HIGH))

             ENDPGM

