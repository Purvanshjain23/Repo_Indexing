     H/TITLE Fix Trans Partner     XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 08/06/10  Time  : 17:11:34
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMDACPL1IF  E           K        DISK
      * RTV : COA Batch Header RIN      Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FPMDACPL0UF  E           K        DISK
      * UPD : COA Batch Header RIN      Update index
      *
     I@DACPP6
      * COA Batch Header RIN      Retrieval index
      * Renamed input format fields
     I              DAAIC3                          WAAIC3
     I              DAL6T1                          WAL6T1
     I              DAI3NY                          WAI3NY
     I              DAJYNY                          WAJYNY
     I              DAQ1NY                          WAQ1NY
     I              DAMUT1                          WAMUT1
     I              DAJZNY                          WAJZNY
     I              DAJ0NY                          WAJ0NY
     I              DAJ2NY                          WAJ2NY
     I              DARIDT                          WARIDT
     I              DAC5TM                          WAC5TM
     I              DAMVT1                          WAMVT1
     I              DAMWT1                          WAMWT1
     I              DARINT                          WARINT
     I              DARJDT                          WARJDT
     I              DAC6TM                          WAC6TM
     I              DAC4NB                          WAC4NB
     I              DADPNB                          WADPNB
     I              DAUENB                          WAUENB
     I              DARZNB                          WARZNB
     I              DANGT1                          WANGT1
     I              DARMNB                          WARMNB
     I              DARKDT                          WARKDT
     I              DAC7TM                          WAC7TM
     I              DARINS                          WARINS
     I              DAMXT1                          WAMXT1
     I              DAG3ST                          WAG3ST
     I              DAQWNY                          WAQWNY
     I              DAL0AA                          WAL0AA
     I              DAMAT1                          WAMAT1
     I              DATDNA                          WATDNA
     I              DACWC3                          WACWC3
     I              DAQXNY                          WAQXNY
     I              DAQZNY                          WAQZNY
     I              DAQ0NY                          WAQ0NY
     I              DALVTX                          WALVTX
     I              DANYT1                          WANYT1
     I              DAG5ST                          WAG5ST
     I              DAG7ST                          WAG7ST
     I              DATFDT                          WATFDT
     I              DATGDT                          WATGDT
     I              DAWIT1                          WAWIT1
     I              DAQYNY                          WAQYNY
     I              DAL7T1                          WAL7T1
     I              DAR8NY                          WAR8NY
     I              DAR0NY                          WAR0NY
     I              DAI7AA                          WAI7AA
     I              DAMXAA                          WAMXAA
     I              DAMSAA                          WAMSAA
     I              DAR7NY                          WAR7NY
     I              DAHEPR                          WAHEPR
     I              DAHFPR                          WAHFPR
     I              DAWVT1                          WAWVT1
     I              DAW0T1                          WAW0T1
     I              DAR5NY                          WAR5NY
     I              DAW1T1                          WAW1T1
     I              DAR6NY                          WAR6NY
     I              DAJ1ST                          WAJ1ST
     I              DAKHST                          WAKHST
     I              DATWDT                          WATWDT
     I              DADUTM                          WADUTM
     I              DAKGST                          WAKGST
     I              DATVDT                          WATVDT
     I              DADTTM                          WADTTM
     I              DAR9NY                          WAR9NY
     I              DASQNY                          WASQNY
     I              DABHR3                          WABHR3
     I              DASRNY                          WASRNY
     I              DAW7T1                          WAW7T1
     I              DAW8T1                          WAW8T1
     I              DAT2DT                          WAT2DT
     I              DASXNY                          WASXNY
     I              DASYNY                          WASYNY
     I              DASZNY                          WASZNY
     I              DAVSST                          WAVSST
     I              DAMJDT                          WAMJDT
     I              DABETM                          WABETM
     I              DACCVN                          WACCVN
     I              DACDVN                          WACDVN
     I              DAMKDT                          WAMKDT
     I              DABFTM                          WABFTM
     I              DACEVN                          WACEVN
     I              DACFVN                          WACFVN
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@NIREBO
      * Company Customer EXT      Retrieval index
      * Renamed input format fields
     I              NIAIC3                          WCAIC3
     I              NIBKC7                          WCBKC7
     I              NIUFTX                          WCUFTX
     I              NIUGTX                          WCUGTX
     I              NIPFNA                          WCPFNA
     I              NIJ5NX                          WCJ5NX
     I              NIU5TX                          WCU5TX
     I              NIU6TX                          WCU6TX
     I              NIW0TX                          WCW0TX
     I              NIKSNX                          WCKSNX
     I              NIPENX                          WCPENX
     I              NIHSSX                          WCHSSX
     I              NIHTSX                          WCHTSX
     I              NIHUSX                          WCHUSX
     I              NIHVSX                          WCHVSX
     I              NINCT1                          WCNCT1
     I              NIM9T1                          WCM9T1
     I              NINAT1                          WCNAT1
     I              NIL9AA                          WCL9AA
     I              NIWJT1                          WCWJT1
     I              NIHLST                          WCHLST
     I              NIHMST                          WCHMST
     I              NINBT1                          WCNBT1
     I              NIWKT1                          WCWKT1
     I              NIJ7NY                          WCJ7NY
     I              NIRJNY                          WCRJNY
     I              NIRKNY                          WCRKNY
     I              NIH9ST                          WCH9ST
     I              NIAATM                          WCAATM
     I              NIAYNA                          WCAYNA
     I              NIA0NA                          WCA0NA
     I              NIAXDT                          WCAXDT
      *
     I@DACPP5
      * COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WDAIC3
     I              DAL6T1                          WDL6T1
     I              DAI3NY                          WDI3NY
     I              DAJYNY                          WDJYNY
     I              DAQ1NY                          WDQ1NY
     I              DAMUT1                          WDMUT1
     I              DAJZNY                          WDJZNY
     I              DAJ0NY                          WDJ0NY
     I              DAJ2NY                          WDJ2NY
     I              DARIDT                          WDRIDT
     I              DAC5TM                          WDC5TM
     I              DAMVT1                          WDMVT1
     I              DAMWT1                          WDMWT1
     I              DARINT                          WDRINT
     I              DARJDT                          WDRJDT
     I              DAC6TM                          WDC6TM
     I              DAC4NB                          WDC4NB
     I              DADPNB                          WDDPNB
     I              DAUENB                          WDUENB
     I              DARZNB                          WDRZNB
     I              DANGT1                          WDNGT1
     I              DARMNB                          WDRMNB
     I              DARKDT                          WDRKDT
     I              DAC7TM                          WDC7TM
     I              DARINS                          WDRINS
     I              DAMXT1                          WDMXT1
     I              DAG3ST                          WDG3ST
     I              DAQWNY                          WDQWNY
     I              DAL0AA                          WDL0AA
     I              DAMAT1                          WDMAT1
     I              DATDNA                          WDTDNA
     I              DACWC3                          WDCWC3
     I              DAQXNY                          WDQXNY
     I              DAQZNY                          WDQZNY
     I              DAQ0NY                          WDQ0NY
     I              DALVTX                          WDLVTX
     I              DANYT1                          WDNYT1
     I              DAG5ST                          WDG5ST
     I              DAG7ST                          WDG7ST
     I              DATFDT                          WDTFDT
     I              DATGDT                          WDTGDT
     I              DAWIT1                          WDWIT1
     I              DAQYNY                          WDQYNY
     I              DAL7T1                          WDL7T1
     I              DAR8NY                          WDR8NY
     I              DAR0NY                          WDR0NY
     I              DAI7AA                          WDI7AA
     I              DAMXAA                          WDMXAA
     I              DAMSAA                          WDMSAA
     I              DAR7NY                          WDR7NY
     I              DAHEPR                          WDHEPR
     I              DAHFPR                          WDHFPR
     I              DAWVT1                          WDWVT1
     I              DAW0T1                          WDW0T1
     I              DAR5NY                          WDR5NY
     I              DAW1T1                          WDW1T1
     I              DAR6NY                          WDR6NY
     I              DAJ1ST                          WDJ1ST
     I              DAKHST                          WDKHST
     I              DATWDT                          WDTWDT
     I              DADUTM                          WDDUTM
     I              DAKGST                          WDKGST
     I              DATVDT                          WDTVDT
     I              DADTTM                          WDDTTM
     I              DAR9NY                          WDR9NY
     I              DASQNY                          WDSQNY
     I              DABHR3                          WDBHR3
     I              DASRNY                          WDSRNY
     I              DAW7T1                          WDW7T1
     I              DAW8T1                          WDW8T1
     I              DAT2DT                          WDT2DT
     I              DASXNY                          WDSXNY
     I              DASYNY                          WDSYNY
     I              DASZNY                          WDSZNY
     I              DAVSST                          WDVSST
     I              DAMJDT                          WDMJDT
     I              DABETM                          WDBETM
     I              DACCVN                          WDCCVN
     I              DACDVN                          WDCDVN
     I              DAMKDT                          WDMKDT
     I              DABFTM                          WDBFTM
     I              DACEVN                          WDCEVN
     I              DACFVN                          WDCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMDA1    E DSPMDACPL0
      * UPD : COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WDAIC3
     I              DAL6T1                          WDL6T1
     I              DAI3NY                          WDI3NY
     I              DAJYNY                          WDJYNY
     I              DAQ1NY                          WDQ1NY
     I              DAMUT1                          WDMUT1
     I              DAJZNY                          WDJZNY
     I              DAJ0NY                          WDJ0NY
     I              DAJ2NY                          WDJ2NY
     I              DARIDT                          WDRIDT
     I              DAC5TM                          WDC5TM
     I              DAMVT1                          WDMVT1
     I              DAMWT1                          WDMWT1
     I              DARINT                          WDRINT
     I              DARJDT                          WDRJDT
     I              DAC6TM                          WDC6TM
     I              DAC4NB                          WDC4NB
     I              DADPNB                          WDDPNB
     I              DAUENB                          WDUENB
     I              DARZNB                          WDRZNB
     I              DANGT1                          WDNGT1
     I              DARMNB                          WDRMNB
     I              DARKDT                          WDRKDT
     I              DAC7TM                          WDC7TM
     I              DARINS                          WDRINS
     I              DAMXT1                          WDMXT1
     I              DAG3ST                          WDG3ST
     I              DAQWNY                          WDQWNY
     I              DAL0AA                          WDL0AA
     I              DAMAT1                          WDMAT1
     I              DATDNA                          WDTDNA
     I              DACWC3                          WDCWC3
     I              DAQXNY                          WDQXNY
     I              DAQZNY                          WDQZNY
     I              DAQ0NY                          WDQ0NY
     I              DALVTX                          WDLVTX
     I              DANYT1                          WDNYT1
     I              DAG5ST                          WDG5ST
     I              DAG7ST                          WDG7ST
     I              DATFDT                          WDTFDT
     I              DATGDT                          WDTGDT
     I              DAWIT1                          WDWIT1
     I              DAQYNY                          WDQYNY
     I              DAL7T1                          WDL7T1
     I              DAR8NY                          WDR8NY
     I              DAR0NY                          WDR0NY
     I              DAI7AA                          WDI7AA
     I              DAMXAA                          WDMXAA
     I              DAMSAA                          WDMSAA
     I              DAR7NY                          WDR7NY
     I              DAHEPR                          WDHEPR
     I              DAHFPR                          WDHFPR
     I              DAWVT1                          WDWVT1
     I              DAW0T1                          WDW0T1
     I              DAR5NY                          WDR5NY
     I              DAW1T1                          WDW1T1
     I              DAR6NY                          WDR6NY
     I              DAJ1ST                          WDJ1ST
     I              DAKHST                          WDKHST
     I              DATWDT                          WDTWDT
     I              DADUTM                          WDDUTM
     I              DAKGST                          WDKGST
     I              DATVDT                          WDTVDT
     I              DADTTM                          WDDTTM
     I              DAR9NY                          WDR9NY
     I              DASQNY                          WDSQNY
     I              DABHR3                          WDBHR3
     I              DASRNY                          WDSRNY
     I              DAW7T1                          WDW7T1
     I              DAW8T1                          WDW8T1
     I              DAT2DT                          WDT2DT
     I              DASXNY                          WDSXNY
     I              DASYNY                          WDSYNY
     I              DASZNY                          WDSZNY
     I              DAVSST                          WDVSST
     I              DAMJDT                          WDMJDT
     I              DABETM                          WDBETM
     I              DACCVN                          WDCCVN
     I              DACDVN                          WDCDVN
     I              DAMKDT                          WDMKDT
     I              DABFTM                          WDBFTM
     I              DACEVN                          WDCEVN
     I              DACFVN                          WDCFVN
      *
     IYARDCS      DS                            563
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Fix Trans Partner     XF
      * Fix Trans Partner     RT - COA Batch Header RIN  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Fix Trans Partner     RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@DACPP6                    *
     C                     READ @DACPP6                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.COA Retired RIN Reason Cd is *Blank
     C           WARINT    IFEQ *BLANK                     *IF
      * RTV Bilto/Customer     RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Rtv HPB Cust Fields   RT - Company Customer EXT  * 
     C                     EXSR SCRVGN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WASXNY' defaulted for 'COA BHR Equiv Value'.
      * Field '(DB1) WASYNY' defaulted for 'COA BHR Unused Nbr 4'.
      * Field '(DB1) WASZNY' defaulted for 'COA BHR Unused Nbr 5'.
      * Chg COA Batch Hdr RIN CH - COA Batch Header RIN  * 
     C                     EXSR SDCHRC
     C                     END                             *FI
     C                     READ @DACPP6                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Bilto/Customer     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBC4NB    WQSB01           Order Number
     C           *LIKE     DEFN WBAIC3    WQSB02           Company Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Order Number
     C                     KFLD           WQSB02           Company Number
      * Setup key
     C                     Z-ADDWAC4NB    WQSB01           Order Number
     C                     Z-ADDWAAIC3    WQSB02           Company Number
      * Establish starting position
     C           KRSSB     SETLL@BFCPY2                    *
     C           KRSSB     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBB0C7    YL0001           Bill to Custome
     C                     MOVELWBAETX    YL0002           Bill to Name
     C           KRSSB     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv HPB Cust Fields   RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     Z-ADDYL0001    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           HPB Employer ID
     C                     MOVEL*BLANK    YL0004           HPB ULSD Compan
     C                     MOVEL*BLANK    YL0005           HPB ULSD Facili
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCNCT1    YL0003           HPB Employer ID
     C                     MOVELWCM9T1    YL0004           HPB ULSD Compan
     C                     MOVELWCNAT1    YL0005           HPB ULSD Facili
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg COA Batch Hdr RIN CH - COA Batch Header RIN  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Create Date
     C                     Z-ADD*ZERO     WN0002  60       Create Time
     C                     MOVEL*BLANK    WN0003 10        Create User
     C                     MOVEL*BLANK    WN0004 10        Create Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @DACPP5
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     MOVELWAL6T1    WDL6T1    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WDI3NY           COA Batch Numbe
     C                     Z-ADDWAJYNY    WDJYNY           COA Batch Heade
     C                     Z-ADDWAQ1NY    WDQ1NY           COA Batch Hdr R
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDL6T1           COA ULSD Compan
     C                     KFLD           WDI3NY           COA Batch Numbe
     C                     KFLD           WDJYNY           COA Batch Heade
     C                     KFLD           WDQ1NY           COA Batch Hdr R
     C           KLCHSD    CHAIN@DACPP5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDACPL0'MDACP
     C                     MOVEL'@DACPP5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMDA1    YARDCS
      * Move non-key fields to @DACPP5
     C                     MOVELWAMUT1    WDMUT1    P      COA Batch Heade
     C                     Z-ADDWAJZNY    WDJZNY           COA RIN SSSSSSS
     C                     Z-ADDWAJ0NY    WDJ0NY           COA RIN EEEEEEE
     C                     Z-ADDWAJ2NY    WDJ2NY           COA RIN Volume
     C                     Z-ADDWARIDT    WDRIDT           COA RIN Transac
     C                     Z-ADDWAC5TM    WDC5TM           COA RIN Transac
     C                     MOVELYL0002    WDMVT1    P      COA RIN Trans P
     C                     MOVELYL0004    WDMWT1    P      COA RIN Trans P
     C                     MOVELWARINT    WDRINT    P      COA Retired RIN
     C                     Z-ADDWARJDT    WDRJDT           COA Retired RIN
     C                     Z-ADDWAC6TM    WDC6TM           COA Retired RIN
     C                     Z-ADDWAC4NB    WDC4NB           Order Number
     C                     Z-ADDWADPNB    WDDPNB           Order Sequence
     C                     Z-ADDWAUENB    WDUENB           Order Secondary
     C                     Z-ADDWARZNB    WDRZNB           Case Sequence N
     C                     MOVELWANGT1    WDNGT1    P      COA Rail Car
     C                     Z-ADDWARMNB    WDRMNB           Load ID
     C                     Z-ADDWARKDT    WDRKDT           COA Date of 1st
     C                     Z-ADDWAC7TM    WDC7TM           COA RIN Unused
     C                     MOVELWARINS    WDRINS    P      COA RIN Modifie
     C                     MOVELWAMXT1    WDMXT1    P      COA RIN Unused
     C                     MOVELWAG3ST    WDG3ST    P      COA RIN SoldFul
     C                     Z-ADDWAQWNY    WDQWNY           COA RIN Gallons
     C                     MOVELWAL0AA    WDL0AA    P      COA Ship To War
     C                     MOVELWAMAT1    WDMAT1    P      COA RIN Type Fl
     C                     MOVELWATDNA    WDTDNA    P      COA RIN Custome
     C                     Z-ADDWACWC3    WDCWC3           COA Shipping Co
     C                     Z-ADDWAQXNY    WDQXNY           COA Ref Load Id
     C                     Z-ADDWAQZNY    WDQZNY           COA Reference B
     C                     Z-ADDWAQ0NY    WDQ0NY           COA Reference B
     C                     MOVELWALVTX    WDLVTX    P      RFS Compliance
     C                     MOVELWANYT1    WDNYT1    P      RFS Report Year
     C                     MOVELWAG5ST    WDG5ST    P      COA RIN Int/Ext
     C                     MOVELWAG7ST    WDG7ST    P      COA BHR Unused
     C                     Z-ADDWATFDT    WDTFDT           COA BHR Net Gal
     C                     Z-ADDWATGDT    WDTGDT           COA BHR Unused
     C                     MOVELWAWIT1    WDWIT1    P      COA BHR Unused
     C                     Z-ADDWAQYNY    WDQYNY           COA BHR Loadout
     C                     MOVELWAL7T1    WDL7T1    P      COA ULSD Facili
     C                     Z-ADDWAR8NY    WDR8NY           COA Batch RIN V
     C                     Z-ADDWAR0NY    WDR0NY           COA RIN Quantit
     C                     MOVELWAI7AA    WDI7AA    P      RFS Transaction
     C                     MOVELWAMXAA    WDMXAA    P      RFS Trans Reaso
     C                     MOVELWAMSAA    WDMSAA    P      RFS Fuel Code
     C                     Z-ADDWAR7NY    WDR7NY           COA BHR RIN Gen
     C                     Z-ADDWAHEPR    WDHEPR           COA BHR RIN Pri
     C                     Z-ADDWAHFPR    WDHFPR           COA BHR Gallon
     C                     MOVELWAWVT1    WDWVT1    P      COA Transaction
     C                     MOVELWAW0T1    WDW0T1    P      COA RIN Support
     C                     Z-ADDWAR5NY    WDR5NY           COA RIN Support
     C                     MOVELWAW1T1    WDW1T1    P      COA RIN Support
     C                     Z-ADDWAR6NY    WDR6NY           COA RIN Support
     C                     MOVELWAJ1ST    WDJ1ST    P      COA BHR RFS Ver
     C                     MOVELWAKHST    WDKHST    P      COA GEN EMTS St
     C                     Z-ADDWATWDT    WDTWDT           COA GEN EMTS Da
     C                     Z-ADDWADUTM    WDDUTM           COA GEN EMTS Ti
     C                     MOVELWAKGST    WDKGST    P      COA RIN EMTS St
     C                     Z-ADDWATVDT    WDTVDT           COA RIN EMTS Da
     C                     Z-ADDWADTTM    WDDTTM           COA RIN EMTS Ti
     C                     Z-ADDWAR9NY    WDR9NY           COA EMTS PTD Nb
     C                     Z-ADDWASQNY    WDSQNY           COA EMTS Batch
     C                     MOVELWABHR3    WDBHR3    P      COA BHR Unused
     C                     Z-ADDWASRNY    WDSRNY           COA BHR Unused
     C                     MOVELWAW7T1    WDW7T1    P      COA EMTS Trans
     C                     MOVELWAW8T1    WDW8T1    P      COA EMTS Return
     C                     Z-ADDWAT2DT    WDT2DT           COA BHR Unused
     C                     Z-ADDWASXNY    WDSXNY           COA BHR Equiv V
     C                     Z-ADDWASYNY    WDSYNY           COA BHR Unused
     C                     Z-ADDWASZNY    WDSZNY           COA BHR Unused
     C                     MOVELWAVSST    WDVSST    P      Record Status
     C                     Z-ADDWAMKDT    WDMKDT           Change Date
     C                     Z-ADDWABFTM    WDBFTM           Change Time
     C                     MOVELWACEVN    WDCEVN    P      Change User
     C                     MOVELWACFVN    WDCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WDMKDT           Change Date
     C                     Z-ADD##JTM     WDBFTM           Change Time
     C                     MOVEL##USR     WDCEVN           Change User
     C                     MOVEL##PGM     WDCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@DACPP5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WAJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WAQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WAJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WAJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WAJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WARIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WAC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WARJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WAC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WARZNB           Case Sequence N
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WAC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WAQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WACWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WAQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WAQZNY           COA Reference B
     C                     Z-ADD*ZERO     WAQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WATFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WATGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WAQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WAR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WAR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WAR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WAHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WAHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WAR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WAR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WATWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WADUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WATVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WADTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WAR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WASQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WASRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WAT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WASXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WASYNY           COA BHR Unused
     C                     Z-ADD*ZERO     WASZNY           COA BHR Unused
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Unused Date
     C                     Z-ADD*ZERO     WBNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCKSNX           EDI Manufacture
     C                     Z-ADD*ZERO     WCPENX           Cust Shipping T
     C                     Z-ADD*ZERO     WCJ7NY           CCE Last ABS Fr
     C                     Z-ADD*ZERO     WCRJNY           Item Age Days F
     C                     Z-ADD*ZERO     WCRKNY           Item Age Days F
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field HPB Employer ID #
     C                     MOVEL*BLANK    YL0003 20
      * Define local work field HPB ULSD Company #
     C                     MOVEL*BLANK    YL0004  4
      * Define local work field HPB ULSD Facility ID
     C                     MOVEL*BLANK    YL0005  5
      *================================================================
     CSR         ZZEXIT    ENDSR
