// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKN6E1R
// ?Date: 14.08.2025 Time: 02:52:17
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

// Execute function Mov ApplN to Company  US.
EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
PARAMETER(PAR.Oms_System_Value_Alpha);
{
 C***   MOVE USER SOURCE                      ***
 C                     MOVEL#IEVTX    ##CMP
}


//?USER: Initialize detail screen (new record)

EXECUTE FUNCTION(Rtv Producer f/ Contr RT) TYPE(RTVOBJ) FILE(PKAPCPP)           AB1208607;
PARAMETER(DTL.PC_Contract_Code);
PARAMETER(DTL.PD_Producer_Code);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Producer Name     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1101542;
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.PD_Name);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// DTL.RS Record Status = CND.Active
DTL.RS_Record_Status = 'A';

//?USER: Initialize detail screen (existing record)

EXECUTE FUNCTION(Rtv Producer f/ Contr RT) TYPE(RTVOBJ) FILE(PKAPCPP)           AB1208607;
PARAMETER(DTL.PC_Contract_Code);
PARAMETER(DTL.PD_Producer_Code);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Producer Name     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1101542;
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.PD_Name);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?USER: Create DBF record

EXECUTE FUNCTION(CRT Reserve Acct Hdr  CR) TYPE(CRTOBJ) FILE(PKEECPP)           AB1208594;
PARAMETER(DTL.PC_Contract_Code);
PARAMETER(DTL.PAH_Account_Balance);
PARAMETER(DTL.PAH_Activation_Date);
PARAMETER(*BLANK);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(DTL.RS_Record_Status);
PARAMETER(JOB.*JOB);
PARAMETER(JOB.*PROGRAM);
PARAMETER(JOB.*USER);
PARAMETER(JOB.*Job_date);
PARAMETER(JOB.*Job_time);

//?USER: Change DBF record

EXECUTE FUNCTION(Chg Reserve Account HdrCH) TYPE(CHGOBJ) FILE(PKEECPP)          AB1208595;
PARAMETER(DTL.PC_Contract_Code);
PARAMETER(DTL.PAH_Account_Balance);
PARAMETER(DTL.PAH_Activation_Date);
PARAMETER(JOB.*USER);
PARAMETER(JOB.*Job_date);
PARAMETER(JOB.*Job_time);
PARAMETER(DTL.RS_Record_Status);
PARAMETER(JOB.*JOB);
PARAMETER(JOB.*PROGRAM);
PARAMETER(DTL.RS_User_Added);
PARAMETER(DTL.RS_Date_Added);
PARAMETER(DTL.RS_Time_Added);

