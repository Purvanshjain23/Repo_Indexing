// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PVI0XFR
// ?Date: 14.08.2025 Time: 03:52:16
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?12/04/24 AB SR 3023419: Orders are invoiced with 0 values due to
//?Due to 'Manifest Detail' file was not created as part of 24th Nov DDS/DDL
//?deployment issue. INC # 1033621
//?11/05/24 DN INC 1031800 - Warranty Fix for CR 7001057.
//?Purpose is to recalculate the Order Total Weight Shipped & Total
//?Quantity Shipped so we can update this info in the Export Doc Order
//?Hdr & Dtl and other related info.
EXECUTE FUNCTION(Cnv Fix Export Hdr/Dtl2RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC2238690;
{
 //?USER: Process Data record

 //?***SAVE-Was fix for 11/5/24 run.
 //?***SAVE-Fix for 12/04/24 run.
 //?Selective Orders Only.
 CASE;

 // IF DB1.Order Number is Fix 2718821
 IF DB1.Order_Number = 2718821;

 // OR DB1.Order Number is Fix 2748562
 OR DB1.Order_Number = 2748562;

 // OR DB1.Order Number is Fix 2749006
 OR DB1.Order_Number = 2749006;

 // OR DB1.Order Number is Fix 2749170
 OR DB1.Order_Number = 2749170;

 // OR DB1.Order Number is Fix 2749187
 OR DB1.Order_Number = 2749187;

 // OR DB1.Order Number is Fix 2749238
 OR DB1.Order_Number = 2749238;

 // OR DB1.Order Number is Fix 2750918
 OR DB1.Order_Number = 2750918;

 // OR DB1.Order Number is Fix 2755164
 OR DB1.Order_Number = 2755164;

 // OR DB1.Order Number is Fix 2766095
 OR DB1.Order_Number = 2766095;

 // OR DB1.Order Number is Fix 2766241
 OR DB1.Order_Number = 2766241;

 // OR DB1.Order Number is Fix 2766375
 OR DB1.Order_Number = 2766375;

 // OR DB1.Order Number is Fix 2766416
 OR DB1.Order_Number = 2766416;

 // OR DB1.Order Number is Fix 2766483
 OR DB1.Order_Number = 2766483;

 // OR DB1.Order Number is Fix 2766488
 OR DB1.Order_Number = 2766488;

 // OR DB1.Order Number is Fix 2767050
 OR DB1.Order_Number = 2767050;

 // OR DB1.Order Number is Fix 2767191
 OR DB1.Order_Number = 2767191;

 // OR DB1.Order Number is Fix 2771151
 OR DB1.Order_Number = 2771151;

 // OR DB1.Order Number is Fix 2771235
 OR DB1.Order_Number = 2771235;

 // OR DB1.Order Number is Fix 2767178
 OR DB1.Order_Number = 2767178;

 //?Update Export Doc Order Dtl & Hdr.
 CASE;

 // IF DB1.Quantity Shipped Total is Greater than zero
 IF DB1.Quantity_Shipped_Total > *ZERO;

 EXECUTE FUNCTION(Cnv Fix Export Hdr/Dtl RT) TYPE(RTVOBJ) FILE(PDMSREP)          AC2236920;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.Quantity_Shipped_Total);
 PARAMETER(DB1.Weight_Shipped_Total);
 {
  //?USER: Process Data record

  //?Get Company Item Info.
  EXECUTE FUNCTION(RTV Pc/Bg/Unt/Chl/Dpt RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1973329;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.ED_Item_Code);
  PARAMETER(NLL.Description_Line_One);
  PARAMETER(NLL.Unit_Weight);
  PARAMETER(NLL.Fresh_Chilling_Time);
  PARAMETER(NLL.Credit_Item_Status);
  PARAMETER(NLL.Piece_Count_Item);
  PARAMETER(LCL.ED_Pieces_per_Bag);
  PARAMETER(LCL.ED_Bags_per_Unit);
  {
   //?USER: Processing if Data record not found

   // PGM.*Return code = CND.*Record does not exist
   PGM.*Return_code = 'Y2U0005';

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  // LCL.ED Product Net Weight MT = PAR.Weight Shipped Total / CON.2204.6 *
  LCL.ED_Product_Net_Weight_MT = PAR.Weight_Shipped_Total / 2204.6;

  // Compute: Total Nbr Pieces
  LCL.ED_Total_Nbr_of_Pieces = PAR.Quantity_Shipped_Total * ( LCL.ED_Pieces_per_Bag
  * LCL.ED_Bags_per_Unit );

  //?This will update both Export Doc Order Hdr & Dtl.
  EXECUTE FUNCTION(Chg Exp Doc Order Dtl  CH) TYPE(CHGOBJ) FILE(PDMSREP)          AC1524036;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.ED_Export_Document_Type);
  PARAMETER(DB1.Country_Code);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(DB1.ED_Item_Code);
  PARAMETER(DB1.ED_Item_Label_Line_1);
  PARAMETER(DB1.ED_Item_Label_Line_2);
  PARAMETER(DB1.ED_Chilled_Frozen_Text);
  PARAMETER(DB1.ED_Unmarked_Txt);
  PARAMETER(PAR.Weight_Shipped_Total);
  PARAMETER(LCL.ED_Product_Net_Weight_MT);
  PARAMETER(DB1.ED_Product_UOM);
  PARAMETER(PAR.Quantity_Shipped_Total);
  PARAMETER(DB1.ED_Product_Pkg_Type);
  PARAMETER(DB1.ED_Shipping_Marks_Txt);
  PARAMETER(LCL.ED_Pieces_per_Bag);
  PARAMETER(LCL.ED_Bags_per_Unit);
  PARAMETER(LCL.ED_Total_Nbr_of_Pieces);
  PARAMETER(DB1.ED_Product_Unit_Price);
  PARAMETER(DB1.ED_Producet_Extended_Amt);
  PARAMETER(DB1.ED_Print_Status);
  PARAMETER(DB1.ED_Plant_Number_Dtl);
  PARAMETER(DB1.ED_Language_Xlate_Desc_2);
  PARAMETER(DB1.ED_Consignee_Address_Nbr);
  PARAMETER(DB1.ED_Date_of_Slaughter_Dtl);
  PARAMETER(DB1.ED_HACCP_Category);
  PARAMETER(DB1.ED_Slaughter_Date_Range);
  PARAMETER(DB1.ED_Production_Date_Range);
  PARAMETER(DB1.ED_Product_UID);
  PARAMETER(DB1.ED_Language_Xlate_Desc);
  PARAMETER(DB1.ED_Unused_Status_1);
  PARAMETER(DB1.ED_Unused_Status_2);
  PARAMETER(DB1.ED_Harmonized_Tariff_Cde);
  PARAMETER(DB1.ED_Nbr_of_Packing_Units);
  PARAMETER(DB1.EDI_Status_1);
  PARAMETER(DB1.EDI_Status_2);
  PARAMETER(DB1.EDI_Status_3);
  PARAMETER(DB1.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

   //?USER: Processing after Data update

   // Call program Rtv/Chg Hdr Shpd Amts XF.
   CALL PROGRAM(Rtv/Chg Hdr Shpd Amts XF) ('POIYXFR');
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(DB1.ED_Export_Document_Type);
   PARAMETER(DB1.Country_Code);

  }

 }

 ENDIF;

 ENDIF;

}


