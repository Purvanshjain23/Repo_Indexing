     H/TITLE Dlt Crc Dtl & Tat D/A XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 09/16/21  Time  : 07:46:20
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPWAXCPL1IF  E           K        DISK
      * RTV : Tattoo Repayment Detail   Retrieval index
      *
     FPKB1CPL1IF  E           K        DISK
      * RTV : Carcass Detail            Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKB1CPL0UF  E           K        DISK
      * UPD : Carcass Detail            Update index
      *
     FPKCDCPL0UF  E           K        DISK
      * UPD : Tattoo Ded/Add            Update index
      *
     I@AXCPAX
      * Tattoo Repayment Detail   Retrieval index
      * Renamed input format fields
     I              AXHONB                          WAHONB
     I              AXCDNZ                          WACDNZ
     I              AXHMNB                          WAHMNB
     I              AXBNNB                          WABNNB
     I              AXBONB                          WABONB
     I              AXCVNB                          WACVNB
     I              AXB0DT                          WAB0DT
     I              AXCGNZ                          WACGNZ
     I              AXCENZ                          WACENZ
     I              AXCFNZ                          WACFNZ
     I              AXIIDT                          WAIIDT
     I              AXTOCD                          WATOCD
     I              AXTPCD                          WATPCD
     I              AXINT1                          WAINT1
     I              AXMCSS                          WAMCSS
     I              AXC1NZ                          WAC1NZ
     I              AXMZSS                          WAMZSS
     I              AXTNCD                          WATNCD
     I              AXABCD                          WAABCD
     I              AXNYCD                          WANYCD
     I              AXNASS                          WANASS
     I              AXAACD                          WAAACD
     I              AXAECD                          WAAECD
     I              AXAKCD                          WAAKCD
     I              AXALCD                          WAALCD
     I              AXAAVN                          WAAAVN
     I              AXAADT                          WAAADT
     I              AXAMTM                          WAAMTM
     I              AXAJST                          WAAJST
     I              AXAHVN                          WAAHVN
     I              AXAGVN                          WAAGVN
     I              AXABVN                          WAABVN
     I              AXABDT                          WAABDT
     I              AXABTM                          WAABTM
      *
     I@B1CPG7
      * Carcass Detail            Retrieval index
      * Renamed input format fields
     I              B1HMNB                          WBHMNB
     I              B1BNNB                          WBBNNB
     I              B1BONB                          WBBONB
     I              B1CVNB                          WBCVNB
     I              B1B0DT                          WBB0DT
     I              B1LGNB                          WBLGNB
     I              B1EUNB                          WBEUNB
     I              B1LHNB                          WBLHNB
     I              B1INST                          WBINST
     I              B1BEPR                          WBBEPR
     I              B1ASPC                          WBASPC
     I              B1EWNB                          WBEWNB
     I              B1B4PR                          WBB4PR
     I              B1EYNB                          WBEYNB
     I              B1B1PR                          WBB1PR
     I              B1AVPR                          WBAVPR
     I              B1AUPC                          WBAUPC
     I              B1AWPR                          WBAWPR
     I              B1AXPR                          WBAXPR
     I              B1EZNB                          WBEZNB
     I              B1AYPR                          WBAYPR
     I              B1BBDT                          WBBBDT
     I              B1AKTM                          WBAKTM
     I              B1IQST                          WBIQST
     I              B1EFST                          WBEFST
     I              B1H6NB                          WBH6NB
     I              B1BEPC                          WBBEPC
     I              B1GCST                          WBGCST
     I              B1GDST                          WBGDST
     I              B1GEST                          WBGEST
     I              B1BHPC                          WBBHPC
     I              B1IOST                          WBIOST
     I              B1IPST                          WBIPST
     I              B1LTNB                          WBLTNB
     I              B1JNST                          WBJNST
     I              B1X4NB                          WBX4NB
     I              B1FNPC                          WBFNPC
     I              B1FOPC                          WBFOPC
     I              B1FPPC                          WBFPPC
     I              B1K2ST                          WBK2ST
     I              B1K3ST                          WBK3ST
     I              B1JWPR                          WBJWPR
     I              B1F5PC                          WBF5PC
     I              B1JXPR                          WBJXPR
     I              B1JYPR                          WBJYPR
     I              B1JZPR                          WBJZPR
     I              B1J0PR                          WBJ0PR
     I              B1J1PR                          WBJ1PR
     I              B1J2PR                          WBJ2PR
     I              B1J3PR                          WBJ3PR
     I              B1J4PR                          WBJ4PR
     I              B1UTST                          WBUTST
     I              B1HVCD                          WBHVCD
     I              B1DKJR                          WBDKJR
     I              B1ITJF                          WBITJF
     I              B1IJGR                          WBIJGR
     I              B1ORJE                          WBORJE
     I              B1OTJR                          WBOTJR
     I              B1PEIR                          WBPEIR
     I              B1IEUF                          WBIEUF
     I              B1ORUE                          WBORUE
     I              B1IUTR                          WBIUTR
     I              B1IJRR                          WBIJRR
     I              B1VCST                          WBVCST
     I              B1VDST                          WBVDST
     I              B1VEST                          WBVEST
     I              B1VFST                          WBVFST
     I              B1VGST                          WBVGST
     I              B1ABCD                          WBABCD
     I              B1AACD                          WBAACD
     I              B1AAVN                          WBAAVN
     I              B1AADT                          WBAADT
     I              B1AMTM                          WBAMTM
     I              B1AJST                          WBAJST
     I              B1AHVN                          WBAHVN
     I              B1AGVN                          WBAGVN
     I              B1ABVN                          WBABVN
     I              B1ABDT                          WBABDT
     I              B1ABTM                          WBABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WCHMNB
     I              B1BNNB                          WCBNNB
     I              B1BONB                          WCBONB
     I              B1CVNB                          WCCVNB
     I              B1B0DT                          WCB0DT
     I              B1LGNB                          WCLGNB
     I              B1EUNB                          WCEUNB
     I              B1LHNB                          WCLHNB
     I              B1INST                          WCINST
     I              B1BEPR                          WCBEPR
     I              B1ASPC                          WCASPC
     I              B1EWNB                          WCEWNB
     I              B1B4PR                          WCB4PR
     I              B1EYNB                          WCEYNB
     I              B1B1PR                          WCB1PR
     I              B1AVPR                          WCAVPR
     I              B1AUPC                          WCAUPC
     I              B1AWPR                          WCAWPR
     I              B1AXPR                          WCAXPR
     I              B1EZNB                          WCEZNB
     I              B1AYPR                          WCAYPR
     I              B1BBDT                          WCBBDT
     I              B1AKTM                          WCAKTM
     I              B1IQST                          WCIQST
     I              B1EFST                          WCEFST
     I              B1H6NB                          WCH6NB
     I              B1BEPC                          WCBEPC
     I              B1GCST                          WCGCST
     I              B1GDST                          WCGDST
     I              B1GEST                          WCGEST
     I              B1BHPC                          WCBHPC
     I              B1IOST                          WCIOST
     I              B1IPST                          WCIPST
     I              B1LTNB                          WCLTNB
     I              B1JNST                          WCJNST
     I              B1X4NB                          WCX4NB
     I              B1FNPC                          WCFNPC
     I              B1FOPC                          WCFOPC
     I              B1FPPC                          WCFPPC
     I              B1K2ST                          WCK2ST
     I              B1K3ST                          WCK3ST
     I              B1JWPR                          WCJWPR
     I              B1F5PC                          WCF5PC
     I              B1JXPR                          WCJXPR
     I              B1JYPR                          WCJYPR
     I              B1JZPR                          WCJZPR
     I              B1J0PR                          WCJ0PR
     I              B1J1PR                          WCJ1PR
     I              B1J2PR                          WCJ2PR
     I              B1J3PR                          WCJ3PR
     I              B1J4PR                          WCJ4PR
     I              B1UTST                          WCUTST
     I              B1HVCD                          WCHVCD
     I              B1DKJR                          WCDKJR
     I              B1ITJF                          WCITJF
     I              B1IJGR                          WCIJGR
     I              B1ORJE                          WCORJE
     I              B1OTJR                          WCOTJR
     I              B1PEIR                          WCPEIR
     I              B1IEUF                          WCIEUF
     I              B1ORUE                          WCORUE
     I              B1IUTR                          WCIUTR
     I              B1IJRR                          WCIJRR
     I              B1VCST                          WCVCST
     I              B1VDST                          WCVDST
     I              B1VEST                          WCVEST
     I              B1VFST                          WCVFST
     I              B1VGST                          WCVGST
     I              B1ABCD                          WCABCD
     I              B1AACD                          WCAACD
     I              B1AAVN                          WCAAVN
     I              B1AADT                          WCAADT
     I              B1AMTM                          WCAMTM
     I              B1AJST                          WCAJST
     I              B1AHVN                          WCAHVN
     I              B1AGVN                          WCAGVN
     I              B1ABVN                          WCABVN
     I              B1ABDT                          WCABDT
     I              B1ABTM                          WCABTM
      *
     I@CDCPIU
      * Tattoo Ded/Add            Retrieval index
      * Renamed input format fields
     I              CDHMNB                          WDHMNB
     I              CDBNNB                          WDBNNB
     I              CDBONB                          WDBONB
     I              CDCVNB                          WDCVNB
     I              CDB0DT                          WDB0DT
     I              CDBQCD                          WDBQCD
     I              CDAZVA                          WDAZVA
     I              CDA0VA                          WDA0VA
     I              CDJBST                          WDJBST
     I              CDEIST                          WDEIST
     I              CDJDST                          WDJDST
     I              CDDPCD                          WDDPCD
     I              CDE3CD                          WDE3CD
     I              CDAQNB                          WDAQNB
     I              CDOCST                          WDOCST
     I              CDPEST                          WDPEST
     I              CDPFST                          WDPFST
     I              CDPGST                          WDPGST
     I              CDPIST                          WDPIST
     I              CDPJST                          WDPJST
     I              CDPKST                          WDPKST
     I              CDPLST                          WDPLST
     I              CDAAVN                          WDAAVN
     I              CDAADT                          WDAADT
     I              CDAMTM                          WDAMTM
     I              CDAJST                          WDAJST
     I              CDAHVN                          WDAHVN
     I              CDAGVN                          WDAGVN
     I              CDABVN                          WDABVN
     I              CDABDT                          WDABDT
     I              CDABTM                          WDABTM
      *
     I@CDCPIT
      * Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WEHMNB
     I              CDBNNB                          WEBNNB
     I              CDBONB                          WEBONB
     I              CDCVNB                          WECVNB
     I              CDB0DT                          WEB0DT
     I              CDBQCD                          WEBQCD
     I              CDAZVA                          WEAZVA
     I              CDA0VA                          WEA0VA
     I              CDJBST                          WEJBST
     I              CDEIST                          WEEIST
     I              CDJDST                          WEJDST
     I              CDDPCD                          WEDPCD
     I              CDE3CD                          WEE3CD
     I              CDAQNB                          WEAQNB
     I              CDOCST                          WEOCST
     I              CDPEST                          WEPEST
     I              CDPFST                          WEPFST
     I              CDPGST                          WEPGST
     I              CDPIST                          WEPIST
     I              CDPJST                          WEPJST
     I              CDPKST                          WEPKST
     I              CDPLST                          WEPLST
     I              CDAAVN                          WEAAVN
     I              CDAADT                          WEAADT
     I              CDAMTM                          WEAMTM
     I              CDAJST                          WEAJST
     I              CDAHVN                          WEAHVN
     I              CDAGVN                          WEAGVN
     I              CDABVN                          WEABVN
     I              CDABDT                          WEABDT
     I              CDABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WCHMNB
     I              B1BNNB                          WCBNNB
     I              B1BONB                          WCBONB
     I              B1CVNB                          WCCVNB
     I              B1B0DT                          WCB0DT
     I              B1LGNB                          WCLGNB
     I              B1EUNB                          WCEUNB
     I              B1LHNB                          WCLHNB
     I              B1INST                          WCINST
     I              B1BEPR                          WCBEPR
     I              B1ASPC                          WCASPC
     I              B1EWNB                          WCEWNB
     I              B1B4PR                          WCB4PR
     I              B1EYNB                          WCEYNB
     I              B1B1PR                          WCB1PR
     I              B1AVPR                          WCAVPR
     I              B1AUPC                          WCAUPC
     I              B1AWPR                          WCAWPR
     I              B1AXPR                          WCAXPR
     I              B1EZNB                          WCEZNB
     I              B1AYPR                          WCAYPR
     I              B1BBDT                          WCBBDT
     I              B1AKTM                          WCAKTM
     I              B1IQST                          WCIQST
     I              B1EFST                          WCEFST
     I              B1H6NB                          WCH6NB
     I              B1BEPC                          WCBEPC
     I              B1GCST                          WCGCST
     I              B1GDST                          WCGDST
     I              B1GEST                          WCGEST
     I              B1BHPC                          WCBHPC
     I              B1IOST                          WCIOST
     I              B1IPST                          WCIPST
     I              B1LTNB                          WCLTNB
     I              B1JNST                          WCJNST
     I              B1X4NB                          WCX4NB
     I              B1FNPC                          WCFNPC
     I              B1FOPC                          WCFOPC
     I              B1FPPC                          WCFPPC
     I              B1K2ST                          WCK2ST
     I              B1K3ST                          WCK3ST
     I              B1JWPR                          WCJWPR
     I              B1F5PC                          WCF5PC
     I              B1JXPR                          WCJXPR
     I              B1JYPR                          WCJYPR
     I              B1JZPR                          WCJZPR
     I              B1J0PR                          WCJ0PR
     I              B1J1PR                          WCJ1PR
     I              B1J2PR                          WCJ2PR
     I              B1J3PR                          WCJ3PR
     I              B1J4PR                          WCJ4PR
     I              B1UTST                          WCUTST
     I              B1HVCD                          WCHVCD
     I              B1DKJR                          WCDKJR
     I              B1ITJF                          WCITJF
     I              B1IJGR                          WCIJGR
     I              B1ORJE                          WCORJE
     I              B1OTJR                          WCOTJR
     I              B1PEIR                          WCPEIR
     I              B1IEUF                          WCIEUF
     I              B1ORUE                          WCORUE
     I              B1IUTR                          WCIUTR
     I              B1IJRR                          WCIJRR
     I              B1VCST                          WCVCST
     I              B1VDST                          WCVDST
     I              B1VEST                          WCVEST
     I              B1VFST                          WCVFST
     I              B1VGST                          WCVGST
     I              B1ABCD                          WCABCD
     I              B1AACD                          WCAACD
     I              B1AAVN                          WCAAVN
     I              B1AADT                          WCAADT
     I              B1AMTM                          WCAMTM
     I              B1AJST                          WCAJST
     I              B1AHVN                          WCAHVN
     I              B1AGVN                          WCAGVN
     I              B1ABVN                          WCABVN
     I              B1ABDT                          WCABDT
     I              B1ABTM                          WCABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKCD1    E DSPKCDCPL0
      * UPD : Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WEHMNB
     I              CDBNNB                          WEBNNB
     I              CDBONB                          WEBONB
     I              CDCVNB                          WECVNB
     I              CDB0DT                          WEB0DT
     I              CDBQCD                          WEBQCD
     I              CDAZVA                          WEAZVA
     I              CDA0VA                          WEA0VA
     I              CDJBST                          WEJBST
     I              CDEIST                          WEEIST
     I              CDJDST                          WEJDST
     I              CDDPCD                          WEDPCD
     I              CDE3CD                          WEE3CD
     I              CDAQNB                          WEAQNB
     I              CDOCST                          WEOCST
     I              CDPEST                          WEPEST
     I              CDPFST                          WEPFST
     I              CDPGST                          WEPGST
     I              CDPIST                          WEPIST
     I              CDPJST                          WEPJST
     I              CDPKST                          WEPKST
     I              CDPLST                          WEPLST
     I              CDAAVN                          WEAAVN
     I              CDAADT                          WEAADT
     I              CDAMTM                          WEAMTM
     I              CDAJST                          WEAJST
     I              CDAHVN                          WEAHVN
     I              CDAGVN                          WEAGVN
     I              CDABVN                          WEABVN
     I              CDABDT                          WEABDT
     I              CDABTM                          WEABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Repayment Detail
      * I :  CC Company Number
     I                                    P   1   20P1HONB
      * I :  TRH Repayment ID
     I                                    P   3   50P1CDNZ
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1CDNZ    PARM           WP0002  50       TRH Repayment I
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Dlt Crc Dtl & Tat D/A XF
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Dlt Crc Dtl & Tat D/A RT - Tattoo Repayment Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Dlt Crc Dtl & Tat D/A RT - Tattoo Repayment Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHONB    WQSA01           CC Company Numb
     C           *LIKE     DEFN WACDNZ    WQSA02           TRH Repayment I
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
     C                     KFLD           WQSA02           TRH Repayment I
      * Setup key
     C                     Z-ADDP1HONB    WQSA01           CC Company Numb
     C                     Z-ADDP1CDNZ    WQSA02           TRH Repayment I
      * Establish starting position
     C           KRSSA     SETLL@AXCPAX                    *
     C           KRSSA     READE@AXCPAX                  90*
      * Data record not found
     C   90                MOVEL'PRK1566' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Carc Dtl for Repay RT - Carcass Detail  * 
     C                     EXSR SBRVGN
      * Dlt Ttt D/A excpt FRT RT - Tattoo Ded/Add  * 
     C                     EXSR SDRVGN
     C           KRSSA     READE@AXCPAX                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Dlt Carc Dtl for Repay RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSB02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSB03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSB04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQSB05           TH Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
     C                     KFLD           WQSB03           BOL Load Number
     C                     KFLD           WQSB04           TH Tattoo Numbe
     C                     KFLD           WQSB05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSB01           BOH Company Num
     C                     Z-ADDWABNNB    WQSB02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSB03           BOL Load Number
     C                     Z-ADDWACVNB    WQSB04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSB05           TH Kill Date
      * Establish starting position
     C           KRSSB     SETLL@B1CPG7                    *
     C           KRSSB     READE@B1CPG7                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Carcass Detail    DL - Carcass Detail  * 
     C                     EXSR SCDLRC
     C           KRSSB     READE@B1CPG7                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Dlt Carcass Detail    DL - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1CPG6
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     Z-ADDWBLGNB    WCLGNB           CD Scale Sequen
     C                     Z-ADDWBEUNB    WCEUNB           CD Carcass Numb
     C                     Z-ADDWBLHNB    WCLHNB           CD Carcass Numb
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCLGNB           CD Scale Sequen
     C                     KFLD           WCEUNB           CD Carcass Numb
     C                     KFLD           WCLHNB           CD Carcass Numb
     C           KLDLSC    CHAIN@B1CPG6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1CPG6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Dlt Ttt D/A excpt FRT RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSD03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQSD04           TH Tattoo Numbe
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
     C                     KFLD           WQSD04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSD01           BOH Company Num
     C                     Z-ADDWABNNB    WQSD02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSD03           BOL Load Number
     C                     Z-ADDWACVNB    WQSD04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSD     SETLL@CDCPIU                    *
     C           KRSSD     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If D/A Code <> FRT, delete the record
      * CASE:
      *  - NOTc1
      *   |- c1    : DB1.DED D/A Code is Freight
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDBQCD    IFEQ 'FRT'                      *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Delete Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SEDLRC
     C                     END                             *FI
     C           KRSSD     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * Delete Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CDCPIT
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
     C                     MOVELWDBQCD    WEBQCD           DED D/A Code
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEBQCD           DED D/A Code
     C           KLDLSE    CHAIN@CDCPIT              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CDCPIT                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  9/13/2021 JBB WHD83659 - Previous Day Repayment Issue
      *                           Function created.  This function will
      *                           delete all Carcass Detail records for
      *                           each Tattoo for the Repayment ID.
      *                           Also. all Tattoo Header D/A records
      *                           will be deleted for the Repayment ID,
      *                           except for the FRT record.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACDNZ           TRH Repayment I
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WACGNZ           Transfer Buy Or
     C                     Z-ADD*ZERO     WACENZ           Transfer Buy Or
     C                     Z-ADD*ZERO     WACFNZ           Transfer Tattoo
     C                     Z-ADD*ZERO     WAIIDT           Transfer Kill D
     C                     Z-ADD*ZERO     WAC1NZ           TRD Pen Head
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBLGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WBEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WBLHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WBBEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WBASPC           CD STD Yield
     C                     Z-ADD*ZERO     WBEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WBB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WBEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WBB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WBAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WBAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WBAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WBAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WBEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WBAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WBBBDT           CD Kill Date
     C                     Z-ADD*ZERO     WBAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WBH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WBBEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WBGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WBBHPC           CD FFLI
     C                     Z-ADD*ZERO     WBLTNB           CD LOT
     C                     Z-ADD*ZERO     WBX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WBFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WBFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WBFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WBJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WBF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WBJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WBJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WBJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WBJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WBJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WBJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WBJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WBJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WBDKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WBITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WBIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WBORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WBOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WBPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WBIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WBORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WBIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WBIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WDA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WDAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
