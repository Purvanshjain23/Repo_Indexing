     H/TITLE CLC Price Information XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 09/06/24  Time  : 02:05:48
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDK3CPL2IF  E           K        DISK
      * RSQ : Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      *
     FOPBGWKL9IF  E           K        DISK
      * RTV : Order Detail              Priced,Audit Required
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDK3CPL0IF  E           K        DISK                      A
      * UPD : Price Change Audit Log    Update index
      *
     FPDKXCPL0IF  E           K        DISK                      A
      * UPD : WF Price Audit Log Work   Update index
      *
     E                    #L7         7  1
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@K3CPKR
      * Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      * Renamed input format fields
     I              K3AIC3                          WCAIC3
     I              K3C4NB                          WCC4NB
     I              K3DPNB                          WCDPNB
     I              K3UENB                          WCUENB
     I              K3ASNO                          WCASNO
     I              K3HGCD                          WCHGCD
     I              K3GMST                          WCGMST
     I              K3GNST                          WCGNST
     I              K3AYVA                          WCAYVA
     I              K3YJVA                          WCYJVA
     I              K3U1ST                          WCU1ST
     I              K3PSTL                          WCPSTL
     I              K3U0ST                          WCU0ST
     I              K3RFCD                          WCRFCD
     I              K3PALS                          WCPALS
     I              K3WWCD                          WCWWCD
     I              K3AKPR                          WCAKPR
     I              K3DBPR                          WCDBPR
     I              K3ALPR                          WCALPR
     I              K3DCPR                          WCDCPR
     I              K3JPCD                          WCJPCD
     I              K3WXCD                          WCWXCD
     I              K3PREC                          WCPREC
     I              K3PIDX                          WCPIDX
     I              K3UVST                          WCUVST
     I              K3UWST                          WCUWST
     I              K3UXST                          WCUXST
     I              K3AATM                          WCAATM
     I              K3AYNA                          WCAYNA
     I              K3A0NA                          WCA0NA
     I              K3AXDT                          WCAXDT
      *
     I@K3CPKP
      * Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WDAIC3
     I              K3C4NB                          WDC4NB
     I              K3DPNB                          WDDPNB
     I              K3UENB                          WDUENB
     I              K3ASNO                          WDASNO
     I              K3HGCD                          WDHGCD
     I              K3GMST                          WDGMST
     I              K3GNST                          WDGNST
     I              K3AYVA                          WDAYVA
     I              K3YJVA                          WDYJVA
     I              K3U1ST                          WDU1ST
     I              K3PSTL                          WDPSTL
     I              K3U0ST                          WDU0ST
     I              K3RFCD                          WDRFCD
     I              K3PALS                          WDPALS
     I              K3WWCD                          WDWWCD
     I              K3AKPR                          WDAKPR
     I              K3DBPR                          WDDBPR
     I              K3ALPR                          WDALPR
     I              K3DCPR                          WDDCPR
     I              K3JPCD                          WDJPCD
     I              K3WXCD                          WDWXCD
     I              K3PREC                          WDPREC
     I              K3PIDX                          WDPIDX
     I              K3UVST                          WDUVST
     I              K3UWST                          WDUWST
     I              K3UXST                          WDUXST
     I              K3AATM                          WDAATM
     I              K3AYNA                          WDAYNA
     I              K3A0NA                          WDA0NA
     I              K3AXDT                          WDAXDT
      *
     I@BGWKF9
      * Order Detail              Priced,Audit Required
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@KXCPI4
      * WF Price Audit Log Work   Update index
      * Renamed input format fields
     I              KXAIC3                          WFAIC3
     I              KXC4NB                          WFC4NB
     I              KXBCCD                          WFBCCD
     I              KXB4DT                          WFB4DT
     I              KXAPTM                          WFAPTM
     I              KXUPDP                          WFUPDP
     I              KXU0ST                          WFU0ST
     I              KXUVST                          WFUVST
     I              KXUWST                          WFUWST
     I              KXUXST                          WFUXST
     I              KXAATM                          WFAATM
     I              KXAYNA                          WFAYNA
     I              KXA0NA                          WFA0NA
     I              KXAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IYBRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQPDK31    E DSPDK3CPL0
      * UPD : Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WDAIC3
     I              K3C4NB                          WDC4NB
     I              K3DPNB                          WDDPNB
     I              K3UENB                          WDUENB
     I              K3ASNO                          WDASNO
     I              K3HGCD                          WDHGCD
     I              K3GMST                          WDGMST
     I              K3GNST                          WDGNST
     I              K3AYVA                          WDAYVA
     I              K3YJVA                          WDYJVA
     I              K3U1ST                          WDU1ST
     I              K3PSTL                          WDPSTL
     I              K3U0ST                          WDU0ST
     I              K3RFCD                          WDRFCD
     I              K3PALS                          WDPALS
     I              K3WWCD                          WDWWCD
     I              K3AKPR                          WDAKPR
     I              K3DBPR                          WDDBPR
     I              K3ALPR                          WDALPR
     I              K3DCPR                          WDDCPR
     I              K3JPCD                          WDJPCD
     I              K3WXCD                          WDWXCD
     I              K3PREC                          WDPREC
     I              K3PIDX                          WDPIDX
     I              K3UVST                          WDUVST
     I              K3UWST                          WDUWST
     I              K3UXST                          WDUXST
     I              K3AATM                          WDAATM
     I              K3AYNA                          WDAYNA
     I              K3A0NA                          WDA0NA
     I              K3AXDT                          WDAXDT
      *
     IYCRDCS      DS                            525
     IQPDKX1    E DSPDKXCPL0
      * UPD : WF Price Audit Log Work   Update index
      * Renamed input format fields
     I              KXAIC3                          WFAIC3
     I              KXC4NB                          WFC4NB
     I              KXBCCD                          WFBCCD
     I              KXB4DT                          WFB4DT
     I              KXAPTM                          WFAPTM
     I              KXUPDP                          WFUPDP
     I              KXU0ST                          WFU0ST
     I              KXUVST                          WFUVST
     I              KXUWST                          WFUWST
     I              KXUXST                          WFUXST
     I              KXAATM                          WFAATM
     I              KXAYNA                          WFAYNA
     I              KXA0NA                          WFA0NA
     I              KXAXDT                          WFAXDT
      *
     IYDRDCS      DS                            779
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST Order Sequence Number
     I                                    P   7   80P1DPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * I :  Item Code
     I                                    P  11  140P1HGCD
      * I :  Warehouse Code
     I                                       15  17 P1AJCD
      * I :  Ship To Customer
     I                                    P  18  210P1BKC7
      * I :  Order Group Code
     I                                    P  22  250P1CFC7
      * I :  Detail Line Status
     I                                       26  26 P1GMST
      * I :  Detail Line Status Last
     I                                       27  27 P1GNST
      * I :  Billing Detail Cost Dol
     I                                    P  28  332P1MAVA
      * I :  Billing Detail Gross Dol
     I                                    P  34  392P1KDVA
      * I :  Billing Detail Net Dol
     I                                    P  40  452P1L8VA
      * I :  Quantity to Substitute
     I                                    P  46  512P1L9VA
      * I :  Comment Print Acknowledge
     I                                       52  52 P1GTST
      * I :  Comment Print Inv_Cr_Memo
     I                                       53  53 P1GVST
      * I :  Comment Print Pick Slip
     I                                       54  54 P1GUST
      * I :  Comment Print Ship Doc
     I                                       55  55 P1QFST
      * B : MAP Extended Amount
     I                                    P  56  612P1AYVA
      * I :  Market Pricing Date
     I                                    P  62  650P1EXDT
      * I :  Commodity Market Code
     I                                       66  68 P1LQCD
      * I :  Date Method Code
     I                                       69  71 P1RDCD
      * I :  Price Method Code
     I                                       72  74 P1Q7CD
      * I :  Price Overage Override
     I                                    P  75  804P1BZPR
      * I :  Contract Number
     I                                    P  81  840P1L6NB
      * I :  Price Status
     I                                       85  85 P1U1ST
      * I :  Pricing Date Used
     I                                    P  86  890P1GIDT
      * I :  U_M_Base Price
     I                                       90  91 P1CRCD
      * I :  U_M_Ordered
     I                                       92  93 P1AGCD
      * I :  Work Confirm Status
     I                                       94  94 P1RZST
      * I :  Work Over_Short Status
     I                                       95  95 P1R0ST
      * I :  OD Production Plan Sts
     I                                       96  96 P1R1ST
      * I :  Order Desc_Line One
     I                                       97 126 P1G7NA
      * I :  Order Desc_Line Two
     I                                      127 156 P1G8NA
      * I :  Age Code
     I                                      157 157 P1RPCD
      * I :  Palletize
     I                                      158 158 P1VEST
      * I :  Slip Sheet
     I                                      159 159 P1VGST
      * I :  Catch Weight Status
     I                                      160 160 P1AVST
      * I :  Price Audit
     I                                      161 161 P1U0ST
      * I :  Price Audit Reason Code
     I                                      162 164 P1RFCD
      * I :  Production Date Control
     I                                      165 165 P1FZST
      * I :  Rated Freight
     I                                    P 166 1712P1R1NB
      * I :  Quantity Ordered
     I                                    P 172 1772P1AVQT
      * I :  Weight Ordered
     I                                    P 178 1832P1D0WG
      * I :  Quantity Scheduled
     I                                    P 184 1892P1CCQT
      * I :  Weight Scheduled
     I                                    P 190 1952P1AUWG
      * I :  Quantity Shipped Total
     I                                    P 196 2012P1CBQT
      * I :  Weight Shipped Total
     I                                    P 202 2072P1ATWG
      * I :  Unit Cost Pricing U_M
     I                                    P 208 2134P1AQCS
      * I :  Unit Cost Per Pound
     I                                    P 214 2194P1AGCS
      * B : MAP Unit Price
     I                                    P 220 2254P1AKPR
      * B : MAP Unit Price_Credit
     I                                    P 226 2314P1ALPR
      * B : MAP Unit Price Ordered U_M
     I                                    P 232 2374P1AUPR
      * I :  Unit Weight Ordered U_M
     I                                    P 238 2432P1AVWG
      * I :  Tare Weight Total
     I                                    P 244 2492P1A4WG
      * I :  Requested Ship Date
     I                                    P 250 2530P1A5DT
      * I :  Scheduled Ship Date
     I                                    P 254 2570P1AODT
      * I :  Actual Shipped Date
     I                                    P 258 2610P1GNDT
      * I :  Affect Inventory Status
     I                                      262 262 P1AMST
      * I :  Affect Sales Doll Status
     I                                      263 263 P1ANST
      * I :  Affect Sales Pnds Status
     I                                      264 264 P1VAST
      * I :  Item Structure Type Code
     I                                    P 265 2660P1RGNB
      * I :  Item Structure Group Code
     I                                    P 267 2680P1RHNB
      * I :  Item Structure Class Code
     I                                    P 269 2700P1RINB
      * I :  Item Level
     I                                      271 272 P1RBCD
      * I :  Quality Level
     I                                      273 274 P1HICD
      * I :  Pricing Product Class Rep
     I                                      275 276 P1RNCD
      * I :  Season Product Class Repo
     I                                      277 278 P1ROCD
      * I :  Date of Original Entry
     I                                    P 279 2820P1CXDT
      * I :  User Profile Name
     I                                      283 292 P1AJVN
      * I :  Country Code
     I                                      293 298 P1KXCD
      * I :  Event Code
     I                                      299 300 P1JPCD
      * I :  Reason Code
     I                                      301 303 P1CQCD
      * I :  Sales Route Code
     I                                      304 306 P1R4CD
      * I :  Modified Flag
     I                                      307 307 P1Z1ST
      * I :  Substituted Flag
     I                                      308 308 P1Z3ST
      * I :  OD Schedule Override Sts
     I                                      309 309 P1Z4ST
      * I :  Invoice Unit Price
     I                                    P 310 3154P1DUPR
      * I :  Invoice Extended Amt
     I                                    P 316 3212P1B6VL
      * I :  Ham Group Number
     I                                    P 322 3230P1A1AA
      * I :  OD Adj Type Override
     I                                      324 324 P1FZSX
      * I :  Affect Trade Fund
     I                                      325 325 P1F0SX
      * I :  Affect Commission
     I                                      326 326 P1F1SX
      * I :  Affect Pricing
     I                                      327 327 P1F2SX
      * I :  Released by User Sts Y_N
     I                                      328 328 P1F3SX
      * I :  Ord TF Exempt Code
     I                                      329 330 P1F4SX
      * I :  OD Pallet Type
     I                                      331 332 P1F5SX
      * I :  Production Warehouse
     I                                      333 335 P1F6SX
      * I :  OD Price Type
     I                                      336 338 P1F7SX
      * I :  Warehouse Pallets Loaded
     I                                    P 339 3420P1NTDT
      * I :  Consumed Item Code
     I                                    P 343 3460P1NUDT
      * I :  Deadline Depart Date LH
     I                                    P 347 3500P1NVDT
      * I :  OD Price Type Ref Num
     I                                    P 351 3540P1NWDT
      * I :  OD Firm Date
     I                                    P 355 3580P1NXDT
      * I :  Deadline Depart Time LH
     I                                    P 359 3620P1BUTM
      * I :  Price Code
     I                                    P 363 3660P1BVTM
      * I :  Maximum Net Weight
     I                                    P 367 3700P1BWTM
      * I :  Substitution Line Number
     I                                    P 371 3740P1BXTM
      * I :  Max Qty to sched per day
     I                                    P 375 3780P1BYTM
      * I :  Warehouse Pallet Tare
     I                                    P 379 3842P1H5NX
      * I :  Warehouse Avg Pallet Tare
     I                                    P 385 3902P1H6NX
     IP2PARM      DS
      * FLD: Company Customer
      * I :  Type Code
     I                                        1   2 P2BOCD
     IP3PARM      DS
      * I :  Company Organization
     I                                        1   1 P3YJSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Send Price MSG to Seaboar'
      * Order Number
     I                                        1   7 ZA0001
      * Order Sequence Number
     I                                    P   8   90ZA0002
      * Item Code
     I                                       10  16 ZA0003
      * Catch Weight Status
     I                                       17  17 ZA0004
      * Unit Price
     I                                    P  18  234ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1AJCD    PARM           WP0006  3        Warehouse Code
     C           P1BKC7    PARM           WP0007  70       Ship To Custome
     C           P1CFC7    PARM           WP0008  70       Order Group Cod
     C           P1GMST    PARM           WP0009  1        Detail Line Sta
     C           P1GNST    PARM           WP0010  1        Detail Line Sta
     C           P1MAVA    PARM           WP0011 112       Billing Detail
     C           P1KDVA    PARM           WP0012 112       Billing Detail
     C           P1L8VA    PARM           WP0013 112       Billing Detail
     C           P1L9VA    PARM           WP0014 112       Quantity to Sub
     C           P1GTST    PARM           WP0015  1        Comment Print A
     C           P1GVST    PARM           WP0016  1        Comment Print I
     C           P1GUST    PARM           WP0017  1        Comment Print P
     C           P1QFST    PARM           WP0018  1        Comment Print S
     C           P1AYVA    PARM P1AYVA    WP0019 112       Extended Amount
     C           P1EXDT    PARM           WP0020  70       Market Pricing
     C           P1LQCD    PARM           WP0021  3        Commodity Marke
     C           P1RDCD    PARM           WP0022  3        Date Method Cod
     C           P1Q7CD    PARM           WP0023  3        Price Method Co
     C           P1BZPR    PARM           WP0024 114       Price Overage O
     C           P1L6NB    PARM           WP0025  70       Contract Number
     C           P1U1ST    PARM           WP0026  1        Price Status
     C           P1GIDT    PARM           WP0027  70       Pricing Date Us
     C           P1CRCD    PARM           WP0028  2        U_M_Base Price
     C           P1AGCD    PARM           WP0029  2        U_M_Ordered
     C           P1RZST    PARM           WP0030  1        Work Confirm St
     C           P1R0ST    PARM           WP0031  1        Work Over_Short
     C           P1R1ST    PARM           WP0032  1        OD Production P
     C           P1G7NA    PARM           WP0033 30        Order Desc_Line
     C           P1G8NA    PARM           WP0034 30        Order Desc_Line
     C           P1RPCD    PARM           WP0035  1        Age Code
     C           P1VEST    PARM           WP0036  1        Palletize
     C           P1VGST    PARM           WP0037  1        Slip Sheet
     C           P1AVST    PARM           WP0038  1        Catch Weight St
     C           P1U0ST    PARM           WP0039  1        Price Audit
     C           P1RFCD    PARM           WP0040  3        Price Audit Rea
     C           P1FZST    PARM           WP0041  1        Production Date
     C           P1R1NB    PARM           WP0042 112       Rated Freight
     C           P1AVQT    PARM           WP0043 112       Quantity Ordere
     C           P1D0WG    PARM           WP0044 112       Weight Ordered
     C           P1CCQT    PARM           WP0045 112       Quantity Schedu
     C           P1AUWG    PARM           WP0046 112       Weight Schedule
     C           P1CBQT    PARM           WP0047 112       Quantity Shippe
     C           P1ATWG    PARM           WP0048 112       Weight Shipped
     C           P1AQCS    PARM           WP0049 114       Unit Cost Prici
     C           P1AGCS    PARM           WP0050 114       Unit Cost Per P
     C           P1AKPR    PARM P1AKPR    WP0051 114       Unit Price
     C           P1ALPR    PARM P1ALPR    WP0052 114       Unit Price_Cred
     C           P1AUPR    PARM P1AUPR    WP0053 114       Unit Price Orde
     C           P1AVWG    PARM           WP0054 112       Unit Weight Ord
     C           P1A4WG    PARM           WP0055 112       Tare Weight Tot
     C           P1A5DT    PARM           WP0056  70       Requested Ship
     C           P1AODT    PARM           WP0057  70       Scheduled Ship
     C           P1GNDT    PARM           WP0058  70       Actual Shipped
     C           P1AMST    PARM           WP0059  1        Affect Inventor
     C           P1ANST    PARM           WP0060  1        Affect Sales Do
     C           P1VAST    PARM           WP0061  1        Affect Sales Pn
     C           P1RGNB    PARM           WP0062  30       Item Structure
     C           P1RHNB    PARM           WP0063  30       Item Structure
     C           P1RINB    PARM           WP0064  30       Item Structure
     C           P1RBCD    PARM           WP0065  2        Item Level
     C           P1HICD    PARM           WP0066  2        Quality Level
     C           P1RNCD    PARM           WP0067  2        Pricing Product
     C           P1ROCD    PARM           WP0068  2        Season Product
     C           P1CXDT    PARM           WP0069  70       Date of Origina
     C           P1AJVN    PARM           WP0070 10        User Profile Na
     C           P1KXCD    PARM           WP0071  6        Country Code
     C           P1JPCD    PARM           WP0072  2        Event Code
     C           P1CQCD    PARM           WP0073  3        Reason Code
     C           P1R4CD    PARM           WP0074  3        Sales Route Cod
     C           P1Z1ST    PARM           WP0075  1        Modified Flag
     C           P1Z3ST    PARM           WP0076  1        Substituted Fla
     C           P1Z4ST    PARM           WP0077  1        OD Schedule Ove
     C           P1DUPR    PARM           WP0078 114       Invoice Unit Pr
     C           P1B6VL    PARM           WP0079 112       Invoice Extende
     C           P1A1AA    PARM           WP0080  30       Ham Group Numbe
     C           P1FZSX    PARM           WP0081  1        OD Adj Type Ove
     C           P1F0SX    PARM           WP0082  1        Affect Trade Fu
     C           P1F1SX    PARM           WP0083  1        Affect Commissi
     C           P1F2SX    PARM           WP0084  1        Affect Pricing
     C           P1F3SX    PARM           WP0085  1        Released by Use
     C           P1F4SX    PARM           WP0086  2        Ord TF Exempt C
     C           P1F5SX    PARM           WP0087  2        OD Pallet Type
     C           P1F6SX    PARM           WP0088  3        Production Ware
     C           P1F7SX    PARM           WP0089  3        OD Price Type
     C           P1NTDT    PARM           WP0090  70       Warehouse Palle
     C           P1NUDT    PARM           WP0091  70       Consumed Item C
     C           P1NVDT    PARM           WP0092  70       Deadline Depart
     C           P1NWDT    PARM           WP0093  70       OD Price Type R
     C           P1NXDT    PARM           WP0094  70       OD Firm Date
     C           P1BUTM    PARM           WP0095  60       Deadline Depart
     C           P1BVTM    PARM           WP0096  60       Price Code
     C           P1BWTM    PARM           WP0097  60       Maximum Net Wei
     C           P1BXTM    PARM           WP0098  60       Substitution Li
     C           P1BYTM    PARM           WP0099  60       Max Qty to sche
     C           P1H5NX    PARM           WP0100 112       Warehouse Palle
     C           P1H6NX    PARM           WP0101 112       Warehouse Avg P
     C           P2BOCD    PARM           WP0102  2        Type Code
     C           P3YJSX    PARM           WP0103  1        Company Organiz
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CLC Price Information XF
      * Price is being changed from the Inter-Co processing
      *         This section is to process the order detail as if the
      *          user entered the price override from the screen
      *          as in the price audit, then after this
      *          process of f13 accept pricing.
     C                     Z-ADDP1AKPR    YL0001           Unit Price Last
     C                     MOVELP1U1ST    YL0002           Price Status La
     C                     Z-ADDP1AYVA    YL0003           Extended Amount
      * CLC Pricing using File XF - Order Detail Pricing  * 
     C                     CALL 'PDOJXFR'              90  CLC Pricing usi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1C4NB    WQ0002  70       Order Number
     C                     PARM P1DPNB    WQ0003  30       Order Sequence
     C                     PARM P1UENB    WQ0004  30       Order Secondary
     C                     PARM YL0004    WQ0005  30       Price Detail Se
     C                     PARM P1HGCD    WQ0006  70       Item Code
     C                     PARM P1Q7CD    WQ0007  3        Price Method Co
     C                     PARM P1AGCD    WQ0008  2        U_M_Ordered
     C           P1AKPR    PARM P1AKPR    WQ0009 114       Unit Price
     C           P1ALPR    PARM P1ALPR    WQ0010 114       Unit Price_Cred
     C           P1AUPR    PARM P1AUPR    WQ0011 114       Unit Price Orde
     C                     PARM '02'      WQ0012  2        Event Called Fr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC 6/17/09 FP1054 pass qty/wgt ordered
      *
     C                     MOVEL*BLANK    WN0001  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0002 112       Unit Weight
     C                     MOVEL*BLANK    WN0003  1        Catch Weight St
     C                     MOVEL*BLANK    WN0004  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0005 114       Price per Pound
     C                     Z-ADD*ZERO     WN0006 112       USR Quantity
     C                     Z-ADD*ZERO     WN0007 112       USR Weight
      *
      * CLC Price,Ext,U/M1Prc  IF
      * *****************************************************************
      * Calculate "Price Per Pound", "Extended Amount", "Primary U/M Pric
      * *****************************************************************
     C                     Z-ADD*ZERO     WN0002           Unit Weight
     C                     MOVEL*BLANK    WN0001           UOM Pricing
     C                     MOVEL*BLANK    WN0003           Catch Weight St
      * Load Quantity Shipped Total field. c2742- do -0- shipped from ord
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           P1CBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1CBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status  c2742 -0- shpe
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1GMST    IFEQ 'L'                        *IF
     C           P1GMST    OREQ 'A'
     C           P1GMST    OREQ 'E'
     C           P1GMST    OREQ 'H'
     C           P1JPCD    IFGE '01'                       *IF
     C           P1JPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADDP1AVQT    WN0006           USR Quantity
     C                     Z-ADDP1D0WG    WN0007           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0006           USR Quantity
     C                     Z-ADDP1ATWG    WN0007           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0013  30       Company Number
     C                     PARM P1HGCD    WQ0014  70       Item Code
     C           WN0001    PARM *BLANK    WQ0015  2        UOM Pricing
     C           WN0002    PARM *ZERO     WQ0016 112       Unit Weight
     C           WN0003    PARM *BLANK    WQ0017  1        Catch Weight St
     C           WN0004    PARM *BLANK    WQ0018  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check retrieve Unit Weight & C/W error
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Catch Weight Status is Y/N Values
      *   |- c3    : PAR.Unit Weight is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WN0003    IFEQ 'N'                        *IF
     C           WN0003    OREQ 'Y'
     C           WN0002    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           *ZERO     IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL*ZERO     WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZA0002           Order Sequence
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           P1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELP1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWN0003    ZA0004           Catch Weight St
     C                     Z-ADD*ZERO     ZA0005           Unit Price
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * CASE: PAR.Price Method Code is Extended
     C           P1Q7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADDP1BZPR    P1AYVA           Extended Amount
      * Calculate Unit Price for Extended
      * CASE: PAR.USR Weight is Not equal zero
     C           WN0007    IFNE 0                          *IF
     C           P1AYVA    DIV  WN0007    P1AKPR    H      Unit Price
     C                     END                             *FI
      * Calculate Pricing U/M Price for Extended
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0006    IFNE 0                          *IF
     C           P1AYVA    DIV  WN0006    P1AUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   |- c3    : PAR.Unit Price - Credit is Not Zeros
      *   |- c5    : PAR.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1GMST    IFEQ 'L'                        *IF
     C           P1GMST    OREQ 'A'
     C           P1GMST    OREQ 'E'
     C           P1GMST    OREQ 'H'
     C           P1JPCD    IFGE '01'                       *IF
     C           P1JPCD    ANDLE'03'
     C           P1ALPR    IFNE 0                          *IF
     C           P1U0ST    IFEQ 'A'                        *IF
     C           P1U0ST    OREQ 'N'
     C           P1U0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced w/consideration for .01 manual price
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: PAR.Price Method Code is Deviated
     C           P1Q7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           P1AYVA    PARM *ZERO     WQ0019 112       Extended Amount
     C                     PARM WN0001    WQ0020  2        U_M_Base Price
     C                     PARM WN0006    WQ0021 112       Quantity Shippe
     C                     PARM WN0007    WQ0022 112       Weight Shipped
     C                     PARM P1BZPR    WQ0023 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1Q7CD    IFEQ 'MAN'                      *IF
     C           P3YJSX    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           P1AYVA    PARM *ZERO     WQ0024 112       Extended Amount
     C                     PARM WN0001    WQ0025  2        U_M_Base Price
     C                     PARM WN0006    WQ0026 112       Quantity Shippe
     C                     PARM WN0007    WQ0027 112       Weight Shipped
     C                     PARM P1BZPR    WQ0028 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1Q7CD    IFEQ 'MAN'                      *IF
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : PAR.Price Overage Override is GT .01
      *   '-
     C           P2BOCD    IFEQ 'IC'                       *IF
     C           P2BOCD    OREQ 'PS'                       *OR
     C           WN0004    OREQ 'UNID'                     *OR
     C           WN0004    OREQ 'OTHER'                    *OR
     C           P1BZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           P1AYVA    PARM *ZERO     WQ0029 112       Extended Amount
     C                     PARM WN0001    WQ0030  2        U_M_Base Price
     C                     PARM WN0006    WQ0031 112       Quantity Shippe
     C                     PARM WN0007    WQ0032 112       Weight Shipped
     C                     PARM P1BZPR    WQ0033 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           P1AYVA    PARM *ZERO     WQ0034 112       Extended Amount
     C                     PARM WN0001    WQ0035  2        U_M_Base Price
     C                     PARM WN0006    WQ0036 112       Quantity Shippe
     C                     PARM WN0007    WQ0037 112       Weight Shipped
     C                     PARM P1ALPR    WQ0038 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           P1AYVA    PARM *ZERO     WQ0039 112       Extended Amount
     C                     PARM WN0001    WQ0040  2        U_M_Base Price
     C                     PARM WN0006    WQ0041 112       Quantity Shippe
     C                     PARM WN0007    WQ0042 112       Weight Shipped
     C                     PARM P1ALPR    WQ0043 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * ** Added Not .01 to force these orders to use Credit Chk Price.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Price is Not Zeros
      *   |- c2    : PAR.Unit Price is Not .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AKPR    IFNE 0                          *IF
     C           P1AKPR    IFNE .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           P1AYVA    PARM *ZERO     WQ0044 112       Extended Amount
     C                     PARM WN0001    WQ0045  2        U_M_Base Price
     C                     PARM WN0006    WQ0046 112       Quantity Shippe
     C                     PARM WN0007    WQ0047 112       Weight Shipped
     C                     PARM P1AKPR    WQ0048 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Unit Price Ordered U/M
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0006    IFNE 0                          *IF
     C           P1AYVA    DIV  WN0006    P1AUPR    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           P1AYVA    PARM *ZERO     WQ0049 112       Extended Amount
     C                     PARM WN0001    WQ0050  2        U_M_Base Price
     C                     PARM WN0006    WQ0051 112       Quantity Shippe
     C                     PARM WN0007    WQ0052 112       Weight Shipped
     C                     PARM P1ALPR    WQ0053 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * CHG OM Price Maint     CH - Order Detail  * 
     C                     EXSR SACHRC
      * CHG Ord  Prt,Prc Sts   CH - Order Header TRG  * 
     C                     EXSR SBCHRC
      * If price status or unit price changes write to log
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Price Status NE LCL.Price Status Last
      *   |- c2    : PAR.Unit Price NE LCL.Unit Price Last
      *   '-
     C           P1U1ST    IFNE YL0002                     *IF
     C           P1AKPR    ORNE YL0001                     *OR
      * RTV Next Audit Seq #   RT - Price Change Audit Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     Z-ADD999       WL0005           Audit Sequence
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WUQQNB           USR Sequence Nu
      * CRT Price Change Audit CR - Price Change Audit Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0007           Company Number
     C                     Z-ADDP1C4NB    WL0008           Order Number
     C                     Z-ADDP1DPNB    WL0009           Order Sequence
     C                     Z-ADDP1UENB    WL0010           Order Secondary
     C                     Z-ADDWUQQNB    WL0011           Audit Sequence
     C                     Z-ADDP1HGCD    WL0012           Item Code
     C                     MOVELP1GMST    WL0013    P      Detail Line Sta
     C                     MOVELP1GMST    WL0014    P      Detail Line Sta
     C                     Z-ADDP1AYVA    WL0015           Extended Amount
     C                     Z-ADDYL0003    WL0016           Extended Amount
     C                     MOVELP1U1ST    WL0017    P      Price Status
     C                     MOVELYL0002    WL0018    P      Price Status La
     C                     MOVELP1U0ST    WL0019    P      Price Audit
     C                     MOVELP1RFCD    WL0020    P      Price Audit Rea
     C                     MOVELP1U0ST    WL0021    P      Price Audit Las
     C                     MOVELP1RFCD    WL0022    P      Price Audit Rea
     C                     Z-ADDP1AKPR    WL0023           Unit Price
     C                     Z-ADDYL0001    WL0024           Unit Price Last
     C                     Z-ADDP1ALPR    WL0025           Unit Price_Cred
     C                     Z-ADDP1ALPR    WL0026           Unit Price - Cr
     C                     MOVELP1JPCD    WL0027    P      Event Code
     C                     MOVELP1JPCD    WL0028    P      Event Code Last
     C                     MOVEL'PM'      WL0029    P      Price Event Cal
     C                     MOVEL##PGM     WL0030    P      Program ID . .
     C                     EXSR SDCRRC
     C                     END                             *FI
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0061  30       Company Number
     C                     PARM P1C4NB    WQ0062  70       Order Number
     C                     PARM P1DPNB    WQ0063  30       Order Sequence
     C                     PARM P1UENB    WQ0064  30       Order Secondary
     C                     PARM 'PM'      WQ0065  3        Pricing Event C
     C           WUB5VL    PARM WUB5VL    WQ0066 112       Order Value Tot
     C           WUA1WG    PARM WUA1WG    WQ0067 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0068  1        Production Hold
     C                     PARM '*NO'     WQ0069  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *----------------------------------------------------------------
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0070  30       Company Number
     C                     PARM P1C4NB    WQ0071  70       Order Number
     C           YL0008    PARM YL0008    WQ0072 112       USR Order Value
     C           YL0009    PARM YL0009    WQ0073 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0074  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0075  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *----------------------------------------------------------------
      * *--THIS IS THE SECTION OF THE F13 accept pricing ----------------
      * *--from the Price Audit Order,  Purva wants this process after th
      * *--above
      * *----------------------------------------------------------------
      * UPD Accept Price Audit RT - Order Detail  * 
     C                     EXSR SERVGN
     C                     MOVEL'M'       YL0010           Price Audit
      * CRT Price Audit Log    CR - WF Price Audit Log Work  * 
     C                     EXSR SGCRRC
      * CHG Price Audit        CH - Order Header TRG  * 
     C                     EXSR SHCHRC
      * *----------------------------------------------------------------
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SACHRC    BEGSR
      *================================================================
      * CHG OM Price Maint     CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  70       Item Code
     C                     MOVEL*BLANK    WN0009  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0010  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0011  70       Order Group Cod
     C                     MOVEL*BLANK    WN0012  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0013  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0014 112       Billing Detail
     C                     Z-ADD*ZERO     WN0015 112       Billing Detail
     C                     Z-ADD*ZERO     WN0016 112       Billing Detail
     C                     Z-ADD*ZERO     WN0017 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0018  1        Comment Print A
     C                     MOVEL*BLANK    WN0019  1        Comment Print I
     C                     MOVEL*BLANK    WN0020  1        Comment Print P
     C                     MOVEL*BLANK    WN0021  1        Comment Print S
     C                     Z-ADD*ZERO     WN0022  70       Contract Number
     C                     MOVEL*BLANK    WN0023  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0024  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0025  1        Work Confirm St
     C                     MOVEL*BLANK    WN0026  1        Work Over_Short
     C                     MOVEL*BLANK    WN0027  1        OD Production P
     C                     MOVEL*BLANK    WN0028 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0029 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0030  1        Age Code
     C                     MOVEL*BLANK    WN0031  1        Palletize
     C                     MOVEL*BLANK    WN0032  1        Slip Sheet
     C                     MOVEL*BLANK    WN0033  1        Catch Weight St
     C                     MOVEL*BLANK    WN0034  1        Price Audit
     C                     MOVEL*BLANK    WN0035  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0036  1        Production Date
     C                     Z-ADD*ZERO     WN0037 112       Rated Freight
     C                     Z-ADD*ZERO     WN0038 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0039 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0040 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0041 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0042 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0043 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0044 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0046 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0047 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0048 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0049  70       Requested Ship
     C                     Z-ADD*ZERO     WN0050  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0051  70       Actual Shipped
     C                     MOVEL*BLANK    WN0052  1        Affect Inventor
     C                     MOVEL*BLANK    WN0053  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0054  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0055  30       Item Structure
     C                     Z-ADD*ZERO     WN0056  30       Item Structure
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     MOVEL*BLANK    WN0058  2        Item Level
     C                     MOVEL*BLANK    WN0059  2        Quality Level
     C                     MOVEL*BLANK    WN0060  2        Pricing Product
     C                     MOVEL*BLANK    WN0061  2        Season Product
     C                     MOVEL*BLANK    WN0062 10        User Profile Na
     C                     MOVEL*BLANK    WN0063  6        Country Code
     C                     MOVEL*BLANK    WN0064  2        Event Code
     C                     MOVEL*BLANK    WN0065  3        Reason Code
     C                     MOVEL*BLANK    WN0066  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0067  1        Modified Flag
     C                     MOVEL*BLANK    WN0068  1        Substituted Fla
     C                     MOVEL*BLANK    WN0069  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0070 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0071 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0072  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0073  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0074  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0075  1        Affect Commissi
     C                     MOVEL*BLANK    WN0076  1        Affect Pricing
     C                     MOVEL*BLANK    WN0077  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0078  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0079  3        Production Ware
     C                     Z-ADD*ZERO     WN0080  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0081  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0082  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0083  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0084  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0085  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0086  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0087  60       Substitution Li
     C                     Z-ADD*ZERO     WN0088  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0089 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0090 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0091 112       OD Item Target
     C                     Z-ADD*ZERO     WN0092 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0093 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0094 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0095 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0096 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0097 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0098 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0099 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0100 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0101  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0102  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0103  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0104 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0105  40       Item Age Days
     C                     Z-ADD*ZERO     WN0106  70       Production Ovr
     C                     Z-ADD*ZERO     WN0107  70       Production Ovr
     C                     MOVEL*BLANK    WN0108  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0109  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0110  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0111  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0112  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0113  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0114  1        EDI Status 1
     C                     MOVEL*BLANK    WN0115  1        EDI Status 2
     C                     MOVEL*BLANK    WN0116  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0117  60       Job Time
     C                     MOVEL*BLANK    WN0118 10        User Id
     C                     MOVEL*BLANK    WN0119 10        Job Name
     C                     Z-ADD*ZERO     WN0120  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
     C                     Z-ADDP1DPNB    WADPNB           Order Sequence
     C                     Z-ADDP1UENB    WAUENB           Order Secondary
      *
     C           KLCHSA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
     C           KLCHSA    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * USER: Processing after Data read
      * E2247 RMC 10/03/12 Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Sent to USDA Sts is yes
     C           WAHOST    IFEQ 'Y'                        *IF
      * If price type changes, then create type: ORDPRT
      * CASE: DB1.OD Price Type NE PAR.OD Price Type
     C           WAF7SX    IFNE P1F7SX                     *IF
      * change log prior has seq in pos 1-3, price type 5-7: '001 NEG
     C                     MOVELWADPNB    YL0005           Text 3 Length U
     C                     Z-ADD1         ZQ      50
     C           YL0005    CAT  WAF7SX:ZQ YL0006    P      Change Log Prio
     C                     MOVEL*BLANK    YL0007           Change Log New
     C                     MOVELP1F7SX    YL0007           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0054  70       Load ID
     C                     PARM 'ORDPRT'  WQ0055  6        Load Change Typ
     C                     PARM 'SLS'     WQ0056  3        Department Cont
     C                     PARM YL0006    WQ0057 12        Change Log Prio
     C                     PARM YL0007    WQ0058 12        Change Log New
     C                     PARM WAAIC3    WQ0059  30       Company Number
     C                     PARM WAC4NB    WQ0060  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @BGWKL0
     C                     Z-ADDP1AYVA    WAAYVA           Extended Amount
     C                     Z-ADDP1EXDT    WAEXDT           Market Pricing
     C                     MOVELP1LQCD    WALQCD    P      Commodity Marke
     C                     MOVELP1RDCD    WARDCD    P      Date Method Cod
     C                     MOVELP1Q7CD    WAQ7CD    P      Price Method Co
     C                     Z-ADDP1BZPR    WABZPR           Price Overage O
     C                     MOVELP1U1ST    WAU1ST    P      Price Status
     C                     Z-ADDWUGIDT    WAGIDT           Pricing Date Us
     C                     Z-ADDP1AKPR    WAAKPR           Unit Price
     C                     Z-ADDP1AUPR    WAAUPR           Unit Price Orde
     C                     Z-ADDP1CXDT    WACXDT           Date of Origina
     C                     MOVELP1F3SX    WAF3SX    P      Released by Use
     C                     MOVELP1F7SX    WAF7SX    P      OD Price Type
     C                     Z-ADDP1BVTM    WABVTM           Price Code
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAAATM' defaulted for 'Job Time'.
      * Field '(DB1) WAAYNA' defaulted for 'User Id'.
      * Field '(DB1) WAA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WAAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Ord  Prt,Prc Sts   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0121  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0122  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0123  70       Ship To Custome
     C                     MOVEL*BLANK    WN0124 30        Ship To Name
     C                     MOVEL*BLANK    WN0125 30        Ship To Address
     C                     MOVEL*BLANK    WN0126 30        Ship To Address
     C                     MOVEL*BLANK    WN0127 30        Ship To Address
     C                     MOVEL*BLANK    WN0128 20        Ship To City
     C                     MOVEL*BLANK    WN0129  2        Ship To State C
     C                     MOVEL*BLANK    WN0130 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0131  70       Bill to Custome
     C                     MOVEL*BLANK    WN0132 30        Bill to Name
     C                     MOVEL*BLANK    WN0133 30        Bill to Address
     C                     MOVEL*BLANK    WN0134 30        Bill to Address
     C                     MOVEL*BLANK    WN0135 30        Bill to Address
     C                     MOVEL*BLANK    WN0136 20        Bill to City
     C                     MOVEL*BLANK    WN0137  2        Bill to State C
     C                     MOVEL*BLANK    WN0138 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0139 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0140  70       Order Date
     C                     Z-ADD*ZERO     WN0141  70       Requested Ship
     C                     Z-ADD*ZERO     WN0142  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0143  70       Cancel Date
     C                     MOVEL*BLANK    WN0144  2        Terms Code
     C                     MOVEL*BLANK    WN0145 40        Special Instruc
     C                     MOVEL*BLANK    WN0146 40        Special Instruc
     C                     MOVEL*BLANK    WN0147  3        Carrier Code
     C                     MOVEL*BLANK    WN0148  1        Comment Print A
     C                     MOVEL*BLANK    WN0149  1        Comment Print I
     C                     MOVEL*BLANK    WN0150  1        Comment Print P
     C                     MOVEL*BLANK    WN0151  1        Comment Print S
     C                     MOVEL*BLANK    WN0152  3        Reason Code
     C                     MOVEL*BLANK    WN0153  1        Order in Use
     C                     MOVEL*BLANK    WN0154  1        Header Status
     C                     MOVEL*BLANK    WN0155  1        Header Status L
     C                     Z-ADD*ZERO     WN0156  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0157 10        User Original E
     C                     Z-ADD*ZERO     WN0158  70       Date of Origina
     C                     Z-ADD*ZERO     WN0159 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0160 112       Order Weight To
     C                     MOVEL*BLANK    WN0161  1        Credit Hold
     C                     MOVEL*BLANK    WN0162  1        Production Hold
     C                     MOVEL*BLANK    WN0163  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0164  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0165  40       Requested Deliv
     C                     MOVEL*BLANK    WN0166  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0167 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0168  70       Load ID
     C                     Z-ADD*ZERO     WN0169  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0170 112       Rated Freight
     C                     MOVEL*BLANK    WN0171  1        LTL Flag
     C                     MOVEL*BLANK    WN0172  1        Price Audit
     C                     MOVEL*BLANK    WN0173  2        Shipping Method
     C                     MOVEL*BLANK    WN0174  1        Export Status
     C                     MOVEL*BLANK    WN0175  1        Palletize
     C                     MOVEL*BLANK    WN0176  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0177  1        Slip Sheet
     C                     MOVEL*BLANK    WN0178  1        Age Code
     C                     Z-ADD*ZERO     WN0179  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0180  1        Load Type
     C                     Z-ADD*ZERO     WN0181  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0182  1        Load Plan Order
     C                     MOVEL*BLANK    WN0183  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0184  70       Resell Referenc
     C                     MOVEL*BLANK    WN0185 30        Special Comment
     C                     MOVEL*BLANK    WN0186 30        Special Comment
     C                     MOVEL*BLANK    WN0187  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0188  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0189  2        Manager Level C
     C                     MOVEL*BLANK    WN0190  3        VP Level Code
     C                     Z-ADD*ZERO     WN0191  70       Attach to Order
     C                     MOVEL*BLANK    WN0192  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0193  70       Invoice Number
     C                     MOVEL*BLANK    WN0194  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0195  70       Invoice Date
     C                     MOVEL*BLANK    WN0196  2        Event Code
     C                     MOVEL*BLANK    WN0197  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0198  1        Modified Flag
     C                     Z-ADD*ZERO     WN0199 112       A_R order Value
     C                     MOVEL*BLANK    WN0200  1        Billing Activit
     C                     MOVEL*BLANK    WN0201  1        Block Order Fla
     C                     MOVEL*BLANK    WN0202  1        Order Certifica
     C                     Z-ADD*ZERO     WN0203 112       Invoice Order V
     C                     MOVEL*BLANK    WN0204  1        Process Sts for
     C                     MOVEL*BLANK    WN0205  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0206  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0207  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0208  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0209  1        Email Cust On O
     C                     MOVEL*BLANK    WN0210  1        Order Emailed
     C                     MOVEL*BLANK    WN0211  1        Export Docs Go
     C                     MOVEL*BLANK    WN0212  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0213  1        Broker Order St
     C                     MOVEL*BLANK    WN0214  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0215  2        Order Requires
     C                     MOVEL*BLANK    WN0216  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0217  2        Export USDA App
     C                     MOVEL*BLANK    WN0218  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0219  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0220  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0221  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0222  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0223  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0224  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0225  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0226  60       Time of Origina
     C                     Z-ADD*ZERO     WN0227  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0228  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0229  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0230 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0231 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0232 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0233 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0234 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0235  70       Claim Number
     C                     MOVEL*BLANK    WN0236  1        EDI Status 1
     C                     MOVEL*BLANK    WN0237  1        EDI Status 2
     C                     MOVEL*BLANK    WN0238  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0239  60       Job Time
     C                     MOVEL*BLANK    WN0240 10        User Id
     C                     MOVEL*BLANK    WN0241 10        Job Name
     C                     Z-ADD*ZERO     WN0242  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSB    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       WBGYST    P      Order Type Prin
     C                     MOVEL'U'       WBU1ST    P      Price Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
     C                     MOVELWBJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWBANC7    PAANC7           AR Customer Num
     C                     Z-ADDWBBKC7    PABKC7           Ship To Custome
     C                     MOVELWBBRTX    PABRTX    P      Ship To Name
     C                     MOVELWBHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWBHONA    PAHONA    P      Ship To Address
     C                     MOVELWBHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PAHNNA    P      Ship To City
     C                     MOVELWBDBCD    PADBCD    P      Ship To State C
     C                     MOVELWBCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWBB0C7    PAB0C7           Bill to Custome
     C                     MOVELWBAETX    PAAETX    P      Bill to Name
     C                     MOVELWBB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PAB2NA    P      Bill to City
     C                     MOVELWBBHCD    PABHCD    P      Bill to State C
     C                     MOVELWBC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWBBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PAA0DT           Order Date
     C                     Z-ADDWBA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PAACDT           Cancel Date
     C                     MOVELWBAQCD    PAAQCD    P      Terms Code
     C                     MOVELWBB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PABYNA    P      Special Instruc
     C                     MOVELWBBZNA    PABZNA    P      Carrier Code
     C                     MOVELWBGTST    PAGTST    P      Comment Print A
     C                     MOVELWBGVST    PAGVST    P      Comment Print I
     C                     MOVELWBGUST    PAGUST    P      Comment Print P
     C                     MOVELWBQFST    PAQFST    P      Comment Print S
     C                     MOVELWBCQCD    PACQCD    P      Reason Code
     C                     MOVELWBGJST    PAGJST    P      Order in Use
     C                     MOVELWBGWST    PAGWST    P      Header Status
     C                     MOVELWBGXST    PAGXST    P      Header Status L
     C                     MOVELWBGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PAAODT           Scheduled Ship
     C                     MOVELWBAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PACXDT           Date of Origina
     C                     Z-ADDWBJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PAA1WG           Order Weight To
     C                     MOVELWBXIST    PAXIST    P      Credit Hold
     C                     MOVELWBXJST    PAXJST    P      Production Hold
     C                     MOVELWBXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PAAFTM           Requested Deliv
     C                     MOVELWBE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PAR1NB           Rated Freight
     C                     MOVELWBPJST    PAPJST    P      LTL Flag
     C                     MOVELWBU0ST    PAU0ST    P      Price Audit
     C                     MOVELWBU1ST    PAU1ST    P      Price Status
     C                     MOVELWBQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PAU2ST    P      Export Status
     C                     MOVELWBVEST    PAVEST    P      Palletize
     C                     MOVELWBVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PAVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PARPCD    P      Age Code
     C                     Z-ADDWBRNNB    PARNNB           Reefer Temperat
     C                     MOVELWBVDST    PAVDST    P      Load Type
     C                     Z-ADDWBATIN    PAATIN           Attach to Invoi
     C                     MOVELWBU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PARSRN           Resell Referenc
     C                     MOVELWBMHNA    PAMHNA    P      Special Comment
     C                     MOVELWBMINA    PAMINA    P      Special Comment
     C                     MOVELWBWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PABFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PAT3NB           Attach to Order
     C                     MOVELWBSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PACONB           Invoice Number
     C                     MOVELWBCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PAAWDT           Invoice Date
     C                     MOVELWBJPCD    PAJPCD    P      Event Code
     C                     MOVELWBXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PAVRVA           A_R order Value
     C                     MOVELWBOBST    PAOBST    P      Billing Activit
     C                     MOVELWBBCST    PABCST    P      Block Order Fla
     C                     MOVELWBBDST    PABDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PAB7VL           Invoice Order V
     C                     MOVELWBGASX    PAGASX    P      Process Sts for
     C                     MOVELWBGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PAFUSX    P      Order Requires
     C                     MOVELWBFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWBFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PABQTM           Time of Origina
     C                     Z-ADDWBBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWBH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWBH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PAC0C7           Claim Number
     C                     MOVELWBUVST    PAUVST    P      EDI Status 1
     C                     MOVELWBUWST    PAUWST    P      EDI Status 2
     C                     MOVELWBUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PAAATM           Job Time
     C                     MOVELWBAYNA    PAAYNA    P      User Id
     C                     MOVELWBA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Next Audit Seq #   RT - Price Change Audit Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WCDPNB    WQSC03           Order Sequence
     C           *LIKE     DEFN WCUENB    WQSC04           Order Secondary
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
     C                     KFLD           WCASNO           Audit Sequence
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     Z-ADDWL0002    WQSC02           Order Number
     C                     Z-ADDWL0003    WQSC03           Order Sequence
     C                     Z-ADDWL0004    WQSC04           Order Secondary
     C                     Z-ADDWL0005    WCASNO           Audit Sequence
      * Establish starting position
     C           KPSSC     SETLL@K3CPKR                    *
     C           KRSSC     READE@K3CPKR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2378' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0006           USR Sequence Nu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WCASNO    ADD  1         WL0006           USR Sequence Nu
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@K3CPKR                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * CRT Price Change Audit CR - Price Change Audit Log  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0243  1        EDI Status 1
     C                     MOVEL*BLANK    WN0244  1        EDI Status 2
     C                     MOVEL*BLANK    WN0245  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0246  60       Job Time
     C                     MOVEL*BLANK    WN0247 10        User Id
     C                     MOVEL*BLANK    WN0248 10        Job Name
     C                     Z-ADD*ZERO     WN0249  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @K3CPKP
     C                     Z-ADDWL0007    WDAIC3           Company Number
     C                     Z-ADDWL0008    WDC4NB           Order Number
     C                     Z-ADDWL0009    WDDPNB           Order Sequence
     C                     Z-ADDWL0010    WDUENB           Order Secondary
     C                     Z-ADDWL0011    WDASNO           Audit Sequence
     C                     Z-ADDWL0012    WDHGCD           Item Code
     C                     MOVELWL0013    WDGMST           Detail Line Sta
     C                     MOVELWL0014    WDGNST           Detail Line Sta
     C                     Z-ADDWL0015    WDAYVA           Extended Amount
     C                     Z-ADDWL0016    WDYJVA           Extended Amount
     C                     MOVELWL0017    WDU1ST           Price Status
     C                     MOVELWL0018    WDPSTL           Price Status La
     C                     MOVELWL0019    WDU0ST           Price Audit
     C                     MOVELWL0020    WDRFCD           Price Audit Rea
     C                     MOVELWL0021    WDPALS           Price Audit Las
     C                     MOVELWL0022    WDWWCD           Price Audit Rea
     C                     Z-ADDWL0023    WDAKPR           Unit Price
     C                     Z-ADDWL0024    WDDBPR           Unit Price Last
     C                     Z-ADDWL0025    WDALPR           Unit Price_Cred
     C                     Z-ADDWL0026    WDDCPR           Unit Price - Cr
     C                     MOVELWL0027    WDJPCD           Event Code
     C                     MOVELWL0028    WDWXCD           Event Code Last
     C                     MOVELWL0029    WDPREC           Price Event Cal
     C                     MOVELWL0030    WDPIDX           Program ID . .
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C                     KFLD           WDASNO           Audit Sequence
      * Check for duplicate primary key
     C           KLCRSD    SETLL@K3CPKP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2379' W0RTN   7
      * Send message 'Price Change Audit Log EX'
     C                     MOVEL'USR2379' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@K3CPKP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPD Accept Price Audit RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP1C4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKF9                    *
     C           KRSSE     READE@BGWKF9                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WEGMST    IFEQ 'L'                        *IF
     C           WEGMST    OREQ 'A'
     C           WEGMST    OREQ 'C'
     C           WEGMST    OREQ 'R'
     C           WEGMST    OREQ 'E'
     C           WEGMST    OREQ 'H'
     C           WEGMST    OREQ 'I'
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     Z-ADDWEC4NB    WL0002           Order Number
     C                     Z-ADDWEDPNB    WL0003           Order Sequence
     C                     Z-ADDWEUENB    WL0004           Order Secondary
     C                     Z-ADD999       WL0005           Audit Sequence
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WUQQNB           USR Sequence Nu
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0007           Company Number
     C                     Z-ADDWEC4NB    WL0008           Order Number
     C                     Z-ADDWEDPNB    WL0009           Order Sequence
     C                     Z-ADDWEUENB    WL0010           Order Secondary
     C                     Z-ADDWUQQNB    WL0011           Audit Sequence
     C                     Z-ADDWEHGCD    WL0012           Item Code
     C                     MOVELWEGMST    WL0013    P      Detail Line Sta
     C                     MOVELWEGNST    WL0014    P      Detail Line Sta
     C                     Z-ADDWEAYVA    WL0015           Extended Amount
     C                     Z-ADDWEAYVA    WL0016           Extended Amount
     C                     MOVELWEU1ST    WL0017    P      Price Status
     C                     MOVELWEU1ST    WL0018    P      Price Status La
     C                     MOVEL'M'       WL0019    P      Price Audit
     C                     MOVEL*BLANK    WL0020           Price Audit Rea
     C                     MOVELWEU0ST    WL0021    P      Price Audit Las
     C                     MOVELWERFCD    WL0022    P      Price Audit Rea
     C                     Z-ADDWEAKPR    WL0023           Unit Price
     C                     Z-ADDWEAKPR    WL0024           Unit Price Last
     C                     Z-ADDWEALPR    WL0025           Unit Price_Cred
     C                     Z-ADDWEALPR    WL0026           Unit Price - Cr
     C                     MOVELWEJPCD    WL0027    P      Event Code
     C                     MOVELWEJPCD    WL0028    P      Event Code Last
     C                     MOVEL'PA'      WL0029    P      Price Event Cal
     C                     MOVEL##PGM     WL0030    P      Program ID . .
     C                     EXSR SDCRRC
      * CHG Price Audit        CH - PD Order Detail  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
     C           KRSSE     READE@BGWKF9                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG Price Audit        CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0250  70       Item Code
     C                     MOVEL*BLANK    WN0251  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0252  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0253  70       Order Group Cod
     C                     MOVEL*BLANK    WN0254  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0255  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0256 112       Billing Detail
     C                     Z-ADD*ZERO     WN0257 112       Billing Detail
     C                     Z-ADD*ZERO     WN0258 112       Billing Detail
     C                     Z-ADD*ZERO     WN0259 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0260  1        Comment Print A
     C                     MOVEL*BLANK    WN0261  1        Comment Print I
     C                     MOVEL*BLANK    WN0262  1        Comment Print P
     C                     MOVEL*BLANK    WN0263  1        Comment Print S
     C                     Z-ADD*ZERO     WN0264 112       Extended Amount
     C                     Z-ADD*ZERO     WN0265  70       Market Pricing
     C                     MOVEL*BLANK    WN0266  3        Commodity Marke
     C                     MOVEL*BLANK    WN0267  3        Date Method Cod
     C                     MOVEL*BLANK    WN0268  3        Price Method Co
     C                     Z-ADD*ZERO     WN0269 114       Price Overage O
     C                     Z-ADD*ZERO     WN0270  70       Contract Number
     C                     MOVEL*BLANK    WN0271  1        Price Status
     C                     Z-ADD*ZERO     WN0272  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0273  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0274  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0275  1        Work Confirm St
     C                     MOVEL*BLANK    WN0276  1        Work Over_Short
     C                     MOVEL*BLANK    WN0277  1        OD Production P
     C                     MOVEL*BLANK    WN0278 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0279 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0280  1        Age Code
     C                     MOVEL*BLANK    WN0281  1        Palletize
     C                     MOVEL*BLANK    WN0282  1        Slip Sheet
     C                     MOVEL*BLANK    WN0283  1        Catch Weight St
     C                     MOVEL*BLANK    WN0284  1        Production Date
     C                     Z-ADD*ZERO     WN0285 112       Rated Freight
     C                     Z-ADD*ZERO     WN0286 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0287 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0288 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0289 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0290 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0291 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0292 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0293 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0294 114       Unit Price
     C                     Z-ADD*ZERO     WN0295 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0296 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0297 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0298 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0299  70       Requested Ship
     C                     Z-ADD*ZERO     WN0300  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0301  70       Actual Shipped
     C                     MOVEL*BLANK    WN0302  1        Affect Inventor
     C                     MOVEL*BLANK    WN0303  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0304  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0305  30       Item Structure
     C                     Z-ADD*ZERO     WN0306  30       Item Structure
     C                     Z-ADD*ZERO     WN0307  30       Item Structure
     C                     MOVEL*BLANK    WN0308  2        Item Level
     C                     MOVEL*BLANK    WN0309  2        Quality Level
     C                     MOVEL*BLANK    WN0310  2        Pricing Product
     C                     MOVEL*BLANK    WN0311  2        Season Product
     C                     Z-ADD*ZERO     WN0312  70       Date of Origina
     C                     MOVEL*BLANK    WN0313 10        User Profile Na
     C                     MOVEL*BLANK    WN0314  6        Country Code
     C                     MOVEL*BLANK    WN0315  2        Event Code
     C                     MOVEL*BLANK    WN0316  3        Reason Code
     C                     MOVEL*BLANK    WN0317  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0318  1        Modified Flag
     C                     MOVEL*BLANK    WN0319  1        Substituted Fla
     C                     MOVEL*BLANK    WN0320  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0321 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0322 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0323  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0324  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0325  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0326  1        Affect Commissi
     C                     MOVEL*BLANK    WN0327  1        Affect Pricing
     C                     MOVEL*BLANK    WN0328  1        Released by Use
     C                     MOVEL*BLANK    WN0329  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0330  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0331  3        Production Ware
     C                     MOVEL*BLANK    WN0332  3        OD Price Type
     C                     Z-ADD*ZERO     WN0333  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0334  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0335  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0336  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0337  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0338  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0339  60       Price Code
     C                     Z-ADD*ZERO     WN0340  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0341  60       Substitution Li
     C                     Z-ADD*ZERO     WN0342  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0343 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0344 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0345 112       OD Item Target
     C                     Z-ADD*ZERO     WN0346 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0347 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0348 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0349 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0350 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0351 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0352 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0353 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0354 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0355 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0356  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0357  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0358  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0359 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0360  40       Item Age Days
     C                     Z-ADD*ZERO     WN0361  70       Production Ovr
     C                     Z-ADD*ZERO     WN0362  70       Production Ovr
     C                     MOVEL*BLANK    WN0363  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0364  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0365  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0366  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0367  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0368  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0369  1        EDI Status 1
     C                     MOVEL*BLANK    WN0370  1        EDI Status 2
     C                     MOVEL*BLANK    WN0371  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0372  60       Job Time
     C                     MOVEL*BLANK    WN0373 10        User Id
     C                     MOVEL*BLANK    WN0374 10        Job Name
     C                     Z-ADD*ZERO     WN0375  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWEAIC3    WAAIC3           Company Number
     C                     Z-ADDWEC4NB    WAC4NB           Order Number
     C                     Z-ADDWEDPNB    WADPNB           Order Sequence
     C                     Z-ADDWEUENB    WAUENB           Order Secondary
      *
     C           KLCHSF    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
     C           KLCHSF    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL'M'       WAU0ST    P      Price Audit
     C                     MOVEL*BLANK    WARFCD    P      Price Audit Rea
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * CRT Price Audit Log    CR - WF Price Audit Log Work  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0376  1        EDI Status 1
     C                     MOVEL*BLANK    WN0377  1        EDI Status 2
     C                     MOVEL*BLANK    WN0378  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0379  60       Job Time
     C                     MOVEL*BLANK    WN0380 10        User Id
     C                     MOVEL*BLANK    WN0381 10        Job Name
     C                     Z-ADD*ZERO     WN0382  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KXCPI4
     C                     Z-ADDP1AIC3    WFAIC3           Company Number
     C                     Z-ADDP1C4NB    WFC4NB           Order Number
     C                     MOVELP1R4CD    WFBCCD           Salesperson Cod
     C                     Z-ADD##JDT     WFB4DT           Transaction Dat
     C                     Z-ADD##JTM     WFAPTM           Time
     C                     MOVEL'PAU'     WFUPDP           Update Point
     C                     MOVELYL0010    WFU0ST           Price Audit
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C                     MOVEL##PGM     WFA0NA           Job Name
     C           KLCRSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFBCCD           Salesperson Cod
     C                     KFLD           WFB4DT           Transaction Dat
     C                     KFLD           WFAPTM           Time
     C                     KFLD           WFUPDP           Update Point
      * Check for duplicate primary key
     C           KLCRSG    SETLL@KXCPI4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2323' W0RTN   7
      * Send message 'WF Price Audit Log Wor EX'
     C                     MOVEL'USR2323' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@KXCPI4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * CHG Price Audit        CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0383  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0384  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0385  70       Ship To Custome
     C                     MOVEL*BLANK    WN0386 30        Ship To Name
     C                     MOVEL*BLANK    WN0387 30        Ship To Address
     C                     MOVEL*BLANK    WN0388 30        Ship To Address
     C                     MOVEL*BLANK    WN0389 30        Ship To Address
     C                     MOVEL*BLANK    WN0390 20        Ship To City
     C                     MOVEL*BLANK    WN0391  2        Ship To State C
     C                     MOVEL*BLANK    WN0392 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0393  70       Bill to Custome
     C                     MOVEL*BLANK    WN0394 30        Bill to Name
     C                     MOVEL*BLANK    WN0395 30        Bill to Address
     C                     MOVEL*BLANK    WN0396 30        Bill to Address
     C                     MOVEL*BLANK    WN0397 30        Bill to Address
     C                     MOVEL*BLANK    WN0398 20        Bill to City
     C                     MOVEL*BLANK    WN0399  2        Bill to State C
     C                     MOVEL*BLANK    WN0400 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0401 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0402  70       Order Date
     C                     Z-ADD*ZERO     WN0403  70       Requested Ship
     C                     Z-ADD*ZERO     WN0404  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0405  70       Cancel Date
     C                     MOVEL*BLANK    WN0406  2        Terms Code
     C                     MOVEL*BLANK    WN0407 40        Special Instruc
     C                     MOVEL*BLANK    WN0408 40        Special Instruc
     C                     MOVEL*BLANK    WN0409  3        Carrier Code
     C                     MOVEL*BLANK    WN0410  1        Comment Print A
     C                     MOVEL*BLANK    WN0411  1        Comment Print I
     C                     MOVEL*BLANK    WN0412  1        Comment Print P
     C                     MOVEL*BLANK    WN0413  1        Comment Print S
     C                     MOVEL*BLANK    WN0414  3        Reason Code
     C                     MOVEL*BLANK    WN0415  1        Order in Use
     C                     MOVEL*BLANK    WN0416  1        Header Status
     C                     MOVEL*BLANK    WN0417  1        Header Status L
     C                     MOVEL*BLANK    WN0418  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0419  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0420 10        User Original E
     C                     Z-ADD*ZERO     WN0421  70       Date of Origina
     C                     Z-ADD*ZERO     WN0422 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0423 112       Order Weight To
     C                     MOVEL*BLANK    WN0424  1        Credit Hold
     C                     MOVEL*BLANK    WN0425  1        Production Hold
     C                     MOVEL*BLANK    WN0426  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0427  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0428  40       Requested Deliv
     C                     MOVEL*BLANK    WN0429  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0430 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0431  70       Load ID
     C                     Z-ADD*ZERO     WN0432  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0433 112       Rated Freight
     C                     MOVEL*BLANK    WN0434  1        LTL Flag
     C                     MOVEL*BLANK    WN0435  1        Price Status
     C                     MOVEL*BLANK    WN0436  2        Shipping Method
     C                     MOVEL*BLANK    WN0437  1        Export Status
     C                     MOVEL*BLANK    WN0438  1        Palletize
     C                     MOVEL*BLANK    WN0439  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0440  1        Slip Sheet
     C                     MOVEL*BLANK    WN0441  1        Age Code
     C                     Z-ADD*ZERO     WN0442  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0443  1        Load Type
     C                     Z-ADD*ZERO     WN0444  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0445  1        Load Plan Order
     C                     MOVEL*BLANK    WN0446  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0447  70       Resell Referenc
     C                     MOVEL*BLANK    WN0448 30        Special Comment
     C                     MOVEL*BLANK    WN0449 30        Special Comment
     C                     MOVEL*BLANK    WN0450  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0451  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0452  2        Manager Level C
     C                     MOVEL*BLANK    WN0453  3        VP Level Code
     C                     Z-ADD*ZERO     WN0454  70       Attach to Order
     C                     MOVEL*BLANK    WN0455  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0456  70       Invoice Number
     C                     MOVEL*BLANK    WN0457  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0458  70       Invoice Date
     C                     MOVEL*BLANK    WN0459  2        Event Code
     C                     MOVEL*BLANK    WN0460  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0461  1        Modified Flag
     C                     Z-ADD*ZERO     WN0462 112       A_R order Value
     C                     MOVEL*BLANK    WN0463  1        Billing Activit
     C                     MOVEL*BLANK    WN0464  1        Block Order Fla
     C                     MOVEL*BLANK    WN0465  1        Order Certifica
     C                     Z-ADD*ZERO     WN0466 112       Invoice Order V
     C                     MOVEL*BLANK    WN0467  1        Process Sts for
     C                     MOVEL*BLANK    WN0468  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0469  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0470  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0471  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0472  1        Email Cust On O
     C                     MOVEL*BLANK    WN0473  1        Order Emailed
     C                     MOVEL*BLANK    WN0474  1        Export Docs Go
     C                     MOVEL*BLANK    WN0475  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0476  1        Broker Order St
     C                     MOVEL*BLANK    WN0477  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0478  2        Order Requires
     C                     MOVEL*BLANK    WN0479  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0480  2        Export USDA App
     C                     MOVEL*BLANK    WN0481  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0482  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0483  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0484  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0485  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0486  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0487  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0488  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0489  60       Time of Origina
     C                     Z-ADD*ZERO     WN0490  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0491  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0492  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0493 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0494 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0495 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0496 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0497 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0498  70       Claim Number
     C                     MOVEL*BLANK    WN0499  1        EDI Status 1
     C                     MOVEL*BLANK    WN0500  1        EDI Status 2
     C                     MOVEL*BLANK    WN0501  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0502  60       Job Time
     C                     MOVEL*BLANK    WN0503 10        User Id
     C                     MOVEL*BLANK    WN0504 10        Job Name
     C                     Z-ADD*ZERO     WN0505  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      *
     C           KLCHSH    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSH    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELYL0010    WBU0ST    P      Price Audit
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
     C                     MOVELWBJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWBANC7    PAANC7           AR Customer Num
     C                     Z-ADDWBBKC7    PABKC7           Ship To Custome
     C                     MOVELWBBRTX    PABRTX    P      Ship To Name
     C                     MOVELWBHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWBHONA    PAHONA    P      Ship To Address
     C                     MOVELWBHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PAHNNA    P      Ship To City
     C                     MOVELWBDBCD    PADBCD    P      Ship To State C
     C                     MOVELWBCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWBB0C7    PAB0C7           Bill to Custome
     C                     MOVELWBAETX    PAAETX    P      Bill to Name
     C                     MOVELWBB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PAB2NA    P      Bill to City
     C                     MOVELWBBHCD    PABHCD    P      Bill to State C
     C                     MOVELWBC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWBBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PAA0DT           Order Date
     C                     Z-ADDWBA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PAACDT           Cancel Date
     C                     MOVELWBAQCD    PAAQCD    P      Terms Code
     C                     MOVELWBB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PABYNA    P      Special Instruc
     C                     MOVELWBBZNA    PABZNA    P      Carrier Code
     C                     MOVELWBGTST    PAGTST    P      Comment Print A
     C                     MOVELWBGVST    PAGVST    P      Comment Print I
     C                     MOVELWBGUST    PAGUST    P      Comment Print P
     C                     MOVELWBQFST    PAQFST    P      Comment Print S
     C                     MOVELWBCQCD    PACQCD    P      Reason Code
     C                     MOVELWBGJST    PAGJST    P      Order in Use
     C                     MOVELWBGWST    PAGWST    P      Header Status
     C                     MOVELWBGXST    PAGXST    P      Header Status L
     C                     MOVELWBGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PAAODT           Scheduled Ship
     C                     MOVELWBAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PACXDT           Date of Origina
     C                     Z-ADDWBJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PAA1WG           Order Weight To
     C                     MOVELWBXIST    PAXIST    P      Credit Hold
     C                     MOVELWBXJST    PAXJST    P      Production Hold
     C                     MOVELWBXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PAAFTM           Requested Deliv
     C                     MOVELWBE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PAR1NB           Rated Freight
     C                     MOVELWBPJST    PAPJST    P      LTL Flag
     C                     MOVELWBU0ST    PAU0ST    P      Price Audit
     C                     MOVELWBU1ST    PAU1ST    P      Price Status
     C                     MOVELWBQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PAU2ST    P      Export Status
     C                     MOVELWBVEST    PAVEST    P      Palletize
     C                     MOVELWBVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PAVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PARPCD    P      Age Code
     C                     Z-ADDWBRNNB    PARNNB           Reefer Temperat
     C                     MOVELWBVDST    PAVDST    P      Load Type
     C                     Z-ADDWBATIN    PAATIN           Attach to Invoi
     C                     MOVELWBU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PARSRN           Resell Referenc
     C                     MOVELWBMHNA    PAMHNA    P      Special Comment
     C                     MOVELWBMINA    PAMINA    P      Special Comment
     C                     MOVELWBWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PABFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PAT3NB           Attach to Order
     C                     MOVELWBSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PACONB           Invoice Number
     C                     MOVELWBCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PAAWDT           Invoice Date
     C                     MOVELWBJPCD    PAJPCD    P      Event Code
     C                     MOVELWBXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PAVRVA           A_R order Value
     C                     MOVELWBOBST    PAOBST    P      Billing Activit
     C                     MOVELWBBCST    PABCST    P      Block Order Fla
     C                     MOVELWBBDST    PABDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PAB7VL           Invoice Order V
     C                     MOVELWBGASX    PAGASX    P      Process Sts for
     C                     MOVELWBGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PAFUSX    P      Order Requires
     C                     MOVELWBFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWBFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PABQTM           Time of Origina
     C                     Z-ADDWBBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWBH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWBH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PAC0C7           Claim Number
     C                     MOVELWBUVST    PAUVST    P      EDI Status 1
     C                     MOVELWBUWST    PAUWST    P      EDI Status 2
     C                     MOVELWBUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PAAATM           Job Time
     C                     MOVELWBAYNA    PAAYNA    P      User Id
     C                     MOVELWBA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Quantity Shipped Total
     C                     Z-ADD*ZERO     WUCBQT 112
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Pricing Date Used
     C                     Z-ADD*ZERO     WUGIDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A_R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Sequence Num. New ATR
     C                     Z-ADD*ZERO     WUQQNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCASNO           Audit Sequence
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCYJVA           Extended Amount
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCDBPR           Unit Price Last
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCDCPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Clear all neither parameters
      * CRT Price Change Audit CR - Price Change Audit Log  * 
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Production Hold
     C                     MOVEL*BLANK    WUXJST  1
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WFAPTM           Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  30
      * Define local variables for subroutine SDCRRC.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  3
     C                     Z-ADD*ZERO     WL0023 114
     C                     Z-ADD*ZERO     WL0024 114
     C                     Z-ADD*ZERO     WL0025 114
     C                     Z-ADD*ZERO     WL0026 114
     C                     MOVEL*BLANK    WL0027  2
     C                     MOVEL*BLANK    WL0028  2
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030 10
      * Define local work field Unit Price Last
     C                     Z-ADD*ZERO     YL0001 114
      * Define local work field Price Status Last
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Extended Amount Last
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Price Detail Sequence
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0006 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0007 12
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field Price Audit
     C                     MOVEL*BLANK    YL0010  1
      *================================================================
     CSR         ZZEXIT    ENDSR
