// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWH1PVR
// ?Date: 14.08.2025 Time: 02:56:31
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?E14473 JJH 02/08/19 - Add PT SQL Format
//?E14322 JJH 01/06/19 - Copy Producer Trading Partner
//?USER: Load screen

MOVE *ALL (To: DTL From: PAR);

// DTL.PT FTP Method USR = DTL.PT FTP Method
DTL.PT_FTP_Method_USR = DTL.PT_FTP_Method;

// DTL.PT SQL Format USR = DTL.PT SQL Format
DTL.PT_SQL_Format_USR = DTL.PT_SQL_Format;

// DTL.PT Summary View USR = DTL.PT Summary View
DTL.PT_Summary_View_USR = DTL.PT_Summary_View;

// DTL.PT Detail View USR = DTL.PT Detail View
DTL.PT_Detail_View_USR = DTL.PT_Detail_View;

//?USER: Validate fields

EXECUTE FUNCTION(Rtv Producer Trd PtMthRT) TYPE(RTVOBJ) FILE(PLB6REP)           AB1322407;
PARAMETER(DTL.PT_Producer_Trade_Pft_USR);
PARAMETER(NLL.PT_FTP_Method);
PARAMETER(NLL.PT_Summary_View);
PARAMETER(NLL.PT_Detail_View);
PARAMETER(NLL.PT_SQL_Format);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// Send error message - 'Producer Trading Partner &1 already exists.'
ERROR(PRK1521);
MSGPARM(DTL.PT_Producer_Trade_Pft_USR);

ENDIF;

//?USER: User defined action

EXECUTE FUNCTION(Crt Producer Trade PtnCR) TYPE(CRTOBJ) FILE(PLB6REP)           AB1322293;
PARAMETER(DTL.PT_Producer_Trade_Pft_USR);
PARAMETER(DTL.PT_Prod_Trade_Ptnr_Nm_USR);
PARAMETER(DTL.PT_FTP_Method_USR);
PARAMETER(DTL.PT_Summary_View_USR);
PARAMETER(DTL.PT_Detail_View_USR);
PARAMETER(DTL.PT_SQL_Format);
PARAMETER('A');
PARAMETER(DTL.RS_Job);
PARAMETER(DTL.RS_Program);
PARAMETER(DTL.RS_User_Added);
PARAMETER(DTL.RS_Date_Added);
PARAMETER(DTL.RS_Time_Added);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?Execute internal function

  // PAR.RS Record Status = CND.Active
  PAR.RS_Record_Status = 'A';

  // PAR.RS User Added = JOB.*USER
  PAR.RS_User_Added = JOB.*USER;

  // PAR.RS Date Added = JOB.*Job date
  PAR.RS_Date_Added = JOB.*Job_date;

  // PAR.RS Time Added = JOB.*Job time
  PAR.RS_Time_Added = JOB.*Job_time;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

 }

}


