     H/TITLE Rtv Crt ManDtl Test    XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 12/05/24  Time  : 02:57:21
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFNCPL1  IF   E           K DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FOMFNCPL0  UF A E           K DISK
      * UPD : Manifest Detail           Update index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QOMFN1        E DS                  EXTNAME(OMFNCPL0)
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     D  WBAIC3       E                     EXTFLD(FNAIC3)
     D  WBC4NB       E                     EXTFLD(FNC4NB)
     D  WBDPNB       E                     EXTFLD(FNDPNB)
     D  WBUENB       E                     EXTFLD(FNUENB)
     D  WBRZNB       E                     EXTFLD(FNRZNB)
     D  WBFOQT       E                     EXTFLD(FNFOQT)
     D  WBR0NB       E                     EXTFLD(FNR0NB)
     D  WBPMST       E                     EXTFLD(FNPMST)
     D  WBK7DT       E                     EXTFLD(FNK7DT)
     D  WBPFNX       E                     EXTFLD(FNPFNX)
     D  WBHGCD       E                     EXTFLD(FNHGCD)
     D  WBAJCD       E                     EXTFLD(FNAJCD)
     D  WBELDT       E                     EXTFLD(FNELDT)
     D  WBN5WG       E                     EXTFLD(FNN5WG)
     D  WBRZNA       E                     EXTFLD(FNRZNA)
     D  WBH5NY       E                     EXTFLD(FNH5NY)
     D  WBH6NY       E                     EXTFLD(FNH6NY)
     D  WBH7NY       E                     EXTFLD(FNH7NY)
     D  WBGBTX       E                     EXTFLD(FNGBTX)
     D  WBN6WG       E                     EXTFLD(FNN6WG)
     D  WBN7WG       E                     EXTFLD(FNN7WG)
     D  WBGCTX       E                     EXTFLD(FNGCTX)
     D  WBGDTX       E                     EXTFLD(FNGDTX)
     D  WBRBDT       E                     EXTFLD(FNRBDT)
     D  WBITNY       E                     EXTFLD(FNITNY)
     D  WBIVNY       E                     EXTFLD(FNIVNY)
     D  WBIUNY       E                     EXTFLD(FNIUNY)
     D  WBIWNY       E                     EXTFLD(FNIWNY)
     D  WBIXNY       E                     EXTFLD(FNIXNY)
     D  WBIYNY       E                     EXTFLD(FNIYNY)
     D  WBUVST       E                     EXTFLD(FNUVST)
     D  WBUWST       E                     EXTFLD(FNUWST)
     D  WBUXST       E                     EXTFLD(FNUXST)
     D  WBVSST       E                     EXTFLD(FNVSST)
     D  WBAATM       E                     EXTFLD(FNAATM)
     D  WBAYNA       E                     EXTFLD(FNAYNA)
     D  WBA0NA       E                     EXTFLD(FNA0NA)
     D  WBAXDT       E                     EXTFLD(FNAXDT)
     D  WBLPNZ       E                     EXTFLD(FNLPNZ)
      *
     D YARDCS          DS           179
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              1
     D  YL0002         S              1
     D  YL0003         S              1
     D  YL0004         S              1
     D  YL0005         S              1
     D  YL0006         S              1
     D  YL0007         S              1
     D  YL0008         S              1
     D  ZADFMF         S             10
     D  YL0009         S              1
     D  YL0010         S              1
     D  YARDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
     D                 DS
     D  ZAMSDA                 1    132
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                      WAAIC3
     I              FNC4NB                      WAC4NB
     I              FNDPNB                      WADPNB
     I              FNUENB                      WAUENB
     I              FNRZNB                      WARZNB
     I              FNFOQT                      WAFOQT
     I              FNR0NB                      WAR0NB
     I              FNPMST                      WAPMST
     I              FNK7DT                      WAK7DT
     I              FNPFNX                      WAPFNX
     I              FNHGCD                      WAHGCD
     I              FNAJCD                      WAAJCD
     I              FNELDT                      WAELDT
     I              FNN5WG                      WAN5WG
     I              FNRZNA                      WARZNA
     I              FNH5NY                      WAH5NY
     I              FNH6NY                      WAH6NY
     I              FNH7NY                      WAH7NY
     I              FNGBTX                      WAGBTX
     I              FNN6WG                      WAN6WG
     I              FNN7WG                      WAN7WG
     I              FNGCTX                      WAGCTX
     I              FNGDTX                      WAGDTX
     I              FNRBDT                      WARBDT
     I              FNITNY                      WAITNY
     I              FNIVNY                      WAIVNY
     I              FNIUNY                      WAIUNY
     I              FNIWNY                      WAIWNY
     I              FNIXNY                      WAIXNY
     I              FNIYNY                      WAIYNY
     I              FNUVST                      WAUVST
     I              FNUWST                      WAUWST
     I              FNUXST                      WAUXST
     I              FNVSST                      WAVSST
     I              FNAATM                      WAAATM
     I              FNAYNA                      WAAYNA
     I              FNA0NA                      WAA0NA
     I              FNAXDT                      WAAXDT
     I              FNLPNZ                      WALPNZ
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                      WBAIC3
     I              FNC4NB                      WBC4NB
     I              FNDPNB                      WBDPNB
     I              FNUENB                      WBUENB
     I              FNRZNB                      WBRZNB
     I              FNFOQT                      WBFOQT
     I              FNR0NB                      WBR0NB
     I              FNPMST                      WBPMST
     I              FNK7DT                      WBK7DT
     I              FNPFNX                      WBPFNX
     I              FNHGCD                      WBHGCD
     I              FNAJCD                      WBAJCD
     I              FNELDT                      WBELDT
     I              FNN5WG                      WBN5WG
     I              FNRZNA                      WBRZNA
     I              FNH5NY                      WBH5NY
     I              FNH6NY                      WBH6NY
     I              FNH7NY                      WBH7NY
     I              FNGBTX                      WBGBTX
     I              FNN6WG                      WBN6WG
     I              FNN7WG                      WBN7WG
     I              FNGCTX                      WBGCTX
     I              FNGDTX                      WBGDTX
     I              FNRBDT                      WBRBDT
     I              FNITNY                      WBITNY
     I              FNIVNY                      WBIVNY
     I              FNIUNY                      WBIUNY
     I              FNIWNY                      WBIWNY
     I              FNIXNY                      WBIXNY
     I              FNIYNY                      WBIYNY
     I              FNUVST                      WBUVST
     I              FNUWST                      WBUWST
     I              FNUXST                      WBUXST
     I              FNVSST                      WBVSST
     I              FNAATM                      WBAATM
     I              FNAYNA                      WBAYNA
     I              FNA0NA                      WBA0NA
     I              FNAXDT                      WBAXDT
     I              FNLPNZ                      WBLPNZ
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Rtv Crt ManDtl Test    XF
      * Rtv Crt ManDtl Test    RT - Manifest Detail  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Crt ManDtl Test    RT - Manifest Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WADPNB                         Order Sequence
     C                   KFLD                    WAUENB                         Order Secondary
     C                   KFLD                    WARZNB                         Case Sequence N
      * Setup key
     C                   Z-ADD     440           WAAIC3                         Company Number
     C                   Z-ADD     2632809       WAC4NB                         Order Number
     C                   Z-ADD     1             WADPNB                         Order Sequence
     C                   Z-ADD     1             WAUENB                         Order Secondary
     C                   Z-ADD     313           WARZNB                         Case Sequence N
      * Establish starting position
     C     KRSSA         SETGT     @FNCPCT                              91      *
     C                   READP     @FNCPCT                              9190    *
      * Check high order keys
     C  N90              IF        440 <> WAAIC3 OR
     C                             2632809 <> WAC4NB OR
     C                             1 <> WADPNB OR
     C                             1 <> WAUENB
     C                   SETON                                        90
     C                   END
      *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1196'     W0RTN
      * USER: Processing if Data record not found
      * Crt Manifest Detail   CR - Manifest Detail  * 
     C                   EXSR      SBCRRC
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CHG OM Manifest Detail CH - Manifest Detail  * 
     C                   IF        NOT *IN90
     C                   EXSR      SCCHRC
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBCRRC        BEGSR
      *================================================================
      * Crt Manifest Detail   CR - Manifest Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @FNCPCS
     C                   Z-ADD     440           WBAIC3                         Company Number
     C                   Z-ADD     2632809       WBC4NB                         Order Number
     C                   Z-ADD     1             WBDPNB                         Order Sequence
     C                   Z-ADD     1             WBUENB                         Order Secondary
     C                   Z-ADD     313           WBRZNB                         Case Sequence N
     C                   Z-ADD     10            WBFOQT                         Case Quantity
     C                   Z-ADD     10            WBR0NB                         Case Weight
     C                   MOVEL     YL0001        WBPMST                         Inventory Updat
     C                   Z-ADD     *ZERO         WBK7DT                         Label Date
     C                   Z-ADD     *ZERO         WBPFNX                         PT Serial Numbe
     C                   Z-ADD     *ZERO         WBHGCD                         Item Code
     C                   EVAL      WBAJCD = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WBELDT                         Production Date
     C                   Z-ADD     *ZERO         WBN5WG                         Manifest Gross
     C                   EVAL      WBRZNA = ' '                                 Manifest Lot ID
     C                   Z-ADD     *ZERO         WBH5NY                         Manifest Total
     C                   Z-ADD     *ZERO         WBH6NY                         Manifest Co_Par
     C                   Z-ADD     *ZERO         WBH7NY                         Manifest Pallet
     C                   MOVEL     YL0002        WBGBTX                         Manifest Shift
     C                   Z-ADD     *ZERO         WBN6WG                         HPB Meter Net G
     C                   Z-ADD     *ZERO         WBN7WG                         Manifest Net We
     C                   MOVEL     YL0003        WBGCTX                         Manifest Unused
     C                   MOVEL     YL0004        WBGDTX                         Manifest Unused
     C                   Z-ADD     *ZERO         WBRBDT                         Manifest Unused
     C                   Z-ADD     *ZERO         WBITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WBIVNY                         HPB Meter Start
     C                   Z-ADD     *ZERO         WBIUNY                         HPB Meter Endin
     C                   Z-ADD     *ZERO         WBIWNY                         HPB Meter Total
     C                   Z-ADD     *ZERO         WBIXNY                         HPB Meter Net W
     C                   Z-ADD     *ZERO         WBIYNY                         HPB Density Ref
     C                   MOVEL     YL0005        WBUVST                         EDI Status 1
     C                   MOVEL     YL0006        WBUWST                         EDI Status 2
     C                   MOVEL     YL0007        WBUXST                         EDI Status 3
     C                   MOVEL     YL0008        WBVSST                         Record Status
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   EVAL      WBAYNA = ' '                                 User Id
     C                   EVAL      WBA0NA = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
     C                   Z-ADD     *ZERO         WBLPNZ                         Manifest Pallet
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                   MOVEL     'A'           WBVSST                         Record Status
     C                   Z-ADD     ##JTM         WBAATM                         Job Time
     C                   MOVEL     ##USR         WBAYNA                         User Id
     C                   MOVEL     ##PGM         WBA0NA                         Job Name
     C                   Z-ADD     ##JDT         WBAXDT                         Job Date
     C     KLCRSB        KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
     C                   KFLD                    WBDPNB                         Order Sequence
     C                   KFLD                    WBUENB                         Order Secondary
     C                   KFLD                    WBRZNB                         Case Sequence N
      * Check for duplicate primary key
     C     KLCRSB        SETLL     @FNCPCS                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR1197'     W0RTN
      * Send message 'Manifest Detail        EX'
     C                   MOVEL     'USR1197'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
     C                   WRITE     @FNCPCS                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCHRC        BEGSR
      *================================================================
      * CHG OM Manifest Detail CH - Manifest Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @FNCPCS
     C                   Z-ADD     WAAIC3        WBAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WBC4NB                         Order Number
     C                   Z-ADD     WADPNB        WBDPNB                         Order Sequence
     C                   Z-ADD     WAUENB        WBUENB                         Order Secondary
     C                   Z-ADD     WARZNB        WBRZNB                         Case Sequence N
      *
     C     KLCHSC        KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
     C                   KFLD                    WBDPNB                         Order Sequence
     C                   KFLD                    WBUENB                         Order Secondary
     C                   KFLD                    WBRZNB                         Case Sequence N
     C     KLCHSC        CHAIN     @FNCPCS                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OMFNCPL0'    MDACP
     C                   MOVEL     '@FNCPCS'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOMFN1        YARDCS
      * Move non-key fields to @FNCPCS
     C                   Z-ADD     100           WBFOQT                         Case Quantity
     C                   Z-ADD     100           WBR0NB                         Case Weight
     C                   MOVEL(P)  WAPMST        WBPMST                         Inventory Updat
     C                   Z-ADD     WAK7DT        WBK7DT                         Label Date
     C                   Z-ADD     WAPFNX        WBPFNX                         PT Serial Numbe
     C                   Z-ADD     WAHGCD        WBHGCD                         Item Code
     C                   MOVEL(P)  WAAJCD        WBAJCD                         Warehouse Code
     C                   Z-ADD     WAELDT        WBELDT                         Production Date
     C                   Z-ADD     WAN5WG        WBN5WG                         Manifest Gross
     C                   MOVEL(P)  WARZNA        WBRZNA                         Manifest Lot ID
     C                   Z-ADD     WAH5NY        WBH5NY                         Manifest Total
     C                   Z-ADD     WAH6NY        WBH6NY                         Manifest Co_Par
     C                   Z-ADD     WAH7NY        WBH7NY                         Manifest Pallet
     C                   MOVEL(P)  WAGBTX        WBGBTX                         Manifest Shift
     C                   Z-ADD     WAN6WG        WBN6WG                         HPB Meter Net G
     C                   Z-ADD     WAN7WG        WBN7WG                         Manifest Net We
     C                   MOVEL(P)  WAGCTX        WBGCTX                         Manifest Unused
     C                   MOVEL(P)  WAGDTX        WBGDTX                         Manifest Unused
     C                   Z-ADD     WARBDT        WBRBDT                         Manifest Unused
     C                   Z-ADD     WAITNY        WBITNY                         HPB COA Batch N
     C                   Z-ADD     WAIVNY        WBIVNY                         HPB Meter Start
     C                   Z-ADD     WAIUNY        WBIUNY                         HPB Meter Endin
     C                   Z-ADD     WAIWNY        WBIWNY                         HPB Meter Total
     C                   Z-ADD     WAIXNY        WBIXNY                         HPB Meter Net W
     C                   Z-ADD     WAIYNY        WBIYNY                         HPB Density Ref
     C                   MOVEL(P)  WAUVST        WBUVST                         EDI Status 1
     C                   MOVEL(P)  WAUWST        WBUWST                         EDI Status 2
     C                   MOVEL(P)  WAUXST        WBUXST                         EDI Status 3
     C                   MOVEL(P)  WAVSST        WBVSST                         Record Status
     C                   Z-ADD     WAAATM        WBAATM                         Job Time
     C                   MOVEL(P)  WAAYNA        WBAYNA                         User Id
     C                   MOVEL(P)  WAA0NA        WBA0NA                         Job Name
     C                   Z-ADD     WAAXDT        WBAXDT                         Job Date
     C                   Z-ADD     WALPNZ        WBLPNZ                         Manifest Pallet
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFN1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAATM' defaulted for 'Job Time'.
      * Field '(DB1) WBAYNA' defaulted for 'User Id'.
      * Field '(DB1) WBA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WBAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                   Z-ADD     ##JTM         WBAATM                         Job Time
     C                   MOVEL     ##USR         WBAYNA                         User Id
     C                   MOVEL     ##JOB         WBA0NA                         Job Name
     C                   Z-ADD     ##JDT         WBAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFN1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @FNCPCS                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OMFNCPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
     C                   MOVEL     'Y'           YL0009                         USR Update Flag
     C                   MOVEL     'Y'           YL0010                         COA RIN Modifie
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WADPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WAUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WARZNB                         Case Sequence N
     C                   Z-ADD     *ZERO         WAFOQT                         Case Quantity
     C                   Z-ADD     *ZERO         WAR0NB                         Case Weight
     C                   Z-ADD     *ZERO         WAK7DT                         Label Date
     C                   Z-ADD     *ZERO         WAPFNX                         PT Serial Numbe
     C                   Z-ADD     *ZERO         WAHGCD                         Item Code
     C                   Z-ADD     *ZERO         WAELDT                         Production Date
     C                   Z-ADD     *ZERO         WAN5WG                         Manifest Gross
     C                   Z-ADD     *ZERO         WAH5NY                         Manifest Total
     C                   Z-ADD     *ZERO         WAH6NY                         Manifest Co_Par
     C                   Z-ADD     *ZERO         WAH7NY                         Manifest Pallet
     C                   Z-ADD     *ZERO         WAN6WG                         HPB Meter Net G
     C                   Z-ADD     *ZERO         WAN7WG                         Manifest Net We
     C                   Z-ADD     *ZERO         WARBDT                         Manifest Unused
     C                   Z-ADD     *ZERO         WAITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WAIVNY                         HPB Meter Start
     C                   Z-ADD     *ZERO         WAIUNY                         HPB Meter Endin
     C                   Z-ADD     *ZERO         WAIWNY                         HPB Meter Total
     C                   Z-ADD     *ZERO         WAIXNY                         HPB Meter Net W
     C                   Z-ADD     *ZERO         WAIYNY                         HPB Density Ref
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
     C                   Z-ADD     *ZERO         WALPNZ                         Manifest Pallet
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
     C                   MOVEL     'N'           W0PMT
      * Define local work field Inventory Updated Flag
     C                   EVAL      YL0001 = ' '
      * Define local work field Manifest Shift
     C                   EVAL      YL0002 = ' '
      * Define local work field Manifest Unused Status 1A
     C                   EVAL      YL0003 = ' '
      * Define local work field Manifest Unused Status 2A
     C                   EVAL      YL0004 = ' '
      * Define local work field EDI Status 1
     C                   EVAL      YL0005 = ' '
      * Define local work field EDI Status 2
     C                   EVAL      YL0006 = ' '
      * Define local work field EDI Status 3
     C                   EVAL      YL0007 = ' '
      * Define local work field Record Status
     C                   EVAL      YL0008 = ' '
      * Define local work field USR Update Flag
     C                   EVAL      YL0009 = ' '
      * Define local work field COA RIN Modified Sts
     C                   EVAL      YL0010 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
