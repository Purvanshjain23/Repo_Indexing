     H/TITLE UPD Match Cust RecSts  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 06/08/17  Time  : 15:02:33
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNGKREL2IF  E           K        DISK
      * RSQ : Customer Freight Rate     Customer/Company/Chg Dat
      *
     FPDISREL3IF  E           K        DISK
      * RSQ : Company Customer Item     Customer/Company/Item
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPNGKREL0UF  E           K        DISK
      * UPD : Customer Freight Rate     Update index
      *
     FPDISREL0UF  E           K        DISK
      * UPD : Company Customer Item     Update index
      *
     FPOBIREL0UF  E           K        DISK
      * UPD : Customer Item Reference   Update index
      *
     FPDNEREL0UF  E           K        DISK
      * UPD : Customer EXT              Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@GKRENN
      * Customer Freight Rate     Customer/Company/Chg Dat
      * Renamed input format fields
     I              GKAIC3                          WAAIC3
     I              GKBKC7                          WABKC7
     I              GKMKDT                          WAMKDT
     I              GKBFTM                          WABFTM
     I              GKTBNB                          WATBNB
     I              GKVSST                          WAVSST
     I              GKAATM                          WAAATM
     I              GKAYNA                          WAAYNA
     I              GKA0NA                          WAA0NA
     I              GKAXDT                          WAAXDT
      *
     I@GKREHL
      * Customer Freight Rate     Update index
      * Renamed input format fields
     I              GKAIC3                          WBAIC3
     I              GKBKC7                          WBBKC7
     I              GKMKDT                          WBMKDT
     I              GKBFTM                          WBBFTM
     I              GKTBNB                          WBTBNB
     I              GKVSST                          WBVSST
     I              GKAATM                          WBAATM
     I              GKAYNA                          WBAYNA
     I              GKA0NA                          WBA0NA
     I              GKAXDT                          WBAXDT
      *
     I@ISRENM
      * Company Customer Item     Customer/Company/Item
      * Renamed input format fields
     I              ISAIC3                          WCAIC3
     I              ISBKC7                          WCBKC7
     I              ISHGCD                          WCHGCD
     I              ISERDT                          WCERDT
     I              ISESDT                          WCESDT
     I              ISBWPR                          WCBWPR
     I              ISBLPR                          WCBLPR
     I              ISBXPR                          WCBXPR
     I              ISBYPR                          WCBYPR
     I              ISLQCD                          WCLQCD
     I              ISUVST                          WCUVST
     I              ISUWST                          WCUWST
     I              ISUXST                          WCUXST
     I              ISVSST                          WCVSST
     I              ISAATM                          WCAATM
     I              ISAYNA                          WCAYNA
     I              ISA0NA                          WCA0NA
     I              ISAXDT                          WCAXDT
      *
     I@ISREV5
      * Company Customer Item     Update index
      * Renamed input format fields
     I              ISAIC3                          WDAIC3
     I              ISBKC7                          WDBKC7
     I              ISHGCD                          WDHGCD
     I              ISERDT                          WDERDT
     I              ISESDT                          WDESDT
     I              ISBWPR                          WDBWPR
     I              ISBLPR                          WDBLPR
     I              ISBXPR                          WDBXPR
     I              ISBYPR                          WDBYPR
     I              ISLQCD                          WDLQCD
     I              ISUVST                          WDUVST
     I              ISUWST                          WDUWST
     I              ISUXST                          WDUXST
     I              ISVSST                          WDVSST
     I              ISAATM                          WDAATM
     I              ISAYNA                          WDAYNA
     I              ISA0NA                          WDA0NA
     I              ISAXDT                          WDAXDT
      *
     I@BIREKY
      * Customer Item Reference   Retrieval index
      * Renamed input format fields
     I              BIBKC7                          WEBKC7
     I              BIHGCD                          WEHGCD
     I              BICOAA                          WECOAA
     I              BICPAA                          WECPAA
     I              BIPSNA                          WEPSNA
     I              BIPTNA                          WEPTNA
     I              BIPUNA                          WEPUNA
     I              BILBSX                          WELBSX
     I              BILCSX                          WELCSX
     I              BILDSX                          WELDSX
     I              BILESX                          WELESX
     I              BILFSX                          WELFSX
     I              BIVSST                          WEVSST
     I              BIMJDT                          WEMJDT
     I              BIBETM                          WEBETM
     I              BICCVN                          WECCVN
     I              BICDVN                          WECDVN
     I              BIMKDT                          WEMKDT
     I              BIBFTM                          WEBFTM
     I              BICEVN                          WECEVN
     I              BICFVN                          WECFVN
      *
     I@BIREKX
      * Customer Item Reference   Update index
      * Renamed input format fields
     I              BIBKC7                          WFBKC7
     I              BIHGCD                          WFHGCD
     I              BICOAA                          WFCOAA
     I              BICPAA                          WFCPAA
     I              BIPSNA                          WFPSNA
     I              BIPTNA                          WFPTNA
     I              BIPUNA                          WFPUNA
     I              BILBSX                          WFLBSX
     I              BILCSX                          WFLCSX
     I              BILDSX                          WFLDSX
     I              BILESX                          WFLESX
     I              BILFSX                          WFLFSX
     I              BIVSST                          WFVSST
     I              BIMJDT                          WFMJDT
     I              BIBETM                          WFBETM
     I              BICCVN                          WFCCVN
     I              BICDVN                          WFCDVN
     I              BIMKDT                          WFMKDT
     I              BIBFTM                          WFBFTM
     I              BICEVN                          WFCEVN
     I              BICFVN                          WFCFVN
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WGBKC7
     I              NEUFTX                          WGUFTX
     I              NEUGTX                          WGUGTX
     I              NEPFNA                          WGPFNA
     I              NEJ5NX                          WGJ5NX
     I              NEU5TX                          WGU5TX
     I              NEU6TX                          WGU6TX
     I              NEW0TX                          WGW0TX
     I              NEHSSX                          WGHSSX
     I              NEHUSX                          WGHUSX
     I              NEHVSX                          WGHVSX
     I              NEAAC8                          WGAAC8
     I              NEP0SX                          WGP0SX
     I              NEP1SX                          WGP1SX
     I              NEP2SX                          WGP2SX
     I              NEP3SX                          WGP3SX
     I              NEP4SX                          WGP4SX
     I              NEP5SX                          WGP5SX
     I              NEP6SX                          WGP6SX
     I              NEUVST                          WGUVST
     I              NEUWST                          WGUWST
     I              NEUXST                          WGUXST
     I              NEVSST                          WGVSST
     I              NEAATM                          WGAATM
     I              NEAYNA                          WGAYNA
     I              NEA0NA                          WGA0NA
     I              NEAXDT                          WGAXDT
      *
     I@NEREAS
      * Customer EXT              Update index
      * Renamed input format fields
     I              NEBKC7                          WHBKC7
     I              NEUFTX                          WHUFTX
     I              NEUGTX                          WHUGTX
     I              NEPFNA                          WHPFNA
     I              NEJ5NX                          WHJ5NX
     I              NEU5TX                          WHU5TX
     I              NEU6TX                          WHU6TX
     I              NEW0TX                          WHW0TX
     I              NEHSSX                          WHHSSX
     I              NEHUSX                          WHHUSX
     I              NEHVSX                          WHHVSX
     I              NEAAC8                          WHAAC8
     I              NEP0SX                          WHP0SX
     I              NEP1SX                          WHP1SX
     I              NEP2SX                          WHP2SX
     I              NEP3SX                          WHP3SX
     I              NEP4SX                          WHP4SX
     I              NEP5SX                          WHP5SX
     I              NEP6SX                          WHP6SX
     I              NEUVST                          WHUVST
     I              NEUWST                          WHUWST
     I              NEUXST                          WHUXST
     I              NEVSST                          WHVSST
     I              NEAATM                          WHAATM
     I              NEAYNA                          WHAYNA
     I              NEA0NA                          WHA0NA
     I              NEAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPNGK1    E DSPNGKREL0
      * UPD : Customer Freight Rate     Update index
      * Renamed input format fields
     I              GKAIC3                          WBAIC3
     I              GKBKC7                          WBBKC7
     I              GKMKDT                          WBMKDT
     I              GKBFTM                          WBBFTM
     I              GKTBNB                          WBTBNB
     I              GKVSST                          WBVSST
     I              GKAATM                          WBAATM
     I              GKAYNA                          WBAYNA
     I              GKA0NA                          WBA0NA
     I              GKAXDT                          WBAXDT
      *
     IYARDCS      DS                             46
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDIS1    E DSPDISREL0
      * UPD : Company Customer Item     Update index
      * Renamed input format fields
     I              ISAIC3                          WDAIC3
     I              ISBKC7                          WDBKC7
     I              ISHGCD                          WDHGCD
     I              ISERDT                          WDERDT
     I              ISESDT                          WDESDT
     I              ISBWPR                          WDBWPR
     I              ISBLPR                          WDBLPR
     I              ISBXPR                          WDBXPR
     I              ISBYPR                          WDBYPR
     I              ISLQCD                          WDLQCD
     I              ISUVST                          WDUVST
     I              ISUWST                          WDUWST
     I              ISUXST                          WDUXST
     I              ISVSST                          WDVSST
     I              ISAATM                          WDAATM
     I              ISAYNA                          WDAYNA
     I              ISA0NA                          WDA0NA
     I              ISAXDT                          WDAXDT
      *
     IYBRDCS      DS                             77
     IQPOBI1    E DSPOBIREL0
      * UPD : Customer Item Reference   Update index
      * Renamed input format fields
     I              BIBKC7                          WFBKC7
     I              BIHGCD                          WFHGCD
     I              BICOAA                          WFCOAA
     I              BICPAA                          WFCPAA
     I              BIPSNA                          WFPSNA
     I              BIPTNA                          WFPTNA
     I              BIPUNA                          WFPUNA
     I              BILBSX                          WFLBSX
     I              BILCSX                          WFLCSX
     I              BILDSX                          WFLDSX
     I              BILESX                          WFLESX
     I              BILFSX                          WFLFSX
     I              BIVSST                          WFVSST
     I              BIMJDT                          WFMJDT
     I              BIBETM                          WFBETM
     I              BICCVN                          WFCCVN
     I              BICDVN                          WFCDVN
     I              BIMKDT                          WFMKDT
     I              BIBFTM                          WFBFTM
     I              BICEVN                          WFCEVN
     I              BICFVN                          WFCFVN
      *
     IYCRDCS      DS                            188
     IQPDNE1    E DSPDNEREL0
      * UPD : Customer EXT              Update index
      * Renamed input format fields
     I              NEBKC7                          WHBKC7
     I              NEUFTX                          WHUFTX
     I              NEUGTX                          WHUGTX
     I              NEPFNA                          WHPFNA
     I              NEJ5NX                          WHJ5NX
     I              NEU5TX                          WHU5TX
     I              NEU6TX                          WHU6TX
     I              NEW0TX                          WHW0TX
     I              NEHSSX                          WHHSSX
     I              NEHUSX                          WHHUSX
     I              NEHVSX                          WHHVSX
     I              NEAAC8                          WHAAC8
     I              NEP0SX                          WHP0SX
     I              NEP1SX                          WHP1SX
     I              NEP2SX                          WHP2SX
     I              NEP3SX                          WHP3SX
     I              NEP4SX                          WHP4SX
     I              NEP5SX                          WHP5SX
     I              NEP6SX                          WHP6SX
     I              NEUVST                          WHUVST
     I              NEUWST                          WHUWST
     I              NEUXST                          WHUXST
     I              NEVSST                          WHVSST
     I              NEAATM                          WHAATM
     I              NEAYNA                          WHAYNA
     I              NEA0NA                          WHA0NA
     I              NEAXDT                          WHAXDT
      *
     IYDRDCS      DS                            189
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Customer
      * I : RST Ship To Customer
     I                                    P   1   40P1BKC7
      * I :  Record Status
     I                                        5   5 P1VSST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BKC7    PARM           WP0001  70       Ship To Custome
     C           P1VSST    PARM           WP0002  1        Record Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Match Cust RecSts  XF
      * Set Customer's associated file rec status to match customer's
     C                     EXSR UASUBR                     Set Customer's
      * ***** Changes and Comments
     C                     EXSR UBSUBR                     ***** Changes a
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * VAL Cust Frt Rt Exists RT - Customer Freight Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABKC7    WQSA01           Ship To Custome
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSA01           Ship To Custome
      * Establish starting position
     C           KRSSA     SETLL@GKRENN                    *
     C           KRSSA     READE@GKRENN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4357' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSA     READE@GKRENN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV/UPD Cst Frt Rt Sts RT - Customer Freight Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABKC7    WQSB01           Ship To Custome
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAMKDT           Change Date
     C                     KFLD           WABFTM           Change Time
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSB01           Ship To Custome
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Establish starting position
     C           KPSSB     SETLL@GKRENN                    *
     C           KRSSB     READE@GKRENN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4357' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status NE PAR.Record Status
     C           WAVSST    IFNE P1VSST                     *IF
      * CHG Cust Frt Rate Sts  CH - Customer Freight Rate  * 
     C                     EXSR SCCHRC
     C                     END                             *FI
     C           KRSSB     READE@GKRENN                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * CHG Cust Frt Rate Sts  CH - Customer Freight Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @GKREHL
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWABKC7    WBBKC7           Ship To Custome
     C                     Z-ADDWAMKDT    WBMKDT           Change Date
     C                     Z-ADDWABFTM    WBBFTM           Change Time
      *
     C           KLCHSC    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
     C                     KFLD           WBMKDT           Change Date
     C                     KFLD           WBBFTM           Change Time
     C           KLCHSC    CHAIN@GKREHL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PNGKREL0'MDACP
     C                     MOVEL'@GKREHL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPNGK1    YARDCS
      * Move non-key fields to @GKREHL
     C                     Z-ADDWATBNB    WBTBNB           Absorbed Freigh
     C                     MOVELP1VSST    WBVSST    P      Record Status
     C                     Z-ADDWAAATM    WBAATM           Job Time
     C                     MOVELWAAYNA    WBAYNA    P      User Id
     C                     MOVELWAA0NA    WBA0NA    P      Job Name
     C                     Z-ADDWAAXDT    WBAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPNGK1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPNGK1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@GKREHL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPNGKREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Val Customer exists    RT - Company Customer Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBKC7    WQSD01           Ship To Custome
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSD01           Ship To Custome
      * Establish starting position
     C           KRSSD     SETLL@ISRENM                    *
     C           KRSSD     READE@ISRENM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1687' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSD     READE@ISRENM                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV CoCust Item Status RT - Company Customer Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBKC7    WQSE01           Ship To Custome
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSE01           Ship To Custome
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
      * Establish starting position
     C           KPSSE     SETLL@ISRENM                    *
     C           KRSSE     READE@ISRENM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1687' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG CoCust Item Status CH - Company Customer Item  * 
     C                     EXSR SFCHRC
     C           KRSSE     READE@ISRENM                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG CoCust Item Status CH - Company Customer Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ISREV5
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCBKC7    WDBKC7           Ship To Custome
     C                     Z-ADDWCHGCD    WDHGCD           Item Code
      *
     C           KLCHSF    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBKC7           Ship To Custome
     C                     KFLD           WDHGCD           Item Code
     C           KLCHSF    CHAIN@ISREV5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDISREL0'MDACP
     C                     MOVEL'@ISREV5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIS1    YBRDCS
      * USER: Processing after Data read
      * DB1 = PAR By name
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCBKC7    WDBKC7           Ship To Custome
     C                     Z-ADDWCHGCD    WDHGCD           Item Code
     C                     Z-ADDWCERDT    WDERDT           Overage Begin D
     C                     Z-ADDWCESDT    WDESDT           Overage End Dat
     C                     Z-ADDWCBWPR    WDBWPR           Seasonal Overag
     C                     Z-ADDWCBLPR    WDBLPR           Market Overage
     C                     Z-ADDWCBXPR    WDBXPR           Formula Differe
     C                     Z-ADDWCBYPR    WDBYPR           Formula Process
     C                     MOVELWCLQCD    WDLQCD           Commodity Marke
     C                     MOVELWCUVST    WDUVST           EDI Status 1
     C                     MOVELWCUWST    WDUWST           EDI Status 2
     C                     MOVELWCUXST    WDUXST           EDI Status 3
     C                     MOVELP1VSST    WDVSST           Record Status
     C                     Z-ADDWCAATM    WDAATM           Job Time
     C                     MOVELWCAYNA    WDAYNA           User Id
     C                     MOVELWCA0NA    WDA0NA           Job Name
     C                     Z-ADDWCAXDT    WDAXDT           Job Date
      * Move non-key fields to @ISREV5
     C                     Z-ADDWCERDT    WDERDT           Overage Begin D
     C                     Z-ADDWCESDT    WDESDT           Overage End Dat
     C                     Z-ADDWCBWPR    WDBWPR           Seasonal Overag
     C                     Z-ADDWCBLPR    WDBLPR           Market Overage
     C                     Z-ADDWCBXPR    WDBXPR           Formula Differe
     C                     Z-ADDWCBYPR    WDBYPR           Formula Process
     C                     MOVELWCLQCD    WDLQCD    P      Commodity Marke
     C                     MOVELWCUVST    WDUVST    P      EDI Status 1
     C                     MOVELWCUWST    WDUWST    P      EDI Status 2
     C                     MOVELWCUXST    WDUXST    P      EDI Status 3
     C                     MOVELP1VSST    WDVSST    P      Record Status
     C                     Z-ADDWCAATM    WDAATM           Job Time
     C                     MOVELWCAYNA    WDAYNA    P      User Id
     C                     MOVELWCA0NA    WDA0NA    P      Job Name
     C                     Z-ADDWCAXDT    WDAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDIS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ISREV5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDISREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * VAL Cust Item Ref Exis RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSG01           Ship To Custome
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSG01           Ship To Custome
      * Establish starting position
     C           KRSSG     SETLL@BIREKY                    *
     C           KRSSG     READE@BIREKY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSG     READE@BIREKY                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV/UPD CIR Status    RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSH01           Ship To Custome
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Ship To Custome
     C                     KFLD           WEHGCD           Item Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSH01           Ship To Custome
     C                     Z-ADD*ZERO     WEHGCD           Item Code
      * Establish starting position
     C           KPSSH     SETLL@BIREKY                    *
     C           KRSSH     READE@BIREKY                  90*
      * Data record not found
     C   90                MOVEL'USR3081' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status NE PAR.Record Status
     C           WEVSST    IFNE P1VSST                     *IF
      * CHG Cust Itm Ref Sts  CH - Customer Item Reference  * 
     C                     EXSR SICHRC
     C                     END                             *FI
     C           KRSSH     READE@BIREKY                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Cust Itm Ref Sts  CH - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BIREKX
     C                     Z-ADDWEBKC7    WFBKC7           Ship To Custome
     C                     Z-ADDWEHGCD    WFHGCD           Item Code
      *
     C           KLCHSI    KLIST
     C                     KFLD           WFBKC7           Ship To Custome
     C                     KFLD           WFHGCD           Item Code
     C           KLCHSI    CHAIN@BIREKX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POBIREL0'MDACP
     C                     MOVEL'@BIREKX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOBI1    YCRDCS
      * Move non-key fields to @BIREKX
     C                     MOVELWECOAA    WFCOAA    P      CIR Resource No
     C                     MOVELWECPAA    WFCPAA    P      CIR Item No
     C                     MOVELWEPSNA    WFPSNA    P      CIR Description
     C                     MOVELWEPTNA    WFPTNA    P      CIR Description
     C                     MOVELWEPUNA    WFPUNA    P      CIR Description
     C                     MOVELWELBSX    WFLBSX    P      CIR Unused Stat
     C                     MOVELWELCSX    WFLCSX    P      CIR Unused Stat
     C                     MOVELWELDSX    WFLDSX    P      CIR Resource No
     C                     MOVELWELESX    WFLESX    P      CIR UM Base Pri
     C                     MOVELWELFSX    WFLFSX    P      CIR Unused Stat
     C                     MOVELP1VSST    WFVSST    P      Record Status
     C                     Z-ADDWEMJDT    WFMJDT           Create Date
     C                     Z-ADDWEBETM    WFBETM           Create Time
     C                     MOVELWECCVN    WFCCVN    P      Create User
     C                     MOVELWECDVN    WFCDVN    P      Create Program
     C                     Z-ADDWEMKDT    WFMKDT           Change Date
     C                     Z-ADDWEBFTM    WFBFTM           Change Time
     C                     MOVELWECEVN    WFCEVN    P      Change User
     C                     MOVELWECFVN    WFCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPOBI1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFBFTM           Job Time
     C                     MOVEL##USR     WFCEVN           User Id
     C                     MOVEL##JOB     WFCFVN           Job Name
     C                     Z-ADD##JDT     WFMKDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOBI1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BIREKX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOBIREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Cust in Custom EXT RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Upd Cust Status   RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.Record Status NE DB1.Record Status
     C           P1VSST    IFNE WGVSST                     *IF
      * Chg Cust EXT Rec Sts  CH - Customer EXT  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Cust EXT Rec Sts  CH - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @NEREAS
     C                     Z-ADDWGBKC7    WHBKC7           Ship To Custome
      *
     C           KLCHSL    KLIST
     C                     KFLD           WHBKC7           Ship To Custome
     C           KLCHSL    CHAIN@NEREAS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDNEREL0'MDACP
     C                     MOVEL'@NEREAS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDNE1    YDRDCS
      * Move non-key fields to @NEREAS
     C                     MOVELWGUFTX    WHUFTX    P      Internet Passwo
     C                     MOVELWGUGTX    WHUGTX    P      Email Address
     C                     MOVELWGPFNA    WHPFNA    P      Email User ID
     C                     MOVELWGJ5NX    WHJ5NX    P      EDI Trading Par
     C                     MOVELWGU5TX    WHU5TX    P      EDI Cust Duns N
     C                     MOVELWGU6TX    WHU6TX    P      EDI Warehouse/S
     C                     MOVELWGW0TX    WHW0TX    P      State Tax ID
     C                     MOVELWGHSSX    WHHSSX    P      Cust Shipping T
     C                     MOVELWGHUSX    WHHUSX    P      One Invoice Per
     C                     MOVELWGHVSX    WHHVSX    P      EDI Advanced Sh
     C                     Z-ADDWGAAC8    WHAAC8           Customer G/L Ve
     C                     MOVELWGP0SX    WHP0SX    P      Air Freight Ord
     C                     MOVELWGP1SX    WHP1SX    P      Regional Mgr Fa
     C                     MOVELWGP2SX    WHP2SX    P      Employee/Co-Pac
     C                     MOVELWGP3SX    WHP3SX    P      Customer TF Exe
     C                     MOVELWGP4SX    WHP4SX    P      Customer Watch
     C                     MOVELWGP5SX    WHP5SX    P      Customer Sales
     C                     MOVELWGP6SX    WHP6SX    P      Customer Market
     C                     MOVELWGUVST    WHUVST    P      EDI Status 1
     C                     MOVELWGUWST    WHUWST    P      EDI Status 2
     C                     MOVELWGUXST    WHUXST    P      EDI Status 3
     C                     MOVELP1VSST    WHVSST    P      Record Status
     C                     Z-ADDWGAATM    WHAATM           Job Time
     C                     MOVELWGAYNA    WHAYNA    P      User Id
     C                     MOVELWGA0NA    WHA0NA    P      Job Name
     C                     Z-ADDWGAXDT    WHAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDNE1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDNE1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@NEREAS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDNEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Set Customer's associated file rec status to match customer's
      *================================================================
      * VAL Cust Frt Rt Exists RT - Customer Freight Rate  * 
     C                     EXSR SARVGN
      * Set Customer Freight Rate rec sts to match Customer rec sts   E00
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV/UPD Cst Frt Rt Sts RT - Customer Freight Rate  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * Val Customer exists    RT - Company Customer Item  * 
     C                     EXSR SDRVGN
      * Set Company Customer Item rec sts to match Customer rec sts   E00
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV CoCust Item Status RT - Company Customer Item  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      * VAL Cust Item Ref Exis RT - Customer Item Reference  * 
     C                     EXSR SGRVGN
      * Set Customer Item Reference rec sts to match Customer rec sts   E
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV/UPD CIR Status    RT - Customer Item Reference  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * Val Cust in Custom EXT RT - Customer EXT  * 
     C                     EXSR SJRVGN
      * Set Customer EXT record status to match Customer record status E0
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV Upd Cust Status   RT - Customer EXT  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Changes and Comments
      *================================================================
      * ** 06/08/2017 RMC E9064 DONT CHG COMP CUST RCD STS HERE
      * ** 04/09/2012 LJB E000900  When the Record Status for a Customer
      * **   changes, change the record status of several associated file
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCERDT           Overage Begin D
     C                     Z-ADD*ZERO     WCESDT           Overage End Dat
     C                     Z-ADD*ZERO     WCBWPR           Seasonal Overag
     C                     Z-ADD*ZERO     WCBLPR           Market Overage
     C                     Z-ADD*ZERO     WCBXPR           Formula Differe
     C                     Z-ADD*ZERO     WCBYPR           Formula Process
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0003
