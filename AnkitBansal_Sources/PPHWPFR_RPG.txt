     H/TITLE Prt TF Class          PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 08/25/08  Time  : 15:24:58
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCABZREMCIF  E           K        DISK
      * RSQ : Company Item              Item/Company
      *
     FPPAOREL3IF  E           K        DISK
      * RSQ : TF Margin Adj Group Dtl   Seq/Class/Structure
      *
     FPPAMREL1IF  E           K        DISK
      * RTV : TF Classification         Retrieval index
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FPMAPREL0IF  E           K        DISK
      * RTV : TF Meat Cost Group        Retrieval index
      *
     FPPANREL0IF  E           K        DISK
      * RTV : TF Margin Adj Group Hdr   Retrieval index
      *
     FOMBYREL7IF  E           K        DISK
      * RSQ : Item Default              ItemStr/Item
      *
     FPPAPREL1IF  E           K        DISK
      * RTV : TF Margin Adj Group Item  Retrieval index
      *
     FOMBYREL0UF  E           K        DISK
      * UPD : Item Default              Update index
      *
     FCABZREL0UF  E           K        DISK
      * UPD : Company Item              Update index
      *
     FPPHWPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt TF Class          PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@BYREA0
      * Item Default              Update index
      * Renamed input format fields
     I              BYHGCD                          WAHGCD
     I              BYAVNA                          WAAVNA
     I              BYAWNA                          WAAWNA
     I              BYL7NA                          WAL7NA
     I              BYL8NA                          WAL8NA
     I              BYL6NA                          WAL6NA
     I              BYMFNA                          WAMFNA
     I              BYHHCD                          WAHHCD
     I              BYAWPC                          WAAWPC
     I              BYLXST                          WALXST
     I              BYLGCD                          WALGCD
     I              BYAXPC                          WAAXPC
     I              BYLYST                          WALYST
     I              BYLHCD                          WALHCD
     I              BYLICD                          WALICD
     I              BYAIWG                          WAAIWG
     I              BYHICD                          WAHICD
     I              BYRBCD                          WARBCD
     I              BYFZST                          WAFZST
     I              BYAVST                          WAAVST
     I              BYCZWG                          WACZWG
     I              BYC0WG                          WAC0WG
     I              BYURTN                          WAURTN
     I              BYACC8                          WAACC8
     I              BYRINB                          WARINB
     I              BYRHNB                          WARHNB
     I              BYRGNB                          WARGNB
     I              BYLNCD                          WALNCD
     I              BYTFNB                          WATFNB
     I              BYN0CD                          WAN0CD
     I              BYX4ST                          WAX4ST
     I              BYCHTM                          WACHTM
     I              BYQZCD                          WAQZCD
     I              BYXWST                          WAXWST
     I              BYXXST                          WAXXST
     I              BYVMST                          WAVMST
     I              BYSWGH                          WASWGH
     I              BYPPHE                          WAPPHE
     I              BYLRCD                          WALRCD
     I              BYSFNB                          WASFNB
     I              BYA3WG                          WAA3WG
     I              BYSJNB                          WASJNB
     I              BYLLCD                          WALLCD
     I              BYLMCD                          WALMCD
     I              BYP3ST                          WAP3ST
     I              BYSKNB                          WASKNB
     I              BYSLNB                          WASLNB
     I              BYSMNB                          WASMNB
     I              BYP4ST                          WAP4ST
     I              BYCFNB                          WACFNB
     I              BYCGNB                          WACGNB
     I              BYILNB                          WAILNB
     I              BYCHNB                          WACHNB
     I              BYCINB                          WACINB
     I              BYCJNB                          WACJNB
     I              BYCMNB                          WACMNB
     I              BYCNNB                          WACNNB
     I              BYCRNB                          WACRNB
     I              BYCSNB                          WACSNB
     I              BYCVNB                          WACVNB
     I              BYCWNB                          WACWNB
     I              BYCXNB                          WACXNB
     I              BYCZNB                          WACZNB
     I              BYC0NB                          WAC0NB
     I              BYN1CD                          WAN1CD
     I              BYB4NB                          WAB4NB
     I              BYX5ST                          WAX5ST
     I              BYX6ST                          WAX6ST
     I              BYX7ST                          WAX7ST
     I              BYTMVA                          WATMVA
     I              BYTNVA                          WATNVA
     I              BYBLPR                          WABLPR
     I              BYBMPR                          WABMPR
     I              BYU9ST                          WAU9ST
     I              BYCMCO                          WACMCO
     I              BYQ1CD                          WAQ1CD
     I              BYAIC3                          WAAIC3
     I              BYQ8CD                          WAQ8CD
     I              BYR3CD                          WAR3CD
     I              BYSDCD                          WASDCD
     I              BYICN1                          WAICN1
     I              BYSVCD                          WASVCD
     I              BYICN2                          WAICN2
     I              BYSWCD                          WASWCD
     I              BYV2NB                          WAV2NB
     I              BYSXCD                          WASXCD
     I              BYITCN                          WAITCN
     I              BYSYCD                          WASYCD
     I              BYITC5                          WAITC5
     I              BYSZCD                          WASZCD
     I              BYICN6                          WAICN6
     I              BYS0CD                          WAS0CD
     I              BYICN7                          WAICN7
     I              BYS1CD                          WAS1CD
     I              BYICN8                          WAICN8
     I              BYS2CD                          WAS2CD
     I              BYICN9                          WAICN9
     I              BYS3CD                          WAS3CD
     I              BYICN0                          WAICN0
     I              BYS4CD                          WAS4CD
     I              BYB5NB                          WAB5NB
     I              BYXRCD                          WAXRCD
     I              BYPCCT                          WAPCCT
     I              BYBDNB                          WABDNB
     I              BYBJNB                          WABJNB
     I              BYSUST                          WASUST
     I              BYSVST                          WASVST
     I              BYSYST                          WASYST
     I              BYSZST                          WASZST
     I              BYS1ST                          WAS1ST
     I              BYXTCD                          WAXTCD
     I              BYXUCD                          WAXUCD
     I              BYF5WG                          WAF5WG
     I              BYF6WG                          WAF6WG
     I              BYF7WG                          WAF7WG
     I              BYBLNB                          WABLNB
     I              BYBNNB                          WABNNB
     I              BYS2ST                          WAS2ST
     I              BYS4ST                          WAS4ST
     I              BYS5ST                          WAS5ST
     I              BYS6ST                          WAS6ST
     I              BYS8ST                          WAS8ST
     I              BYS9ST                          WAS9ST
     I              BYTCST                          WATCST
     I              BYTDST                          WATDST
     I              BYUVST                          WAUVST
     I              BYUWST                          WAUWST
     I              BYUXST                          WAUXST
     I              BYVSST                          WAVSST
     I              BYAHTM                          WAAHTM
     I              BYBEVN                          WABEVN
     I              BYBFVN                          WABFVN
     I              BYEKDT                          WAEKDT
      *
     I@BZREJV
      * Company Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@BYREV1
      * Item Default              ItemStr/Item
      * Renamed input format fields
     I              BYHGCD                          WCHGCD
     I              BYAVNA                          WCAVNA
     I              BYAWNA                          WCAWNA
     I              BYL7NA                          WCL7NA
     I              BYL8NA                          WCL8NA
     I              BYL6NA                          WCL6NA
     I              BYMFNA                          WCMFNA
     I              BYHHCD                          WCHHCD
     I              BYAWPC                          WCAWPC
     I              BYLXST                          WCLXST
     I              BYLGCD                          WCLGCD
     I              BYAXPC                          WCAXPC
     I              BYLYST                          WCLYST
     I              BYLHCD                          WCLHCD
     I              BYLICD                          WCLICD
     I              BYAIWG                          WCAIWG
     I              BYHICD                          WCHICD
     I              BYRBCD                          WCRBCD
     I              BYFZST                          WCFZST
     I              BYAVST                          WCAVST
     I              BYCZWG                          WCCZWG
     I              BYC0WG                          WCC0WG
     I              BYURTN                          WCURTN
     I              BYACC8                          WCACC8
     I              BYRINB                          WCRINB
     I              BYRHNB                          WCRHNB
     I              BYRGNB                          WCRGNB
     I              BYLNCD                          WCLNCD
     I              BYTFNB                          WCTFNB
     I              BYN0CD                          WCN0CD
     I              BYX4ST                          WCX4ST
     I              BYCHTM                          WCCHTM
     I              BYQZCD                          WCQZCD
     I              BYXWST                          WCXWST
     I              BYXXST                          WCXXST
     I              BYVMST                          WCVMST
     I              BYSWGH                          WCSWGH
     I              BYPPHE                          WCPPHE
     I              BYLRCD                          WCLRCD
     I              BYSFNB                          WCSFNB
     I              BYA3WG                          WCA3WG
     I              BYSJNB                          WCSJNB
     I              BYLLCD                          WCLLCD
     I              BYLMCD                          WCLMCD
     I              BYP3ST                          WCP3ST
     I              BYSKNB                          WCSKNB
     I              BYSLNB                          WCSLNB
     I              BYSMNB                          WCSMNB
     I              BYP4ST                          WCP4ST
     I              BYCFNB                          WCCFNB
     I              BYCGNB                          WCCGNB
     I              BYILNB                          WCILNB
     I              BYCHNB                          WCCHNB
     I              BYCINB                          WCCINB
     I              BYCJNB                          WCCJNB
     I              BYCMNB                          WCCMNB
     I              BYCNNB                          WCCNNB
     I              BYCRNB                          WCCRNB
     I              BYCSNB                          WCCSNB
     I              BYCVNB                          WCCVNB
     I              BYCWNB                          WCCWNB
     I              BYCXNB                          WCCXNB
     I              BYCZNB                          WCCZNB
     I              BYC0NB                          WCC0NB
     I              BYN1CD                          WCN1CD
     I              BYB4NB                          WCB4NB
     I              BYX5ST                          WCX5ST
     I              BYX6ST                          WCX6ST
     I              BYX7ST                          WCX7ST
     I              BYTMVA                          WCTMVA
     I              BYTNVA                          WCTNVA
     I              BYBLPR                          WCBLPR
     I              BYBMPR                          WCBMPR
     I              BYU9ST                          WCU9ST
     I              BYCMCO                          WCCMCO
     I              BYQ1CD                          WCQ1CD
     I              BYAIC3                          WCAIC3
     I              BYQ8CD                          WCQ8CD
     I              BYR3CD                          WCR3CD
     I              BYSDCD                          WCSDCD
     I              BYICN1                          WCICN1
     I              BYSVCD                          WCSVCD
     I              BYICN2                          WCICN2
     I              BYSWCD                          WCSWCD
     I              BYV2NB                          WCV2NB
     I              BYSXCD                          WCSXCD
     I              BYITCN                          WCITCN
     I              BYSYCD                          WCSYCD
     I              BYITC5                          WCITC5
     I              BYSZCD                          WCSZCD
     I              BYICN6                          WCICN6
     I              BYS0CD                          WCS0CD
     I              BYICN7                          WCICN7
     I              BYS1CD                          WCS1CD
     I              BYICN8                          WCICN8
     I              BYS2CD                          WCS2CD
     I              BYICN9                          WCICN9
     I              BYS3CD                          WCS3CD
     I              BYICN0                          WCICN0
     I              BYS4CD                          WCS4CD
     I              BYB5NB                          WCB5NB
     I              BYXRCD                          WCXRCD
     I              BYPCCT                          WCPCCT
     I              BYBDNB                          WCBDNB
     I              BYBJNB                          WCBJNB
     I              BYSUST                          WCSUST
     I              BYSVST                          WCSVST
     I              BYSYST                          WCSYST
     I              BYSZST                          WCSZST
     I              BYS1ST                          WCS1ST
     I              BYXTCD                          WCXTCD
     I              BYXUCD                          WCXUCD
     I              BYF5WG                          WCF5WG
     I              BYF6WG                          WCF6WG
     I              BYF7WG                          WCF7WG
     I              BYBLNB                          WCBLNB
     I              BYBNNB                          WCBNNB
     I              BYS2ST                          WCS2ST
     I              BYS4ST                          WCS4ST
     I              BYS5ST                          WCS5ST
     I              BYS6ST                          WCS6ST
     I              BYS8ST                          WCS8ST
     I              BYS9ST                          WCS9ST
     I              BYTCST                          WCTCST
     I              BYTDST                          WCTDST
     I              BYUVST                          WCUVST
     I              BYUWST                          WCUWST
     I              BYUXST                          WCUXST
     I              BYVSST                          WCVSST
     I              BYAHTM                          WCAHTM
     I              BYBEVN                          WCBEVN
     I              BYBFVN                          WCBFVN
     I              BYEKDT                          WCEKDT
      *
     I@APREV0
      * TF Margin Adj Group Item  Retrieval index
      * Renamed input format fields
     I              APFLAA                          WDFLAA
     I              APRGNB                          WDRGNB
     I              APRHNB                          WDRHNB
     I              APRINB                          WDRINB
     I              APHGCD                          WDHGCD
     I              APVSST                          WDVSST
     I              APMJDT                          WDMJDT
     I              APBETM                          WDBETM
     I              APCCVN                          WDCCVN
     I              APCDVN                          WDCDVN
     I              APMKDT                          WDMKDT
     I              APBFTM                          WDBFTM
     I              APCEVN                          WDCEVN
     I              APCFVN                          WDCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMBY1    E DSOMBYREL0
      * UPD : Item Default              Update index
      * Renamed input format fields
     I              BYHGCD                          WAHGCD
     I              BYAVNA                          WAAVNA
     I              BYAWNA                          WAAWNA
     I              BYL7NA                          WAL7NA
     I              BYL8NA                          WAL8NA
     I              BYL6NA                          WAL6NA
     I              BYMFNA                          WAMFNA
     I              BYHHCD                          WAHHCD
     I              BYAWPC                          WAAWPC
     I              BYLXST                          WALXST
     I              BYLGCD                          WALGCD
     I              BYAXPC                          WAAXPC
     I              BYLYST                          WALYST
     I              BYLHCD                          WALHCD
     I              BYLICD                          WALICD
     I              BYAIWG                          WAAIWG
     I              BYHICD                          WAHICD
     I              BYRBCD                          WARBCD
     I              BYFZST                          WAFZST
     I              BYAVST                          WAAVST
     I              BYCZWG                          WACZWG
     I              BYC0WG                          WAC0WG
     I              BYURTN                          WAURTN
     I              BYACC8                          WAACC8
     I              BYRINB                          WARINB
     I              BYRHNB                          WARHNB
     I              BYRGNB                          WARGNB
     I              BYLNCD                          WALNCD
     I              BYTFNB                          WATFNB
     I              BYN0CD                          WAN0CD
     I              BYX4ST                          WAX4ST
     I              BYCHTM                          WACHTM
     I              BYQZCD                          WAQZCD
     I              BYXWST                          WAXWST
     I              BYXXST                          WAXXST
     I              BYVMST                          WAVMST
     I              BYSWGH                          WASWGH
     I              BYPPHE                          WAPPHE
     I              BYLRCD                          WALRCD
     I              BYSFNB                          WASFNB
     I              BYA3WG                          WAA3WG
     I              BYSJNB                          WASJNB
     I              BYLLCD                          WALLCD
     I              BYLMCD                          WALMCD
     I              BYP3ST                          WAP3ST
     I              BYSKNB                          WASKNB
     I              BYSLNB                          WASLNB
     I              BYSMNB                          WASMNB
     I              BYP4ST                          WAP4ST
     I              BYCFNB                          WACFNB
     I              BYCGNB                          WACGNB
     I              BYILNB                          WAILNB
     I              BYCHNB                          WACHNB
     I              BYCINB                          WACINB
     I              BYCJNB                          WACJNB
     I              BYCMNB                          WACMNB
     I              BYCNNB                          WACNNB
     I              BYCRNB                          WACRNB
     I              BYCSNB                          WACSNB
     I              BYCVNB                          WACVNB
     I              BYCWNB                          WACWNB
     I              BYCXNB                          WACXNB
     I              BYCZNB                          WACZNB
     I              BYC0NB                          WAC0NB
     I              BYN1CD                          WAN1CD
     I              BYB4NB                          WAB4NB
     I              BYX5ST                          WAX5ST
     I              BYX6ST                          WAX6ST
     I              BYX7ST                          WAX7ST
     I              BYTMVA                          WATMVA
     I              BYTNVA                          WATNVA
     I              BYBLPR                          WABLPR
     I              BYBMPR                          WABMPR
     I              BYU9ST                          WAU9ST
     I              BYCMCO                          WACMCO
     I              BYQ1CD                          WAQ1CD
     I              BYAIC3                          WAAIC3
     I              BYQ8CD                          WAQ8CD
     I              BYR3CD                          WAR3CD
     I              BYSDCD                          WASDCD
     I              BYICN1                          WAICN1
     I              BYSVCD                          WASVCD
     I              BYICN2                          WAICN2
     I              BYSWCD                          WASWCD
     I              BYV2NB                          WAV2NB
     I              BYSXCD                          WASXCD
     I              BYITCN                          WAITCN
     I              BYSYCD                          WASYCD
     I              BYITC5                          WAITC5
     I              BYSZCD                          WASZCD
     I              BYICN6                          WAICN6
     I              BYS0CD                          WAS0CD
     I              BYICN7                          WAICN7
     I              BYS1CD                          WAS1CD
     I              BYICN8                          WAICN8
     I              BYS2CD                          WAS2CD
     I              BYICN9                          WAICN9
     I              BYS3CD                          WAS3CD
     I              BYICN0                          WAICN0
     I              BYS4CD                          WAS4CD
     I              BYB5NB                          WAB5NB
     I              BYXRCD                          WAXRCD
     I              BYPCCT                          WAPCCT
     I              BYBDNB                          WABDNB
     I              BYBJNB                          WABJNB
     I              BYSUST                          WASUST
     I              BYSVST                          WASVST
     I              BYSYST                          WASYST
     I              BYSZST                          WASZST
     I              BYS1ST                          WAS1ST
     I              BYXTCD                          WAXTCD
     I              BYXUCD                          WAXUCD
     I              BYF5WG                          WAF5WG
     I              BYF6WG                          WAF6WG
     I              BYF7WG                          WAF7WG
     I              BYBLNB                          WABLNB
     I              BYBNNB                          WABNNB
     I              BYS2ST                          WAS2ST
     I              BYS4ST                          WAS4ST
     I              BYS5ST                          WAS5ST
     I              BYS6ST                          WAS6ST
     I              BYS8ST                          WAS8ST
     I              BYS9ST                          WAS9ST
     I              BYTCST                          WATCST
     I              BYTDST                          WATDST
     I              BYUVST                          WAUVST
     I              BYUWST                          WAUWST
     I              BYUXST                          WAUXST
     I              BYVSST                          WAVSST
     I              BYAHTM                          WAAHTM
     I              BYBEVN                          WABEVN
     I              BYBFVN                          WABFVN
     I              BYEKDT                          WAEKDT
      *
     IYARDCS      DS                            605
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCABZ1    E DSCABZREL0
      * UPD : Company Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     IYBRDCS      DS                            605
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Report Type
     I                                        1   1 P1IZSX
     IP2PARM      DS
      * I :  Print Information USR
     I                                        1   1 P2SUSX
     IP3PARM      DS
      * FLD: TF Margin Adj Group Dtl
      * I :  TF Classification Code
     I                                        1   3 P3FLAA
      * I :  Item Structure Type Code
     I                                    P   4   50P3RGNB
      * I :  Item Structure Group Code
     I                                    P   6   70P3RHNB
      * I :  Item Structure Class Code
     I                                    P   8   90P3RINB
      * I :  TF Class Group
     I                                       10  11 P3SVSX
      * I :  TFMC Group Code
     I                                       12  15 P3HFAA
     IP4PARM      DS
      * I :  Active Status Flag
     I                                        1   1 P4P2ST
     IP5PARM      DS
      * I :  Include Credit Items USR
     I                                        1   1 P5PBSX
     IP6PARM      DS
      * I :  Change Flag USR
     I                                        1   1 P6HWSX
     IP7PARM      DS
      * N :  Print On Form
     I                                        1   1 P7PROF
     IP8PARM      DS
      * FLD: Item Default
      * I :  Item Type Code
     I                                        1   3 P8N0CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1IZSX    PARM           WP0001  1        Report Type
     C           P2SUSX    PARM           WP0002  1        Print Informati
     C           P3FLAA    PARM           WP0003  3        TF Classificati
     C           P3RGNB    PARM           WP0004  30       Item Structure
     C           P3RHNB    PARM           WP0005  30       Item Structure
     C           P3RINB    PARM           WP0006  30       Item Structure
     C           P3SVSX    PARM           WP0007  2        TF Class Group
     C           P3HFAA    PARM           WP0008  4        TFMC Group Code
     C           P4P2ST    PARM           WP0009  1        Active Status F
     C           P5PBSX    PARM           WP0010  1        Include Credit
     C           P6HWSX    PARM           WP0011  1        Change Flag USR
     C           P8N0CD    PARM           WP0012  3        Item Type Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt TF Class          PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$GENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt TF Class          PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@AOREDS                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Sequence Number
     C                     MOVEL'Y'       W0AL01  1        TF Classificati
     C                     MOVEL'Y'       W0AL02  1        Item Structure
     C                     MOVEL'Y'       W0AL03  1        Item Structure
     C                     MOVEL'Y'       W0AL04  1        Item Structure
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     MOVELAOFLAA    $FFLAA           TF Classificati
     C                     Z-ADDAODXNB    $FDXNB           Sequence Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load related totals format
     C                     MOVELAOFLAA    $EFLAA           TF Classificati
     C                     Z-ADDAORGNB    $ERGNB           Item Structure
     C                     Z-ADDAODXNB    $EDXNB           Sequence Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELAOFLAA    $CFLAA           TF Classificati
     C                     Z-ADDAORGNB    $CRGNB           Item Structure
     C                     MOVEL*BLANK    $CQXNA           Item Str Type D
     C                     Z-ADDAORHNB    $CRHNB           Item Structure
     C                     MOVEL*BLANK    $CQWNA           Item Str Group
     C                     Z-ADDAORINB    $CRINB           Item Structure
     C                     Z-ADDAODXNB    $CDXNB           Sequence Number
     C                     MOVEL*BLANK    $CQVNA           Item Str Class
     C                     MOVELAOSVSX    $CSVSX           TF Class Group
     C                     MOVELAOI1T1    $CI1T1           Mix Sub-Group C
     C                     MOVELAOHFAA    $CHFAA           TFMC Group Code
     C                     Z-ADDAOGGPC    $CGGPC           TF % Owned
     C                     MOVELAOD3TX    $CD3TX           Co-Own Producin
     C                     MOVELAOX5SX    $CX5SX           Converted Raw M
     C                     MOVELAOD4TX    $CD4TX           TFMAGD Unused S
     C                     MOVELAOD5TX    $CD5TX           TFMAGD Unused S
     C                     MOVELAOD7TX    $CD7TX           TFMAGD Unused S
     C                     MOVELAOD8TX    $CD8TX           TFMAGD Unused S
     C                     MOVELAOD9TX    $CD9TX           TFMAGD Unused S
     C                     MOVELAOEATX    $CEATX           TFMAGD Unused S
     C                     MOVELAOEBTX    $CEBTX           TFMAGD Unused S
     C                     Z-ADDAOGFPC    $CGFPC           TFMAGD Unused P
     C                     Z-ADDAOGHPC    $CGHPC           TFMAGD Unused P
     C                     Z-ADDAOGIPC    $CGIPC           TFMAGD Unused P
     C                     Z-ADDAOGJPC    $CGJPC           TFMAGD Unused P
     C                     Z-ADDAOGKPC    $CGKPC           TFMAGD Unused P
     C                     MOVEL*BLANK    $CQ1ST           Status Flag 1
     C                     MOVEL*BLANK    $CQ2ST           Status Flag 2
     C                     MOVEL*BLANK    $CZ9SX           Status Flag 2
     C                     MOVEL*BLANK    $CQ3ST           Status Flag 3
     C                     MOVEL*BLANK    $CFMST           Status Flag 4
     C                     MOVEL*BLANK    $CAJTX           Status Flag 5
     C                     MOVEL*BLANK    $CACTX           Status Flag 6
     C                     MOVEL*BLANK    $CAKTX           Status Flag 7
     C                     MOVEL*BLANK    $CAFTX           Status Flag 8
     C                     MOVELAOSWSX    $CSWSX           Include In Mix
     C                     MOVELAOSXSX    $CSXSX           Include In Vol
     C                     MOVELAOZ8SX    $CZ8SX           Include In Inve
     C                     MOVELAOSNSX    $CSNSX           Include Sts
     C                     MOVEL*BLANK    $CHLTX           Condition Desc.
     C                     Z-ADD*ZERO     $CHGCD           Item Code
     C                     MOVEL*BLANK    $CAVNA           Description Lin
     C                     MOVEL*BLANK    $CHHCD           U/M - Primary D
     C                     MOVEL*BLANK    $CN0CD           Item Type Code
     C                     MOVEL*BLANK    $CQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    $CSYCD           G/L Sub Code
     C                     MOVEL*BLANK    $CRBCD           Item Level
     C                     MOVEL*BLANK    $CVMST           Credit Item Sta
     C                     MOVEL*BLANK    $CS6ST           Value Added Sts
     C                     MOVEL*BLANK    $CX6ST           Print on Realiz
     C                     MOVEL*BLANK    $CSUST           Export/Domestic
     C                     MOVEL*BLANK    $CPCCT           Piece Count Ite
     C                     Z-ADD*ZERO     $CBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     $CBJNB           Bags Per Unit
     C                     MOVELAOVSST    $CVSST           Record Status
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt TF Class ItmsAdSelPO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AODXNB    WZA001           Sequence Number
     C                     Z-ADDAODXNB    WZA001
     C           *LIKE     DEFN AOFLAA    WZA002           TF Classificati
     C                     MOVELAOFLAA    WZA002
     C           *LIKE     DEFN AORGNB    WZA003           Item Structure
     C                     Z-ADDAORGNB    WZA003
     C           *LIKE     DEFN AORHNB    WZA004           Item Structure
     C                     Z-ADDAORHNB    WZA004
     C           *LIKE     DEFN AORINB    WZA005           Item Structure
     C                     Z-ADDAORINB    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @AOREDS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * SEL:  TF Classification
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TF Classification Code is Entered
      *   |- c2    : PAR.TF Classification Code NE DB1.TF Classification
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3FLAA    IFNE *BLANK                     *IF
     C           P3FLAA    IFNE AOFLAA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * 032108 slm e00124 additional seletion
      * SEL:  TF Class Group
      * CASE: PAR.TF Class Group is Not Entered
     C           P3SVSX    IFEQ *BLANK                     *IF
      * 03/18/28 Slm Add new selection on class group
     C                     ELSE
      * CASE: PAR.TF Class Group NE DB1.TF Class Group
     C           P3SVSX    IFNE AOSVSX                     *IF
      * 03/18/28 Slm Add new selection on class group
      * Par is selecting now see if equal to db1
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Item Structure Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Structure Type Code is Entered
      *   |- c2    : PAR.Item Structure Type Code NE DB1.Item Structure T
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3RGNB    IFNE *ZERO                      *IF
     C           P3RGNB    IFNE AORGNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL:  Item Structure Group
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Structure Group Code is Entered
      *   |- c2    : PAR.Item Structure Group Code NE DB1.Item Structure
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3RHNB    IFNE *ZERO                      *IF
     C           P3RHNB    IFNE AORHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL:  Item Structure Class
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Structure Class Code is Entered
      *   |- c2    : PAR.Item Structure Class Code NE DB1.Item Structure
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3RINB    IFNE *ZERO                      *IF
     C           P3RINB    IFNE AORINB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL:  TF Meat Cost Group
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TFMC Group Code is Entered
      *   |- c2    : PAR.TFMC Group Code NE DB1.TFMC Group Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3HFAA    IFNE *BLANK                     *IF
     C           P3HFAA    IFNE AOHFAA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Sequence Number
     C                     MOVEL*BLANK    W0AL01  1        TF Classificati
     C                     MOVEL*BLANK    W0AL02  1        Item Structure
     C                     MOVEL*BLANK    W0AL03  1        Item Structure
     C                     MOVEL*BLANK    W0AL04  1        Item Structure
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Sequence Number
     C                     MOVEL'Y'       W0AL01  1        TF Classificati
     C                     MOVEL'Y'       W0AL02  1        Item Structure
     C                     MOVEL'Y'       W0AL03  1        Item Structure
     C                     MOVEL'Y'       W0AL04  1        Item Structure
     C                     ELSE
      * Next record - Detect level breaks
     C           AODXNB    IFNE WZA001                     Sequence Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           AOFLAA    IFNE WZA002                     TF Classificati
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           AORGNB    IFNE WZA003                     Item Structure
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           AORHNB    IFNE WZA004                     Item Structure
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           AORINB    IFNE WZA005                     Item Structure
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$EKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt TF Class ItmsAdSelPO: Mainline
      *================================================================
      * Prt TF Class ItmsAdSelPO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRGNB    WQKB01           Item Structure
     C           *LIKE     DEFN WCRHNB    WQKB02           Item Structure
     C           *LIKE     DEFN WCRINB    WQKB03           Item Structure
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Item Structure
     C                     KFLD           WQKB02           Item Structure
     C                     KFLD           WQKB03           Item Structure
      * Setup key
     C                     Z-ADD$CRGNB    WQKB01           Item Structure
     C                     Z-ADD$CRHNB    WQKB02           Item Structure
     C                     Z-ADD$CRINB    WQKB03           Item Structure
      * Establish starting position
     C           KRSB      SETLL@BYREV1                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Item Structure
     C                     MOVEL'Y'       W0BL01  1        Item Structure
     C                     MOVEL'Y'       W0BL02  1        Item Structure
     C                     MOVEL'Y'       W0BL03  1        Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $DD6T1           Text USR 9
     C                     MOVELWCTCST    $DTCST           Item TF Classif
     C                     MOVEL*BLANK    $DPFTX           Text 1 Length U
     C                     Z-ADDWCHGCD    $DHGCD           Item Code
     C                     MOVELWCAVNA    $DAVNA           Description Lin
     C                     MOVELWCAWNA    $DAWNA           Description Lin
     C                     MOVELWCL7NA    $DL7NA           Item Label Line
     C                     MOVELWCL8NA    $DL8NA           Item Label Line
     C                     MOVELWCL6NA    $DL6NA           Item Label Line
     C                     MOVELWCMFNA    $DMFNA           Item Label Line
     C                     MOVELWCHHCD    $DHHCD           U/M - Primary D
     C                     MOVELWCP3ST    $DP3ST           TF Co-Ownership
     C                     Z-ADDWCAWPC    $DAWPC           Conversion Fact
     C                     MOVELWCLXST    $DLXST           Operation Facto
     C                     MOVELWCLGCD    $DLGCD           U/M - Second Df
     C                     Z-ADDWCAXPC    $DAXPC           Conversion Fact
     C                     MOVELWCLYST    $DLYST           Operation Facto
     C                     MOVELWCLHCD    $DLHCD           U/M - Third Dft
     C                     MOVELWCLICD    $DLICD           U/M - Pricing D
     C                     Z-ADDWCAIWG    $DAIWG           Unit Weight
     C                     MOVELWCHICD    $DHICD           Quality Level
     C                     MOVELWCFZST    $DFZST           Production Date
     C                     MOVELWCAVST    $DAVST           Catch Weight St
     C                     Z-ADDWCCZWG    $DCZWG           Minimum Weight
     C                     Z-ADDWCC0WG    $DC0WG           Maximum Weight
     C                     Z-ADDWCURTN    $DURTN           Number Cases On
     C                     Z-ADDWCACC8    $DACC8           Vendor item Def
     C                     Z-ADDWCRINB    $DRINB           Item Structure
     C                     Z-ADDWCRHNB    $DRHNB           Item Structure
     C                     Z-ADDWCRGNB    $DRGNB           Item Structure
     C                     MOVELWCLNCD    $DLNCD           Default Commod
     C                     Z-ADDWCTFNB    $DTFNB           Transportation
     C                     MOVELWCN0CD    $DN0CD           Item Type Code
     C                     MOVELWCQZCD    $DQZCD           Base/Conv/Loss
     C                     MOVELWCSYCD    $DSYCD           G/L Sub Code
     C                     MOVELWCRBCD    $DRBCD           Item Level
     C                     MOVELWCX4ST    $DX4ST           Package Type Co
     C                     Z-ADDWCCHTM    $DCHTM           Fresh Chilling
     C                     MOVELWCXWST    $DXWST           Variety/Rendere
     C                     MOVELWCXXST    $DXXST           Frozen Make to
     C                     MOVELWCVMST    $DVMST           Credit Item Sta
     C                     MOVELWCS6ST    $DS6ST           Value Added Sts
     C                     Z-ADDWCSWGH    $DSWGH           Std Weight/Head
     C                     Z-ADDWCPPHE    $DPPHE           Pieces Per Head
     C                     MOVELWCLRCD    $DLRCD           Commodity Price
     C                     Z-ADDWCSFNB    $DSFNB           Pallet Tare Wei
     C                     Z-ADDWCA3WG    $DA3WG           Misc Tare Weigh
     C                     Z-ADDWCSJNB    $DSJNB           Production Lead
     C                     MOVELWCLLCD    $DLLCD           Packaging Code
     C                     MOVELWCLMCD    $DLMCD           Item Market Cod
     C                     Z-ADDWCSKNB    $DSKNB           Agrimetrics gro
     C                     Z-ADDWCSLNB    $DSLNB           Agrimetrics pac
     C                     Z-ADDWCSMNB    $DSMNB           Agrimetrics gra
     C                     MOVELWCP4ST    $DP4ST           PA Base Avail R
     C                     Z-ADDWCCFNB    $DCFNB           PM Pounds per H
     C                     Z-ADDWCCGNB    $DCGNB           Item Frt Overag
     C                     Z-ADDWCILNB    $DILNB           PM % 2nds Facto
     C                     Z-ADDWCCHNB    $DCHNB           Use/Freeze/Sell
     C                     Z-ADDWCCINB    $DCINB           PM Batch Size
     C                     Z-ADDWCCJNB    $DCJNB           PM Lot Size
     C                     Z-ADDWCCMNB    $DCMNB           Partial Item Co
     C                     Z-ADDWCCNNB    $DCNNB           WIP Item Code
     C                     Z-ADDWCCRNB    $DCRNB           WIP Reject Code
     C                     Z-ADDWCCSNB    $DCSNB           Std Costing Uni
     C                     Z-ADDWCCVNB    $DCVNB           FP Std Green We
     C                     Z-ADDWCCWNB    $DCWNB           PM Standard LBS
     C                     Z-ADDWCCXNB    $DCXNB           PM Raw Meat LBS
     C                     Z-ADDWCCZNB    $DCZNB           PM Formula LBS/
     C                     Z-ADDWCC0NB    $DC0NB           PM Finished LBS
     C                     MOVELWCN1CD    $DN1CD           SH Unused (was
     C                     Z-ADDWCB4NB    $DB4NB           PM R/M Type Cod
     C                     MOVELWCX5ST    $DX5ST           Seconds Item
     C                     MOVELWCX6ST    $DX6ST           Print on Realiz
     C                     MOVELWCSUST    $DSUST           Export/Domestic
     C                     MOVELWCX7ST    $DX7ST           Unit Weight Cha
     C                     Z-ADDWCTMVA    $DTMVA           Maximum Audit V
     C                     Z-ADDWCTNVA    $DTNVA           Minimum Audit V
     C                     Z-ADDWCBLPR    $DBLPR           Market Overage
     C                     Z-ADDWCBMPR    $DBMPR           Standard Overag
     C                     MOVELWCU9ST    $DU9ST           Item Pricing Op
     C                     Z-ADDWCCMCO    $DCMCO           Item Pricing Co
     C                     MOVELWCQ1CD    $DQ1CD           Default Warehou
     C                     Z-ADDWCAIC3    $DAIC3           Company Number
     C                     MOVELWCQ8CD    $DQ8CD           Price Method De
     C                     MOVELWCR3CD    $DR3CD           Department Code
     C                     MOVELWCSDCD    $DSDCD           Group for Packa
     C                     Z-ADDWCICN1    $DICN1           Item Category N
     C                     MOVELWCSVCD    $DSVCD           MTO Code
     C                     Z-ADDWCICN2    $DICN2           Item Category N
     C                     MOVELWCSWCD    $DSWCD           Item Category C
     C                     Z-ADDWCV2NB    $DV2NB           Item Category N
     C                     MOVELWCSXCD    $DSXCD           Item Category C
     C                     Z-ADDWCITCN    $DITCN           Item Category N
     C                     Z-ADDWCITC5    $DITC5           Item Category N
     C                     MOVELWCSZCD    $DSZCD           Item Category C
     C                     Z-ADDWCICN6    $DICN6           Item Category N
     C                     MOVELWCS0CD    $DS0CD           Item Category C
     C                     Z-ADDWCICN7    $DICN7           Item Category N
     C                     MOVELWCS1CD    $DS1CD           Item Category C
     C                     Z-ADDWCICN8    $DICN8           Item Category N
     C                     MOVELWCS2CD    $DS2CD           Item Category C
     C                     Z-ADDWCICN9    $DICN9           Item Category N
     C                     MOVELWCS3CD    $DS3CD           Item Category C
     C                     Z-ADDWCICN0    $DICN0           Item Category N
     C                     MOVELWCS4CD    $DS4CD           Item Category C
     C                     Z-ADDWCB5NB    $DB5NB           PM Line Number
     C                     MOVELWCXRCD    $DXRCD           Primal Group Co
     C                     MOVELWCPCCT    $DPCCT           Piece Count Ite
     C                     Z-ADDWCBDNB    $DBDNB           Pieces Per Bag
     C                     Z-ADDWCBJNB    $DBJNB           Bags Per Unit
     C                     MOVELWCSVST    $DSVST           Print On Schedu
     C                     MOVELWCSYST    $DSYST           Fresh Inv Alloc
     C                     MOVELWCSZST    $DSZST           Fresh Sched As
     C                     MOVELWCS1ST    $DS1ST           Frozen Sched As
     C                     MOVELWCXTCD    $DXTCD           UPC Code 1
     C                     MOVELWCXUCD    $DXUCD           UPC Code 2
     C                     Z-ADDWCF5WG    $DF5WG           Item Target Pri
     C                     Z-ADDWCF6WG    $DF6WG           Minimum Piece W
     C                     Z-ADDWCF7WG    $DF7WG           Maximum Piece W
     C                     Z-ADDWCBLNB    $DBLNB           Seaboard Equiva
     C                     Z-ADDWCBNNB    $DBNNB           Production Qty
     C                     MOVELWCS2ST    $DS2ST           Scheduling Posi
     C                     MOVELWCS4ST    $DS4ST           Sold 100% Froze
     C                     MOVELWCS5ST    $DS5ST           Maximum Shifts
     C                     MOVELWCS8ST    $DS8ST           Label Type
     C                     MOVELWCS9ST    $DS9ST           Item TF Exempt
     C                     MOVELWCTDST    $DTDST           Default Workcen
     C                     MOVELWCUVST    $DUVST           EDI Status 1
     C                     MOVELWCUWST    $DUWST           EDI Status 2
     C                     MOVELWCUXST    $DUXST           EDI Status 3
     C                     MOVELWCVSST    $DVSST           Record Status
     C                     Z-ADDWCAHTM    $DAHTM           Job Time
     C                     MOVELWCBEVN    $DBEVN           User Id
     C                     MOVELWCBFVN    $DBFVN           Job Name
     C                     Z-ADDWCEKDT    $DEKDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCRGNB    WZB001           Item Structure
     C                     Z-ADDWCRGNB    WZB001
     C           *LIKE     DEFN WCRHNB    WZB002           Item Structure
     C                     Z-ADDWCRHNB    WZB002
     C           *LIKE     DEFN WCRINB    WZB003           Item Structure
     C                     Z-ADDWCRINB    WZB003
     C           *LIKE     DEFN WCHGCD    WZB004           Item Code
     C                     Z-ADDWCHGCD    WZB004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BYREV1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * SEL:  Finished Goods or Work in process or both
      * CASE: DB1.Item Type Code is Not FG/WP
     C           WCN0CD    IFEQ *BLANK                     *IF
     C           WCN0CD    OREQ 'PS'
     C           WCN0CD    OREQ 'RM'
     C           WCN0CD    OREQ 'EX'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Entered
      *   |- c2    : PAR.Item Type Code NE DB1.Item Type Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8N0CD    IFNE *BLANK                     *IF
     C           P8N0CD    IFNE WCN0CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * select on FG/WIP OR both
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Active Record
      * CASE: PAR.Active Status Flag is Yes
     C           P4P2ST    IFEQ 'Y'                        *IF
      * CASE: DB1.Record Status is Not Active
     C           WCVSST    IFEQ *BLANK                     *IF
     C           WCVSST    OREQ 'D'
     C           WCVSST    OREQ 'I'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Include Credit Items
      * CASE: PAR.Include Credit Items USR is no
     C           P5PBSX    IFEQ 'N'                        *IF
      * CASE: DB1.Credit Item Status is yes
     C           WCVMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Print Information = Entry
      * CASE: PAR.All/Select/Omit Sts USR is Entry
     C           P2SUSX    IFEQ 'E'                        *IF
      * Val Existance         RT - TF Margin Adj Group Item  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CFLAA    WL0010    P      TF Classificati
     C                     Z-ADDWCRGNB    WL0011           Item Structure
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     Z-ADDWCRINB    WL0013           Item Structure
     C                     Z-ADDWCHGCD    WL0014           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Print Information = Selected Items
      * CASE: PAR.All/Select/Omit Sts USR is Selected
     C           P2SUSX    IFEQ 'S'                        *IF
      * SEL:  Only Items Listed
      * CASE: PAR.Include Sts is Only Items Listed
     C           $CSNSX    IFEQ 'O'                        *IF
      * Val Existance         RT - TF Margin Adj Group Item  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CFLAA    WL0010    P      TF Classificati
     C                     Z-ADDWCRGNB    WL0011           Item Structure
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     Z-ADDWCRINB    WL0013           Item Structure
     C                     Z-ADDWCHGCD    WL0014           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  All Items Except
      * CASE: PAR.Include Sts is All Items Except Listed
     C           $CSNSX    IFEQ 'E'                        *IF
      * Val Existance         RT - TF Margin Adj Group Item  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CFLAA    WL0010    P      TF Classificati
     C                     Z-ADDWCRGNB    WL0011           Item Structure
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     Z-ADDWCRINB    WL0013           Item Structure
     C                     Z-ADDWCHGCD    WL0014           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Found
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Print Information = Omitted Items
      * CASE: PAR.All/Select/Omit Sts USR is Omitted
     C           P2SUSX    IFEQ 'O'                        *IF
      * OMT:  All Items
      * CASE: PAR.Include Sts is All Items
     C           $CSNSX    IFEQ 'A'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL:  Only Items Listed
      * CASE: PAR.Include Sts is Only Items Listed
     C           $CSNSX    IFEQ 'O'                        *IF
      * Val Existance         RT - TF Margin Adj Group Item  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CFLAA    WL0010    P      TF Classificati
     C                     Z-ADDWCRGNB    WL0011           Item Structure
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     Z-ADDWCRINB    WL0013           Item Structure
     C                     Z-ADDWCHGCD    WL0014           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Found
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  All Items Except
      * CASE: PAR.Include Sts is All Items Except Listed
     C           $CSNSX    IFEQ 'E'                        *IF
      * Val Existance         RT - TF Margin Adj Group Item  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CFLAA    WL0010    P      TF Classificati
     C                     Z-ADDWCRGNB    WL0011           Item Structure
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     Z-ADDWCRINB    WL0013           Item Structure
     C                     Z-ADDWCHGCD    WL0014           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Item Structure
     C                     MOVEL*BLANK    W0BL01  1        Item Structure
     C                     MOVEL*BLANK    W0BL02  1        Item Structure
     C                     MOVEL*BLANK    W0BL03  1        Item Code
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Item Structure
     C                     MOVEL'Y'       W0BL01  1        Item Structure
     C                     MOVEL'Y'       W0BL02  1        Item Structure
     C                     MOVEL'Y'       W0BL03  1        Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           WCRGNB    IFNE WZB001                     Item Structure
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WCRHNB    IFNE WZB002                     Item Structure
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WCRINB    IFNE WZB003                     Item Structure
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           WCHGCD    IFNE WZB004                     Item Code
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt TF Class          PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt TF Class          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Sequence Number of Prt TF Class          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print TF Classification Code of Prt TF Class          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Item Structure Type Code of Prt TF Class          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Item Structure Group Code of Prt TF Class          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Item Structure Class Code of Prt TF Class          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Prt TF Class          PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv TF Class Info     RT - TF Classification  * 
     C                     EXSR SLRVGN
      * Rtv TF Margin Adj Hdr RT - TF Margin Adj Group Hdr  * 
     C                     EXSR SMRVGN
     C                     MOVELAOSWSX    $CACTX           Status Flag 6
     C                     MOVELAOSXSX    $CAKTX           Status Flag 7
     C                     MOVELAOZ8SX    $CAFTX           Status Flag 8
     C                     MOVEL'N'       WUB5SX           Print Yes/No
     C                     MOVEL*BLANK    $CQXNA           Item Str Type D
      * Item Str Type Desc DRV
      * Rtv Type Description   RT - Item Structure Type  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRGNB    WL0004           Item Structure
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $CQXNA    P      Item Structure
     C                     MOVEL*BLANK    $CQWNA           Item Str Group
      * Item Str Group Desc DRV
      * Rtv Group Desc - Item Structure Group  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRHNB    WL0006           Item Structure
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    $CQWNA    P      Item Structure
     C                     MOVEL*BLANK    $CQVNA           Item Str Class
      * Item Str Class Desc DRV
      * Rtv Item Class Desc    RT - Item Structure Class  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRINB    WL0008           Item Structure
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    $CQVNA    P      Item Structure
     C                     MOVELAOSVSX    $CSVSX           TF Class Group
     C                     MOVELAOHFAA    $CHFAA           TFMC Group Code
     C                     Z-ADDAOGGPC    $CGGPC           TF % Owned
      * Converted Raw Material Description
      * CASE: CUR.Converted Raw Material is Converted
     C           $CX5SX    IFEQ 'C'                        *IF
      * CUR.Condition Desc. 1  USR = Condition name of CUR.Converted Raw
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1753858   Y2LSNO  70       List number
     C                     PARM $CX5SX    W0INVL 25        Converted Raw M
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     MOVEL'Y'       YL0001           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CHLTX           Condition Desc.
     C                     MOVEL'N'       YL0001           Display Flag
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           P2SUSX    IFEQ 'A'                        *IF
     C           P2SUSX    OREQ 'O'
     C           P2SUSX    OREQ 'S'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P2SUSX    IFEQ 'E'                        *IF
     C           P2SUSX    OREQ 'O'
     C           P2SUSX    OREQ 'S'
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt TF Class ItmsAdSelPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Item Structure Type Code of Prt TF Class ItmsAdSelPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Item Structure Group Code of Prt TF Class ItmsAdSelPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Item Structure Class Code of Prt TF Class ItmsAdSelPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Item Code of Prt TF Class ItmsAdSelPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Detail line. of Prt TF Class ItmsAdSelPO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PAR.All/Select/Omit Sts USR is All
     C           P2SUSX    IFEQ 'A'                        *IF
      * SEL:  Only Items Listed
      * CASE: PAR.Include Sts is Only Items Listed
     C           $CSNSX    IFEQ 'O'                        *IF
      * Val Existance         RT - TF Margin Adj Group Item  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CFLAA    WL0010    P      TF Classificati
     C                     Z-ADDWCRGNB    WL0011           Item Structure
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     Z-ADDWCRINB    WL0013           Item Structure
     C                     Z-ADDWCHGCD    WL0014           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'*'       $DPFTX           Text 1 Length U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $DPFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  All Items Except
      * CASE: PAR.Include Sts is All Items Except Listed
     C           $CSNSX    IFEQ 'E'                        *IF
      * Val Existance         RT - TF Margin Adj Group Item  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CFLAA    WL0010    P      TF Classificati
     C                     Z-ADDWCRGNB    WL0011           Item Structure
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     Z-ADDWCRINB    WL0013           Item Structure
     C                     Z-ADDWCHGCD    WL0014           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Found
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'*'       $DPFTX           Text 1 Length U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $DPFTX           Text 1 Length U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       YL0003           Display Flag
      * ** Display Item TF Classification **'
      * CASE: CUR.Text 1 Length USR is *Blank
     C           $DPFTX    IFEQ *BLANK                     *IF
      * CASE: CUR.Item TF Classification EQ PAR.TF Classification Code
     C           $DTCST    IFEQ $CFLAA                     *IF
     C                     MOVEL'N'       YL0003           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0003           Display Flag
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CUR.Credit Item Status is yes
     C           $DVMST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    $DD6T1           Text USR 9
     C                     MOVEL'*CREDIT*'$DD6T1           Text USR 9
     C                     END                             *FI
      * CHANGE Item Default and Company Item
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Print Information USR is Selected Items
      *   |- c2    : PAR.Change Flag USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2SUSX    IFEQ 'S'                        *IF
     C           P6HWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 8/25/2008 slm Add new logic to update from TF Margin Detail
      * to the Item Default and then the Company Item.
     C                     MOVEL$CD3TX    $DP3ST           TF Co-Ownership
      * Chg TF Classification CH - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DHGCD    WL0001           Item Code
     C                     MOVEL$DP3ST    WL0002    P      TF Co-Ownership
     C                     MOVEL$CFLAA    WL0003    P      Item TF Classif
     C                     EXSR SDCHRC
     C                     END                             *FI
      * ONLY PRINT ITEMS BELONGING TO THE CLASS
      * CASE: PAR.Print Information USR is Selected Items
     C           P2SUSX    IFEQ 'S'                        *IF
      * CASE: PAR.TF Classification Code NE CUR.Item TF Classification
     C           $CFLAA    IFNE $DTCST                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt TF Class          PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Sequence Number of Prt TF Class          PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TF Classification Code of Prt TF Class          PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Type Code of Prt TF Class          PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Group Code of Prt TF Class          PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Class Code of Prt TF Class          PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt TF Class          PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt TF Class ItmsAdSelPO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Type Code of Prt TF Class ItmsAdSelPO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Group Code of Prt TF Class ItmsAdSelPO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Class Code of Prt TF Class ItmsAdSelPO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of Prt TF Class ItmsAdSelPO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt TF Class ItmsAdSelPO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     MOVELP1IZSX    $BIZSX           Report Type
     C                     MOVELP2SUSX    $BSUSX           Print Informati
     C                     MOVELP3FLAA    $BFLAA           TF Classificati
     C                     MOVELP3SVSX    $BSVSX           TF Class Group
     C                     Z-ADDP3RGNB    $BRGNB           Item Structure
     C                     Z-ADDP3RHNB    $BRHNB           Item Structure
     C                     Z-ADDP3RINB    $BRINB           Item Structure
     C                     MOVELP8N0CD    $BN0CD           Item Type Code
     C                     MOVELP3HFAA    $BHFAA           TFMC Group Code
     C                     MOVELP4P2ST    $BP2ST           Active Status F
     C                     MOVELP5PBSX    $BPBSX           Include Credit
     C                     MOVEL*BLANK    $BQ2NA           Report Type Des
      * Report Type Desc DRV
      * PAR.Report Type Desc DRV = Condition name of PAR.Report Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1456722   Y2LSNO  70       List number
     C                     PARM $BIZSX    W0INVL 25        Report Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BQ2NA    PARM           W0CNNM 25        Report Type Des
      *
     C                     MOVEL*BLANK    $BQ3NA           Print Info Desc
      * Print Info Desc DRV
      * PAR.All/Select/Omit Desc DRV = Condition name of PAR.All/Select/O
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1713258   Y2LSNO  70       List number
     C                     PARM $BSUSX    W0INVL 25        Print Informati
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BQ3NA    PARM           W0CNNM 25        Print Info Desc
      *
      * TF Classification
      * CASE: TOP.TF Classification Code is Entered
     C           $BFLAA    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $BQ1NA           TF Class Desc D
      * TF Class Desc DRV
      * Rtv TF Class Desc     RT - TF Classification  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BQ1NA           TF Class Desc D
     C                     MOVEL'*ALL'    $BQ1NA           TF Class Desc D
     C                     END                             *FI
      * Item Structure Type
      * CASE: TOP.Item Structure Type Code is Entered
     C           $BRGNB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    $BQXNA           Item Str Type D
      * Item Str Type Desc DRV
      * Rtv Type Description   RT - Item Structure Type  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$BRGNB    WL0004           Item Structure
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $BQXNA    P      Item Structure
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BQXNA           Item Str Type D
     C                     MOVEL'*ALL'    $BQXNA           Item Str Type D
     C                     END                             *FI
      * Item Structure Group
      * CASE: TOP.Item Structure Group Code is Entered
     C           $BRHNB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    $BQWNA           Item Str Group
      * Item Str Group Desc DRV
      * Rtv Group Desc - Item Structure Group  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$BRHNB    WL0006           Item Structure
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    $BQWNA    P      Item Structure
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BQWNA           Item Str Group
     C                     MOVEL'*ALL'    $BQWNA           Item Str Group
     C                     END                             *FI
      * Item Structure Class
      * CASE: TOP.Item Structure Class Code is Entered
     C           $BRINB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    $BQVNA           Item Str Class
      * Item Str Class Desc DRV
      * Rtv Item Class Desc    RT - Item Structure Class  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$BRINB    WL0008           Item Structure
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    $BQVNA    P      Item Structure
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BQVNA           Item Str Class
     C                     MOVEL'*ALL'    $BQVNA           Item Str Class
     C                     END                             *FI
      * Item type code
      * CASE: TOP.Item Type Code is Entered
     C           $BN0CD    IFNE *BLANK                     *IF
      * TOP.Item Type Desc Usr = Condition name of TOP.Item Type Code
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294118   Y2LSNO  70       List number
     C                     PARM $BN0CD    W0INVL 25        Item Type Code
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BNLT1    PARM           W0CNNM 25        Item Type Desc
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BNLT1           Item Type Desc
     C                     MOVEL@CN,01    $BNLT1           Item Type Desc
     C                     END                             *FI
      * Meat Cost Group                              05/03/2007 LJB OMS01
      * CASE: TOP.TFMC Group Code is Entered
     C           $BHFAA    IFNE *BLANK                     *IF
      * RTV TF Meat Cost Desc  RT - TF Meat Cost Group  * 
     C                     EXSR SKRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BRNNA           TFMC Group Desc
     C                     MOVEL'*ALL'    $BRNNA           TFMC Group Desc
     C                     END                             *FI
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           WUB5SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'C/S'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Upd Init TF Class     RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BYREA1                    *
     C                     READ @BYREA1                  90*
      * Data record not found
     C   90                MOVEL'USR1160' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg TF Classification CH - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBYHGCD    WL0001           Item Code
     C                     MOVEL'N'       WL0002    P      TF Co-Ownership
     C                     MOVEL*BLANK    WL0003           Item TF Classif
     C                     EXSR SDCHRC
     C                     READ @BYREA1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg TF Classification CH - Item Default  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 30        Description Lin
     C                     MOVEL*BLANK    WN0002 30        Description Lin
     C                     MOVEL*BLANK    WN0003 32        Item Label Line
     C                     MOVEL*BLANK    WN0004 32        Item Label Line
     C                     MOVEL*BLANK    WN0005 32        Item Label Line
     C                     MOVEL*BLANK    WN0006 32        Item Label Line
     C                     MOVEL*BLANK    WN0007  2        U/M - Primary D
     C                     Z-ADD*ZERO     WN0008  94       Conversion Fact
     C                     MOVEL*BLANK    WN0009  1        Operation Facto
     C                     MOVEL*BLANK    WN0010  2        U/M - Second Df
     C                     Z-ADD*ZERO     WN0011  94       Conversion Fact
     C                     MOVEL*BLANK    WN0012  1        Operation Facto
     C                     MOVEL*BLANK    WN0013  2        U/M - Third Dft
     C                     MOVEL*BLANK    WN0014  2        U/M - Pricing D
     C                     Z-ADD*ZERO     WN0015 112       Unit Weight
     C                     MOVEL*BLANK    WN0016  2        Quality Level
     C                     MOVEL*BLANK    WN0017  2        Item Level
     C                     MOVEL*BLANK    WN0018  1        Production Date
     C                     MOVEL*BLANK    WN0019  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0020 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0021 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0022  50       Number Cases On
     C                     Z-ADD*ZERO     WN0023  80       Vendor item Def
     C                     Z-ADD*ZERO     WN0024  30       Item Structure
     C                     Z-ADD*ZERO     WN0025  30       Item Structure
     C                     Z-ADD*ZERO     WN0026  30       Item Structure
     C                     MOVEL*BLANK    WN0027  3        Default Commod
     C                     Z-ADD*ZERO     WN0028  30       Transportation
     C                     MOVEL*BLANK    WN0029  3        Item Type Code
     C                     MOVEL*BLANK    WN0030  1        Package Type Co
     C                     Z-ADD*ZERO     WN0031  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0032  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0033  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0034  1        Frozen Make to
     C                     MOVEL*BLANK    WN0035  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0036 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0037  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0038  7        Commodity Price
     C                     Z-ADD*ZERO     WN0039  52       Pallet Tare Wei
     C                     Z-ADD*ZERO     WN0040  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WN0041  30       Production Lead
     C                     MOVEL*BLANK    WN0042  3        Packaging Code
     C                     MOVEL*BLANK    WN0043  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0044  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0045  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0046  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0047  1        PA Base Avail R
     C                     Z-ADD*ZERO     WN0048 114       PM Pounds per H
     C                     Z-ADD*ZERO     WN0049  74       Item Frt Overag
     C                     Z-ADD*ZERO     WN0050  74       PM % 2nds Facto
     C                     Z-ADD*ZERO     WN0051  30       Use/Freeze/Sell
     C                     Z-ADD*ZERO     WN0052 114       PM Batch Size
     C                     Z-ADD*ZERO     WN0053 114       PM Lot Size
     C                     Z-ADD*ZERO     WN0054  70       Partial Item Co
     C                     Z-ADD*ZERO     WN0055  70       WIP Item Code
     C                     Z-ADD*ZERO     WN0056  70       WIP Reject Code
     C                     Z-ADD*ZERO     WN0057  92       Std Costing Uni
     C                     Z-ADD*ZERO     WN0058  92       FP Std Green We
     C                     Z-ADD*ZERO     WN0059 114       PM Standard LBS
     C                     Z-ADD*ZERO     WN0060 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WN0061 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WN0062 114       PM Finished LBS
     C                     MOVEL*BLANK    WN0063  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0064  30       PM R/M Type Cod
     C                     MOVEL*BLANK    WN0065  1        Seconds Item
     C                     MOVEL*BLANK    WN0066  2        Print on Realiz
     C                     MOVEL*BLANK    WN0067  3        Unit Weight Cha
     C                     Z-ADD*ZERO     WN0068 112       Maximum Audit V
     C                     Z-ADD*ZERO     WN0069 112       Minimum Audit V
     C                     Z-ADD*ZERO     WN0070 114       Market Overage
     C                     Z-ADD*ZERO     WN0071 114       Standard Overag
     C                     MOVEL*BLANK    WN0072  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0073 114       Item Pricing Co
     C                     MOVEL*BLANK    WN0074  3        Default Warehou
     C                     Z-ADD*ZERO     WN0075  30       Company Number
     C                     MOVEL*BLANK    WN0076  3        Price Method De
     C                     MOVEL*BLANK    WN0077  6        Department Code
     C                     MOVEL*BLANK    WN0078  1        Group for Packa
     C                     Z-ADD*ZERO     WN0079  20       Item Category N
     C                     MOVEL*BLANK    WN0080  3        MTO Code
     C                     Z-ADD*ZERO     WN0081  20       Item Category N
     C                     MOVEL*BLANK    WN0082  3        Item Category C
     C                     Z-ADD*ZERO     WN0083  20       Item Category N
     C                     MOVEL*BLANK    WN0084  3        Item Category C
     C                     Z-ADD*ZERO     WN0085  20       Item Category N
     C                     MOVEL*BLANK    WN0086  3        G/L Sub Code
     C                     Z-ADD*ZERO     WN0087  20       Item Category N
     C                     MOVEL*BLANK    WN0088  3        Item Category C
     C                     Z-ADD*ZERO     WN0089  20       Item Category N
     C                     MOVEL*BLANK    WN0090  3        Item Category C
     C                     Z-ADD*ZERO     WN0091  20       Item Category N
     C                     MOVEL*BLANK    WN0092  3        Item Category C
     C                     Z-ADD*ZERO     WN0093  20       Item Category N
     C                     MOVEL*BLANK    WN0094  3        Item Category C
     C                     Z-ADD*ZERO     WN0095  20       Item Category N
     C                     MOVEL*BLANK    WN0096  3        Item Category C
     C                     Z-ADD*ZERO     WN0097  20       Item Category N
     C                     MOVEL*BLANK    WN0098  3        Item Category C
     C                     Z-ADD*ZERO     WN0099  50       PM Line Number
     C                     MOVEL*BLANK    WN0100  6        Primal Group Co
     C                     MOVEL*BLANK    WN0101  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0102  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0103  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0104  1        Export/Domestic
     C                     MOVEL*BLANK    WN0105  1        Print On Schedu
     C                     MOVEL*BLANK    WN0106  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0107  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0108  1        Frozen Sched As
     C                     MOVEL*BLANK    WN0109 12        UPC Code 1
     C                     MOVEL*BLANK    WN0110 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0111 112       Item Target Pri
     C                     Z-ADD*ZERO     WN0112 112       Minimum Piece W
     C                     Z-ADD*ZERO     WN0113 112       Maximum Piece W
     C                     Z-ADD*ZERO     WN0114  70       Seaboard Equiva
     C                     Z-ADD*ZERO     WN0115  70       Production Qty
     C                     MOVEL*BLANK    WN0116  1        Scheduling Posi
     C                     MOVEL*BLANK    WN0117  1        Sold 100% Froze
     C                     MOVEL*BLANK    WN0118  1        Maximum Shifts
     C                     MOVEL*BLANK    WN0119  1        Value Added Sts
     C                     MOVEL*BLANK    WN0120  2        Label Type
     C                     MOVEL*BLANK    WN0121  2        Item TF Exempt
     C                     MOVEL*BLANK    WN0122  3        Default Workcen
     C                     MOVEL*BLANK    WN0123  1        EDI Status 1
     C                     MOVEL*BLANK    WN0124  1        EDI Status 2
     C                     MOVEL*BLANK    WN0125  1        EDI Status 3
     C                     MOVEL*BLANK    WN0126  1        Record Status
     C                     Z-ADD*ZERO     WN0127  60       Job Time
     C                     MOVEL*BLANK    WN0128 10        User Id
     C                     MOVEL*BLANK    WN0129 10        Job Name
     C                     Z-ADD*ZERO     WN0130  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BYREA0
     C                     Z-ADDWL0001    WAHGCD           Item Code
      *
     C           KLCHSD    KLIST
     C                     KFLD           WAHGCD           Item Code
     C           KLCHSD    CHAIN@BYREA0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMBYREL0'MDACP
     C                     MOVEL'@BYREA0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMBY1    YARDCS
      * Move non-key fields to @BYREA0
     C                     MOVELWL0002    WAP3ST    P      TF Co-Ownership
     C                     MOVELWL0003    WATCST    P      Item TF Classif
      *
      * Set PGM.*Record Data Changed flag
     C           QOMBY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BYREA0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMBYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd TF Classification RT - Company Item  * 
     C                     EXSR SERVGN
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd TF Classification RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZHGCD    WQSE01           Item Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Item Code
      * Setup key
     C                     Z-ADDWAHGCD    WQSE01           Item Code
      * Establish starting position
     C           KRSSE     SETLL@BZREU3                    *
     C           KRSSE     READE@BZREU3                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg TF Classification CH - Company Item  * 
     C                     EXSR SFCHRC
     C           KRSSE     READE@BZREU3                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg TF Classification CH - Company Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0131 30        Description Lin
     C                     MOVEL*BLANK    WN0132 30        Description Lin
     C                     MOVEL*BLANK    WN0133 32        Item Label Line
     C                     MOVEL*BLANK    WN0134 32        Item Label Line
     C                     MOVEL*BLANK    WN0135 32        Item Label Line
     C                     MOVEL*BLANK    WN0136 32        Item Label Line
     C                     MOVEL*BLANK    WN0137  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0138  94       Conversion Fact
     C                     MOVEL*BLANK    WN0139  1        Operation Facto
     C                     MOVEL*BLANK    WN0140  2        U/M - Second
     C                     Z-ADD*ZERO     WN0141  94       Conversion Fact
     C                     MOVEL*BLANK    WN0142  1        Operation Facto
     C                     MOVEL*BLANK    WN0143  2        U/M - Third
     C                     MOVEL*BLANK    WN0144  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0145 112       Unit Weight
     C                     MOVEL*BLANK    WN0146  2        Quality Level
     C                     MOVEL*BLANK    WN0147  2        Item Level
     C                     MOVEL*BLANK    WN0148  1        Production Date
     C                     MOVEL*BLANK    WN0149  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0150 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0151 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0152  50       Number Cases On
     C                     Z-ADD*ZERO     WN0153  80       Vendor - Item D
     C                     Z-ADD*ZERO     WN0154  30       Item Structure
     C                     Z-ADD*ZERO     WN0155  30       Item Structure
     C                     Z-ADD*ZERO     WN0156  30       Item Structure
     C                     MOVEL*BLANK    WN0157  3        Default Commod
     C                     Z-ADD*ZERO     WN0158  30       Transportation
     C                     MOVEL*BLANK    WN0159  3        Item Type Code
     C                     MOVEL*BLANK    WN0160  1        Package Type Co
     C                     Z-ADD*ZERO     WN0161 112       Maximum Audit V
     C                     Z-ADD*ZERO     WN0162 112       Minimum Audit V
     C                     Z-ADD*ZERO     WN0163 114       Market Overage
     C                     Z-ADD*ZERO     WN0164 114       Standard Overag
     C                     MOVEL*BLANK    WN0165  7        Commodity Price
     C                     MOVEL*BLANK    WN0166  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0167 114       Item Pricing Co
     C                     MOVEL*BLANK    WN0168  3        Default Warehou
     C                     MOVEL*BLANK    WN0169  3        Price Method De
     C                     Z-ADD*ZERO     WN0170  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0171  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0172  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0173  1        Frozen Make to
     C                     MOVEL*BLANK    WN0174  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0175 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0176  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0177  6        Department Code
     C                     MOVEL*BLANK    WN0178  1        Group for Packa
     C                     Z-ADD*ZERO     WN0179  20       Item Category N
     C                     MOVEL*BLANK    WN0180  3        MTO Code
     C                     Z-ADD*ZERO     WN0181  20       Item Category N
     C                     MOVEL*BLANK    WN0182  3        Item Category C
     C                     Z-ADD*ZERO     WN0183  20       Item Category N
     C                     MOVEL*BLANK    WN0184  3        Item Category C
     C                     Z-ADD*ZERO     WN0185  20       Item Category N
     C                     MOVEL*BLANK    WN0186  3        G/L Sub Code
     C                     Z-ADD*ZERO     WN0187  20       Item Category N
     C                     MOVEL*BLANK    WN0188  3        Item Category C
     C                     Z-ADD*ZERO     WN0189  20       Item Category N
     C                     MOVEL*BLANK    WN0190  3        Item Category C
     C                     Z-ADD*ZERO     WN0191  20       Item Category N
     C                     MOVEL*BLANK    WN0192  3        Item Category C
     C                     Z-ADD*ZERO     WN0193  20       Item Category N
     C                     MOVEL*BLANK    WN0194  3        Item Category C
     C                     Z-ADD*ZERO     WN0195  20       Item Category N
     C                     MOVEL*BLANK    WN0196  3        Item Category C
     C                     Z-ADD*ZERO     WN0197  20       Item Category N
     C                     MOVEL*BLANK    WN0198  3        Item Category C
     C                     Z-ADD*ZERO     WN0199  52       Pallet Tare Wei
     C                     Z-ADD*ZERO     WN0200  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WN0201  30       Production Lead
     C                     MOVEL*BLANK    WN0202  3        Packaging Code
     C                     MOVEL*BLANK    WN0203  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0204  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0205  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0206  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0207  1        PA Base Avail R
     C                     Z-ADD*ZERO     WN0208 114       PM Pounds per H
     C                     Z-ADD*ZERO     WN0209  74       Item Frt Overag
     C                     Z-ADD*ZERO     WN0210  74       PM % 2nds Facto
     C                     Z-ADD*ZERO     WN0211  30       Use/Freeze/Sell
     C                     Z-ADD*ZERO     WN0212 114       PM Batch Size
     C                     Z-ADD*ZERO     WN0213 114       PM Lot Size
     C                     Z-ADD*ZERO     WN0214  70       Partial Item Co
     C                     Z-ADD*ZERO     WN0215  70       WIP Item Code
     C                     Z-ADD*ZERO     WN0216  70       WIP Reject Code
     C                     Z-ADD*ZERO     WN0217  92       Std Costing Uni
     C                     Z-ADD*ZERO     WN0218  92       FP Std Green We
     C                     Z-ADD*ZERO     WN0219 114       PM Standard LBS
     C                     Z-ADD*ZERO     WN0220 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WN0221 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WN0222 114       PM Finished LBS
     C                     MOVEL*BLANK    WN0223  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0224  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0225  50       PM Line Number
     C                     MOVEL*BLANK    WN0226  1        Seconds Item
     C                     MOVEL*BLANK    WN0227  2        Print on Realiz
     C                     MOVEL*BLANK    WN0228  3        Unit Weight Cha
     C                     MOVEL*BLANK    WN0229  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0230  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0231  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0232  1        Export/Domestic
     C                     MOVEL*BLANK    WN0233  1        Print On Schedu
     C                     MOVEL*BLANK    WN0234  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0235  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0236  1        Frozen Sched As
     C                     MOVEL*BLANK    WN0237  6        Primal Group Co
     C                     MOVEL*BLANK    WN0238 12        UPC Code 1
     C                     MOVEL*BLANK    WN0239 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0240 112       Item Target Pri
     C                     Z-ADD*ZERO     WN0241 112       Minimum Piece W
     C                     Z-ADD*ZERO     WN0242 112       Maximum Piece W
     C                     Z-ADD*ZERO     WN0243  70       Seaboard Equiva
     C                     Z-ADD*ZERO     WN0244  70       Production Qty
     C                     MOVEL*BLANK    WN0245  1        Scheduling Posi
     C                     MOVEL*BLANK    WN0246  1        Sold 100% Froze
     C                     MOVEL*BLANK    WN0247  1        Maximum Shifts
     C                     MOVEL*BLANK    WN0248  1        Value Added Sts
     C                     MOVEL*BLANK    WN0249  2        Label Type
     C                     MOVEL*BLANK    WN0250  2        Item TF Exempt
     C                     MOVEL*BLANK    WN0251  3        Default Workcen
     C                     MOVEL*BLANK    WN0252  1        EDI Status 1
     C                     MOVEL*BLANK    WN0253  1        EDI Status 2
     C                     MOVEL*BLANK    WN0254  1        EDI Status 3
     C                     MOVEL*BLANK    WN0255  1        Record Status
     C                     Z-ADD*ZERO     WN0256  60       Job Time
     C                     MOVEL*BLANK    WN0257 10        User Id
     C                     MOVEL*BLANK    WN0258 10        Job Name
     C                     Z-ADD*ZERO     WN0259  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BZREJV
     C                     Z-ADDBZAIC3    WBAIC3           Company Number
     C                     Z-ADDBZHGCD    WBHGCD           Item Code
      *
     C           KLCHSF    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C           KLCHSF    CHAIN@BZREJV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CABZREL0'MDACP
     C                     MOVEL'@BZREJV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCABZ1    YBRDCS
      * Move non-key fields to @BZREJV
     C                     MOVELWL0002    WBP3ST    P      TF Co-Ownership
     C                     MOVELWL0003    WBTCST    P      Item TF Classif
      *
      * Set PGM.*Record Data Changed flag
     C           QCABZ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BZREJV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv TF Class Desc     RT - TF Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           AMFLAA           TF Classificati
      * Setup key
     C                     MOVEL$BFLAA    AMFLAA           TF Classificati
      * Establish starting position
     C           KRSSG     CHAIN@AMREVR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3376' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BQ1NA           TF Classificati
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMQ0NA    $BQ1NA           TF Classificati
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Type Description   RT - Item Structure Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           E8RGNB           Item Structure
      * Setup key
     C                     Z-ADDWL0004    E8RGNB           Item Structure
      * Establish starting position
     C           KRSSH     CHAIN@E8REBB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1166' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Item Structure
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE8DCTX    WL0005           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Group Desc - Item Structure Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADDWL0006    E9RHNB           Item Structure
      * Establish starting position
     C           KRSSI     CHAIN@E9REA8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1168' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Item Structure
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE9DDTX    WL0007           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Item Class Desc    RT - Item Structure Class  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           FARINB           Item Structure
      * Setup key
     C                     Z-ADDWL0008    FARINB           Item Structure
      * Establish starting position
     C           KRSSJ     CHAIN@FAREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Item Structure
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFADETX    WL0009           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV TF Meat Cost Desc  RT - TF Meat Cost Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           APHFAA           TFMC Group Code
      * Setup key
     C                     MOVEL$BHFAA    APHFAA           TFMC Group Code
      * Establish starting position
     C           KRSSK     CHAIN@APREJN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3703' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BRNNA           TFMC Group Desc
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPRNNA    $BRNNA           TFMC Group Desc
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv TF Class Info     RT - TF Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           AMFLAA           TF Classificati
      * Setup key
     C                     MOVEL$CFLAA    AMFLAA           TF Classificati
      * Establish starting position
     C           KRSSL     CHAIN@AMREVR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3376' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv TF Margin Adj Hdr RT - TF Margin Adj Group Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           ANFLAA           TF Classificati
     C                     KFLD           ANRGNB           Item Structure
      * Setup key
     C                     MOVEL$CFLAA    ANFLAA           TF Classificati
     C                     Z-ADD$CRGNB    ANRGNB           Item Structure
      * Establish starting position
     C           KRSSM     CHAIN@ANREVU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3378' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Existance         RT - TF Margin Adj Group Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WDFLAA           TF Classificati
     C                     KFLD           WDRGNB           Item Structure
     C                     KFLD           WDRHNB           Item Structure
     C                     KFLD           WDRINB           Item Structure
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     MOVELWL0010    WDFLAA           TF Classificati
     C                     Z-ADDWL0011    WDRGNB           Item Structure
     C                     Z-ADDWL0012    WDRHNB           Item Structure
     C                     Z-ADDWL0013    WDRINB           Item Structure
     C                     Z-ADDWL0014    WDHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@APREV0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3382' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0015           Record Found US
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0015           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 05/04/2007 LJB OMS011
      * ** Add Meat Cost Group selection and Record Status Selection.
      * ** Add both fields to Top of Page. If Meat Cost is passed in then
      * ** select only matching. If Record Status is passed in then
      * ** 032108 slm add addition selection e00124
      * ** 081508 slm Update the Item Default with co-own from TF Margin
      * ** group detail -
      * ** Need to get with Alice.
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt TF Class ItmsAdSelPO
      *================================================================
      * CASE: PAR.Report Type is Summary
     C           P1IZSX    IFEQ 'S'                        *IF
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      * Prt TF Class ItmsAdSelPO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * history
      *================================================================
      * 032008 slm selection on fg/wip/or both
      * E00124
      * 082508 slm add logic to place co-own into the item co-own
      * fp1291
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt TF Class ItmsAdSelPO: Initialise
      *================================================================
      * USER: Initialize program
      * history
     C                     EXSR UCSUBR                     history
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7PROF           Print On Form
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Print Yes/No          USR
     C                     MOVEL*BLANK    WUB5SX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAACC8           Vendor item Def
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           PM Lot Size
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAHTM           Job Time
     C                     Z-ADD*ZERO     WAEKDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Production Lead
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AODXNB           Sequence Number
     C                     MOVEL*LOVAL    AOFLAA           TF Classificati
     C                     MOVEL*LOVAL    AORGNB           Item Structure
     C                     MOVEL*LOVAL    AORHNB           Item Structure
     C                     MOVEL*LOVAL    AORINB           Item Structure
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCRGNB           Item Structure
     C                     MOVEL*LOVAL    WCRHNB           Item Structure
     C                     MOVEL*LOVAL    WCRINB           Item Structure
     C                     MOVEL*LOVAL    WCHGCD           Item Code
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDCHRC.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003  3
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007 30
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009 30
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Sequence Number
     C                     Z-ADD*ZERO     YN0002  30
      * Define null work field TF Class Group
     C                     MOVEL*BLANK    YN0003  2
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0003  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Change Flag USR is Yes
      *   |- c2    : PAR.Print Information USR is Selected Items
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6HWSX    IFEQ 'Y'                        *IF
     C           P2SUSX    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Initialize to Blank
      * Upd Init TF Class     RT - Item Default  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
     C                     MOVEL'0'       P7PROF           Print On Form
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Both FG/WIP
