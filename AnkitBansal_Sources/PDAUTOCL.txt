/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - AUTO PRICING CALC                                    */
/*                                                                  */
/*  DON MCINTYRE                                                    */
/*  05/26/95                                                        */
/********************************************************************/
             PGM        PARM(&RETURN &COMPN &SDATEN)

        DCL     &COMPN      *DEC
        DCL     &COMP       *DEC     (3 0)    /*  COMPANY #      */
        DCL     &COMPA      *CHAR    3        /*  ALPHA CO #     */
        DCL     &SDATEN     *DEC
        DCL     &SDATE      *DEC     (7 0)    /*  REQ. DATE      */
        DCL     &SDATEA     *CHAR    7
        DCL     &ORDER#     *DEC     (7 0) VALUE(0)  /* ORDER # */
        DCL     &RETURN     *CHAR    7
        DCL     &MSGRTN     *CHAR    10
        DCL     &MSGE       *CHAR    7
        DCL     &MSGC       *CHAR    7
        DCL     &A          *CHAR    25       /* QRY EVENT CODE   */
        DCL     &B          *CHAR    25       /* QRY CO SELECT    */
        DCL     &C          *CHAR    25       /* QRY DATE SELECT  */
        DCL     &H          *CHAR    195      /* QRY COMBINED     */

/********************************************************************/
/* CHANGE VARIABLES                                                 */
/********************************************************************/
             CHGVAR     VAR(&COMP) VALUE(&COMPN) /* Change to length +
                          for print program */
             CHGVAR     VAR(&COMPA) VALUE(&COMP) /* Change FOR  +
                          MESSAGES for print program */
             CHGVAR     VAR(&SDATE) VALUE(&SDATEN) /* Change to +
                          length for print program */
             CHGVAR     VAR(&SDATEA) VALUE(&SDATE)

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR OPEN ORDER REPORTS        */
/*********************************************************************/
             CHGVAR     VAR(&A) VALUE('BEJPCD *LE "05" ')

             IF         (&COMPA *NE '000') THEN(DO)
             CHGVAR     VAR(&B) VALUE('*AND BEAIC3 *EQ ' *CAT &COMPA)
             ENDDO



/** SELECT REQUESTED SHIP DATE                          */

  /*         IF         (&SDATEA *NE '0000000') THEN(DO)        */
  /*         CHGVAR     VAR(&C) VALUE('*AND BEA5DT *EQ ' *CAT + */
  /*                     &SDATEA)                               */
  /*         ENDDO                                              */


/** SELECT ACTUAL SHIP DATE                             */

             IF         (&SDATEA *NE '0000000') THEN(DO)
             CHGVAR     VAR(&C) VALUE('*AND BEGNDT *EQ ' *CAT +
                         &SDATEA)
             ENDDO

             CHGVAR     VAR(&H) VALUE(&A *BCAT &B *BCAT &C)


/*  OPEN OP ORDER HEADER VIA OPEN QUERY FILE            */

             OVRDBF     FILE(OPBFCPL1) SHARE(*YES)
             OPNQRYF    FILE(OPBFCPL1) +
                        QRYSLT(&H) +
                        KEYFLD(*FILE)

             CALL       PGM(PDPRXFR) PARM(&RETURN &COMP &ORDER# &SDATE)

             DLTOVR     FILE(*ALL)
             CLOF       OPNID(OPBFCPL1)

 END:        ENDPGM
