// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for OPXIPVR
// ?Date: 14.08.2025 Time: 03:26:36
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

// PAR.Warehouse Code = CND.Warehouse Code Blank
PAR.Warehouse_Code = *BLANK;

//?USER: Load screen

// DTL.Company Number = PAR.Company Number
DTL.Company_Number = PAR.Company_Number;

// DTL.Company Number CDE = PAR.Company Number
DTL.Company_Number_CDE = PAR.Company_Number;

EXECUTE FUNCTION(RTV Company Name       RT) TYPE(RTVOBJ) FILE(CAABREP)          AC1255767;
PARAMETER(PAR.Company_Number);
PARAMETER(DTL.Name);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?USER: Validate fields

//?Process F4 on Warehouse
CASE;

// IF DTL.*CMD key is *Prompt
IF DTL.*CMD_key = '04';

// AND PGM.*Cursor field <IS> DTL.Warehouse Code
AND PGM.*Cursor_field = DTL.Warehouse_Code;

// Call program Zzz Non-Prod Whse/Desc SR.
CALL PROGRAM(Zzz Non-Prod Whse/Desc SR) ('PDZMSRR');
PARAMETER(DTL.Warehouse_Code);

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

ENDIF;

//?Validate warehouse if entered
CASE;

// IF DTL.Warehouse Code is Warehouse Code not Blank
IF DTL.Warehouse_Code <> *BLANK;

EXECUTE FUNCTION(Rtv Desc/Trans Control RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1304130;
PARAMETER(DTL.Warehouse_Code);
PARAMETER(DTL.Warehouse_Description);
PARAMETER(WRK.Trans_Contol_AS400_Plant);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// PAR.Warehouse Code = DTL.Warehouse Code
PAR.Warehouse_Code = DTL.Warehouse_Code;

CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

CASE;

// IF WRK.Trans Contol AS400/Plant is Plant
IF WRK.Trans_Contol_AS400_Plant = 'P';

// Send error message - 'Warehouse cannot be a production warehouse.'
ERROR(USR1923);
MSGPARM(DTL.Warehouse_Code);

ENDIF;

// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - 'Warehouse not found'
ERROR(USR0372);
MSGPARM(DTL.Warehouse_Code);

ENDIF;

ENDIF;

//?USER: User defined action

// PAR.Warehouse Code = DTL.Warehouse Code
PAR.Warehouse_Code = DTL.Warehouse_Code;

//?USER: Exit program processing

CASE;

// IF DTL.*CMD key is CF03
IF DTL.*CMD_key = '03';

PGM.*Return_code = 'Y2U9999';

RETURN;

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Return code = CND.*Normal
PGM.*Return_code = *BLANK;

ENDIF;

